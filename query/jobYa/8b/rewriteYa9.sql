create or replace view tAux28 as select id as v11, title as v40 from title where production_year<=2007 and ((title LIKE 'One Piece%') OR (title LIKE 'Dragon Ball Z%')) and production_year>=2006;
create or replace view semiUp4230947620596908040 as select person_id as v2, name as v3 from aka_name AS an where (person_id) in (select id from name AS n where name LIKE '%Yo%' and name NOT LIKE '%Yu%');
create or replace view anAux21 as select v2, v3 from semiUp4230947620596908040;
create or replace view semiUp4488621334762361810 as select movie_id as v11, company_id as v25 from movie_companies AS mc where (company_id) in (select id from company_name AS cn where country_code= '[jp]') and ((note LIKE '%(2006)%') OR (note LIKE '%(2007)%')) and note NOT LIKE '%(USA)%' and note LIKE '%(Japan)%';
create or replace view semiUp1016072959563955402 as select person_id as v2, movie_id as v11, role_id as v15 from cast_info AS ci where (role_id) in (select id from role_type AS rt where role= 'actress') and note= '(voice: English version)';
create or replace view semiUp3312168541482035614 as select v2, v11, v15 from semiUp1016072959563955402 where (v11) in (select v11 from semiUp4488621334762361810);
create or replace view semiUp7926447474095099348 as select v2, v11, v15 from semiUp3312168541482035614 where (v2) in (select v2 from anAux21);
create or replace view semiUp9078731108046797812 as select v11, v40 from tAux28 where (v11) in (select v11 from semiUp7926447474095099348);
create or replace view semiDown1459805592378053990 as select id as v11, title as v40 from title AS t where (id, title) in (select v11, v40 from semiUp9078731108046797812) and production_year<=2007 and ((title LIKE 'One Piece%') OR (title LIKE 'Dragon Ball Z%')) and production_year>=2006;
create or replace view semiDown618474344722764836 as select v2, v11, v15 from semiUp7926447474095099348 where (v11) in (select v11 from semiUp9078731108046797812);
create or replace view semiDown5724912082921167834 as select id as v15 from role_type AS rt where (id) in (select v15 from semiDown618474344722764836) and role= 'actress';
create or replace view semiDown1337206330358809544 as select v11, v25 from semiUp4488621334762361810 where (v11) in (select v11 from semiDown618474344722764836);
create or replace view semiDown8257978602737138826 as select v2, v3 from anAux21 where (v2) in (select v2 from semiDown618474344722764836);
create or replace view semiDown7640430065745664461 as select id as v25 from company_name AS cn where (id) in (select v25 from semiDown1337206330358809544) and country_code= '[jp]';
create or replace view semiDown8316322709761827274 as select v2, v3 from semiUp4230947620596908040 where (v2, v3) in (select v2, v3 from semiDown8257978602737138826);
create or replace view semiDown2793248387469351276 as select id as v2 from name AS n where (id) in (select v2 from semiDown8316322709761827274) and name LIKE '%Yo%' and name NOT LIKE '%Yu%';
create or replace view aggView2448302449076576413 as select v11, v40, v40 as v52 from semiDown1459805592378053990;
create or replace view aggView123840283061464212 as select v2 from semiDown2793248387469351276;
create or replace view aggJoin7676106914686213569 as select v2, v3 from semiDown8316322709761827274 join aggView123840283061464212 using(v2);
create or replace view aggView8852550983510029894 as select v2, v3, MIN(v3) as v51 from aggJoin7676106914686213569 group by v2,v3;
create or replace view aggView1413005721837356884 as select v25 from semiDown7640430065745664461;
create or replace view aggJoin7163841151679240983 as select v11 from semiDown1337206330358809544 join aggView1413005721837356884 using(v25);
create or replace view aggView2368029098852264355 as select v11 from aggJoin7163841151679240983 group by v11;
create or replace view aggJoin7697062783226860810 as select v2, v11, v15 from semiDown618474344722764836 join aggView2368029098852264355 using(v11);
create or replace view aggView5605254631864053261 as select v2, MIN(v51) as v51 from aggView8852550983510029894 group by v2,v51;
create or replace view aggJoin2097575030580859665 as select v11, v15, v51 from aggJoin7697062783226860810 join aggView5605254631864053261 using(v2);
create or replace view aggView3367060543301245198 as select v15 from semiDown5724912082921167834;
create or replace view aggJoin2948889579740945543 as select v11, v51 from aggJoin2097575030580859665 join aggView3367060543301245198 using(v15);
create or replace view aggView6051565282559945576 as select v11, MIN(v51) as v51 from aggJoin2948889579740945543 group by v11,v51;
create or replace view aggJoin7781219118529437885 as select v52 as v52, v51 from aggView2448302449076576413 join aggView6051565282559945576 using(v11);
create or replace view res as select MIN(v51) as v51, MIN(v52) as v52 from aggJoin7781219118529437885;
select sum(v51+v52) from res;
