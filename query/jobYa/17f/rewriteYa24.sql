create or replace view semiUp3311697418571860665 as select movie_id as v3, keyword_id as v25 from movie_keyword AS mk where (keyword_id) in (select id from keyword AS k where keyword= 'character-name-in-title');
create or replace view semiUp7406037611470906108 as select v3, v25 from semiUp3311697418571860665 where (v3) in (select id from title AS t);
create or replace view semiUp9188012427573189902 as select movie_id as v3, company_id as v20 from movie_companies AS mc where (company_id) in (select id from company_name AS cn);
create or replace view semiUp9112155463181300549 as select v3, v25 from semiUp7406037611470906108 where (v3) in (select v3 from semiUp9188012427573189902);
create or replace view semiUp7420608796210314724 as select person_id as v26, movie_id as v3 from cast_info AS ci where (person_id) in (select id from name AS n where name LIKE '%B%');
create or replace view semiUp7503163326212639606 as select v26, v3 from semiUp7420608796210314724 where (v3) in (select v3 from semiUp9112155463181300549);
create or replace view semiDown251329857518361018 as select id as v26, name as v27 from name AS n where (id) in (select v26 from semiUp7503163326212639606) and name LIKE '%B%';
create or replace view semiDown2977967801529809244 as select v3, v25 from semiUp9112155463181300549 where (v3) in (select v3 from semiUp7503163326212639606);
create or replace view semiDown7908772718680002055 as select id as v25 from keyword AS k where (id) in (select v25 from semiDown2977967801529809244) and keyword= 'character-name-in-title';
create or replace view semiDown2636769808535472454 as select id as v3 from title AS t where (id) in (select v3 from semiDown2977967801529809244);
create or replace view semiDown6628299628087737842 as select v3, v20 from semiUp9188012427573189902 where (v3) in (select v3 from semiDown2977967801529809244);
create or replace view semiDown5303931201753019919 as select id as v20 from company_name AS cn where (id) in (select v20 from semiDown6628299628087737842);
create or replace view aggView4857081932416120600 as select v20 from semiDown5303931201753019919;
create or replace view aggJoin1957273610586546325 as select v3 from semiDown6628299628087737842 join aggView4857081932416120600 using(v20);
create or replace view aggView456232753284129722 as select v25 from semiDown7908772718680002055;
create or replace view aggJoin625881546841232233 as select v3 from semiDown2977967801529809244 join aggView456232753284129722 using(v25);
create or replace view aggView6300538793234695820 as select v3 from semiDown2636769808535472454;
create or replace view aggJoin1636127939518407504 as select v3 from aggJoin625881546841232233 join aggView6300538793234695820 using(v3);
create or replace view aggView7135161157988258886 as select v3 from aggJoin1957273610586546325 group by v3;
create or replace view aggJoin8525051193464923828 as select v3 from aggJoin1636127939518407504 join aggView7135161157988258886 using(v3);
create or replace view aggView7480278963855241098 as select v26, v27 as v47 from semiDown251329857518361018;
create or replace view aggJoin2375294532790275775 as select v3, v47 from semiUp7503163326212639606 join aggView7480278963855241098 using(v26);
create or replace view aggView4484465867079314105 as select v3 from aggJoin8525051193464923828 group by v3;
create or replace view aggJoin7114975938747830302 as select v47 as v47 from aggJoin2375294532790275775 join aggView4484465867079314105 using(v3);
create or replace view res as select MIN(v47) as v47 from aggJoin7114975938747830302;
select sum(v47) from res;
