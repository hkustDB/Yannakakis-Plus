create or replace view chnAux71 as select id as v1, name as v2 from char_name;
create or replace view semiUp1257944080192555412 as select movie_id as v31, company_id as v15, company_type_id as v22 from movie_companies AS mc where (company_type_id) in (select id from company_type AS ct);
create or replace view semiUp6945718059569598371 as select v31, v15, v22 from semiUp1257944080192555412 where (v15) in (select id from company_name AS cn where country_code= '[us]');
create or replace view semiUp599871694996367049 as select id as v31, title as v32 from title AS t where (id) in (select v31 from semiUp6945718059569598371) and production_year>1990;
create or replace view tAux59 as select v31, v32 from semiUp599871694996367049;
create or replace view semiUp6038357938531976446 as select movie_id as v31, person_role_id as v1, role_id as v29 from cast_info AS ci where (role_id) in (select id from role_type AS rt) and note LIKE '%(producer)%';
create or replace view semiUp3628401412638387497 as select v31, v1, v29 from semiUp6038357938531976446 where (v31) in (select v31 from tAux59);
create or replace view semiUp3662894724916895243 as select v1, v2 from chnAux71 where (v1) in (select v1 from semiUp3628401412638387497);
create or replace view semiDown4387379098943727277 as select v31, v1, v29 from semiUp3628401412638387497 where (v1) in (select v1 from semiUp3662894724916895243);
create or replace view semiDown4678959214035481100 as select id as v1, name as v2 from char_name AS chn where (name, id) in (select v2, v1 from semiUp3662894724916895243);
create or replace view semiDown3551852202507613769 as select id as v29 from role_type AS rt where (id) in (select v29 from semiDown4387379098943727277);
create or replace view semiDown4183484344481828114 as select v31, v32 from tAux59 where (v31) in (select v31 from semiDown4387379098943727277);
create or replace view semiDown3623898473879187938 as select v31, v32 from semiUp599871694996367049 where (v32, v31) in (select v32, v31 from semiDown4183484344481828114);
create or replace view semiDown2963970114231812903 as select v31, v15, v22 from semiUp6945718059569598371 where (v31) in (select v31 from semiDown3623898473879187938);
create or replace view semiDown4899087704015661359 as select id as v22 from company_type AS ct where (id) in (select v22 from semiDown2963970114231812903);
create or replace view semiDown2616108488536381303 as select id as v15 from company_name AS cn where (id) in (select v15 from semiDown2963970114231812903) and country_code= '[us]';
create or replace view aggView6521829383007642459 as select v2, v1, v2 as v43 from semiDown4678959214035481100;
create or replace view aggView2230235624237077980 as select v22 from semiDown4899087704015661359;
create or replace view aggJoin3819613944928502107 as select v31, v15 from semiDown2963970114231812903 join aggView2230235624237077980 using(v22);
create or replace view aggView5416666104312509377 as select v15 from semiDown2616108488536381303;
create or replace view aggJoin2162088805393803286 as select v31 from aggJoin3819613944928502107 join aggView5416666104312509377 using(v15);
create or replace view aggView759873149958444101 as select v31 from aggJoin2162088805393803286 group by v31;
create or replace view aggJoin1916507004997577270 as select v31, v32 from semiDown3623898473879187938 join aggView759873149958444101 using(v31);
create or replace view aggView6272635870317671214 as select v32, v31, MIN(v32) as v44 from aggJoin1916507004997577270 group by v32,v31;
create or replace view aggView6662475753340482626 as select v31, MIN(v44) as v44 from aggView6272635870317671214 group by v31,v44;
create or replace view aggJoin5418101540445546869 as select v1, v29, v44 from semiDown4387379098943727277 join aggView6662475753340482626 using(v31);
create or replace view aggView75697734277930330 as select v29 from semiDown3551852202507613769;
create or replace view aggJoin4710019809340932204 as select v1, v44 from aggJoin5418101540445546869 join aggView75697734277930330 using(v29);
create or replace view aggView2409978679148756792 as select v1, MIN(v44) as v44 from aggJoin4710019809340932204 group by v1,v44;
create or replace view aggJoin860441638248624205 as select v43 as v43, v44 from aggView6521829383007642459 join aggView2409978679148756792 using(v1);
create or replace view res as select MIN(v43) as v43, MIN(v44) as v44 from aggJoin860441638248624205;
select sum(v43+v44) from res;
