create or replace view semiUp8340165737877736841 as select movie_id as v31, company_id as v15, company_type_id as v22 from movie_companies AS mc where (company_type_id) in (select id from company_type AS ct);
create or replace view semiUp5415813578576802556 as select movie_id as v31, person_role_id as v1, role_id as v29 from cast_info AS ci where (movie_id) in (select id from title AS t where production_year>1990) and note LIKE '%(producer)%';
create or replace view semiUp8965234639904312327 as select v31, v15, v22 from semiUp8340165737877736841 where (v15) in (select id from company_name AS cn where country_code= '[us]');
create or replace view semiUp1350812698045157821 as select v31, v1, v29 from semiUp5415813578576802556 where (v1) in (select id from char_name AS chn);
create or replace view semiUp7927415394769788920 as select v31, v1, v29 from semiUp1350812698045157821 where (v29) in (select id from role_type AS rt);
create or replace view semiUp6449410484724803029 as select v31, v15, v22 from semiUp8965234639904312327 where (v31) in (select v31 from semiUp7927415394769788920);
create or replace view semiDown6224807111092730541 as select id as v22 from company_type AS ct where (id) in (select v22 from semiUp6449410484724803029);
create or replace view semiDown3366543713004548588 as select id as v15 from company_name AS cn where (id) in (select v15 from semiUp6449410484724803029) and country_code= '[us]';
create or replace view semiDown9181634431368947200 as select v31, v1, v29 from semiUp7927415394769788920 where (v31) in (select v31 from semiUp6449410484724803029);
create or replace view semiDown4093808405736646955 as select id as v29 from role_type AS rt where (id) in (select v29 from semiDown9181634431368947200);
create or replace view semiDown1882021751150701930 as select id as v31, title as v32 from title AS t where (id) in (select v31 from semiDown9181634431368947200) and production_year>1990;
create or replace view semiDown406557093557676433 as select id as v1, name as v2 from char_name AS chn where (id) in (select v1 from semiDown9181634431368947200);
create or replace view aggView805440277759207202 as select v31, v32 as v44 from semiDown1882021751150701930;
create or replace view aggJoin8002556574050883476 as select v31, v1, v29, v44 from semiDown9181634431368947200 join aggView805440277759207202 using(v31);
create or replace view aggView8930775345073972680 as select v1, v2 as v43 from semiDown406557093557676433;
create or replace view aggJoin5671257830115911091 as select v31, v29, v44, v43 from aggJoin8002556574050883476 join aggView8930775345073972680 using(v1);
create or replace view aggView7537670267879890723 as select v29 from semiDown4093808405736646955;
create or replace view aggJoin3263822430111536140 as select v31, v44, v43 from aggJoin5671257830115911091 join aggView7537670267879890723 using(v29);
create or replace view aggView5624997011418582106 as select v22 from semiDown6224807111092730541;
create or replace view aggJoin1152339988366932391 as select v31, v15 from semiUp6449410484724803029 join aggView5624997011418582106 using(v22);
create or replace view aggView1136174710979880023 as select v15 from semiDown3366543713004548588;
create or replace view aggJoin5507014189125386506 as select v31 from aggJoin1152339988366932391 join aggView1136174710979880023 using(v15);
create or replace view aggView3616282214564006647 as select v31, MIN(v44) as v44, MIN(v43) as v43 from aggJoin3263822430111536140 group by v31,v44,v43;
create or replace view aggJoin1476329332411676469 as select v44, v43 from aggJoin5507014189125386506 join aggView3616282214564006647 using(v31);
create or replace view res as select MIN(v43) as v43, MIN(v44) as v44 from aggJoin1476329332411676469;
select sum(v43+v44) from res;
