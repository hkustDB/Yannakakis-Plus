create or replace view semiUp6281329942934143665 as select movie_id as v24, keyword_id as v22 from movie_keyword AS mk where (keyword_id) in (select id from keyword AS k where keyword IN ('sequel','revenge','based-on-novel'));
create or replace view cnAux99 as select id as v17, name as v2 from company_name where country_code<> '[pl]';
create or replace view semiUp7369593507505585261 as select movie_id as v24, company_id as v17, company_type_id as v18, note as v19 from movie_companies AS mc where (company_type_id) in (select id from company_type AS ct where kind<> 'production companies');
create or replace view mcAux70 as select v24, v17, v19 from semiUp7369593507505585261;
create or replace view semiUp1073084719878641753 as select movie_id as v24, link_type_id as v13 from movie_link AS ml where (link_type_id) in (select id from link_type AS lt);
create or replace view semiUp5657409930449416981 as select v24, v22 from semiUp6281329942934143665 where (v24) in (select v24 from semiUp1073084719878641753);
create or replace view semiUp3243882890242097069 as select id as v24, title as v28 from title AS t where (id) in (select v24 from semiUp5657409930449416981) and production_year>1950;
create or replace view tAux59 as select v24, v28 from semiUp3243882890242097069;
create or replace view semiUp7358228579191565211 as select v24, v17, v19 from mcAux70 where (v24) in (select v24 from tAux59);
create or replace view semiUp3039753047081144668 as select v24, v17, v19 from semiUp7358228579191565211 where (v17) in (select v17 from cnAux99);
create or replace view semiDown6074891964261075184 as select v17, v2 from cnAux99 where (v17) in (select v17 from semiUp3039753047081144668);
create or replace view semiDown7521011240764575922 as select v24, v28 from tAux59 where (v24) in (select v24 from semiUp3039753047081144668);
create or replace view semiDown7739820705314937907 as select v24, v17, v18, v19 from semiUp7369593507505585261 where (v19, v17, v24) in (select v19, v17, v24 from semiUp3039753047081144668);
create or replace view semiDown7369062989866010485 as select id as v17, name as v2 from company_name AS cn where (id, name) in (select v17, v2 from semiDown6074891964261075184) and country_code<> '[pl]';
create or replace view semiDown178301645554182980 as select v24, v28 from semiUp3243882890242097069 where (v24, v28) in (select v24, v28 from semiDown7521011240764575922);
create or replace view semiDown3751326672144412009 as select id as v18 from company_type AS ct where (id) in (select v18 from semiDown7739820705314937907) and kind<> 'production companies';
create or replace view semiDown7792985538953980 as select v24, v22 from semiUp5657409930449416981 where (v24) in (select v24 from semiDown178301645554182980);
create or replace view semiDown4003438863545841010 as select id as v22 from keyword AS k where (id) in (select v22 from semiDown7792985538953980) and keyword IN ('sequel','revenge','based-on-novel');
create or replace view semiDown9113427024950114827 as select v24, v13 from semiUp1073084719878641753 where (v24) in (select v24 from semiDown7792985538953980);
create or replace view semiDown8478595694946585718 as select id as v13 from link_type AS lt where (id) in (select v13 from semiDown9113427024950114827);
create or replace view aggView599733494949695456 as select v17, v2, v2 as v39 from semiDown7369062989866010485;
create or replace view aggView3048934616127897678 as select v13 from semiDown8478595694946585718;
create or replace view aggJoin7280656436010949521 as select v24 from semiDown9113427024950114827 join aggView3048934616127897678 using(v13);
create or replace view aggView1720722243716697443 as select v24 from aggJoin7280656436010949521 group by v24;
create or replace view aggJoin1568932515417547766 as select v24, v22 from semiDown7792985538953980 join aggView1720722243716697443 using(v24);
create or replace view aggView7604287485712539625 as select v22 from semiDown4003438863545841010;
create or replace view aggJoin4468701142112948472 as select v24 from aggJoin1568932515417547766 join aggView7604287485712539625 using(v22);
create or replace view aggView2077274815306286780 as select v24 from aggJoin4468701142112948472 group by v24;
create or replace view aggJoin7459265006430770173 as select v24, v28 from semiDown178301645554182980 join aggView2077274815306286780 using(v24);
create or replace view aggView3147919529057719563 as select v24, v28, MIN(v28) as v41 from aggJoin7459265006430770173 group by v24,v28;
create or replace view aggView4259113067568693154 as select v18 from semiDown3751326672144412009;
create or replace view aggJoin7297190784289657123 as select v24, v17, v19 from semiDown7739820705314937907 join aggView4259113067568693154 using(v18);
create or replace view aggView6245017659181658023 as select v19, v17, v24, MIN(v19) as v40 from aggJoin7297190784289657123 group by v19,v17,v24;
create or replace view aggView4556439500096356016 as select v24, MIN(v41) as v41 from aggView3147919529057719563 group by v24,v41;
create or replace view aggJoin4899989550571458492 as select v17, v40 as v40, v41 from aggView6245017659181658023 join aggView4556439500096356016 using(v24);
create or replace view aggView6193041579650982514 as select v17, MIN(v39) as v39 from aggView599733494949695456 group by v17,v39;
create or replace view aggJoin6473309552623867875 as select v40 as v40, v41 as v41, v39 from aggJoin4899989550571458492 join aggView6193041579650982514 using(v17);
create or replace view res as select MIN(v39) as v39, MIN(v40) as v40, MIN(v41) as v41 from aggJoin6473309552623867875;
select sum(v39+v40+v41) from res;
