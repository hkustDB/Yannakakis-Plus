create or replace view tAux83 as select id as v24, title as v28 from title where production_year>1950;
create or replace view cnAux55 as select id as v17, name as v2 from company_name where country_code<> '[pl]';
create or replace view semiUp5159164599860862389 as select movie_id as v24, company_id as v17, company_type_id as v18, note as v19 from movie_companies AS mc where (company_type_id) in (select id from company_type AS ct where kind<> 'production companies');
create or replace view semiUp2561814962147632153 as select movie_id as v24, keyword_id as v22 from movie_keyword AS mk where (keyword_id) in (select id from keyword AS k where keyword IN ('sequel','revenge','based-on-novel'));
create or replace view semiUp6478441749715596421 as select movie_id as v24, link_type_id as v13 from movie_link AS ml where (link_type_id) in (select id from link_type AS lt);
create or replace view semiUp6894555717873947556 as select v24, v13 from semiUp6478441749715596421 where (v24) in (select v24 from semiUp2561814962147632153);
create or replace view semiUp6489317332826872967 as select v24, v17, v18, v19 from semiUp5159164599860862389 where (v24) in (select v24 from semiUp6894555717873947556);
create or replace view mcAux11 as select v24, v17, v19 from semiUp6489317332826872967;
create or replace view semiUp8075225219096004946 as select v24, v17, v19 from mcAux11 where (v17) in (select v17 from cnAux55);
create or replace view semiUp6899666325244263740 as select v24, v17, v19 from semiUp8075225219096004946 where (v24) in (select v24 from tAux83);
create or replace view semiDown7005853569542856284 as select v17, v2 from cnAux55 where (v17) in (select v17 from semiUp6899666325244263740);
create or replace view semiDown6700610092314021343 as select v24, v28 from tAux83 where (v24) in (select v24 from semiUp6899666325244263740);
create or replace view semiDown829848552639481173 as select v24, v17, v18, v19 from semiUp6489317332826872967 where (v19, v17, v24) in (select v19, v17, v24 from semiUp6899666325244263740);
create or replace view semiDown2480643145355940701 as select id as v17, name as v2 from company_name AS cn where (id, name) in (select v17, v2 from semiDown7005853569542856284) and country_code<> '[pl]';
create or replace view semiDown4703718228805803701 as select id as v24, title as v28 from title AS t where (id, title) in (select v24, v28 from semiDown6700610092314021343) and production_year>1950;
create or replace view semiDown2439943401143940527 as select id as v18 from company_type AS ct where (id) in (select v18 from semiDown829848552639481173) and kind<> 'production companies';
create or replace view semiDown3833069323972967114 as select v24, v13 from semiUp6894555717873947556 where (v24) in (select v24 from semiDown829848552639481173);
create or replace view semiDown253911196602490164 as select id as v13 from link_type AS lt where (id) in (select v13 from semiDown3833069323972967114);
create or replace view semiDown3780930280774037285 as select v24, v22 from semiUp2561814962147632153 where (v24) in (select v24 from semiDown3833069323972967114);
create or replace view semiDown2139965817843253527 as select id as v22 from keyword AS k where (id) in (select v22 from semiDown3780930280774037285) and keyword IN ('sequel','revenge','based-on-novel');
create or replace view aggView8018862421798506886 as select v17, v2, v2 as v39 from semiDown2480643145355940701;
create or replace view aggView834872388313185633 as select v24, v28, v28 as v41 from semiDown4703718228805803701;
create or replace view aggView8649757049568149456 as select v22 from semiDown2139965817843253527;
create or replace view aggJoin151510648488219008 as select v24 from semiDown3780930280774037285 join aggView8649757049568149456 using(v22);
create or replace view aggView6197075506509397658 as select v24 from aggJoin151510648488219008 group by v24;
create or replace view aggJoin2552812283748531323 as select v24, v13 from semiDown3833069323972967114 join aggView6197075506509397658 using(v24);
create or replace view aggView8029542776382228109 as select v13 from semiDown253911196602490164;
create or replace view aggJoin8504451169297560813 as select v24 from aggJoin2552812283748531323 join aggView8029542776382228109 using(v13);
create or replace view aggView3346475003859227106 as select v24 from aggJoin8504451169297560813 group by v24;
create or replace view aggJoin7251989854328156077 as select v24, v17, v18, v19 from semiDown829848552639481173 join aggView3346475003859227106 using(v24);
create or replace view aggView4360234365794326237 as select v18 from semiDown2439943401143940527;
create or replace view aggJoin6305815559437057299 as select v24, v17, v19 from aggJoin7251989854328156077 join aggView4360234365794326237 using(v18);
create or replace view aggView1054538567249082858 as select v19, v17, v24, MIN(v19) as v40 from aggJoin6305815559437057299 group by v19,v17,v24;
create or replace view aggView7296075860534232956 as select v17, MIN(v39) as v39 from aggView8018862421798506886 group by v17,v39;
create or replace view aggJoin7648503655396542682 as select v24, v40 as v40, v39 from aggView1054538567249082858 join aggView7296075860534232956 using(v17);
create or replace view aggView6772048076366708814 as select v24, MIN(v41) as v41 from aggView834872388313185633 group by v24,v41;
create or replace view aggJoin5492217917867544568 as select v40 as v40, v39 as v39, v41 from aggJoin7648503655396542682 join aggView6772048076366708814 using(v24);
create or replace view res as select MIN(v39) as v39, MIN(v40) as v40, MIN(v41) as v41 from aggJoin5492217917867544568;
select sum(v39+v40+v41) from res;
