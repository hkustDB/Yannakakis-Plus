create or replace view semiUp916895108985747023 as select movie_id as v24, company_id as v17, company_type_id as v18, note as v19 from movie_companies AS mc where (company_type_id) in (select id from company_type AS ct where kind<> 'production companies');
create or replace view semiUp7962246327940177454 as select v24, v17, v18, v19 from semiUp916895108985747023 where (v17) in (select id from company_name AS cn where country_code<> '[pl]');
create or replace view semiUp6702541022157848675 as select movie_id as v24, link_type_id as v13 from movie_link AS ml where (link_type_id) in (select id from link_type AS lt);
create or replace view semiUp5288904628714881871 as select v24, v13 from semiUp6702541022157848675 where (v24) in (select v24 from semiUp7962246327940177454);
create or replace view semiUp8596411946238132870 as select id as v24, title as v28 from title AS t where (id) in (select v24 from semiUp5288904628714881871) and production_year>1950;
create or replace view semiUp7302070428579970705 as select movie_id as v24, keyword_id as v22 from movie_keyword AS mk where (keyword_id) in (select id from keyword AS k where keyword IN ('sequel','revenge','based-on-novel'));
create or replace view semiUp3429733071051919219 as select v24, v22 from semiUp7302070428579970705 where (v24) in (select v24 from semiUp8596411946238132870);
create or replace view semiDown3133130723094046711 as select id as v22 from keyword AS k where (id) in (select v22 from semiUp3429733071051919219) and keyword IN ('sequel','revenge','based-on-novel');
create or replace view semiDown7799987696758063245 as select v24, v28 from semiUp8596411946238132870 where (v24) in (select v24 from semiUp3429733071051919219);
create or replace view semiDown7572312918540085603 as select v24, v13 from semiUp5288904628714881871 where (v24) in (select v24 from semiDown7799987696758063245);
create or replace view semiDown4195375349981131805 as select id as v13 from link_type AS lt where (id) in (select v13 from semiDown7572312918540085603);
create or replace view semiDown8841427728992396690 as select v24, v17, v18, v19 from semiUp7962246327940177454 where (v24) in (select v24 from semiDown7572312918540085603);
create or replace view semiDown1326053387434826947 as select id as v18 from company_type AS ct where (id) in (select v18 from semiDown8841427728992396690) and kind<> 'production companies';
create or replace view semiDown3435616994483790787 as select id as v17, name as v2 from company_name AS cn where (id) in (select v17 from semiDown8841427728992396690) and country_code<> '[pl]';
create or replace view aggView1522879610628224604 as select v17, v2 as v39 from semiDown3435616994483790787;
create or replace view aggJoin4630966645520580784 as select v24, v18, v19, v39 from semiDown8841427728992396690 join aggView1522879610628224604 using(v17);
create or replace view aggView7183776283960386485 as select v18 from semiDown1326053387434826947;
create or replace view aggJoin8406793689215401625 as select v24, v19, v39 from aggJoin4630966645520580784 join aggView7183776283960386485 using(v18);
create or replace view aggView5704869054233497783 as select v24, MIN(v39) as v39, MIN(v19) as v40 from aggJoin8406793689215401625 group by v24,v39;
create or replace view aggJoin4148853275021947248 as select v24, v13, v39, v40 from semiDown7572312918540085603 join aggView5704869054233497783 using(v24);
create or replace view aggView8321003823758906165 as select v13 from semiDown4195375349981131805;
create or replace view aggJoin5650500769770598143 as select v24, v39, v40 from aggJoin4148853275021947248 join aggView8321003823758906165 using(v13);
create or replace view aggView8941647305778482209 as select v24, MIN(v39) as v39, MIN(v40) as v40 from aggJoin5650500769770598143 group by v24,v39,v40;
create or replace view aggJoin4710266762833131680 as select v24, v28, v39, v40 from semiDown7799987696758063245 join aggView8941647305778482209 using(v24);
create or replace view aggView1989718381183474551 as select v24, MIN(v39) as v39, MIN(v40) as v40, MIN(v28) as v41 from aggJoin4710266762833131680 group by v24,v39,v40;
create or replace view aggJoin1026575768802239066 as select v22, v39, v40, v41 from semiUp3429733071051919219 join aggView1989718381183474551 using(v24);
create or replace view aggView5625360919555907835 as select v22 from semiDown3133130723094046711;
create or replace view aggJoin8084140519904041641 as select v39, v40, v41 from aggJoin1026575768802239066 join aggView5625360919555907835 using(v22);
create or replace view res as select MIN(v39) as v39, MIN(v40) as v40, MIN(v41) as v41 from aggJoin8084140519904041641;
select sum(v39+v40+v41) from res;
