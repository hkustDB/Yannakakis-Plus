create or replace view cnAux66 as select id as v17, name as v2 from company_name where country_code<> '[pl]';
create or replace view semiUp1552251317301308832 as select movie_id as v24, link_type_id as v13 from movie_link AS ml where (link_type_id) in (select id from link_type AS lt);
create or replace view tAux11 as select id as v24, title as v28 from title where production_year>1950;
create or replace view semiUp775360761506178416 as select movie_id as v24, company_id as v17, company_type_id as v18, note as v19 from movie_companies AS mc where (company_type_id) in (select id from company_type AS ct where kind<> 'production companies');
create or replace view semiUp5893415929690496951 as select movie_id as v24, keyword_id as v22 from movie_keyword AS mk where (keyword_id) in (select id from keyword AS k where keyword IN ('sequel','revenge','based-on-novel'));
create or replace view semiUp5311131418405354928 as select v24, v17, v18, v19 from semiUp775360761506178416 where (v24) in (select v24 from semiUp1552251317301308832);
create or replace view semiUp9066736399015556230 as select v24, v17, v18, v19 from semiUp5311131418405354928 where (v24) in (select v24 from semiUp5893415929690496951);
create or replace view mcAux40 as select v24, v17, v19 from semiUp9066736399015556230;
create or replace view semiUp6683532357767025350 as select v24, v17, v19 from mcAux40 where (v17) in (select v17 from cnAux66);
create or replace view semiUp6866218700767004615 as select v24, v17, v19 from semiUp6683532357767025350 where (v24) in (select v24 from tAux11);
create or replace view semiDown4467045500166110475 as select v17, v2 from cnAux66 where (v17) in (select v17 from semiUp6866218700767004615);
create or replace view semiDown2068622959873381748 as select v24, v28 from tAux11 where (v24) in (select v24 from semiUp6866218700767004615);
create or replace view semiDown3510291609560286156 as select v24, v17, v18, v19 from semiUp9066736399015556230 where (v19, v17, v24) in (select v19, v17, v24 from semiUp6866218700767004615);
create or replace view semiDown3503707918301643894 as select id as v17, name as v2 from company_name AS cn where (id, name) in (select v17, v2 from semiDown4467045500166110475) and country_code<> '[pl]';
create or replace view semiDown270411423497799084 as select id as v24, title as v28 from title AS t where (id, title) in (select v24, v28 from semiDown2068622959873381748) and production_year>1950;
create or replace view semiDown2938089897690686142 as select id as v18 from company_type AS ct where (id) in (select v18 from semiDown3510291609560286156) and kind<> 'production companies';
create or replace view semiDown2378815998128256829 as select v24, v13 from semiUp1552251317301308832 where (v24) in (select v24 from semiDown3510291609560286156);
create or replace view semiDown6575703411957172166 as select v24, v22 from semiUp5893415929690496951 where (v24) in (select v24 from semiDown3510291609560286156);
create or replace view semiDown1053399956278439995 as select id as v13 from link_type AS lt where (id) in (select v13 from semiDown2378815998128256829);
create or replace view semiDown3380660134603793067 as select id as v22 from keyword AS k where (id) in (select v22 from semiDown6575703411957172166) and keyword IN ('sequel','revenge','based-on-novel');
create or replace view aggView8397124847422708910 as select v24, v28, v28 as v41 from semiDown270411423497799084;
create or replace view aggView4001943326725413135 as select v17, v2, v2 as v39 from semiDown3503707918301643894;
create or replace view aggView6160051096536986582 as select v22 from semiDown3380660134603793067;
create or replace view aggJoin2704389070475195221 as select v24 from semiDown6575703411957172166 join aggView6160051096536986582 using(v22);
create or replace view aggView4097834241523549137 as select v13 from semiDown1053399956278439995;
create or replace view aggJoin8586181075840915286 as select v24 from semiDown2378815998128256829 join aggView4097834241523549137 using(v13);
create or replace view aggView4635427521523035995 as select v24 from aggJoin8586181075840915286 group by v24;
create or replace view aggJoin2111042234506099340 as select v24, v17, v18, v19 from semiDown3510291609560286156 join aggView4635427521523035995 using(v24);
create or replace view aggView463347208800004535 as select v24 from aggJoin2704389070475195221 group by v24;
create or replace view aggJoin7991070636034717428 as select v24, v17, v18, v19 from aggJoin2111042234506099340 join aggView463347208800004535 using(v24);
create or replace view aggView196292426895655563 as select v18 from semiDown2938089897690686142;
create or replace view aggJoin6457221174159321870 as select v24, v17, v19 from aggJoin7991070636034717428 join aggView196292426895655563 using(v18);
create or replace view aggView8118924203758920947 as select v19, v17, v24, MIN(v19) as v40 from aggJoin6457221174159321870 group by v19,v17,v24;
create or replace view aggView9027296810019510066 as select v24, MIN(v41) as v41 from aggView8397124847422708910 group by v24,v41;
create or replace view aggJoin5193950206018225010 as select v17, v40 as v40, v41 from aggView8118924203758920947 join aggView9027296810019510066 using(v24);
create or replace view aggView6947685483691759641 as select v17, MIN(v39) as v39 from aggView4001943326725413135 group by v17,v39;
create or replace view aggJoin6839782695138173872 as select v40 as v40, v41 as v41, v39 from aggJoin5193950206018225010 join aggView6947685483691759641 using(v17);
create or replace view res as select MIN(v39) as v39, MIN(v40) as v40, MIN(v41) as v41 from aggJoin6839782695138173872;
select sum(v39+v40+v41) from res;
