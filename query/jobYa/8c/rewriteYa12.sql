create or replace view semiUp1618715872334946291 as select id as v2 from name AS n1 where (id) in (select person_id from aka_name AS an);
create or replace view semiUp4444773746440733381 as select movie_id as v11, company_id as v25 from movie_companies AS mc where (company_id) in (select id from company_name AS cn where country_code= '[us]');
create or replace view semiUp5712798411300574008 as select person_id as v2, movie_id as v11, role_id as v15 from cast_info AS ci where (movie_id) in (select id from title AS t);
create or replace view semiUp3465435727043384605 as select v2, v11, v15 from semiUp5712798411300574008 where (v11) in (select v11 from semiUp4444773746440733381);
create or replace view semiUp5177897971112256842 as select v2, v11, v15 from semiUp3465435727043384605 where (v2) in (select v2 from semiUp1618715872334946291);
create or replace view semiUp4046346487985701654 as select v2, v11, v15 from semiUp5177897971112256842 where (v15) in (select id from role_type AS rt where role= 'writer');
create or replace view semiDown4095464143776008132 as select id as v15 from role_type AS rt where (id) in (select v15 from semiUp4046346487985701654) and role= 'writer';
create or replace view semiDown2906815104102114790 as select id as v11, title as v40 from title AS t where (id) in (select v11 from semiUp4046346487985701654);
create or replace view semiDown8619714008455595848 as select v11, v25 from semiUp4444773746440733381 where (v11) in (select v11 from semiUp4046346487985701654);
create or replace view semiDown2975172077324195521 as select v2 from semiUp1618715872334946291 where (v2) in (select v2 from semiUp4046346487985701654);
create or replace view semiDown3781025959054992656 as select id as v25 from company_name AS cn where (id) in (select v25 from semiDown8619714008455595848) and country_code= '[us]';
create or replace view semiDown3366352066159034192 as select person_id as v2, name as v3 from aka_name AS an where (person_id) in (select v2 from semiDown2975172077324195521);
create or replace view aggView4849003690993022449 as select v25 from semiDown3781025959054992656;
create or replace view aggJoin2848456734066774904 as select v11 from semiDown8619714008455595848 join aggView4849003690993022449 using(v25);
create or replace view aggView4589774678452398557 as select v2, MIN(v3) as v51 from semiDown3366352066159034192 group by v2;
create or replace view aggJoin8767480120011870688 as select v2, v51 from semiDown2975172077324195521 join aggView4589774678452398557 using(v2);
create or replace view aggView4305434659634022227 as select v11, v40 as v52 from semiDown2906815104102114790;
create or replace view aggJoin2814468478800499266 as select v2, v11, v15, v52 from semiUp4046346487985701654 join aggView4305434659634022227 using(v11);
create or replace view aggView5984513443219054419 as select v11 from aggJoin2848456734066774904 group by v11;
create or replace view aggJoin3211549883739176819 as select v2, v15, v52 as v52 from aggJoin2814468478800499266 join aggView5984513443219054419 using(v11);
create or replace view aggView3394498006173495496 as select v15 from semiDown4095464143776008132;
create or replace view aggJoin8985657942974954096 as select v2, v52 from aggJoin3211549883739176819 join aggView3394498006173495496 using(v15);
create or replace view aggView2339676140851723655 as select v2, MIN(v51) as v51 from aggJoin8767480120011870688 group by v2,v51;
create or replace view aggJoin2659494532629149175 as select v52 as v52, v51 from aggJoin8985657942974954096 join aggView2339676140851723655 using(v2);
create or replace view res as select MIN(v51) as v51, MIN(v52) as v52 from aggJoin2659494532629149175;
select sum(v51+v52) from res;
