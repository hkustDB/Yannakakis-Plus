create or replace view tAux57 as select id as v29, title as v30 from title where production_year>=2000 and production_year<=2010;
create or replace view semiUp4011523817609439279 as select movie_id as v29, info_type_id as v26, info as v27 from movie_info_idx AS mi_idx where (info_type_id) in (select id from info_type AS it2 where info= 'rating');
create or replace view mi_idxAux60 as select v29, v27 from semiUp4011523817609439279;
create or replace view cnAux30 as select id as v1, name as v2 from company_name where country_code= '[us]';
create or replace view semiUp2129932538261069427 as select movie_id as v29, company_id as v1, company_type_id as v8 from movie_companies AS mc where (movie_id) in (select v29 from tAux57);
create or replace view semiUp238320252121301159 as select v29, v1, v8 from semiUp2129932538261069427 where (v8) in (select id from company_type AS ct where kind= 'production companies');
create or replace view semiUp2034750666557462246 as select movie_id as v29, info_type_id as v21 from movie_info AS mi where (info_type_id) in (select id from info_type AS it1 where info= 'genres') and info IN ('Drama','Horror','Western','Family');
create or replace view semiUp2154193769282029037 as select v29, v1, v8 from semiUp238320252121301159 where (v29) in (select v29 from semiUp2034750666557462246);
create or replace view semiUp4991002401111094425 as select v29, v1, v8 from semiUp2154193769282029037 where (v29) in (select v29 from mi_idxAux60);
create or replace view semiUp4286605238564101347 as select v1, v2 from cnAux30 where (v1) in (select v1 from semiUp4991002401111094425);
create or replace view semiDown6373654472235777221 as select id as v1, name as v2 from company_name AS cn where (name, id) in (select v2, v1 from semiUp4286605238564101347) and country_code= '[us]';
create or replace view semiDown404479196991288555 as select v29, v1, v8 from semiUp4991002401111094425 where (v1) in (select v1 from semiUp4286605238564101347);
create or replace view semiDown7722133314760021941 as select id as v8 from company_type AS ct where (id) in (select v8 from semiDown404479196991288555) and kind= 'production companies';
create or replace view semiDown173544185054748325 as select v29, v27 from mi_idxAux60 where (v29) in (select v29 from semiDown404479196991288555);
create or replace view semiDown4080920705793426098 as select v29, v21 from semiUp2034750666557462246 where (v29) in (select v29 from semiDown404479196991288555);
create or replace view semiDown5747298807621193465 as select v29, v30 from tAux57 where (v29) in (select v29 from semiDown404479196991288555);
create or replace view semiDown9063906276427521354 as select v29, v26, v27 from semiUp4011523817609439279 where (v27, v29) in (select v27, v29 from semiDown173544185054748325);
create or replace view semiDown604941948457734458 as select id as v21 from info_type AS it1 where (id) in (select v21 from semiDown4080920705793426098) and info= 'genres';
create or replace view semiDown7674711475301869623 as select id as v29, title as v30 from title AS t where (id, title) in (select v29, v30 from semiDown5747298807621193465) and production_year>=2000 and production_year<=2010;
create or replace view semiDown995727358463079379 as select id as v26 from info_type AS it2 where (id) in (select v26 from semiDown9063906276427521354) and info= 'rating';
create or replace view aggView707616648697115925 as select v29, v30, v30 as v43 from semiDown7674711475301869623;
create or replace view aggView8529600681519942829 as select v2, v1, v2 as v41 from semiDown6373654472235777221;
create or replace view aggView1683960803561672425 as select v26 from semiDown995727358463079379;
create or replace view aggJoin5155370801787724199 as select v29, v27 from semiDown9063906276427521354 join aggView1683960803561672425 using(v26);
create or replace view aggView1264521854215593750 as select v27, v29, MIN(v27) as v42 from aggJoin5155370801787724199 group by v27,v29;
create or replace view aggView3738327482554945243 as select v21 from semiDown604941948457734458;
create or replace view aggJoin7279368566433440806 as select v29 from semiDown4080920705793426098 join aggView3738327482554945243 using(v21);
create or replace view aggView7817611031544047506 as select v8 from semiDown7722133314760021941;
create or replace view aggJoin9119980183841156459 as select v29, v1 from semiDown404479196991288555 join aggView7817611031544047506 using(v8);
create or replace view aggView4654377890192787682 as select v29 from aggJoin7279368566433440806 group by v29;
create or replace view aggJoin253911403910145875 as select v29, v1 from aggJoin9119980183841156459 join aggView4654377890192787682 using(v29);
create or replace view aggView7810742654837103835 as select v29, MIN(v42) as v42 from aggView1264521854215593750 group by v29,v42;
create or replace view aggJoin7034209732265308592 as select v29, v1, v42 from aggJoin253911403910145875 join aggView7810742654837103835 using(v29);
create or replace view aggView4454406005221661436 as select v29, MIN(v43) as v43 from aggView707616648697115925 group by v29,v43;
create or replace view aggJoin6774034338384555202 as select v1, v42 as v42, v43 from aggJoin7034209732265308592 join aggView4454406005221661436 using(v29);
create or replace view aggView1013037702513147018 as select v1, MIN(v42) as v42, MIN(v43) as v43 from aggJoin6774034338384555202 group by v1,v42,v43;
create or replace view aggJoin882582079223559476 as select v41 as v41, v42, v43 from aggView8529600681519942829 join aggView1013037702513147018 using(v1);
create or replace view res as select MIN(v41) as v41, MIN(v42) as v42, MIN(v43) as v43 from aggJoin882582079223559476;
select sum(v41+v42+v43) from res;
