create or replace view semiUp3387512627648741275 as select movie_id as v29, company_id as v1, company_type_id as v8 from movie_companies AS mc where (company_id) in (select id from company_name AS cn where country_code= '[us]');
create or replace view semiUp8666908033094166147 as select movie_id as v29, info_type_id as v26, info as v27 from movie_info_idx AS mi_idx where (info_type_id) in (select id from info_type AS it2 where info= 'rating') and info>'7.0';
create or replace view semiUp6081321989314530801 as select movie_id as v29, info_type_id as v21 from movie_info AS mi where (info_type_id) in (select id from info_type AS it1 where info= 'genres') and info IN ('Drama','Horror','Western','Family');
create or replace view semiUp2416460862595496581 as select v29, v1, v8 from semiUp3387512627648741275 where (v8) in (select id from company_type AS ct where kind= 'production companies');
create or replace view semiUp6028924127653097239 as select id as v29, title as v30 from title AS t where (id) in (select v29 from semiUp8666908033094166147) and production_year>=2000 and production_year<=2010;
create or replace view semiUp6967069103369027739 as select v29, v21 from semiUp6081321989314530801 where (v29) in (select v29 from semiUp6028924127653097239);
create or replace view semiUp443756700760154393 as select v29, v1, v8 from semiUp2416460862595496581 where (v29) in (select v29 from semiUp6967069103369027739);
create or replace view semiDown8741950132590414963 as select id as v8 from company_type AS ct where (id) in (select v8 from semiUp443756700760154393) and kind= 'production companies';
create or replace view semiDown2304607160724825449 as select id as v1, name as v2 from company_name AS cn where (id) in (select v1 from semiUp443756700760154393) and country_code= '[us]';
create or replace view semiDown6594307601499467955 as select v29, v21 from semiUp6967069103369027739 where (v29) in (select v29 from semiUp443756700760154393);
create or replace view semiDown6484797444859327272 as select id as v21 from info_type AS it1 where (id) in (select v21 from semiDown6594307601499467955) and info= 'genres';
create or replace view semiDown4729054053050578635 as select v29, v30 from semiUp6028924127653097239 where (v29) in (select v29 from semiDown6594307601499467955);
create or replace view semiDown1108204890988227744 as select v29, v26, v27 from semiUp8666908033094166147 where (v29) in (select v29 from semiDown4729054053050578635);
create or replace view semiDown58403265059786386 as select id as v26 from info_type AS it2 where (id) in (select v26 from semiDown1108204890988227744) and info= 'rating';
create or replace view aggView7884392558999082111 as select v26 from semiDown58403265059786386;
create or replace view aggJoin8940588389817175101 as select v29, v27 from semiDown1108204890988227744 join aggView7884392558999082111 using(v26);
create or replace view aggView1419021381437306861 as select v29, MIN(v27) as v42 from aggJoin8940588389817175101 group by v29;
create or replace view aggJoin1200758495724174853 as select v29, v30, v42 from semiDown4729054053050578635 join aggView1419021381437306861 using(v29);
create or replace view aggView8207154887936687771 as select v21 from semiDown6484797444859327272;
create or replace view aggJoin1316249658929533578 as select v29 from semiDown6594307601499467955 join aggView8207154887936687771 using(v21);
create or replace view aggView4035273852783689767 as select v29, MIN(v42) as v42, MIN(v30) as v43 from aggJoin1200758495724174853 group by v29,v42;
create or replace view aggJoin3722639523642780311 as select v29, v42, v43 from aggJoin1316249658929533578 join aggView4035273852783689767 using(v29);
create or replace view aggView7638937277007368069 as select v8 from semiDown8741950132590414963;
create or replace view aggJoin5098019776659091404 as select v29, v1 from semiUp443756700760154393 join aggView7638937277007368069 using(v8);
create or replace view aggView5308761206041589581 as select v29, MIN(v42) as v42, MIN(v43) as v43 from aggJoin3722639523642780311 group by v29,v42,v43;
create or replace view aggJoin5756401769369364777 as select v1, v42, v43 from aggJoin5098019776659091404 join aggView5308761206041589581 using(v29);
create or replace view aggView6590123648052164014 as select v1, v2 as v41 from semiDown2304607160724825449;
create or replace view aggJoin7228145872054783364 as select v42, v43, v41 from aggJoin5756401769369364777 join aggView6590123648052164014 using(v1);
create or replace view res as select MIN(v41) as v41, MIN(v42) as v42, MIN(v43) as v43 from aggJoin7228145872054783364;
select sum(v41+v42+v43) from res;
