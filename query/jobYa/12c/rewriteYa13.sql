create or replace view tAux64 as select id as v29, title as v30 from title where production_year>=2000 and production_year<=2010;
create or replace view cnAux2 as select id as v1, name as v2 from company_name where country_code= '[us]';
create or replace view semiUp2281064396281014650 as select movie_id as v29, info_type_id as v21 from movie_info AS mi where (info_type_id) in (select id from info_type AS it1 where info= 'genres') and info IN ('Drama','Horror','Western','Family');
create or replace view semiUp793348121595349508 as select movie_id as v29, info_type_id as v26, info as v27 from movie_info_idx AS mi_idx where (info_type_id) in (select id from info_type AS it2 where info= 'rating');
create or replace view semiUp8189808218540167981 as select v29, v26, v27 from semiUp793348121595349508 where (v29) in (select v29 from semiUp2281064396281014650);
create or replace view mi_idxAux42 as select v29, v27 from semiUp8189808218540167981;
create or replace view semiUp6509401331982901780 as select movie_id as v29, company_id as v1, company_type_id as v8 from movie_companies AS mc where (company_id) in (select v1 from cnAux2);
create or replace view semiUp3083355491079371884 as select v29, v1, v8 from semiUp6509401331982901780 where (v29) in (select v29 from tAux64);
create or replace view semiUp538608334009327433 as select v29, v1, v8 from semiUp3083355491079371884 where (v8) in (select id from company_type AS ct where kind= 'production companies');
create or replace view semiUp5457711212589042801 as select v29, v27 from mi_idxAux42 where (v29) in (select v29 from semiUp538608334009327433);
create or replace view semiDown8727019043813993637 as select v29, v26, v27 from semiUp8189808218540167981 where (v27, v29) in (select v27, v29 from semiUp5457711212589042801);
create or replace view semiDown7262245152838740938 as select v29, v1, v8 from semiUp538608334009327433 where (v29) in (select v29 from semiUp5457711212589042801);
create or replace view semiDown7591087132737532989 as select id as v26 from info_type AS it2 where (id) in (select v26 from semiDown8727019043813993637) and info= 'rating';
create or replace view semiDown2680677178080865765 as select v29, v21 from semiUp2281064396281014650 where (v29) in (select v29 from semiDown8727019043813993637);
create or replace view semiDown6748084882029505613 as select id as v8 from company_type AS ct where (id) in (select v8 from semiDown7262245152838740938) and kind= 'production companies';
create or replace view semiDown5093489029754349570 as select v1, v2 from cnAux2 where (v1) in (select v1 from semiDown7262245152838740938);
create or replace view semiDown1780923683355084702 as select v29, v30 from tAux64 where (v29) in (select v29 from semiDown7262245152838740938);
create or replace view semiDown8431083013425727032 as select id as v21 from info_type AS it1 where (id) in (select v21 from semiDown2680677178080865765) and info= 'genres';
create or replace view semiDown6324833437419403401 as select id as v1, name as v2 from company_name AS cn where (name, id) in (select v2, v1 from semiDown5093489029754349570) and country_code= '[us]';
create or replace view semiDown7788527680911732762 as select id as v29, title as v30 from title AS t where (id, title) in (select v29, v30 from semiDown1780923683355084702) and production_year>=2000 and production_year<=2010;
create or replace view aggView8497661863812246327 as select v2, v1, v2 as v41 from semiDown6324833437419403401;
create or replace view aggView5188557157949916391 as select v29, v30, v30 as v43 from semiDown7788527680911732762;
create or replace view aggView217244487316119291 as select v21 from semiDown8431083013425727032;
create or replace view aggJoin5972655622668977481 as select v29 from semiDown2680677178080865765 join aggView217244487316119291 using(v21);
create or replace view aggView1699782180431431570 as select v26 from semiDown7591087132737532989;
create or replace view aggJoin596558681112103944 as select v29, v27 from semiDown8727019043813993637 join aggView1699782180431431570 using(v26);
create or replace view aggView2088444261828319253 as select v29 from aggJoin5972655622668977481 group by v29;
create or replace view aggJoin3600447621411262850 as select v29, v27 from aggJoin596558681112103944 join aggView2088444261828319253 using(v29);
create or replace view aggView1558707171422838039 as select v27, v29, MIN(v27) as v42 from aggJoin3600447621411262850 group by v27,v29;
create or replace view aggView324812267837150497 as select v8 from semiDown6748084882029505613;
create or replace view aggJoin2123568785817647829 as select v29, v1 from semiDown7262245152838740938 join aggView324812267837150497 using(v8);
create or replace view aggView7795434522233310872 as select v29, MIN(v43) as v43 from aggView5188557157949916391 group by v29,v43;
create or replace view aggJoin7770180699254103215 as select v29, v1, v43 from aggJoin2123568785817647829 join aggView7795434522233310872 using(v29);
create or replace view aggView6910811563512978382 as select v1, MIN(v41) as v41 from aggView8497661863812246327 group by v1,v41;
create or replace view aggJoin3641461411004927024 as select v29, v43 as v43, v41 from aggJoin7770180699254103215 join aggView6910811563512978382 using(v1);
create or replace view aggView7381367313218548250 as select v29, MIN(v43) as v43, MIN(v41) as v41 from aggJoin3641461411004927024 group by v29,v41,v43;
create or replace view aggJoin4135167364812998731 as select v42 as v42, v43, v41 from aggView1558707171422838039 join aggView7381367313218548250 using(v29);
create or replace view res as select MIN(v41) as v41, MIN(v42) as v42, MIN(v43) as v43 from aggJoin4135167364812998731;
select sum(v41+v42+v43) from res;
