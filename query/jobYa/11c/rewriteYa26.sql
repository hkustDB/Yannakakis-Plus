create or replace view cnAux52 as select id as v17, name as v2 from company_name where country_code<> '[pl]' and ((name LIKE '20th Century Fox%') OR (name LIKE 'Twentieth Century Fox%'));
create or replace view semiUp8108037373260583347 as select movie_id as v24, keyword_id as v22 from movie_keyword AS mk where (keyword_id) in (select id from keyword AS k where keyword IN ('sequel','revenge','based-on-novel'));
create or replace view semiUp7310607500150931411 as select movie_id as v24, link_type_id as v13 from movie_link AS ml where (link_type_id) in (select id from link_type AS lt);
create or replace view semiUp5807395215278622298 as select movie_id as v24, company_id as v17, company_type_id as v18, note as v19 from movie_companies AS mc where (company_type_id) in (select id from company_type AS ct where kind<> 'production companies');
create or replace view mcAux57 as select v24, v17, v19 from semiUp5807395215278622298;
create or replace view semiUp317550513222013129 as select id as v24, title as v28 from title AS t where (id) in (select v24 from semiUp8108037373260583347) and production_year>1950;
create or replace view semiUp586348337593308736 as select v24, v28 from semiUp317550513222013129 where (v24) in (select v24 from semiUp7310607500150931411);
create or replace view tAux21 as select v24, v28 from semiUp586348337593308736;
create or replace view semiUp1578506052856355209 as select v24, v17, v19 from mcAux57 where (v17) in (select v17 from cnAux52);
create or replace view semiUp5736033954248912050 as select v24, v17, v19 from semiUp1578506052856355209 where (v24) in (select v24 from tAux21);
create or replace view semiDown4864528752480725631 as select v17, v2 from cnAux52 where (v17) in (select v17 from semiUp5736033954248912050);
create or replace view semiDown5333755391082059744 as select v24, v28 from tAux21 where (v24) in (select v24 from semiUp5736033954248912050);
create or replace view semiDown4348151145798024777 as select v24, v17, v18, v19 from semiUp5807395215278622298 where (v19, v17, v24) in (select v19, v17, v24 from semiUp5736033954248912050);
create or replace view semiDown526365375658621999 as select id as v17, name as v2 from company_name AS cn where (name, id) in (select v2, v17 from semiDown4864528752480725631) and country_code<> '[pl]' and ((name LIKE '20th Century Fox%') OR (name LIKE 'Twentieth Century Fox%'));
create or replace view semiDown6500753929790904418 as select v24, v28 from semiUp586348337593308736 where (v28, v24) in (select v28, v24 from semiDown5333755391082059744);
create or replace view semiDown2822772278809015493 as select id as v18 from company_type AS ct where (id) in (select v18 from semiDown4348151145798024777) and kind<> 'production companies';
create or replace view semiDown8040352829440149618 as select v24, v13 from semiUp7310607500150931411 where (v24) in (select v24 from semiDown6500753929790904418);
create or replace view semiDown2106247641659846165 as select v24, v22 from semiUp8108037373260583347 where (v24) in (select v24 from semiDown6500753929790904418);
create or replace view semiDown7796451004509249760 as select id as v13 from link_type AS lt where (id) in (select v13 from semiDown8040352829440149618);
create or replace view semiDown8468924507257888190 as select id as v22 from keyword AS k where (id) in (select v22 from semiDown2106247641659846165) and keyword IN ('sequel','revenge','based-on-novel');
create or replace view aggView2336367924900763814 as select v2, v17, v2 as v39 from semiDown526365375658621999;
create or replace view aggView6187303822527950720 as select v13 from semiDown7796451004509249760;
create or replace view aggJoin6523888642706750576 as select v24 from semiDown8040352829440149618 join aggView6187303822527950720 using(v13);
create or replace view aggView3423043371292693348 as select v22 from semiDown8468924507257888190;
create or replace view aggJoin2434226629072359268 as select v24 from semiDown2106247641659846165 join aggView3423043371292693348 using(v22);
create or replace view aggView8537457409230071956 as select v24 from aggJoin6523888642706750576 group by v24;
create or replace view aggJoin126289318215481945 as select v24, v28 from semiDown6500753929790904418 join aggView8537457409230071956 using(v24);
create or replace view aggView352181540482343133 as select v24 from aggJoin2434226629072359268 group by v24;
create or replace view aggJoin16066193900456913 as select v24, v28 from aggJoin126289318215481945 join aggView352181540482343133 using(v24);
create or replace view aggView54724632926558747 as select v28, v24, MIN(v28) as v41 from aggJoin16066193900456913 group by v28,v24;
create or replace view aggView6160919951533689519 as select v18 from semiDown2822772278809015493;
create or replace view aggJoin5481988560676946425 as select v24, v17, v19 from semiDown4348151145798024777 join aggView6160919951533689519 using(v18);
create or replace view aggView3983393361738260380 as select v19, v17, v24, MIN(v19) as v40 from aggJoin5481988560676946425 group by v19,v17,v24;
create or replace view aggView4125479044222707586 as select v24, MIN(v41) as v41 from aggView54724632926558747 group by v24,v41;
create or replace view aggJoin8736003760004822384 as select v17, v40 as v40, v41 from aggView3983393361738260380 join aggView4125479044222707586 using(v24);
create or replace view aggView1756345932964250293 as select v17, MIN(v39) as v39 from aggView2336367924900763814 group by v17,v39;
create or replace view aggJoin8600581588312816652 as select v40 as v40, v41 as v41, v39 from aggJoin8736003760004822384 join aggView1756345932964250293 using(v17);
create or replace view res as select MIN(v39) as v39, MIN(v40) as v40, MIN(v41) as v41 from aggJoin8600581588312816652;
select sum(v39+v40+v41) from res;
