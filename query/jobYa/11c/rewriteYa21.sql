create or replace view semiUp3645699084432660667 as select movie_id as v24, link_type_id as v13 from movie_link AS ml where (link_type_id) in (select id from link_type AS lt);
create or replace view semiUp3384580827836471184 as select id as v24, title as v28 from title AS t where (id) in (select v24 from semiUp3645699084432660667) and production_year>1950;
create or replace view cnAux68 as select id as v17, name as v2 from company_name where country_code<> '[pl]' and ((name LIKE '20th Century Fox%') OR (name LIKE 'Twentieth Century Fox%'));
create or replace view semiUp1754032137466255824 as select movie_id as v24, company_id as v17, company_type_id as v18, note as v19 from movie_companies AS mc where (company_type_id) in (select id from company_type AS ct where kind<> 'production companies');
create or replace view tAux47 as select v24, v28 from semiUp3384580827836471184;
create or replace view semiUp4291839644173321180 as select movie_id as v24, keyword_id as v22 from movie_keyword AS mk where (keyword_id) in (select id from keyword AS k where keyword IN ('sequel','revenge','based-on-novel'));
create or replace view semiUp3955611990533062450 as select v24, v17, v18, v19 from semiUp1754032137466255824 where (v24) in (select v24 from semiUp4291839644173321180);
create or replace view mcAux30 as select v24, v17, v19 from semiUp3955611990533062450;
create or replace view semiUp5738964516971206578 as select v24, v17, v19 from mcAux30 where (v24) in (select v24 from tAux47);
create or replace view semiUp5663839768191454790 as select v24, v17, v19 from semiUp5738964516971206578 where (v17) in (select v17 from cnAux68);
create or replace view semiDown6651080056226100363 as select v17, v2 from cnAux68 where (v17) in (select v17 from semiUp5663839768191454790);
create or replace view semiDown7130263753352522490 as select v24, v28 from tAux47 where (v24) in (select v24 from semiUp5663839768191454790);
create or replace view semiDown6412133704677833672 as select v24, v17, v18, v19 from semiUp3955611990533062450 where (v19, v17, v24) in (select v19, v17, v24 from semiUp5663839768191454790);
create or replace view semiDown5309115161639299493 as select id as v17, name as v2 from company_name AS cn where (name, id) in (select v2, v17 from semiDown6651080056226100363) and country_code<> '[pl]' and ((name LIKE '20th Century Fox%') OR (name LIKE 'Twentieth Century Fox%'));
create or replace view semiDown1288635044711450014 as select v24, v28 from semiUp3384580827836471184 where (v28, v24) in (select v28, v24 from semiDown7130263753352522490);
create or replace view semiDown4670232191200613020 as select id as v18 from company_type AS ct where (id) in (select v18 from semiDown6412133704677833672) and kind<> 'production companies';
create or replace view semiDown1142967492748139436 as select v24, v22 from semiUp4291839644173321180 where (v24) in (select v24 from semiDown6412133704677833672);
create or replace view semiDown4911258102730003023 as select v24, v13 from semiUp3645699084432660667 where (v24) in (select v24 from semiDown1288635044711450014);
create or replace view semiDown8440535831845661206 as select id as v22 from keyword AS k where (id) in (select v22 from semiDown1142967492748139436) and keyword IN ('sequel','revenge','based-on-novel');
create or replace view semiDown6707975220928008191 as select id as v13 from link_type AS lt where (id) in (select v13 from semiDown4911258102730003023);
create or replace view aggView7574606837246374765 as select v2, v17, v2 as v39 from semiDown5309115161639299493;
create or replace view aggView615992206488460250 as select v13 from semiDown6707975220928008191;
create or replace view aggJoin3204247052000263231 as select v24 from semiDown4911258102730003023 join aggView615992206488460250 using(v13);
create or replace view aggView2290104863538193176 as select v24 from aggJoin3204247052000263231 group by v24;
create or replace view aggJoin3052792938814853477 as select v24, v28 from semiDown1288635044711450014 join aggView2290104863538193176 using(v24);
create or replace view aggView4887595510330122915 as select v28, v24, MIN(v28) as v41 from aggJoin3052792938814853477 group by v28,v24;
create or replace view aggView7578351472197633080 as select v22 from semiDown8440535831845661206;
create or replace view aggJoin2826284605905123335 as select v24 from semiDown1142967492748139436 join aggView7578351472197633080 using(v22);
create or replace view aggView8724588612431822631 as select v18 from semiDown4670232191200613020;
create or replace view aggJoin2371629969208270050 as select v24, v17, v19 from semiDown6412133704677833672 join aggView8724588612431822631 using(v18);
create or replace view aggView8319574599901934464 as select v24 from aggJoin2826284605905123335 group by v24;
create or replace view aggJoin9182168821601824166 as select v24, v17, v19 from aggJoin2371629969208270050 join aggView8319574599901934464 using(v24);
create or replace view aggView8926849860005057460 as select v19, v17, v24, MIN(v19) as v40 from aggJoin9182168821601824166 group by v19,v17,v24;
create or replace view aggView7884785306688186457 as select v17, MIN(v39) as v39 from aggView7574606837246374765 group by v17,v39;
create or replace view aggJoin1760758437981398740 as select v24, v40 as v40, v39 from aggView8926849860005057460 join aggView7884785306688186457 using(v17);
create or replace view aggView4407552330139397745 as select v24, MIN(v41) as v41 from aggView4887595510330122915 group by v24,v41;
create or replace view aggJoin8019050991025465258 as select v40 as v40, v39 as v39, v41 from aggJoin1760758437981398740 join aggView4407552330139397745 using(v24);
create or replace view res as select MIN(v39) as v39, MIN(v40) as v40, MIN(v41) as v41 from aggJoin8019050991025465258;
select sum(v39+v40+v41) from res;
