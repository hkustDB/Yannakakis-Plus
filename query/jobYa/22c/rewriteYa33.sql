create or replace view cnAux21 as select id as v1, name as v2 from company_name where country_code<> '[us]';
create or replace view semiUp2880021642279130289 as select movie_id as v37, keyword_id as v14 from movie_keyword AS mk where (keyword_id) in (select id from keyword AS k where keyword IN ('murder','murder-in-title','blood','violence'));
create or replace view semiUp5965993408392646450 as select movie_id as v37, info_type_id as v12, info as v32 from movie_info_idx AS mi_idx where (info_type_id) in (select id from info_type AS it2 where info= 'rating');
create or replace view semiUp8779823705857898556 as select id as v37, title as v38, kind_id as v17 from title AS t where (id) in (select v37 from semiUp2880021642279130289) and production_year>2005;
create or replace view semiUp5633626795197581834 as select movie_id as v37, info_type_id as v10 from movie_info AS mi where (info_type_id) in (select id from info_type AS it1 where info= 'countries') and info IN ('Sweden','Norway','Germany','Denmark','Swedish','Danish','Norwegian','German','USA','American');
create or replace view semiUp6985452455422542983 as select v37, v38, v17 from semiUp8779823705857898556 where (v17) in (select id from kind_type AS kt where kind IN ('movie','episode'));
create or replace view tAux61 as select v37, v38 from semiUp6985452455422542983;
create or replace view semiUp2118590874026050331 as select v37, v12, v32 from semiUp5965993408392646450 where (v37) in (select v37 from semiUp5633626795197581834);
create or replace view mi_idxAux56 as select v37, v32 from semiUp2118590874026050331;
create or replace view semiUp2905005191402197041 as select movie_id as v37, company_id as v1, company_type_id as v8 from movie_companies AS mc where (movie_id) in (select v37 from mi_idxAux56) and note NOT LIKE '%(USA)%' and note LIKE '%(200%)%';
create or replace view semiUp6972850403807185183 as select v37, v1, v8 from semiUp2905005191402197041 where (v37) in (select v37 from tAux61);
create or replace view semiUp814282264293248843 as select v37, v1, v8 from semiUp6972850403807185183 where (v8) in (select id from company_type AS ct);
create or replace view semiUp2498253337940269587 as select v1, v2 from cnAux21 where (v1) in (select v1 from semiUp814282264293248843);
create or replace view semiDown8475245670763976650 as select id as v1, name as v2 from company_name AS cn where (id, name) in (select v1, v2 from semiUp2498253337940269587) and country_code<> '[us]';
create or replace view semiDown4205818972588977631 as select v37, v1, v8 from semiUp814282264293248843 where (v1) in (select v1 from semiUp2498253337940269587);
create or replace view semiDown5223590412605827482 as select id as v8 from company_type AS ct where (id) in (select v8 from semiDown4205818972588977631);
create or replace view semiDown6283369727712563420 as select v37, v38 from tAux61 where (v37) in (select v37 from semiDown4205818972588977631);
create or replace view semiDown5427699565716263108 as select v37, v32 from mi_idxAux56 where (v37) in (select v37 from semiDown4205818972588977631);
create or replace view semiDown2364496231177700110 as select v37, v38, v17 from semiUp6985452455422542983 where (v38, v37) in (select v38, v37 from semiDown6283369727712563420);
create or replace view semiDown55550656373902785 as select v37, v12, v32 from semiUp2118590874026050331 where (v37, v32) in (select v37, v32 from semiDown5427699565716263108);
create or replace view semiDown1645839009825715354 as select id as v17 from kind_type AS kt where (id) in (select v17 from semiDown2364496231177700110) and kind IN ('movie','episode');
create or replace view semiDown5572807765666755077 as select v37, v14 from semiUp2880021642279130289 where (v37) in (select v37 from semiDown2364496231177700110);
create or replace view semiDown6983236825155524129 as select id as v12 from info_type AS it2 where (id) in (select v12 from semiDown55550656373902785) and info= 'rating';
create or replace view semiDown3532742841641414368 as select v37, v10 from semiUp5633626795197581834 where (v37) in (select v37 from semiDown55550656373902785);
create or replace view semiDown9213179670627657922 as select id as v14 from keyword AS k where (id) in (select v14 from semiDown5572807765666755077) and keyword IN ('murder','murder-in-title','blood','violence');
create or replace view semiDown349612604742963014 as select id as v10 from info_type AS it1 where (id) in (select v10 from semiDown3532742841641414368) and info= 'countries';
create or replace view aggView9185596774689197410 as select v2, v1, v2 as v49 from semiDown8475245670763976650;
create or replace view aggView271004874923863270 as select v14 from semiDown9213179670627657922;
create or replace view aggJoin3962673187527694770 as select v37 from semiDown5572807765666755077 join aggView271004874923863270 using(v14);
create or replace view aggView891018055195956602 as select v10 from semiDown349612604742963014;
create or replace view aggJoin601356712879489625 as select v37 from semiDown3532742841641414368 join aggView891018055195956602 using(v10);
create or replace view aggView3143942465942996255 as select v12 from semiDown6983236825155524129;
create or replace view aggJoin2263665559077263203 as select v37, v32 from semiDown55550656373902785 join aggView3143942465942996255 using(v12);
create or replace view aggView4663260480892404554 as select v17 from semiDown1645839009825715354;
create or replace view aggJoin8110205601822351372 as select v37, v38 from semiDown2364496231177700110 join aggView4663260480892404554 using(v17);
create or replace view aggView5934680392699512883 as select v37 from aggJoin601356712879489625 group by v37;
create or replace view aggJoin5317049356912300479 as select v37, v32 from aggJoin2263665559077263203 join aggView5934680392699512883 using(v37);
create or replace view aggView5400793988286173014 as select v37, v32, MIN(v32) as v50 from aggJoin5317049356912300479 group by v37,v32;
create or replace view aggView2005214928017050752 as select v37 from aggJoin3962673187527694770 group by v37;
create or replace view aggJoin2735231970984504846 as select v37, v38 from aggJoin8110205601822351372 join aggView2005214928017050752 using(v37);
create or replace view aggView8200558136477004989 as select v38, v37, MIN(v38) as v51 from aggJoin2735231970984504846 group by v38,v37;
create or replace view aggView5768017645323514585 as select v8 from semiDown5223590412605827482;
create or replace view aggJoin8516389308786454639 as select v37, v1 from semiDown4205818972588977631 join aggView5768017645323514585 using(v8);
create or replace view aggView1543732867699423551 as select v37, MIN(v50) as v50 from aggView5400793988286173014 group by v37,v50;
create or replace view aggJoin5067411730746294806 as select v37, v1, v50 from aggJoin8516389308786454639 join aggView1543732867699423551 using(v37);
create or replace view aggView8296371435583266151 as select v37, MIN(v51) as v51 from aggView8200558136477004989 group by v37,v51;
create or replace view aggJoin7258784428498267120 as select v1, v50 as v50, v51 from aggJoin5067411730746294806 join aggView8296371435583266151 using(v37);
create or replace view aggView2456864665696928130 as select v1, MIN(v50) as v50, MIN(v51) as v51 from aggJoin7258784428498267120 group by v1,v50,v51;
create or replace view aggJoin8922780846464561981 as select v49 as v49, v50, v51 from aggView9185596774689197410 join aggView2456864665696928130 using(v1);
create or replace view res as select MIN(v49) as v49, MIN(v50) as v50, MIN(v51) as v51 from aggJoin8922780846464561981;
select sum(v49+v50+v51) from res;
