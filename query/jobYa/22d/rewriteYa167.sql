create or replace view semiUp7671084758462873474 as select id as v37, title as v38, kind_id as v17 from title AS t where (kind_id) in (select id from kind_type AS kt where kind IN ('movie','episode')) and production_year>2005;
create or replace view semiUp2219721328534071022 as select movie_id as v37, info_type_id as v10 from movie_info AS mi where (info_type_id) in (select id from info_type AS it1 where info= 'countries') and info IN ('Sweden','Norway','Germany','Denmark','Swedish','Danish','Norwegian','German','USA','American');
create or replace view semiUp8076083626083892971 as select movie_id as v37, company_id as v1, company_type_id as v8 from movie_companies AS mc where (company_type_id) in (select id from company_type AS ct);
create or replace view semiUp8753915090140260780 as select movie_id as v37, info_type_id as v12, info as v32 from movie_info_idx AS mi_idx where (info_type_id) in (select id from info_type AS it2 where info= 'rating') and info<'8.5';
create or replace view semiUp2227080192187284275 as select v37, v38, v17 from semiUp7671084758462873474 where (v37) in (select v37 from semiUp2219721328534071022);
create or replace view semiUp1452581828834964657 as select v37, v12, v32 from semiUp8753915090140260780 where (v37) in (select v37 from semiUp2227080192187284275);
create or replace view semiUp5982472145963590748 as select v37, v1, v8 from semiUp8076083626083892971 where (v1) in (select id from company_name AS cn where country_code<> '[us]');
create or replace view semiUp4895157589962905357 as select movie_id as v37, keyword_id as v14 from movie_keyword AS mk where (keyword_id) in (select id from keyword AS k where keyword IN ('murder','murder-in-title','blood','violence'));
create or replace view semiUp5832627109364588841 as select v37, v1, v8 from semiUp5982472145963590748 where (v37) in (select v37 from semiUp1452581828834964657);
create or replace view semiUp65427570512875178 as select v37, v14 from semiUp4895157589962905357 where (v37) in (select v37 from semiUp5832627109364588841);
create or replace view semiDown8796533038676990695 as select id as v14 from keyword AS k where (id) in (select v14 from semiUp65427570512875178) and keyword IN ('murder','murder-in-title','blood','violence');
create or replace view semiDown7776514300207691562 as select v37, v1, v8 from semiUp5832627109364588841 where (v37) in (select v37 from semiUp65427570512875178);
create or replace view semiDown8838828875823600 as select id as v8 from company_type AS ct where (id) in (select v8 from semiDown7776514300207691562);
create or replace view semiDown4449639572743206567 as select id as v1, name as v2 from company_name AS cn where (id) in (select v1 from semiDown7776514300207691562) and country_code<> '[us]';
create or replace view semiDown367166977146766325 as select v37, v12, v32 from semiUp1452581828834964657 where (v37) in (select v37 from semiDown7776514300207691562);
create or replace view semiDown5751387779734974424 as select id as v12 from info_type AS it2 where (id) in (select v12 from semiDown367166977146766325) and info= 'rating';
create or replace view semiDown6606908880125397207 as select v37, v38, v17 from semiUp2227080192187284275 where (v37) in (select v37 from semiDown367166977146766325);
create or replace view semiDown5628451840080554501 as select id as v17 from kind_type AS kt where (id) in (select v17 from semiDown6606908880125397207) and kind IN ('movie','episode');
create or replace view semiDown438882484254384881 as select v37, v10 from semiUp2219721328534071022 where (v37) in (select v37 from semiDown6606908880125397207);
create or replace view semiDown3618433492728049356 as select id as v10 from info_type AS it1 where (id) in (select v10 from semiDown438882484254384881) and info= 'countries';
create or replace view aggView830974469315563172 as select v10 from semiDown3618433492728049356;
create or replace view aggJoin8273121737226658792 as select v37 from semiDown438882484254384881 join aggView830974469315563172 using(v10);
create or replace view aggView4955374924589928195 as select v37 from aggJoin8273121737226658792 group by v37;
create or replace view aggJoin2285490704435337765 as select v37, v38, v17 from semiDown6606908880125397207 join aggView4955374924589928195 using(v37);
create or replace view aggView2742863601150340829 as select v17 from semiDown5628451840080554501;
create or replace view aggJoin8844603112897415757 as select v37, v38 from aggJoin2285490704435337765 join aggView2742863601150340829 using(v17);
create or replace view aggView7972920478853976883 as select v37, MIN(v38) as v51 from aggJoin8844603112897415757 group by v37;
create or replace view aggJoin8272476798532040934 as select v37, v12, v32, v51 from semiDown367166977146766325 join aggView7972920478853976883 using(v37);
create or replace view aggView4878827879361043582 as select v12 from semiDown5751387779734974424;
create or replace view aggJoin1988265055298059836 as select v37, v32, v51 from aggJoin8272476798532040934 join aggView4878827879361043582 using(v12);
create or replace view aggView7879690925710912298 as select v37, MIN(v51) as v51, MIN(v32) as v50 from aggJoin1988265055298059836 group by v37,v51;
create or replace view aggJoin779193015720868240 as select v37, v1, v8, v51, v50 from semiDown7776514300207691562 join aggView7879690925710912298 using(v37);
create or replace view aggView3912622175127570426 as select v8 from semiDown8838828875823600;
create or replace view aggJoin6275936892168387629 as select v37, v1, v51, v50 from aggJoin779193015720868240 join aggView3912622175127570426 using(v8);
create or replace view aggView5435194972640358762 as select v1, v2 as v49 from semiDown4449639572743206567;
create or replace view aggJoin1968128372923058114 as select v37, v51, v50, v49 from aggJoin6275936892168387629 join aggView5435194972640358762 using(v1);
create or replace view aggView8475773279600138129 as select v14 from semiDown8796533038676990695;
create or replace view aggJoin2941735367838060439 as select v37 from semiUp65427570512875178 join aggView8475773279600138129 using(v14);
create or replace view aggView9164378595605972663 as select v37, MIN(v51) as v51, MIN(v50) as v50, MIN(v49) as v49 from aggJoin1968128372923058114 group by v37,v50,v49,v51;
create or replace view aggJoin3491904377585327592 as select v51, v50, v49 from aggJoin2941735367838060439 join aggView9164378595605972663 using(v37);
create or replace view res as select MIN(v49) as v49, MIN(v50) as v50, MIN(v51) as v51 from aggJoin3491904377585327592;
select sum(v49+v50+v51) from res;
