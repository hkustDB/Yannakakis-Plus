create or replace view cnAux78 as select id as v1, name as v2 from company_name where country_code= '[us]';
create or replace view tAux21 as select id as v29, title as v30 from title where production_year<=2008 and production_year>=2005;
create or replace view semiUp2132020934779488639 as select movie_id as v29, info_type_id as v26, info as v27 from movie_info_idx AS mi_idx where (info_type_id) in (select id from info_type AS it2 where info= 'rating') and info>'8.0';
create or replace view mi_idxAux47 as select v29, v27 from semiUp2132020934779488639;
create or replace view semiUp5569151181694582961 as select movie_id as v29, company_id as v1, company_type_id as v8 from movie_companies AS mc where (company_type_id) in (select id from company_type AS ct where kind= 'production companies');
create or replace view semiUp8488556181334649818 as select v29, v1, v8 from semiUp5569151181694582961 where (v1) in (select v1 from cnAux78);
create or replace view semiUp4744720130858902154 as select movie_id as v29, info_type_id as v21 from movie_info AS mi where (info_type_id) in (select id from info_type AS it1 where info= 'genres') and info IN ('Drama','Horror');
create or replace view semiUp4101030800744937334 as select v29, v1, v8 from semiUp8488556181334649818 where (v29) in (select v29 from semiUp4744720130858902154);
create or replace view semiUp8138783314833973593 as select v29, v27 from mi_idxAux47 where (v29) in (select v29 from semiUp4101030800744937334);
create or replace view semiUp4690776965996025336 as select v29, v30 from tAux21 where (v29) in (select v29 from semiUp8138783314833973593);
create or replace view semiDown3024208255584980021 as select v29, v27 from semiUp8138783314833973593 where (v29) in (select v29 from semiUp4690776965996025336);
create or replace view semiDown7138626131058257834 as select id as v29, title as v30 from title AS t where (title, id) in (select v30, v29 from semiUp4690776965996025336) and production_year<=2008 and production_year>=2005;
create or replace view semiDown3358937315014907303 as select v29, v26, v27 from semiUp2132020934779488639 where (v29, v27) in (select v29, v27 from semiDown3024208255584980021);
create or replace view semiDown1160076565952045153 as select v29, v1, v8 from semiUp4101030800744937334 where (v29) in (select v29 from semiDown3024208255584980021);
create or replace view semiDown2339830632077005546 as select id as v26 from info_type AS it2 where (id) in (select v26 from semiDown3358937315014907303) and info= 'rating';
create or replace view semiDown3662112105105786073 as select id as v8 from company_type AS ct where (id) in (select v8 from semiDown1160076565952045153) and kind= 'production companies';
create or replace view semiDown3947756474492167032 as select v1, v2 from cnAux78 where (v1) in (select v1 from semiDown1160076565952045153);
create or replace view semiDown2554628286599033819 as select v29, v21 from semiUp4744720130858902154 where (v29) in (select v29 from semiDown1160076565952045153);
create or replace view semiDown5112707220857120284 as select id as v1, name as v2 from company_name AS cn where (id, name) in (select v1, v2 from semiDown3947756474492167032) and country_code= '[us]';
create or replace view semiDown5560407806198153066 as select id as v21 from info_type AS it1 where (id) in (select v21 from semiDown2554628286599033819) and info= 'genres';
create or replace view aggView6583738523087322453 as select v1, v2, v2 as v41 from semiDown5112707220857120284;
create or replace view aggView1646972545834892907 as select v30, v29, v30 as v43 from semiDown7138626131058257834;
create or replace view aggView6612069655980282875 as select v26 from semiDown2339830632077005546;
create or replace view aggJoin3775757687327632161 as select v29, v27 from semiDown3358937315014907303 join aggView6612069655980282875 using(v26);
create or replace view aggView994582788310507646 as select v29, v27, MIN(v27) as v42 from aggJoin3775757687327632161 group by v29,v27;
create or replace view aggView3632598427346678630 as select v21 from semiDown5560407806198153066;
create or replace view aggJoin7629058835051188993 as select v29 from semiDown2554628286599033819 join aggView3632598427346678630 using(v21);
create or replace view aggView3317659914471404931 as select v29 from aggJoin7629058835051188993 group by v29;
create or replace view aggJoin480521016530466574 as select v29, v1, v8 from semiDown1160076565952045153 join aggView3317659914471404931 using(v29);
create or replace view aggView8763118039950177199 as select v8 from semiDown3662112105105786073;
create or replace view aggJoin5757608211849719155 as select v29, v1 from aggJoin480521016530466574 join aggView8763118039950177199 using(v8);
create or replace view aggView90249890761296107 as select v1, MIN(v41) as v41 from aggView6583738523087322453 group by v1,v41;
create or replace view aggJoin6663138737086794124 as select v29, v41 from aggJoin5757608211849719155 join aggView90249890761296107 using(v1);
create or replace view aggView1438781644262596877 as select v29, MIN(v41) as v41 from aggJoin6663138737086794124 group by v29,v41;
create or replace view aggJoin3200184714747572369 as select v29, v42 as v42, v41 from aggView994582788310507646 join aggView1438781644262596877 using(v29);
create or replace view aggView799582749464466641 as select v29, MIN(v42) as v42, MIN(v41) as v41 from aggJoin3200184714747572369 group by v29,v42,v41;
create or replace view aggJoin6776387160194621703 as select v43 as v43, v42, v41 from aggView1646972545834892907 join aggView799582749464466641 using(v29);
create or replace view res as select MIN(v41) as v41, MIN(v42) as v42, MIN(v43) as v43 from aggJoin6776387160194621703;
select sum(v41+v42+v43) from res;
