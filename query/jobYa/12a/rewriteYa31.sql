create or replace view semiUp2157078562142159533 as select movie_id as v29, info_type_id as v26, info as v27 from movie_info_idx AS mi_idx where (info_type_id) in (select id from info_type AS it2 where info= 'rating') and info>'8.0';
create or replace view semiUp7681003815480102538 as select movie_id as v29, company_id as v1, company_type_id as v8 from movie_companies AS mc where (company_type_id) in (select id from company_type AS ct where kind= 'production companies');
create or replace view semiUp1720554800550886738 as select v29, v1, v8 from semiUp7681003815480102538 where (v1) in (select id from company_name AS cn where country_code= '[us]');
create or replace view semiUp3510432510924342305 as select movie_id as v29, info_type_id as v21 from movie_info AS mi where (info_type_id) in (select id from info_type AS it1 where info= 'genres') and info IN ('Drama','Horror');
create or replace view semiUp703968011098372803 as select v29, v26, v27 from semiUp2157078562142159533 where (v29) in (select v29 from semiUp3510432510924342305);
create or replace view semiUp6296183599411318210 as select id as v29, title as v30 from title AS t where (id) in (select v29 from semiUp703968011098372803) and production_year<=2008 and production_year>=2005;
create or replace view semiUp2540913480004917794 as select v29, v1, v8 from semiUp1720554800550886738 where (v29) in (select v29 from semiUp6296183599411318210);
create or replace view semiDown4034355909194213654 as select id as v8 from company_type AS ct where (id) in (select v8 from semiUp2540913480004917794) and kind= 'production companies';
create or replace view semiDown728562629985056143 as select id as v1, name as v2 from company_name AS cn where (id) in (select v1 from semiUp2540913480004917794) and country_code= '[us]';
create or replace view semiDown5666432555310401249 as select v29, v30 from semiUp6296183599411318210 where (v29) in (select v29 from semiUp2540913480004917794);
create or replace view semiDown9205888372361401439 as select v29, v26, v27 from semiUp703968011098372803 where (v29) in (select v29 from semiDown5666432555310401249);
create or replace view semiDown582834461826628668 as select id as v26 from info_type AS it2 where (id) in (select v26 from semiDown9205888372361401439) and info= 'rating';
create or replace view semiDown108293000709744654 as select v29, v21 from semiUp3510432510924342305 where (v29) in (select v29 from semiDown9205888372361401439);
create or replace view semiDown2297717688459305657 as select id as v21 from info_type AS it1 where (id) in (select v21 from semiDown108293000709744654) and info= 'genres';
create or replace view aggView2825312455178677512 as select v21 from semiDown2297717688459305657;
create or replace view aggJoin3911770848197032335 as select v29 from semiDown108293000709744654 join aggView2825312455178677512 using(v21);
create or replace view aggView5563684889530611025 as select v26 from semiDown582834461826628668;
create or replace view aggJoin7205241129075259729 as select v29, v27 from semiDown9205888372361401439 join aggView5563684889530611025 using(v26);
create or replace view aggView6273847984793551457 as select v29 from aggJoin3911770848197032335 group by v29;
create or replace view aggJoin2665289879648900564 as select v29, v27 from aggJoin7205241129075259729 join aggView6273847984793551457 using(v29);
create or replace view aggView1705853004385600487 as select v29, MIN(v27) as v42 from aggJoin2665289879648900564 group by v29;
create or replace view aggJoin7097708404919891477 as select v29, v30, v42 from semiDown5666432555310401249 join aggView1705853004385600487 using(v29);
create or replace view aggView6888806574275617222 as select v8 from semiDown4034355909194213654;
create or replace view aggJoin1494366825039795045 as select v29, v1 from semiUp2540913480004917794 join aggView6888806574275617222 using(v8);
create or replace view aggView3007607363584961574 as select v1, v2 as v41 from semiDown728562629985056143;
create or replace view aggJoin4613983416288942488 as select v29, v41 from aggJoin1494366825039795045 join aggView3007607363584961574 using(v1);
create or replace view aggView4190413024162565012 as select v29, MIN(v42) as v42, MIN(v30) as v43 from aggJoin7097708404919891477 group by v29,v42;
create or replace view aggJoin6503967487772224943 as select v41 as v41, v42, v43 from aggJoin4613983416288942488 join aggView4190413024162565012 using(v29);
create or replace view res as select MIN(v41) as v41, MIN(v42) as v42, MIN(v43) as v43 from aggJoin6503967487772224943;
select sum(v41+v42+v43) from res;
