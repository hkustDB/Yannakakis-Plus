create or replace view cnAux78 as select id as v1, name as v2 from company_name where country_code= '[us]';
create or replace view tAux21 as select id as v29, title as v30 from title where production_year<=2008 and production_year>=2005;
create or replace view semiUp5296291346813634210 as select movie_id as v29, info_type_id as v26, info as v27 from movie_info_idx AS mi_idx where (info_type_id) in (select id from info_type AS it2 where info= 'rating') and info>'8.0';
create or replace view mi_idxAux47 as select v29, v27 from semiUp5296291346813634210;
create or replace view semiUp4979560773130520741 as select movie_id as v29, company_id as v1, company_type_id as v8 from movie_companies AS mc where (company_id) in (select v1 from cnAux78);
create or replace view semiUp3079614798772686317 as select v29, v1, v8 from semiUp4979560773130520741 where (v8) in (select id from company_type AS ct where kind= 'production companies');
create or replace view semiUp3143026635155885019 as select movie_id as v29, info_type_id as v21 from movie_info AS mi where (info_type_id) in (select id from info_type AS it1 where info= 'genres') and info IN ('Drama','Horror');
create or replace view semiUp7829566206981038934 as select v29, v1, v8 from semiUp3079614798772686317 where (v29) in (select v29 from semiUp3143026635155885019);
create or replace view semiUp5606928437674944088 as select v29, v30 from tAux21 where (v29) in (select v29 from semiUp7829566206981038934);
create or replace view semiUp5640631256525819237 as select v29, v27 from mi_idxAux47 where (v29) in (select v29 from semiUp5606928437674944088);
create or replace view semiDown4207615420533314142 as select v29, v26, v27 from semiUp5296291346813634210 where (v29, v27) in (select v29, v27 from semiUp5640631256525819237);
create or replace view semiDown2756662015571908628 as select v29, v30 from semiUp5606928437674944088 where (v29) in (select v29 from semiUp5640631256525819237);
create or replace view semiDown1765625044147581641 as select id as v26 from info_type AS it2 where (id) in (select v26 from semiDown4207615420533314142) and info= 'rating';
create or replace view semiDown2084343578096224244 as select id as v29, title as v30 from title AS t where (title, id) in (select v30, v29 from semiDown2756662015571908628) and production_year<=2008 and production_year>=2005;
create or replace view semiDown7452752623580320570 as select v29, v1, v8 from semiUp7829566206981038934 where (v29) in (select v29 from semiDown2756662015571908628);
create or replace view semiDown835266827661755444 as select id as v8 from company_type AS ct where (id) in (select v8 from semiDown7452752623580320570) and kind= 'production companies';
create or replace view semiDown781640023287761528 as select v1, v2 from cnAux78 where (v1) in (select v1 from semiDown7452752623580320570);
create or replace view semiDown2558052817568586164 as select v29, v21 from semiUp3143026635155885019 where (v29) in (select v29 from semiDown7452752623580320570);
create or replace view semiDown3059698493200619960 as select id as v1, name as v2 from company_name AS cn where (id, name) in (select v1, v2 from semiDown781640023287761528) and country_code= '[us]';
create or replace view semiDown2552838153311108114 as select id as v21 from info_type AS it1 where (id) in (select v21 from semiDown2558052817568586164) and info= 'genres';
create or replace view aggView2907809076557111152 as select v1, v2, v2 as v41 from semiDown3059698493200619960;
create or replace view aggView7470766772935570340 as select v30, v29, v30 as v43 from semiDown2084343578096224244;
create or replace view aggView3239981138336061074 as select v26 from semiDown1765625044147581641;
create or replace view aggJoin5839263809279154588 as select v29, v27 from semiDown4207615420533314142 join aggView3239981138336061074 using(v26);
create or replace view aggView1353148481402473483 as select v29, v27, MIN(v27) as v42 from aggJoin5839263809279154588 group by v29,v27;
create or replace view aggView392902509938654788 as select v21 from semiDown2552838153311108114;
create or replace view aggJoin7781288079013433124 as select v29 from semiDown2558052817568586164 join aggView392902509938654788 using(v21);
create or replace view aggView2000423483411198356 as select v29 from aggJoin7781288079013433124 group by v29;
create or replace view aggJoin5057701193500257692 as select v29, v1, v8 from semiDown7452752623580320570 join aggView2000423483411198356 using(v29);
create or replace view aggView825990395090413040 as select v8 from semiDown835266827661755444;
create or replace view aggJoin7348419903115230284 as select v29, v1 from aggJoin5057701193500257692 join aggView825990395090413040 using(v8);
create or replace view aggView6747595128582349358 as select v1, MIN(v41) as v41 from aggView2907809076557111152 group by v1,v41;
create or replace view aggJoin2298295458800329813 as select v29, v41 from aggJoin7348419903115230284 join aggView6747595128582349358 using(v1);
create or replace view aggView3643488753181223745 as select v29, MIN(v41) as v41 from aggJoin2298295458800329813 group by v29,v41;
create or replace view aggJoin5856840020086675914 as select v29, v43 as v43, v41 from aggView7470766772935570340 join aggView3643488753181223745 using(v29);
create or replace view aggView2625378930595564272 as select v29, MIN(v43) as v43, MIN(v41) as v41 from aggJoin5856840020086675914 group by v29,v43,v41;
create or replace view aggJoin3378364437822537763 as select v42 as v42, v43, v41 from aggView1353148481402473483 join aggView2625378930595564272 using(v29);
create or replace view res as select MIN(v41) as v41, MIN(v42) as v42, MIN(v43) as v43 from aggJoin3378364437822537763;
select sum(v41+v42+v43) from res;
