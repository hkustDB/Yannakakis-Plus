create or replace view semiUp1374103121249702528 as select movie_id as v3, company_id as v20 from movie_companies AS mc where (company_id) in (select id from company_name AS cn where country_code= '[us]');
create or replace view semiUp6865365585423576536 as select movie_id as v3, keyword_id as v25 from movie_keyword AS mk where (movie_id) in (select id from title AS t);
create or replace view semiUp2168532452173995039 as select person_id as v26, movie_id as v3 from cast_info AS ci where (person_id) in (select id from name AS n where name LIKE 'B%');
create or replace view semiUp5437103989770490994 as select v3, v25 from semiUp6865365585423576536 where (v25) in (select id from keyword AS k where keyword= 'character-name-in-title');
create or replace view semiUp1443399427243518290 as select v3, v20 from semiUp1374103121249702528 where (v3) in (select v3 from semiUp5437103989770490994);
create or replace view semiUp6480482899022311374 as select v26, v3 from semiUp2168532452173995039 where (v3) in (select v3 from semiUp1443399427243518290);
create or replace view semiDown2165550346131804029 as select id as v26, name as v27 from name AS n where (id) in (select v26 from semiUp6480482899022311374) and name LIKE 'B%';
create or replace view semiDown4697818416630312155 as select v3, v20 from semiUp1443399427243518290 where (v3) in (select v3 from semiUp6480482899022311374);
create or replace view semiDown7801952263808845718 as select id as v20 from company_name AS cn where (id) in (select v20 from semiDown4697818416630312155) and country_code= '[us]';
create or replace view semiDown3508720465414803999 as select v3, v25 from semiUp5437103989770490994 where (v3) in (select v3 from semiDown4697818416630312155);
create or replace view semiDown8625899327765766766 as select id as v25 from keyword AS k where (id) in (select v25 from semiDown3508720465414803999) and keyword= 'character-name-in-title';
create or replace view semiDown4278516096557563966 as select id as v3 from title AS t where (id) in (select v3 from semiDown3508720465414803999);
create or replace view aggView5980835253769613478 as select v25 from semiDown8625899327765766766;
create or replace view aggJoin8934337212532621827 as select v3 from semiDown3508720465414803999 join aggView5980835253769613478 using(v25);
create or replace view aggView446883017928906863 as select v3 from semiDown4278516096557563966;
create or replace view aggJoin7288027410243626695 as select v3 from aggJoin8934337212532621827 join aggView446883017928906863 using(v3);
create or replace view aggView4867512108949703104 as select v20 from semiDown7801952263808845718;
create or replace view aggJoin6750109973769599445 as select v3 from semiDown4697818416630312155 join aggView4867512108949703104 using(v20);
create or replace view aggView1025480919608683062 as select v3 from aggJoin7288027410243626695 group by v3;
create or replace view aggJoin8105351860169399189 as select v3 from aggJoin6750109973769599445 join aggView1025480919608683062 using(v3);
create or replace view aggView8094154303426018129 as select v26, v27 as v47 from semiDown2165550346131804029;
create or replace view aggJoin857170782601758591 as select v3, v47 from semiUp6480482899022311374 join aggView8094154303426018129 using(v26);
create or replace view aggView5018405360597216606 as select v3 from aggJoin8105351860169399189 group by v3;
create or replace view aggJoin6948366163684851101 as select v47 as v47 from aggJoin857170782601758591 join aggView5018405360597216606 using(v3);
create or replace view res as select MIN(v47) as v47 from aggJoin6948366163684851101;
select sum(v47) from res;
