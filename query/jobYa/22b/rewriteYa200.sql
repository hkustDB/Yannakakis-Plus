create or replace view semiUp1244451015365031530 as select movie_id as v37, keyword_id as v14 from movie_keyword AS mk where (keyword_id) in (select id from keyword AS k where keyword IN ('murder','murder-in-title','blood','violence'));
create or replace view semiUp5203433841310003200 as select id as v37, title as v38, kind_id as v17 from title AS t where (kind_id) in (select id from kind_type AS kt where kind IN ('movie','episode')) and production_year>2009;
create or replace view semiUp3923585085314534834 as select movie_id as v37, info_type_id as v10 from movie_info AS mi where (info_type_id) in (select id from info_type AS it1 where info= 'countries') and info IN ('Germany','German','USA','American');
create or replace view semiUp8468940825969644277 as select v37, v14 from semiUp1244451015365031530 where (v37) in (select v37 from semiUp5203433841310003200);
create or replace view semiUp2336365540344108105 as select movie_id as v37, company_id as v1, company_type_id as v8 from movie_companies AS mc where (company_type_id) in (select id from company_type AS ct) and note NOT LIKE '%(USA)%' and note LIKE '%(200%)%';
create or replace view semiUp70193261726366638 as select movie_id as v37, info_type_id as v12, info as v32 from movie_info_idx AS mi_idx where (info_type_id) in (select id from info_type AS it2 where info= 'rating') and info<'7.0';
create or replace view semiUp4645569334414170621 as select v37, v1, v8 from semiUp2336365540344108105 where (v1) in (select id from company_name AS cn where country_code<> '[us]');
create or replace view semiUp3854069094354838547 as select v37, v10 from semiUp3923585085314534834 where (v37) in (select v37 from semiUp4645569334414170621);
create or replace view semiUp3033562096271970751 as select v37, v12, v32 from semiUp70193261726366638 where (v37) in (select v37 from semiUp3854069094354838547);
create or replace view semiUp2750387410647789201 as select v37, v14 from semiUp8468940825969644277 where (v37) in (select v37 from semiUp3033562096271970751);
create or replace view semiDown6018447892846052765 as select id as v14 from keyword AS k where (id) in (select v14 from semiUp2750387410647789201) and keyword IN ('murder','murder-in-title','blood','violence');
create or replace view semiDown3101842894137337493 as select v37, v38, v17 from semiUp5203433841310003200 where (v37) in (select v37 from semiUp2750387410647789201);
create or replace view semiDown6310673073065119972 as select v37, v12, v32 from semiUp3033562096271970751 where (v37) in (select v37 from semiUp2750387410647789201);
create or replace view semiDown3758361248871591142 as select id as v17 from kind_type AS kt where (id) in (select v17 from semiDown3101842894137337493) and kind IN ('movie','episode');
create or replace view semiDown5644304894940753900 as select id as v12 from info_type AS it2 where (id) in (select v12 from semiDown6310673073065119972) and info= 'rating';
create or replace view semiDown1490676575052695526 as select v37, v10 from semiUp3854069094354838547 where (v37) in (select v37 from semiDown6310673073065119972);
create or replace view semiDown7984434329314935034 as select id as v10 from info_type AS it1 where (id) in (select v10 from semiDown1490676575052695526) and info= 'countries';
create or replace view semiDown3630214351414218322 as select v37, v1, v8 from semiUp4645569334414170621 where (v37) in (select v37 from semiDown1490676575052695526);
create or replace view semiDown6154936221262130456 as select id as v8 from company_type AS ct where (id) in (select v8 from semiDown3630214351414218322);
create or replace view semiDown1935266724930462427 as select id as v1, name as v2 from company_name AS cn where (id) in (select v1 from semiDown3630214351414218322) and country_code<> '[us]';
create or replace view aggView1697890937185070499 as select v1, v2 as v49 from semiDown1935266724930462427;
create or replace view aggJoin3634196947474593202 as select v37, v8, v49 from semiDown3630214351414218322 join aggView1697890937185070499 using(v1);
create or replace view aggView2429032603096999782 as select v8 from semiDown6154936221262130456;
create or replace view aggJoin5316465584602748071 as select v37, v49 from aggJoin3634196947474593202 join aggView2429032603096999782 using(v8);
create or replace view aggView3330661846916910283 as select v10 from semiDown7984434329314935034;
create or replace view aggJoin8197621103335945523 as select v37 from semiDown1490676575052695526 join aggView3330661846916910283 using(v10);
create or replace view aggView5873678994445723356 as select v37, MIN(v49) as v49 from aggJoin5316465584602748071 group by v37,v49;
create or replace view aggJoin985941192320544576 as select v37, v49 from aggJoin8197621103335945523 join aggView5873678994445723356 using(v37);
create or replace view aggView1224705953190236124 as select v12 from semiDown5644304894940753900;
create or replace view aggJoin2245843403173557852 as select v37, v32 from semiDown6310673073065119972 join aggView1224705953190236124 using(v12);
create or replace view aggView5149216483309698475 as select v17 from semiDown3758361248871591142;
create or replace view aggJoin5029171378377437833 as select v37, v38 from semiDown3101842894137337493 join aggView5149216483309698475 using(v17);
create or replace view aggView2908058611012544423 as select v37, MIN(v49) as v49 from aggJoin985941192320544576 group by v37,v49;
create or replace view aggJoin2562436506672537406 as select v37, v32, v49 from aggJoin2245843403173557852 join aggView2908058611012544423 using(v37);
create or replace view aggView8959508828738245898 as select v14 from semiDown6018447892846052765;
create or replace view aggJoin771939725913993072 as select v37 from semiUp2750387410647789201 join aggView8959508828738245898 using(v14);
create or replace view aggView161264036222605486 as select v37, MIN(v49) as v49, MIN(v32) as v50 from aggJoin2562436506672537406 group by v37,v49;
create or replace view aggJoin1065288558940694390 as select v37, v49, v50 from aggJoin771939725913993072 join aggView161264036222605486 using(v37);
create or replace view aggView8599830026707618268 as select v37, MIN(v38) as v51 from aggJoin5029171378377437833 group by v37;
create or replace view aggJoin2869470488881009826 as select v49 as v49, v50 as v50, v51 from aggJoin1065288558940694390 join aggView8599830026707618268 using(v37);
create or replace view res as select MIN(v49) as v49, MIN(v50) as v50, MIN(v51) as v51 from aggJoin2869470488881009826;
select sum(v49+v50+v51) from res;
