create or replace view g1 as select Graph.src as v1, Graph.dst as v2, v12 from Graph, (SELECT src, COUNT(*) AS v12 FROM Graph GROUP BY src) AS c1 where Graph.src = c1.src;
create or replace view g1Aux70 as select v1, v2 from g1;
create or replace view g5 as select Graph.src as v4, Graph.dst as v10, v18 from Graph, (SELECT dst, COUNT(*) AS v18 FROM Graph GROUP BY dst) AS c4 where Graph.dst = c4.dst;
create or replace view g3 as select Graph.src as v4, Graph.dst as v6, v14 from Graph, (SELECT src, COUNT(*) AS v14 FROM Graph GROUP BY src) AS c2 where Graph.dst = c2.src;
create or replace view semiUp2543966526053414696 as select v4, v6 from g3 where (v4) in (select v4 from g5);
create or replace view semiUp1463193156987695215 as select src as v2, dst as v4 from Graph AS g2 where (dst) in (select v4 from semiUp2543966526053414696);
create or replace view g4 as select Graph.src as v7, Graph.dst as v2, v16 from Graph, (SELECT dst, COUNT(*) AS v16 FROM Graph GROUP BY dst) AS c3 where Graph.src = c3.dst;
create or replace view semiUp3406971373654269209 as select v7, v2 from g4 where (v2) in (select v2 from semiUp1463193156987695215);
create or replace view g4Aux37 as select v7, v2 from semiUp3406971373654269209;
create or replace view semiUp4874240807577673521 as select v1, v2 from g1Aux70 where (v2) in (select v2 from g4Aux37);
create or replace view semiDown619412746574101433 as select v7, v2 from g4Aux37 where (v2) in (select v2 from semiUp4874240807577673521);
create or replace view semiDown3315061171337961010 as select v1, v2 from g1 where (v2, v1) in (select v2, v1 from semiUp4874240807577673521);
create or replace view semiDown7273937078462153485 as select v7, v2 from semiUp3406971373654269209 where (v7, v2) in (select v7, v2 from semiDown619412746574101433);
create or replace view semiDown3398701580471306793 as select v2, v4 from semiUp1463193156987695215 where (v2) in (select v2 from semiDown7273937078462153485);
create or replace view semiDown2248941531944003589 as select v4, v6 from semiUp2543966526053414696 where (v4) in (select v4 from semiDown3398701580471306793);
create or replace view semiDown6428939700869921746 as select v4 from g5 where (v4) in (select v4 from semiDown2248941531944003589);
create or replace view aggView4390523664399115871 as select v2, v1, AVG(v2) as v21, AVG(v1) as v22, COUNT(*) as annot from semiDown3315061171337961010 group by v2,v1;
create or replace view aggView8322165074837134068 as select v4, COUNT(*) as annot from semiDown6428939700869921746 group by v4;
create or replace view aggJoin7002731366562542704 as select v4, v6, annot from semiDown2248941531944003589 join aggView8322165074837134068 using(v4);
create or replace view aggView6194685830942982841 as select v4, SUM(v6 * annot) as v20, SUM(annot) as annot from aggJoin7002731366562542704 group by v4;
create or replace view aggJoin8851118969699615060 as select v2, v20, annot from semiDown3398701580471306793 join aggView6194685830942982841 using(v4);
create or replace view aggView5381949630075569736 as select v2, SUM(v20) as v20, SUM(annot) as annot from aggJoin8851118969699615060 group by v2,v20;
create or replace view aggJoin637307291279999809 as select v7, v2, v20, annot from semiDown7273937078462153485 join aggView5381949630075569736 using(v2);
create or replace view aggView2871346525572833085 as select v7, v2, SUM(v20) as v20, SUM(annot) as annot from aggJoin637307291279999809 group by v7,v2,v20;
create or replace view aggView804827874619636057 as select v2, SUM(v20) as v20, v7, SUM(annot) as annot from aggView2871346525572833085 group by v2,v7,v20;
create or replace view aggJoin4459759307072097917 as select v21*aggView804827874619636057.annot as v21, v22*aggView804827874619636057.annot as v22, aggView4390523664399115871.annot * aggView804827874619636057.annot as annot, v20 * aggView4390523664399115871.annot as v20, v7, v1 from aggView4390523664399115871 join aggView804827874619636057 using(v2);
create or replace view res as select v1,v7,SUM(annot) as v19,SUM(v20) as v20,SUM(v21/annot) as v21,SUM(v22/annot) as v22 from aggJoin4459759307072097917 group by v1, v7;
select sum(v1), sum(v7), sum(v19), sum(v20), sum(v21), sum(v22) from res;