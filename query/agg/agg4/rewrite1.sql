create or replace view aggView5637044405122597024 as select dst as v2, SUM(src) as v9, COUNT(*) as annot, src as v1 from Graph as g1 group by dst,src;
create or replace view aggJoin5722067917604137802 as select src as v2, dst as v4, v9, v1, annot from Graph as g2, aggView5637044405122597024 where g2.src=aggView5637044405122597024.v2;
create or replace view orderView431242041195830667 as select src as v6, dst as v8, row_number() over (partition by src order by dst DESC) as rn from Graph as g4;
create or replace view minView8059847865858519976 as select v6, v8 as mfR8746397362724500464 from orderView431242041195830667 where rn = 1;
create or replace view joinView6431515138407997754 as select src as v4, dst as v6, mfR8746397362724500464 from Graph AS g3, minView8059847865858519976 where g3.dst=minView8059847865858519976.v6;
create or replace view orderView1478532751779622493 as select v4, v6, mfR8746397362724500464, row_number() over (partition by v4 order by mfR8746397362724500464 DESC) as rn from joinView6431515138407997754;
create or replace view minView4426622854473565820 as select v4, mfR8746397362724500464 as mfR5874244115538897553 from orderView1478532751779622493 where rn = 1;
create or replace view joinView803205897009798411 as select v2, v4, v9, v1, annot, mfR5874244115538897553 from aggJoin5722067917604137802 join minView4426622854473565820 using(v4) where v1<mfR5874244115538897553;
create or replace view sample5777056190154746636 as select * from orderView1478532751779622493 where rn % 5 = 1;
create or replace view maxRn5630488661293092 as select v4, max(rn) as mrn from joinView803205897009798411 join sample5777056190154746636 using(v4) where v1<mfR8746397362724500464 group by v4;
create or replace view target8963683799544505773 as select v4, v6, mfR8746397362724500464 from orderView1478532751779622493 join maxRn5630488661293092 using(v4) where rn < mrn + 5;
create or replace view end5075254450802141875 as select v2, v1, v9, v6, mfR8746397362724500464 from joinView803205897009798411 join target8963683799544505773 using(v4) where v1<mfR8746397362724500464 group by v2,v1,v6,mfR8746397362724500464;
create or replace view sample1572971984607553906 as select * from orderView431242041195830667 where rn % 5 = 1;
create or replace view maxRn7107623030593855623 as select v6, max(rn) as mrn from end5075254450802141875 join sample1572971984607553906 using(v6) where v1<v8 group by v6;
create or replace view target8939573722844100664 as select v6, v8 from orderView431242041195830667 join maxRn7107623030593855623 using(v6) where rn < mrn + 5;
create or replace view end3059302262140807272 as select v2, v9, v8 from end5075254450802141875 join target8939573722844100664 using(v6) where v1<v8 group by v2,v8;
select v2,v8,SUM(v9) as v9 from end3059302262140807272 group by v2, v8;
