create or replace view g3 as select Graph.src as v4, Graph.dst as v6, v10 from Graph, (SELECT src, COUNT(*) AS v10 FROM Graph GROUP BY src) AS c2 where Graph.dst = c2.src;
create or replace view orderView8736314845590169203 as select v4, v6, v10, row_number() over (partition by v4 order by v10 DESC) as rn from g3;
create or replace view minView3564053510705471904 as select v4, v10 as mfR3068473505922860898 from orderView8736314845590169203 where rn = 1;
create or replace view joinView4252133862165458202 as select src as v2, dst as v4, mfR3068473505922860898 from Graph AS g2, minView3564053510705471904 where g2.dst=minView3564053510705471904.v4;
create or replace view g1 as select Graph.src as v1, Graph.dst as v2, v8 from Graph, (SELECT src, COUNT(*) AS v8 FROM Graph GROUP BY src) AS c1 where Graph.src = c1.src;
create or replace view orderView1508666079840230255 as select v2, v4, mfR3068473505922860898, row_number() over (partition by v2 order by mfR3068473505922860898 DESC) as rn from joinView4252133862165458202;
create or replace view minView5719364849888902338 as select v2, mfR3068473505922860898 as mfR2875800549036126768 from orderView1508666079840230255 where rn = 1;
create or replace view joinView1719917380055875343 as select v1, v2, v8, mfR2875800549036126768 from g1 join minView5719364849888902338 using(v2) where v8<mfR2875800549036126768;
create or replace view sample1907860021593006797 as select * from orderView1508666079840230255 where rn % 5 = 1;
create or replace view maxRn5868011465254616856 as select v2, max(rn) as mrn from joinView1719917380055875343 join sample1907860021593006797 using(v2) where v8<mfR3068473505922860898 group by v2;
create or replace view target2021639317442213828 as select v2, v4, mfR3068473505922860898 from orderView1508666079840230255 join maxRn5868011465254616856 using(v2) where rn < mrn + 5;
create or replace view end5171086560027768210 as select v1, v8, v4, v2, mfR3068473505922860898 from joinView1719917380055875343 join target2021639317442213828 using(v2) where v8<mfR3068473505922860898;
create or replace view sample4667287415919343808 as select * from orderView8736314845590169203 where rn % 5 = 1;
create or replace view maxRn9077866189149192680 as select v4, max(rn) as mrn from end5171086560027768210 join sample4667287415919343808 using(v4) where v8<v10 group by v4;
create or replace view target1380727735188710689 as select v4, v6, v10 from orderView8736314845590169203 join maxRn9077866189149192680 using(v4) where rn < mrn + 5;
create or replace view end3145558741005453759 as select v1, v8, v6, v4, v2, v10 from end5171086560027768210 join target1380727735188710689 using(v4) where v8<v10;
select v1, v2, v4, v6, v8, v10 from end3145558741005453759;
