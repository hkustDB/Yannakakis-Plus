create or replace view g3 as select Graph.src as v4, Graph.dst as v6, v10 from Graph, (SELECT src, COUNT(*) AS v10 FROM Graph GROUP BY src) AS c2 where Graph.dst = c2.src;
create or replace view orderView8035994316679276247 as select v4, v6, v10, row_number() over (partition by v4 order by v10) as rn from g3;
create or replace view minView6577448004733749312 as select v4, v10 as mfL573371214827397902 from orderView8035994316679276247 where rn = 1;
create or replace view joinView4871152454099653555 as select src as v2, dst as v4, mfL573371214827397902 from Graph AS g2, minView6577448004733749312 where g2.dst=minView6577448004733749312.v4;
create or replace view g1 as select Graph.src as v7, Graph.dst as v2, v8 from Graph, (SELECT src, COUNT(*) AS v8 FROM Graph GROUP BY src) AS c1 where Graph.src = c1.src;
create or replace view orderView5750703883360351877 as select v7, v2, v8, row_number() over (partition by v2 order by v8 DESC) as rn from g1;
create or replace view minView6613587613906611760 as select v2, v8 as mfR390829787938018830 from orderView5750703883360351877 where rn = 1;
create or replace view joinView9028616587998857026 as select v2, v4, mfL573371214827397902, mfR390829787938018830 from joinView4871152454099653555 join minView6613587613906611760 using(v2) where mfL573371214827397902<=mfR390829787938018830;
create or replace view sample691756724002924940 as select * from orderView5750703883360351877 where rn % 5 = 1;
create or replace view maxRn8729650621728992770 as select v2, max(rn) as mrn from joinView9028616587998857026 join sample691756724002924940 using(v2) where mfL573371214827397902<=v8 group by v2;
create or replace view target1918722439718959334 as select v7, v2, v8 from orderView5750703883360351877 join maxRn8729650621728992770 using(v2) where rn < mrn + 5;
create or replace view end5793332309339816726 as select v4, v8, v2, v7, mfL573371214827397902 from joinView9028616587998857026 join target1918722439718959334 using(v2) where mfL573371214827397902<=v8;
create or replace view sample977399862097908375 as select * from orderView8035994316679276247 where rn % 5 = 1;
create or replace view maxRn9026700313425157398 as select v4, max(rn) as mrn from end5793332309339816726 join sample977399862097908375 using(v4) where v10<=v8 group by v4;
create or replace view target3359361283252671983 as select v4, v6, v10 from orderView8035994316679276247 join maxRn9026700313425157398 using(v4) where rn < mrn + 5;
create or replace view end4165270316392615455 as select v4, v8, v10, v2, v7, v6 from end5793332309339816726 join target3359361283252671983 using(v4) where v10<=v8;
select v7, v2, v4, v6, v8, v10 from end4165270316392615455;
