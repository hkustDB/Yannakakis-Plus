create or replace view g1 as select Graph.src as v1, Graph.dst as v2, v8 from Graph, (SELECT src, COUNT(*) AS v8 FROM Graph GROUP BY src) AS c1 where Graph.src = c1.src;
create or replace view orderView1947727368063044390 as select v1, v2, v8, row_number() over (partition by v2 order by v8) as rn from g1;
create or replace view minView2532017102651017099 as select v2, v8 as mfL7155191615852546882 from orderView1947727368063044390 where rn = 1;
create or replace view joinView5287326421687254392 as select src as v2, dst as v4, mfL7155191615852546882 from Graph AS g2, minView2532017102651017099 where g2.src=minView2532017102651017099.v2;
create or replace view g3 as select Graph.src as v4, Graph.dst as v6, v10 from Graph, (SELECT src, COUNT(*) AS v10 FROM Graph GROUP BY src) AS c2 where Graph.dst = c2.src;
create or replace view orderView9108896442550535145 as select v2, v4, mfL7155191615852546882, row_number() over (partition by v4 order by mfL7155191615852546882) as rn from joinView5287326421687254392;
create or replace view minView5030909080665262651 as select v4, mfL7155191615852546882 as mfL1905742241675313364 from orderView9108896442550535145 where rn = 1;
create or replace view joinView9129126772785350265 as select v4, v6, v10, mfL1905742241675313364 from g3 join minView5030909080665262651 using(v4) where mfL1905742241675313364<v10;
create or replace view sample1216761764236812731 as select * from orderView9108896442550535145 where rn % 100 = 1;
create or replace view maxRn2056502089354391627 as select v4, max(rn) as mrn from joinView9129126772785350265 join sample1216761764236812731 using(v4) where mfL7155191615852546882<v10 group by v4;
create or replace view target7636828649251532153 as select v2, v4, mfL7155191615852546882 from orderView9108896442550535145 join maxRn2056502089354391627 using(v4) where rn < mrn + 5;
create or replace view end1591698175340050358 as select v2, v6, v4, v10, mfL7155191615852546882 from joinView9129126772785350265 join target7636828649251532153 using(v4) where mfL7155191615852546882<v10;
create or replace view sample2260450260301013499 as select * from orderView1947727368063044390 where rn % 100 = 1;
create or replace view maxRn7966251917228961468 as select v2, max(rn) as mrn from end1591698175340050358 join sample2260450260301013499 using(v2) where v8<v10 group by v2;
create or replace view target2571749557495043014 as select v1, v2, v8 from orderView1947727368063044390 join maxRn7966251917228961468 using(v2) where rn < mrn + 5;
create or replace view end7432108857204609087 as select v1, v8, v6, v4, v2, v10 from end1591698175340050358 join target2571749557495043014 using(v2) where v8<v10;
select sum(v1+v2+v4+v6+v8+v10) from end7432108857204609087;
