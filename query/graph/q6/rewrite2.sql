create or replace view g1 as select Graph.src as v7, Graph.dst as v2, v8 from Graph, (SELECT src, COUNT(*) AS v8 FROM Graph GROUP BY src) AS c1 where Graph.src = c1.src;
create or replace view orderView4356039939568789926 as select v7, v2, v8, row_number() over (partition by v2 order by v8) as rn from g1;
create or replace view minView398083810330037554 as select v2, v8 as mfL6699443890250285555 from orderView4356039939568789926 where rn = 1;
create or replace view joinView3213806558835278513 as select src as v2, dst as v4, mfL6699443890250285555 from Graph AS g2, minView398083810330037554 where g2.src=minView398083810330037554.v2;
create or replace view g3 as select Graph.src as v4, Graph.dst as v6, v10 from Graph, (SELECT src, COUNT(*) AS v10 FROM Graph GROUP BY src) AS c2 where Graph.dst = c2.src;
create or replace view orderView2732159224560793403 as select v4, v6, v10, row_number() over (partition by v4 order by v6 DESC) as rn from g3;
create or replace view minView3339350685649767858 as select v4, v6 as mfR5780754001538480609 from orderView2732159224560793403 where rn = 1;
create or replace view joinView7973022347573615691 as select v2, v4, mfL6699443890250285555, mfR5780754001538480609 from joinView3213806558835278513 join minView3339350685649767858 using(v4) where mfL6699443890250285555<mfR5780754001538480609;
create or replace view sample4004870737386114485 as select * from orderView2732159224560793403 where rn % 5 = 1;
create or replace view maxRn7862453374076424738 as select v4, max(rn) as mrn from joinView7973022347573615691 join sample4004870737386114485 using(v4) where mfL6699443890250285555<v6 group by v4;
create or replace view target9195079394148841194 as select v4, v6, v10 from orderView2732159224560793403 join maxRn7862453374076424738 using(v4) where rn < mrn + 5;
create or replace view end4492042981917101131 as select v4, v2, v10, v6, mfL6699443890250285555 from joinView7973022347573615691 join target9195079394148841194 using(v4) where mfL6699443890250285555<v6;
create or replace view sample6344832788316917417 as select * from orderView4356039939568789926 where rn % 5 = 1;
create or replace view maxRn1073366012979202621 as select v2, max(rn) as mrn from end4492042981917101131 join sample6344832788316917417 using(v2) where v8<v6 group by v2;
create or replace view target9198777421202805758 as select v7, v2, v8 from orderView4356039939568789926 join maxRn1073366012979202621 using(v2) where rn < mrn + 5;
create or replace view end4292845797271045021 as select v4, v2, v10, v7, v6, v8 from end4492042981917101131 join target9198777421202805758 using(v2) where v8<v6;
select sum(v7+v2+v4+v6+v8+v10) from end4292845797271045021;
