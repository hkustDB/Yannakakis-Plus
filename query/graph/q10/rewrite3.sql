create or replace view orderView6004605197809699663 as select src as v6, dst as v8, row_number() over (partition by src order by dst DESC) as rn from Graph as g4;
create or replace view minView8907182895875211270 as select v6, v8 as mfR2730085174632867472 from orderView6004605197809699663 where rn = 1;
create or replace view joinView4957326171300745848 as select src as v4, dst as v6, mfR2730085174632867472 from Graph AS g3, minView8907182895875211270 where g3.dst=minView8907182895875211270.v6;
create or replace view orderView382526675703276054 as select v4, v6, mfR2730085174632867472, row_number() over (partition by v4 order by mfR2730085174632867472 DESC) as rn from joinView4957326171300745848;
create or replace view minView3565099113218202561 as select v4, mfR2730085174632867472 as mfR2297706350985644227 from orderView382526675703276054 where rn = 1;
create or replace view joinView3198221863995284654 as select src as v2, dst as v4, mfR2297706350985644227 from Graph AS g2, minView3565099113218202561 where g2.dst=minView3565099113218202561.v4;
create or replace view orderView3354204805539305730 as select v2, v4, mfR2297706350985644227, row_number() over (partition by v2 order by mfR2297706350985644227 DESC) as rn from joinView3198221863995284654;
create or replace view minView5736364326784210835 as select v2, mfR2297706350985644227 as mfR1133718419838903036 from orderView3354204805539305730 where rn = 1;
create or replace view joinView7434866575809690990 as select src as v1, dst as v2, mfR1133718419838903036 from Graph AS g1, minView5736364326784210835 where g1.dst=minView5736364326784210835.v2 and src<mfR1133718419838903036;
create or replace view sample6465404048437948382 as select * from orderView3354204805539305730 where rn % 5 = 1;
create or replace view maxRn6420591333298599365 as select v2, max(rn) as mrn from joinView7434866575809690990 join sample6465404048437948382 using(v2) where v1<mfR2297706350985644227 group by v2;
create or replace view target1108820434466949757 as select v2, v4, mfR2297706350985644227 from orderView3354204805539305730 join maxRn6420591333298599365 using(v2) where rn < mrn + 5;
create or replace view end1794549412057580622 as select v2, v4, v1, mfR2297706350985644227 from joinView7434866575809690990 join target1108820434466949757 using(v2) where v1<mfR2297706350985644227;
create or replace view sample4878041065078632965 as select * from orderView382526675703276054 where rn % 5 = 1;
create or replace view maxRn4907237053672677357 as select v4, max(rn) as mrn from end1794549412057580622 join sample4878041065078632965 using(v4) where v1<mfR2730085174632867472 group by v4;
create or replace view target8172188204483280869 as select v4, v6, mfR2730085174632867472 from orderView382526675703276054 join maxRn4907237053672677357 using(v4) where rn < mrn + 5;
create or replace view end1500893287411232979 as select v2, v4, v6, v1, mfR2730085174632867472 from end1794549412057580622 join target8172188204483280869 using(v4) where v1<mfR2730085174632867472;
create or replace view sample3455378837957739910 as select * from orderView6004605197809699663 where rn % 5 = 1;
create or replace view maxRn694856208958552248 as select v6, max(rn) as mrn from end1500893287411232979 join sample3455378837957739910 using(v6) where v1<v8 group by v6;
create or replace view target217469169031622088 as select v6, v8 from orderView6004605197809699663 join maxRn694856208958552248 using(v6) where rn < mrn + 5;
create or replace view end2893733090287603464 as select v2, v8, v4, v6, v1 from end1500893287411232979 join target217469169031622088 using(v6) where v1<v8;
select sum(v1+v2+v4+v6+v8) from end2893733090287603464;
