create or replace view orderView1539821219266667542 as select src as v6, dst as v8, row_number() over (partition by src order by dst DESC) as rn from Graph as g4;
create or replace view minView1867727317457988147 as select v6, v8 as mfR1441434067700847305 from orderView1539821219266667542 where rn = 1;
create or replace view joinView8680762583619568996 as select src as v4, dst as v6, mfR1441434067700847305 from Graph AS g3, minView1867727317457988147 where g3.dst=minView1867727317457988147.v6;
create or replace view orderView5388602881028595691 as select v4, v6, mfR1441434067700847305, row_number() over (partition by v4 order by mfR1441434067700847305 DESC) as rn from joinView8680762583619568996;
create or replace view minView187459921521316880 as select v4, mfR1441434067700847305 as mfR6721719011051664906 from orderView5388602881028595691 where rn = 1;
create or replace view joinView2926884247619734563 as select src as v2, dst as v4, mfR6721719011051664906 from Graph AS g2, minView187459921521316880 where g2.dst=minView187459921521316880.v4;
create or replace view orderView3275860770892184509 as select v2, v4, mfR6721719011051664906, row_number() over (partition by v2 order by mfR6721719011051664906 DESC) as rn from joinView2926884247619734563;
create or replace view minView5254840572362701245 as select v2, mfR6721719011051664906 as mfR1933819973015993044 from orderView3275860770892184509 where rn = 1;
create or replace view joinView8864200267743917535 as select src as v1, dst as v2, mfR1933819973015993044 from Graph AS g1, minView5254840572362701245 where g1.dst=minView5254840572362701245.v2 and src<mfR1933819973015993044;
create or replace view sample7835495751629701991 as select * from orderView3275860770892184509 where rn % 5 = 1;
create or replace view maxRn91458300594679090 as select v2, max(rn) as mrn from joinView8864200267743917535 join sample7835495751629701991 using(v2) where v1<mfR6721719011051664906 group by v2;
create or replace view target3788979984457147340 as select v2, v4, mfR6721719011051664906 from orderView3275860770892184509 join maxRn91458300594679090 using(v2) where rn < mrn + 5;
create or replace view end6163649208082124156 as select v1, v4, v2, mfR6721719011051664906 from joinView8864200267743917535 join target3788979984457147340 using(v2) where v1<mfR6721719011051664906;
create or replace view sample9172235540337396040 as select * from orderView5388602881028595691 where rn % 5 = 1;
create or replace view maxRn1507920970206170444 as select v4, max(rn) as mrn from end6163649208082124156 join sample9172235540337396040 using(v4) where v1<mfR1441434067700847305 group by v4;
create or replace view target2513569792102392016 as select v4, v6, mfR1441434067700847305 from orderView5388602881028595691 join maxRn1507920970206170444 using(v4) where rn < mrn + 5;
create or replace view end476113917558619105 as select v1, v4, v2, v6, mfR1441434067700847305 from end6163649208082124156 join target2513569792102392016 using(v4) where v1<mfR1441434067700847305;
create or replace view sample7165110250832211983 as select * from orderView1539821219266667542 where rn % 5 = 1;
create or replace view maxRn5117562536027421702 as select v6, max(rn) as mrn from end476113917558619105 join sample7165110250832211983 using(v6) where v1<v8 group by v6;
create or replace view target5411252854222432492 as select v6, v8 from orderView1539821219266667542 join maxRn5117562536027421702 using(v6) where rn < mrn + 5;
create or replace view end5462489014641964538 as select v1, v4, v2, v6, v8 from end476113917558619105 join target5411252854222432492 using(v6) where v1<v8;
select sum(v1+v2+v4+v6+v8) from end5462489014641964538;
