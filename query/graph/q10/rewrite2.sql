create or replace view orderView9134461941867854161 as select src as v6, dst as v8, row_number() over (partition by src order by dst DESC) as rn from Graph as g4;
create or replace view minView3763787800062165563 as select v6, v8 as mfR3983126334108884678 from orderView9134461941867854161 where rn = 1;
create or replace view joinView7051676799064857238 as select src as v4, dst as v6, mfR3983126334108884678 from Graph AS g3, minView3763787800062165563 where g3.dst=minView3763787800062165563.v6;
create or replace view orderView2084555305113253135 as select src as v1, dst as v2, row_number() over (partition by dst order by src) as rn from Graph as g1;
create or replace view minView3880175820025287257 as select v2, v1 as mfL1357058450418199521 from orderView2084555305113253135 where rn = 1;
create or replace view joinView7001444241721773701 as select src as v2, dst as v4, mfL1357058450418199521 from Graph AS g2, minView3880175820025287257 where g2.src=minView3880175820025287257.v2;
create or replace view orderView3578071200480410577 as select v4, v6, mfR3983126334108884678, row_number() over (partition by v4 order by mfR3983126334108884678 DESC) as rn from joinView7051676799064857238;
create or replace view minView5542713893028670316 as select v4, mfR3983126334108884678 as mfR848273727096710930 from orderView3578071200480410577 where rn = 1;
create or replace view joinView6470075272989522610 as select v2, v4, mfL1357058450418199521, mfR848273727096710930 from joinView7001444241721773701 join minView5542713893028670316 using(v4) where mfL1357058450418199521<mfR848273727096710930;
create or replace view sample1136000337394570646 as select * from orderView3578071200480410577 where rn % 5 = 1;
create or replace view maxRn7620454584663595262 as select v4, max(rn) as mrn from joinView6470075272989522610 join sample1136000337394570646 using(v4) where mfL1357058450418199521<mfR3983126334108884678 group by v4;
create or replace view target3309368164541659910 as select v4, v6, mfR3983126334108884678 from orderView3578071200480410577 join maxRn7620454584663595262 using(v4) where rn < mrn + 5;
create or replace view end52421406249142754 as select v2, v4, v6, mfL1357058450418199521, mfR3983126334108884678 from joinView6470075272989522610 join target3309368164541659910 using(v4) where mfL1357058450418199521<mfR3983126334108884678;
create or replace view sample4658841480841644662 as select * from orderView2084555305113253135 where rn % 5 = 1;
create or replace view maxRn8976941672590936969 as select v2, max(rn) as mrn from end52421406249142754 join sample4658841480841644662 using(v2) where v1<mfR3983126334108884678 group by v2;
create or replace view target4817776996579600031 as select v1, v2 from orderView2084555305113253135 join maxRn8976941672590936969 using(v2) where rn < mrn + 5;
create or replace view end1142244160043638386 as select v2, v4, v6, v1, mfR3983126334108884678 from end52421406249142754 join target4817776996579600031 using(v2) where v1<mfR3983126334108884678;
create or replace view sample5202124875231567182 as select * from orderView9134461941867854161 where rn % 5 = 1;
create or replace view maxRn8818747209208360052 as select v6, max(rn) as mrn from end1142244160043638386 join sample5202124875231567182 using(v6) where v1<v8 group by v6;
create or replace view target6042822811143809621 as select v6, v8 from orderView9134461941867854161 join maxRn8818747209208360052 using(v6) where rn < mrn + 5;
create or replace view end3706478315727498075 as select v2, v8, v4, v6, v1 from end1142244160043638386 join target6042822811143809621 using(v6) where v1<v8;
select sum(v1+v2+v4+v6+v8) from end3706478315727498075;
