create or replace view g3 as select Graph.src as v4, Graph.dst as v9, v10, v14 from Graph, (SELECT src, COUNT(*) AS v10 FROM Graph GROUP BY src) AS c2, (SELECT dst, COUNT(*) AS v14 FROM Graph GROUP BY dst) AS c4 where Graph.dst = c2.src and Graph.dst = c4.dst;
create or replace view g2 as select Graph.src as v2, Graph.dst as v4, v12 from Graph, (SELECT src, COUNT(*) AS v12 FROM Graph GROUP BY src) AS c3 where Graph.src = c3.src;
create or replace view orderView50535046905570549 as select v4, v9, v10, v14, row_number() over (partition by v4 order by v10 DESC) as rn from g3;
create or replace view minView5143807157870430591 as select v4, v10 as mfR7659949028933813098 from orderView50535046905570549 where rn = 1;
create or replace view joinView8769292068748113602 as select v2, v4, v12, mfR7659949028933813098 from g2 join minView5143807157870430591 using(v4);
create or replace view g1 as select Graph.src as v7, Graph.dst as v2, v8 from Graph, (SELECT src, COUNT(*) AS v8 FROM Graph GROUP BY src) AS c1 where Graph.src = c1.src;
create or replace view orderView5180749733150565495 as select v2, v4, v12, mfR7659949028933813098, row_number() over (partition by v2 order by mfR7659949028933813098 DESC) as rn from joinView8769292068748113602;
create or replace view minView4003915050385316316 as select v2, mfR7659949028933813098 as mfR216347253136616349 from orderView5180749733150565495 where rn = 1;
create or replace view joinView3919052555419805535 as select v7, v2, v8, mfR216347253136616349 from g1 join minView4003915050385316316 using(v2) where v8<mfR216347253136616349;
create or replace view sample5836242294923791796 as select * from orderView5180749733150565495 where rn % 5 = 1;
create or replace view maxRn8682959302969629853 as select v2, max(rn) as mrn from joinView3919052555419805535 join sample5836242294923791796 using(v2) where v8<mfR7659949028933813098 group by v2;
create or replace view target6843650297708854891 as select v2, v4, v12, mfR7659949028933813098 from orderView5180749733150565495 join maxRn8682959302969629853 using(v2) where rn < mrn + 5;
create or replace view end6714159572305354103 as select v7, v12, v2, v8, v4, mfR7659949028933813098 from joinView3919052555419805535 join target6843650297708854891 using(v2) where v8<mfR7659949028933813098;
create or replace view sample7500326409652811140 as select * from orderView50535046905570549 where rn % 5 = 1;
create or replace view maxRn695315204289988357 as select v4, max(rn) as mrn from end6714159572305354103 join sample7500326409652811140 using(v4) where v8<v10 group by v4;
create or replace view target3019017513785047473 as select v4, v9, v10, v14 from orderView50535046905570549 join maxRn695315204289988357 using(v4) where rn < mrn + 5;
create or replace view end2480614639464946899 as select v7, v9, v12, v10, v2, v14, v8, v4 from end6714159572305354103 join target3019017513785047473 using(v4) where v8<v10 and v12<v14;
select sum(v7+v2+v4+v9+v8+v10+v12+v14) from end2480614639464946899;
