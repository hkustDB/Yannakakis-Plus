create or replace view g1 as select Graph.src as v7, Graph.dst as v2, v8 from Graph, (SELECT src, COUNT(*) AS v8 FROM Graph GROUP BY src) AS c1 where Graph.src = c1.src;
create or replace view g2 as select Graph.src as v2, Graph.dst as v4, v12 from Graph, (SELECT src, COUNT(*) AS v12 FROM Graph GROUP BY src) AS c3 where Graph.src = c3.src;
create or replace view orderView166326580573057623 as select v7, v2, v8, row_number() over (partition by v2 order by v8) as rn from g1;
create or replace view minView920767603332010762 as select v2, v8 as mfL8959815592606988527 from orderView166326580573057623 where rn = 1;
create or replace view joinView2250282077725544693 as select v2, v4, v12, mfL8959815592606988527 from g2 join minView920767603332010762 using(v2);
create or replace view g3 as select Graph.src as v4, Graph.dst as v9, v10, v14 from Graph, (SELECT src, COUNT(*) AS v10 FROM Graph GROUP BY src) AS c2, (SELECT dst, COUNT(*) AS v14 FROM Graph GROUP BY dst) AS c4 where Graph.dst = c2.src and Graph.dst = c4.dst;
create or replace view orderView2398228262013915449 as select v2, v4, v12, mfL8959815592606988527, row_number() over (partition by v4 order by mfL8959815592606988527) as rn from joinView2250282077725544693;
create or replace view minView3717246911210794719 as select v4, mfL8959815592606988527 as mfL7598534237870140324 from orderView2398228262013915449 where rn = 1;
create or replace view joinView3325683886142984952 as select v4, v9, v10, v14, mfL7598534237870140324 from g3 join minView3717246911210794719 using(v4) where mfL7598534237870140324<v10;
create or replace view sample3342725583536502061 as select * from orderView2398228262013915449 where rn % 5 = 1;
create or replace view maxRn6408634090002403309 as select v4, max(rn) as mrn from joinView3325683886142984952 join sample3342725583536502061 using(v4) where mfL8959815592606988527<v10 group by v4;
create or replace view target5762279887916921886 as select v2, v4, v12, mfL8959815592606988527 from orderView2398228262013915449 join maxRn6408634090002403309 using(v4) where rn < mrn + 5;
create or replace view end3523963266549806261 as select v9, v12, v10, v2, v14, v4, mfL8959815592606988527 from joinView3325683886142984952 join target5762279887916921886 using(v4) where mfL8959815592606988527<v10 and v12<v14;
create or replace view sample4596278560737236716 as select * from orderView166326580573057623 where rn % 5 = 1;
create or replace view maxRn3084064350111951384 as select v2, max(rn) as mrn from end3523963266549806261 join sample4596278560737236716 using(v2) where v8<v10 group by v2;
create or replace view target369467017003504186 as select v7, v2, v8 from orderView166326580573057623 join maxRn3084064350111951384 using(v2) where rn < mrn + 5;
create or replace view end4934822469665278189 as select v7, v9, v12, v10, v2, v14, v8, v4 from end3523963266549806261 join target369467017003504186 using(v2) where v8<v10;
select sum(v7+v2+v4+v9+v8+v10+v12+v14) from end4934822469665278189;
