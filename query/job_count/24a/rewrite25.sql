create or replace view aggView6816783404924234565 as select id as v23 from company_name as cn where country_code= '[us]';
create or replace view aggJoin7684214898628673328 as select movie_id as v59 from movie_companies as mc, aggView6816783404924234565 where mc.company_id=aggView6816783404924234565.v23;
create or replace view aggView9119992760287638219 as select id as v32 from keyword as k where keyword IN ('hero','martial-arts','hand-to-hand-combat');
create or replace view aggJoin1139444323940544608 as select movie_id as v59 from movie_keyword as mk, aggView9119992760287638219 where mk.keyword_id=aggView9119992760287638219.v32;
create or replace view aggView5004957640557255960 as select v59, COUNT(*) as annot from aggJoin1139444323940544608 group by v59;
create or replace view aggJoin8532093870845634853 as select v59, annot from aggJoin7684214898628673328 join aggView5004957640557255960 using(v59);
create or replace view aggView2936527326378857986 as select v59, SUM(annot) as annot from aggJoin8532093870845634853 group by v59;
create or replace view aggJoin5122665869437272746 as select id as v59, production_year as v63, annot from title as t, aggView2936527326378857986 where t.id=aggView2936527326378857986.v59 and production_year>2010;
create or replace view aggView2349190578937885254 as select v59, SUM(annot) as annot from aggJoin5122665869437272746 group by v59;
create or replace view aggJoin6839580474027598234 as select movie_id as v59, info_type_id as v30, info as v43, annot from movie_info as mi, aggView2349190578937885254 where mi.movie_id=aggView2349190578937885254.v59 and ((info LIKE 'Japan:%201%') OR (info LIKE 'USA:%201%'));
create or replace view aggView7293011850959734060 as select person_id as v48, COUNT(*) as annot from aka_name as an group by person_id;
create or replace view aggJoin910380081510740890 as select person_id as v48, movie_id as v59, person_role_id as v9, note as v20, role_id as v57, annot from cast_info as ci, aggView7293011850959734060 where ci.person_id=aggView7293011850959734060.v48 and note IN ('(voice)','(voice: Japanese version)','(voice) (uncredited)','(voice: English version)');
create or replace view aggView8165949952519505940 as select id as v30 from info_type as it where info= 'release dates';
create or replace view aggJoin7785239178949718974 as select v59, v43, annot from aggJoin6839580474027598234 join aggView8165949952519505940 using(v30);
create or replace view aggView5771428818238151341 as select v59, SUM(annot) as annot from aggJoin7785239178949718974 group by v59;
create or replace view aggJoin5155867460756124668 as select v48, v9, v20, v57, aggJoin910380081510740890.annot * aggView5771428818238151341.annot as annot from aggJoin910380081510740890 join aggView5771428818238151341 using(v59);
create or replace view aggView164047523204500150 as select id as v48 from name as n where name LIKE '%An%' and gender= 'f';
create or replace view aggJoin7563792653038358276 as select v9, v20, v57, annot from aggJoin5155867460756124668 join aggView164047523204500150 using(v48);
create or replace view aggView1701069230715628617 as select id as v57 from role_type as rt where role= 'actress';
create or replace view aggJoin570610138787150069 as select v9, v20, annot from aggJoin7563792653038358276 join aggView1701069230715628617 using(v57);
create or replace view aggView3270244930822077002 as select v9, SUM(annot) as annot from aggJoin570610138787150069 group by v9;
create or replace view aggJoin5555497998442516891 as select annot from char_name as chn, aggView3270244930822077002 where chn.id=aggView3270244930822077002.v9;
select SUM(annot) as v71 from aggJoin5555497998442516891;
