create or replace view aggView4013139205992486074 as select id as v17 from company_name as cn where country_code<> '[pl]' and ((name LIKE '%Film%') OR (name LIKE '%Warner%'));
create or replace view aggJoin5530032543865980325 as select movie_id as v24, company_type_id as v18 from movie_companies as mc, aggView4013139205992486074 where mc.company_id=aggView4013139205992486074.v17;
create or replace view aggView5672517951785769758 as select id as v13 from link_type as lt where link LIKE '%follows%';
create or replace view aggJoin6668584098238288209 as select movie_id as v24 from movie_link as ml, aggView5672517951785769758 where ml.link_type_id=aggView5672517951785769758.v13;
create or replace view aggView8578246229784589186 as select v24, COUNT(*) as annot from aggJoin6668584098238288209 group by v24;
create or replace view aggJoin4407703708516190649 as select v24, v18, annot from aggJoin5530032543865980325 join aggView8578246229784589186 using(v24);
create or replace view aggView5550110101840913520 as select id as v18 from company_type as ct where kind= 'production companies';
create or replace view aggJoin123416239645029025 as select v24, annot from aggJoin4407703708516190649 join aggView5550110101840913520 using(v18);
create or replace view aggView7235348662714910235 as select id as v22 from keyword as k where keyword= 'sequel';
create or replace view aggJoin6636943747731783382 as select movie_id as v24 from movie_keyword as mk, aggView7235348662714910235 where mk.keyword_id=aggView7235348662714910235.v22;
create or replace view aggView568743933623189080 as select v24, SUM(annot) as annot from aggJoin123416239645029025 group by v24;
create or replace view aggJoin3029782617134540366 as select id as v24, title as v28, production_year as v31, annot from title as t, aggView568743933623189080 where t.id=aggView568743933623189080.v24 and title LIKE '%Money%' and production_year= 1998;
create or replace view aggView8343181203843037329 as select v24, SUM(annot) as annot from aggJoin3029782617134540366 group by v24;
create or replace view aggJoin3589270530591406864 as select annot from aggJoin6636943747731783382 join aggView8343181203843037329 using(v24);
select SUM(annot) as v39 from aggJoin3589270530591406864;
