create or replace view aggView2569762210365757296 as select id as v25 from keyword as k where keyword= 'character-name-in-title';
create or replace view aggJoin2242978108531449130 as select movie_id as v3 from movie_keyword as mk, aggView2569762210365757296 where mk.keyword_id=aggView2569762210365757296.v25;
create or replace view aggView3337761175378977769 as select v3, COUNT(*) as annot from aggJoin2242978108531449130 group by v3;
create or replace view aggJoin3280910937657226935 as select movie_id as v3, company_id as v20, annot from movie_companies as mc, aggView3337761175378977769 where mc.movie_id=aggView3337761175378977769.v3;
create or replace view aggView5838518857037407068 as select id as v20 from company_name as cn where country_code= '[us]';
create or replace view aggJoin1643320889306489525 as select v3, annot from aggJoin3280910937657226935 join aggView5838518857037407068 using(v20);
create or replace view aggView5035724458820228677 as select v3, SUM(annot) as annot from aggJoin1643320889306489525 group by v3;
create or replace view aggJoin8044219622877011019 as select id as v3, annot from title as t, aggView5035724458820228677 where t.id=aggView5035724458820228677.v3;
create or replace view aggView813819548171861881 as select v3, SUM(annot) as annot from aggJoin8044219622877011019 group by v3;
create or replace view aggJoin1071904480102011762 as select person_id as v26, annot from cast_info as ci, aggView813819548171861881 where ci.movie_id=aggView813819548171861881.v3;
create or replace view aggView7042862459659966190 as select v26, SUM(annot) as annot from aggJoin1071904480102011762 group by v26;
create or replace view aggJoin4700901948022204748 as select annot from name as n, aggView7042862459659966190 where n.id=aggView7042862459659966190.v26;
select SUM(annot) as v47 from aggJoin4700901948022204748;
