create or replace view aggView7903074852664314665 as select id as v8 from company_type as ct where kind IN ('production companies','distributors');
create or replace view aggJoin4468284821584647774 as select movie_id as v29, company_id as v1 from movie_companies as mc, aggView7903074852664314665 where mc.company_type_id=aggView7903074852664314665.v8;
create or replace view aggView7729068806510941716 as select id as v26 from info_type as it2 where info= 'bottom 10 rank';
create or replace view aggJoin8320207838654152365 as select movie_id as v29 from movie_info_idx as mi_idx, aggView7729068806510941716 where mi_idx.info_type_id=aggView7729068806510941716.v26;
create or replace view aggView3144819811389571954 as select id as v1 from company_name as cn where country_code= '[us]';
create or replace view aggJoin6986947749583558685 as select v29 from aggJoin4468284821584647774 join aggView3144819811389571954 using(v1);
create or replace view aggView1473599673713671325 as select v29, COUNT(*) as annot from aggJoin8320207838654152365 group by v29;
create or replace view aggJoin4925064342592907381 as select v29, annot from aggJoin6986947749583558685 join aggView1473599673713671325 using(v29);
create or replace view aggView7120319972826954832 as select v29, SUM(annot) as annot from aggJoin4925064342592907381 group by v29;
create or replace view aggJoin7833283970767262779 as select id as v29, title as v30, production_year as v33, annot from title as t, aggView7120319972826954832 where t.id=aggView7120319972826954832.v29 and production_year>2000 and ((title LIKE 'Birdemic%') OR (title LIKE '%Movie%'));
create or replace view aggView5942658146486210568 as select v29, SUM(annot) as annot from aggJoin7833283970767262779 group by v29;
create or replace view aggJoin1980785957214523960 as select info_type_id as v21, annot from movie_info as mi, aggView5942658146486210568 where mi.movie_id=aggView5942658146486210568.v29;
create or replace view aggView5110821039596893174 as select id as v21 from info_type as it1 where info= 'budget';
create or replace view aggJoin2269088529551472322 as select annot from aggJoin1980785957214523960 join aggView5110821039596893174 using(v21);
select SUM(annot) as v41 from aggJoin2269088529551472322;
