create or replace view aggView1165238434840846636 as select id as v26 from info_type as it2 where info= 'bottom 10 rank';
create or replace view aggJoin3578828043805467393 as select movie_id as v29 from movie_info_idx as mi_idx, aggView1165238434840846636 where mi_idx.info_type_id=aggView1165238434840846636.v26;
create or replace view aggView2721537855715962477 as select id as v1 from company_name as cn where country_code= '[us]';
create or replace view aggJoin3626237984661676729 as select movie_id as v29, company_type_id as v8 from movie_companies as mc, aggView2721537855715962477 where mc.company_id=aggView2721537855715962477.v1;
create or replace view aggView8954590371789489591 as select id as v21 from info_type as it1 where info= 'budget';
create or replace view aggJoin7218238212784671971 as select movie_id as v29 from movie_info as mi, aggView8954590371789489591 where mi.info_type_id=aggView8954590371789489591.v21;
create or replace view aggView2444203725245523912 as select v29, COUNT(*) as annot from aggJoin7218238212784671971 group by v29;
create or replace view aggJoin1980797299920853242 as select v29, annot from aggJoin3578828043805467393 join aggView2444203725245523912 using(v29);
create or replace view aggView1587948168135844154 as select v29, SUM(annot) as annot from aggJoin1980797299920853242 group by v29;
create or replace view aggJoin1005837696681934793 as select id as v29, title as v30, production_year as v33, annot from title as t, aggView1587948168135844154 where t.id=aggView1587948168135844154.v29 and production_year>2000 and ((title LIKE 'Birdemic%') OR (title LIKE '%Movie%'));
create or replace view aggView4527872260342484708 as select v29, SUM(annot) as annot from aggJoin1005837696681934793 group by v29;
create or replace view aggJoin3691965450456534071 as select v8, annot from aggJoin3626237984661676729 join aggView4527872260342484708 using(v29);
create or replace view aggView1633327435923712132 as select v8, SUM(annot) as annot from aggJoin3691965450456534071 group by v8;
create or replace view aggJoin3926391477095718309 as select kind as v9, annot from company_type as ct, aggView1633327435923712132 where ct.id=aggView1633327435923712132.v8 and kind IN ('production companies','distributors');
select SUM(annot) as v41 from aggJoin3926391477095718309;
