create or replace view aggView4813542947040617676 as select id as v33 from keyword as k where keyword= 'character-name-in-title';
create or replace view aggJoin2095875667107400414 as select movie_id as v11 from movie_keyword as mk, aggView4813542947040617676 where mk.keyword_id=aggView4813542947040617676.v33;
create or replace view aggView6274636412457805207 as select id as v2 from name as n;
create or replace view aggJoin1266149407774426989 as select person_id as v2 from aka_name as an, aggView6274636412457805207 where an.person_id=aggView6274636412457805207.v2;
create or replace view aggView6028014202503648539 as select v2, COUNT(*) as annot from aggJoin1266149407774426989 group by v2;
create or replace view aggJoin2418768121052747838 as select movie_id as v11, annot from cast_info as ci, aggView6028014202503648539 where ci.person_id=aggView6028014202503648539.v2;
create or replace view aggView6563701712986910253 as select v11, SUM(annot) as annot from aggJoin2418768121052747838 group by v11;
create or replace view aggJoin5886957122113587742 as select v11, annot from aggJoin2095875667107400414 join aggView6563701712986910253 using(v11);
create or replace view aggView1902141745416159070 as select v11, SUM(annot) as annot from aggJoin5886957122113587742 group by v11;
create or replace view aggJoin118510879803801076 as select id as v11, annot from title as t, aggView1902141745416159070 where t.id=aggView1902141745416159070.v11;
create or replace view aggView1905538569903988880 as select v11, SUM(annot) as annot from aggJoin118510879803801076 group by v11;
create or replace view aggJoin2897664787694214644 as select company_id as v28, annot from movie_companies as mc, aggView1905538569903988880 where mc.movie_id=aggView1905538569903988880.v11;
create or replace view aggView6464712510557305937 as select v28, SUM(annot) as annot from aggJoin2897664787694214644 group by v28;
create or replace view aggJoin8119072581798478255 as select country_code as v18, annot from company_name as cn, aggView6464712510557305937 where cn.id=aggView6464712510557305937.v28 and country_code= '[us]';
select SUM(annot) as v55 from aggJoin8119072581798478255;
