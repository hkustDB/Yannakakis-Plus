create or replace view aggView3744370691132119547 as select id as v2 from name as n;
create or replace view aggJoin9120897373481788141 as select person_id as v2 from aka_name as an, aggView3744370691132119547 where an.person_id=aggView3744370691132119547.v2;
create or replace view aggView3448825805870732502 as select v2, COUNT(*) as annot from aggJoin9120897373481788141 group by v2;
create or replace view aggJoin4968024730968397611 as select movie_id as v11, annot from cast_info as ci, aggView3448825805870732502 where ci.person_id=aggView3448825805870732502.v2;
create or replace view aggView3255334139164842539 as select v11, SUM(annot) as annot from aggJoin4968024730968397611 group by v11;
create or replace view aggJoin4973215536094850653 as select id as v11, annot from title as t, aggView3255334139164842539 where t.id=aggView3255334139164842539.v11;
create or replace view aggView3674576832526241398 as select id as v28 from company_name as cn where country_code= '[us]';
create or replace view aggJoin3602578226798951758 as select movie_id as v11 from movie_companies as mc, aggView3674576832526241398 where mc.company_id=aggView3674576832526241398.v28;
create or replace view aggView3977117094058478367 as select v11, SUM(annot) as annot from aggJoin4973215536094850653 group by v11;
create or replace view aggJoin8461288325405075711 as select v11, annot from aggJoin3602578226798951758 join aggView3977117094058478367 using(v11);
create or replace view aggView6098073047741745040 as select v11, SUM(annot) as annot from aggJoin8461288325405075711 group by v11;
create or replace view aggJoin5897604954919373406 as select keyword_id as v33, annot from movie_keyword as mk, aggView6098073047741745040 where mk.movie_id=aggView6098073047741745040.v11;
create or replace view aggView1995945858832245994 as select v33, SUM(annot) as annot from aggJoin5897604954919373406 group by v33;
create or replace view aggJoin1466362302042800349 as select keyword as v24, annot from keyword as k, aggView1995945858832245994 where k.id=aggView1995945858832245994.v33 and keyword= 'character-name-in-title';
select SUM(annot) as v55 from aggJoin1466362302042800349;
