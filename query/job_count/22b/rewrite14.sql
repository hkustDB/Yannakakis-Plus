create or replace view aggView4896144438679473627 as select id as v12 from info_type as it2 where info= 'rating';
create or replace view aggJoin5348510398420583475 as select movie_id as v37, info as v32 from movie_info_idx as mi_idx, aggView4896144438679473627 where mi_idx.info_type_id=aggView4896144438679473627.v12 and info<'7.0';
create or replace view aggView79824050273759838 as select id as v17 from kind_type as kt where kind IN ('movie','episode');
create or replace view aggJoin4120563737348248457 as select id as v37, production_year as v41 from title as t, aggView79824050273759838 where t.kind_id=aggView79824050273759838.v17 and production_year>2009;
create or replace view aggView2865081404130058378 as select v37, COUNT(*) as annot from aggJoin5348510398420583475 group by v37;
create or replace view aggJoin9071513497778354296 as select movie_id as v37, keyword_id as v14, annot from movie_keyword as mk, aggView2865081404130058378 where mk.movie_id=aggView2865081404130058378.v37;
create or replace view aggView5422882625597190143 as select id as v1 from company_name as cn where country_code<> '[us]';
create or replace view aggJoin3061421176747823831 as select movie_id as v37, company_type_id as v8, note as v23 from movie_companies as mc, aggView5422882625597190143 where mc.company_id=aggView5422882625597190143.v1 and note NOT LIKE '%(USA)%' and note LIKE '%(200%)%';
create or replace view aggView7266180501131788278 as select id as v14 from keyword as k where keyword IN ('murder','murder-in-title','blood','violence');
create or replace view aggJoin7045513584956784931 as select v37, annot from aggJoin9071513497778354296 join aggView7266180501131788278 using(v14);
create or replace view aggView2686667636569262065 as select v37, SUM(annot) as annot from aggJoin7045513584956784931 group by v37;
create or replace view aggJoin3255076441778124332 as select v37, v41, annot from aggJoin4120563737348248457 join aggView2686667636569262065 using(v37);
create or replace view aggView2380000812089510912 as select v37, SUM(annot) as annot from aggJoin3255076441778124332 group by v37;
create or replace view aggJoin1629185313676125647 as select movie_id as v37, info_type_id as v10, info as v27, annot from movie_info as mi, aggView2380000812089510912 where mi.movie_id=aggView2380000812089510912.v37 and info IN ('Germany','German','USA','American');
create or replace view aggView7307754075182990228 as select id as v10 from info_type as it1 where info= 'countries';
create or replace view aggJoin7476364263746030881 as select v37, v27, annot from aggJoin1629185313676125647 join aggView7307754075182990228 using(v10);
create or replace view aggView386004141003132349 as select v37, SUM(annot) as annot from aggJoin7476364263746030881 group by v37;
create or replace view aggJoin5577649922825614520 as select v8, v23, annot from aggJoin3061421176747823831 join aggView386004141003132349 using(v37);
create or replace view aggView6074098884695862885 as select v8, SUM(annot) as annot from aggJoin5577649922825614520 group by v8;
create or replace view aggJoin3906736168104499456 as select annot from company_type as ct, aggView6074098884695862885 where ct.id=aggView6074098884695862885.v8;
select SUM(annot) as v49 from aggJoin3906736168104499456;
