create or replace view aggView3920123124117552036 as select id as v9 from char_name as chn where ((name LIKE '%man%') OR (name LIKE '%Man%'));
create or replace view aggJoin5384770210225683627 as select person_id as v38, movie_id as v47 from cast_info as ci, aggView3920123124117552036 where ci.person_role_id=aggView3920123124117552036.v9;
create or replace view aggView2579586251605222334 as select id as v28 from kind_type as kt where kind= 'movie';
create or replace view aggJoin2851483816096029597 as select id as v47, production_year as v51 from title as t, aggView2579586251605222334 where t.kind_id=aggView2579586251605222334.v28 and production_year>2000;
create or replace view aggView4693241667930652598 as select v47, COUNT(*) as annot from aggJoin2851483816096029597 group by v47;
create or replace view aggJoin7834710441299508810 as select movie_id as v47, info_type_id as v23, annot from movie_info_idx as mi_idx, aggView4693241667930652598 where mi_idx.movie_id=aggView4693241667930652598.v47;
create or replace view aggView1946153396787075796 as select id as v25 from keyword as k where keyword IN ('superhero','marvel-comics','based-on-comic','tv-special','fight','violence','magnet','web','claw','laser');
create or replace view aggJoin159020313643945065 as select movie_id as v47 from movie_keyword as mk, aggView1946153396787075796 where mk.keyword_id=aggView1946153396787075796.v25;
create or replace view aggView6670171476371939762 as select id as v7 from comp_cast_type as cct2 where kind LIKE '%complete%';
create or replace view aggJoin7408191671511157322 as select movie_id as v47, subject_id as v5 from complete_cast as cc, aggView6670171476371939762 where cc.status_id=aggView6670171476371939762.v7;
create or replace view aggView6214541777207468521 as select id as v5 from comp_cast_type as cct1 where kind= 'cast';
create or replace view aggJoin5104170797280487062 as select v47 from aggJoin7408191671511157322 join aggView6214541777207468521 using(v5);
create or replace view aggView4647854453504576998 as select id as v23 from info_type as it2 where info= 'rating';
create or replace view aggJoin5618042756854862798 as select v47, annot from aggJoin7834710441299508810 join aggView4647854453504576998 using(v23);
create or replace view aggView1486772628236530637 as select v47, SUM(annot) as annot from aggJoin5618042756854862798 group by v47;
create or replace view aggJoin1567280664982306310 as select v47, annot from aggJoin5104170797280487062 join aggView1486772628236530637 using(v47);
create or replace view aggView764997554948876911 as select v47, SUM(annot) as annot from aggJoin1567280664982306310 group by v47;
create or replace view aggJoin8664592040209462783 as select v47, annot from aggJoin159020313643945065 join aggView764997554948876911 using(v47);
create or replace view aggView333684534709862254 as select v47, SUM(annot) as annot from aggJoin8664592040209462783 group by v47;
create or replace view aggJoin2928611031470584760 as select v38, annot from aggJoin5384770210225683627 join aggView333684534709862254 using(v47);
create or replace view aggView7118458178433976604 as select v38, SUM(annot) as annot from aggJoin2928611031470584760 group by v38;
create or replace view aggJoin7957443987361976824 as select annot from name as n, aggView7118458178433976604 where n.id=aggView7118458178433976604.v38;
select SUM(annot) as v59 from aggJoin7957443987361976824;
