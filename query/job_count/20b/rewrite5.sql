create or replace view aggView8613243612197342638 as select id as v26 from kind_type as kt where kind= 'movie';
create or replace view aggJoin3642962964340842637 as select id as v40, production_year as v44 from title as t, aggView8613243612197342638 where t.kind_id=aggView8613243612197342638.v26 and production_year>2000;
create or replace view aggView1266112602381818893 as select id as v9 from char_name as chn where ((name LIKE '%Tony%Stark%') OR (name LIKE '%Iron%Man%')) and name NOT LIKE '%Sherlock%';
create or replace view aggJoin6146296590191069718 as select person_id as v31, movie_id as v40 from cast_info as ci, aggView1266112602381818893 where ci.person_role_id=aggView1266112602381818893.v9;
create or replace view aggView8529131299222820514 as select id as v31 from name as n where name LIKE '%Downey%Robert%';
create or replace view aggJoin8453539441108286442 as select v40 from aggJoin6146296590191069718 join aggView8529131299222820514 using(v31);
create or replace view aggView7831253291829900017 as select v40, COUNT(*) as annot from aggJoin8453539441108286442 group by v40;
create or replace view aggJoin3292621533229872393 as select movie_id as v40, keyword_id as v23, annot from movie_keyword as mk, aggView7831253291829900017 where mk.movie_id=aggView7831253291829900017.v40;
create or replace view aggView9087584698113120575 as select id as v23 from keyword as k where keyword IN ('superhero','sequel','second-part','marvel-comics','based-on-comic','tv-special','fight','violence');
create or replace view aggJoin4490946198960599348 as select v40, annot from aggJoin3292621533229872393 join aggView9087584698113120575 using(v23);
create or replace view aggView4364702099978697597 as select id as v7 from comp_cast_type as cct2 where kind LIKE '%complete%';
create or replace view aggJoin3324744410138461121 as select movie_id as v40, subject_id as v5 from complete_cast as cc, aggView4364702099978697597 where cc.status_id=aggView4364702099978697597.v7;
create or replace view aggView222344619740981236 as select v40, SUM(annot) as annot from aggJoin4490946198960599348 group by v40;
create or replace view aggJoin9184301059526968289 as select v40, v44, annot from aggJoin3642962964340842637 join aggView222344619740981236 using(v40);
create or replace view aggView6679877463667871722 as select v40, SUM(annot) as annot from aggJoin9184301059526968289 group by v40;
create or replace view aggJoin3108184353953360939 as select v5, annot from aggJoin3324744410138461121 join aggView6679877463667871722 using(v40);
create or replace view aggView3881221756913162446 as select v5, SUM(annot) as annot from aggJoin3108184353953360939 group by v5;
create or replace view aggJoin4717161841777399136 as select kind as v6, annot from comp_cast_type as cct1, aggView3881221756913162446 where cct1.id=aggView3881221756913162446.v5 and kind= 'cast';
select SUM(annot) as v52 from aggJoin4717161841777399136;
