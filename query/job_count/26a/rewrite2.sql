create or replace view aggView3627294191631586358 as select id as v25 from keyword as k where keyword IN ('superhero','marvel-comics','based-on-comic','tv-special','fight','violence','magnet','web','claw','laser');
create or replace view aggJoin7909920787364095119 as select movie_id as v47 from movie_keyword as mk, aggView3627294191631586358 where mk.keyword_id=aggView3627294191631586358.v25;
create or replace view aggView7756709722959445171 as select id as v9 from char_name as chn where ((name LIKE '%man%') OR (name LIKE '%Man%'));
create or replace view aggJoin1433566792376002320 as select person_id as v38, movie_id as v47 from cast_info as ci, aggView7756709722959445171 where ci.person_role_id=aggView7756709722959445171.v9;
create or replace view aggView6164407457073280389 as select v47, COUNT(*) as annot from aggJoin7909920787364095119 group by v47;
create or replace view aggJoin2670684171544881999 as select movie_id as v47, subject_id as v5, status_id as v7, annot from complete_cast as cc, aggView6164407457073280389 where cc.movie_id=aggView6164407457073280389.v47;
create or replace view aggView3974266818533853119 as select id as v28 from kind_type as kt where kind= 'movie';
create or replace view aggJoin3330930994690961074 as select id as v47, production_year as v51 from title as t, aggView3974266818533853119 where t.kind_id=aggView3974266818533853119.v28 and production_year>2000;
create or replace view aggView96601179609508798 as select id as v5 from comp_cast_type as cct1 where kind= 'cast';
create or replace view aggJoin8469326937919421691 as select v47, v7, annot from aggJoin2670684171544881999 join aggView96601179609508798 using(v5);
create or replace view aggView2194793106813336375 as select id as v7 from comp_cast_type as cct2 where kind LIKE '%complete%';
create or replace view aggJoin2296318147997934367 as select v47, annot from aggJoin8469326937919421691 join aggView2194793106813336375 using(v7);
create or replace view aggView1087186799967721713 as select v47, SUM(annot) as annot from aggJoin2296318147997934367 group by v47;
create or replace view aggJoin1985153809788307647 as select movie_id as v47, info_type_id as v23, info as v33, annot from movie_info_idx as mi_idx, aggView1087186799967721713 where mi_idx.movie_id=aggView1087186799967721713.v47 and info>'7.0';
create or replace view aggView8880222320884610159 as select id as v23 from info_type as it2 where info= 'rating';
create or replace view aggJoin2112135087883357114 as select v47, v33, annot from aggJoin1985153809788307647 join aggView8880222320884610159 using(v23);
create or replace view aggView8522335217135834654 as select v47, SUM(annot) as annot from aggJoin2112135087883357114 group by v47;
create or replace view aggJoin2259950157371150336 as select v47, v51, annot from aggJoin3330930994690961074 join aggView8522335217135834654 using(v47);
create or replace view aggView8434710574400081363 as select v47, SUM(annot) as annot from aggJoin2259950157371150336 group by v47;
create or replace view aggJoin6191057498361694069 as select v38, annot from aggJoin1433566792376002320 join aggView8434710574400081363 using(v47);
create or replace view aggView3491996080502691128 as select v38, SUM(annot) as annot from aggJoin6191057498361694069 group by v38;
create or replace view aggJoin1552251151134585310 as select annot from name as n, aggView3491996080502691128 where n.id=aggView3491996080502691128.v38;
select SUM(annot) as v59 from aggJoin1552251151134585310;
