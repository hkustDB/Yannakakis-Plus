create or replace view aggView3519129623522775951 as select id as v15 from role_type as rt where role= 'writer';
create or replace view aggJoin5933142907672619794 as select person_id as v2, movie_id as v11 from cast_info as ci, aggView3519129623522775951 where ci.role_id=aggView3519129623522775951.v15;
create or replace view aggView4204477829306125043 as select id as v25 from company_name as cn where country_code= '[us]';
create or replace view aggJoin1414066830384504303 as select movie_id as v11 from movie_companies as mc, aggView4204477829306125043 where mc.company_id=aggView4204477829306125043.v25;
create or replace view aggView3593852884099386723 as select person_id as v2, COUNT(*) as annot from aka_name as an group by person_id;
create or replace view aggJoin7346821134661872738 as select v2, v11, annot from aggJoin5933142907672619794 join aggView3593852884099386723 using(v2);
create or replace view aggView674205893680833786 as select v11, COUNT(*) as annot from aggJoin1414066830384504303 group by v11;
create or replace view aggJoin6669292826415410165 as select id as v11, annot from title as t, aggView674205893680833786 where t.id=aggView674205893680833786.v11;
create or replace view aggView6953512467184605426 as select v11, SUM(annot) as annot from aggJoin6669292826415410165 group by v11;
create or replace view aggJoin7548550976634213143 as select v2, aggJoin7346821134661872738.annot * aggView6953512467184605426.annot as annot from aggJoin7346821134661872738 join aggView6953512467184605426 using(v11);
create or replace view aggView6752910405269280374 as select id as v2 from name as n1;
create or replace view aggJoin205604986026847862 as select annot from aggJoin7548550976634213143 join aggView6752910405269280374 using(v2);
select SUM(annot) as v51 from aggJoin205604986026847862;
