create or replace view aggView1761079432589743894 as select person_id as v2, COUNT(*) as annot from aka_name as an group by person_id;
create or replace view aggJoin6100675807234002200 as select id as v2, annot from name as n, aggView1761079432589743894 where n.id=aggView1761079432589743894.v2;
create or replace view aggView8332223275769785875 as select id as v28 from company_name as cn where country_code= '[us]';
create or replace view aggJoin4342297757018982758 as select movie_id as v11 from movie_companies as mc, aggView8332223275769785875 where mc.company_id=aggView8332223275769785875.v28;
create or replace view aggView7700661089959743325 as select v2, SUM(annot) as annot from aggJoin6100675807234002200 group by v2;
create or replace view aggJoin6940521655864282169 as select movie_id as v11, annot from cast_info as ci, aggView7700661089959743325 where ci.person_id=aggView7700661089959743325.v2;
create or replace view aggView3663005686039314096 as select v11, SUM(annot) as annot from aggJoin6940521655864282169 group by v11;
create or replace view aggJoin4378754288265545013 as select v11, annot from aggJoin4342297757018982758 join aggView3663005686039314096 using(v11);
create or replace view aggView4319505282599551826 as select v11, SUM(annot) as annot from aggJoin4378754288265545013 group by v11;
create or replace view aggJoin6959326177231525227 as select id as v11, episode_nr as v52, annot from title as t, aggView4319505282599551826 where t.id=aggView4319505282599551826.v11 and episode_nr<100;
create or replace view aggView2650864292688812338 as select v11, SUM(annot) as annot from aggJoin6959326177231525227 group by v11;
create or replace view aggJoin8481665662528691838 as select keyword_id as v33, annot from movie_keyword as mk, aggView2650864292688812338 where mk.movie_id=aggView2650864292688812338.v11;
create or replace view aggView6571319802800492366 as select v33, SUM(annot) as annot from aggJoin8481665662528691838 group by v33;
create or replace view aggJoin1629198389084339574 as select keyword as v24, annot from keyword as k, aggView6571319802800492366 where k.id=aggView6571319802800492366.v33 and keyword= 'character-name-in-title';
select SUM(annot) as v55 from aggJoin1629198389084339574;
