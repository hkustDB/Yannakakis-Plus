create or replace view aggView5333485615355148190 as select id as v5 from comp_cast_type as cct1 where kind= 'cast';
create or replace view aggJoin8240599528848773924 as select movie_id as v40, status_id as v7 from complete_cast as cc, aggView5333485615355148190 where cc.subject_id=aggView5333485615355148190.v5;
create or replace view aggView2546332062501090805 as select id as v31 from name as n;
create or replace view aggJoin2537438159561350436 as select movie_id as v40, person_role_id as v9 from cast_info as ci, aggView2546332062501090805 where ci.person_id=aggView2546332062501090805.v31;
create or replace view aggView7347338523050040649 as select id as v23 from keyword as k where keyword IN ('superhero','marvel-comics','based-on-comic','tv-special','fight','violence','magnet','web','claw','laser');
create or replace view aggJoin6042227236805347194 as select movie_id as v40 from movie_keyword as mk, aggView7347338523050040649 where mk.keyword_id=aggView7347338523050040649.v23;
create or replace view aggView7127666016651098439 as select id as v9 from char_name as chn where ((name LIKE '%man%') OR (name LIKE '%Man%'));
create or replace view aggJoin6523808576406845757 as select v40 from aggJoin2537438159561350436 join aggView7127666016651098439 using(v9);
create or replace view aggView3761684029188601737 as select v40, COUNT(*) as annot from aggJoin6523808576406845757 group by v40;
create or replace view aggJoin6428748007080482487 as select v40, annot from aggJoin6042227236805347194 join aggView3761684029188601737 using(v40);
create or replace view aggView2350381521859765377 as select v40, SUM(annot) as annot from aggJoin6428748007080482487 group by v40;
create or replace view aggJoin315266359733630988 as select id as v40, kind_id as v26, production_year as v44, annot from title as t, aggView2350381521859765377 where t.id=aggView2350381521859765377.v40 and production_year>2000;
create or replace view aggView3417281594174362879 as select id as v26 from kind_type as kt where kind= 'movie';
create or replace view aggJoin237646369360524602 as select v40, v44, annot from aggJoin315266359733630988 join aggView3417281594174362879 using(v26);
create or replace view aggView6392561589543229988 as select v40, SUM(annot) as annot from aggJoin237646369360524602 group by v40;
create or replace view aggJoin6519008683554291835 as select v7, annot from aggJoin8240599528848773924 join aggView6392561589543229988 using(v40);
create or replace view aggView6946153238988765945 as select v7, SUM(annot) as annot from aggJoin6519008683554291835 group by v7;
create or replace view aggJoin1902953242530920969 as select kind as v8, annot from comp_cast_type as cct2, aggView6946153238988765945 where cct2.id=aggView6946153238988765945.v7 and kind LIKE '%complete%';
select SUM(annot) as v52 from aggJoin1902953242530920969;
