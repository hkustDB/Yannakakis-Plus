create or replace view aggView466116782051381369 as select id as v28 from name as n where gender= 'm';
create or replace view aggJoin6080314225445503790 as select movie_id as v37, note as v5 from cast_info as ci, aggView466116782051381369 where ci.person_id=aggView466116782051381369.v28 and note IN ('(writer)','(head writer)','(written by)','(story)','(story editor)');
create or replace view aggView6552171182251020558 as select id as v12 from keyword as k where keyword IN ('murder','violence','blood','gore','death','female-nudity','hospital');
create or replace view aggJoin1805444115385938642 as select movie_id as v37 from movie_keyword as mk, aggView6552171182251020558 where mk.keyword_id=aggView6552171182251020558.v12;
create or replace view aggView763834939620726331 as select v37, COUNT(*) as annot from aggJoin1805444115385938642 group by v37;
create or replace view aggJoin5737975774775388348 as select id as v37, annot from title as t, aggView763834939620726331 where t.id=aggView763834939620726331.v37;
create or replace view aggView3812299817503410470 as select v37, SUM(annot) as annot from aggJoin5737975774775388348 group by v37;
create or replace view aggJoin8411545887625000053 as select v37, v5, annot from aggJoin6080314225445503790 join aggView3812299817503410470 using(v37);
create or replace view aggView2167723931667639591 as select v37, SUM(annot) as annot from aggJoin8411545887625000053 group by v37;
create or replace view aggJoin8196030910598638986 as select movie_id as v37, info_type_id as v8, info as v18, annot from movie_info as mi, aggView2167723931667639591 where mi.movie_id=aggView2167723931667639591.v37 and info IN ('Horror','Action','Sci-Fi','Thriller','Crime','War');
create or replace view aggView7858322272930057612 as select id as v8 from info_type as it1 where info= 'genres';
create or replace view aggJoin4061644387054581702 as select v37, v18, annot from aggJoin8196030910598638986 join aggView7858322272930057612 using(v8);
create or replace view aggView7489757850291411425 as select v37, SUM(annot) as annot from aggJoin4061644387054581702 group by v37;
create or replace view aggJoin7825069037563057549 as select info_type_id as v10, annot from movie_info_idx as mi_idx, aggView7489757850291411425 where mi_idx.movie_id=aggView7489757850291411425.v37;
create or replace view aggView1521400780806190411 as select v10, SUM(annot) as annot from aggJoin7825069037563057549 group by v10;
create or replace view aggJoin4592036665045500112 as select info as v11, annot from info_type as it2, aggView1521400780806190411 where it2.id=aggView1521400780806190411.v10 and info= 'votes';
select SUM(annot) as v49 from aggJoin4592036665045500112;
