create or replace view aggView6926589088121875602 as select id as v20 from company_name as cn;
create or replace view aggJoin3184773877140012841 as select movie_id as v3 from movie_companies as mc, aggView6926589088121875602 where mc.company_id=aggView6926589088121875602.v20;
create or replace view aggView8413113506251395543 as select id as v26 from name as n where name LIKE '%B%';
create or replace view aggJoin6092873388687606907 as select movie_id as v3 from cast_info as ci, aggView8413113506251395543 where ci.person_id=aggView8413113506251395543.v26;
create or replace view aggView5459294392074924842 as select v3, COUNT(*) as annot from aggJoin6092873388687606907 group by v3;
create or replace view aggJoin1004741974022349635 as select id as v3, annot from title as t, aggView5459294392074924842 where t.id=aggView5459294392074924842.v3;
create or replace view aggView3594816575256576870 as select v3, SUM(annot) as annot from aggJoin1004741974022349635 group by v3;
create or replace view aggJoin8366464276871754534 as select v3, annot from aggJoin3184773877140012841 join aggView3594816575256576870 using(v3);
create or replace view aggView581596883717179944 as select v3, SUM(annot) as annot from aggJoin8366464276871754534 group by v3;
create or replace view aggJoin6335311377298186515 as select keyword_id as v25, annot from movie_keyword as mk, aggView581596883717179944 where mk.movie_id=aggView581596883717179944.v3;
create or replace view aggView6615026808674333826 as select v25, SUM(annot) as annot from aggJoin6335311377298186515 group by v25;
create or replace view aggJoin5471261724567574105 as select keyword as v16, annot from keyword as k, aggView6615026808674333826 where k.id=aggView6615026808674333826.v25 and keyword= 'character-name-in-title';
select SUM(annot) as v47 from aggJoin5471261724567574105;
