create or replace view aggView6578284913477223733 as select id as v17 from info_type as it2 where info= 'rating';
create or replace view aggJoin222358564910586282 as select movie_id as v61, info as v43 from movie_info_idx as mi_idx2, aggView6578284913477223733 where mi_idx2.info_type_id=aggView6578284913477223733.v17 and info<'3.0';
create or replace view aggView1082350769357781548 as select id as v19 from kind_type as kt1 where kind= 'tv series';
create or replace view aggJoin485507584365691887 as select id as v49 from title as t1, aggView1082350769357781548 where t1.kind_id=aggView1082350769357781548.v19;
create or replace view aggView8756344439342333639 as select id as v21 from kind_type as kt2 where kind= 'tv series';
create or replace view aggJoin9182397482557164799 as select id as v61, production_year as v65 from title as t2, aggView8756344439342333639 where t2.kind_id=aggView8756344439342333639.v21 and production_year<=2008 and production_year>=2005;
create or replace view aggView3119916563050426698 as select id as v23 from link_type as lt where link IN ('sequel','follows','followed by');
create or replace view aggJoin3278887953754602662 as select movie_id as v49, linked_movie_id as v61 from movie_link as ml, aggView3119916563050426698 where ml.link_type_id=aggView3119916563050426698.v23;
create or replace view aggView1004198382841724823 as select id as v1 from company_name as cn1 where country_code= '[us]';
create or replace view aggJoin6912452524233145979 as select movie_id as v49 from movie_companies as mc1, aggView1004198382841724823 where mc1.company_id=aggView1004198382841724823.v1;
create or replace view aggView8992914630957042681 as select id as v15 from info_type as it1 where info= 'rating';
create or replace view aggJoin3578314830595175230 as select movie_id as v49 from movie_info_idx as mi_idx1, aggView8992914630957042681 where mi_idx1.info_type_id=aggView8992914630957042681.v15;
create or replace view aggView1947566232992815134 as select v49, COUNT(*) as annot from aggJoin3578314830595175230 group by v49;
create or replace view aggJoin6944600199493812832 as select v49, annot from aggJoin485507584365691887 join aggView1947566232992815134 using(v49);
create or replace view aggView4470451422209978406 as select v49, SUM(annot) as annot from aggJoin6944600199493812832 group by v49;
create or replace view aggJoin5387325091502656100 as select v49, annot from aggJoin6912452524233145979 join aggView4470451422209978406 using(v49);
create or replace view aggView2347148046054327170 as select v49, SUM(annot) as annot from aggJoin5387325091502656100 group by v49;
create or replace view aggJoin5421071914620000574 as select v61, annot from aggJoin3278887953754602662 join aggView2347148046054327170 using(v49);
create or replace view aggView8881534921048576716 as select v61, SUM(annot) as annot from aggJoin5421071914620000574 group by v61;
create or replace view aggJoin4482261482713455768 as select v61, v65, annot from aggJoin9182397482557164799 join aggView8881534921048576716 using(v61);
create or replace view aggView7263933188116188183 as select v61, SUM(annot) as annot from aggJoin4482261482713455768 group by v61;
create or replace view aggJoin7169732925050393357 as select v61, v43, annot from aggJoin222358564910586282 join aggView7263933188116188183 using(v61);
create or replace view aggView5932309074650929750 as select v61, SUM(annot) as annot from aggJoin7169732925050393357 group by v61;
create or replace view aggJoin2251448182879248825 as select company_id as v8, annot from movie_companies as mc2, aggView5932309074650929750 where mc2.movie_id=aggView5932309074650929750.v61;
create or replace view aggView8887449048744270110 as select v8, SUM(annot) as annot from aggJoin2251448182879248825 group by v8;
create or replace view aggJoin7681816254769607946 as select annot from company_name as cn2, aggView8887449048744270110 where cn2.id=aggView8887449048744270110.v8;
select SUM(annot) as v73 from aggJoin7681816254769607946;
