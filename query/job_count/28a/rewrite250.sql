create or replace view aggView3047339741138626896 as select id as v16 from company_type as ct;
create or replace view aggJoin8415672570382211304 as select movie_id as v45, company_id as v9, note as v31 from movie_companies as mc, aggView3047339741138626896 where mc.company_type_id=aggView3047339741138626896.v16 and note NOT LIKE '%(USA)%' and note LIKE '%(200%)%';
create or replace view aggView375456239182525767 as select id as v20 from info_type as it2 where info= 'rating';
create or replace view aggJoin7655220183870275671 as select movie_id as v45, info as v40 from movie_info_idx as mi_idx, aggView375456239182525767 where mi_idx.info_type_id=aggView375456239182525767.v20 and info<'8.5';
create or replace view aggView1866834425120197364 as select id as v5 from comp_cast_type as cct1 where kind= 'crew';
create or replace view aggJoin9143909318616663241 as select movie_id as v45, status_id as v7 from complete_cast as cc, aggView1866834425120197364 where cc.subject_id=aggView1866834425120197364.v5;
create or replace view aggView889113434955337447 as select id as v25 from kind_type as kt where kind IN ('movie','episode');
create or replace view aggJoin1077645205887392436 as select id as v45, production_year as v49 from title as t, aggView889113434955337447 where t.kind_id=aggView889113434955337447.v25 and production_year>2000;
create or replace view aggView6214973282239008033 as select id as v7 from comp_cast_type as cct2 where kind<> 'complete+verified';
create or replace view aggJoin2026288788844104158 as select v45 from aggJoin9143909318616663241 join aggView6214973282239008033 using(v7);
create or replace view aggView8535872559931747094 as select v45, COUNT(*) as annot from aggJoin2026288788844104158 group by v45;
create or replace view aggJoin1651483430864095798 as select movie_id as v45, info_type_id as v18, info as v35, annot from movie_info as mi, aggView8535872559931747094 where mi.movie_id=aggView8535872559931747094.v45 and info IN ('Sweden','Norway','Germany','Denmark','Swedish','Danish','Norwegian','German','USA','American');
create or replace view aggView8389103199618216 as select id as v9 from company_name as cn where country_code<> '[us]';
create or replace view aggJoin3684550000477504175 as select v45, v31 from aggJoin8415672570382211304 join aggView8389103199618216 using(v9);
create or replace view aggView7520309449708319944 as select id as v18 from info_type as it1 where info= 'countries';
create or replace view aggJoin6830656775905811985 as select v45, v35, annot from aggJoin1651483430864095798 join aggView7520309449708319944 using(v18);
create or replace view aggView7138418780993488470 as select v45, SUM(annot) as annot from aggJoin6830656775905811985 group by v45;
create or replace view aggJoin7410434385033566717 as select v45, v40, annot from aggJoin7655220183870275671 join aggView7138418780993488470 using(v45);
create or replace view aggView1807669786227120603 as select v45, SUM(annot) as annot from aggJoin7410434385033566717 group by v45;
create or replace view aggJoin2821461748291298874 as select v45, v49, annot from aggJoin1077645205887392436 join aggView1807669786227120603 using(v45);
create or replace view aggView8541218901491253587 as select v45, SUM(annot) as annot from aggJoin2821461748291298874 group by v45;
create or replace view aggJoin3148551264770320906 as select v45, v31, annot from aggJoin3684550000477504175 join aggView8541218901491253587 using(v45);
create or replace view aggView4641741278866756763 as select v45, SUM(annot) as annot from aggJoin3148551264770320906 group by v45;
create or replace view aggJoin1524723045944689122 as select keyword_id as v22, annot from movie_keyword as mk, aggView4641741278866756763 where mk.movie_id=aggView4641741278866756763.v45;
create or replace view aggView8028644362390327692 as select v22, SUM(annot) as annot from aggJoin1524723045944689122 group by v22;
create or replace view aggJoin4633341620510970282 as select annot from keyword as k, aggView8028644362390327692 where k.id=aggView8028644362390327692.v22 and keyword IN ('murder','murder-in-title','blood','violence');
select SUM(annot) as v57 from aggJoin4633341620510970282;
