create or replace view aggView4920689661894661155 as select id as v16 from company_type as ct;
create or replace view aggJoin262752292102821717 as select movie_id as v45, company_id as v9, note as v31 from movie_companies as mc, aggView4920689661894661155 where mc.company_type_id=aggView4920689661894661155.v16 and note NOT LIKE '%(USA)%' and note LIKE '%(200%)%';
create or replace view aggView989983672359596218 as select id as v20 from info_type as it2 where info= 'rating';
create or replace view aggJoin1803628498676858826 as select movie_id as v45, info as v40 from movie_info_idx as mi_idx, aggView989983672359596218 where mi_idx.info_type_id=aggView989983672359596218.v20 and info<'8.5';
create or replace view aggView6334579582686594756 as select v45, COUNT(*) as annot from aggJoin1803628498676858826 group by v45;
create or replace view aggJoin3587433329930676525 as select movie_id as v45, info_type_id as v18, info as v35, annot from movie_info as mi, aggView6334579582686594756 where mi.movie_id=aggView6334579582686594756.v45 and info IN ('Sweden','Norway','Germany','Denmark','Swedish','Danish','Norwegian','German','USA','American');
create or replace view aggView8474338169931541291 as select id as v5 from comp_cast_type as cct1 where kind= 'crew';
create or replace view aggJoin4582509570399681060 as select movie_id as v45, status_id as v7 from complete_cast as cc, aggView8474338169931541291 where cc.subject_id=aggView8474338169931541291.v5;
create or replace view aggView7812392056466329722 as select id as v25 from kind_type as kt where kind IN ('movie','episode');
create or replace view aggJoin6550205885356427211 as select id as v45, production_year as v49 from title as t, aggView7812392056466329722 where t.kind_id=aggView7812392056466329722.v25 and production_year>2000;
create or replace view aggView6581231433684555081 as select id as v7 from comp_cast_type as cct2 where kind<> 'complete+verified';
create or replace view aggJoin518955130089128848 as select v45 from aggJoin4582509570399681060 join aggView6581231433684555081 using(v7);
create or replace view aggView1552030137794987831 as select id as v9 from company_name as cn where country_code<> '[us]';
create or replace view aggJoin1102231759698378306 as select v45, v31 from aggJoin262752292102821717 join aggView1552030137794987831 using(v9);
create or replace view aggView8046804543333563018 as select id as v18 from info_type as it1 where info= 'countries';
create or replace view aggJoin969822837305445519 as select v45, v35, annot from aggJoin3587433329930676525 join aggView8046804543333563018 using(v18);
create or replace view aggView3899298601535937916 as select v45, SUM(annot) as annot from aggJoin969822837305445519 group by v45;
create or replace view aggJoin7823644179134167012 as select v45, v31, annot from aggJoin1102231759698378306 join aggView3899298601535937916 using(v45);
create or replace view aggView4084859706885218548 as select v45, SUM(annot) as annot from aggJoin7823644179134167012 group by v45;
create or replace view aggJoin3900078727442139054 as select v45, v49, annot from aggJoin6550205885356427211 join aggView4084859706885218548 using(v45);
create or replace view aggView861586836727295096 as select v45, SUM(annot) as annot from aggJoin3900078727442139054 group by v45;
create or replace view aggJoin6997620914770702353 as select v45, annot from aggJoin518955130089128848 join aggView861586836727295096 using(v45);
create or replace view aggView1445416745953564919 as select v45, SUM(annot) as annot from aggJoin6997620914770702353 group by v45;
create or replace view aggJoin8025613533588016129 as select keyword_id as v22, annot from movie_keyword as mk, aggView1445416745953564919 where mk.movie_id=aggView1445416745953564919.v45;
create or replace view aggView6502276861662414297 as select v22, SUM(annot) as annot from aggJoin8025613533588016129 group by v22;
create or replace view aggJoin4188269844002598036 as select annot from keyword as k, aggView6502276861662414297 where k.id=aggView6502276861662414297.v22 and keyword IN ('murder','murder-in-title','blood','violence');
select SUM(annot) as v57 from aggJoin4188269844002598036;
