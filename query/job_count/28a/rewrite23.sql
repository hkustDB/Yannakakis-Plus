create or replace view aggView6887542243636726555 as select id as v16 from company_type as ct;
create or replace view aggJoin6790923936959396188 as select movie_id as v45, company_id as v9, note as v31 from movie_companies as mc, aggView6887542243636726555 where mc.company_type_id=aggView6887542243636726555.v16 and note NOT LIKE '%(USA)%' and note LIKE '%(200%)%';
create or replace view aggView1385282948614863960 as select id as v20 from info_type as it2 where info= 'rating';
create or replace view aggJoin1860188950633141453 as select movie_id as v45, info as v40 from movie_info_idx as mi_idx, aggView1385282948614863960 where mi_idx.info_type_id=aggView1385282948614863960.v20 and info<'8.5';
create or replace view aggView4348194210122183074 as select id as v5 from comp_cast_type as cct1 where kind= 'crew';
create or replace view aggJoin2897943661224075272 as select movie_id as v45, status_id as v7 from complete_cast as cc, aggView4348194210122183074 where cc.subject_id=aggView4348194210122183074.v5;
create or replace view aggView5455986608896247064 as select id as v25 from kind_type as kt where kind IN ('movie','episode');
create or replace view aggJoin5002333011829218010 as select id as v45, production_year as v49 from title as t, aggView5455986608896247064 where t.kind_id=aggView5455986608896247064.v25 and production_year>2000;
create or replace view aggView5448484227372104462 as select id as v7 from comp_cast_type as cct2 where kind<> 'complete+verified';
create or replace view aggJoin2522908149330668608 as select v45 from aggJoin2897943661224075272 join aggView5448484227372104462 using(v7);
create or replace view aggView9171144099006745687 as select v45, COUNT(*) as annot from aggJoin2522908149330668608 group by v45;
create or replace view aggJoin6650816569922327590 as select v45, v40, annot from aggJoin1860188950633141453 join aggView9171144099006745687 using(v45);
create or replace view aggView2986760067810561148 as select v45, SUM(annot) as annot from aggJoin6650816569922327590 group by v45;
create or replace view aggJoin1668345856698650973 as select movie_id as v45, info_type_id as v18, info as v35, annot from movie_info as mi, aggView2986760067810561148 where mi.movie_id=aggView2986760067810561148.v45 and info IN ('Sweden','Norway','Germany','Denmark','Swedish','Danish','Norwegian','German','USA','American');
create or replace view aggView4186873420037550862 as select id as v18 from info_type as it1 where info= 'countries';
create or replace view aggJoin5418962070417272353 as select v45, v35, annot from aggJoin1668345856698650973 join aggView4186873420037550862 using(v18);
create or replace view aggView8587919517669922011 as select id as v9 from company_name as cn where country_code<> '[us]';
create or replace view aggJoin1703466272985845416 as select v45, v31 from aggJoin6790923936959396188 join aggView8587919517669922011 using(v9);
create or replace view aggView7669655402176226463 as select v45, SUM(annot) as annot from aggJoin5418962070417272353 group by v45;
create or replace view aggJoin577305396578892751 as select v45, v49, annot from aggJoin5002333011829218010 join aggView7669655402176226463 using(v45);
create or replace view aggView1511731288108763593 as select v45, SUM(annot) as annot from aggJoin577305396578892751 group by v45;
create or replace view aggJoin1151128525030467400 as select v45, v31, annot from aggJoin1703466272985845416 join aggView1511731288108763593 using(v45);
create or replace view aggView4982911480005044548 as select v45, SUM(annot) as annot from aggJoin1151128525030467400 group by v45;
create or replace view aggJoin107912634054538207 as select keyword_id as v22, annot from movie_keyword as mk, aggView4982911480005044548 where mk.movie_id=aggView4982911480005044548.v45;
create or replace view aggView225630868292245396 as select v22, SUM(annot) as annot from aggJoin107912634054538207 group by v22;
create or replace view aggJoin6394379996641976033 as select annot from keyword as k, aggView225630868292245396 where k.id=aggView225630868292245396.v22 and keyword IN ('murder','murder-in-title','blood','violence');
select SUM(annot) as v57 from aggJoin6394379996641976033;
