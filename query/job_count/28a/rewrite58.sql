create or replace view aggView365146247553480824 as select id as v16 from company_type as ct;
create or replace view aggJoin5258988321974684017 as select movie_id as v45, company_id as v9, note as v31 from movie_companies as mc, aggView365146247553480824 where mc.company_type_id=aggView365146247553480824.v16 and note NOT LIKE '%(USA)%' and note LIKE '%(200%)%';
create or replace view aggView6505614568285337870 as select id as v20 from info_type as it2 where info= 'rating';
create or replace view aggJoin2886014900149020659 as select movie_id as v45, info as v40 from movie_info_idx as mi_idx, aggView6505614568285337870 where mi_idx.info_type_id=aggView6505614568285337870.v20 and info<'8.5';
create or replace view aggView3263097004452462850 as select id as v5 from comp_cast_type as cct1 where kind= 'crew';
create or replace view aggJoin427369240443284750 as select movie_id as v45, status_id as v7 from complete_cast as cc, aggView3263097004452462850 where cc.subject_id=aggView3263097004452462850.v5;
create or replace view aggView3724419863398805844 as select id as v25 from kind_type as kt where kind IN ('movie','episode');
create or replace view aggJoin2587626520473336672 as select id as v45, production_year as v49 from title as t, aggView3724419863398805844 where t.kind_id=aggView3724419863398805844.v25 and production_year>2000;
create or replace view aggView6538599334731675621 as select id as v7 from comp_cast_type as cct2 where kind<> 'complete+verified';
create or replace view aggJoin8236221148420000854 as select v45 from aggJoin427369240443284750 join aggView6538599334731675621 using(v7);
create or replace view aggView1318144947999439584 as select id as v9 from company_name as cn where country_code<> '[us]';
create or replace view aggJoin8219249568428196281 as select v45, v31 from aggJoin5258988321974684017 join aggView1318144947999439584 using(v9);
create or replace view aggView8227987574022403130 as select id as v18 from info_type as it1 where info= 'countries';
create or replace view aggJoin1461887469135991624 as select movie_id as v45, info as v35 from movie_info as mi, aggView8227987574022403130 where mi.info_type_id=aggView8227987574022403130.v18 and info IN ('Sweden','Norway','Germany','Denmark','Swedish','Danish','Norwegian','German','USA','American');
create or replace view aggView6606219209926413692 as select v45, COUNT(*) as annot from aggJoin1461887469135991624 group by v45;
create or replace view aggJoin951752403273571959 as select v45, v31, annot from aggJoin8219249568428196281 join aggView6606219209926413692 using(v45);
create or replace view aggView7323306516070121628 as select v45, SUM(annot) as annot from aggJoin951752403273571959 group by v45;
create or replace view aggJoin3550621592156866579 as select v45, v49, annot from aggJoin2587626520473336672 join aggView7323306516070121628 using(v45);
create or replace view aggView8478134967177010536 as select v45, SUM(annot) as annot from aggJoin3550621592156866579 group by v45;
create or replace view aggJoin4278275228093631121 as select v45, v40, annot from aggJoin2886014900149020659 join aggView8478134967177010536 using(v45);
create or replace view aggView7911525901020154739 as select v45, SUM(annot) as annot from aggJoin4278275228093631121 group by v45;
create or replace view aggJoin3067864564654448087 as select v45, annot from aggJoin8236221148420000854 join aggView7911525901020154739 using(v45);
create or replace view aggView4544966768924570423 as select v45, SUM(annot) as annot from aggJoin3067864564654448087 group by v45;
create or replace view aggJoin5752084484227078721 as select keyword_id as v22, annot from movie_keyword as mk, aggView4544966768924570423 where mk.movie_id=aggView4544966768924570423.v45;
create or replace view aggView6681612059947116547 as select v22, SUM(annot) as annot from aggJoin5752084484227078721 group by v22;
create or replace view aggJoin75833383664260341 as select annot from keyword as k, aggView6681612059947116547 where k.id=aggView6681612059947116547.v22 and keyword IN ('murder','murder-in-title','blood','violence');
select SUM(annot) as v57 from aggJoin75833383664260341;
