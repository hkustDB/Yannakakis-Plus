create or replace view aggView3178122871757000728 as select id as v9 from company_name as cn where country_code<> '[us]';
create or replace view aggJoin1844829973796417226 as select movie_id as v45, company_type_id as v16, note as v31 from movie_companies as mc, aggView3178122871757000728 where mc.company_id=aggView3178122871757000728.v9 and note NOT LIKE '%(USA)%' and note LIKE '%(200%)%';
create or replace view aggView3740979740119683168 as select id as v16 from company_type as ct;
create or replace view aggJoin1468121075151811722 as select v45, v31 from aggJoin1844829973796417226 join aggView3740979740119683168 using(v16);
create or replace view aggView7193081257580042007 as select id as v5 from comp_cast_type as cct1 where kind= 'crew';
create or replace view aggJoin927703024502964937 as select movie_id as v45, status_id as v7 from complete_cast as cc, aggView7193081257580042007 where cc.subject_id=aggView7193081257580042007.v5;
create or replace view aggView1651822930700749604 as select id as v25 from kind_type as kt where kind IN ('movie','episode');
create or replace view aggJoin6336988628586200154 as select id as v45, production_year as v49 from title as t, aggView1651822930700749604 where t.kind_id=aggView1651822930700749604.v25 and production_year>2000;
create or replace view aggView6140279215059951999 as select id as v20 from info_type as it2 where info= 'rating';
create or replace view aggJoin1088134700002477253 as select movie_id as v45, info as v40 from movie_info_idx as mi_idx, aggView6140279215059951999 where mi_idx.info_type_id=aggView6140279215059951999.v20 and info<'8.5';
create or replace view aggView3652495361866211735 as select id as v7 from comp_cast_type as cct2 where kind<> 'complete+verified';
create or replace view aggJoin7005708639974382471 as select v45 from aggJoin927703024502964937 join aggView3652495361866211735 using(v7);
create or replace view aggView7053450308236585154 as select v45, COUNT(*) as annot from aggJoin7005708639974382471 group by v45;
create or replace view aggJoin7146279545743506233 as select v45, v31, annot from aggJoin1468121075151811722 join aggView7053450308236585154 using(v45);
create or replace view aggView2325802720824360200 as select v45, SUM(annot) as annot from aggJoin7146279545743506233 group by v45;
create or replace view aggJoin6770930424319195701 as select v45, v49, annot from aggJoin6336988628586200154 join aggView2325802720824360200 using(v45);
create or replace view aggView5471070639913824019 as select id as v18 from info_type as it1 where info= 'countries';
create or replace view aggJoin1611947142570232560 as select movie_id as v45, info as v35 from movie_info as mi, aggView5471070639913824019 where mi.info_type_id=aggView5471070639913824019.v18 and info IN ('Sweden','Norway','Germany','Denmark','Swedish','Danish','Norwegian','German','USA','American');
create or replace view aggView4741477909840693686 as select v45, SUM(annot) as annot from aggJoin6770930424319195701 group by v45;
create or replace view aggJoin644367293492746173 as select v45, v35, annot from aggJoin1611947142570232560 join aggView4741477909840693686 using(v45);
create or replace view aggView6725763304638929467 as select v45, SUM(annot) as annot from aggJoin644367293492746173 group by v45;
create or replace view aggJoin95226405477318375 as select v45, v40, annot from aggJoin1088134700002477253 join aggView6725763304638929467 using(v45);
create or replace view aggView2746085984105938041 as select v45, SUM(annot) as annot from aggJoin95226405477318375 group by v45;
create or replace view aggJoin6492879395677746682 as select keyword_id as v22, annot from movie_keyword as mk, aggView2746085984105938041 where mk.movie_id=aggView2746085984105938041.v45;
create or replace view aggView3172355841394879365 as select v22, SUM(annot) as annot from aggJoin6492879395677746682 group by v22;
create or replace view aggJoin6505763998451195214 as select annot from keyword as k, aggView3172355841394879365 where k.id=aggView3172355841394879365.v22 and keyword IN ('murder','murder-in-title','blood','violence');
select SUM(annot) as v57 from aggJoin6505763998451195214;
