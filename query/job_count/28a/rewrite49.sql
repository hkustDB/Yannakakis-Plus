create or replace view aggView2336734213887890695 as select id as v9 from company_name as cn where country_code<> '[us]';
create or replace view aggJoin5740218636837019206 as select movie_id as v45, company_type_id as v16, note as v31 from movie_companies as mc, aggView2336734213887890695 where mc.company_id=aggView2336734213887890695.v9 and note NOT LIKE '%(USA)%' and note LIKE '%(200%)%';
create or replace view aggView3885997749026980012 as select id as v16 from company_type as ct;
create or replace view aggJoin4739258735886855055 as select v45, v31 from aggJoin5740218636837019206 join aggView3885997749026980012 using(v16);
create or replace view aggView7277291171273959636 as select id as v5 from comp_cast_type as cct1 where kind= 'crew';
create or replace view aggJoin7171163958838199276 as select movie_id as v45, status_id as v7 from complete_cast as cc, aggView7277291171273959636 where cc.subject_id=aggView7277291171273959636.v5;
create or replace view aggView2894535284017606862 as select id as v25 from kind_type as kt where kind IN ('movie','episode');
create or replace view aggJoin7855379616394253301 as select id as v45, production_year as v49 from title as t, aggView2894535284017606862 where t.kind_id=aggView2894535284017606862.v25 and production_year>2000;
create or replace view aggView1952968129294810783 as select id as v20 from info_type as it2 where info= 'rating';
create or replace view aggJoin4528346168908280694 as select movie_id as v45, info as v40 from movie_info_idx as mi_idx, aggView1952968129294810783 where mi_idx.info_type_id=aggView1952968129294810783.v20 and info<'8.5';
create or replace view aggView3888424108587217598 as select id as v7 from comp_cast_type as cct2 where kind<> 'complete+verified';
create or replace view aggJoin4922853628970948227 as select v45 from aggJoin7171163958838199276 join aggView3888424108587217598 using(v7);
create or replace view aggView4539651007013997650 as select v45, COUNT(*) as annot from aggJoin4922853628970948227 group by v45;
create or replace view aggJoin3389862819601125608 as select v45, v31, annot from aggJoin4739258735886855055 join aggView4539651007013997650 using(v45);
create or replace view aggView6505081740821046566 as select v45, SUM(annot) as annot from aggJoin3389862819601125608 group by v45;
create or replace view aggJoin5065883219780044859 as select movie_id as v45, info_type_id as v18, info as v35, annot from movie_info as mi, aggView6505081740821046566 where mi.movie_id=aggView6505081740821046566.v45 and info IN ('Sweden','Norway','Germany','Denmark','Swedish','Danish','Norwegian','German','USA','American');
create or replace view aggView1683553653145612067 as select id as v18 from info_type as it1 where info= 'countries';
create or replace view aggJoin223662015163452848 as select v45, v35, annot from aggJoin5065883219780044859 join aggView1683553653145612067 using(v18);
create or replace view aggView4432953883614207837 as select v45, SUM(annot) as annot from aggJoin223662015163452848 group by v45;
create or replace view aggJoin3120419664459554057 as select v45, v49, annot from aggJoin7855379616394253301 join aggView4432953883614207837 using(v45);
create or replace view aggView7780357333540173575 as select v45, SUM(annot) as annot from aggJoin3120419664459554057 group by v45;
create or replace view aggJoin3856220782318156978 as select v45, v40, annot from aggJoin4528346168908280694 join aggView7780357333540173575 using(v45);
create or replace view aggView6324604477779700848 as select v45, SUM(annot) as annot from aggJoin3856220782318156978 group by v45;
create or replace view aggJoin4370657103727351626 as select keyword_id as v22, annot from movie_keyword as mk, aggView6324604477779700848 where mk.movie_id=aggView6324604477779700848.v45;
create or replace view aggView7277975993572471460 as select v22, SUM(annot) as annot from aggJoin4370657103727351626 group by v22;
create or replace view aggJoin3054805362779927276 as select annot from keyword as k, aggView7277975993572471460 where k.id=aggView7277975993572471460.v22 and keyword IN ('murder','murder-in-title','blood','violence');
select SUM(annot) as v57 from aggJoin3054805362779927276;
