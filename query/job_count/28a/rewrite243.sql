create or replace view aggView6011555113033399303 as select id as v16 from company_type as ct;
create or replace view aggJoin4424686134158140385 as select movie_id as v45, company_id as v9, note as v31 from movie_companies as mc, aggView6011555113033399303 where mc.company_type_id=aggView6011555113033399303.v16 and note NOT LIKE '%(USA)%' and note LIKE '%(200%)%';
create or replace view aggView5074737198958340755 as select id as v20 from info_type as it2 where info= 'rating';
create or replace view aggJoin628911075346754976 as select movie_id as v45, info as v40 from movie_info_idx as mi_idx, aggView5074737198958340755 where mi_idx.info_type_id=aggView5074737198958340755.v20 and info<'8.5';
create or replace view aggView1270289259251111898 as select id as v5 from comp_cast_type as cct1 where kind= 'crew';
create or replace view aggJoin8434000850299389338 as select movie_id as v45, status_id as v7 from complete_cast as cc, aggView1270289259251111898 where cc.subject_id=aggView1270289259251111898.v5;
create or replace view aggView1672477358022273953 as select id as v25 from kind_type as kt where kind IN ('movie','episode');
create or replace view aggJoin9050190500460767312 as select id as v45, production_year as v49 from title as t, aggView1672477358022273953 where t.kind_id=aggView1672477358022273953.v25 and production_year>2000;
create or replace view aggView2139238150782169250 as select id as v7 from comp_cast_type as cct2 where kind<> 'complete+verified';
create or replace view aggJoin3416907771242926022 as select v45 from aggJoin8434000850299389338 join aggView2139238150782169250 using(v7);
create or replace view aggView2293371140802540666 as select id as v18 from info_type as it1 where info= 'countries';
create or replace view aggJoin2554532529495687257 as select movie_id as v45, info as v35 from movie_info as mi, aggView2293371140802540666 where mi.info_type_id=aggView2293371140802540666.v18 and info IN ('Sweden','Norway','Germany','Denmark','Swedish','Danish','Norwegian','German','USA','American');
create or replace view aggView1372545475135523176 as select v45, COUNT(*) as annot from aggJoin628911075346754976 group by v45;
create or replace view aggJoin4675902685924408239 as select v45, v9, v31, annot from aggJoin4424686134158140385 join aggView1372545475135523176 using(v45);
create or replace view aggView3625961543469974885 as select id as v9 from company_name as cn where country_code<> '[us]';
create or replace view aggJoin3158547259906950371 as select v45, v31, annot from aggJoin4675902685924408239 join aggView3625961543469974885 using(v9);
create or replace view aggView8014099365932243361 as select v45, SUM(annot) as annot from aggJoin3158547259906950371 group by v45;
create or replace view aggJoin4737836117632847283 as select v45, v35, annot from aggJoin2554532529495687257 join aggView8014099365932243361 using(v45);
create or replace view aggView8122458125477200438 as select v45, SUM(annot) as annot from aggJoin4737836117632847283 group by v45;
create or replace view aggJoin5114829112881864004 as select v45, v49, annot from aggJoin9050190500460767312 join aggView8122458125477200438 using(v45);
create or replace view aggView7106772912835784545 as select v45, SUM(annot) as annot from aggJoin5114829112881864004 group by v45;
create or replace view aggJoin3892076805309370916 as select v45, annot from aggJoin3416907771242926022 join aggView7106772912835784545 using(v45);
create or replace view aggView6170365223178427259 as select v45, SUM(annot) as annot from aggJoin3892076805309370916 group by v45;
create or replace view aggJoin6543041617248656580 as select keyword_id as v22, annot from movie_keyword as mk, aggView6170365223178427259 where mk.movie_id=aggView6170365223178427259.v45;
create or replace view aggView8092246978135501149 as select v22, SUM(annot) as annot from aggJoin6543041617248656580 group by v22;
create or replace view aggJoin7948045747206955544 as select annot from keyword as k, aggView8092246978135501149 where k.id=aggView8092246978135501149.v22 and keyword IN ('murder','murder-in-title','blood','violence');
select SUM(annot) as v57 from aggJoin7948045747206955544;
