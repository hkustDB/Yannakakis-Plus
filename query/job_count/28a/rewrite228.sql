create or replace view aggView6570250132120613878 as select id as v7 from comp_cast_type as cct2 where kind<> 'complete+verified';
create or replace view aggJoin1793911565010589629 as select movie_id as v45, subject_id as v5 from complete_cast as cc, aggView6570250132120613878 where cc.status_id=aggView6570250132120613878.v7;
create or replace view aggView1469033812453246398 as select id as v20 from info_type as it2 where info= 'rating';
create or replace view aggJoin7936696824030538743 as select movie_id as v45, info as v40 from movie_info_idx as mi_idx, aggView1469033812453246398 where mi_idx.info_type_id=aggView1469033812453246398.v20 and info<'8.5';
create or replace view aggView5020760409742126586 as select id as v25 from kind_type as kt where kind IN ('movie','episode');
create or replace view aggJoin612162436621865801 as select id as v45, production_year as v49 from title as t, aggView5020760409742126586 where t.kind_id=aggView5020760409742126586.v25 and production_year>2000;
create or replace view aggView3938512924093649112 as select id as v16 from company_type as ct;
create or replace view aggJoin3078861859636171092 as select movie_id as v45, company_id as v9, note as v31 from movie_companies as mc, aggView3938512924093649112 where mc.company_type_id=aggView3938512924093649112.v16 and note NOT LIKE '%(USA)%' and note LIKE '%(200%)%';
create or replace view aggView292101269295398137 as select id as v5 from comp_cast_type as cct1 where kind= 'crew';
create or replace view aggJoin5269601501717488170 as select v45 from aggJoin1793911565010589629 join aggView292101269295398137 using(v5);
create or replace view aggView8615020988852593373 as select id as v18 from info_type as it1 where info= 'countries';
create or replace view aggJoin2640368572016285553 as select movie_id as v45, info as v35 from movie_info as mi, aggView8615020988852593373 where mi.info_type_id=aggView8615020988852593373.v18 and info IN ('Sweden','Norway','Germany','Denmark','Swedish','Danish','Norwegian','German','USA','American');
create or replace view aggView3051528412740993154 as select v45, COUNT(*) as annot from aggJoin2640368572016285553 group by v45;
create or replace view aggJoin4498172021906052599 as select v45, annot from aggJoin5269601501717488170 join aggView3051528412740993154 using(v45);
create or replace view aggView2717539203445367152 as select v45, SUM(annot) as annot from aggJoin4498172021906052599 group by v45;
create or replace view aggJoin5355117063525474284 as select v45, v49, annot from aggJoin612162436621865801 join aggView2717539203445367152 using(v45);
create or replace view aggView8977528644274350489 as select v45, SUM(annot) as annot from aggJoin5355117063525474284 group by v45;
create or replace view aggJoin9198428304144581754 as select v45, v9, v31, annot from aggJoin3078861859636171092 join aggView8977528644274350489 using(v45);
create or replace view aggView6313363491456425409 as select id as v9 from company_name as cn where country_code<> '[us]';
create or replace view aggJoin7388230875377122266 as select v45, v31, annot from aggJoin9198428304144581754 join aggView6313363491456425409 using(v9);
create or replace view aggView6948409750697818508 as select v45, SUM(annot) as annot from aggJoin7388230875377122266 group by v45;
create or replace view aggJoin9051704035828869181 as select v45, v40, annot from aggJoin7936696824030538743 join aggView6948409750697818508 using(v45);
create or replace view aggView2692036076217609073 as select v45, SUM(annot) as annot from aggJoin9051704035828869181 group by v45;
create or replace view aggJoin1368364871152191349 as select keyword_id as v22, annot from movie_keyword as mk, aggView2692036076217609073 where mk.movie_id=aggView2692036076217609073.v45;
create or replace view aggView6107875651395660449 as select v22, SUM(annot) as annot from aggJoin1368364871152191349 group by v22;
create or replace view aggJoin8851499060187514829 as select annot from keyword as k, aggView6107875651395660449 where k.id=aggView6107875651395660449.v22 and keyword IN ('murder','murder-in-title','blood','violence');
select SUM(annot) as v57 from aggJoin8851499060187514829;
