create or replace view aggView98220810081061804 as select id as v25 from kind_type as kt where kind IN ('movie','episode');
create or replace view aggJoin7775292317456684564 as select id as v45, production_year as v49 from title as t, aggView98220810081061804 where t.kind_id=aggView98220810081061804.v25 and production_year>2000;
create or replace view aggView8987575134189110659 as select id as v20 from info_type as it2 where info= 'rating';
create or replace view aggJoin1393919896584593823 as select movie_id as v45, info as v40 from movie_info_idx as mi_idx, aggView8987575134189110659 where mi_idx.info_type_id=aggView8987575134189110659.v20 and info<'8.5';
create or replace view aggView3710732199000447922 as select id as v5 from comp_cast_type as cct1 where kind= 'crew';
create or replace view aggJoin476778671357377097 as select movie_id as v45, status_id as v7 from complete_cast as cc, aggView3710732199000447922 where cc.subject_id=aggView3710732199000447922.v5;
create or replace view aggView377575543763801091 as select id as v16 from company_type as ct;
create or replace view aggJoin6384479728456495382 as select movie_id as v45, company_id as v9, note as v31 from movie_companies as mc, aggView377575543763801091 where mc.company_type_id=aggView377575543763801091.v16 and note NOT LIKE '%(USA)%' and note LIKE '%(200%)%';
create or replace view aggView4340257343041324926 as select id as v7 from comp_cast_type as cct2 where kind<> 'complete+verified';
create or replace view aggJoin8426609888872846059 as select v45 from aggJoin476778671357377097 join aggView4340257343041324926 using(v7);
create or replace view aggView8250432498124548427 as select id as v9 from company_name as cn where country_code<> '[us]';
create or replace view aggJoin4007963539897486541 as select v45, v31 from aggJoin6384479728456495382 join aggView8250432498124548427 using(v9);
create or replace view aggView1158956916210389891 as select v45, COUNT(*) as annot from aggJoin1393919896584593823 group by v45;
create or replace view aggJoin1182699004543217816 as select v45, v31, annot from aggJoin4007963539897486541 join aggView1158956916210389891 using(v45);
create or replace view aggView2124022617784536510 as select v45, SUM(annot) as annot from aggJoin1182699004543217816 group by v45;
create or replace view aggJoin6778373018868127606 as select v45, v49, annot from aggJoin7775292317456684564 join aggView2124022617784536510 using(v45);
create or replace view aggView2725534280454773096 as select v45, SUM(annot) as annot from aggJoin6778373018868127606 group by v45;
create or replace view aggJoin653809267922551045 as select v45, annot from aggJoin8426609888872846059 join aggView2725534280454773096 using(v45);
create or replace view aggView4190613508967587757 as select v45, SUM(annot) as annot from aggJoin653809267922551045 group by v45;
create or replace view aggJoin4600230141434439486 as select movie_id as v45, info_type_id as v18, info as v35, annot from movie_info as mi, aggView4190613508967587757 where mi.movie_id=aggView4190613508967587757.v45 and info IN ('Sweden','Norway','Germany','Denmark','Swedish','Danish','Norwegian','German','USA','American');
create or replace view aggView1845689860258417378 as select id as v18 from info_type as it1 where info= 'countries';
create or replace view aggJoin3026800428587574525 as select v45, v35, annot from aggJoin4600230141434439486 join aggView1845689860258417378 using(v18);
create or replace view aggView8598539799818277820 as select v45, SUM(annot) as annot from aggJoin3026800428587574525 group by v45;
create or replace view aggJoin8786603224035695493 as select keyword_id as v22, annot from movie_keyword as mk, aggView8598539799818277820 where mk.movie_id=aggView8598539799818277820.v45;
create or replace view aggView8220162712438800338 as select v22, SUM(annot) as annot from aggJoin8786603224035695493 group by v22;
create or replace view aggJoin6553368976239467652 as select annot from keyword as k, aggView8220162712438800338 where k.id=aggView8220162712438800338.v22 and keyword IN ('murder','murder-in-title','blood','violence');
select SUM(annot) as v57 from aggJoin6553368976239467652;
