create or replace view aggView1250045803665216430 as select id as v25 from kind_type as kt where kind IN ('movie','episode');
create or replace view aggJoin418189010527135865 as select id as v45, production_year as v49 from title as t, aggView1250045803665216430 where t.kind_id=aggView1250045803665216430.v25 and production_year>2000;
create or replace view aggView7702615753219853005 as select id as v20 from info_type as it2 where info= 'rating';
create or replace view aggJoin4972118751449812162 as select movie_id as v45, info as v40 from movie_info_idx as mi_idx, aggView7702615753219853005 where mi_idx.info_type_id=aggView7702615753219853005.v20 and info<'8.5';
create or replace view aggView3850924872283857018 as select id as v5 from comp_cast_type as cct1 where kind= 'crew';
create or replace view aggJoin922232166531176245 as select movie_id as v45, status_id as v7 from complete_cast as cc, aggView3850924872283857018 where cc.subject_id=aggView3850924872283857018.v5;
create or replace view aggView8436378196078352529 as select id as v16 from company_type as ct;
create or replace view aggJoin4969006883759274138 as select movie_id as v45, company_id as v9, note as v31 from movie_companies as mc, aggView8436378196078352529 where mc.company_type_id=aggView8436378196078352529.v16 and note NOT LIKE '%(USA)%' and note LIKE '%(200%)%';
create or replace view aggView130378688210201115 as select id as v7 from comp_cast_type as cct2 where kind<> 'complete+verified';
create or replace view aggJoin9102085651108080308 as select v45 from aggJoin922232166531176245 join aggView130378688210201115 using(v7);
create or replace view aggView1011221859957860652 as select id as v9 from company_name as cn where country_code<> '[us]';
create or replace view aggJoin5088732414953319544 as select v45, v31 from aggJoin4969006883759274138 join aggView1011221859957860652 using(v9);
create or replace view aggView2036643495643845002 as select v45, COUNT(*) as annot from aggJoin5088732414953319544 group by v45;
create or replace view aggJoin328315334869827503 as select v45, v40, annot from aggJoin4972118751449812162 join aggView2036643495643845002 using(v45);
create or replace view aggView886375297448278472 as select v45, SUM(annot) as annot from aggJoin328315334869827503 group by v45;
create or replace view aggJoin1401948592326678415 as select v45, v49, annot from aggJoin418189010527135865 join aggView886375297448278472 using(v45);
create or replace view aggView6852603298964431806 as select v45, SUM(annot) as annot from aggJoin1401948592326678415 group by v45;
create or replace view aggJoin9080344294634587831 as select v45, annot from aggJoin9102085651108080308 join aggView6852603298964431806 using(v45);
create or replace view aggView5422113734394141349 as select v45, SUM(annot) as annot from aggJoin9080344294634587831 group by v45;
create or replace view aggJoin1356171673801111093 as select movie_id as v45, info_type_id as v18, info as v35, annot from movie_info as mi, aggView5422113734394141349 where mi.movie_id=aggView5422113734394141349.v45 and info IN ('Sweden','Norway','Germany','Denmark','Swedish','Danish','Norwegian','German','USA','American');
create or replace view aggView5803247812505324748 as select id as v18 from info_type as it1 where info= 'countries';
create or replace view aggJoin7420821748292592426 as select v45, v35, annot from aggJoin1356171673801111093 join aggView5803247812505324748 using(v18);
create or replace view aggView7733982561883476879 as select v45, SUM(annot) as annot from aggJoin7420821748292592426 group by v45;
create or replace view aggJoin5691948673665853297 as select keyword_id as v22, annot from movie_keyword as mk, aggView7733982561883476879 where mk.movie_id=aggView7733982561883476879.v45;
create or replace view aggView653101280622494409 as select v22, SUM(annot) as annot from aggJoin5691948673665853297 group by v22;
create or replace view aggJoin7525484818058923021 as select annot from keyword as k, aggView653101280622494409 where k.id=aggView653101280622494409.v22 and keyword IN ('murder','murder-in-title','blood','violence');
select SUM(annot) as v57 from aggJoin7525484818058923021;
