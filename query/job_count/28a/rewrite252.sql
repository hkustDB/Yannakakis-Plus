create or replace view aggView1813961302518314516 as select id as v16 from company_type as ct;
create or replace view aggJoin2809265522345590170 as select movie_id as v45, company_id as v9, note as v31 from movie_companies as mc, aggView1813961302518314516 where mc.company_type_id=aggView1813961302518314516.v16 and note NOT LIKE '%(USA)%' and note LIKE '%(200%)%';
create or replace view aggView3056463213231897519 as select id as v20 from info_type as it2 where info= 'rating';
create or replace view aggJoin6396019818936056821 as select movie_id as v45, info as v40 from movie_info_idx as mi_idx, aggView3056463213231897519 where mi_idx.info_type_id=aggView3056463213231897519.v20 and info<'8.5';
create or replace view aggView4810754097231824151 as select id as v5 from comp_cast_type as cct1 where kind= 'crew';
create or replace view aggJoin2591117884748973080 as select movie_id as v45, status_id as v7 from complete_cast as cc, aggView4810754097231824151 where cc.subject_id=aggView4810754097231824151.v5;
create or replace view aggView5799945598986620318 as select id as v25 from kind_type as kt where kind IN ('movie','episode');
create or replace view aggJoin1922791592514204917 as select id as v45, production_year as v49 from title as t, aggView5799945598986620318 where t.kind_id=aggView5799945598986620318.v25 and production_year>2000;
create or replace view aggView6957110397926822778 as select id as v7 from comp_cast_type as cct2 where kind<> 'complete+verified';
create or replace view aggJoin3180088837364333016 as select v45 from aggJoin2591117884748973080 join aggView6957110397926822778 using(v7);
create or replace view aggView8631497435960661605 as select id as v18 from info_type as it1 where info= 'countries';
create or replace view aggJoin779179966278911562 as select movie_id as v45, info as v35 from movie_info as mi, aggView8631497435960661605 where mi.info_type_id=aggView8631497435960661605.v18 and info IN ('Sweden','Norway','Germany','Denmark','Swedish','Danish','Norwegian','German','USA','American');
create or replace view aggView1918623299875654689 as select id as v9 from company_name as cn where country_code<> '[us]';
create or replace view aggJoin6618637798783733787 as select v45, v31 from aggJoin2809265522345590170 join aggView1918623299875654689 using(v9);
create or replace view aggView1644380651220258393 as select v45, COUNT(*) as annot from aggJoin6618637798783733787 group by v45;
create or replace view aggJoin7163811046732738144 as select v45, v35, annot from aggJoin779179966278911562 join aggView1644380651220258393 using(v45);
create or replace view aggView3888759893937985123 as select v45, SUM(annot) as annot from aggJoin7163811046732738144 group by v45;
create or replace view aggJoin7572553237262165605 as select v45, v40, annot from aggJoin6396019818936056821 join aggView3888759893937985123 using(v45);
create or replace view aggView7749146825203822155 as select v45, SUM(annot) as annot from aggJoin7572553237262165605 group by v45;
create or replace view aggJoin2481098841655748374 as select v45, annot from aggJoin3180088837364333016 join aggView7749146825203822155 using(v45);
create or replace view aggView7036897977473862531 as select v45, SUM(annot) as annot from aggJoin2481098841655748374 group by v45;
create or replace view aggJoin3764730202898134550 as select v45, v49, annot from aggJoin1922791592514204917 join aggView7036897977473862531 using(v45);
create or replace view aggView93915302109664521 as select v45, SUM(annot) as annot from aggJoin3764730202898134550 group by v45;
create or replace view aggJoin243056043111837286 as select keyword_id as v22, annot from movie_keyword as mk, aggView93915302109664521 where mk.movie_id=aggView93915302109664521.v45;
create or replace view aggView6800398274724328193 as select v22, SUM(annot) as annot from aggJoin243056043111837286 group by v22;
create or replace view aggJoin8093062565315909190 as select annot from keyword as k, aggView6800398274724328193 where k.id=aggView6800398274724328193.v22 and keyword IN ('murder','murder-in-title','blood','violence');
select SUM(annot) as v57 from aggJoin8093062565315909190;
