create or replace view aggView3829133565472380322 as select id as v7 from comp_cast_type as cct2 where kind<> 'complete+verified';
create or replace view aggJoin3990384132425232108 as select movie_id as v45, subject_id as v5 from complete_cast as cc, aggView3829133565472380322 where cc.status_id=aggView3829133565472380322.v7;
create or replace view aggView5853488626020639410 as select id as v20 from info_type as it2 where info= 'rating';
create or replace view aggJoin5776713414401840935 as select movie_id as v45, info as v40 from movie_info_idx as mi_idx, aggView5853488626020639410 where mi_idx.info_type_id=aggView5853488626020639410.v20 and info<'8.5';
create or replace view aggView830747209111128474 as select id as v16 from company_type as ct;
create or replace view aggJoin6391288020447623312 as select movie_id as v45, company_id as v9, note as v31 from movie_companies as mc, aggView830747209111128474 where mc.company_type_id=aggView830747209111128474.v16 and note NOT LIKE '%(USA)%' and note LIKE '%(200%)%';
create or replace view aggView1990283506478334964 as select id as v25 from kind_type as kt where kind IN ('movie','episode');
create or replace view aggJoin8212410223638495063 as select id as v45, production_year as v49 from title as t, aggView1990283506478334964 where t.kind_id=aggView1990283506478334964.v25 and production_year>2000;
create or replace view aggView6588167087940067245 as select id as v5 from comp_cast_type as cct1 where kind= 'crew';
create or replace view aggJoin1671152330849220457 as select v45 from aggJoin3990384132425232108 join aggView6588167087940067245 using(v5);
create or replace view aggView5399958967485699379 as select id as v18 from info_type as it1 where info= 'countries';
create or replace view aggJoin8563907121699169404 as select movie_id as v45, info as v35 from movie_info as mi, aggView5399958967485699379 where mi.info_type_id=aggView5399958967485699379.v18 and info IN ('Sweden','Norway','Germany','Denmark','Swedish','Danish','Norwegian','German','USA','American');
create or replace view aggView1022782451669248022 as select v45, COUNT(*) as annot from aggJoin1671152330849220457 group by v45;
create or replace view aggJoin952577087880211475 as select v45, v40, annot from aggJoin5776713414401840935 join aggView1022782451669248022 using(v45);
create or replace view aggView1081710981108514307 as select v45, SUM(annot) as annot from aggJoin952577087880211475 group by v45;
create or replace view aggJoin6502317694138002676 as select v45, v9, v31, annot from aggJoin6391288020447623312 join aggView1081710981108514307 using(v45);
create or replace view aggView8811356252171090023 as select id as v9 from company_name as cn where country_code<> '[us]';
create or replace view aggJoin3938997158072028866 as select v45, v31, annot from aggJoin6502317694138002676 join aggView8811356252171090023 using(v9);
create or replace view aggView642446084885580897 as select v45, SUM(annot) as annot from aggJoin3938997158072028866 group by v45;
create or replace view aggJoin747019351137980475 as select v45, v49, annot from aggJoin8212410223638495063 join aggView642446084885580897 using(v45);
create or replace view aggView7504628908779561789 as select v45, SUM(annot) as annot from aggJoin747019351137980475 group by v45;
create or replace view aggJoin2093317388483548603 as select v45, v35, annot from aggJoin8563907121699169404 join aggView7504628908779561789 using(v45);
create or replace view aggView7892427540788256278 as select v45, SUM(annot) as annot from aggJoin2093317388483548603 group by v45;
create or replace view aggJoin941689494367299733 as select keyword_id as v22, annot from movie_keyword as mk, aggView7892427540788256278 where mk.movie_id=aggView7892427540788256278.v45;
create or replace view aggView7909189200278969261 as select v22, SUM(annot) as annot from aggJoin941689494367299733 group by v22;
create or replace view aggJoin3233861839415545320 as select annot from keyword as k, aggView7909189200278969261 where k.id=aggView7909189200278969261.v22 and keyword IN ('murder','murder-in-title','blood','violence');
select SUM(annot) as v57 from aggJoin3233861839415545320;
