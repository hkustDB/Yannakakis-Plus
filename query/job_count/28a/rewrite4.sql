create or replace view aggView3044874753555946754 as select id as v16 from company_type as ct;
create or replace view aggJoin2428784529936579870 as select movie_id as v45, company_id as v9, note as v31 from movie_companies as mc, aggView3044874753555946754 where mc.company_type_id=aggView3044874753555946754.v16 and note NOT LIKE '%(USA)%' and note LIKE '%(200%)%';
create or replace view aggView6995560367261517884 as select id as v20 from info_type as it2 where info= 'rating';
create or replace view aggJoin4267030712295032588 as select movie_id as v45, info as v40 from movie_info_idx as mi_idx, aggView6995560367261517884 where mi_idx.info_type_id=aggView6995560367261517884.v20 and info<'8.5';
create or replace view aggView391994245343626546 as select id as v5 from comp_cast_type as cct1 where kind= 'crew';
create or replace view aggJoin516888765460763327 as select movie_id as v45, status_id as v7 from complete_cast as cc, aggView391994245343626546 where cc.subject_id=aggView391994245343626546.v5;
create or replace view aggView4575452561391334182 as select id as v25 from kind_type as kt where kind IN ('movie','episode');
create or replace view aggJoin7604848676459712769 as select id as v45, production_year as v49 from title as t, aggView4575452561391334182 where t.kind_id=aggView4575452561391334182.v25 and production_year>2000;
create or replace view aggView6083278939878385981 as select id as v7 from comp_cast_type as cct2 where kind<> 'complete+verified';
create or replace view aggJoin4660063694075865990 as select v45 from aggJoin516888765460763327 join aggView6083278939878385981 using(v7);
create or replace view aggView1191878924648442999 as select id as v18 from info_type as it1 where info= 'countries';
create or replace view aggJoin7307918766243603621 as select movie_id as v45, info as v35 from movie_info as mi, aggView1191878924648442999 where mi.info_type_id=aggView1191878924648442999.v18 and info IN ('Sweden','Norway','Germany','Denmark','Swedish','Danish','Norwegian','German','USA','American');
create or replace view aggView4557862361986906694 as select id as v9 from company_name as cn where country_code<> '[us]';
create or replace view aggJoin2638265879114588500 as select v45, v31 from aggJoin2428784529936579870 join aggView4557862361986906694 using(v9);
create or replace view aggView5202751517274412081 as select v45, COUNT(*) as annot from aggJoin7307918766243603621 group by v45;
create or replace view aggJoin2006937528724030656 as select v45, annot from aggJoin4660063694075865990 join aggView5202751517274412081 using(v45);
create or replace view aggView5540932271350869255 as select v45, SUM(annot) as annot from aggJoin2006937528724030656 group by v45;
create or replace view aggJoin990500521706102485 as select v45, v31, annot from aggJoin2638265879114588500 join aggView5540932271350869255 using(v45);
create or replace view aggView6189552610103413386 as select v45, SUM(annot) as annot from aggJoin990500521706102485 group by v45;
create or replace view aggJoin6057222789407813664 as select v45, v40, annot from aggJoin4267030712295032588 join aggView6189552610103413386 using(v45);
create or replace view aggView966382439471513059 as select v45, SUM(annot) as annot from aggJoin6057222789407813664 group by v45;
create or replace view aggJoin6751530815680369962 as select v45, v49, annot from aggJoin7604848676459712769 join aggView966382439471513059 using(v45);
create or replace view aggView3807610720827707348 as select v45, SUM(annot) as annot from aggJoin6751530815680369962 group by v45;
create or replace view aggJoin5517555882981740193 as select keyword_id as v22, annot from movie_keyword as mk, aggView3807610720827707348 where mk.movie_id=aggView3807610720827707348.v45;
create or replace view aggView3970241928163445188 as select v22, SUM(annot) as annot from aggJoin5517555882981740193 group by v22;
create or replace view aggJoin4453646668228234825 as select annot from keyword as k, aggView3970241928163445188 where k.id=aggView3970241928163445188.v22 and keyword IN ('murder','murder-in-title','blood','violence');
select SUM(annot) as v57 from aggJoin4453646668228234825;
