create or replace view aggView8480085173895110319 as select id as v25 from kind_type as kt where kind IN ('movie','episode');
create or replace view aggJoin2372930622455092238 as select id as v45, production_year as v49 from title as t, aggView8480085173895110319 where t.kind_id=aggView8480085173895110319.v25 and production_year>2000;
create or replace view aggView8780553647327156642 as select id as v5 from comp_cast_type as cct1 where kind= 'crew';
create or replace view aggJoin4334455687575748834 as select movie_id as v45, status_id as v7 from complete_cast as cc, aggView8780553647327156642 where cc.subject_id=aggView8780553647327156642.v5;
create or replace view aggView704617234528869046 as select id as v16 from company_type as ct;
create or replace view aggJoin6070551918188683003 as select movie_id as v45, company_id as v9, note as v31 from movie_companies as mc, aggView704617234528869046 where mc.company_type_id=aggView704617234528869046.v16 and note NOT LIKE '%(USA)%' and note LIKE '%(200%)%';
create or replace view aggView5496218530185864631 as select id as v20 from info_type as it2 where info= 'rating';
create or replace view aggJoin5506217340180296949 as select movie_id as v45, info as v40 from movie_info_idx as mi_idx, aggView5496218530185864631 where mi_idx.info_type_id=aggView5496218530185864631.v20 and info<'8.5';
create or replace view aggView1904813964397887677 as select id as v7 from comp_cast_type as cct2 where kind<> 'complete+verified';
create or replace view aggJoin6894190863111782524 as select v45 from aggJoin4334455687575748834 join aggView1904813964397887677 using(v7);
create or replace view aggView9205149046534795813 as select id as v9 from company_name as cn where country_code<> '[us]';
create or replace view aggJoin4587792529458728333 as select v45, v31 from aggJoin6070551918188683003 join aggView9205149046534795813 using(v9);
create or replace view aggView4847490766649029000 as select v45, COUNT(*) as annot from aggJoin2372930622455092238 group by v45;
create or replace view aggJoin1928548624243014529 as select movie_id as v45, info_type_id as v18, info as v35, annot from movie_info as mi, aggView4847490766649029000 where mi.movie_id=aggView4847490766649029000.v45 and info IN ('Sweden','Norway','Germany','Denmark','Swedish','Danish','Norwegian','German','USA','American');
create or replace view aggView2974331997966964960 as select id as v18 from info_type as it1 where info= 'countries';
create or replace view aggJoin5985177988245502629 as select v45, v35, annot from aggJoin1928548624243014529 join aggView2974331997966964960 using(v18);
create or replace view aggView5304613720473501059 as select v45, SUM(annot) as annot from aggJoin5985177988245502629 group by v45;
create or replace view aggJoin3548455459009091748 as select v45, v31, annot from aggJoin4587792529458728333 join aggView5304613720473501059 using(v45);
create or replace view aggView3048474442354995181 as select v45, SUM(annot) as annot from aggJoin3548455459009091748 group by v45;
create or replace view aggJoin9103080062644535620 as select v45, annot from aggJoin6894190863111782524 join aggView3048474442354995181 using(v45);
create or replace view aggView4252033171462187711 as select v45, SUM(annot) as annot from aggJoin9103080062644535620 group by v45;
create or replace view aggJoin4441979141814544526 as select v45, v40, annot from aggJoin5506217340180296949 join aggView4252033171462187711 using(v45);
create or replace view aggView7908214791591417217 as select v45, SUM(annot) as annot from aggJoin4441979141814544526 group by v45;
create or replace view aggJoin2170163225608234998 as select keyword_id as v22, annot from movie_keyword as mk, aggView7908214791591417217 where mk.movie_id=aggView7908214791591417217.v45;
create or replace view aggView7958469724675855797 as select v22, SUM(annot) as annot from aggJoin2170163225608234998 group by v22;
create or replace view aggJoin6473573054468952650 as select annot from keyword as k, aggView7958469724675855797 where k.id=aggView7958469724675855797.v22 and keyword IN ('murder','murder-in-title','blood','violence');
select SUM(annot) as v57 from aggJoin6473573054468952650;
