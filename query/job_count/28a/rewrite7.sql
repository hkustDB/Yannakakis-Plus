create or replace view aggView1947167616682045634 as select id as v9 from company_name as cn where country_code<> '[us]';
create or replace view aggJoin24902832022210606 as select movie_id as v45, company_type_id as v16, note as v31 from movie_companies as mc, aggView1947167616682045634 where mc.company_id=aggView1947167616682045634.v9 and note NOT LIKE '%(USA)%' and note LIKE '%(200%)%';
create or replace view aggView8155042731013047377 as select id as v16 from company_type as ct;
create or replace view aggJoin8863594128908418249 as select v45, v31 from aggJoin24902832022210606 join aggView8155042731013047377 using(v16);
create or replace view aggView2229435865869828676 as select id as v5 from comp_cast_type as cct1 where kind= 'crew';
create or replace view aggJoin9100195072810568487 as select movie_id as v45, status_id as v7 from complete_cast as cc, aggView2229435865869828676 where cc.subject_id=aggView2229435865869828676.v5;
create or replace view aggView3427974748300834464 as select id as v25 from kind_type as kt where kind IN ('movie','episode');
create or replace view aggJoin7943892248551614190 as select id as v45, production_year as v49 from title as t, aggView3427974748300834464 where t.kind_id=aggView3427974748300834464.v25 and production_year>2000;
create or replace view aggView7932815538505639771 as select id as v20 from info_type as it2 where info= 'rating';
create or replace view aggJoin8705952422877031603 as select movie_id as v45, info as v40 from movie_info_idx as mi_idx, aggView7932815538505639771 where mi_idx.info_type_id=aggView7932815538505639771.v20 and info<'8.5';
create or replace view aggView6013587526691721374 as select id as v7 from comp_cast_type as cct2 where kind<> 'complete+verified';
create or replace view aggJoin5645488636428353041 as select v45 from aggJoin9100195072810568487 join aggView6013587526691721374 using(v7);
create or replace view aggView804784171147294513 as select v45, COUNT(*) as annot from aggJoin8705952422877031603 group by v45;
create or replace view aggJoin292781083022402023 as select v45, v31, annot from aggJoin8863594128908418249 join aggView804784171147294513 using(v45);
create or replace view aggView4798540578133171099 as select v45, SUM(annot) as annot from aggJoin292781083022402023 group by v45;
create or replace view aggJoin7519148876704177200 as select v45, annot from aggJoin5645488636428353041 join aggView4798540578133171099 using(v45);
create or replace view aggView4592419374822602564 as select v45, SUM(annot) as annot from aggJoin7519148876704177200 group by v45;
create or replace view aggJoin4909387722255783770 as select v45, v49, annot from aggJoin7943892248551614190 join aggView4592419374822602564 using(v45);
create or replace view aggView6664518419799143927 as select id as v18 from info_type as it1 where info= 'countries';
create or replace view aggJoin2997060496896539949 as select movie_id as v45, info as v35 from movie_info as mi, aggView6664518419799143927 where mi.info_type_id=aggView6664518419799143927.v18 and info IN ('Sweden','Norway','Germany','Denmark','Swedish','Danish','Norwegian','German','USA','American');
create or replace view aggView1541147847179391897 as select v45, SUM(annot) as annot from aggJoin4909387722255783770 group by v45;
create or replace view aggJoin6873839597872379743 as select v45, v35, annot from aggJoin2997060496896539949 join aggView1541147847179391897 using(v45);
create or replace view aggView3071930773733309859 as select v45, SUM(annot) as annot from aggJoin6873839597872379743 group by v45;
create or replace view aggJoin1066007580270957210 as select keyword_id as v22, annot from movie_keyword as mk, aggView3071930773733309859 where mk.movie_id=aggView3071930773733309859.v45;
create or replace view aggView7865761350499563120 as select v22, SUM(annot) as annot from aggJoin1066007580270957210 group by v22;
create or replace view aggJoin6328444618312796820 as select annot from keyword as k, aggView7865761350499563120 where k.id=aggView7865761350499563120.v22 and keyword IN ('murder','murder-in-title','blood','violence');
select SUM(annot) as v57 from aggJoin6328444618312796820;
