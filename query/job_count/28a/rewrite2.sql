create or replace view aggView5464078938138890336 as select id as v7 from comp_cast_type as cct2 where kind<> 'complete+verified';
create or replace view aggJoin5961056041771738245 as select movie_id as v45, subject_id as v5 from complete_cast as cc, aggView5464078938138890336 where cc.status_id=aggView5464078938138890336.v7;
create or replace view aggView3149595265403576957 as select id as v20 from info_type as it2 where info= 'rating';
create or replace view aggJoin6761554542716024732 as select movie_id as v45, info as v40 from movie_info_idx as mi_idx, aggView3149595265403576957 where mi_idx.info_type_id=aggView3149595265403576957.v20 and info<'8.5';
create or replace view aggView4466339278247458713 as select id as v25 from kind_type as kt where kind IN ('movie','episode');
create or replace view aggJoin3142990149944006724 as select id as v45, production_year as v49 from title as t, aggView4466339278247458713 where t.kind_id=aggView4466339278247458713.v25 and production_year>2000;
create or replace view aggView2008347597310638365 as select id as v16 from company_type as ct;
create or replace view aggJoin2085517377127460537 as select movie_id as v45, company_id as v9, note as v31 from movie_companies as mc, aggView2008347597310638365 where mc.company_type_id=aggView2008347597310638365.v16 and note NOT LIKE '%(USA)%' and note LIKE '%(200%)%';
create or replace view aggView2343628017725298976 as select id as v5 from comp_cast_type as cct1 where kind= 'crew';
create or replace view aggJoin7731821472910163925 as select v45 from aggJoin5961056041771738245 join aggView2343628017725298976 using(v5);
create or replace view aggView1705221893293677232 as select id as v18 from info_type as it1 where info= 'countries';
create or replace view aggJoin6306695839153624479 as select movie_id as v45, info as v35 from movie_info as mi, aggView1705221893293677232 where mi.info_type_id=aggView1705221893293677232.v18 and info IN ('Sweden','Norway','Germany','Denmark','Swedish','Danish','Norwegian','German','USA','American');
create or replace view aggView6174601135420786410 as select id as v9 from company_name as cn where country_code<> '[us]';
create or replace view aggJoin985917863976251097 as select v45, v31 from aggJoin2085517377127460537 join aggView6174601135420786410 using(v9);
create or replace view aggView527683166304792937 as select v45, COUNT(*) as annot from aggJoin3142990149944006724 group by v45;
create or replace view aggJoin4779705036505506490 as select v45, v35, annot from aggJoin6306695839153624479 join aggView527683166304792937 using(v45);
create or replace view aggView260651388000007123 as select v45, SUM(annot) as annot from aggJoin4779705036505506490 group by v45;
create or replace view aggJoin7201117964484509061 as select v45, v31, annot from aggJoin985917863976251097 join aggView260651388000007123 using(v45);
create or replace view aggView6749867382931187368 as select v45, SUM(annot) as annot from aggJoin7201117964484509061 group by v45;
create or replace view aggJoin966415609768699183 as select v45, annot from aggJoin7731821472910163925 join aggView6749867382931187368 using(v45);
create or replace view aggView9121310182135588967 as select v45, SUM(annot) as annot from aggJoin966415609768699183 group by v45;
create or replace view aggJoin236167998595593575 as select v45, v40, annot from aggJoin6761554542716024732 join aggView9121310182135588967 using(v45);
create or replace view aggView9097134157152872817 as select v45, SUM(annot) as annot from aggJoin236167998595593575 group by v45;
create or replace view aggJoin6376338123520030677 as select keyword_id as v22, annot from movie_keyword as mk, aggView9097134157152872817 where mk.movie_id=aggView9097134157152872817.v45;
create or replace view aggView621784524474572938 as select v22, SUM(annot) as annot from aggJoin6376338123520030677 group by v22;
create or replace view aggJoin4472949067613167764 as select annot from keyword as k, aggView621784524474572938 where k.id=aggView621784524474572938.v22 and keyword IN ('murder','murder-in-title','blood','violence');
select SUM(annot) as v57 from aggJoin4472949067613167764;
