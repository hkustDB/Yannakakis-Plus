create or replace view aggView7215002376646534696 as select id as v22 from name as n where gender= 'm' and name LIKE '%Tim%';
create or replace view aggJoin3413461417760748712 as select movie_id as v31, note as v5 from cast_info as ci, aggView7215002376646534696 where ci.person_id=aggView7215002376646534696.v22 and note IN ('(producer)','(executive producer)');
create or replace view aggView2840197818249906000 as select id as v8 from info_type as it1 where info= 'budget';
create or replace view aggJoin6880903524958420610 as select movie_id as v31 from movie_info as mi, aggView2840197818249906000 where mi.info_type_id=aggView2840197818249906000.v8;
create or replace view aggView8537494750012139419 as select v31, COUNT(*) as annot from aggJoin6880903524958420610 group by v31;
create or replace view aggJoin116086402463933307 as select v31, v5, annot from aggJoin3413461417760748712 join aggView8537494750012139419 using(v31);
create or replace view aggView6598505590554320528 as select v31, SUM(annot) as annot from aggJoin116086402463933307 group by v31;
create or replace view aggJoin416517909081436108 as select id as v31, annot from title as t, aggView6598505590554320528 where t.id=aggView6598505590554320528.v31;
create or replace view aggView1563324575619165957 as select v31, SUM(annot) as annot from aggJoin416517909081436108 group by v31;
create or replace view aggJoin4507598898213606816 as select info_type_id as v10, annot from movie_info_idx as mi_idx, aggView1563324575619165957 where mi_idx.movie_id=aggView1563324575619165957.v31;
create or replace view aggView6763639192412109248 as select v10, SUM(annot) as annot from aggJoin4507598898213606816 group by v10;
create or replace view aggJoin4017471324401826563 as select info as v11, annot from info_type as it2, aggView6763639192412109248 where it2.id=aggView6763639192412109248.v10 and info= 'votes';
select SUM(annot) as v43 from aggJoin4017471324401826563;
