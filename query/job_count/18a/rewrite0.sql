create or replace view aggView3037617136419361591 as select id as v8 from info_type as it1 where info= 'budget';
create or replace view aggJoin4034037453483562337 as select movie_id as v31 from movie_info as mi, aggView3037617136419361591 where mi.info_type_id=aggView3037617136419361591.v8;
create or replace view aggView1208050803377851671 as select id as v10 from info_type as it2 where info= 'votes';
create or replace view aggJoin3731786570326607803 as select movie_id as v31 from movie_info_idx as mi_idx, aggView1208050803377851671 where mi_idx.info_type_id=aggView1208050803377851671.v10;
create or replace view aggView2332235103382580188 as select v31, COUNT(*) as annot from aggJoin3731786570326607803 group by v31;
create or replace view aggJoin4159816831332314526 as select v31, annot from aggJoin4034037453483562337 join aggView2332235103382580188 using(v31);
create or replace view aggView1226136824996152578 as select v31, SUM(annot) as annot from aggJoin4159816831332314526 group by v31;
create or replace view aggJoin7926320818907021740 as select id as v31, annot from title as t, aggView1226136824996152578 where t.id=aggView1226136824996152578.v31;
create or replace view aggView5940006776524552840 as select v31, SUM(annot) as annot from aggJoin7926320818907021740 group by v31;
create or replace view aggJoin6024727698686692449 as select person_id as v22, note as v5, annot from cast_info as ci, aggView5940006776524552840 where ci.movie_id=aggView5940006776524552840.v31 and note IN ('(producer)','(executive producer)');
create or replace view aggView914698247626925298 as select v22, SUM(annot) as annot from aggJoin6024727698686692449 group by v22;
create or replace view aggJoin8291143638360979909 as select name as v23, gender as v26, annot from name as n, aggView914698247626925298 where n.id=aggView914698247626925298.v22 and gender= 'm' and name LIKE '%Tim%';
select SUM(annot) as v43 from aggJoin8291143638360979909;
