create or replace view aggView8198838411895072651 as select id as v22 from name as n where gender= 'm' and name LIKE '%Tim%';
create or replace view aggJoin2833151702124842660 as select movie_id as v31, note as v5 from cast_info as ci, aggView8198838411895072651 where ci.person_id=aggView8198838411895072651.v22 and note IN ('(producer)','(executive producer)');
create or replace view aggView7853599269716669021 as select v31, COUNT(*) as annot from aggJoin2833151702124842660 group by v31;
create or replace view aggJoin340665435268463072 as select id as v31, annot from title as t, aggView7853599269716669021 where t.id=aggView7853599269716669021.v31;
create or replace view aggView1749939303324783867 as select id as v8 from info_type as it1 where info= 'budget';
create or replace view aggJoin3920940493019770836 as select movie_id as v31 from movie_info as mi, aggView1749939303324783867 where mi.info_type_id=aggView1749939303324783867.v8;
create or replace view aggView4962530411421774333 as select id as v10 from info_type as it2 where info= 'votes';
create or replace view aggJoin5430259720192691512 as select movie_id as v31 from movie_info_idx as mi_idx, aggView4962530411421774333 where mi_idx.info_type_id=aggView4962530411421774333.v10;
create or replace view aggView6216057427385105215 as select v31, SUM(annot) as annot from aggJoin340665435268463072 group by v31;
create or replace view aggJoin4712586417944940094 as select v31, annot from aggJoin5430259720192691512 join aggView6216057427385105215 using(v31);
create or replace view aggView4188969381359975551 as select v31, SUM(annot) as annot from aggJoin4712586417944940094 group by v31;
create or replace view aggJoin8060349827989532887 as select annot from aggJoin3920940493019770836 join aggView4188969381359975551 using(v31);
select SUM(annot) as v43 from aggJoin8060349827989532887;
