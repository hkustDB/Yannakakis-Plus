create or replace view aggView9019743616363208221 as select id as v29 from role_type as rt;
create or replace view aggJoin3481176457947421561 as select movie_id as v31, person_role_id as v1, note as v12 from cast_info as ci, aggView9019743616363208221 where ci.role_id=aggView9019743616363208221.v29 and note LIKE '%(producer)%';
create or replace view aggView9218449595418586650 as select id as v1 from char_name as chn;
create or replace view aggJoin3373517020217646604 as select v31, v12 from aggJoin3481176457947421561 join aggView9218449595418586650 using(v1);
create or replace view aggView2975606581105311358 as select id as v22 from company_type as ct;
create or replace view aggJoin2707150379028596315 as select movie_id as v31, company_id as v15 from movie_companies as mc, aggView2975606581105311358 where mc.company_type_id=aggView2975606581105311358.v22;
create or replace view aggView3577851478998365842 as select v31, COUNT(*) as annot from aggJoin3373517020217646604 group by v31;
create or replace view aggJoin2191582066002644835 as select id as v31, production_year as v35, annot from title as t, aggView3577851478998365842 where t.id=aggView3577851478998365842.v31 and production_year>1990;
create or replace view aggView8952504428829487955 as select v31, SUM(annot) as annot from aggJoin2191582066002644835 group by v31;
create or replace view aggJoin22109970604446352 as select v15, annot from aggJoin2707150379028596315 join aggView8952504428829487955 using(v31);
create or replace view aggView1607063373829754909 as select v15, SUM(annot) as annot from aggJoin22109970604446352 group by v15;
create or replace view aggJoin4339590406781521366 as select country_code as v17, annot from company_name as cn, aggView1607063373829754909 where cn.id=aggView1607063373829754909.v15 and country_code= '[us]';
select SUM(annot) as v43 from aggJoin4339590406781521366;
