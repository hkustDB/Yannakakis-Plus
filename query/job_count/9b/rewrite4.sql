create or replace view aggView8669124260313407889 as select id as v22 from role_type as rt where role= 'actress';
create or replace view aggJoin8620017971144658578 as select person_id as v35, movie_id as v18, person_role_id as v9, note as v20 from cast_info as ci, aggView8669124260313407889 where ci.role_id=aggView8669124260313407889.v22 and note= '(voice)';
create or replace view aggView3515866809370556554 as select person_id as v35, COUNT(*) as annot from aka_name as an group by person_id;
create or replace view aggJoin7352659673417342967 as select v35, v18, v9, v20, annot from aggJoin8620017971144658578 join aggView3515866809370556554 using(v35);
create or replace view aggView2084730006063470970 as select id as v32 from company_name as cn where country_code= '[us]';
create or replace view aggJoin3857355834647909630 as select movie_id as v18, note as v34 from movie_companies as mc, aggView2084730006063470970 where mc.company_id=aggView2084730006063470970.v32 and ((note LIKE '%(USA)%') OR (note LIKE '%(worldwide)%')) and note LIKE '%(200%)%';
create or replace view aggView8993540715459054928 as select id as v35 from name as n where gender= 'f' and name LIKE '%Angel%';
create or replace view aggJoin2353878579319720927 as select v18, v9, v20, annot from aggJoin7352659673417342967 join aggView8993540715459054928 using(v35);
create or replace view aggView3675744231993369867 as select v18, COUNT(*) as annot from aggJoin3857355834647909630 group by v18;
create or replace view aggJoin8465865126937931185 as select id as v18, production_year as v50, annot from title as t, aggView3675744231993369867 where t.id=aggView3675744231993369867.v18 and production_year>=2007 and production_year<=2010;
create or replace view aggView6248227657554034724 as select v18, SUM(annot) as annot from aggJoin8465865126937931185 group by v18;
create or replace view aggJoin8564481719706847228 as select v9, v20, aggJoin2353878579319720927.annot * aggView6248227657554034724.annot as annot from aggJoin2353878579319720927 join aggView6248227657554034724 using(v18);
create or replace view aggView6953895758310375727 as select v9, SUM(annot) as annot from aggJoin8564481719706847228 group by v9;
create or replace view aggJoin2157882397891739005 as select annot from char_name as chn, aggView6953895758310375727 where chn.id=aggView6953895758310375727.v9;
select SUM(annot) as v58 from aggJoin2157882397891739005;
