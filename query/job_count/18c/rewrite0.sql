create or replace view aggView30933556742741946 as select id as v22 from name as n where gender= 'm';
create or replace view aggJoin8518218439010391148 as select movie_id as v31, note as v5 from cast_info as ci, aggView30933556742741946 where ci.person_id=aggView30933556742741946.v22 and note IN ('(writer)','(head writer)','(written by)','(story)','(story editor)');
create or replace view aggView8774272075662688326 as select id as v8 from info_type as it1 where info= 'genres';
create or replace view aggJoin3587502330417958270 as select movie_id as v31, info as v15 from movie_info as mi, aggView8774272075662688326 where mi.info_type_id=aggView8774272075662688326.v8 and info IN ('Horror','Action','Sci-Fi','Thriller','Crime','War');
create or replace view aggView6301103363759773331 as select v31, COUNT(*) as annot from aggJoin8518218439010391148 group by v31;
create or replace view aggJoin9068372929047374821 as select id as v31, annot from title as t, aggView6301103363759773331 where t.id=aggView6301103363759773331.v31;
create or replace view aggView8421245253250515340 as select v31, SUM(annot) as annot from aggJoin9068372929047374821 group by v31;
create or replace view aggJoin3943602121478242345 as select v31, v15, annot from aggJoin3587502330417958270 join aggView8421245253250515340 using(v31);
create or replace view aggView6262395935217345855 as select v31, SUM(annot) as annot from aggJoin3943602121478242345 group by v31;
create or replace view aggJoin1536336954801485425 as select info_type_id as v10, annot from movie_info_idx as mi_idx, aggView6262395935217345855 where mi_idx.movie_id=aggView6262395935217345855.v31;
create or replace view aggView6196812890812389247 as select v10, SUM(annot) as annot from aggJoin1536336954801485425 group by v10;
create or replace view aggJoin6010133416129231778 as select info as v11, annot from info_type as it2, aggView6196812890812389247 where it2.id=aggView6196812890812389247.v10 and info= 'votes';
select SUM(annot) as v43 from aggJoin6010133416129231778;
