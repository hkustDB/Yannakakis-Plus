create or replace view aggView227203380340606086 as select id as v25 from keyword as k where keyword= 'character-name-in-title';
create or replace view aggJoin3010926164883934890 as select movie_id as v3 from movie_keyword as mk, aggView227203380340606086 where mk.keyword_id=aggView227203380340606086.v25;
create or replace view aggView6501639956558513151 as select v3, COUNT(*) as annot from aggJoin3010926164883934890 group by v3;
create or replace view aggJoin3792736961151079066 as select movie_id as v3, company_id as v20, annot from movie_companies as mc, aggView6501639956558513151 where mc.movie_id=aggView6501639956558513151.v3;
create or replace view aggView4213883767895095382 as select id as v20 from company_name as cn where country_code= '[us]';
create or replace view aggJoin2071977975981648565 as select v3, annot from aggJoin3792736961151079066 join aggView4213883767895095382 using(v20);
create or replace view aggView9184536235366957316 as select v3, SUM(annot) as annot from aggJoin2071977975981648565 group by v3;
create or replace view aggJoin3375464658788325598 as select id as v3, annot from title as t, aggView9184536235366957316 where t.id=aggView9184536235366957316.v3;
create or replace view aggView1965116563582824017 as select v3, SUM(annot) as annot from aggJoin3375464658788325598 group by v3;
create or replace view aggJoin8603344932688931988 as select person_id as v26, annot from cast_info as ci, aggView1965116563582824017 where ci.movie_id=aggView1965116563582824017.v3;
create or replace view aggView8896836775928566762 as select v26, SUM(annot) as annot from aggJoin8603344932688931988 group by v26;
create or replace view aggJoin8776984175570150369 as select name as v27, annot from name as n, aggView8896836775928566762 where n.id=aggView8896836775928566762.v26 and name LIKE 'B%';
select SUM(annot) as v47 from aggJoin8776984175570150369;
