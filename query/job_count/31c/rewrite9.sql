create or replace view aggView6800652141048273062 as select id as v8 from company_name as cn where name LIKE 'Lionsgate%';
create or replace view aggJoin6409036071710615897 as select movie_id as v49 from movie_companies as mc, aggView6800652141048273062 where mc.company_id=aggView6800652141048273062.v8;
create or replace view aggView3882224830523396764 as select id as v15 from info_type as it1 where info= 'genres';
create or replace view aggJoin6901948774558659007 as select movie_id as v49, info as v30 from movie_info as mi, aggView3882224830523396764 where mi.info_type_id=aggView3882224830523396764.v15 and info IN ('Horror','Action','Sci-Fi','Thriller','Crime','War');
create or replace view aggView447199627442858822 as select v49, COUNT(*) as annot from aggJoin6901948774558659007 group by v49;
create or replace view aggJoin7726941584692167904 as select id as v49, annot from title as t, aggView447199627442858822 where t.id=aggView447199627442858822.v49;
create or replace view aggView132533024573783842 as select id as v19 from keyword as k where keyword IN ('murder','violence','blood','gore','death','female-nudity','hospital');
create or replace view aggJoin1052778401044789562 as select movie_id as v49 from movie_keyword as mk, aggView132533024573783842 where mk.keyword_id=aggView132533024573783842.v19;
create or replace view aggView6649304400991782463 as select id as v17 from info_type as it2 where info= 'votes';
create or replace view aggJoin2060597800607784266 as select movie_id as v49 from movie_info_idx as mi_idx, aggView6649304400991782463 where mi_idx.info_type_id=aggView6649304400991782463.v17;
create or replace view aggView7049218803083434303 as select v49, SUM(annot) as annot from aggJoin7726941584692167904 group by v49;
create or replace view aggJoin1329352199812128243 as select v49, annot from aggJoin6409036071710615897 join aggView7049218803083434303 using(v49);
create or replace view aggView2426097534688243417 as select v49, SUM(annot) as annot from aggJoin1329352199812128243 group by v49;
create or replace view aggJoin4846707978354171317 as select v49, annot from aggJoin1052778401044789562 join aggView2426097534688243417 using(v49);
create or replace view aggView2510098820156694442 as select v49, SUM(annot) as annot from aggJoin4846707978354171317 group by v49;
create or replace view aggJoin5775762835645917493 as select v49, annot from aggJoin2060597800607784266 join aggView2510098820156694442 using(v49);
create or replace view aggView8741833326890578552 as select v49, SUM(annot) as annot from aggJoin5775762835645917493 group by v49;
create or replace view aggJoin7488830717700864680 as select person_id as v40, note as v5, annot from cast_info as ci, aggView8741833326890578552 where ci.movie_id=aggView8741833326890578552.v49 and note IN ('(writer)','(head writer)','(written by)','(story)','(story editor)');
create or replace view aggView7539284029744492572 as select v40, SUM(annot) as annot from aggJoin7488830717700864680 group by v40;
create or replace view aggJoin5420519177696100045 as select annot from name as n, aggView7539284029744492572 where n.id=aggView7539284029744492572.v40;
select SUM(annot) as v61 from aggJoin5420519177696100045;
