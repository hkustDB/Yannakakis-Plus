create or replace view aggView7359539890450091682 as select id as v25 from kind_type as kt where kind IN ('movie','episode');
create or replace view aggJoin7661266420219761593 as select id as v45, production_year as v49 from title as t, aggView7359539890450091682 where t.kind_id=aggView7359539890450091682.v25 and production_year>2005;
create or replace view aggView2958624470679655237 as select id as v20 from info_type as it2 where info= 'rating';
create or replace view aggJoin236253694010217046 as select movie_id as v45, info as v40 from movie_info_idx as mi_idx, aggView2958624470679655237 where mi_idx.info_type_id=aggView2958624470679655237.v20 and info<'8.5';
create or replace view aggView1019648741676516087 as select id as v5 from comp_cast_type as cct1 where kind= 'cast';
create or replace view aggJoin8969923636244566790 as select movie_id as v45, status_id as v7 from complete_cast as cc, aggView1019648741676516087 where cc.subject_id=aggView1019648741676516087.v5;
create or replace view aggView7116347927377204352 as select id as v16 from company_type as ct;
create or replace view aggJoin6196704816028272729 as select movie_id as v45, company_id as v9, note as v31 from movie_companies as mc, aggView7116347927377204352 where mc.company_type_id=aggView7116347927377204352.v16 and note NOT LIKE '%(USA)%' and note LIKE '%(200%)%';
create or replace view aggView4583382295976495646 as select id as v7 from comp_cast_type as cct2 where kind= 'complete';
create or replace view aggJoin6573235111891673930 as select v45 from aggJoin8969923636244566790 join aggView4583382295976495646 using(v7);
create or replace view aggView5928998088461241698 as select id as v9 from company_name as cn where country_code<> '[us]';
create or replace view aggJoin6647309084176195428 as select v45, v31 from aggJoin6196704816028272729 join aggView5928998088461241698 using(v9);
create or replace view aggView579612079803589752 as select id as v18 from info_type as it1 where info= 'countries';
create or replace view aggJoin9143098634521798412 as select movie_id as v45, info as v35 from movie_info as mi, aggView579612079803589752 where mi.info_type_id=aggView579612079803589752.v18 and info IN ('Sweden','Norway','Germany','Denmark','Swedish','Danish','Norwegian','German','USA','American');
create or replace view aggView4077741328098926866 as select v45, COUNT(*) as annot from aggJoin9143098634521798412 group by v45;
create or replace view aggJoin6560215931554959936 as select v45, v49, annot from aggJoin7661266420219761593 join aggView4077741328098926866 using(v45);
create or replace view aggView3563643024884151604 as select v45, SUM(annot) as annot from aggJoin6560215931554959936 group by v45;
create or replace view aggJoin8012399972886636248 as select v45, v40, annot from aggJoin236253694010217046 join aggView3563643024884151604 using(v45);
create or replace view aggView405081362577439300 as select v45, SUM(annot) as annot from aggJoin8012399972886636248 group by v45;
create or replace view aggJoin3988637247473727549 as select v45, v31, annot from aggJoin6647309084176195428 join aggView405081362577439300 using(v45);
create or replace view aggView2543330245448516838 as select v45, SUM(annot) as annot from aggJoin3988637247473727549 group by v45;
create or replace view aggJoin4700090599984411800 as select v45, annot from aggJoin6573235111891673930 join aggView2543330245448516838 using(v45);
create or replace view aggView148463679152048547 as select v45, SUM(annot) as annot from aggJoin4700090599984411800 group by v45;
create or replace view aggJoin3198187003635803822 as select keyword_id as v22, annot from movie_keyword as mk, aggView148463679152048547 where mk.movie_id=aggView148463679152048547.v45;
create or replace view aggView9011168974297310186 as select v22, SUM(annot) as annot from aggJoin3198187003635803822 group by v22;
create or replace view aggJoin4472842777232083868 as select annot from keyword as k, aggView9011168974297310186 where k.id=aggView9011168974297310186.v22 and keyword IN ('murder','murder-in-title','blood','violence');
select SUM(annot) as v57 from aggJoin4472842777232083868;
