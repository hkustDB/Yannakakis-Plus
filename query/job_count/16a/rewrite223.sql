create or replace view aggView9214370406769050563 as select id as v28 from company_name as cn where country_code= '[us]';
create or replace view aggJoin7588743494389923467 as select movie_id as v11 from movie_companies as mc, aggView9214370406769050563 where mc.company_id=aggView9214370406769050563.v28;
create or replace view aggView2616259146718243864 as select v11, COUNT(*) as annot from aggJoin7588743494389923467 group by v11;
create or replace view aggJoin1306165062106580932 as select movie_id as v11, keyword_id as v33, annot from movie_keyword as mk, aggView2616259146718243864 where mk.movie_id=aggView2616259146718243864.v11;
create or replace view aggView2112037188434627043 as select id as v33 from keyword as k where keyword= 'character-name-in-title';
create or replace view aggJoin894852300049320060 as select v11, annot from aggJoin1306165062106580932 join aggView2112037188434627043 using(v33);
create or replace view aggView2930538082318677062 as select v11, SUM(annot) as annot from aggJoin894852300049320060 group by v11;
create or replace view aggJoin543179100197741893 as select id as v11, episode_nr as v52, annot from title as t, aggView2930538082318677062 where t.id=aggView2930538082318677062.v11 and episode_nr>=50 and episode_nr<100;
create or replace view aggView98599132347227959 as select v11, SUM(annot) as annot from aggJoin543179100197741893 group by v11;
create or replace view aggJoin6849337390079218545 as select person_id as v2, annot from cast_info as ci, aggView98599132347227959 where ci.movie_id=aggView98599132347227959.v11;
create or replace view aggView4764386279313297059 as select person_id as v2, COUNT(*) as annot from aka_name as an group by person_id;
create or replace view aggJoin2993639456860241776 as select id as v2, annot from name as n, aggView4764386279313297059 where n.id=aggView4764386279313297059.v2;
create or replace view aggView6265327854503116917 as select v2, SUM(annot) as annot from aggJoin2993639456860241776 group by v2;
create or replace view aggJoin4102915292054248630 as select aggJoin6849337390079218545.annot * aggView6265327854503116917.annot as annot from aggJoin6849337390079218545 join aggView6265327854503116917 using(v2);
select SUM(annot) as v55 from aggJoin4102915292054248630;
