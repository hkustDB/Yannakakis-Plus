create or replace view aggView62765695850625189 as select id as v28 from company_name as cn where country_code= '[us]';
create or replace view aggJoin7274543490767509051 as select movie_id as v11 from movie_companies as mc, aggView62765695850625189 where mc.company_id=aggView62765695850625189.v28;
create or replace view aggView3578039913519090244 as select v11, COUNT(*) as annot from aggJoin7274543490767509051 group by v11;
create or replace view aggJoin4761061709175920863 as select movie_id as v11, keyword_id as v33, annot from movie_keyword as mk, aggView3578039913519090244 where mk.movie_id=aggView3578039913519090244.v11;
create or replace view aggView4051047658234371579 as select id as v33 from keyword as k where keyword= 'character-name-in-title';
create or replace view aggJoin2190966950353464769 as select v11, annot from aggJoin4761061709175920863 join aggView4051047658234371579 using(v33);
create or replace view aggView6053611955110868761 as select v11, SUM(annot) as annot from aggJoin2190966950353464769 group by v11;
create or replace view aggJoin3382170042690773978 as select id as v11, episode_nr as v52, annot from title as t, aggView6053611955110868761 where t.id=aggView6053611955110868761.v11 and episode_nr>=50 and episode_nr<100;
create or replace view aggView8933522835418879950 as select v11, SUM(annot) as annot from aggJoin3382170042690773978 group by v11;
create or replace view aggJoin1437330627842072491 as select person_id as v2, annot from cast_info as ci, aggView8933522835418879950 where ci.movie_id=aggView8933522835418879950.v11;
create or replace view aggView3608074622652936020 as select id as v2 from name as n;
create or replace view aggJoin3980371158040098526 as select person_id as v2 from aka_name as an, aggView3608074622652936020 where an.person_id=aggView3608074622652936020.v2;
create or replace view aggView7161838365576626682 as select v2, COUNT(*) as annot from aggJoin3980371158040098526 group by v2;
create or replace view aggJoin8571609539351717650 as select aggJoin1437330627842072491.annot * aggView7161838365576626682.annot as annot from aggJoin1437330627842072491 join aggView7161838365576626682 using(v2);
select SUM(annot) as v55 from aggJoin8571609539351717650;
