create or replace view aggView7359592984640113202 as select id as v9 from company_name as cn where country_code<> '[us]';
create or replace view aggJoin4034084972352972572 as select movie_id as v45, company_type_id as v16, note as v31 from movie_companies as mc, aggView7359592984640113202 where mc.company_id=aggView7359592984640113202.v9 and note NOT LIKE '%(USA)%' and note LIKE '%(200%)%';
create or replace view aggView8097258862441457107 as select id as v18 from info_type as it1 where info= 'countries';
create or replace view aggJoin432909753472969388 as select movie_id as v45, info as v35 from movie_info as mi, aggView8097258862441457107 where mi.info_type_id=aggView8097258862441457107.v18 and info IN ('Sweden','Germany','Swedish','German');
create or replace view aggView4681121353995794748 as select id as v7 from comp_cast_type as cct2 where kind<> 'complete+verified';
create or replace view aggJoin6090856688009142659 as select movie_id as v45, subject_id as v5 from complete_cast as cc, aggView4681121353995794748 where cc.status_id=aggView4681121353995794748.v7;
create or replace view aggView7746092691962954480 as select id as v25 from kind_type as kt where kind IN ('movie','episode');
create or replace view aggJoin4609934654850366913 as select id as v45, production_year as v49 from title as t, aggView7746092691962954480 where t.kind_id=aggView7746092691962954480.v25 and production_year>2005;
create or replace view aggView5903195538990091027 as select id as v5 from comp_cast_type as cct1 where kind= 'crew';
create or replace view aggJoin5954581766750616820 as select v45 from aggJoin6090856688009142659 join aggView5903195538990091027 using(v5);
create or replace view aggView8836927761600264123 as select v45, COUNT(*) as annot from aggJoin5954581766750616820 group by v45;
create or replace view aggJoin1313532208287108554 as select v45, v49, annot from aggJoin4609934654850366913 join aggView8836927761600264123 using(v45);
create or replace view aggView2301674882297932039 as select v45, SUM(annot) as annot from aggJoin1313532208287108554 group by v45;
create or replace view aggJoin7632533216792785224 as select v45, v16, v31, annot from aggJoin4034084972352972572 join aggView2301674882297932039 using(v45);
create or replace view aggView871964508628202982 as select id as v16 from company_type as ct;
create or replace view aggJoin8063021768538752031 as select v45, v31, annot from aggJoin7632533216792785224 join aggView871964508628202982 using(v16);
create or replace view aggView2623657788139141584 as select v45, SUM(annot) as annot from aggJoin8063021768538752031 group by v45;
create or replace view aggJoin2093062380349276628 as select movie_id as v45, info_type_id as v20, info as v40, annot from movie_info_idx as mi_idx, aggView2623657788139141584 where mi_idx.movie_id=aggView2623657788139141584.v45 and info>'6.5';
create or replace view aggView765826506098578631 as select id as v20 from info_type as it2 where info= 'rating';
create or replace view aggJoin8894694066398268287 as select v45, v40, annot from aggJoin2093062380349276628 join aggView765826506098578631 using(v20);
create or replace view aggView2139690547397461270 as select v45, SUM(annot) as annot from aggJoin8894694066398268287 group by v45;
create or replace view aggJoin128713474184686396 as select v45, v35, annot from aggJoin432909753472969388 join aggView2139690547397461270 using(v45);
create or replace view aggView7926048400376094650 as select v45, SUM(annot) as annot from aggJoin128713474184686396 group by v45;
create or replace view aggJoin1772796887735591046 as select keyword_id as v22, annot from movie_keyword as mk, aggView7926048400376094650 where mk.movie_id=aggView7926048400376094650.v45;
create or replace view aggView1051430844830067218 as select v22, SUM(annot) as annot from aggJoin1772796887735591046 group by v22;
create or replace view aggJoin103721340260487927 as select annot from keyword as k, aggView1051430844830067218 where k.id=aggView1051430844830067218.v22 and keyword IN ('murder','murder-in-title','blood','violence');
select SUM(annot) as v57 from aggJoin103721340260487927;
