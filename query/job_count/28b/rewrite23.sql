create or replace view aggView3795905253883674619 as select id as v9 from company_name as cn where country_code<> '[us]';
create or replace view aggJoin936993473403298366 as select movie_id as v45, company_type_id as v16, note as v31 from movie_companies as mc, aggView3795905253883674619 where mc.company_id=aggView3795905253883674619.v9 and note NOT LIKE '%(USA)%' and note LIKE '%(200%)%';
create or replace view aggView634578552754330666 as select id as v18 from info_type as it1 where info= 'countries';
create or replace view aggJoin949656897671173402 as select movie_id as v45, info as v35 from movie_info as mi, aggView634578552754330666 where mi.info_type_id=aggView634578552754330666.v18 and info IN ('Sweden','Germany','Swedish','German');
create or replace view aggView2861119425555387772 as select id as v7 from comp_cast_type as cct2 where kind<> 'complete+verified';
create or replace view aggJoin6968635153295130931 as select movie_id as v45, subject_id as v5 from complete_cast as cc, aggView2861119425555387772 where cc.status_id=aggView2861119425555387772.v7;
create or replace view aggView7052250711181093026 as select id as v25 from kind_type as kt where kind IN ('movie','episode');
create or replace view aggJoin777355837598967156 as select id as v45, production_year as v49 from title as t, aggView7052250711181093026 where t.kind_id=aggView7052250711181093026.v25 and production_year>2005;
create or replace view aggView8864722660869171892 as select id as v5 from comp_cast_type as cct1 where kind= 'crew';
create or replace view aggJoin3238543178362301320 as select v45 from aggJoin6968635153295130931 join aggView8864722660869171892 using(v5);
create or replace view aggView3242882983919977868 as select v45, COUNT(*) as annot from aggJoin3238543178362301320 group by v45;
create or replace view aggJoin2881492794325898457 as select movie_id as v45, info_type_id as v20, info as v40, annot from movie_info_idx as mi_idx, aggView3242882983919977868 where mi_idx.movie_id=aggView3242882983919977868.v45 and info>'6.5';
create or replace view aggView504483016998596519 as select id as v20 from info_type as it2 where info= 'rating';
create or replace view aggJoin6828024017383680257 as select v45, v40, annot from aggJoin2881492794325898457 join aggView504483016998596519 using(v20);
create or replace view aggView7340960566547320358 as select v45, SUM(annot) as annot from aggJoin6828024017383680257 group by v45;
create or replace view aggJoin1798875523711610725 as select v45, v16, v31, annot from aggJoin936993473403298366 join aggView7340960566547320358 using(v45);
create or replace view aggView6642288582563181545 as select id as v16 from company_type as ct;
create or replace view aggJoin5431145854662595425 as select v45, v31, annot from aggJoin1798875523711610725 join aggView6642288582563181545 using(v16);
create or replace view aggView806030997255956578 as select v45, SUM(annot) as annot from aggJoin5431145854662595425 group by v45;
create or replace view aggJoin3720178704647007275 as select v45, v49, annot from aggJoin777355837598967156 join aggView806030997255956578 using(v45);
create or replace view aggView1149706314705767204 as select v45, SUM(annot) as annot from aggJoin3720178704647007275 group by v45;
create or replace view aggJoin6891484949137500895 as select v45, v35, annot from aggJoin949656897671173402 join aggView1149706314705767204 using(v45);
create or replace view aggView6063191720143494852 as select v45, SUM(annot) as annot from aggJoin6891484949137500895 group by v45;
create or replace view aggJoin1572392712129684918 as select keyword_id as v22, annot from movie_keyword as mk, aggView6063191720143494852 where mk.movie_id=aggView6063191720143494852.v45;
create or replace view aggView1184627978511187676 as select v22, SUM(annot) as annot from aggJoin1572392712129684918 group by v22;
create or replace view aggJoin8647431206042938463 as select annot from keyword as k, aggView1184627978511187676 where k.id=aggView1184627978511187676.v22 and keyword IN ('murder','murder-in-title','blood','violence');
select SUM(annot) as v57 from aggJoin8647431206042938463;
