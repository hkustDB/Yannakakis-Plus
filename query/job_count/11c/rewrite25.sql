create or replace view aggView796001673573820841 as select id as v18 from company_type as ct where kind<> 'production companies';
create or replace view aggJoin2779468350108650698 as select movie_id as v24, company_id as v17 from movie_companies as mc, aggView796001673573820841 where mc.company_type_id=aggView796001673573820841.v18;
create or replace view aggView8220109873819151641 as select id as v17 from company_name as cn where country_code<> '[pl]' and ((name LIKE '20th Century Fox%') OR (name LIKE 'Twentieth Century Fox%'));
create or replace view aggJoin4295856385908910801 as select v24 from aggJoin2779468350108650698 join aggView8220109873819151641 using(v17);
create or replace view aggView1915857479271935467 as select v24, COUNT(*) as annot from aggJoin4295856385908910801 group by v24;
create or replace view aggJoin142164637640539878 as select id as v24, production_year as v31, annot from title as t, aggView1915857479271935467 where t.id=aggView1915857479271935467.v24 and production_year>1950;
create or replace view aggView5555465259482625049 as select v24, SUM(annot) as annot from aggJoin142164637640539878 group by v24;
create or replace view aggJoin7959697778359881537 as select movie_id as v24, keyword_id as v22, annot from movie_keyword as mk, aggView5555465259482625049 where mk.movie_id=aggView5555465259482625049.v24;
create or replace view aggView651852225248663882 as select id as v22 from keyword as k where keyword IN ('sequel','revenge','based-on-novel');
create or replace view aggJoin3903747309480124561 as select v24, annot from aggJoin7959697778359881537 join aggView651852225248663882 using(v22);
create or replace view aggView862349420488505698 as select v24, SUM(annot) as annot from aggJoin3903747309480124561 group by v24;
create or replace view aggJoin8753490622540685425 as select link_type_id as v13, annot from movie_link as ml, aggView862349420488505698 where ml.movie_id=aggView862349420488505698.v24;
create or replace view aggView3205404212511363634 as select v13, SUM(annot) as annot from aggJoin8753490622540685425 group by v13;
create or replace view aggJoin2165816800641044546 as select annot from link_type as lt, aggView3205404212511363634 where lt.id=aggView3205404212511363634.v13;
select SUM(annot) as v39 from aggJoin2165816800641044546;
