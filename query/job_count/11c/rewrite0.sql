create or replace view aggView3879723553214963320 as select id as v18 from company_type as ct where kind<> 'production companies';
create or replace view aggJoin5888513489829506256 as select movie_id as v24, company_id as v17 from movie_companies as mc, aggView3879723553214963320 where mc.company_type_id=aggView3879723553214963320.v18;
create or replace view aggView8249844299118244525 as select id as v13 from link_type as lt;
create or replace view aggJoin2432633485294168169 as select movie_id as v24 from movie_link as ml, aggView8249844299118244525 where ml.link_type_id=aggView8249844299118244525.v13;
create or replace view aggView151151534631648826 as select v24, COUNT(*) as annot from aggJoin2432633485294168169 group by v24;
create or replace view aggJoin8798427221913314735 as select movie_id as v24, keyword_id as v22, annot from movie_keyword as mk, aggView151151534631648826 where mk.movie_id=aggView151151534631648826.v24;
create or replace view aggView1558327361341648596 as select id as v22 from keyword as k where keyword IN ('sequel','revenge','based-on-novel');
create or replace view aggJoin761889797887790909 as select v24, annot from aggJoin8798427221913314735 join aggView1558327361341648596 using(v22);
create or replace view aggView4806296005793136586 as select v24, SUM(annot) as annot from aggJoin761889797887790909 group by v24;
create or replace view aggJoin7248427345982592383 as select id as v24, production_year as v31, annot from title as t, aggView4806296005793136586 where t.id=aggView4806296005793136586.v24 and production_year>1950;
create or replace view aggView8665753943791342080 as select v24, SUM(annot) as annot from aggJoin7248427345982592383 group by v24;
create or replace view aggJoin4691840877033547705 as select v17, annot from aggJoin5888513489829506256 join aggView8665753943791342080 using(v24);
create or replace view aggView4384135169628259709 as select v17, SUM(annot) as annot from aggJoin4691840877033547705 group by v17;
create or replace view aggJoin3494239620553007792 as select name as v2, country_code as v3, annot from company_name as cn, aggView4384135169628259709 where cn.id=aggView4384135169628259709.v17 and country_code<> '[pl]' and ((name LIKE '20th Century Fox%') OR (name LIKE 'Twentieth Century Fox%'));
select SUM(annot) as v39 from aggJoin3494239620553007792;
