create or replace view aggView3397249972502528499 as select id as v19 from keyword as k where keyword IN ('murder','violence','blood','gore','death','female-nudity','hospital');
create or replace view aggJoin55810414120130993 as select movie_id as v49 from movie_keyword as mk, aggView3397249972502528499 where mk.keyword_id=aggView3397249972502528499.v19;
create or replace view aggView8711035584600120881 as select id as v15 from info_type as it1 where info= 'genres';
create or replace view aggJoin1091177854911332751 as select movie_id as v49, info as v30 from movie_info as mi, aggView8711035584600120881 where mi.info_type_id=aggView8711035584600120881.v15 and info IN ('Horror','Thriller');
create or replace view aggView1886681128269306636 as select id as v17 from info_type as it2 where info= 'votes';
create or replace view aggJoin2932291641110135439 as select movie_id as v49 from movie_info_idx as mi_idx, aggView1886681128269306636 where mi_idx.info_type_id=aggView1886681128269306636.v17;
create or replace view aggView1825104636039485569 as select id as v8 from company_name as cn where name LIKE 'Lionsgate%';
create or replace view aggJoin5325167960349051911 as select movie_id as v49, note as v26 from movie_companies as mc, aggView1825104636039485569 where mc.company_id=aggView1825104636039485569.v8 and note LIKE '%(Blu-ray)%';
create or replace view aggView593879570511346236 as select v49, COUNT(*) as annot from aggJoin1091177854911332751 group by v49;
create or replace view aggJoin8768753534427311904 as select v49, annot from aggJoin55810414120130993 join aggView593879570511346236 using(v49);
create or replace view aggView7415124440384555874 as select v49, SUM(annot) as annot from aggJoin8768753534427311904 group by v49;
create or replace view aggJoin4298226750768663777 as select id as v49, title as v50, production_year as v53, annot from title as t, aggView7415124440384555874 where t.id=aggView7415124440384555874.v49 and production_year>2000 and ((title LIKE 'Saw%') OR (title LIKE '%Jason%'));
create or replace view aggView6455265594871219642 as select v49, SUM(annot) as annot from aggJoin4298226750768663777 group by v49;
create or replace view aggJoin7750162636627939045 as select v49, annot from aggJoin2932291641110135439 join aggView6455265594871219642 using(v49);
create or replace view aggView1247475902119282869 as select v49, SUM(annot) as annot from aggJoin7750162636627939045 group by v49;
create or replace view aggJoin5346448889811322194 as select v49, v26, annot from aggJoin5325167960349051911 join aggView1247475902119282869 using(v49);
create or replace view aggView6052818599373978228 as select v49, SUM(annot) as annot from aggJoin5346448889811322194 group by v49;
create or replace view aggJoin3674320198654521083 as select person_id as v40, note as v5, annot from cast_info as ci, aggView6052818599373978228 where ci.movie_id=aggView6052818599373978228.v49 and note IN ('(writer)','(head writer)','(written by)','(story)','(story editor)');
create or replace view aggView9150790738233613000 as select v40, SUM(annot) as annot from aggJoin3674320198654521083 group by v40;
create or replace view aggJoin1513932922821688457 as select annot from name as n, aggView9150790738233613000 where n.id=aggView9150790738233613000.v40 and gender= 'm';
select SUM(annot) as v61 from aggJoin1513932922821688457;
