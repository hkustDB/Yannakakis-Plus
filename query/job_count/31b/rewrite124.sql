create or replace view aggView254826305665062741 as select id as v19 from keyword as k where keyword IN ('murder','violence','blood','gore','death','female-nudity','hospital');
create or replace view aggJoin3112801072313453165 as select movie_id as v49 from movie_keyword as mk, aggView254826305665062741 where mk.keyword_id=aggView254826305665062741.v19;
create or replace view aggView3924224911204758317 as select id as v15 from info_type as it1 where info= 'genres';
create or replace view aggJoin1050408281408840266 as select movie_id as v49, info as v30 from movie_info as mi, aggView3924224911204758317 where mi.info_type_id=aggView3924224911204758317.v15 and info IN ('Horror','Thriller');
create or replace view aggView5606583519714773644 as select v49, COUNT(*) as annot from aggJoin1050408281408840266 group by v49;
create or replace view aggJoin5000830245952711827 as select movie_id as v49, company_id as v8, note as v26, annot from movie_companies as mc, aggView5606583519714773644 where mc.movie_id=aggView5606583519714773644.v49 and note LIKE '%(Blu-ray)%';
create or replace view aggView683371690920371786 as select id as v8 from company_name as cn where name LIKE 'Lionsgate%';
create or replace view aggJoin3605940261502822780 as select v49, v26, annot from aggJoin5000830245952711827 join aggView683371690920371786 using(v8);
create or replace view aggView3992351947645901610 as select id as v17 from info_type as it2 where info= 'votes';
create or replace view aggJoin2117268239533740430 as select movie_id as v49 from movie_info_idx as mi_idx, aggView3992351947645901610 where mi_idx.info_type_id=aggView3992351947645901610.v17;
create or replace view aggView6997220673443768375 as select v49, SUM(annot) as annot from aggJoin3605940261502822780 group by v49;
create or replace view aggJoin1902489226187345560 as select v49, annot from aggJoin3112801072313453165 join aggView6997220673443768375 using(v49);
create or replace view aggView2410010696512088786 as select v49, SUM(annot) as annot from aggJoin1902489226187345560 group by v49;
create or replace view aggJoin4291791907237655114 as select v49, annot from aggJoin2117268239533740430 join aggView2410010696512088786 using(v49);
create or replace view aggView7124571479823023061 as select v49, SUM(annot) as annot from aggJoin4291791907237655114 group by v49;
create or replace view aggJoin2680898963459977891 as select id as v49, title as v50, production_year as v53, annot from title as t, aggView7124571479823023061 where t.id=aggView7124571479823023061.v49 and production_year>2000 and ((title LIKE 'Saw%') OR (title LIKE '%Jason%'));
create or replace view aggView6285696358807334766 as select v49, SUM(annot) as annot from aggJoin2680898963459977891 group by v49;
create or replace view aggJoin53218203087419814 as select person_id as v40, note as v5, annot from cast_info as ci, aggView6285696358807334766 where ci.movie_id=aggView6285696358807334766.v49 and note IN ('(writer)','(head writer)','(written by)','(story)','(story editor)');
create or replace view aggView1604657790694430442 as select v40, SUM(annot) as annot from aggJoin53218203087419814 group by v40;
create or replace view aggJoin1265422459035835728 as select annot from name as n, aggView1604657790694430442 where n.id=aggView1604657790694430442.v40 and gender= 'm';
select SUM(annot) as v61 from aggJoin1265422459035835728;
