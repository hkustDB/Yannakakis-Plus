create or replace view aggView7328124750720145 as select id as v9 from company_name as cn where country_code<> '[us]';
create or replace view aggJoin5458659321217011043 as select movie_id as v45, company_type_id as v16, note as v31 from movie_companies as mc, aggView7328124750720145 where mc.company_id=aggView7328124750720145.v9 and note NOT LIKE '%(USA)%' and note LIKE '%(200%)%';
create or replace view aggView2463678311649974115 as select id as v18 from info_type as it1 where info= 'countries';
create or replace view aggJoin6220178432520825743 as select movie_id as v45, info as v35 from movie_info as mi, aggView2463678311649974115 where mi.info_type_id=aggView2463678311649974115.v18 and info IN ('Sweden','Norway','Germany','Denmark','Swedish','Danish','Norwegian','German','USA','American');
create or replace view aggView8722678873344254807 as select id as v7 from comp_cast_type as cct2 where kind= 'complete';
create or replace view aggJoin1555014536685388061 as select movie_id as v45, subject_id as v5 from complete_cast as cc, aggView8722678873344254807 where cc.status_id=aggView8722678873344254807.v7;
create or replace view aggView8694179495716861263 as select id as v5 from comp_cast_type as cct1 where kind= 'cast';
create or replace view aggJoin7239892717642737726 as select v45 from aggJoin1555014536685388061 join aggView8694179495716861263 using(v5);
create or replace view aggView5253230102451228599 as select v45, COUNT(*) as annot from aggJoin7239892717642737726 group by v45;
create or replace view aggJoin643955679832854009 as select id as v45, kind_id as v25, production_year as v49, annot from title as t, aggView5253230102451228599 where t.id=aggView5253230102451228599.v45 and production_year>2005;
create or replace view aggView8307318715212176061 as select id as v16 from company_type as ct;
create or replace view aggJoin8266986135527219695 as select v45, v31 from aggJoin5458659321217011043 join aggView8307318715212176061 using(v16);
create or replace view aggView2956223516680318046 as select id as v25 from kind_type as kt where kind IN ('movie','episode');
create or replace view aggJoin6533864902058927343 as select v45, v49, annot from aggJoin643955679832854009 join aggView2956223516680318046 using(v25);
create or replace view aggView5772126180065174062 as select v45, SUM(annot) as annot from aggJoin6533864902058927343 group by v45;
create or replace view aggJoin7774230192713900774 as select v45, v31, annot from aggJoin8266986135527219695 join aggView5772126180065174062 using(v45);
create or replace view aggView8208048897444429120 as select v45, SUM(annot) as annot from aggJoin7774230192713900774 group by v45;
create or replace view aggJoin881746038833043948 as select v45, v35, annot from aggJoin6220178432520825743 join aggView8208048897444429120 using(v45);
create or replace view aggView4685112468369998941 as select v45, SUM(annot) as annot from aggJoin881746038833043948 group by v45;
create or replace view aggJoin4896342302722795185 as select movie_id as v45, info_type_id as v20, info as v40, annot from movie_info_idx as mi_idx, aggView4685112468369998941 where mi_idx.movie_id=aggView4685112468369998941.v45 and info<'8.5';
create or replace view aggView6897458022816264392 as select id as v20 from info_type as it2 where info= 'rating';
create or replace view aggJoin1339539636839659663 as select v45, v40, annot from aggJoin4896342302722795185 join aggView6897458022816264392 using(v20);
create or replace view aggView7773120778403143996 as select v45, SUM(annot) as annot from aggJoin1339539636839659663 group by v45;
create or replace view aggJoin3813099966618204146 as select keyword_id as v22, annot from movie_keyword as mk, aggView7773120778403143996 where mk.movie_id=aggView7773120778403143996.v45;
create or replace view aggView8027659774900080848 as select v22, SUM(annot) as annot from aggJoin3813099966618204146 group by v22;
create or replace view aggJoin8387167102430471791 as select annot from keyword as k, aggView8027659774900080848 where k.id=aggView8027659774900080848.v22 and keyword IN ('murder','murder-in-title','blood','violence');
select SUM(annot) as v57 from aggJoin8387167102430471791;
