create or replace view aggView4046992555058921951 as select id as v9 from company_name as cn where country_code<> '[us]';
create or replace view aggJoin8155572267095632675 as select movie_id as v45, company_type_id as v16, note as v31 from movie_companies as mc, aggView4046992555058921951 where mc.company_id=aggView4046992555058921951.v9 and note NOT LIKE '%(USA)%' and note LIKE '%(200%)%';
create or replace view aggView4843944936779813804 as select id as v18 from info_type as it1 where info= 'countries';
create or replace view aggJoin8586420925762258730 as select movie_id as v45, info as v35 from movie_info as mi, aggView4843944936779813804 where mi.info_type_id=aggView4843944936779813804.v18 and info IN ('Sweden','Norway','Germany','Denmark','Swedish','Danish','Norwegian','German','USA','American');
create or replace view aggView3818720570532044875 as select id as v7 from comp_cast_type as cct2 where kind= 'complete';
create or replace view aggJoin5530730912698843242 as select movie_id as v45, subject_id as v5 from complete_cast as cc, aggView3818720570532044875 where cc.status_id=aggView3818720570532044875.v7;
create or replace view aggView1481522338789187966 as select id as v5 from comp_cast_type as cct1 where kind= 'cast';
create or replace view aggJoin8516797705689705548 as select v45 from aggJoin5530730912698843242 join aggView1481522338789187966 using(v5);
create or replace view aggView3440816325285213220 as select id as v16 from company_type as ct;
create or replace view aggJoin7720194534127160850 as select v45, v31 from aggJoin8155572267095632675 join aggView3440816325285213220 using(v16);
create or replace view aggView4289492617903073669 as select id as v20 from info_type as it2 where info= 'rating';
create or replace view aggJoin2695868441900714351 as select movie_id as v45, info as v40 from movie_info_idx as mi_idx, aggView4289492617903073669 where mi_idx.info_type_id=aggView4289492617903073669.v20 and info<'8.5';
create or replace view aggView6098994630502179995 as select v45, COUNT(*) as annot from aggJoin2695868441900714351 group by v45;
create or replace view aggJoin9038987902952867947 as select v45, v35, annot from aggJoin8586420925762258730 join aggView6098994630502179995 using(v45);
create or replace view aggView3752398042326556121 as select v45, SUM(annot) as annot from aggJoin9038987902952867947 group by v45;
create or replace view aggJoin8848779022320364452 as select v45, v31, annot from aggJoin7720194534127160850 join aggView3752398042326556121 using(v45);
create or replace view aggView2348280531486384388 as select v45, SUM(annot) as annot from aggJoin8848779022320364452 group by v45;
create or replace view aggJoin1954697058711540173 as select v45, annot from aggJoin8516797705689705548 join aggView2348280531486384388 using(v45);
create or replace view aggView3083175502339330312 as select v45, SUM(annot) as annot from aggJoin1954697058711540173 group by v45;
create or replace view aggJoin3716977889199229254 as select id as v45, kind_id as v25, production_year as v49, annot from title as t, aggView3083175502339330312 where t.id=aggView3083175502339330312.v45 and production_year>2005;
create or replace view aggView3304478648782703436 as select id as v25 from kind_type as kt where kind IN ('movie','episode');
create or replace view aggJoin8061657735017418820 as select v45, v49, annot from aggJoin3716977889199229254 join aggView3304478648782703436 using(v25);
create or replace view aggView2026135669361677244 as select v45, SUM(annot) as annot from aggJoin8061657735017418820 group by v45;
create or replace view aggJoin8802443931833376103 as select keyword_id as v22, annot from movie_keyword as mk, aggView2026135669361677244 where mk.movie_id=aggView2026135669361677244.v45;
create or replace view aggView7166569044306919464 as select v22, SUM(annot) as annot from aggJoin8802443931833376103 group by v22;
create or replace view aggJoin279228360118628613 as select annot from keyword as k, aggView7166569044306919464 where k.id=aggView7166569044306919464.v22 and keyword IN ('murder','murder-in-title','blood','violence');
select SUM(annot) as v57 from aggJoin279228360118628613;
