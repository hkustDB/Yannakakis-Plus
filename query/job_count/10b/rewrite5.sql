create or replace view aggView269595092747067258 as select id as v22 from company_type as ct;
create or replace view aggJoin4013642852199615844 as select movie_id as v31, company_id as v15 from movie_companies as mc, aggView269595092747067258 where mc.company_type_id=aggView269595092747067258.v22;
create or replace view aggView578638327851614115 as select id as v29 from role_type as rt where role= 'actor';
create or replace view aggJoin5534914636151148048 as select movie_id as v31, person_role_id as v1, note as v12 from cast_info as ci, aggView578638327851614115 where ci.role_id=aggView578638327851614115.v29 and note LIKE '%(producer)%';
create or replace view aggView1732814946257949132 as select id as v15 from company_name as cn where country_code= '[ru]';
create or replace view aggJoin3608839647048294958 as select v31 from aggJoin4013642852199615844 join aggView1732814946257949132 using(v15);
create or replace view aggView1136847756219687261 as select v31, COUNT(*) as annot from aggJoin3608839647048294958 group by v31;
create or replace view aggJoin8432653474372802717 as select id as v31, production_year as v35, annot from title as t, aggView1136847756219687261 where t.id=aggView1136847756219687261.v31 and production_year>2010;
create or replace view aggView500999128148502029 as select v31, SUM(annot) as annot from aggJoin8432653474372802717 group by v31;
create or replace view aggJoin5573864021445145256 as select v1, v12, annot from aggJoin5534914636151148048 join aggView500999128148502029 using(v31);
create or replace view aggView3772472365715793918 as select v1, SUM(annot) as annot from aggJoin5573864021445145256 group by v1;
create or replace view aggJoin8655590875099774705 as select annot from char_name as chn, aggView3772472365715793918 where chn.id=aggView3772472365715793918.v1;
select SUM(annot) as v43 from aggJoin8655590875099774705;
