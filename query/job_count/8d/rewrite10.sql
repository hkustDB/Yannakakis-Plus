create or replace view aggView6266782474152657357 as select id as v15 from role_type as rt where role= 'costume designer';
create or replace view aggJoin8399554361084922960 as select person_id as v2, movie_id as v11 from cast_info as ci, aggView6266782474152657357 where ci.role_id=aggView6266782474152657357.v15;
create or replace view aggView6251638950927281369 as select person_id as v2, COUNT(*) as annot from aka_name as an1 group by person_id;
create or replace view aggJoin4734448865035301389 as select id as v2, annot from name as n1, aggView6251638950927281369 where n1.id=aggView6251638950927281369.v2;
create or replace view aggView7274263844758591899 as select v2, SUM(annot) as annot from aggJoin4734448865035301389 group by v2;
create or replace view aggJoin8469944543387866918 as select v11, annot from aggJoin8399554361084922960 join aggView7274263844758591899 using(v2);
create or replace view aggView9154663303707777553 as select v11, SUM(annot) as annot from aggJoin8469944543387866918 group by v11;
create or replace view aggJoin6424392206683289607 as select id as v11, annot from title as t, aggView9154663303707777553 where t.id=aggView9154663303707777553.v11;
create or replace view aggView2120346508373886437 as select v11, SUM(annot) as annot from aggJoin6424392206683289607 group by v11;
create or replace view aggJoin7362634616707079814 as select company_id as v25, annot from movie_companies as mc, aggView2120346508373886437 where mc.movie_id=aggView2120346508373886437.v11;
create or replace view aggView485371853183998282 as select v25, SUM(annot) as annot from aggJoin7362634616707079814 group by v25;
create or replace view aggJoin2993489287631418914 as select country_code as v18, annot from company_name as cn, aggView485371853183998282 where cn.id=aggView485371853183998282.v25 and country_code= '[us]';
select SUM(annot) as v51 from aggJoin2993489287631418914;
