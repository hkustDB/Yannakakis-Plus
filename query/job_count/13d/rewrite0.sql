create or replace view aggView1142943115591738119 as select id as v8 from company_type as ct where kind= 'production companies';
create or replace view aggJoin7516892553639296641 as select movie_id as v22, company_id as v1 from movie_companies as mc, aggView1142943115591738119 where mc.company_type_id=aggView1142943115591738119.v8;
create or replace view aggView4272345947304585520 as select id as v14 from kind_type as kt where kind= 'movie';
create or replace view aggJoin6976461815836685150 as select id as v22 from title as t, aggView4272345947304585520 where t.kind_id=aggView4272345947304585520.v14;
create or replace view aggView8325441417031735729 as select id as v1 from company_name as cn where country_code= '[us]';
create or replace view aggJoin4817120434730205409 as select v22 from aggJoin7516892553639296641 join aggView8325441417031735729 using(v1);
create or replace view aggView2019914221872455181 as select v22, COUNT(*) as annot from aggJoin4817120434730205409 group by v22;
create or replace view aggJoin4746024276859172711 as select movie_id as v22, info_type_id as v10, annot from movie_info_idx as mi_idx, aggView2019914221872455181 where mi_idx.movie_id=aggView2019914221872455181.v22;
create or replace view aggView8461109083948453911 as select id as v10 from info_type as it where info= 'rating';
create or replace view aggJoin5508817438134655306 as select v22, annot from aggJoin4746024276859172711 join aggView8461109083948453911 using(v10);
create or replace view aggView4166910741744345919 as select v22, SUM(annot) as annot from aggJoin5508817438134655306 group by v22;
create or replace view aggJoin4553211167948245849 as select v22, annot from aggJoin6976461815836685150 join aggView4166910741744345919 using(v22);
create or replace view aggView9190251205555655781 as select v22, SUM(annot) as annot from aggJoin4553211167948245849 group by v22;
create or replace view aggJoin7908314886162242523 as select info_type_id as v12, annot from movie_info as mi, aggView9190251205555655781 where mi.movie_id=aggView9190251205555655781.v22;
create or replace view aggView6125791663439918909 as select id as v12 from info_type as it2 where info= 'release dates';
create or replace view aggJoin521394778246356195 as select annot from aggJoin7908314886162242523 join aggView6125791663439918909 using(v12);
select SUM(annot) as v43 from aggJoin521394778246356195;
