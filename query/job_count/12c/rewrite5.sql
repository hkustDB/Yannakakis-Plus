create or replace view aggView930404197949046412 as select id as v1 from company_name as cn where country_code= '[us]';
create or replace view aggJoin370830701179110672 as select movie_id as v29, company_type_id as v8 from movie_companies as mc, aggView930404197949046412 where mc.company_id=aggView930404197949046412.v1;
create or replace view aggView2149849423918115979 as select id as v21 from info_type as it1 where info= 'genres';
create or replace view aggJoin8261278592635468852 as select movie_id as v29, info as v22 from movie_info as mi, aggView2149849423918115979 where mi.info_type_id=aggView2149849423918115979.v21 and info IN ('Drama','Horror','Western','Family');
create or replace view aggView2459678209380202101 as select v29, COUNT(*) as annot from aggJoin8261278592635468852 group by v29;
create or replace view aggJoin1536774517502737782 as select movie_id as v29, info_type_id as v26, info as v27, annot from movie_info_idx as mi_idx, aggView2459678209380202101 where mi_idx.movie_id=aggView2459678209380202101.v29 and info>'7.0';
create or replace view aggView3131806735864424976 as select id as v26 from info_type as it2 where info= 'rating';
create or replace view aggJoin2953233009952645494 as select v29, v27, annot from aggJoin1536774517502737782 join aggView3131806735864424976 using(v26);
create or replace view aggView9200959570294681920 as select v29, SUM(annot) as annot from aggJoin2953233009952645494 group by v29;
create or replace view aggJoin8643787629670292842 as select id as v29, production_year as v33, annot from title as t, aggView9200959570294681920 where t.id=aggView9200959570294681920.v29 and production_year>=2000 and production_year<=2010;
create or replace view aggView9113185855210515756 as select v29, SUM(annot) as annot from aggJoin8643787629670292842 group by v29;
create or replace view aggJoin4983504454918340776 as select v8, annot from aggJoin370830701179110672 join aggView9113185855210515756 using(v29);
create or replace view aggView4834536772801117358 as select v8, SUM(annot) as annot from aggJoin4983504454918340776 group by v8;
create or replace view aggJoin8472114879462547925 as select kind as v9, annot from company_type as ct, aggView4834536772801117358 where ct.id=aggView4834536772801117358.v8 and kind= 'production companies';
select SUM(annot) as v41 from aggJoin8472114879462547925;
