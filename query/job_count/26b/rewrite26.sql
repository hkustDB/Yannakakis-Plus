create or replace view aggView3967827052656481020 as select id as v25 from keyword as k where keyword IN ('superhero','marvel-comics','based-on-comic','fight');
create or replace view aggJoin551032326484544155 as select movie_id as v47 from movie_keyword as mk, aggView3967827052656481020 where mk.keyword_id=aggView3967827052656481020.v25;
create or replace view aggView7078524134644678493 as select id as v9 from char_name as chn where ((name LIKE '%man%') OR (name LIKE '%Man%'));
create or replace view aggJoin5512301619442278625 as select person_id as v38, movie_id as v47 from cast_info as ci, aggView7078524134644678493 where ci.person_role_id=aggView7078524134644678493.v9;
create or replace view aggView2472965884977545765 as select id as v7 from comp_cast_type as cct2 where kind LIKE '%complete%';
create or replace view aggJoin3201684110216428035 as select movie_id as v47, subject_id as v5 from complete_cast as cc, aggView2472965884977545765 where cc.status_id=aggView2472965884977545765.v7;
create or replace view aggView6975421149498834849 as select id as v28 from kind_type as kt where kind= 'movie';
create or replace view aggJoin3919355535750583668 as select id as v47, production_year as v51 from title as t, aggView6975421149498834849 where t.kind_id=aggView6975421149498834849.v28 and production_year>2005;
create or replace view aggView1375677745935857842 as select v47, COUNT(*) as annot from aggJoin551032326484544155 group by v47;
create or replace view aggJoin887124863947767612 as select v47, v5, annot from aggJoin3201684110216428035 join aggView1375677745935857842 using(v47);
create or replace view aggView5716949786674718951 as select id as v5 from comp_cast_type as cct1 where kind= 'cast';
create or replace view aggJoin3232526841916023536 as select v47, annot from aggJoin887124863947767612 join aggView5716949786674718951 using(v5);
create or replace view aggView1531705378741785571 as select v47, SUM(annot) as annot from aggJoin3232526841916023536 group by v47;
create or replace view aggJoin94333200787014501 as select movie_id as v47, info_type_id as v23, info as v33, annot from movie_info_idx as mi_idx, aggView1531705378741785571 where mi_idx.movie_id=aggView1531705378741785571.v47 and info>'8.0';
create or replace view aggView4182558540457769444 as select id as v23 from info_type as it2 where info= 'rating';
create or replace view aggJoin2888539620957428161 as select v47, v33, annot from aggJoin94333200787014501 join aggView4182558540457769444 using(v23);
create or replace view aggView839901771043035963 as select v47, SUM(annot) as annot from aggJoin2888539620957428161 group by v47;
create or replace view aggJoin1712004005105895334 as select v47, v51, annot from aggJoin3919355535750583668 join aggView839901771043035963 using(v47);
create or replace view aggView6386864834372791460 as select v47, SUM(annot) as annot from aggJoin1712004005105895334 group by v47;
create or replace view aggJoin6206260942463471031 as select v38, annot from aggJoin5512301619442278625 join aggView6386864834372791460 using(v47);
create or replace view aggView6101779524702918154 as select v38, SUM(annot) as annot from aggJoin6206260942463471031 group by v38;
create or replace view aggJoin6696235176657241044 as select annot from name as n, aggView6101779524702918154 where n.id=aggView6101779524702918154.v38;
select SUM(annot) as v59 from aggJoin6696235176657241044;
