create or replace view aggView6941623270682356423 as select id as v5 from comp_cast_type as cct1 where kind= 'cast';
create or replace view aggJoin2173748324868055835 as select movie_id as v40, status_id as v7 from complete_cast as cc, aggView6941623270682356423 where cc.subject_id=aggView6941623270682356423.v5;
create or replace view aggView724680047094689254 as select id as v7 from comp_cast_type as cct2 where kind LIKE '%complete%';
create or replace view aggJoin4921648500817259739 as select v40 from aggJoin2173748324868055835 join aggView724680047094689254 using(v7);
create or replace view aggView4284351184828468571 as select v40, COUNT(*) as annot from aggJoin4921648500817259739 group by v40;
create or replace view aggJoin2655641113464761779 as select movie_id as v40, keyword_id as v23, annot from movie_keyword as mk, aggView4284351184828468571 where mk.movie_id=aggView4284351184828468571.v40;
create or replace view aggView7255467512969161241 as select id as v23 from keyword as k where keyword IN ('superhero','sequel','second-part','marvel-comics','based-on-comic','tv-special','fight','violence');
create or replace view aggJoin3844864479940952447 as select v40, annot from aggJoin2655641113464761779 join aggView7255467512969161241 using(v23);
create or replace view aggView8680738598365981863 as select v40, SUM(annot) as annot from aggJoin3844864479940952447 group by v40;
create or replace view aggJoin3279776437691502341 as select id as v40, kind_id as v26, production_year as v44, annot from title as t, aggView8680738598365981863 where t.id=aggView8680738598365981863.v40 and production_year>1950;
create or replace view aggView7518658360876611456 as select id as v9 from char_name as chn where ((name LIKE '%Tony%Stark%') OR (name LIKE '%Iron%Man%')) and name NOT LIKE '%Sherlock%';
create or replace view aggJoin4362291759797683154 as select person_id as v31, movie_id as v40 from cast_info as ci, aggView7518658360876611456 where ci.person_role_id=aggView7518658360876611456.v9;
create or replace view aggView5184255720671408189 as select id as v26 from kind_type as kt where kind= 'movie';
create or replace view aggJoin7736500893965543519 as select v40, v44, annot from aggJoin3279776437691502341 join aggView5184255720671408189 using(v26);
create or replace view aggView2860824043061341203 as select v40, SUM(annot) as annot from aggJoin7736500893965543519 group by v40;
create or replace view aggJoin3461141504768454759 as select v31, annot from aggJoin4362291759797683154 join aggView2860824043061341203 using(v40);
create or replace view aggView4016840711664394721 as select v31, SUM(annot) as annot from aggJoin3461141504768454759 group by v31;
create or replace view aggJoin2211072076031702278 as select annot from name as n, aggView4016840711664394721 where n.id=aggView4016840711664394721.v31;
select SUM(annot) as v52 from aggJoin2211072076031702278;
