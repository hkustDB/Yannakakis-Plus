create or replace view aggView1143816497197601391 as select id as v31 from name as n;
create or replace view aggJoin4939262294462737791 as select movie_id as v40, person_role_id as v9 from cast_info as ci, aggView1143816497197601391 where ci.person_id=aggView1143816497197601391.v31;
create or replace view aggView6673376050843090847 as select id as v5 from comp_cast_type as cct1 where kind= 'cast';
create or replace view aggJoin2011896524946230438 as select movie_id as v40, status_id as v7 from complete_cast as cc, aggView6673376050843090847 where cc.subject_id=aggView6673376050843090847.v5;
create or replace view aggView1919290924918551468 as select id as v7 from comp_cast_type as cct2 where kind LIKE '%complete%';
create or replace view aggJoin5362878932336962979 as select v40 from aggJoin2011896524946230438 join aggView1919290924918551468 using(v7);
create or replace view aggView504423257031898303 as select v40, COUNT(*) as annot from aggJoin5362878932336962979 group by v40;
create or replace view aggJoin8192058316603191012 as select movie_id as v40, keyword_id as v23, annot from movie_keyword as mk, aggView504423257031898303 where mk.movie_id=aggView504423257031898303.v40;
create or replace view aggView1903899425585780681 as select id as v23 from keyword as k where keyword IN ('superhero','sequel','second-part','marvel-comics','based-on-comic','tv-special','fight','violence');
create or replace view aggJoin7028018050636125057 as select v40, annot from aggJoin8192058316603191012 join aggView1903899425585780681 using(v23);
create or replace view aggView1321828165186387664 as select v40, SUM(annot) as annot from aggJoin7028018050636125057 group by v40;
create or replace view aggJoin8422929104687420781 as select id as v40, kind_id as v26, production_year as v44, annot from title as t, aggView1321828165186387664 where t.id=aggView1321828165186387664.v40 and production_year>1950;
create or replace view aggView2250248670975907399 as select id as v9 from char_name as chn where ((name LIKE '%Tony%Stark%') OR (name LIKE '%Iron%Man%')) and name NOT LIKE '%Sherlock%';
create or replace view aggJoin7544088394462154950 as select v40 from aggJoin4939262294462737791 join aggView2250248670975907399 using(v9);
create or replace view aggView6812824468235791843 as select id as v26 from kind_type as kt where kind= 'movie';
create or replace view aggJoin4642827929165502604 as select v40, v44, annot from aggJoin8422929104687420781 join aggView6812824468235791843 using(v26);
create or replace view aggView3203613144827686033 as select v40, SUM(annot) as annot from aggJoin4642827929165502604 group by v40;
create or replace view aggJoin1524107232119216787 as select annot from aggJoin7544088394462154950 join aggView3203613144827686033 using(v40);
select SUM(annot) as v52 from aggJoin1524107232119216787;
