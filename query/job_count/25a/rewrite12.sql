create or replace view aggView1552569686359465027 as select id as v8 from info_type as it1 where info= 'genres';
create or replace view aggJoin6973834188172275792 as select movie_id as v37, info as v18 from movie_info as mi, aggView1552569686359465027 where mi.info_type_id=aggView1552569686359465027.v8 and info= 'Horror';
create or replace view aggView685326165270180498 as select id as v12 from keyword as k where keyword IN ('murder','blood','gore','death','female-nudity');
create or replace view aggJoin6068145838970618783 as select movie_id as v37 from movie_keyword as mk, aggView685326165270180498 where mk.keyword_id=aggView685326165270180498.v12;
create or replace view aggView5403031924961016422 as select id as v10 from info_type as it2 where info= 'votes';
create or replace view aggJoin7473766877287653044 as select movie_id as v37 from movie_info_idx as mi_idx, aggView5403031924961016422 where mi_idx.info_type_id=aggView5403031924961016422.v10;
create or replace view aggView4078684551425596792 as select v37, COUNT(*) as annot from aggJoin7473766877287653044 group by v37;
create or replace view aggJoin3246786928922518687 as select v37, annot from aggJoin6068145838970618783 join aggView4078684551425596792 using(v37);
create or replace view aggView8477502498008324871 as select v37, SUM(annot) as annot from aggJoin3246786928922518687 group by v37;
create or replace view aggJoin4631752523892791448 as select v37, v18, annot from aggJoin6973834188172275792 join aggView8477502498008324871 using(v37);
create or replace view aggView6701324634363530424 as select v37, SUM(annot) as annot from aggJoin4631752523892791448 group by v37;
create or replace view aggJoin6973905218262671911 as select id as v37, annot from title as t, aggView6701324634363530424 where t.id=aggView6701324634363530424.v37;
create or replace view aggView6526670259962004403 as select v37, SUM(annot) as annot from aggJoin6973905218262671911 group by v37;
create or replace view aggJoin1346333068524641838 as select person_id as v28, note as v5, annot from cast_info as ci, aggView6526670259962004403 where ci.movie_id=aggView6526670259962004403.v37 and note IN ('(writer)','(head writer)','(written by)','(story)','(story editor)');
create or replace view aggView1559297539887682449 as select v28, SUM(annot) as annot from aggJoin1346333068524641838 group by v28;
create or replace view aggJoin122178884821496016 as select gender as v32, annot from name as n, aggView1559297539887682449 where n.id=aggView1559297539887682449.v28 and gender= 'm';
select SUM(annot) as v49 from aggJoin122178884821496016;
