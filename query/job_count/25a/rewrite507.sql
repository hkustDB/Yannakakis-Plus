create or replace view aggView3155089168815201515 as select id as v8 from info_type as it1 where info= 'genres';
create or replace view aggJoin669999113213172485 as select movie_id as v37, info as v18 from movie_info as mi, aggView3155089168815201515 where mi.info_type_id=aggView3155089168815201515.v8 and info= 'Horror';
create or replace view aggView4156318648315583689 as select v37, COUNT(*) as annot from aggJoin669999113213172485 group by v37;
create or replace view aggJoin5614077072419304397 as select id as v37, annot from title as t, aggView4156318648315583689 where t.id=aggView4156318648315583689.v37;
create or replace view aggView1510273508028150502 as select id as v12 from keyword as k where keyword IN ('murder','blood','gore','death','female-nudity');
create or replace view aggJoin3004045817524658333 as select movie_id as v37 from movie_keyword as mk, aggView1510273508028150502 where mk.keyword_id=aggView1510273508028150502.v12;
create or replace view aggView5352369964417785332 as select id as v28 from name as n where gender= 'm';
create or replace view aggJoin333942437641719702 as select movie_id as v37, note as v5 from cast_info as ci, aggView5352369964417785332 where ci.person_id=aggView5352369964417785332.v28 and note IN ('(writer)','(head writer)','(written by)','(story)','(story editor)');
create or replace view aggView8843355610831897234 as select v37, SUM(annot) as annot from aggJoin5614077072419304397 group by v37;
create or replace view aggJoin3960680186998400933 as select v37, v5, annot from aggJoin333942437641719702 join aggView8843355610831897234 using(v37);
create or replace view aggView3049654882670915738 as select v37, SUM(annot) as annot from aggJoin3960680186998400933 group by v37;
create or replace view aggJoin8476293485487233483 as select movie_id as v37, info_type_id as v10, annot from movie_info_idx as mi_idx, aggView3049654882670915738 where mi_idx.movie_id=aggView3049654882670915738.v37;
create or replace view aggView4798700097968296713 as select id as v10 from info_type as it2 where info= 'votes';
create or replace view aggJoin7773564685837216491 as select v37, annot from aggJoin8476293485487233483 join aggView4798700097968296713 using(v10);
create or replace view aggView2766185511276085992 as select v37, SUM(annot) as annot from aggJoin7773564685837216491 group by v37;
create or replace view aggJoin4900592789153694209 as select annot from aggJoin3004045817524658333 join aggView2766185511276085992 using(v37);
select SUM(annot) as v49 from aggJoin4900592789153694209;
