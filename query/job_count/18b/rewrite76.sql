create or replace view aggView3748238682624900751 as select id as v10 from info_type as it2 where info= 'rating';
create or replace view aggJoin4486190438750240950 as select movie_id as v31, info as v20 from movie_info_idx as mi_idx, aggView3748238682624900751 where mi_idx.info_type_id=aggView3748238682624900751.v10 and info>'8.0';
create or replace view aggView1577986690585477196 as select id as v8 from info_type as it1 where info= 'genres';
create or replace view aggJoin924330551203653697 as select movie_id as v31, info as v15 from movie_info as mi, aggView1577986690585477196 where mi.info_type_id=aggView1577986690585477196.v8 and info IN ('Horror','Thriller');
create or replace view aggView2433012121393842247 as select v31, COUNT(*) as annot from aggJoin924330551203653697 group by v31;
create or replace view aggJoin1274553410752195613 as select id as v31, production_year as v35, annot from title as t, aggView2433012121393842247 where t.id=aggView2433012121393842247.v31 and production_year>=2008 and production_year<=2014;
create or replace view aggView2109467253562728726 as select v31, SUM(annot) as annot from aggJoin1274553410752195613 group by v31;
create or replace view aggJoin6032861543283045586 as select v31, v20, annot from aggJoin4486190438750240950 join aggView2109467253562728726 using(v31);
create or replace view aggView6561587707465658164 as select v31, SUM(annot) as annot from aggJoin6032861543283045586 group by v31;
create or replace view aggJoin5230983901126998400 as select person_id as v22, note as v5, annot from cast_info as ci, aggView6561587707465658164 where ci.movie_id=aggView6561587707465658164.v31 and note IN ('(writer)','(head writer)','(written by)','(story)','(story editor)');
create or replace view aggView4591244100718741380 as select id as v22 from name as n where gender= 'f';
create or replace view aggJoin8442915235292208031 as select annot from aggJoin5230983901126998400 join aggView4591244100718741380 using(v22);
select SUM(annot) as v43 from aggJoin8442915235292208031;
