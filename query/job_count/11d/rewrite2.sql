create or replace view aggView185911398297805116 as select id as v17 from company_name as cn where country_code<> '[pl]';
create or replace view aggJoin4246358510641217913 as select movie_id as v24, company_type_id as v18 from movie_companies as mc, aggView185911398297805116 where mc.company_id=aggView185911398297805116.v17;
create or replace view aggView4305727628896865220 as select id as v18 from company_type as ct where kind<> 'production companies';
create or replace view aggJoin1708802317748249276 as select v24 from aggJoin4246358510641217913 join aggView4305727628896865220 using(v18);
create or replace view aggView1176868121119944254 as select v24, COUNT(*) as annot from aggJoin1708802317748249276 group by v24;
create or replace view aggJoin3458638952018575904 as select movie_id as v24, link_type_id as v13, annot from movie_link as ml, aggView1176868121119944254 where ml.movie_id=aggView1176868121119944254.v24;
create or replace view aggView3233612327967013946 as select id as v13 from link_type as lt;
create or replace view aggJoin9011541161162605064 as select v24, annot from aggJoin3458638952018575904 join aggView3233612327967013946 using(v13);
create or replace view aggView7463065856286737602 as select v24, SUM(annot) as annot from aggJoin9011541161162605064 group by v24;
create or replace view aggJoin8538690004409202181 as select id as v24, production_year as v31, annot from title as t, aggView7463065856286737602 where t.id=aggView7463065856286737602.v24 and production_year>1950;
create or replace view aggView8061089419950132342 as select v24, SUM(annot) as annot from aggJoin8538690004409202181 group by v24;
create or replace view aggJoin8191308724349638224 as select keyword_id as v22, annot from movie_keyword as mk, aggView8061089419950132342 where mk.movie_id=aggView8061089419950132342.v24;
create or replace view aggView682541514646270405 as select v22, SUM(annot) as annot from aggJoin8191308724349638224 group by v22;
create or replace view aggJoin5558213930722339795 as select keyword as v11, annot from keyword as k, aggView682541514646270405 where k.id=aggView682541514646270405.v22 and keyword IN ('sequel','revenge','based-on-novel');
select SUM(annot) as v39 from aggJoin5558213930722339795;
