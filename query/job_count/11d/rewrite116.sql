create or replace view aggView1736284201535749591 as select id as v22 from keyword as k where keyword IN ('sequel','revenge','based-on-novel');
create or replace view aggJoin3481222648991410502 as select movie_id as v24 from movie_keyword as mk, aggView1736284201535749591 where mk.keyword_id=aggView1736284201535749591.v22;
create or replace view aggView1900094159171654918 as select id as v17 from company_name as cn where country_code<> '[pl]';
create or replace view aggJoin149018397554152569 as select movie_id as v24, company_type_id as v18 from movie_companies as mc, aggView1900094159171654918 where mc.company_id=aggView1900094159171654918.v17;
create or replace view aggView4501407636091899366 as select id as v18 from company_type as ct where kind<> 'production companies';
create or replace view aggJoin2345883548669033027 as select v24 from aggJoin149018397554152569 join aggView4501407636091899366 using(v18);
create or replace view aggView6499360547631521091 as select id as v13 from link_type as lt;
create or replace view aggJoin213881336083981400 as select movie_id as v24 from movie_link as ml, aggView6499360547631521091 where ml.link_type_id=aggView6499360547631521091.v13;
create or replace view aggView2639744588335641902 as select v24, COUNT(*) as annot from aggJoin213881336083981400 group by v24;
create or replace view aggJoin814774709687107475 as select id as v24, production_year as v31, annot from title as t, aggView2639744588335641902 where t.id=aggView2639744588335641902.v24 and production_year>1950;
create or replace view aggView5415254676338912494 as select v24, SUM(annot) as annot from aggJoin814774709687107475 group by v24;
create or replace view aggJoin7599865808035459707 as select v24, annot from aggJoin2345883548669033027 join aggView5415254676338912494 using(v24);
create or replace view aggView1819458246640018451 as select v24, SUM(annot) as annot from aggJoin7599865808035459707 group by v24;
create or replace view aggJoin8728174668185254200 as select annot from aggJoin3481222648991410502 join aggView1819458246640018451 using(v24);
select SUM(annot) as v39 from aggJoin8728174668185254200;
