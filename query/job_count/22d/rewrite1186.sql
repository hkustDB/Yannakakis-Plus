create or replace view aggView988800310704636322 as select id as v10 from info_type as it1 where info= 'countries';
create or replace view aggJoin8704667416963228489 as select movie_id as v37, info as v27 from movie_info as mi, aggView988800310704636322 where mi.info_type_id=aggView988800310704636322.v10 and info IN ('Sweden','Norway','Germany','Denmark','Swedish','Danish','Norwegian','German','USA','American');
create or replace view aggView7111754988026782388 as select id as v14 from keyword as k where keyword IN ('murder','murder-in-title','blood','violence');
create or replace view aggJoin8124810209944338610 as select movie_id as v37 from movie_keyword as mk, aggView7111754988026782388 where mk.keyword_id=aggView7111754988026782388.v14;
create or replace view aggView8528264757905591453 as select id as v8 from company_type as ct;
create or replace view aggJoin4451062042147913533 as select movie_id as v37, company_id as v1 from movie_companies as mc, aggView8528264757905591453 where mc.company_type_id=aggView8528264757905591453.v8;
create or replace view aggView8243600418448536125 as select id as v1 from company_name as cn where country_code<> '[us]';
create or replace view aggJoin1072376138997718688 as select v37 from aggJoin4451062042147913533 join aggView8243600418448536125 using(v1);
create or replace view aggView8314086634413125429 as select id as v17 from kind_type as kt where kind IN ('movie','episode');
create or replace view aggJoin1099011847733756204 as select id as v37, production_year as v41 from title as t, aggView8314086634413125429 where t.kind_id=aggView8314086634413125429.v17 and production_year>2005;
create or replace view aggView104635455024748185 as select v37, COUNT(*) as annot from aggJoin1099011847733756204 group by v37;
create or replace view aggJoin890895828616249367 as select movie_id as v37, info_type_id as v12, info as v32, annot from movie_info_idx as mi_idx, aggView104635455024748185 where mi_idx.movie_id=aggView104635455024748185.v37 and info<'8.5';
create or replace view aggView4403037587277206560 as select id as v12 from info_type as it2 where info= 'rating';
create or replace view aggJoin6281959112653101385 as select v37, v32, annot from aggJoin890895828616249367 join aggView4403037587277206560 using(v12);
create or replace view aggView1410836667007439899 as select v37, SUM(annot) as annot from aggJoin6281959112653101385 group by v37;
create or replace view aggJoin9049192598455451517 as select v37, v27, annot from aggJoin8704667416963228489 join aggView1410836667007439899 using(v37);
create or replace view aggView8119939899750518462 as select v37, SUM(annot) as annot from aggJoin9049192598455451517 group by v37;
create or replace view aggJoin1774321407999210627 as select v37, annot from aggJoin1072376138997718688 join aggView8119939899750518462 using(v37);
create or replace view aggView2092272164241180966 as select v37, SUM(annot) as annot from aggJoin1774321407999210627 group by v37;
create or replace view aggJoin4228798302959304263 as select annot from aggJoin8124810209944338610 join aggView2092272164241180966 using(v37);
select SUM(annot) as v49 from aggJoin4228798302959304263;
