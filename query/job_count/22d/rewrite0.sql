create or replace view aggView4695035607298459497 as select id as v10 from info_type as it1 where info= 'countries';
create or replace view aggJoin790609737492478699 as select movie_id as v37, info as v27 from movie_info as mi, aggView4695035607298459497 where mi.info_type_id=aggView4695035607298459497.v10 and info IN ('Sweden','Norway','Germany','Denmark','Swedish','Danish','Norwegian','German','USA','American');
create or replace view aggView5264289636381669570 as select id as v14 from keyword as k where keyword IN ('murder','murder-in-title','blood','violence');
create or replace view aggJoin2631819863929592026 as select movie_id as v37 from movie_keyword as mk, aggView5264289636381669570 where mk.keyword_id=aggView5264289636381669570.v14;
create or replace view aggView6132792121099730490 as select id as v1 from company_name as cn where country_code<> '[us]';
create or replace view aggJoin931355565895951756 as select movie_id as v37, company_type_id as v8 from movie_companies as mc, aggView6132792121099730490 where mc.company_id=aggView6132792121099730490.v1;
create or replace view aggView3608496359721041118 as select id as v12 from info_type as it2 where info= 'rating';
create or replace view aggJoin7507001690240877302 as select movie_id as v37, info as v32 from movie_info_idx as mi_idx, aggView3608496359721041118 where mi_idx.info_type_id=aggView3608496359721041118.v12 and info<'8.5';
create or replace view aggView1828295544379734829 as select v37, COUNT(*) as annot from aggJoin7507001690240877302 group by v37;
create or replace view aggJoin4837622160684269048 as select v37, annot from aggJoin2631819863929592026 join aggView1828295544379734829 using(v37);
create or replace view aggView2199713044146874585 as select v37, SUM(annot) as annot from aggJoin4837622160684269048 group by v37;
create or replace view aggJoin3751233043361529892 as select v37, v27, annot from aggJoin790609737492478699 join aggView2199713044146874585 using(v37);
create or replace view aggView4585247665160905357 as select v37, SUM(annot) as annot from aggJoin3751233043361529892 group by v37;
create or replace view aggJoin3107646000976517236 as select id as v37, kind_id as v17, production_year as v41, annot from title as t, aggView4585247665160905357 where t.id=aggView4585247665160905357.v37 and production_year>2005;
create or replace view aggView1465969270938911502 as select id as v17 from kind_type as kt where kind IN ('movie','episode');
create or replace view aggJoin5871453625331256597 as select v37, v41, annot from aggJoin3107646000976517236 join aggView1465969270938911502 using(v17);
create or replace view aggView4776676053355812971 as select v37, SUM(annot) as annot from aggJoin5871453625331256597 group by v37;
create or replace view aggJoin4917358037040892888 as select v8, annot from aggJoin931355565895951756 join aggView4776676053355812971 using(v37);
create or replace view aggView4895107607319591851 as select v8, SUM(annot) as annot from aggJoin4917358037040892888 group by v8;
create or replace view aggJoin1421084057052950200 as select annot from company_type as ct, aggView4895107607319591851 where ct.id=aggView4895107607319591851.v8;
select SUM(annot) as v49 from aggJoin1421084057052950200;
