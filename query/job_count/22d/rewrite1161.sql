create or replace view aggView3779196679738173479 as select id as v10 from info_type as it1 where info= 'countries';
create or replace view aggJoin5633018635475478868 as select movie_id as v37, info as v27 from movie_info as mi, aggView3779196679738173479 where mi.info_type_id=aggView3779196679738173479.v10 and info IN ('Sweden','Norway','Germany','Denmark','Swedish','Danish','Norwegian','German','USA','American');
create or replace view aggView371767528626623135 as select id as v14 from keyword as k where keyword IN ('murder','murder-in-title','blood','violence');
create or replace view aggJoin4576745051449122865 as select movie_id as v37 from movie_keyword as mk, aggView371767528626623135 where mk.keyword_id=aggView371767528626623135.v14;
create or replace view aggView1052358882812376284 as select id as v8 from company_type as ct;
create or replace view aggJoin8478216641388165286 as select movie_id as v37, company_id as v1 from movie_companies as mc, aggView1052358882812376284 where mc.company_type_id=aggView1052358882812376284.v8;
create or replace view aggView2563264980685603308 as select v37, COUNT(*) as annot from aggJoin5633018635475478868 group by v37;
create or replace view aggJoin5525704274803362896 as select movie_id as v37, info_type_id as v12, info as v32, annot from movie_info_idx as mi_idx, aggView2563264980685603308 where mi_idx.movie_id=aggView2563264980685603308.v37 and info<'8.5';
create or replace view aggView8345823892639206484 as select id as v1 from company_name as cn where country_code<> '[us]';
create or replace view aggJoin4834954826481962407 as select v37 from aggJoin8478216641388165286 join aggView8345823892639206484 using(v1);
create or replace view aggView6185309472361255690 as select id as v12 from info_type as it2 where info= 'rating';
create or replace view aggJoin642627957234274014 as select v37, v32, annot from aggJoin5525704274803362896 join aggView6185309472361255690 using(v12);
create or replace view aggView5239304201059789302 as select v37, SUM(annot) as annot from aggJoin642627957234274014 group by v37;
create or replace view aggJoin5042699800866018876 as select id as v37, kind_id as v17, production_year as v41, annot from title as t, aggView5239304201059789302 where t.id=aggView5239304201059789302.v37 and production_year>2005;
create or replace view aggView8898335587974389361 as select id as v17 from kind_type as kt where kind IN ('movie','episode');
create or replace view aggJoin3068195031207695165 as select v37, v41, annot from aggJoin5042699800866018876 join aggView8898335587974389361 using(v17);
create or replace view aggView6659347299111069770 as select v37, SUM(annot) as annot from aggJoin3068195031207695165 group by v37;
create or replace view aggJoin5266411673734602195 as select v37, annot from aggJoin4834954826481962407 join aggView6659347299111069770 using(v37);
create or replace view aggView3341013729552534792 as select v37, SUM(annot) as annot from aggJoin5266411673734602195 group by v37;
create or replace view aggJoin6964618106523369473 as select annot from aggJoin4576745051449122865 join aggView3341013729552534792 using(v37);
select SUM(annot) as v49 from aggJoin6964618106523369473;
