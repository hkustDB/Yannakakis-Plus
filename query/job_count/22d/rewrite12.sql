create or replace view aggView888320108673718896 as select id as v10 from info_type as it1 where info= 'countries';
create or replace view aggJoin3418309393473840501 as select movie_id as v37, info as v27 from movie_info as mi, aggView888320108673718896 where mi.info_type_id=aggView888320108673718896.v10 and info IN ('Sweden','Norway','Germany','Denmark','Swedish','Danish','Norwegian','German','USA','American');
create or replace view aggView6770265036993495006 as select id as v14 from keyword as k where keyword IN ('murder','murder-in-title','blood','violence');
create or replace view aggJoin1366996374767328094 as select movie_id as v37 from movie_keyword as mk, aggView6770265036993495006 where mk.keyword_id=aggView6770265036993495006.v14;
create or replace view aggView638848002765459024 as select id as v8 from company_type as ct;
create or replace view aggJoin2382998547460569547 as select movie_id as v37, company_id as v1 from movie_companies as mc, aggView638848002765459024 where mc.company_type_id=aggView638848002765459024.v8;
create or replace view aggView9079319492206415607 as select id as v1 from company_name as cn where country_code<> '[us]';
create or replace view aggJoin716428916198305669 as select v37 from aggJoin2382998547460569547 join aggView9079319492206415607 using(v1);
create or replace view aggView1506875847409451295 as select v37, COUNT(*) as annot from aggJoin716428916198305669 group by v37;
create or replace view aggJoin2548644150811734694 as select movie_id as v37, info_type_id as v12, info as v32, annot from movie_info_idx as mi_idx, aggView1506875847409451295 where mi_idx.movie_id=aggView1506875847409451295.v37 and info<'8.5';
create or replace view aggView2610217278788199336 as select id as v12 from info_type as it2 where info= 'rating';
create or replace view aggJoin2370158737358727779 as select v37, v32, annot from aggJoin2548644150811734694 join aggView2610217278788199336 using(v12);
create or replace view aggView2123239352953690646 as select v37, SUM(annot) as annot from aggJoin2370158737358727779 group by v37;
create or replace view aggJoin9017418296891784694 as select v37, v27, annot from aggJoin3418309393473840501 join aggView2123239352953690646 using(v37);
create or replace view aggView3929699089061213186 as select v37, SUM(annot) as annot from aggJoin9017418296891784694 group by v37;
create or replace view aggJoin4907421821008889895 as select v37, annot from aggJoin1366996374767328094 join aggView3929699089061213186 using(v37);
create or replace view aggView7388567159984510699 as select v37, SUM(annot) as annot from aggJoin4907421821008889895 group by v37;
create or replace view aggJoin5440854181145985856 as select kind_id as v17, production_year as v41, annot from title as t, aggView7388567159984510699 where t.id=aggView7388567159984510699.v37 and production_year>2005;
create or replace view aggView8844217692153619640 as select v17, SUM(annot) as annot from aggJoin5440854181145985856 group by v17;
create or replace view aggJoin3070354714494019307 as select kind as v18, annot from kind_type as kt, aggView8844217692153619640 where kt.id=aggView8844217692153619640.v17 and kind IN ('movie','episode');
select SUM(annot) as v49 from aggJoin3070354714494019307;
