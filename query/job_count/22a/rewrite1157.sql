create or replace view aggView2320775477236785681 as select id as v1 from company_name as cn where country_code<> '[us]';
create or replace view aggJoin8378212923914335224 as select movie_id as v37, company_type_id as v8, note as v23 from movie_companies as mc, aggView2320775477236785681 where mc.company_id=aggView2320775477236785681.v1 and note NOT LIKE '%(USA)%' and note LIKE '%(200%)%';
create or replace view aggView643838753687744902 as select id as v10 from info_type as it1 where info= 'countries';
create or replace view aggJoin4538003639667638181 as select movie_id as v37, info as v27 from movie_info as mi, aggView643838753687744902 where mi.info_type_id=aggView643838753687744902.v10 and info IN ('Germany','German','USA','American');
create or replace view aggView3932423258142058373 as select id as v14 from keyword as k where keyword IN ('murder','murder-in-title','blood','violence');
create or replace view aggJoin2846035376220483473 as select movie_id as v37 from movie_keyword as mk, aggView3932423258142058373 where mk.keyword_id=aggView3932423258142058373.v14;
create or replace view aggView3492642340723156231 as select v37, COUNT(*) as annot from aggJoin4538003639667638181 group by v37;
create or replace view aggJoin8682080951331076840 as select movie_id as v37, info_type_id as v12, info as v32, annot from movie_info_idx as mi_idx, aggView3492642340723156231 where mi_idx.movie_id=aggView3492642340723156231.v37 and info<'7.0';
create or replace view aggView3828704653793632495 as select id as v12 from info_type as it2 where info= 'rating';
create or replace view aggJoin1070323681435974295 as select v37, v32, annot from aggJoin8682080951331076840 join aggView3828704653793632495 using(v12);
create or replace view aggView4093881219943649735 as select v37, SUM(annot) as annot from aggJoin1070323681435974295 group by v37;
create or replace view aggJoin8318766054638628568 as select v37, v8, v23, annot from aggJoin8378212923914335224 join aggView4093881219943649735 using(v37);
create or replace view aggView3232011797989695508 as select id as v8 from company_type as ct;
create or replace view aggJoin3439262273872577307 as select v37, v23, annot from aggJoin8318766054638628568 join aggView3232011797989695508 using(v8);
create or replace view aggView8527375321242446181 as select v37, SUM(annot) as annot from aggJoin3439262273872577307 group by v37;
create or replace view aggJoin1146347182518284775 as select id as v37, kind_id as v17, production_year as v41, annot from title as t, aggView8527375321242446181 where t.id=aggView8527375321242446181.v37 and production_year>2008;
create or replace view aggView3484561954102492728 as select id as v17 from kind_type as kt where kind IN ('movie','episode');
create or replace view aggJoin4957545550743428660 as select v37, v41, annot from aggJoin1146347182518284775 join aggView3484561954102492728 using(v17);
create or replace view aggView5751030739155297499 as select v37, SUM(annot) as annot from aggJoin4957545550743428660 group by v37;
create or replace view aggJoin7312135598376180218 as select annot from aggJoin2846035376220483473 join aggView5751030739155297499 using(v37);
select SUM(annot) as v49 from aggJoin7312135598376180218;
