create or replace view aggView3503674412388659257 as select id as v1 from company_name as cn where country_code<> '[us]';
create or replace view aggJoin4844140434952745747 as select movie_id as v37, company_type_id as v8, note as v23 from movie_companies as mc, aggView3503674412388659257 where mc.company_id=aggView3503674412388659257.v1 and note NOT LIKE '%(USA)%' and note LIKE '%(200%)%';
create or replace view aggView762778445702807282 as select id as v10 from info_type as it1 where info= 'countries';
create or replace view aggJoin5448617249796230672 as select movie_id as v37, info as v27 from movie_info as mi, aggView762778445702807282 where mi.info_type_id=aggView762778445702807282.v10 and info IN ('Germany','German','USA','American');
create or replace view aggView1868397534591389553 as select id as v14 from keyword as k where keyword IN ('murder','murder-in-title','blood','violence');
create or replace view aggJoin7242397795266517128 as select movie_id as v37 from movie_keyword as mk, aggView1868397534591389553 where mk.keyword_id=aggView1868397534591389553.v14;
create or replace view aggView3981964965881015963 as select v37, COUNT(*) as annot from aggJoin5448617249796230672 group by v37;
create or replace view aggJoin7485891321100561343 as select v37, annot from aggJoin7242397795266517128 join aggView3981964965881015963 using(v37);
create or replace view aggView6419656587450043956 as select v37, SUM(annot) as annot from aggJoin7485891321100561343 group by v37;
create or replace view aggJoin910955211693016460 as select id as v37, kind_id as v17, production_year as v41, annot from title as t, aggView6419656587450043956 where t.id=aggView6419656587450043956.v37 and production_year>2008;
create or replace view aggView5246145698563130933 as select id as v12 from info_type as it2 where info= 'rating';
create or replace view aggJoin7344704842193121495 as select movie_id as v37, info as v32 from movie_info_idx as mi_idx, aggView5246145698563130933 where mi_idx.info_type_id=aggView5246145698563130933.v12 and info<'7.0';
create or replace view aggView4832007451955663139 as select id as v17 from kind_type as kt where kind IN ('movie','episode');
create or replace view aggJoin5318236233924547683 as select v37, v41, annot from aggJoin910955211693016460 join aggView4832007451955663139 using(v17);
create or replace view aggView2773927484701078356 as select v37, SUM(annot) as annot from aggJoin5318236233924547683 group by v37;
create or replace view aggJoin3637581921577187556 as select v37, v32, annot from aggJoin7344704842193121495 join aggView2773927484701078356 using(v37);
create or replace view aggView6805951079934642133 as select v37, SUM(annot) as annot from aggJoin3637581921577187556 group by v37;
create or replace view aggJoin5822849092106511534 as select v8, v23, annot from aggJoin4844140434952745747 join aggView6805951079934642133 using(v37);
create or replace view aggView525112344401176953 as select v8, SUM(annot) as annot from aggJoin5822849092106511534 group by v8;
create or replace view aggJoin1682215617797653869 as select annot from company_type as ct, aggView525112344401176953 where ct.id=aggView525112344401176953.v8;
select SUM(annot) as v49 from aggJoin1682215617797653869;
