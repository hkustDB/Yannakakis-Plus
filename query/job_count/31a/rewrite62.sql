create or replace view aggView7942752916831470624 as select id as v8 from company_name as cn where name LIKE 'Lionsgate%';
create or replace view aggJoin657775274945972714 as select movie_id as v49 from movie_companies as mc, aggView7942752916831470624 where mc.company_id=aggView7942752916831470624.v8;
create or replace view aggView3095531408175160938 as select id as v15 from info_type as it1 where info= 'genres';
create or replace view aggJoin3985281370501352737 as select movie_id as v49, info as v30 from movie_info as mi, aggView3095531408175160938 where mi.info_type_id=aggView3095531408175160938.v15 and info IN ('Horror','Thriller');
create or replace view aggView9178874655215645512 as select id as v17 from info_type as it2 where info= 'votes';
create or replace view aggJoin8605390820606077566 as select movie_id as v49 from movie_info_idx as mi_idx, aggView9178874655215645512 where mi_idx.info_type_id=aggView9178874655215645512.v17;
create or replace view aggView2423555510807337533 as select id as v19 from keyword as k where keyword IN ('murder','violence','blood','gore','death','female-nudity','hospital');
create or replace view aggJoin4248029114623191085 as select movie_id as v49 from movie_keyword as mk, aggView2423555510807337533 where mk.keyword_id=aggView2423555510807337533.v19;
create or replace view aggView4103970910755362008 as select v49, COUNT(*) as annot from aggJoin657775274945972714 group by v49;
create or replace view aggJoin3695354604040378151 as select v49, annot from aggJoin8605390820606077566 join aggView4103970910755362008 using(v49);
create or replace view aggView3557383653289664469 as select v49, SUM(annot) as annot from aggJoin3695354604040378151 group by v49;
create or replace view aggJoin8136719734632040019 as select id as v49, annot from title as t, aggView3557383653289664469 where t.id=aggView3557383653289664469.v49;
create or replace view aggView893999564051177551 as select v49, SUM(annot) as annot from aggJoin8136719734632040019 group by v49;
create or replace view aggJoin5466557117704438841 as select v49, v30, annot from aggJoin3985281370501352737 join aggView893999564051177551 using(v49);
create or replace view aggView4043540924772883132 as select v49, SUM(annot) as annot from aggJoin5466557117704438841 group by v49;
create or replace view aggJoin7165976674380403779 as select v49, annot from aggJoin4248029114623191085 join aggView4043540924772883132 using(v49);
create or replace view aggView3436580257210453157 as select v49, SUM(annot) as annot from aggJoin7165976674380403779 group by v49;
create or replace view aggJoin9152737779554765452 as select person_id as v40, note as v5, annot from cast_info as ci, aggView3436580257210453157 where ci.movie_id=aggView3436580257210453157.v49 and note IN ('(writer)','(head writer)','(written by)','(story)','(story editor)');
create or replace view aggView1228315849745968101 as select v40, SUM(annot) as annot from aggJoin9152737779554765452 group by v40;
create or replace view aggJoin3274036950217862501 as select annot from name as n, aggView1228315849745968101 where n.id=aggView1228315849745968101.v40 and gender= 'm';
select SUM(annot) as v61 from aggJoin3274036950217862501;
