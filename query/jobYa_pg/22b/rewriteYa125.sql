create or replace view semiUp3341470571332237653 as select movie_id as v37, keyword_id as v14 from movie_keyword AS mk where (keyword_id) in (select id from keyword AS k where keyword IN ('murder','murder-in-title','blood','violence'));
create or replace view semiUp1325198008459792730 as select movie_id as v37, company_id as v1, company_type_id as v8 from movie_companies AS mc where (company_id) in (select id from company_name AS cn where country_code<> '[us]') and note NOT LIKE '%(USA)%' and note LIKE '%(200%)%';
create or replace view semiUp8527648577359343497 as select id as v37, title as v38, kind_id as v17 from title AS t where (kind_id) in (select id from kind_type AS kt where kind IN ('movie','episode')) and production_year>2009;
create or replace view semiUp5578557118046479565 as select v37, v1, v8 from semiUp1325198008459792730 where (v8) in (select id from company_type AS ct);
create or replace view semiUp1667852036961118558 as select movie_id as v37, info_type_id as v10 from movie_info AS mi where (info_type_id) in (select id from info_type AS it1 where info= 'countries') and info IN ('Germany','German','USA','American');
create or replace view semiUp7395470208191305277 as select movie_id as v37, info_type_id as v12, info as v32 from movie_info_idx AS mi_idx where (movie_id) in (select v37 from semiUp8527648577359343497) and info<'7.0';
create or replace view semiUp7395680629922075271 as select v37, v12, v32 from semiUp7395470208191305277 where (v12) in (select id from info_type AS it2 where info= 'rating');
create or replace view semiUp19670938821164143 as select v37, v10 from semiUp1667852036961118558 where (v37) in (select v37 from semiUp7395680629922075271);
create or replace view semiUp1695548912309980784 as select v37, v14 from semiUp3341470571332237653 where (v37) in (select v37 from semiUp5578557118046479565);
create or replace view semiUp6749325789246523743 as select v37, v14 from semiUp1695548912309980784 where (v37) in (select v37 from semiUp19670938821164143);
create or replace view semiDown6946548942829960501 as select id as v14 from keyword AS k where (id) in (select v14 from semiUp6749325789246523743) and keyword IN ('murder','murder-in-title','blood','violence');
create or replace view semiDown4846970903216863005 as select v37, v1, v8 from semiUp5578557118046479565 where (v37) in (select v37 from semiUp6749325789246523743);
create or replace view semiDown1830132916017965197 as select v37, v10 from semiUp19670938821164143 where (v37) in (select v37 from semiUp6749325789246523743);
create or replace view semiDown5495067748990583208 as select id as v8 from company_type AS ct where (id) in (select v8 from semiDown4846970903216863005);
create or replace view semiDown6968679004914993997 as select id as v1, name as v2 from company_name AS cn where (id) in (select v1 from semiDown4846970903216863005) and country_code<> '[us]';
create or replace view semiDown7463130107357620396 as select id as v10 from info_type AS it1 where (id) in (select v10 from semiDown1830132916017965197) and info= 'countries';
create or replace view semiDown6279900119776375169 as select v37, v12, v32 from semiUp7395680629922075271 where (v37) in (select v37 from semiDown1830132916017965197);
create or replace view semiDown5658288891167927336 as select id as v12 from info_type AS it2 where (id) in (select v12 from semiDown6279900119776375169) and info= 'rating';
create or replace view semiDown3031463127781669541 as select v37, v38, v17 from semiUp8527648577359343497 where (v37) in (select v37 from semiDown6279900119776375169);
create or replace view semiDown7727470995726452030 as select id as v17 from kind_type AS kt where (id) in (select v17 from semiDown3031463127781669541) and kind IN ('movie','episode');
create or replace view aggView5102222293480226862 as select v17 from semiDown7727470995726452030;
create or replace view aggJoin9095799364667914899 as select v37, v38 from semiDown3031463127781669541 join aggView5102222293480226862 using(v17);
create or replace view aggView7963692433146544826 as select v37, MIN(v38) as v51 from aggJoin9095799364667914899 group by v37;
create or replace view aggJoin7509119081224503829 as select v37, v12, v32, v51 from semiDown6279900119776375169 join aggView7963692433146544826 using(v37);
create or replace view aggView2323770505220185955 as select v12 from semiDown5658288891167927336;
create or replace view aggJoin3683947638259762622 as select v37, v32, v51 from aggJoin7509119081224503829 join aggView2323770505220185955 using(v12);
create or replace view aggView5104617065714423655 as select v10 from semiDown7463130107357620396;
create or replace view aggJoin3139659890449906615 as select v37 from semiDown1830132916017965197 join aggView5104617065714423655 using(v10);
create or replace view aggView2927313370577347886 as select v1, v2 as v49 from semiDown6968679004914993997;
create or replace view aggJoin8214830857173474161 as select v37, v8, v49 from semiDown4846970903216863005 join aggView2927313370577347886 using(v1);
create or replace view aggView5529849914704211601 as select v8 from semiDown5495067748990583208;
create or replace view aggJoin612597809412196083 as select v37, v49 from aggJoin8214830857173474161 join aggView5529849914704211601 using(v8);
create or replace view aggView259782921824070736 as select v37, MIN(v51) as v51, MIN(v32) as v50 from aggJoin3683947638259762622 group by v37,v51;
create or replace view aggJoin6443791976548715703 as select v37, v51, v50 from aggJoin3139659890449906615 join aggView259782921824070736 using(v37);
create or replace view aggView7985006381521120950 as select v14 from semiDown6946548942829960501;
create or replace view aggJoin6190712363648289759 as select v37 from semiUp6749325789246523743 join aggView7985006381521120950 using(v14);
create or replace view aggView5417528463457250717 as select v37, MIN(v49) as v49 from aggJoin612597809412196083 group by v37,v49;
create or replace view aggJoin2236664549275336346 as select v37, v49 from aggJoin6190712363648289759 join aggView5417528463457250717 using(v37);
create or replace view aggView9213425696549714554 as select v37, MIN(v51) as v51, MIN(v50) as v50 from aggJoin6443791976548715703 group by v37,v50,v51;
create or replace view aggJoin2695964334283936738 as select v49 as v49, v51, v50 from aggJoin2236664549275336346 join aggView9213425696549714554 using(v37);
create or replace view res as select MIN(v49) as v49, MIN(v50) as v50, MIN(v51) as v51 from aggJoin2695964334283936738;
select sum(v49+v50+v51) from res;
