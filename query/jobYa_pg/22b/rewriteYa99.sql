create or replace view semiUp2794509992034564971 as select movie_id as v37, info_type_id as v10 from movie_info AS mi where (info_type_id) in (select id from info_type AS it1 where info= 'countries') and info IN ('Germany','German','USA','American');
create or replace view cnAux66 as select id as v1, name as v2 from company_name where country_code<> '[us]';
create or replace view semiUp4890922925361103886 as select id as v37, title as v38, kind_id as v17 from title AS t where (kind_id) in (select id from kind_type AS kt where kind IN ('movie','episode')) and production_year>2009;
create or replace view semiUp8178306376300031347 as select movie_id as v37, info_type_id as v12, info as v32 from movie_info_idx AS mi_idx where (info_type_id) in (select id from info_type AS it2 where info= 'rating') and info<'7.0';
create or replace view tAux38 as select v37, v38 from semiUp4890922925361103886;
create or replace view semiUp765924446848243401 as select movie_id as v37, keyword_id as v14 from movie_keyword AS mk where (keyword_id) in (select id from keyword AS k where keyword IN ('murder','murder-in-title','blood','violence'));
create or replace view semiUp4615684938125960540 as select v37, v10 from semiUp2794509992034564971 where (v37) in (select v37 from semiUp765924446848243401);
create or replace view semiUp1355287242587552794 as select v37, v12, v32 from semiUp8178306376300031347 where (v37) in (select v37 from semiUp4615684938125960540);
create or replace view mi_idxAux85 as select v37, v32 from semiUp1355287242587552794;
create or replace view semiUp6028260573747641135 as select movie_id as v37, company_id as v1, company_type_id as v8 from movie_companies AS mc where (company_id) in (select v1 from cnAux66) and note NOT LIKE '%(USA)%' and note LIKE '%(200%)%';
create or replace view semiUp4297328277167977868 as select v37, v1, v8 from semiUp6028260573747641135 where (v8) in (select id from company_type AS ct);
create or replace view semiUp8439847420114058119 as select v37, v1, v8 from semiUp4297328277167977868 where (v37) in (select v37 from mi_idxAux85);
create or replace view semiUp5911673211382472582 as select v37, v38 from tAux38 where (v37) in (select v37 from semiUp8439847420114058119);
create or replace view semiDown6256442249290470708 as select v37, v1, v8 from semiUp8439847420114058119 where (v37) in (select v37 from semiUp5911673211382472582);
create or replace view semiDown2781286936590294109 as select v37, v38, v17 from semiUp4890922925361103886 where (v38, v37) in (select v38, v37 from semiUp5911673211382472582);
create or replace view semiDown2023530721724563632 as select id as v8 from company_type AS ct where (id) in (select v8 from semiDown6256442249290470708);
create or replace view semiDown5379134098344319232 as select v1, v2 from cnAux66 where (v1) in (select v1 from semiDown6256442249290470708);
create or replace view semiDown4063464547834100024 as select v37, v32 from mi_idxAux85 where (v37) in (select v37 from semiDown6256442249290470708);
create or replace view semiDown5463158064978543129 as select id as v17 from kind_type AS kt where (id) in (select v17 from semiDown2781286936590294109) and kind IN ('movie','episode');
create or replace view semiDown5740552761331611431 as select id as v1, name as v2 from company_name AS cn where (id, name) in (select v1, v2 from semiDown5379134098344319232) and country_code<> '[us]';
create or replace view semiDown2792097323555283294 as select v37, v12, v32 from semiUp1355287242587552794 where (v32, v37) in (select v32, v37 from semiDown4063464547834100024);
create or replace view semiDown1975086644971724096 as select id as v12 from info_type AS it2 where (id) in (select v12 from semiDown2792097323555283294) and info= 'rating';
create or replace view semiDown2072024025087939454 as select v37, v10 from semiUp4615684938125960540 where (v37) in (select v37 from semiDown2792097323555283294);
create or replace view semiDown2434472019267135632 as select id as v10 from info_type AS it1 where (id) in (select v10 from semiDown2072024025087939454) and info= 'countries';
create or replace view semiDown4392795984404470016 as select v37, v14 from semiUp765924446848243401 where (v37) in (select v37 from semiDown2072024025087939454);
create or replace view semiDown7840512963914579697 as select id as v14 from keyword AS k where (id) in (select v14 from semiDown4392795984404470016) and keyword IN ('murder','murder-in-title','blood','violence');
create or replace view aggView1030292596249540692 as select v1, v2, v2 as v49 from semiDown5740552761331611431;
create or replace view aggView8133430461970734275 as select v14 from semiDown7840512963914579697;
create or replace view aggJoin4783455890294414842 as select v37 from semiDown4392795984404470016 join aggView8133430461970734275 using(v14);
create or replace view aggView1637111509733037177 as select v10 from semiDown2434472019267135632;
create or replace view aggJoin1265607184513314926 as select v37 from semiDown2072024025087939454 join aggView1637111509733037177 using(v10);
create or replace view aggView3182192982036627112 as select v37 from aggJoin4783455890294414842 group by v37;
create or replace view aggJoin5894165441400635548 as select v37 from aggJoin1265607184513314926 join aggView3182192982036627112 using(v37);
create or replace view aggView4532221386756730417 as select v12 from semiDown1975086644971724096;
create or replace view aggJoin2142447567432894058 as select v37, v32 from semiDown2792097323555283294 join aggView4532221386756730417 using(v12);
create or replace view aggView2522895239676654556 as select v37 from aggJoin5894165441400635548 group by v37;
create or replace view aggJoin7062412375259601139 as select v37, v32 from aggJoin2142447567432894058 join aggView2522895239676654556 using(v37);
create or replace view aggView1377758271190800788 as select v32, v37, MIN(v32) as v50 from aggJoin7062412375259601139 group by v32,v37;
create or replace view aggView1713045554968523502 as select v17 from semiDown5463158064978543129;
create or replace view aggJoin3543759330963068126 as select v37, v38 from semiDown2781286936590294109 join aggView1713045554968523502 using(v17);
create or replace view aggView5729266659995393119 as select v38, v37, MIN(v38) as v51 from aggJoin3543759330963068126 group by v38,v37;
create or replace view aggView3728140983690435545 as select v8 from semiDown2023530721724563632;
create or replace view aggJoin706450344066282792 as select v37, v1 from semiDown6256442249290470708 join aggView3728140983690435545 using(v8);
create or replace view aggView9025878663006761851 as select v1, MIN(v49) as v49 from aggView1030292596249540692 group by v1,v49;
create or replace view aggJoin2779442105809195529 as select v37, v49 from aggJoin706450344066282792 join aggView9025878663006761851 using(v1);
create or replace view aggView6372234290414388385 as select v37, MIN(v50) as v50 from aggView1377758271190800788 group by v37,v50;
create or replace view aggJoin8381767192583569858 as select v37, v49 as v49, v50 from aggJoin2779442105809195529 join aggView6372234290414388385 using(v37);
create or replace view aggView4595826495937707014 as select v37, MIN(v49) as v49, MIN(v50) as v50 from aggJoin8381767192583569858 group by v37,v49,v50;
create or replace view aggJoin3452570206501954400 as select v51 as v51, v49, v50 from aggView5729266659995393119 join aggView4595826495937707014 using(v37);
create or replace view res as select MIN(v49) as v49, MIN(v50) as v50, MIN(v51) as v51 from aggJoin3452570206501954400;
select sum(v49+v50+v51) from res;
