create or replace view semiUp6917018883388992431 as select movie_id as v37, company_id as v1, company_type_id as v8 from movie_companies AS mc where (company_type_id) in (select id from company_type AS ct) and note NOT LIKE '%(USA)%' and note LIKE '%(200%)%';
create or replace view semiUp2188543692074117505 as select movie_id as v37, info_type_id as v10 from movie_info AS mi where (info_type_id) in (select id from info_type AS it1 where info= 'countries') and info IN ('Sweden','Norway','Germany','Denmark','Swedish','Danish','Norwegian','German','USA','American');
create or replace view semiUp6837283837317452713 as select id as v37, title as v38, kind_id as v17 from title AS t where (kind_id) in (select id from kind_type AS kt where kind IN ('movie','episode')) and production_year>2005;
create or replace view semiUp6804351281782906627 as select movie_id as v37, info_type_id as v12, info as v32 from movie_info_idx AS mi_idx where (info_type_id) in (select id from info_type AS it2 where info= 'rating') and info<'8.5';
create or replace view semiUp4967178714599276586 as select v37, v1, v8 from semiUp6917018883388992431 where (v1) in (select id from company_name AS cn where country_code<> '[us]');
create or replace view semiUp271052340675378784 as select movie_id as v37, keyword_id as v14 from movie_keyword AS mk where (keyword_id) in (select id from keyword AS k where keyword IN ('murder','murder-in-title','blood','violence'));
create or replace view semiUp4761486331242359650 as select v37, v12, v32 from semiUp6804351281782906627 where (v37) in (select v37 from semiUp2188543692074117505);
create or replace view semiUp3951582193830050724 as select v37, v14 from semiUp271052340675378784 where (v37) in (select v37 from semiUp4967178714599276586);
create or replace view semiUp5183445968883085338 as select v37, v38, v17 from semiUp6837283837317452713 where (v37) in (select v37 from semiUp4761486331242359650);
create or replace view semiUp847595747971189000 as select v37, v14 from semiUp3951582193830050724 where (v37) in (select v37 from semiUp5183445968883085338);
create or replace view semiDown8447931197244305345 as select id as v14 from keyword AS k where (id) in (select v14 from semiUp847595747971189000) and keyword IN ('murder','murder-in-title','blood','violence');
create or replace view semiDown6178901672249921457 as select v37, v1, v8 from semiUp4967178714599276586 where (v37) in (select v37 from semiUp847595747971189000);
create or replace view semiDown8319595816463097542 as select v37, v38, v17 from semiUp5183445968883085338 where (v37) in (select v37 from semiUp847595747971189000);
create or replace view semiDown2623372126265689484 as select id as v8 from company_type AS ct where (id) in (select v8 from semiDown6178901672249921457);
create or replace view semiDown3608286221088186020 as select id as v1, name as v2 from company_name AS cn where (id) in (select v1 from semiDown6178901672249921457) and country_code<> '[us]';
create or replace view semiDown3765992037025792504 as select id as v17 from kind_type AS kt where (id) in (select v17 from semiDown8319595816463097542) and kind IN ('movie','episode');
create or replace view semiDown613779637001596703 as select v37, v12, v32 from semiUp4761486331242359650 where (v37) in (select v37 from semiDown8319595816463097542);
create or replace view semiDown7539664141727119765 as select id as v12 from info_type AS it2 where (id) in (select v12 from semiDown613779637001596703) and info= 'rating';
create or replace view semiDown5855097894706428728 as select v37, v10 from semiUp2188543692074117505 where (v37) in (select v37 from semiDown613779637001596703);
create or replace view semiDown4837758461903235977 as select id as v10 from info_type AS it1 where (id) in (select v10 from semiDown5855097894706428728) and info= 'countries';
create or replace view aggView6896528560518052910 as select v10 from semiDown4837758461903235977;
create or replace view aggJoin4231257804667279137 as select v37 from semiDown5855097894706428728 join aggView6896528560518052910 using(v10);
create or replace view aggView3451470269800575708 as select v12 from semiDown7539664141727119765;
create or replace view aggJoin5413523333373321644 as select v37, v32 from semiDown613779637001596703 join aggView3451470269800575708 using(v12);
create or replace view aggView6620072207558183091 as select v37 from aggJoin4231257804667279137 group by v37;
create or replace view aggJoin8432467104322649745 as select v37, v32 from aggJoin5413523333373321644 join aggView6620072207558183091 using(v37);
create or replace view aggView7795496895134572273 as select v17 from semiDown3765992037025792504;
create or replace view aggJoin3050438418755990378 as select v37, v38 from semiDown8319595816463097542 join aggView7795496895134572273 using(v17);
create or replace view aggView1838675020350260173 as select v1, v2 as v49 from semiDown3608286221088186020;
create or replace view aggJoin2484455328521662661 as select v37, v8, v49 from semiDown6178901672249921457 join aggView1838675020350260173 using(v1);
create or replace view aggView9222857442137365265 as select v8 from semiDown2623372126265689484;
create or replace view aggJoin5256989883107362090 as select v37, v49 from aggJoin2484455328521662661 join aggView9222857442137365265 using(v8);
create or replace view aggView628577175190068471 as select v37, MIN(v32) as v50 from aggJoin8432467104322649745 group by v37;
create or replace view aggJoin7334482783760883980 as select v37, v38, v50 from aggJoin3050438418755990378 join aggView628577175190068471 using(v37);
create or replace view aggView9136587439335877215 as select v37, MIN(v49) as v49 from aggJoin5256989883107362090 group by v37,v49;
create or replace view aggJoin6694191009841418755 as select v37, v14, v49 from semiUp847595747971189000 join aggView9136587439335877215 using(v37);
create or replace view aggView8128682743619480343 as select v37, MIN(v50) as v50, MIN(v38) as v51 from aggJoin7334482783760883980 group by v37,v50;
create or replace view aggJoin4102696237778549699 as select v14, v49 as v49, v50, v51 from aggJoin6694191009841418755 join aggView8128682743619480343 using(v37);
create or replace view aggView4140998017028418004 as select v14 from semiDown8447931197244305345;
create or replace view aggJoin4478701200027035479 as select v49, v50, v51 from aggJoin4102696237778549699 join aggView4140998017028418004 using(v14);
create or replace view res as select MIN(v49) as v49, MIN(v50) as v50, MIN(v51) as v51 from aggJoin4478701200027035479;
select sum(v49+v50+v51) from res;
