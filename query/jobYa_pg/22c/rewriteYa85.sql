create or replace view semiUp7471242535671147015 as select movie_id as v37, info_type_id as v10 from movie_info AS mi where (info_type_id) in (select id from info_type AS it1 where info= 'countries') and info IN ('Sweden','Norway','Germany','Denmark','Swedish','Danish','Norwegian','German','USA','American');
create or replace view semiUp299295762222971230 as select id as v37, title as v38, kind_id as v17 from title AS t where (kind_id) in (select id from kind_type AS kt where kind IN ('movie','episode')) and production_year>2005;
create or replace view semiUp2101724809119892182 as select movie_id as v37, keyword_id as v14 from movie_keyword AS mk where (keyword_id) in (select id from keyword AS k where keyword IN ('murder','murder-in-title','blood','violence'));
create or replace view semiUp8733754241675766296 as select movie_id as v37, info_type_id as v12, info as v32 from movie_info_idx AS mi_idx where (movie_id) in (select v37 from semiUp2101724809119892182);
create or replace view semiUp8918363066485560527 as select v37, v12, v32 from semiUp8733754241675766296 where (v12) in (select id from info_type AS it2 where info= 'rating');
create or replace view semiUp2155728750063910582 as select v37, v38, v17 from semiUp299295762222971230 where (v37) in (select v37 from semiUp7471242535671147015);
create or replace view cnAux7 as select id as v1, name as v2 from company_name where country_code<> '[us]';
create or replace view mi_idxAux60 as select v37, v32 from semiUp8918363066485560527;
create or replace view tAux15 as select v37, v38 from semiUp2155728750063910582;
create or replace view semiUp7737585546115707121 as select movie_id as v37, company_id as v1, company_type_id as v8 from movie_companies AS mc where (movie_id) in (select v37 from mi_idxAux60) and note NOT LIKE '%(USA)%' and note LIKE '%(200%)%';
create or replace view semiUp2829962584670168730 as select v37, v1, v8 from semiUp7737585546115707121 where (v37) in (select v37 from tAux15);
create or replace view semiUp7848322885949330440 as select v37, v1, v8 from semiUp2829962584670168730 where (v8) in (select id from company_type AS ct);
create or replace view semiUp3210275841922237288 as select v1, v2 from cnAux7 where (v1) in (select v1 from semiUp7848322885949330440);
create or replace view semiDown8346155071273177883 as select id as v1, name as v2 from company_name AS cn where (id, name) in (select v1, v2 from semiUp3210275841922237288) and country_code<> '[us]';
create or replace view semiDown1830800925769143804 as select v37, v1, v8 from semiUp7848322885949330440 where (v1) in (select v1 from semiUp3210275841922237288);
create or replace view semiDown4836419984772919546 as select id as v8 from company_type AS ct where (id) in (select v8 from semiDown1830800925769143804);
create or replace view semiDown6275900776984546202 as select v37, v38 from tAux15 where (v37) in (select v37 from semiDown1830800925769143804);
create or replace view semiDown3424949761986553824 as select v37, v32 from mi_idxAux60 where (v37) in (select v37 from semiDown1830800925769143804);
create or replace view semiDown8202016924442389652 as select v37, v38, v17 from semiUp2155728750063910582 where (v38, v37) in (select v38, v37 from semiDown6275900776984546202);
create or replace view semiDown4425589125391733315 as select v37, v12, v32 from semiUp8918363066485560527 where (v37, v32) in (select v37, v32 from semiDown3424949761986553824);
create or replace view semiDown7469887994608076345 as select id as v17 from kind_type AS kt where (id) in (select v17 from semiDown8202016924442389652) and kind IN ('movie','episode');
create or replace view semiDown5344653204597937107 as select v37, v10 from semiUp7471242535671147015 where (v37) in (select v37 from semiDown8202016924442389652);
create or replace view semiDown9031037438546797644 as select id as v12 from info_type AS it2 where (id) in (select v12 from semiDown4425589125391733315) and info= 'rating';
create or replace view semiDown7926665410184432848 as select v37, v14 from semiUp2101724809119892182 where (v37) in (select v37 from semiDown4425589125391733315);
create or replace view semiDown1711757819317605001 as select id as v10 from info_type AS it1 where (id) in (select v10 from semiDown5344653204597937107) and info= 'countries';
create or replace view semiDown2229612308416782616 as select id as v14 from keyword AS k where (id) in (select v14 from semiDown7926665410184432848) and keyword IN ('murder','murder-in-title','blood','violence');
create or replace view aggView990694795531970563 as select v2, v1, v2 as v49 from semiDown8346155071273177883;
create or replace view aggView2293474435770646207 as select v14 from semiDown2229612308416782616;
create or replace view aggJoin4933694043560341771 as select v37 from semiDown7926665410184432848 join aggView2293474435770646207 using(v14);
create or replace view aggView3397240645943415613 as select v10 from semiDown1711757819317605001;
create or replace view aggJoin9001222460162556126 as select v37 from semiDown5344653204597937107 join aggView3397240645943415613 using(v10);
create or replace view aggView1351585915784567567 as select v12 from semiDown9031037438546797644;
create or replace view aggJoin3120485671093874639 as select v37, v32 from semiDown4425589125391733315 join aggView1351585915784567567 using(v12);
create or replace view aggView4414478910123755301 as select v17 from semiDown7469887994608076345;
create or replace view aggJoin879723283704531950 as select v37, v38 from semiDown8202016924442389652 join aggView4414478910123755301 using(v17);
create or replace view aggView8291481938235934429 as select v37 from aggJoin4933694043560341771 group by v37;
create or replace view aggJoin1568001757219878697 as select v37, v32 from aggJoin3120485671093874639 join aggView8291481938235934429 using(v37);
create or replace view aggView5760540588398782668 as select v37, v32, MIN(v32) as v50 from aggJoin1568001757219878697 group by v37,v32;
create or replace view aggView8961999499628122157 as select v37 from aggJoin9001222460162556126 group by v37;
create or replace view aggJoin7252130987104179349 as select v37, v38 from aggJoin879723283704531950 join aggView8961999499628122157 using(v37);
create or replace view aggView7096321881543993509 as select v38, v37, MIN(v38) as v51 from aggJoin7252130987104179349 group by v38,v37;
create or replace view aggView2024271437407540042 as select v37, MIN(v50) as v50 from aggView5760540588398782668 group by v37,v50;
create or replace view aggJoin4494101931616536913 as select v37, v1, v8, v50 from semiDown1830800925769143804 join aggView2024271437407540042 using(v37);
create or replace view aggView5836109445315497243 as select v8 from semiDown4836419984772919546;
create or replace view aggJoin3623595188139747316 as select v37, v1, v50 from aggJoin4494101931616536913 join aggView5836109445315497243 using(v8);
create or replace view aggView1841891863528166370 as select v37, MIN(v51) as v51 from aggView7096321881543993509 group by v37,v51;
create or replace view aggJoin3043179285236097625 as select v1, v50 as v50, v51 from aggJoin3623595188139747316 join aggView1841891863528166370 using(v37);
create or replace view aggView244860216940389305 as select v1, MIN(v50) as v50, MIN(v51) as v51 from aggJoin3043179285236097625 group by v1,v50,v51;
create or replace view aggJoin3770343935726941722 as select v49 as v49, v50, v51 from aggView990694795531970563 join aggView244860216940389305 using(v1);
create or replace view res as select MIN(v49) as v49, MIN(v50) as v50, MIN(v51) as v51 from aggJoin3770343935726941722;
select sum(v49+v50+v51) from res;
