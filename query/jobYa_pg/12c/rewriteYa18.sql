create or replace view tAux64 as select id as v29, title as v30 from title where production_year>=2000 and production_year<=2010;
create or replace view semiUp3074374817642843729 as select movie_id as v29, info_type_id as v26, info as v27 from movie_info_idx AS mi_idx where (info_type_id) in (select id from info_type AS it2 where info= 'rating');
create or replace view cnAux2 as select id as v1, name as v2 from company_name where country_code= '[us]';
create or replace view semiUp5446529754676831107 as select movie_id as v29, info_type_id as v21 from movie_info AS mi where (info_type_id) in (select id from info_type AS it1 where info= 'genres') and info IN ('Drama','Horror','Western','Family');
create or replace view semiUp6391945460415642524 as select v29, v26, v27 from semiUp3074374817642843729 where (v29) in (select v29 from semiUp5446529754676831107);
create or replace view mi_idxAux42 as select v29, v27 from semiUp6391945460415642524;
create or replace view semiUp523605534695549463 as select movie_id as v29, company_id as v1, company_type_id as v8 from movie_companies AS mc where (movie_id) in (select v29 from mi_idxAux42);
create or replace view semiUp9024507078180002339 as select v29, v1, v8 from semiUp523605534695549463 where (v8) in (select id from company_type AS ct where kind= 'production companies');
create or replace view semiUp1051739587432315436 as select v29, v1, v8 from semiUp9024507078180002339 where (v29) in (select v29 from tAux64);
create or replace view semiUp2675379058648997916 as select v1, v2 from cnAux2 where (v1) in (select v1 from semiUp1051739587432315436);
create or replace view semiDown7616014643857707630 as select id as v1, name as v2 from company_name AS cn where (name, id) in (select v2, v1 from semiUp2675379058648997916) and country_code= '[us]';
create or replace view semiDown8906534214965293465 as select v29, v1, v8 from semiUp1051739587432315436 where (v1) in (select v1 from semiUp2675379058648997916);
create or replace view semiDown4272107993869630367 as select id as v8 from company_type AS ct where (id) in (select v8 from semiDown8906534214965293465) and kind= 'production companies';
create or replace view semiDown128993124033793581 as select v29, v27 from mi_idxAux42 where (v29) in (select v29 from semiDown8906534214965293465);
create or replace view semiDown5146575360588487093 as select v29, v30 from tAux64 where (v29) in (select v29 from semiDown8906534214965293465);
create or replace view semiDown6327424154583500761 as select v29, v26, v27 from semiUp6391945460415642524 where (v27, v29) in (select v27, v29 from semiDown128993124033793581);
create or replace view semiDown8084197228804133450 as select id as v29, title as v30 from title AS t where (id, title) in (select v29, v30 from semiDown5146575360588487093) and production_year>=2000 and production_year<=2010;
create or replace view semiDown684863631217738569 as select id as v26 from info_type AS it2 where (id) in (select v26 from semiDown6327424154583500761) and info= 'rating';
create or replace view semiDown2781285357938909409 as select v29, v21 from semiUp5446529754676831107 where (v29) in (select v29 from semiDown6327424154583500761);
create or replace view semiDown7751887787638786264 as select id as v21 from info_type AS it1 where (id) in (select v21 from semiDown2781285357938909409) and info= 'genres';
create or replace view aggView5098251691799216649 as select v29, v30, v30 as v43 from semiDown8084197228804133450;
create or replace view aggView7155544630391118946 as select v2, v1, v2 as v41 from semiDown7616014643857707630;
create or replace view aggView2260280879008195183 as select v21 from semiDown7751887787638786264;
create or replace view aggJoin4615112716363565886 as select v29 from semiDown2781285357938909409 join aggView2260280879008195183 using(v21);
create or replace view aggView1582745426540554761 as select v26 from semiDown684863631217738569;
create or replace view aggJoin8157535861421923648 as select v29, v27 from semiDown6327424154583500761 join aggView1582745426540554761 using(v26);
create or replace view aggView8032166200703991747 as select v29 from aggJoin4615112716363565886 group by v29;
create or replace view aggJoin2592613892896992635 as select v29, v27 from aggJoin8157535861421923648 join aggView8032166200703991747 using(v29);
create or replace view aggView8995915585023757547 as select v27, v29, MIN(v27) as v42 from aggJoin2592613892896992635 group by v27,v29;
create or replace view aggView6185111924022572792 as select v8 from semiDown4272107993869630367;
create or replace view aggJoin1161007714630056404 as select v29, v1 from semiDown8906534214965293465 join aggView6185111924022572792 using(v8);
create or replace view aggView1627310324029794648 as select v29, MIN(v43) as v43 from aggView5098251691799216649 group by v29,v43;
create or replace view aggJoin8880965631727382119 as select v29, v1, v43 from aggJoin1161007714630056404 join aggView1627310324029794648 using(v29);
create or replace view aggView6546943629905023327 as select v29, MIN(v42) as v42 from aggView8995915585023757547 group by v29,v42;
create or replace view aggJoin2851607272062830910 as select v1, v43 as v43, v42 from aggJoin8880965631727382119 join aggView6546943629905023327 using(v29);
create or replace view aggView7514925467424250275 as select v1, MIN(v43) as v43, MIN(v42) as v42 from aggJoin2851607272062830910 group by v1,v42,v43;
create or replace view aggJoin5513242400404439926 as select v41 as v41, v43, v42 from aggView7155544630391118946 join aggView7514925467424250275 using(v1);
create or replace view res as select MIN(v41) as v41, MIN(v42) as v42, MIN(v43) as v43 from aggJoin5513242400404439926;
select sum(v41+v42+v43) from res;
