create or replace view semiUp7105065701331327759 as select movie_id as v29, company_id as v1, company_type_id as v8 from movie_companies AS mc where (company_type_id) in (select id from company_type AS ct where kind= 'production companies');
create or replace view semiUp3777787412761794293 as select movie_id as v29, info_type_id as v21 from movie_info AS mi where (info_type_id) in (select id from info_type AS it1 where info= 'genres') and info IN ('Drama','Horror','Western','Family');
create or replace view semiUp7084112536318868698 as select v29, v1, v8 from semiUp7105065701331327759 where (v1) in (select id from company_name AS cn where country_code= '[us]');
create or replace view semiUp6701167738093043842 as select movie_id as v29, info_type_id as v26, info as v27 from movie_info_idx AS mi_idx where (movie_id) in (select v29 from semiUp3777787412761794293) and info>'7.0';
create or replace view semiUp2525631320919523365 as select v29, v26, v27 from semiUp6701167738093043842 where (v26) in (select id from info_type AS it2 where info= 'rating');
create or replace view semiUp5747826184637093863 as select id as v29, title as v30 from title AS t where (id) in (select v29 from semiUp2525631320919523365) and production_year>=2000 and production_year<=2010;
create or replace view semiUp9088180835134682752 as select v29, v1, v8 from semiUp7084112536318868698 where (v29) in (select v29 from semiUp5747826184637093863);
create or replace view semiDown967918881613592284 as select id as v8 from company_type AS ct where (id) in (select v8 from semiUp9088180835134682752) and kind= 'production companies';
create or replace view semiDown6150156802276723126 as select id as v1, name as v2 from company_name AS cn where (id) in (select v1 from semiUp9088180835134682752) and country_code= '[us]';
create or replace view semiDown8910373736808618794 as select v29, v30 from semiUp5747826184637093863 where (v29) in (select v29 from semiUp9088180835134682752);
create or replace view semiDown5776272792368217590 as select v29, v26, v27 from semiUp2525631320919523365 where (v29) in (select v29 from semiDown8910373736808618794);
create or replace view semiDown8797011490204219952 as select id as v26 from info_type AS it2 where (id) in (select v26 from semiDown5776272792368217590) and info= 'rating';
create or replace view semiDown5367064969649553243 as select v29, v21 from semiUp3777787412761794293 where (v29) in (select v29 from semiDown5776272792368217590);
create or replace view semiDown5969852699945198440 as select id as v21 from info_type AS it1 where (id) in (select v21 from semiDown5367064969649553243) and info= 'genres';
create or replace view aggView6900194023265279200 as select v21 from semiDown5969852699945198440;
create or replace view aggJoin8133563150687213721 as select v29 from semiDown5367064969649553243 join aggView6900194023265279200 using(v21);
create or replace view aggView6443678628625739324 as select v26 from semiDown8797011490204219952;
create or replace view aggJoin6703318323940340856 as select v29, v27 from semiDown5776272792368217590 join aggView6443678628625739324 using(v26);
create or replace view aggView5636433434309351428 as select v29 from aggJoin8133563150687213721 group by v29;
create or replace view aggJoin1437769104297806506 as select v29, v27 from aggJoin6703318323940340856 join aggView5636433434309351428 using(v29);
create or replace view aggView8323995054134611402 as select v29, MIN(v27) as v42 from aggJoin1437769104297806506 group by v29;
create or replace view aggJoin8194663067418497399 as select v29, v30, v42 from semiDown8910373736808618794 join aggView8323995054134611402 using(v29);
create or replace view aggView8397304133347919905 as select v8 from semiDown967918881613592284;
create or replace view aggJoin8095354048158607003 as select v29, v1 from semiUp9088180835134682752 join aggView8397304133347919905 using(v8);
create or replace view aggView8349307790730962151 as select v29, MIN(v42) as v42, MIN(v30) as v43 from aggJoin8194663067418497399 group by v29,v42;
create or replace view aggJoin3760873669860127862 as select v1, v42, v43 from aggJoin8095354048158607003 join aggView8349307790730962151 using(v29);
create or replace view aggView7274631568908200206 as select v1, v2 as v41 from semiDown6150156802276723126;
create or replace view aggJoin8669866487780168491 as select v42, v43, v41 from aggJoin3760873669860127862 join aggView7274631568908200206 using(v1);
create or replace view res as select MIN(v41) as v41, MIN(v42) as v42, MIN(v43) as v43 from aggJoin8669866487780168491;
select sum(v41+v42+v43) from res;
