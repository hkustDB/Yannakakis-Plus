create or replace view semiUp4001025470186201114 as select id as v40, title as v41, kind_id as v26 from title AS t where (kind_id) in (select id from kind_type AS kt where kind= 'movie') and production_year>1950;
create or replace view semiUp9091987294175983011 as select movie_id as v40, subject_id as v5, status_id as v7 from complete_cast AS cc where (status_id) in (select id from comp_cast_type AS cct2 where kind LIKE '%complete%');
create or replace view semiUp8513785904457309169 as select person_id as v31, movie_id as v40, person_role_id as v9 from cast_info AS ci where (person_role_id) in (select id from char_name AS chn where ((name LIKE '%Tony%Stark%') OR (name LIKE '%Iron%Man%')) and name NOT LIKE '%Sherlock%');
create or replace view semiUp6899812876149517344 as select v31, v40, v9 from semiUp8513785904457309169 where (v31) in (select id from name AS n);
create or replace view semiUp2614658738794116080 as select v40, v5, v7 from semiUp9091987294175983011 where (v5) in (select id from comp_cast_type AS cct1 where kind= 'cast');
create or replace view semiUp8410196682448211400 as select v31, v40, v9 from semiUp6899812876149517344 where (v40) in (select v40 from semiUp2614658738794116080);
create or replace view semiUp5691754507192431609 as select movie_id as v40, keyword_id as v23 from movie_keyword AS mk where (keyword_id) in (select id from keyword AS k where keyword IN ('superhero','sequel','second-part','marvel-comics','based-on-comic','tv-special','fight','violence'));
create or replace view semiUp3813913107657128569 as select v40, v41, v26 from semiUp4001025470186201114 where (v40) in (select v40 from semiUp5691754507192431609);
create or replace view semiUp6184985584219427164 as select v31, v40, v9 from semiUp8410196682448211400 where (v40) in (select v40 from semiUp3813913107657128569);
create or replace view semiDown8732345942946922663 as select id as v9 from char_name AS chn where (id) in (select v9 from semiUp6184985584219427164) and ((name LIKE '%Tony%Stark%') OR (name LIKE '%Iron%Man%')) and name NOT LIKE '%Sherlock%';
create or replace view semiDown6428466250087181179 as select v40, v5, v7 from semiUp2614658738794116080 where (v40) in (select v40 from semiUp6184985584219427164);
create or replace view semiDown5428375591284179765 as select v40, v41, v26 from semiUp3813913107657128569 where (v40) in (select v40 from semiUp6184985584219427164);
create or replace view semiDown8192361217718638745 as select id as v31 from name AS n where (id) in (select v31 from semiUp6184985584219427164);
create or replace view semiDown2762240585582983141 as select id as v5 from comp_cast_type AS cct1 where (id) in (select v5 from semiDown6428466250087181179) and kind= 'cast';
create or replace view semiDown1036217768746730561 as select id as v7 from comp_cast_type AS cct2 where (id) in (select v7 from semiDown6428466250087181179) and kind LIKE '%complete%';
create or replace view semiDown3532159014237600628 as select id as v26 from kind_type AS kt where (id) in (select v26 from semiDown5428375591284179765) and kind= 'movie';
create or replace view semiDown6309415361898389659 as select v40, v23 from semiUp5691754507192431609 where (v40) in (select v40 from semiDown5428375591284179765);
create or replace view semiDown4020152262322512060 as select id as v23 from keyword AS k where (id) in (select v23 from semiDown6309415361898389659) and keyword IN ('superhero','sequel','second-part','marvel-comics','based-on-comic','tv-special','fight','violence');
create or replace view aggView3556665864217831581 as select v23 from semiDown4020152262322512060;
create or replace view aggJoin4348313110800735698 as select v40 from semiDown6309415361898389659 join aggView3556665864217831581 using(v23);
create or replace view aggView1841231387771532682 as select v40 from aggJoin4348313110800735698 group by v40;
create or replace view aggJoin7551688889603802649 as select v40, v41, v26 from semiDown5428375591284179765 join aggView1841231387771532682 using(v40);
create or replace view aggView3797471544219913809 as select v26 from semiDown3532159014237600628;
create or replace view aggJoin2887364503553605119 as select v40, v41 from aggJoin7551688889603802649 join aggView3797471544219913809 using(v26);
create or replace view aggView7839383062304275321 as select v5 from semiDown2762240585582983141;
create or replace view aggJoin776601702141405181 as select v40, v7 from semiDown6428466250087181179 join aggView7839383062304275321 using(v5);
create or replace view aggView7421397462740051562 as select v7 from semiDown1036217768746730561;
create or replace view aggJoin2786463606630638827 as select v40 from aggJoin776601702141405181 join aggView7421397462740051562 using(v7);
create or replace view aggView5657144095338494252 as select v9 from semiDown8732345942946922663;
create or replace view aggJoin5336517672631581852 as select v31, v40 from semiUp6184985584219427164 join aggView5657144095338494252 using(v9);
create or replace view aggView3472639623746823594 as select v40 from aggJoin2786463606630638827 group by v40;
create or replace view aggJoin7165224413975585315 as select v31, v40 from aggJoin5336517672631581852 join aggView3472639623746823594 using(v40);
create or replace view aggView5795542949022876666 as select v40, MIN(v41) as v52 from aggJoin2887364503553605119 group by v40;
create or replace view aggJoin1868313715704248432 as select v31, v52 from aggJoin7165224413975585315 join aggView5795542949022876666 using(v40);
create or replace view aggView1245984886179575532 as select v31 from semiDown8192361217718638745;
create or replace view aggJoin6477958859904808205 as select v52 from aggJoin1868313715704248432 join aggView1245984886179575532 using(v31);
create or replace view res as select MIN(v52) as v52 from aggJoin6477958859904808205;
select sum(v52) from res;
