create or replace view semiUp6117354237214280532 as select movie_id as v29, info_type_id as v26, info as v27 from movie_info_idx AS mi_idx where (info_type_id) in (select id from info_type AS it2 where info= 'rating') and info>'8.0';
create or replace view semiUp1309921124378441330 as select movie_id as v29, company_id as v1, company_type_id as v8 from movie_companies AS mc where (company_id) in (select id from company_name AS cn where country_code= '[us]');
create or replace view semiUp7057019308095857788 as select v29, v1, v8 from semiUp1309921124378441330 where (v8) in (select id from company_type AS ct where kind= 'production companies');
create or replace view semiUp6469242095852875494 as select id as v29, title as v30 from title AS t where (id) in (select v29 from semiUp6117354237214280532) and production_year<=2008 and production_year>=2005;
create or replace view semiUp8666550201939269531 as select v29, v1, v8 from semiUp7057019308095857788 where (v29) in (select v29 from semiUp6469242095852875494);
create or replace view semiUp5748109816338796379 as select movie_id as v29, info_type_id as v21 from movie_info AS mi where (info_type_id) in (select id from info_type AS it1 where info= 'genres') and info IN ('Drama','Horror');
create or replace view semiUp8973755790699148630 as select v29, v1, v8 from semiUp8666550201939269531 where (v29) in (select v29 from semiUp5748109816338796379);
create or replace view semiDown2331389779048431007 as select id as v8 from company_type AS ct where (id) in (select v8 from semiUp8973755790699148630) and kind= 'production companies';
create or replace view semiDown3547528648587582626 as select id as v1, name as v2 from company_name AS cn where (id) in (select v1 from semiUp8973755790699148630) and country_code= '[us]';
create or replace view semiDown1997201568172232754 as select v29, v21 from semiUp5748109816338796379 where (v29) in (select v29 from semiUp8973755790699148630);
create or replace view semiDown4837504353566318844 as select v29, v30 from semiUp6469242095852875494 where (v29) in (select v29 from semiUp8973755790699148630);
create or replace view semiDown7268479818993783310 as select id as v21 from info_type AS it1 where (id) in (select v21 from semiDown1997201568172232754) and info= 'genres';
create or replace view semiDown3991895242935340920 as select v29, v26, v27 from semiUp6117354237214280532 where (v29) in (select v29 from semiDown4837504353566318844);
create or replace view semiDown33420257794544462 as select id as v26 from info_type AS it2 where (id) in (select v26 from semiDown3991895242935340920) and info= 'rating';
create or replace view aggView8663161460983129784 as select v26 from semiDown33420257794544462;
create or replace view aggJoin5617697911643533361 as select v29, v27 from semiDown3991895242935340920 join aggView8663161460983129784 using(v26);
create or replace view aggView3809150202179454516 as select v29, MIN(v27) as v42 from aggJoin5617697911643533361 group by v29;
create or replace view aggJoin8225721272363262362 as select v29, v30, v42 from semiDown4837504353566318844 join aggView3809150202179454516 using(v29);
create or replace view aggView3322978100544621310 as select v21 from semiDown7268479818993783310;
create or replace view aggJoin7351663147547251196 as select v29 from semiDown1997201568172232754 join aggView3322978100544621310 using(v21);
create or replace view aggView5392954047932842473 as select v29 from aggJoin7351663147547251196 group by v29;
create or replace view aggJoin6527666822953899480 as select v29, v1, v8 from semiUp8973755790699148630 join aggView5392954047932842473 using(v29);
create or replace view aggView2433167047235138555 as select v8 from semiDown2331389779048431007;
create or replace view aggJoin8827196051547827857 as select v29, v1 from aggJoin6527666822953899480 join aggView2433167047235138555 using(v8);
create or replace view aggView3543903774962727836 as select v1, v2 as v41 from semiDown3547528648587582626;
create or replace view aggJoin1289678269604835045 as select v29, v41 from aggJoin8827196051547827857 join aggView3543903774962727836 using(v1);
create or replace view aggView6116908767671364726 as select v29, MIN(v42) as v42, MIN(v30) as v43 from aggJoin8225721272363262362 group by v29,v42;
create or replace view aggJoin7660199196861530469 as select v41 as v41, v42, v43 from aggJoin1289678269604835045 join aggView6116908767671364726 using(v29);
create or replace view res as select MIN(v41) as v41, MIN(v42) as v42, MIN(v43) as v43 from aggJoin7660199196861530469;
select sum(v41+v42+v43) from res;
