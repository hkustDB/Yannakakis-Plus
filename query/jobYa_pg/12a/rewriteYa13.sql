create or replace view tAux21 as select id as v29, title as v30 from title where production_year<=2008 and production_year>=2005;
create or replace view cnAux78 as select id as v1, name as v2 from company_name where country_code= '[us]';
create or replace view semiUp4678755937868502663 as select movie_id as v29, info_type_id as v26, info as v27 from movie_info_idx AS mi_idx where (info_type_id) in (select id from info_type AS it2 where info= 'rating') and info>'8.0';
create or replace view mi_idxAux47 as select v29, v27 from semiUp4678755937868502663;
create or replace view semiUp1733329925722801964 as select movie_id as v29, info_type_id as v21 from movie_info AS mi where (info_type_id) in (select id from info_type AS it1 where info= 'genres') and info IN ('Drama','Horror');
create or replace view semiUp6912690427421848758 as select movie_id as v29, company_id as v1, company_type_id as v8 from movie_companies AS mc where (movie_id) in (select v29 from semiUp1733329925722801964);
create or replace view semiUp9030780390742284794 as select v29, v1, v8 from semiUp6912690427421848758 where (v1) in (select v1 from cnAux78);
create or replace view semiUp8322379987381903996 as select v29, v1, v8 from semiUp9030780390742284794 where (v8) in (select id from company_type AS ct where kind= 'production companies');
create or replace view semiUp1040432447215273251 as select v29, v27 from mi_idxAux47 where (v29) in (select v29 from tAux21);
create or replace view semiUp2355694403840290249 as select v29, v27 from semiUp1040432447215273251 where (v29) in (select v29 from semiUp8322379987381903996);
create or replace view semiDown3515994872235406731 as select v29, v26, v27 from semiUp4678755937868502663 where (v29, v27) in (select v29, v27 from semiUp2355694403840290249);
create or replace view semiDown6619704194329989273 as select v29, v30 from tAux21 where (v29) in (select v29 from semiUp2355694403840290249);
create or replace view semiDown5814742379091065966 as select v29, v1, v8 from semiUp8322379987381903996 where (v29) in (select v29 from semiUp2355694403840290249);
create or replace view semiDown9050572304302613778 as select id as v26 from info_type AS it2 where (id) in (select v26 from semiDown3515994872235406731) and info= 'rating';
create or replace view semiDown8110797054732527296 as select id as v29, title as v30 from title AS t where (title, id) in (select v30, v29 from semiDown6619704194329989273) and production_year<=2008 and production_year>=2005;
create or replace view semiDown8316104649598301313 as select id as v8 from company_type AS ct where (id) in (select v8 from semiDown5814742379091065966) and kind= 'production companies';
create or replace view semiDown7762773480400026715 as select v1, v2 from cnAux78 where (v1) in (select v1 from semiDown5814742379091065966);
create or replace view semiDown622457634006392825 as select v29, v21 from semiUp1733329925722801964 where (v29) in (select v29 from semiDown5814742379091065966);
create or replace view semiDown1026019331316611242 as select id as v1, name as v2 from company_name AS cn where (id, name) in (select v1, v2 from semiDown7762773480400026715) and country_code= '[us]';
create or replace view semiDown1272718135505552368 as select id as v21 from info_type AS it1 where (id) in (select v21 from semiDown622457634006392825) and info= 'genres';
create or replace view aggView8524553957042703127 as select v1, v2, v2 as v41 from semiDown1026019331316611242;
create or replace view aggView6775997249093936252 as select v30, v29, v30 as v43 from semiDown8110797054732527296;
create or replace view aggView4065113958344523156 as select v26 from semiDown9050572304302613778;
create or replace view aggJoin1805180474743659508 as select v29, v27 from semiDown3515994872235406731 join aggView4065113958344523156 using(v26);
create or replace view aggView8335468450897575232 as select v29, v27, MIN(v27) as v42 from aggJoin1805180474743659508 group by v29,v27;
create or replace view aggView3403329266627495843 as select v21 from semiDown1272718135505552368;
create or replace view aggJoin4230363647349670309 as select v29 from semiDown622457634006392825 join aggView3403329266627495843 using(v21);
create or replace view aggView4871431656545615109 as select v29 from aggJoin4230363647349670309 group by v29;
create or replace view aggJoin1056519500450129998 as select v29, v1, v8 from semiDown5814742379091065966 join aggView4871431656545615109 using(v29);
create or replace view aggView679181195238542824 as select v8 from semiDown8316104649598301313;
create or replace view aggJoin7680229664234713034 as select v29, v1 from aggJoin1056519500450129998 join aggView679181195238542824 using(v8);
create or replace view aggView321895394350632074 as select v1, MIN(v41) as v41 from aggView8524553957042703127 group by v1,v41;
create or replace view aggJoin8601231993364750694 as select v29, v41 from aggJoin7680229664234713034 join aggView321895394350632074 using(v1);
create or replace view aggView1352866188585679347 as select v29, MIN(v43) as v43 from aggView6775997249093936252 group by v29,v43;
create or replace view aggJoin8352575158833063424 as select v29, v42 as v42, v43 from aggView8335468450897575232 join aggView1352866188585679347 using(v29);
create or replace view aggView4200052615219148666 as select v29, MIN(v41) as v41 from aggJoin8601231993364750694 group by v29,v41;
create or replace view aggJoin4151226090729581185 as select v42 as v42, v43 as v43, v41 from aggJoin8352575158833063424 join aggView4200052615219148666 using(v29);
create or replace view res as select MIN(v41) as v41, MIN(v42) as v42, MIN(v43) as v43 from aggJoin4151226090729581185;
select sum(v41+v42+v43) from res;
