create or replace view semiUp533132840832398317 as select movie_id as v22, info_type_id as v12 from movie_info AS mi where (info_type_id) in (select id from info_type AS it2 where info= 'release dates');
create or replace view semiUp4290088456711003648 as select movie_id as v22, info_type_id as v10, info as v29 from movie_info_idx AS miidx where (movie_id) in (select v22 from semiUp533132840832398317);
create or replace view semiUp4955304807440328334 as select v22, v10, v29 from semiUp4290088456711003648 where (v10) in (select id from info_type AS it where info= 'rating');
create or replace view semiUp3113701803209303980 as select id as v22, title as v32, kind_id as v14 from title AS t where (kind_id) in (select id from kind_type AS kt where kind= 'movie');
create or replace view semiUp8659532633196706887 as select movie_id as v22, company_id as v1, company_type_id as v8 from movie_companies AS mc where (company_id) in (select id from company_name AS cn where country_code= '[us]');
create or replace view semiUp5054332453048363514 as select v22, v32, v14 from semiUp3113701803209303980 where (v22) in (select v22 from semiUp4955304807440328334);
create or replace view semiUp4613023283869279132 as select v22, v1, v8 from semiUp8659532633196706887 where (v22) in (select v22 from semiUp5054332453048363514);
create or replace view semiUp927058478359431600 as select id as v8 from company_type AS ct where (id) in (select v8 from semiUp4613023283869279132) and kind= 'production companies';
create or replace view semiDown2790218504197068964 as select v22, v1, v8 from semiUp4613023283869279132 where (v8) in (select v8 from semiUp927058478359431600);
create or replace view semiDown5597867947799151132 as select id as v1, name as v2 from company_name AS cn where (id) in (select v1 from semiDown2790218504197068964) and country_code= '[us]';
create or replace view semiDown8132570037863099198 as select v22, v32, v14 from semiUp5054332453048363514 where (v22) in (select v22 from semiDown2790218504197068964);
create or replace view semiDown1596254523892837432 as select v22, v10, v29 from semiUp4955304807440328334 where (v22) in (select v22 from semiDown8132570037863099198);
create or replace view semiDown5943171163544519000 as select id as v14 from kind_type AS kt where (id) in (select v14 from semiDown8132570037863099198) and kind= 'movie';
create or replace view semiDown5978682310306818007 as select id as v10 from info_type AS it where (id) in (select v10 from semiDown1596254523892837432) and info= 'rating';
create or replace view semiDown1255321226472131277 as select v22, v12 from semiUp533132840832398317 where (v22) in (select v22 from semiDown1596254523892837432);
create or replace view semiDown205018866462233153 as select id as v12 from info_type AS it2 where (id) in (select v12 from semiDown1255321226472131277) and info= 'release dates';
create or replace view aggView5092586353207300770 as select v10 from semiDown5978682310306818007;
create or replace view aggJoin794892628945058923 as select v22, v29 from semiDown1596254523892837432 join aggView5092586353207300770 using(v10);
create or replace view aggView4806378899329316535 as select v14 from semiDown5943171163544519000;
create or replace view aggJoin4315431810601596618 as select v22, v32 from semiDown8132570037863099198 join aggView4806378899329316535 using(v14);
create or replace view aggView2819264571884381006 as select v12 from semiDown205018866462233153;
create or replace view aggJoin7772087918382472912 as select v22 from semiDown1255321226472131277 join aggView2819264571884381006 using(v12);
create or replace view aggView6860148734631675478 as select v22 from aggJoin7772087918382472912 group by v22;
create or replace view aggJoin1844594177473994769 as select v22, v29 from aggJoin794892628945058923 join aggView6860148734631675478 using(v22);
create or replace view aggView2582930083796923286 as select v1, v2 as v43 from semiDown5597867947799151132;
create or replace view aggJoin4810227323045737452 as select v22, v8, v43 from semiDown2790218504197068964 join aggView2582930083796923286 using(v1);
create or replace view aggView6569632580201317447 as select v22, MIN(v29) as v44 from aggJoin1844594177473994769 group by v22;
create or replace view aggJoin218386877581288259 as select v22, v32, v44 from aggJoin4315431810601596618 join aggView6569632580201317447 using(v22);
create or replace view aggView5263506791779244064 as select v22, MIN(v44) as v44, MIN(v32) as v45 from aggJoin218386877581288259 group by v22;
create or replace view aggJoin2337641843314134005 as select v8, v43 as v43, v44, v45 from aggJoin4810227323045737452 join aggView5263506791779244064 using(v22);
create or replace view aggView7480837921028323449 as select v8, MIN(v43) as v43, MIN(v44) as v44, MIN(v45) as v45 from aggJoin2337641843314134005 group by v8;
create or replace view aggJoin4383218919964439122 as select v43, v44, v45 from semiUp927058478359431600 join aggView7480837921028323449 using(v8);
create or replace view res as select MIN(v43) as v43, MIN(v44) as v44, MIN(v45) as v45 from aggJoin4383218919964439122;
select sum(v43+v44+v45) from res;
