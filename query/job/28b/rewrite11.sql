create or replace view aggView1093679121972253689 as select id as v9, name as v10 from company_name as cn where country_code<> '[us]';
create or replace view aggView341494524368992524 as select id as v5 from comp_cast_type as cct1 where kind= 'crew';
create or replace view aggJoin7677433549963264327 as select movie_id as v45, status_id as v7 from complete_cast as cc, aggView341494524368992524 where cc.subject_id=aggView341494524368992524.v5;
create or replace view aggView6518674297321978363 as select id as v20 from info_type as it2 where info= 'rating';
create or replace view aggJoin5340781482958616774 as select movie_id as v45, info as v40 from movie_info_idx as mi_idx, aggView6518674297321978363 where mi_idx.info_type_id=aggView6518674297321978363.v20;
create or replace view aggView7627568442996616559 as select id as v25 from kind_type as kt where kind IN ('movie','episode');
create or replace view aggJoin4894622994436715495 as select id as v45, title as v46, production_year as v49 from title as t, aggView7627568442996616559 where t.kind_id=aggView7627568442996616559.v25 and production_year>2005;
create or replace view aggView1749152709617468025 as select id as v7 from comp_cast_type as cct2 where kind<> 'complete+verified';
create or replace view aggJoin7098708705496487465 as select v45 from aggJoin7677433549963264327 join aggView1749152709617468025 using(v7);
create or replace view aggView6934652517889742038 as select v45 from aggJoin7098708705496487465 group by v45;
create or replace view aggJoin8100673627449991964 as select movie_id as v45, keyword_id as v22 from movie_keyword as mk, aggView6934652517889742038 where mk.movie_id=aggView6934652517889742038.v45;
create or replace view aggView5600344724763438333 as select id as v22 from keyword as k where keyword IN ('murder','murder-in-title','blood','violence');
create or replace view aggJoin1130297450339825911 as select v45 from aggJoin8100673627449991964 join aggView5600344724763438333 using(v22);
create or replace view aggView7115346546764788492 as select v45 from aggJoin1130297450339825911 group by v45;
create or replace view aggJoin5866421802080839317 as select v45, v46, v49 from aggJoin4894622994436715495 join aggView7115346546764788492 using(v45);
create or replace view aggView9220215686592369766 as select v45, v46 from aggJoin5866421802080839317 group by v45,v46;
create or replace view aggView2746195407172554141 as select id as v18 from info_type as it1 where info= 'countries';
create or replace view aggJoin5043518127342835717 as select movie_id as v45, info as v35 from movie_info as mi, aggView2746195407172554141 where mi.info_type_id=aggView2746195407172554141.v18 and info IN ('Sweden','Germany','Swedish','German');
create or replace view aggView3866658042769363100 as select v45 from aggJoin5043518127342835717 group by v45;
create or replace view aggJoin1496825333974639227 as select v45, v40 from aggJoin5340781482958616774 join aggView3866658042769363100 using(v45);
create or replace view aggView2080010282964266769 as select v40, v45 from aggJoin1496825333974639227 group by v40,v45;
create or replace view aggJoin20580101104643478 as select v45, v40 from aggView2080010282964266769 where v40>'6.5';
create or replace view aggView2434389503697247308 as select v45, MIN(v46) as v59 from aggView9220215686592369766 group by v45;
create or replace view aggJoin6037023288705829457 as select v45, v40, v59 from aggJoin20580101104643478 join aggView2434389503697247308 using(v45);
create or replace view aggView2578240195480292962 as select v45, MIN(v59) as v59, MIN(v40) as v58 from aggJoin6037023288705829457 group by v45,v59;
create or replace view aggJoin3262847587226014679 as select company_id as v9, company_type_id as v16, note as v31, v59, v58 from movie_companies as mc, aggView2578240195480292962 where mc.movie_id=aggView2578240195480292962.v45 and note NOT LIKE '%(USA)%' and note LIKE '%(200%)%';
create or replace view aggView3886262585795972127 as select id as v16 from company_type as ct;
create or replace view aggJoin328885357101363391 as select v9, v31, v59, v58 from aggJoin3262847587226014679 join aggView3886262585795972127 using(v16);
create or replace view aggView9216385231959487014 as select v9, MIN(v59) as v59, MIN(v58) as v58 from aggJoin328885357101363391 group by v9,v59,v58;
create or replace view aggJoin5829053430981148483 as select v10, v59, v58 from aggView1093679121972253689 join aggView9216385231959487014 using(v9);
select MIN(v10) as v57,MIN(v58) as v58,MIN(v59) as v59 from aggJoin5829053430981148483;
