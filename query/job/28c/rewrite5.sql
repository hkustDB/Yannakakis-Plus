create or replace view aggView4350011798732010399 as select name as v10, id as v9 from company_name as cn where country_code<> '[us]';
create or replace view aggView2606171051903854182 as select id as v20 from info_type as it2 where info= 'rating';
create or replace view aggJoin6590323027890308250 as select movie_id as v45, info as v40 from movie_info_idx as mi_idx, aggView2606171051903854182 where mi_idx.info_type_id=aggView2606171051903854182.v20;
create or replace view aggView4749677919024186255 as select id as v5 from comp_cast_type as cct1 where kind= 'cast';
create or replace view aggJoin6198325298576258824 as select movie_id as v45, status_id as v7 from complete_cast as cc, aggView4749677919024186255 where cc.subject_id=aggView4749677919024186255.v5;
create or replace view aggView257601574494253013 as select id as v25 from kind_type as kt where kind IN ('movie','episode');
create or replace view aggJoin7198270796678686594 as select id as v45, title as v46, production_year as v49 from title as t, aggView257601574494253013 where t.kind_id=aggView257601574494253013.v25 and production_year>2005;
create or replace view aggView1326478964625003802 as select id as v7 from comp_cast_type as cct2 where kind= 'complete';
create or replace view aggJoin8113018301287632496 as select v45 from aggJoin6198325298576258824 join aggView1326478964625003802 using(v7);
create or replace view aggView1842906114088766002 as select v45 from aggJoin8113018301287632496 group by v45;
create or replace view aggJoin559770302342297911 as select v45, v46, v49 from aggJoin7198270796678686594 join aggView1842906114088766002 using(v45);
create or replace view aggView5199271854481322088 as select v46, v45 from aggJoin559770302342297911 group by v46,v45;
create or replace view aggView7627222237354196637 as select id as v18 from info_type as it1 where info= 'countries';
create or replace view aggJoin7828006667937125021 as select movie_id as v45, info as v35 from movie_info as mi, aggView7627222237354196637 where mi.info_type_id=aggView7627222237354196637.v18 and info IN ('Sweden','Norway','Germany','Denmark','Swedish','Danish','Norwegian','German','USA','American');
create or replace view aggView2331371317544788477 as select v45 from aggJoin7828006667937125021 group by v45;
create or replace view aggJoin4988899397822326814 as select movie_id as v45, keyword_id as v22 from movie_keyword as mk, aggView2331371317544788477 where mk.movie_id=aggView2331371317544788477.v45;
create or replace view aggView6895832898029666736 as select id as v22 from keyword as k where keyword IN ('murder','murder-in-title','blood','violence');
create or replace view aggJoin5933770905370304008 as select v45 from aggJoin4988899397822326814 join aggView6895832898029666736 using(v22);
create or replace view aggView2858192591127406079 as select v45 from aggJoin5933770905370304008 group by v45;
create or replace view aggJoin6592680755694226516 as select v45, v40 from aggJoin6590323027890308250 join aggView2858192591127406079 using(v45);
create or replace view aggView7790441396863648391 as select v40, v45 from aggJoin6592680755694226516 group by v40,v45;
create or replace view aggJoin817842799130706402 as select v45, v40 from aggView7790441396863648391 where v40<'8.5';
create or replace view aggView8622101529519131955 as select v45, MIN(v40) as v58 from aggJoin817842799130706402 group by v45;
create or replace view aggJoin1007393167734737914 as select v46, v45, v58 from aggView5199271854481322088 join aggView8622101529519131955 using(v45);
create or replace view aggView3763294827057030422 as select v45, MIN(v58) as v58, MIN(v46) as v59 from aggJoin1007393167734737914 group by v45,v58;
create or replace view aggJoin2350294932787827005 as select company_id as v9, company_type_id as v16, note as v31, v58, v59 from movie_companies as mc, aggView3763294827057030422 where mc.movie_id=aggView3763294827057030422.v45 and note NOT LIKE '%(USA)%' and note LIKE '%(200%)%';
create or replace view aggView4435568809320938999 as select id as v16 from company_type as ct;
create or replace view aggJoin6229952285595749845 as select v9, v31, v58, v59 from aggJoin2350294932787827005 join aggView4435568809320938999 using(v16);
create or replace view aggView691074686189933979 as select v9, MIN(v58) as v58, MIN(v59) as v59 from aggJoin6229952285595749845 group by v9,v58,v59;
create or replace view aggJoin4520893943998032166 as select v10, v58, v59 from aggView4350011798732010399 join aggView691074686189933979 using(v9);
select MIN(v10) as v57,MIN(v58) as v58,MIN(v59) as v59 from aggJoin4520893943998032166;
