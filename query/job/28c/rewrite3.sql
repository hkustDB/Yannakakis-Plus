create or replace view aggView6936333164527121353 as select id as v9, name as v57 from company_name as cn where country_code<> '[us]';
create or replace view aggJoin408878080345610239 as select movie_id as v45, company_type_id as v16, note as v31, v57 from movie_companies as mc, aggView6936333164527121353 where mc.company_id=aggView6936333164527121353.v9 and note NOT LIKE '%(USA)%' and note LIKE '%(200%)%';
create or replace view aggView8129756190748917069 as select id as v5 from comp_cast_type as cct1 where kind= 'cast';
create or replace view aggJoin1759259610616312160 as select movie_id as v45, status_id as v7 from complete_cast as cc, aggView8129756190748917069 where cc.subject_id=aggView8129756190748917069.v5;
create or replace view aggView7099847680390303622 as select id as v20 from info_type as it2 where info= 'rating';
create or replace view aggJoin8441395956350856029 as select movie_id as v45, info as v40 from movie_info_idx as mi_idx, aggView7099847680390303622 where mi_idx.info_type_id=aggView7099847680390303622.v20 and info<'8.5';
create or replace view aggView6847391199432390161 as select id as v25 from kind_type as kt where kind IN ('movie','episode');
create or replace view aggJoin8718204174701061764 as select id as v45, title as v46 from title as t, aggView6847391199432390161 where t.kind_id=aggView6847391199432390161.v25 and production_year>2005;
create or replace view aggView1038268672628398490 as select id as v18 from info_type as it1 where info= 'countries';
create or replace view aggJoin3417509233305965419 as select movie_id as v45 from movie_info as mi, aggView1038268672628398490 where mi.info_type_id=aggView1038268672628398490.v18 and info IN ('Sweden','Norway','Germany','Denmark','Swedish','Danish','Norwegian','German','USA','American');
create or replace view aggView1279814164537321683 as select id as v22 from keyword as k where keyword IN ('murder','murder-in-title','blood','violence');
create or replace view aggJoin8991956937168655015 as select movie_id as v45 from movie_keyword as mk, aggView1279814164537321683 where mk.keyword_id=aggView1279814164537321683.v22;
create or replace view aggView2025441607992583248 as select id as v7 from comp_cast_type as cct2 where kind= 'complete';
create or replace view aggJoin5744868344046790509 as select v45 from aggJoin1759259610616312160 join aggView2025441607992583248 using(v7);
create or replace view aggView8776415195819870060 as select v45 from aggJoin5744868344046790509 group by v45;
create or replace view aggJoin1186875889969037794 as select v45 from aggJoin3417509233305965419 join aggView8776415195819870060 using(v45);
create or replace view aggView8840545453727742501 as select v45 from aggJoin1186875889969037794 group by v45;
create or replace view aggJoin1632785446364915295 as select v45, v46 from aggJoin8718204174701061764 join aggView8840545453727742501 using(v45);
create or replace view aggView1894306904719321711 as select v45, MIN(v46) as v59 from aggJoin1632785446364915295 group by v45;
create or replace view aggJoin5781962543873988970 as select v45, v59 from aggJoin8991956937168655015 join aggView1894306904719321711 using(v45);
create or replace view aggView1203394318592353470 as select v45, MIN(v59) as v59 from aggJoin5781962543873988970 group by v45;
create or replace view aggJoin2088064623953237282 as select v45, v40, v59 from aggJoin8441395956350856029 join aggView1203394318592353470 using(v45);
create or replace view aggView8751646427965349635 as select v45, MIN(v59) as v59, MIN(v40) as v58 from aggJoin2088064623953237282 group by v45;
create or replace view aggJoin1132718279629037228 as select v16, v57 as v57, v59, v58 from aggJoin408878080345610239 join aggView8751646427965349635 using(v45);
create or replace view aggView7021862242718425138 as select v16, MIN(v57) as v57, MIN(v59) as v59, MIN(v58) as v58 from aggJoin1132718279629037228 group by v16;
create or replace view aggJoin4932731622839815180 as select v57, v59, v58 from company_type as ct, aggView7021862242718425138 where ct.id=aggView7021862242718425138.v16;
create or replace view res as select MIN(v57) as v57, MIN(v58) as v58, MIN(v59) as v59 from aggJoin4932731622839815180;
select sum(v57+v58+v59) from res;