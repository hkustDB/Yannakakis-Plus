create or replace view aggView6724297764152501195 as select id as v9, name as v57 from company_name as cn where country_code<> '[us]';
create or replace view aggJoin5390260839209410436 as select movie_id as v45, company_type_id as v16, note as v31, v57 from movie_companies as mc, aggView6724297764152501195 where mc.company_id=aggView6724297764152501195.v9 and note NOT LIKE '%(USA)%' and note LIKE '%(200%)%';
create or replace view aggView5852824727551215274 as select id as v5 from comp_cast_type as cct1 where kind= 'cast';
create or replace view aggJoin4380222987064413225 as select movie_id as v45, status_id as v7 from complete_cast as cc, aggView5852824727551215274 where cc.subject_id=aggView5852824727551215274.v5;
create or replace view aggView2285162127326704201 as select id as v25 from kind_type as kt where kind IN ('movie','episode');
create or replace view aggJoin3154880765185193089 as select id as v45, title as v46 from title as t, aggView2285162127326704201 where t.kind_id=aggView2285162127326704201.v25 and production_year>2005;
create or replace view aggView2615517688310429882 as select id as v16 from company_type as ct;
create or replace view aggJoin4273455269976843710 as select v45, v57 from aggJoin5390260839209410436 join aggView2615517688310429882 using(v16);
create or replace view aggView4513967931628890443 as select v45, MIN(v57) as v57 from aggJoin4273455269976843710 group by v45;
create or replace view aggJoin8264762995888078529 as select movie_id as v45, info_type_id as v20, info as v40, v57 from movie_info_idx as mi_idx, aggView4513967931628890443 where mi_idx.movie_id=aggView4513967931628890443.v45 and info<'8.5';
create or replace view aggView5489592369736135597 as select id as v18 from info_type as it1 where info= 'countries';
create or replace view aggJoin8354910865726333894 as select movie_id as v45 from movie_info as mi, aggView5489592369736135597 where mi.info_type_id=aggView5489592369736135597.v18 and info IN ('Sweden','Norway','Germany','Denmark','Swedish','Danish','Norwegian','German','USA','American');
create or replace view aggView7100620235067908388 as select id as v22 from keyword as k where keyword IN ('murder','murder-in-title','blood','violence');
create or replace view aggJoin237421356268178519 as select movie_id as v45 from movie_keyword as mk, aggView7100620235067908388 where mk.keyword_id=aggView7100620235067908388.v22;
create or replace view aggView3739898825099045485 as select id as v7 from comp_cast_type as cct2 where kind= 'complete';
create or replace view aggJoin2083123862865536103 as select v45 from aggJoin4380222987064413225 join aggView3739898825099045485 using(v7);
create or replace view aggView5581182694474715950 as select v45 from aggJoin2083123862865536103 group by v45;
create or replace view aggJoin5797896593137091065 as select v45, v46 from aggJoin3154880765185193089 join aggView5581182694474715950 using(v45);
create or replace view aggView8080749423049943616 as select v45, MIN(v46) as v59 from aggJoin5797896593137091065 group by v45;
create or replace view aggJoin95665962463894014 as select v45, v59 from aggJoin8354910865726333894 join aggView8080749423049943616 using(v45);
create or replace view aggView3448923781581056496 as select v45, MIN(v59) as v59 from aggJoin95665962463894014 group by v45;
create or replace view aggJoin5606365618919854903 as select v45, v59 from aggJoin237421356268178519 join aggView3448923781581056496 using(v45);
create or replace view aggView2785981699227977777 as select v45, MIN(v59) as v59 from aggJoin5606365618919854903 group by v45;
create or replace view aggJoin5046314465113925435 as select v20, v40, v57 as v57, v59 from aggJoin8264762995888078529 join aggView2785981699227977777 using(v45);
create or replace view aggView1969314941048052959 as select v20, MIN(v57) as v57, MIN(v59) as v59, MIN(v40) as v58 from aggJoin5046314465113925435 group by v20;
create or replace view aggJoin1541302264990347222 as select v57, v59, v58 from info_type as it2, aggView1969314941048052959 where it2.id=aggView1969314941048052959.v20 and info= 'rating';
create or replace view res as select MIN(v57) as v57, MIN(v58) as v58, MIN(v59) as v59 from aggJoin1541302264990347222;
select sum(v57+v58+v59) from res;