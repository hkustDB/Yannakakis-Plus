create or replace view aggView3778709341190789600 as select id as v9, name as v57 from company_name as cn where country_code<> '[us]';
create or replace view aggJoin3724195296033079848 as select movie_id as v45, company_type_id as v16, note as v31, v57 from movie_companies as mc, aggView3778709341190789600 where mc.company_id=aggView3778709341190789600.v9 and note NOT LIKE '%(USA)%' and note LIKE '%(200%)%';
create or replace view aggView9135882068078667083 as select id as v5 from comp_cast_type as cct1 where kind= 'cast';
create or replace view aggJoin7661543268550156505 as select movie_id as v45, status_id as v7 from complete_cast as cc, aggView9135882068078667083 where cc.subject_id=aggView9135882068078667083.v5;
create or replace view aggView8243913423730779168 as select id as v25 from kind_type as kt where kind IN ('movie','episode');
create or replace view aggJoin6860208931964039962 as select id as v45, title as v46 from title as t, aggView8243913423730779168 where t.kind_id=aggView8243913423730779168.v25 and production_year>2005;
create or replace view aggView2845031151573480833 as select id as v16 from company_type as ct;
create or replace view aggJoin8130363844941852747 as select v45, v57 from aggJoin3724195296033079848 join aggView2845031151573480833 using(v16);
create or replace view aggView4115893042801249866 as select v45, MIN(v57) as v57 from aggJoin8130363844941852747 group by v45;
create or replace view aggJoin6431178339374017876 as select movie_id as v45, keyword_id as v22, v57 from movie_keyword as mk, aggView4115893042801249866 where mk.movie_id=aggView4115893042801249866.v45;
create or replace view aggView1205122106490729542 as select id as v22 from keyword as k where keyword IN ('murder','murder-in-title','blood','violence');
create or replace view aggJoin3309600003898097922 as select v45, v57 from aggJoin6431178339374017876 join aggView1205122106490729542 using(v22);
create or replace view aggView7318529239355266721 as select v45, MIN(v57) as v57 from aggJoin3309600003898097922 group by v45;
create or replace view aggJoin2471614512918324083 as select movie_id as v45, info_type_id as v18, v57 from movie_info as mi, aggView7318529239355266721 where mi.movie_id=aggView7318529239355266721.v45 and info IN ('Sweden','Norway','Germany','Denmark','Swedish','Danish','Norwegian','German','USA','American');
create or replace view aggView8055143794679024717 as select id as v18 from info_type as it1 where info= 'countries';
create or replace view aggJoin8341257618610238251 as select v45, v57 from aggJoin2471614512918324083 join aggView8055143794679024717 using(v18);
create or replace view aggView6517912783970719695 as select v45, MIN(v57) as v57 from aggJoin8341257618610238251 group by v45;
create or replace view aggJoin6137231246883350041 as select movie_id as v45, info_type_id as v20, info as v40, v57 from movie_info_idx as mi_idx, aggView6517912783970719695 where mi_idx.movie_id=aggView6517912783970719695.v45 and info<'8.5';
create or replace view aggView8892435245732626066 as select id as v7 from comp_cast_type as cct2 where kind= 'complete';
create or replace view aggJoin7537662582288283966 as select v45 from aggJoin7661543268550156505 join aggView8892435245732626066 using(v7);
create or replace view aggView7317601000204976350 as select v45 from aggJoin7537662582288283966 group by v45;
create or replace view aggJoin8187544555485401184 as select v45, v46 from aggJoin6860208931964039962 join aggView7317601000204976350 using(v45);
create or replace view aggView5936465674374220449 as select v45, MIN(v46) as v59 from aggJoin8187544555485401184 group by v45;
create or replace view aggJoin1348601086681081716 as select v20, v40, v57 as v57, v59 from aggJoin6137231246883350041 join aggView5936465674374220449 using(v45);
create or replace view aggView4157493137091550240 as select v20, MIN(v57) as v57, MIN(v59) as v59, MIN(v40) as v58 from aggJoin1348601086681081716 group by v20;
create or replace view aggJoin2150091226604756515 as select v57, v59, v58 from info_type as it2, aggView4157493137091550240 where it2.id=aggView4157493137091550240.v20 and info= 'rating';
create or replace view res as select MIN(v57) as v57, MIN(v58) as v58, MIN(v59) as v59 from aggJoin2150091226604756515;
select sum(v57+v58+v59) from res;