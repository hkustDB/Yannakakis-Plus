create or replace view aggView8020213907818389371 as select name as v10, id as v9 from company_name as cn where country_code<> '[us]';
create or replace view aggView1715888108279452457 as select id as v20 from info_type as it2 where info= 'rating';
create or replace view aggJoin6760988460513247653 as select movie_id as v45, info as v40 from movie_info_idx as mi_idx, aggView1715888108279452457 where mi_idx.info_type_id=aggView1715888108279452457.v20;
create or replace view aggView2634073600857221881 as select id as v5 from comp_cast_type as cct1 where kind= 'cast';
create or replace view aggJoin4905697067120733395 as select movie_id as v45, status_id as v7 from complete_cast as cc, aggView2634073600857221881 where cc.subject_id=aggView2634073600857221881.v5;
create or replace view aggView8794057469004096735 as select id as v25 from kind_type as kt where kind IN ('movie','episode');
create or replace view aggJoin9059482831954729091 as select id as v45, title as v46, production_year as v49 from title as t, aggView8794057469004096735 where t.kind_id=aggView8794057469004096735.v25 and production_year>2005;
create or replace view aggView8381947487929850618 as select id as v7 from comp_cast_type as cct2 where kind= 'complete';
create or replace view aggJoin1195344423370645104 as select v45 from aggJoin4905697067120733395 join aggView8381947487929850618 using(v7);
create or replace view aggView6320793355988238169 as select id as v18 from info_type as it1 where info= 'countries';
create or replace view aggJoin7182716300275685066 as select movie_id as v45, info as v35 from movie_info as mi, aggView6320793355988238169 where mi.info_type_id=aggView6320793355988238169.v18 and info IN ('Sweden','Norway','Germany','Denmark','Swedish','Danish','Norwegian','German','USA','American');
create or replace view aggView4791872950318972495 as select v45 from aggJoin1195344423370645104 group by v45;
create or replace view aggJoin5761580319492511737 as select v45, v35 from aggJoin7182716300275685066 join aggView4791872950318972495 using(v45);
create or replace view aggView8894431587668666757 as select v45 from aggJoin5761580319492511737 group by v45;
create or replace view aggJoin468504307364630001 as select v45, v40 from aggJoin6760988460513247653 join aggView8894431587668666757 using(v45);
create or replace view aggView3968547601483880752 as select v40, v45 from aggJoin468504307364630001 group by v40,v45;
create or replace view aggJoin4072756025434203578 as select v45, v40 from aggView3968547601483880752 where v40<'8.5';
create or replace view aggView1863107802686186352 as select id as v22 from keyword as k where keyword IN ('murder','murder-in-title','blood','violence');
create or replace view aggJoin1968869344972440749 as select movie_id as v45 from movie_keyword as mk, aggView1863107802686186352 where mk.keyword_id=aggView1863107802686186352.v22;
create or replace view aggView2369403721859981629 as select v45 from aggJoin1968869344972440749 group by v45;
create or replace view aggJoin5050624323180063388 as select v45, v46, v49 from aggJoin9059482831954729091 join aggView2369403721859981629 using(v45);
create or replace view aggView7568591176743691734 as select v46, v45 from aggJoin5050624323180063388 group by v46,v45;
create or replace view aggView8894302863640407991 as select v45, MIN(v46) as v59 from aggView7568591176743691734 group by v45;
create or replace view aggJoin4280193844282873957 as select v45, v40, v59 from aggJoin4072756025434203578 join aggView8894302863640407991 using(v45);
create or replace view aggView1489411938127276681 as select v45, MIN(v59) as v59, MIN(v40) as v58 from aggJoin4280193844282873957 group by v45,v59;
create or replace view aggJoin6756421682947024160 as select company_id as v9, company_type_id as v16, note as v31, v59, v58 from movie_companies as mc, aggView1489411938127276681 where mc.movie_id=aggView1489411938127276681.v45 and note NOT LIKE '%(USA)%' and note LIKE '%(200%)%';
create or replace view aggView3111150373301023972 as select id as v16 from company_type as ct;
create or replace view aggJoin8625808034060203690 as select v9, v31, v59, v58 from aggJoin6756421682947024160 join aggView3111150373301023972 using(v16);
create or replace view aggView5761543342244940357 as select v9, MIN(v59) as v59, MIN(v58) as v58 from aggJoin8625808034060203690 group by v9,v58,v59;
create or replace view aggJoin4074415701931609945 as select v10, v59, v58 from aggView8020213907818389371 join aggView5761543342244940357 using(v9);
select MIN(v10) as v57,MIN(v58) as v58,MIN(v59) as v59 from aggJoin4074415701931609945;
