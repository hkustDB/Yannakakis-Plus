create or replace view aggView3184808225219432700 as select id as v40, name as v63 from name as n where gender= 'm';
create or replace view aggJoin8147162266221155021 as select movie_id as v49, note as v5, v63 from cast_info as ci, aggView3184808225219432700 where ci.person_id=aggView3184808225219432700.v40 and note IN ('(writer)','(head writer)','(written by)','(story)','(story editor)');
create or replace view aggView9104154535959410230 as select id as v17 from info_type as it2 where info= 'votes';
create or replace view aggJoin4819767062281061819 as select movie_id as v49, info as v35 from movie_info_idx as mi_idx, aggView9104154535959410230 where mi_idx.info_type_id=aggView9104154535959410230.v17;
create or replace view aggView1215851102990826388 as select v49, MIN(v35) as v62 from aggJoin4819767062281061819 group by v49;
create or replace view aggJoin1074937162996621692 as select movie_id as v49, keyword_id as v19, v62 from movie_keyword as mk, aggView1215851102990826388 where mk.movie_id=aggView1215851102990826388.v49;
create or replace view aggView3155592153724420204 as select id as v15 from info_type as it1 where info= 'genres';
create or replace view aggJoin4963821658802030351 as select movie_id as v49, info as v30 from movie_info as mi, aggView3155592153724420204 where mi.info_type_id=aggView3155592153724420204.v15 and info IN ('Horror','Thriller');
create or replace view aggView2447402446009739611 as select id as v19 from keyword as k where keyword IN ('murder','violence','blood','gore','death','female-nudity','hospital');
create or replace view aggJoin2621661625293979809 as select v49, v62 from aggJoin1074937162996621692 join aggView2447402446009739611 using(v19);
create or replace view aggView3594437923439122191 as select v49, MIN(v62) as v62 from aggJoin2621661625293979809 group by v49;
create or replace view aggJoin6460376725178571614 as select v49, v5, v63 as v63, v62 from aggJoin8147162266221155021 join aggView3594437923439122191 using(v49);
create or replace view aggView5989512238989051265 as select v49, MIN(v63) as v63, MIN(v62) as v62 from aggJoin6460376725178571614 group by v49;
create or replace view aggJoin4952288325729758857 as select v49, v30, v63, v62 from aggJoin4963821658802030351 join aggView5989512238989051265 using(v49);
create or replace view aggView7691000474695880040 as select v49, MIN(v63) as v63, MIN(v62) as v62, MIN(v30) as v61 from aggJoin4952288325729758857 group by v49;
create or replace view aggJoin7446744074968048456 as select id as v49, title as v50, production_year as v53, v63, v62, v61 from title as t, aggView7691000474695880040 where t.id=aggView7691000474695880040.v49 and production_year>2000 and ((title LIKE '%Freddy%') OR (title LIKE '%Jason%'));
create or replace view aggView1979791388542278401 as select v49, MIN(v63) as v63, MIN(v62) as v62, MIN(v61) as v61, MIN(v50) as v64 from aggJoin7446744074968048456 group by v49;
create or replace view aggJoin6662047460231378999 as select company_id as v8, note as v26, v63, v62, v61, v64 from movie_companies as mc, aggView1979791388542278401 where mc.movie_id=aggView1979791388542278401.v49 and note LIKE '%(Blu-ray)%';
create or replace view aggView1679772520681374653 as select v8, MIN(v63) as v63, MIN(v62) as v62, MIN(v61) as v61, MIN(v64) as v64 from aggJoin6662047460231378999 group by v8;
create or replace view aggJoin3843872092728167161 as select name as v9, v63, v62, v61, v64 from company_name as cn, aggView1679772520681374653 where cn.id=aggView1679772520681374653.v8 and name LIKE 'Lionsgate%';
create or replace view res as select MIN(v61) as v61, MIN(v62) as v62, MIN(v63) as v63, MIN(v64) as v64 from aggJoin3843872092728167161;
select sum(v61+v62+v63+v64) from res;