create or replace view semiUp6934042431653552096 as select person_id as v40, movie_id as v49 from cast_info AS ci where (person_id) in (select id from name AS n where gender= 'm') and note IN ('(writer)','(head writer)','(written by)','(story)','(story editor)');
create or replace view semiUp4446363418984609232 as select movie_id as v49, keyword_id as v19 from movie_keyword AS mk where (keyword_id) in (select id from keyword AS k where keyword IN ('murder','violence','blood','gore','death','female-nudity','hospital'));
create or replace view semiUp6195451960092061936 as select movie_id as v49, info_type_id as v15, info as v30 from movie_info AS mi where (info_type_id) in (select id from info_type AS it1 where info= 'genres') and info IN ('Horror','Thriller');
create or replace view semiUp5238525408935059322 as select v49, v19 from semiUp4446363418984609232 where (v49) in (select v49 from semiUp6195451960092061936);
create or replace view semiUp5416632700218423785 as select id as v49, title as v50 from title AS t where (id) in (select v49 from semiUp5238525408935059322) and production_year>2000 and ((title LIKE '%Freddy%') OR (title LIKE '%Jason%'));
create or replace view semiUp2484176687687897181 as select v49, v50 from semiUp5416632700218423785 where (v49) in (select v49 from semiUp6934042431653552096);
create or replace view semiUp5398217085620462694 as select movie_id as v49, company_id as v8 from movie_companies AS mc where (movie_id) in (select v49 from semiUp2484176687687897181) and note LIKE '%(Blu-ray)%';
create or replace view semiUp8432930992035460331 as select movie_id as v49, info_type_id as v17, info as v35 from movie_info_idx AS mi_idx where (info_type_id) in (select id from info_type AS it2 where info= 'votes');
create or replace view semiUp7695978251240705549 as select v49, v8 from semiUp5398217085620462694 where (v49) in (select v49 from semiUp8432930992035460331);
create or replace view semiUp5139021878167631340 as select id as v8 from company_name AS cn where (id) in (select v8 from semiUp7695978251240705549) and name LIKE 'Lionsgate%';
create or replace view semiDown6597597147418753971 as select v49, v8 from semiUp7695978251240705549 where (v8) in (select v8 from semiUp5139021878167631340);
create or replace view semiDown7927854670393028150 as select v49, v50 from semiUp2484176687687897181 where (v49) in (select v49 from semiDown6597597147418753971);
create or replace view semiDown4656668755829541683 as select v49, v17, v35 from semiUp8432930992035460331 where (v49) in (select v49 from semiDown6597597147418753971);
create or replace view semiDown5618862752554539534 as select v40, v49 from semiUp6934042431653552096 where (v49) in (select v49 from semiDown7927854670393028150);
create or replace view semiDown8813006336733205934 as select v49, v19 from semiUp5238525408935059322 where (v49) in (select v49 from semiDown7927854670393028150);
create or replace view semiDown4174119970677742338 as select id as v17 from info_type AS it2 where (id) in (select v17 from semiDown4656668755829541683) and info= 'votes';
create or replace view semiDown1543521642373051521 as select id as v40, name as v41 from name AS n where (id) in (select v40 from semiDown5618862752554539534) and gender= 'm';
create or replace view semiDown8840930983760007589 as select v49, v15, v30 from semiUp6195451960092061936 where (v49) in (select v49 from semiDown8813006336733205934);
create or replace view semiDown1951832856398431999 as select id as v19 from keyword AS k where (id) in (select v19 from semiDown8813006336733205934) and keyword IN ('murder','violence','blood','gore','death','female-nudity','hospital');
create or replace view semiDown8635193807064356253 as select id as v15 from info_type AS it1 where (id) in (select v15 from semiDown8840930983760007589) and info= 'genres';
create or replace view aggView4555476736567901768 as select v15 from semiDown8635193807064356253;
create or replace view aggJoin7668132257521015121 as select v49, v30 from semiDown8840930983760007589 join aggView4555476736567901768 using(v15);
create or replace view aggView4377059831947593791 as select v40, v41 as v63 from semiDown1543521642373051521;
create or replace view aggJoin5653312287654651224 as select v49, v63 from semiDown5618862752554539534 join aggView4377059831947593791 using(v40);
create or replace view aggView2524350906355320447 as select v49, MIN(v63) as v63 from aggJoin5653312287654651224 group by v49;
create or replace view aggJoin8247568574525976270 as select v49, v50, v63 from semiDown7927854670393028150 join aggView2524350906355320447 using(v49);
create or replace view aggView676821467511790363 as select v19 from semiDown1951832856398431999;
create or replace view aggJoin7103385986795551394 as select v49 from semiDown8813006336733205934 join aggView676821467511790363 using(v19);
create or replace view aggView4525100428950177889 as select v17 from semiDown4174119970677742338;
create or replace view aggJoin548373743938324468 as select v49, v35 from semiDown4656668755829541683 join aggView4525100428950177889 using(v17);
create or replace view aggView1316004666181404191 as select v49, MIN(v35) as v62 from aggJoin548373743938324468 group by v49;
create or replace view aggJoin3231852250411208169 as select v49, v8, v62 from semiDown6597597147418753971 join aggView1316004666181404191 using(v49);
create or replace view aggView5791499727888791809 as select v49, MIN(v30) as v61 from aggJoin7668132257521015121 group by v49;
create or replace view aggJoin1255568272952402070 as select v49, v61 from aggJoin7103385986795551394 join aggView5791499727888791809 using(v49);
create or replace view aggView2245324167075005185 as select v49, MIN(v61) as v61 from aggJoin1255568272952402070 group by v49;
create or replace view aggJoin3856980112226991373 as select v49, v50, v63 as v63, v61 from aggJoin8247568574525976270 join aggView2245324167075005185 using(v49);
create or replace view aggView5751779956627810034 as select v49, MIN(v63) as v63, MIN(v61) as v61, MIN(v50) as v64 from aggJoin3856980112226991373 group by v49;
create or replace view aggJoin6251130345671306432 as select v8, v62 as v62, v63, v61, v64 from aggJoin3231852250411208169 join aggView5751779956627810034 using(v49);
create or replace view aggView3892596163317171343 as select v8, MIN(v62) as v62, MIN(v63) as v63, MIN(v61) as v61, MIN(v64) as v64 from aggJoin6251130345671306432 group by v8;
create or replace view aggJoin8507001998953595335 as select v62, v63, v61, v64 from semiUp5139021878167631340 join aggView3892596163317171343 using(v8);
create or replace view res as select MIN(v61) as v61, MIN(v62) as v62, MIN(v63) as v63, MIN(v64) as v64 from aggJoin8507001998953595335;
select sum(v61+v62+v63+v64) from res;
