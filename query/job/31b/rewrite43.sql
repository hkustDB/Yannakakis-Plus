create or replace view aggView3148271490473109561 as select id as v49, title as v64 from title as t where production_year>2000 and ((title LIKE '%Freddy%') OR (title LIKE '%Jason%'));
create or replace view aggJoin5439717851746722100 as select person_id as v40, movie_id as v49, note as v5, v64 from cast_info as ci, aggView3148271490473109561 where ci.movie_id=aggView3148271490473109561.v49 and note IN ('(writer)','(head writer)','(written by)','(story)','(story editor)');
create or replace view aggView6185785872624734706 as select id as v40, name as v63 from name as n where gender= 'm';
create or replace view aggJoin724405265998865637 as select v49, v5, v64, v63 from aggJoin5439717851746722100 join aggView6185785872624734706 using(v40);
create or replace view aggView5170166539081369710 as select id as v15 from info_type as it1 where info= 'genres';
create or replace view aggJoin4772585748876911963 as select movie_id as v49, info as v30 from movie_info as mi, aggView5170166539081369710 where mi.info_type_id=aggView5170166539081369710.v15 and info IN ('Horror','Thriller');
create or replace view aggView5078719004027603395 as select id as v17 from info_type as it2 where info= 'votes';
create or replace view aggJoin8543999278098157274 as select movie_id as v49, info as v35 from movie_info_idx as mi_idx, aggView5078719004027603395 where mi_idx.info_type_id=aggView5078719004027603395.v17;
create or replace view aggView2053707108588028683 as select id as v19 from keyword as k where keyword IN ('murder','violence','blood','gore','death','female-nudity','hospital');
create or replace view aggJoin2758757370294968690 as select movie_id as v49 from movie_keyword as mk, aggView2053707108588028683 where mk.keyword_id=aggView2053707108588028683.v19;
create or replace view aggView6625244935957384628 as select v49, MIN(v64) as v64, MIN(v63) as v63 from aggJoin724405265998865637 group by v49;
create or replace view aggJoin7998454337728557225 as select v49, v30, v64, v63 from aggJoin4772585748876911963 join aggView6625244935957384628 using(v49);
create or replace view aggView8677042069758182722 as select v49, MIN(v64) as v64, MIN(v63) as v63, MIN(v30) as v61 from aggJoin7998454337728557225 group by v49;
create or replace view aggJoin4748740341016223836 as select v49, v35, v64, v63, v61 from aggJoin8543999278098157274 join aggView8677042069758182722 using(v49);
create or replace view aggView8482548146381865659 as select v49, MIN(v64) as v64, MIN(v63) as v63, MIN(v61) as v61, MIN(v35) as v62 from aggJoin4748740341016223836 group by v49;
create or replace view aggJoin8063346234898479577 as select movie_id as v49, company_id as v8, note as v26, v64, v63, v61, v62 from movie_companies as mc, aggView8482548146381865659 where mc.movie_id=aggView8482548146381865659.v49 and note LIKE '%(Blu-ray)%';
create or replace view aggView8021836951306310050 as select v49 from aggJoin2758757370294968690 group by v49;
create or replace view aggJoin713533986941056952 as select v8, v26, v64 as v64, v63 as v63, v61 as v61, v62 as v62 from aggJoin8063346234898479577 join aggView8021836951306310050 using(v49);
create or replace view aggView2018212688414302028 as select v8, MIN(v64) as v64, MIN(v63) as v63, MIN(v61) as v61, MIN(v62) as v62 from aggJoin713533986941056952 group by v8;
create or replace view aggJoin7806061476798128609 as select name as v9, v64, v63, v61, v62 from company_name as cn, aggView2018212688414302028 where cn.id=aggView2018212688414302028.v8 and name LIKE 'Lionsgate%';
create or replace view res as select MIN(v61) as v61, MIN(v62) as v62, MIN(v63) as v63, MIN(v64) as v64 from aggJoin7806061476798128609;
select sum(v61+v62+v63+v64) from res;