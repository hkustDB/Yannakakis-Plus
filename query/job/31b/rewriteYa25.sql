create or replace view semiUp547054787649701771 as select movie_id as v49, info_type_id as v17, info as v35 from movie_info_idx AS mi_idx where (info_type_id) in (select id from info_type AS it2 where info= 'votes');
create or replace view semiUp300926049010090986 as select person_id as v40, movie_id as v49 from cast_info AS ci where (person_id) in (select id from name AS n where gender= 'm') and note IN ('(writer)','(head writer)','(written by)','(story)','(story editor)');
create or replace view semiUp7698672343926409815 as select v49, v17, v35 from semiUp547054787649701771 where (v49) in (select v49 from semiUp300926049010090986);
create or replace view semiUp1427635811262471003 as select movie_id as v49, info_type_id as v15, info as v30 from movie_info AS mi where (movie_id) in (select v49 from semiUp7698672343926409815) and info IN ('Horror','Thriller');
create or replace view semiUp643526595290569569 as select v49, v15, v30 from semiUp1427635811262471003 where (v15) in (select id from info_type AS it1 where info= 'genres');
create or replace view semiUp6093842116463954883 as select movie_id as v49, keyword_id as v19 from movie_keyword AS mk where (keyword_id) in (select id from keyword AS k where keyword IN ('murder','violence','blood','gore','death','female-nudity','hospital'));
create or replace view semiUp8969900277685760005 as select id as v49, title as v50 from title AS t where (id) in (select v49 from semiUp6093842116463954883) and production_year>2000 and ((title LIKE '%Freddy%') OR (title LIKE '%Jason%'));
create or replace view semiUp688502837901522009 as select v49, v50 from semiUp8969900277685760005 where (v49) in (select v49 from semiUp643526595290569569);
create or replace view semiUp8993879012723808594 as select movie_id as v49, company_id as v8 from movie_companies AS mc where (movie_id) in (select v49 from semiUp688502837901522009) and note LIKE '%(Blu-ray)%';
create or replace view semiUp5772326360634107982 as select id as v8 from company_name AS cn where (id) in (select v8 from semiUp8993879012723808594) and name LIKE 'Lionsgate%';
create or replace view semiDown3292446876582755317 as select v49, v8 from semiUp8993879012723808594 where (v8) in (select v8 from semiUp5772326360634107982);
create or replace view semiDown957181721773137527 as select v49, v50 from semiUp688502837901522009 where (v49) in (select v49 from semiDown3292446876582755317);
create or replace view semiDown36134712897339498 as select v49, v19 from semiUp6093842116463954883 where (v49) in (select v49 from semiDown957181721773137527);
create or replace view semiDown1923769297892185249 as select v49, v15, v30 from semiUp643526595290569569 where (v49) in (select v49 from semiDown957181721773137527);
create or replace view semiDown9188832384219452799 as select id as v19 from keyword AS k where (id) in (select v19 from semiDown36134712897339498) and keyword IN ('murder','violence','blood','gore','death','female-nudity','hospital');
create or replace view semiDown3004263444066924648 as select id as v15 from info_type AS it1 where (id) in (select v15 from semiDown1923769297892185249) and info= 'genres';
create or replace view semiDown6841737375208398475 as select v49, v17, v35 from semiUp7698672343926409815 where (v49) in (select v49 from semiDown1923769297892185249);
create or replace view semiDown2554492135411013627 as select v40, v49 from semiUp300926049010090986 where (v49) in (select v49 from semiDown6841737375208398475);
create or replace view semiDown8013588266806635988 as select id as v17 from info_type AS it2 where (id) in (select v17 from semiDown6841737375208398475) and info= 'votes';
create or replace view semiDown20622293974950321 as select id as v40, name as v41 from name AS n where (id) in (select v40 from semiDown2554492135411013627) and gender= 'm';
create or replace view aggView4644043655009668180 as select v40, v41 as v63 from semiDown20622293974950321;
create or replace view aggJoin4697135108456134413 as select v49, v63 from semiDown2554492135411013627 join aggView4644043655009668180 using(v40);
create or replace view aggView1587776659127948485 as select v15 from semiDown3004263444066924648;
create or replace view aggJoin384372925297344769 as select v49, v30 from semiDown1923769297892185249 join aggView1587776659127948485 using(v15);
create or replace view aggView8361863885103067906 as select v19 from semiDown9188832384219452799;
create or replace view aggJoin3300455419420499256 as select v49 from semiDown36134712897339498 join aggView8361863885103067906 using(v19);
create or replace view aggView7607847469660444445 as select v49 from aggJoin3300455419420499256 group by v49;
create or replace view aggJoin8451615686687636442 as select v49, v50 from semiDown957181721773137527 join aggView7607847469660444445 using(v49);
create or replace view aggView5180469776238219973 as select v17 from semiDown8013588266806635988;
create or replace view aggJoin1378524989509199390 as select v49, v35 from semiDown6841737375208398475 join aggView5180469776238219973 using(v17);
create or replace view aggView4781765136365797396 as select v49, MIN(v63) as v63 from aggJoin4697135108456134413 group by v49;
create or replace view aggJoin23529986317990393 as select v49, v35, v63 from aggJoin1378524989509199390 join aggView4781765136365797396 using(v49);
create or replace view aggView8659414293712879186 as select v49, MIN(v63) as v63, MIN(v35) as v62 from aggJoin23529986317990393 group by v49;
create or replace view aggJoin8694625419694187207 as select v49, v30, v63, v62 from aggJoin384372925297344769 join aggView8659414293712879186 using(v49);
create or replace view aggView1402061164193954559 as select v49, MIN(v63) as v63, MIN(v62) as v62, MIN(v30) as v61 from aggJoin8694625419694187207 group by v49;
create or replace view aggJoin8947744312417836577 as select v49, v50, v63, v62, v61 from aggJoin8451615686687636442 join aggView1402061164193954559 using(v49);
create or replace view aggView1736256286333653537 as select v49, MIN(v63) as v63, MIN(v62) as v62, MIN(v61) as v61, MIN(v50) as v64 from aggJoin8947744312417836577 group by v49;
create or replace view aggJoin3201985810943783732 as select v8, v63, v62, v61, v64 from semiDown3292446876582755317 join aggView1736256286333653537 using(v49);
create or replace view aggView2352649556452443483 as select v8, MIN(v63) as v63, MIN(v62) as v62, MIN(v61) as v61, MIN(v64) as v64 from aggJoin3201985810943783732 group by v8;
create or replace view aggJoin1567023560984643777 as select v63, v62, v61, v64 from semiUp5772326360634107982 join aggView2352649556452443483 using(v8);
create or replace view res as select MIN(v61) as v61, MIN(v62) as v62, MIN(v63) as v63, MIN(v64) as v64 from aggJoin1567023560984643777;
select sum(v61+v62+v63+v64) from res;
