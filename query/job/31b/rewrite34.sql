create or replace view aggView602294440405286010 as select id as v15 from info_type as it1 where info= 'genres';
create or replace view aggJoin6690560818580977316 as select movie_id as v49, info as v30 from movie_info as mi, aggView602294440405286010 where mi.info_type_id=aggView602294440405286010.v15 and info IN ('Horror','Thriller');
create or replace view aggView2607923413867977015 as select v49, MIN(v30) as v61 from aggJoin6690560818580977316 group by v49;
create or replace view aggJoin513310902839971195 as select movie_id as v49, keyword_id as v19, v61 from movie_keyword as mk, aggView2607923413867977015 where mk.movie_id=aggView2607923413867977015.v49;
create or replace view aggView47413995163070844 as select id as v17 from info_type as it2 where info= 'votes';
create or replace view aggJoin5687960449454181580 as select movie_id as v49, info as v35 from movie_info_idx as mi_idx, aggView47413995163070844 where mi_idx.info_type_id=aggView47413995163070844.v17;
create or replace view aggView8628077640798235168 as select v49, MIN(v35) as v62 from aggJoin5687960449454181580 group by v49;
create or replace view aggJoin1727478607821083879 as select id as v49, title as v50, production_year as v53, v62 from title as t, aggView8628077640798235168 where t.id=aggView8628077640798235168.v49 and production_year>2000 and ((title LIKE '%Freddy%') OR (title LIKE '%Jason%'));
create or replace view aggView5626614797645170199 as select id as v8 from company_name as cn where name LIKE 'Lionsgate%';
create or replace view aggJoin343034429688711245 as select movie_id as v49, note as v26 from movie_companies as mc, aggView5626614797645170199 where mc.company_id=aggView5626614797645170199.v8 and note LIKE '%(Blu-ray)%';
create or replace view aggView5154296615055627558 as select id as v19 from keyword as k where keyword IN ('murder','violence','blood','gore','death','female-nudity','hospital');
create or replace view aggJoin3112050148589516193 as select v49, v61 from aggJoin513310902839971195 join aggView5154296615055627558 using(v19);
create or replace view aggView7849655954291373339 as select v49, MIN(v61) as v61 from aggJoin3112050148589516193 group by v49;
create or replace view aggJoin7622049423558359428 as select v49, v50, v53, v62 as v62, v61 from aggJoin1727478607821083879 join aggView7849655954291373339 using(v49);
create or replace view aggView1663637571050799861 as select v49, MIN(v62) as v62, MIN(v61) as v61, MIN(v50) as v64 from aggJoin7622049423558359428 group by v49;
create or replace view aggJoin5856816042874716351 as select person_id as v40, movie_id as v49, note as v5, v62, v61, v64 from cast_info as ci, aggView1663637571050799861 where ci.movie_id=aggView1663637571050799861.v49 and note IN ('(writer)','(head writer)','(written by)','(story)','(story editor)');
create or replace view aggView81847433100774728 as select v49 from aggJoin343034429688711245 group by v49;
create or replace view aggJoin2298337490035425495 as select v40, v5, v62 as v62, v61 as v61, v64 as v64 from aggJoin5856816042874716351 join aggView81847433100774728 using(v49);
create or replace view aggView958830496446447913 as select v40, MIN(v62) as v62, MIN(v61) as v61, MIN(v64) as v64 from aggJoin2298337490035425495 group by v40;
create or replace view aggJoin1183689582419527251 as select name as v41, gender as v44, v62, v61, v64 from name as n, aggView958830496446447913 where n.id=aggView958830496446447913.v40 and gender= 'm';
create or replace view res as select MIN(v61) as v61, MIN(v62) as v62, MIN(v41) as v63, MIN(v64) as v64 from aggJoin1183689582419527251;
select sum(v61+v62+v63+v64) from res;