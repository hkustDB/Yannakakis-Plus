create or replace view aggView7917416411174699745 as select id as v40, name as v63 from name as n where gender= 'm';
create or replace view aggJoin1063914020223878602 as select movie_id as v49, note as v5, v63 from cast_info as ci, aggView7917416411174699745 where ci.person_id=aggView7917416411174699745.v40 and note IN ('(writer)','(head writer)','(written by)','(story)','(story editor)');
create or replace view aggView8498051360409492488 as select id as v15 from info_type as it1 where info= 'genres';
create or replace view aggJoin9090715927512695187 as select movie_id as v49, info as v30 from movie_info as mi, aggView8498051360409492488 where mi.info_type_id=aggView8498051360409492488.v15 and info IN ('Horror','Thriller');
create or replace view aggView1837351905218585488 as select v49, MIN(v30) as v61 from aggJoin9090715927512695187 group by v49;
create or replace view aggJoin8642004694114680255 as select id as v49, title as v50, production_year as v53, v61 from title as t, aggView1837351905218585488 where t.id=aggView1837351905218585488.v49 and production_year>2000 and ((title LIKE '%Freddy%') OR (title LIKE '%Jason%'));
create or replace view aggView7792343383679747626 as select v49, MIN(v61) as v61, MIN(v50) as v64 from aggJoin8642004694114680255 group by v49;
create or replace view aggJoin4471810740670652043 as select movie_id as v49, info_type_id as v17, info as v35, v61, v64 from movie_info_idx as mi_idx, aggView7792343383679747626 where mi_idx.movie_id=aggView7792343383679747626.v49;
create or replace view aggView7590131913346675706 as select id as v17 from info_type as it2 where info= 'votes';
create or replace view aggJoin4948863415959238124 as select v49, v35, v61, v64 from aggJoin4471810740670652043 join aggView7590131913346675706 using(v17);
create or replace view aggView297259663272317112 as select v49, MIN(v61) as v61, MIN(v64) as v64, MIN(v35) as v62 from aggJoin4948863415959238124 group by v49;
create or replace view aggJoin7794627899900930359 as select movie_id as v49, keyword_id as v19, v61, v64, v62 from movie_keyword as mk, aggView297259663272317112 where mk.movie_id=aggView297259663272317112.v49;
create or replace view aggView1112735673595968470 as select id as v8 from company_name as cn where name LIKE 'Lionsgate%';
create or replace view aggJoin2275444970679193545 as select movie_id as v49, note as v26 from movie_companies as mc, aggView1112735673595968470 where mc.company_id=aggView1112735673595968470.v8 and note LIKE '%(Blu-ray)%';
create or replace view aggView2935756281520731828 as select id as v19 from keyword as k where keyword IN ('murder','violence','blood','gore','death','female-nudity','hospital');
create or replace view aggJoin7849018453020950527 as select v49, v61, v64, v62 from aggJoin7794627899900930359 join aggView2935756281520731828 using(v19);
create or replace view aggView6282604693992444179 as select v49, MIN(v61) as v61, MIN(v64) as v64, MIN(v62) as v62 from aggJoin7849018453020950527 group by v49;
create or replace view aggJoin3118798260044717959 as select v49, v26, v61, v64, v62 from aggJoin2275444970679193545 join aggView6282604693992444179 using(v49);
create or replace view aggView1132355888968668250 as select v49, MIN(v61) as v61, MIN(v64) as v64, MIN(v62) as v62 from aggJoin3118798260044717959 group by v49;
create or replace view aggJoin4501172051989636972 as select v5, v63 as v63, v61, v64, v62 from aggJoin1063914020223878602 join aggView1132355888968668250 using(v49);
create or replace view res as select MIN(v61) as v61, MIN(v62) as v62, MIN(v63) as v63, MIN(v64) as v64 from aggJoin4501172051989636972;
select sum(v61+v62+v63+v64) from res;