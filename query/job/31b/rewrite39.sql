create or replace view aggView7386949002029990691 as select id as v40, name as v63 from name as n where gender= 'm';
create or replace view aggJoin8313027539595125963 as select movie_id as v49, note as v5, v63 from cast_info as ci, aggView7386949002029990691 where ci.person_id=aggView7386949002029990691.v40 and note IN ('(writer)','(head writer)','(written by)','(story)','(story editor)');
create or replace view aggView3006977708055892471 as select id as v15 from info_type as it1 where info= 'genres';
create or replace view aggJoin334115093896956614 as select movie_id as v49, info as v30 from movie_info as mi, aggView3006977708055892471 where mi.info_type_id=aggView3006977708055892471.v15 and info IN ('Horror','Thriller');
create or replace view aggView8778026905636847036 as select v49, MIN(v30) as v61 from aggJoin334115093896956614 group by v49;
create or replace view aggJoin5045055349940668630 as select v49, v5, v63 as v63, v61 from aggJoin8313027539595125963 join aggView8778026905636847036 using(v49);
create or replace view aggView993142225461642252 as select id as v17 from info_type as it2 where info= 'votes';
create or replace view aggJoin2644480223381536613 as select movie_id as v49, info as v35 from movie_info_idx as mi_idx, aggView993142225461642252 where mi_idx.info_type_id=aggView993142225461642252.v17;
create or replace view aggView253729787462694349 as select id as v8 from company_name as cn where name LIKE 'Lionsgate%';
create or replace view aggJoin3994552275581641014 as select movie_id as v49, note as v26 from movie_companies as mc, aggView253729787462694349 where mc.company_id=aggView253729787462694349.v8 and note LIKE '%(Blu-ray)%';
create or replace view aggView1441584245928363434 as select v49, MIN(v63) as v63, MIN(v61) as v61 from aggJoin5045055349940668630 group by v49;
create or replace view aggJoin4356323622840044189 as select v49, v35, v63, v61 from aggJoin2644480223381536613 join aggView1441584245928363434 using(v49);
create or replace view aggView9078685933215449433 as select v49, MIN(v63) as v63, MIN(v61) as v61, MIN(v35) as v62 from aggJoin4356323622840044189 group by v49;
create or replace view aggJoin6785011257497403248 as select id as v49, title as v50, production_year as v53, v63, v61, v62 from title as t, aggView9078685933215449433 where t.id=aggView9078685933215449433.v49 and production_year>2000 and ((title LIKE '%Freddy%') OR (title LIKE '%Jason%'));
create or replace view aggView1222189385161419967 as select v49, MIN(v63) as v63, MIN(v61) as v61, MIN(v62) as v62, MIN(v50) as v64 from aggJoin6785011257497403248 group by v49;
create or replace view aggJoin7052527419793107754 as select movie_id as v49, keyword_id as v19, v63, v61, v62, v64 from movie_keyword as mk, aggView1222189385161419967 where mk.movie_id=aggView1222189385161419967.v49;
create or replace view aggView3129390980707516434 as select id as v19 from keyword as k where keyword IN ('murder','violence','blood','gore','death','female-nudity','hospital');
create or replace view aggJoin4734536170139423263 as select v49, v63, v61, v62, v64 from aggJoin7052527419793107754 join aggView3129390980707516434 using(v19);
create or replace view aggView4032600259543174949 as select v49, MIN(v63) as v63, MIN(v61) as v61, MIN(v62) as v62, MIN(v64) as v64 from aggJoin4734536170139423263 group by v49;
create or replace view aggJoin4912571893727813923 as select v26, v63, v61, v62, v64 from aggJoin3994552275581641014 join aggView4032600259543174949 using(v49);
create or replace view res as select MIN(v61) as v61, MIN(v62) as v62, MIN(v63) as v63, MIN(v64) as v64 from aggJoin4912571893727813923;
select sum(v61+v62+v63+v64) from res;