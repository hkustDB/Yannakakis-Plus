create or replace view aggView8066440124472307774 as select id as v17, name as v2 from company_name as cn where country_code<> '[pl]' and ((name LIKE '20th Century Fox%') OR (name LIKE 'Twentieth Century Fox%'));
create or replace view aggView7759160824217647143 as select id as v18 from company_type as ct where kind<> 'production companies';
create or replace view aggJoin3496129397869739480 as select movie_id as v24, company_id as v17, note as v19 from movie_companies as mc, aggView7759160824217647143 where mc.company_type_id=aggView7759160824217647143.v18;
create or replace view aggView210027311712181438 as select v17, v19, v24 from aggJoin3496129397869739480 group by v17,v19,v24;
create or replace view aggView4257846644411209652 as select id as v13 from link_type as lt;
create or replace view aggJoin294229424182612620 as select movie_id as v24 from movie_link as ml, aggView4257846644411209652 where ml.link_type_id=aggView4257846644411209652.v13;
create or replace view aggView7923739142686422521 as select id as v22 from keyword as k where keyword IN ('sequel','revenge','based-on-novel');
create or replace view aggJoin737943722916486204 as select movie_id as v24 from movie_keyword as mk, aggView7923739142686422521 where mk.keyword_id=aggView7923739142686422521.v22;
create or replace view aggView3015069594023916311 as select v24 from aggJoin737943722916486204 group by v24;
create or replace view aggJoin2389346320624258135 as select v24 from aggJoin294229424182612620 join aggView3015069594023916311 using(v24);
create or replace view aggView5080943040801350578 as select v24 from aggJoin2389346320624258135 group by v24;
create or replace view aggJoin7528720626189870045 as select id as v24, title as v28, production_year as v31 from title as t, aggView5080943040801350578 where t.id=aggView5080943040801350578.v24 and production_year>1950;
create or replace view aggView6387219689029632172 as select v28, v24 from aggJoin7528720626189870045 group by v28,v24;
create or replace view aggView2621868328914480977 as select v24, MIN(v28) as v41 from aggView6387219689029632172 group by v24;
create or replace view aggJoin9188762162458564934 as select v17, v19, v41 from aggView210027311712181438 join aggView2621868328914480977 using(v24);
create or replace view aggView1143359401325544750 as select v17, MIN(v41) as v41, MIN(v19) as v40 from aggJoin9188762162458564934 group by v17,v41;
create or replace view aggJoin2201081419007029768 as select v2, v41, v40 from aggView8066440124472307774 join aggView1143359401325544750 using(v17);
select MIN(v2) as v39,MIN(v40) as v40,MIN(v41) as v41 from aggJoin2201081419007029768;
