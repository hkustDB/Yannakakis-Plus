create or replace view semiUp2086157247181790408 as select movie_id as v24, company_id as v17, company_type_id as v18, note as v19 from movie_companies AS mc where (company_type_id) in (select id from company_type AS ct where kind<> 'production companies');
create or replace view semiUp8902311881904935063 as select movie_id as v24, keyword_id as v22 from movie_keyword AS mk where (keyword_id) in (select id from keyword AS k where keyword IN ('sequel','revenge','based-on-novel'));
create or replace view semiUp502834184728647813 as select v24, v22 from semiUp8902311881904935063 where (v24) in (select id from title AS t where production_year>1950);
create or replace view semiUp9216057371727220762 as select movie_id as v24, link_type_id as v13 from movie_link AS ml where (movie_id) in (select v24 from semiUp502834184728647813);
create or replace view semiUp563759409819941034 as select v24, v17, v18, v19 from semiUp2086157247181790408 where (v17) in (select id from company_name AS cn where country_code<> '[pl]' and ((name LIKE '20th Century Fox%') OR (name LIKE 'Twentieth Century Fox%')));
create or replace view semiUp3602217453928283362 as select v24, v13 from semiUp9216057371727220762 where (v24) in (select v24 from semiUp563759409819941034);
create or replace view semiUp4392465337298248197 as select id as v13 from link_type AS lt where (id) in (select v13 from semiUp3602217453928283362);
create or replace view semiDown3109564146688629767 as select v24, v13 from semiUp3602217453928283362 where (v13) in (select v13 from semiUp4392465337298248197);
create or replace view semiDown2988920219092938078 as select v24, v22 from semiUp502834184728647813 where (v24) in (select v24 from semiDown3109564146688629767);
create or replace view semiDown1398536078133648980 as select v24, v17, v18, v19 from semiUp563759409819941034 where (v24) in (select v24 from semiDown3109564146688629767);
create or replace view semiDown3524640190178318834 as select id as v22 from keyword AS k where (id) in (select v22 from semiDown2988920219092938078) and keyword IN ('sequel','revenge','based-on-novel');
create or replace view semiDown7230498841279101164 as select id as v24, title as v28 from title AS t where (id) in (select v24 from semiDown2988920219092938078) and production_year>1950;
create or replace view semiDown2848691820320275524 as select id as v18 from company_type AS ct where (id) in (select v18 from semiDown1398536078133648980) and kind<> 'production companies';
create or replace view semiDown4846369709047427139 as select id as v17, name as v2 from company_name AS cn where (id) in (select v17 from semiDown1398536078133648980) and country_code<> '[pl]' and ((name LIKE '20th Century Fox%') OR (name LIKE 'Twentieth Century Fox%'));
create or replace view aggView4353260674121560125 as select v17, v2 as v39 from semiDown4846369709047427139;
create or replace view aggJoin5512736366040222791 as select v24, v18, v19, v39 from semiDown1398536078133648980 join aggView4353260674121560125 using(v17);
create or replace view aggView2420646221318474526 as select v22 from semiDown3524640190178318834;
create or replace view aggJoin205895600210355883 as select v24 from semiDown2988920219092938078 join aggView2420646221318474526 using(v22);
create or replace view aggView7890811495118322560 as select v18 from semiDown2848691820320275524;
create or replace view aggJoin575492576328349543 as select v24, v19, v39 from aggJoin5512736366040222791 join aggView7890811495118322560 using(v18);
create or replace view aggView4880003462623606002 as select v24, MIN(v39) as v39, MIN(v19) as v40 from aggJoin575492576328349543 group by v24;
create or replace view aggJoin585592741552499897 as select v24, v13, v39, v40 from semiDown3109564146688629767 join aggView4880003462623606002 using(v24);
create or replace view aggView8880805241282176080 as select v24, v28 as v41 from semiDown7230498841279101164;
create or replace view aggJoin3291847899790323261 as select v24, v41 from aggJoin205895600210355883 join aggView8880805241282176080 using(v24);
create or replace view aggView246270624598241583 as select v24, MIN(v41) as v41 from aggJoin3291847899790323261 group by v24;
create or replace view aggJoin8450150220817863470 as select v13, v39 as v39, v40 as v40, v41 from aggJoin585592741552499897 join aggView246270624598241583 using(v24);
create or replace view aggView6898487319546685369 as select v13, MIN(v39) as v39, MIN(v40) as v40, MIN(v41) as v41 from aggJoin8450150220817863470 group by v13;
create or replace view aggJoin3630977521119529240 as select v39, v40, v41 from semiUp4392465337298248197 join aggView6898487319546685369 using(v13);
create or replace view res as select MIN(v39) as v39, MIN(v40) as v40, MIN(v41) as v41 from aggJoin3630977521119529240;
select sum(v39+v40+v41) from res;
