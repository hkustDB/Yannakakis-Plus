create or replace view semiUp4666403622610888999 as select movie_id as v24, link_type_id as v13 from movie_link AS ml where (link_type_id) in (select id from link_type AS lt);
create or replace view semiUp2173260522098729920 as select movie_id as v24, keyword_id as v22 from movie_keyword AS mk where (movie_id) in (select v24 from semiUp4666403622610888999);
create or replace view semiUp7576489531368128129 as select movie_id as v24, company_id as v17, company_type_id as v18, note as v19 from movie_companies AS mc where (company_id) in (select id from company_name AS cn where country_code<> '[pl]' and ((name LIKE '20th Century Fox%') OR (name LIKE 'Twentieth Century Fox%')));
create or replace view semiUp4748367334617165795 as select v24, v22 from semiUp2173260522098729920 where (v22) in (select id from keyword AS k where keyword IN ('sequel','revenge','based-on-novel'));
create or replace view semiUp2262703445977190214 as select id as v24, title as v28 from title AS t where (id) in (select v24 from semiUp4748367334617165795) and production_year>1950;
create or replace view semiUp7534156413107031902 as select v24, v17, v18, v19 from semiUp7576489531368128129 where (v24) in (select v24 from semiUp2262703445977190214);
create or replace view semiUp8433573349222568493 as select id as v18 from company_type AS ct where (id) in (select v18 from semiUp7534156413107031902) and kind<> 'production companies';
create or replace view semiDown3526358873638048062 as select v24, v17, v18, v19 from semiUp7534156413107031902 where (v18) in (select v18 from semiUp8433573349222568493);
create or replace view semiDown3516321440658866939 as select v24, v28 from semiUp2262703445977190214 where (v24) in (select v24 from semiDown3526358873638048062);
create or replace view semiDown707498352075303123 as select id as v17, name as v2 from company_name AS cn where (id) in (select v17 from semiDown3526358873638048062) and country_code<> '[pl]' and ((name LIKE '20th Century Fox%') OR (name LIKE 'Twentieth Century Fox%'));
create or replace view semiDown7460702307980994512 as select v24, v22 from semiUp4748367334617165795 where (v24) in (select v24 from semiDown3516321440658866939);
create or replace view semiDown2854334727392513077 as select id as v22 from keyword AS k where (id) in (select v22 from semiDown7460702307980994512) and keyword IN ('sequel','revenge','based-on-novel');
create or replace view semiDown316411384251513490 as select v24, v13 from semiUp4666403622610888999 where (v24) in (select v24 from semiDown7460702307980994512);
create or replace view semiDown8273868600036035975 as select id as v13 from link_type AS lt where (id) in (select v13 from semiDown316411384251513490);
create or replace view aggView3266991923959138618 as select v22 from semiDown2854334727392513077;
create or replace view aggJoin1094603876491878262 as select v24 from semiDown7460702307980994512 join aggView3266991923959138618 using(v22);
create or replace view aggView86979731818665197 as select v13 from semiDown8273868600036035975;
create or replace view aggJoin8184543693362227712 as select v24 from semiDown316411384251513490 join aggView86979731818665197 using(v13);
create or replace view aggView6809743897088428927 as select v24 from aggJoin8184543693362227712 group by v24;
create or replace view aggJoin6342735823486474504 as select v24 from aggJoin1094603876491878262 join aggView6809743897088428927 using(v24);
create or replace view aggView6253940336589566035 as select v24 from aggJoin6342735823486474504 group by v24;
create or replace view aggJoin8963341851217622750 as select v24, v28 from semiDown3516321440658866939 join aggView6253940336589566035 using(v24);
create or replace view aggView2808575956169322487 as select v24, MIN(v28) as v41 from aggJoin8963341851217622750 group by v24;
create or replace view aggJoin3247466023576155537 as select v17, v18, v19, v41 from semiDown3526358873638048062 join aggView2808575956169322487 using(v24);
create or replace view aggView5128312204713310477 as select v17, v2 as v39 from semiDown707498352075303123;
create or replace view aggJoin5888925001779968195 as select v18, v19, v41, v39 from aggJoin3247466023576155537 join aggView5128312204713310477 using(v17);
create or replace view aggView5704559305670413474 as select v18, MIN(v41) as v41, MIN(v39) as v39, MIN(v19) as v40 from aggJoin5888925001779968195 group by v18;
create or replace view aggJoin2125351402928560197 as select v41, v39, v40 from semiUp8433573349222568493 join aggView5704559305670413474 using(v18);
create or replace view res as select MIN(v39) as v39, MIN(v40) as v40, MIN(v41) as v41 from aggJoin2125351402928560197;
select sum(v39+v40+v41) from res;
