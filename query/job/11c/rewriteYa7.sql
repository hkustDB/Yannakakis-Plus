create or replace view semiUp922632512080013254 as select movie_id as v24, company_id as v17, company_type_id as v18, note as v19 from movie_companies AS mc where (company_type_id) in (select id from company_type AS ct where kind<> 'production companies');
create or replace view semiUp3344995404802707923 as select movie_id as v24, link_type_id as v13 from movie_link AS ml where (link_type_id) in (select id from link_type AS lt);
create or replace view semiUp8486183852077880303 as select v24, v17, v18, v19 from semiUp922632512080013254 where (v17) in (select id from company_name AS cn where country_code<> '[pl]' and ((name LIKE '20th Century Fox%') OR (name LIKE 'Twentieth Century Fox%')));
create or replace view semiUp7627095019771049223 as select v24, v13 from semiUp3344995404802707923 where (v24) in (select v24 from semiUp8486183852077880303);
create or replace view semiUp4555374251469974936 as select id as v24, title as v28 from title AS t where (id) in (select v24 from semiUp7627095019771049223) and production_year>1950;
create or replace view semiUp911296074036306400 as select movie_id as v24, keyword_id as v22 from movie_keyword AS mk where (movie_id) in (select v24 from semiUp4555374251469974936);
create or replace view semiUp7148893775291021348 as select id as v22 from keyword AS k where (id) in (select v22 from semiUp911296074036306400) and keyword IN ('sequel','revenge','based-on-novel');
create or replace view semiDown7882812114831969114 as select v24, v22 from semiUp911296074036306400 where (v22) in (select v22 from semiUp7148893775291021348);
create or replace view semiDown1217155112904514340 as select v24, v28 from semiUp4555374251469974936 where (v24) in (select v24 from semiDown7882812114831969114);
create or replace view semiDown3041126966055525795 as select v24, v13 from semiUp7627095019771049223 where (v24) in (select v24 from semiDown1217155112904514340);
create or replace view semiDown2851454836487601249 as select v24, v17, v18, v19 from semiUp8486183852077880303 where (v24) in (select v24 from semiDown3041126966055525795);
create or replace view semiDown7994262637818933439 as select id as v13 from link_type AS lt where (id) in (select v13 from semiDown3041126966055525795);
create or replace view semiDown7223829122316329462 as select id as v18 from company_type AS ct where (id) in (select v18 from semiDown2851454836487601249) and kind<> 'production companies';
create or replace view semiDown5494184629934394813 as select id as v17, name as v2 from company_name AS cn where (id) in (select v17 from semiDown2851454836487601249) and country_code<> '[pl]' and ((name LIKE '20th Century Fox%') OR (name LIKE 'Twentieth Century Fox%'));
create or replace view aggView7740916342810828232 as select v18 from semiDown7223829122316329462;
create or replace view aggJoin1703998013555399189 as select v24, v17, v19 from semiDown2851454836487601249 join aggView7740916342810828232 using(v18);
create or replace view aggView371738795968952988 as select v13 from semiDown7994262637818933439;
create or replace view aggJoin676488460546641427 as select v24 from semiDown3041126966055525795 join aggView371738795968952988 using(v13);
create or replace view aggView4159102275170278493 as select v17, v2 as v39 from semiDown5494184629934394813;
create or replace view aggJoin490611972043382923 as select v24, v19, v39 from aggJoin1703998013555399189 join aggView4159102275170278493 using(v17);
create or replace view aggView3412245462426986319 as select v24, MIN(v39) as v39, MIN(v19) as v40 from aggJoin490611972043382923 group by v24;
create or replace view aggJoin7202993547075009441 as select v24, v39, v40 from aggJoin676488460546641427 join aggView3412245462426986319 using(v24);
create or replace view aggView3229515665983514199 as select v24, MIN(v39) as v39, MIN(v40) as v40 from aggJoin7202993547075009441 group by v24;
create or replace view aggJoin9116479934971986255 as select v24, v28, v39, v40 from semiDown1217155112904514340 join aggView3229515665983514199 using(v24);
create or replace view aggView8287699335919971155 as select v24, MIN(v39) as v39, MIN(v40) as v40, MIN(v28) as v41 from aggJoin9116479934971986255 group by v24;
create or replace view aggJoin3787930719150984898 as select v22, v39, v40, v41 from semiDown7882812114831969114 join aggView8287699335919971155 using(v24);
create or replace view aggView7270895263299328652 as select v22, MIN(v39) as v39, MIN(v40) as v40, MIN(v41) as v41 from aggJoin3787930719150984898 group by v22;
create or replace view aggJoin5053143723057760562 as select v39, v40, v41 from semiUp7148893775291021348 join aggView7270895263299328652 using(v22);
create or replace view res as select MIN(v39) as v39, MIN(v40) as v40, MIN(v41) as v41 from aggJoin5053143723057760562;
select sum(v39+v40+v41) from res;
