create or replace view semiUp3187772666812641831 as select movie_id as v24, link_type_id as v13 from movie_link AS ml where (link_type_id) in (select id from link_type AS lt);
create or replace view semiUp8848378699286682716 as select id as v24, title as v28 from title AS t where (id) in (select v24 from semiUp3187772666812641831) and production_year>1950;
create or replace view semiUp4860696909643583420 as select movie_id as v24, company_id as v17, company_type_id as v18, note as v19 from movie_companies AS mc where (company_type_id) in (select id from company_type AS ct where kind<> 'production companies');
create or replace view semiUp8889430608471566943 as select movie_id as v24, keyword_id as v22 from movie_keyword AS mk where (keyword_id) in (select id from keyword AS k where keyword IN ('sequel','revenge','based-on-novel'));
create or replace view semiUp9122167956213438311 as select v24, v17, v18, v19 from semiUp4860696909643583420 where (v17) in (select id from company_name AS cn where country_code<> '[pl]' and ((name LIKE '20th Century Fox%') OR (name LIKE 'Twentieth Century Fox%')));
create or replace view semiUp474930946866679414 as select v24, v28 from semiUp8848378699286682716 where (v24) in (select v24 from semiUp9122167956213438311);
create or replace view semiUp8019773086293450222 as select v24, v22 from semiUp8889430608471566943 where (v24) in (select v24 from semiUp474930946866679414);
create or replace view semiDown1961899108900092413 as select id as v22 from keyword AS k where (id) in (select v22 from semiUp8019773086293450222) and keyword IN ('sequel','revenge','based-on-novel');
create or replace view semiDown6771673983027637949 as select v24, v28 from semiUp474930946866679414 where (v24) in (select v24 from semiUp8019773086293450222);
create or replace view semiDown6856254506666273000 as select v24, v17, v18, v19 from semiUp9122167956213438311 where (v24) in (select v24 from semiDown6771673983027637949);
create or replace view semiDown3819444552751608161 as select v24, v13 from semiUp3187772666812641831 where (v24) in (select v24 from semiDown6771673983027637949);
create or replace view semiDown2112039031382694471 as select id as v18 from company_type AS ct where (id) in (select v18 from semiDown6856254506666273000) and kind<> 'production companies';
create or replace view semiDown7155119234645649986 as select id as v17, name as v2 from company_name AS cn where (id) in (select v17 from semiDown6856254506666273000) and country_code<> '[pl]' and ((name LIKE '20th Century Fox%') OR (name LIKE 'Twentieth Century Fox%'));
create or replace view semiDown3572102967454947013 as select id as v13 from link_type AS lt where (id) in (select v13 from semiDown3819444552751608161);
create or replace view aggView6381108718486717520 as select v17, v2 as v39 from semiDown7155119234645649986;
create or replace view aggJoin5028759587149300704 as select v24, v18, v19, v39 from semiDown6856254506666273000 join aggView6381108718486717520 using(v17);
create or replace view aggView6461433833777233402 as select v22 from semiDown1961899108900092413;
create or replace view aggJoin853449153126184109 as select v24 from semiUp8019773086293450222 join aggView6461433833777233402 using(v22);
create or replace view aggView2736179795533832158 as select v18 from semiDown2112039031382694471;
create or replace view aggJoin2211374216550988910 as select v24, v19, v39 from aggJoin5028759587149300704 join aggView2736179795533832158 using(v18);
create or replace view aggView4322514383812282086 as select v13 from semiDown3572102967454947013;
create or replace view aggJoin8535579514423198517 as select v24 from semiDown3819444552751608161 join aggView4322514383812282086 using(v13);
create or replace view aggView7641382228575717062 as select v24 from aggJoin8535579514423198517 group by v24;
create or replace view aggJoin8522261084458703678 as select v24, v28 from semiDown6771673983027637949 join aggView7641382228575717062 using(v24);
create or replace view aggView346401357626190152 as select v24, MIN(v39) as v39, MIN(v19) as v40 from aggJoin2211374216550988910 group by v24;
create or replace view aggJoin6727500312866943318 as select v24, v28, v39, v40 from aggJoin8522261084458703678 join aggView346401357626190152 using(v24);
create or replace view aggView1264784699598819124 as select v24, MIN(v39) as v39, MIN(v40) as v40, MIN(v28) as v41 from aggJoin6727500312866943318 group by v24;
create or replace view aggJoin93119065551345900 as select v39, v40, v41 from aggJoin853449153126184109 join aggView1264784699598819124 using(v24);
create or replace view res as select MIN(v39) as v39, MIN(v40) as v40, MIN(v41) as v41 from aggJoin93119065551345900;
select sum(v39+v40+v41) from res;
