create or replace view aggView7314003474190177550 as select id as v23 from keyword as k where keyword IN ('superhero','sequel','second-part','marvel-comics','based-on-comic','tv-special','fight','violence');
create or replace view aggJoin4784434078630912013 as select movie_id as v40 from movie_keyword as mk, aggView7314003474190177550 where mk.keyword_id=aggView7314003474190177550.v23;
create or replace view aggView7572850735334580830 as select id as v5 from comp_cast_type as cct1 where kind= 'cast';
create or replace view aggJoin3720741185891064843 as select movie_id as v40, status_id as v7 from complete_cast as cc, aggView7572850735334580830 where cc.subject_id=aggView7572850735334580830.v5;
create or replace view aggView2738803558363626294 as select id as v7 from comp_cast_type as cct2 where kind LIKE '%complete%';
create or replace view aggJoin3663926619683551825 as select v40 from aggJoin3720741185891064843 join aggView2738803558363626294 using(v7);
create or replace view aggView7534066298571764188 as select v40 from aggJoin3663926619683551825 group by v40;
create or replace view aggJoin8355279512623723072 as select person_id as v31, movie_id as v40, person_role_id as v9 from cast_info as ci, aggView7534066298571764188 where ci.movie_id=aggView7534066298571764188.v40;
create or replace view aggView5488849806827762289 as select id as v31 from name as n;
create or replace view aggJoin648744396988472007 as select v40, v9 from aggJoin8355279512623723072 join aggView5488849806827762289 using(v31);
create or replace view aggView5145124602563870558 as select id as v9 from char_name as chn where ((name LIKE '%Tony%Stark%') OR (name LIKE '%Iron%Man%')) and name NOT LIKE '%Sherlock%';
create or replace view aggJoin1400894041048762996 as select v40 from aggJoin648744396988472007 join aggView5145124602563870558 using(v9);
create or replace view aggView4675523957988457207 as select v40 from aggJoin1400894041048762996 group by v40;
create or replace view aggJoin4617691012165897255 as select v40 from aggJoin4784434078630912013 join aggView4675523957988457207 using(v40);
create or replace view aggView8917484590206313926 as select v40 from aggJoin4617691012165897255 group by v40;
create or replace view aggJoin1473767926541612938 as select title as v41, kind_id as v26 from title as t, aggView8917484590206313926 where t.id=aggView8917484590206313926.v40 and production_year>1950;
create or replace view aggView6739789954276507152 as select v26, MIN(v41) as v52 from aggJoin1473767926541612938 group by v26;
create or replace view aggJoin8131949154904315979 as select v52 from kind_type as kt, aggView6739789954276507152 where kt.id=aggView6739789954276507152.v26 and kind= 'movie';
create or replace view res as select MIN(v52) as v52 from aggJoin8131949154904315979;
select sum(v52) from res;