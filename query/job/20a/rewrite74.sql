create or replace view aggView4638979420392609167 as select id as v23 from keyword as k where keyword IN ('superhero','sequel','second-part','marvel-comics','based-on-comic','tv-special','fight','violence');
create or replace view aggJoin4430019021639020104 as select movie_id as v40 from movie_keyword as mk, aggView4638979420392609167 where mk.keyword_id=aggView4638979420392609167.v23;
create or replace view aggView2185222093952795769 as select id as v5 from comp_cast_type as cct1 where kind= 'cast';
create or replace view aggJoin7571616367121488670 as select movie_id as v40, status_id as v7 from complete_cast as cc, aggView2185222093952795769 where cc.subject_id=aggView2185222093952795769.v5;
create or replace view aggView3478530088026800278 as select v40 from aggJoin4430019021639020104 group by v40;
create or replace view aggJoin428916203553016623 as select id as v40, title as v41, kind_id as v26 from title as t, aggView3478530088026800278 where t.id=aggView3478530088026800278.v40 and production_year>1950;
create or replace view aggView1684995560068907790 as select id as v7 from comp_cast_type as cct2 where kind LIKE '%complete%';
create or replace view aggJoin2459988469707615482 as select v40 from aggJoin7571616367121488670 join aggView1684995560068907790 using(v7);
create or replace view aggView202210854684255471 as select id as v31 from name as n;
create or replace view aggJoin7664694115676582138 as select movie_id as v40, person_role_id as v9 from cast_info as ci, aggView202210854684255471 where ci.person_id=aggView202210854684255471.v31;
create or replace view aggView4602278331431652931 as select id as v26 from kind_type as kt where kind= 'movie';
create or replace view aggJoin4661400160299103235 as select v40, v41 from aggJoin428916203553016623 join aggView4602278331431652931 using(v26);
create or replace view aggView672935971860177993 as select v40, MIN(v41) as v52 from aggJoin4661400160299103235 group by v40;
create or replace view aggJoin6604008091457050374 as select v40, v52 from aggJoin2459988469707615482 join aggView672935971860177993 using(v40);
create or replace view aggView72501895954219558 as select v40, MIN(v52) as v52 from aggJoin6604008091457050374 group by v40;
create or replace view aggJoin8469715493384077458 as select v9, v52 from aggJoin7664694115676582138 join aggView72501895954219558 using(v40);
create or replace view aggView7939943175640228395 as select v9, MIN(v52) as v52 from aggJoin8469715493384077458 group by v9;
create or replace view aggJoin6969403393548908822 as select v52 from char_name as chn, aggView7939943175640228395 where chn.id=aggView7939943175640228395.v9 and ((name LIKE '%Tony%Stark%') OR (name LIKE '%Iron%Man%')) and name NOT LIKE '%Sherlock%';
create or replace view res as select MIN(v52) as v52 from aggJoin6969403393548908822;
select sum(v52) from res;