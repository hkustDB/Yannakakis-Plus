create or replace view aggView905355386695665313 as select id as v23 from keyword as k where keyword IN ('superhero','sequel','second-part','marvel-comics','based-on-comic','tv-special','fight','violence');
create or replace view aggJoin2329374510703154482 as select movie_id as v40 from movie_keyword as mk, aggView905355386695665313 where mk.keyword_id=aggView905355386695665313.v23;
create or replace view aggView7264349920506460457 as select id as v5 from comp_cast_type as cct1 where kind= 'cast';
create or replace view aggJoin1623191826493608001 as select movie_id as v40, status_id as v7 from complete_cast as cc, aggView7264349920506460457 where cc.subject_id=aggView7264349920506460457.v5;
create or replace view aggView4177163412278403861 as select id as v7 from comp_cast_type as cct2 where kind LIKE '%complete%';
create or replace view aggJoin1983791555969409310 as select v40 from aggJoin1623191826493608001 join aggView4177163412278403861 using(v7);
create or replace view aggView486562455725127049 as select id as v31 from name as n;
create or replace view aggJoin8145932152067523973 as select movie_id as v40, person_role_id as v9 from cast_info as ci, aggView486562455725127049 where ci.person_id=aggView486562455725127049.v31;
create or replace view aggView6658501223009614375 as select v40 from aggJoin1983791555969409310 group by v40;
create or replace view aggJoin2969134826920028871 as select v40 from aggJoin2329374510703154482 join aggView6658501223009614375 using(v40);
create or replace view aggView7071269003628631907 as select v40 from aggJoin2969134826920028871 group by v40;
create or replace view aggJoin3703989786676293536 as select id as v40, title as v41, kind_id as v26 from title as t, aggView7071269003628631907 where t.id=aggView7071269003628631907.v40 and production_year>1950;
create or replace view aggView3529662855768817924 as select id as v26 from kind_type as kt where kind= 'movie';
create or replace view aggJoin7575412041583093113 as select v40, v41 from aggJoin3703989786676293536 join aggView3529662855768817924 using(v26);
create or replace view aggView4076320843026974707 as select v40, MIN(v41) as v52 from aggJoin7575412041583093113 group by v40;
create or replace view aggJoin6857958497817264698 as select v9, v52 from aggJoin8145932152067523973 join aggView4076320843026974707 using(v40);
create or replace view aggView2546538069301593145 as select v9, MIN(v52) as v52 from aggJoin6857958497817264698 group by v9;
create or replace view aggJoin1128631956799274347 as select v52 from char_name as chn, aggView2546538069301593145 where chn.id=aggView2546538069301593145.v9 and ((name LIKE '%Tony%Stark%') OR (name LIKE '%Iron%Man%')) and name NOT LIKE '%Sherlock%';
create or replace view res as select MIN(v52) as v52 from aggJoin1128631956799274347;
select sum(v52) from res;