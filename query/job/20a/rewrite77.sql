create or replace view aggView1132767261486553677 as select id as v23 from keyword as k where keyword IN ('superhero','sequel','second-part','marvel-comics','based-on-comic','tv-special','fight','violence');
create or replace view aggJoin3820925689336541585 as select movie_id as v40 from movie_keyword as mk, aggView1132767261486553677 where mk.keyword_id=aggView1132767261486553677.v23;
create or replace view aggView3649883967272127479 as select v40 from aggJoin3820925689336541585 group by v40;
create or replace view aggJoin5299380187664835473 as select id as v40, title as v41, kind_id as v26 from title as t, aggView3649883967272127479 where t.id=aggView3649883967272127479.v40 and production_year>1950;
create or replace view aggView926200096212656440 as select id as v7 from comp_cast_type as cct2 where kind LIKE '%complete%';
create or replace view aggJoin1822067587304251546 as select movie_id as v40, subject_id as v5 from complete_cast as cc, aggView926200096212656440 where cc.status_id=aggView926200096212656440.v7;
create or replace view aggView7403067941852565283 as select id as v31 from name as n;
create or replace view aggJoin6525758585295917433 as select movie_id as v40, person_role_id as v9 from cast_info as ci, aggView7403067941852565283 where ci.person_id=aggView7403067941852565283.v31;
create or replace view aggView386287505682212973 as select id as v9 from char_name as chn where ((name LIKE '%Tony%Stark%') OR (name LIKE '%Iron%Man%')) and name NOT LIKE '%Sherlock%';
create or replace view aggJoin8441372415054549563 as select v40 from aggJoin6525758585295917433 join aggView386287505682212973 using(v9);
create or replace view aggView5618425470219946152 as select v40 from aggJoin8441372415054549563 group by v40;
create or replace view aggJoin3470006949830262430 as select v40, v5 from aggJoin1822067587304251546 join aggView5618425470219946152 using(v40);
create or replace view aggView6022690452989042729 as select id as v26 from kind_type as kt where kind= 'movie';
create or replace view aggJoin3877079782836368394 as select v40, v41 from aggJoin5299380187664835473 join aggView6022690452989042729 using(v26);
create or replace view aggView7126092516019314021 as select v40, MIN(v41) as v52 from aggJoin3877079782836368394 group by v40;
create or replace view aggJoin3552255316105097471 as select v5, v52 from aggJoin3470006949830262430 join aggView7126092516019314021 using(v40);
create or replace view aggView1899572936196334846 as select v5, MIN(v52) as v52 from aggJoin3552255316105097471 group by v5;
create or replace view aggJoin8441842634075517985 as select v52 from comp_cast_type as cct1, aggView1899572936196334846 where cct1.id=aggView1899572936196334846.v5 and kind= 'cast';
create or replace view res as select MIN(v52) as v52 from aggJoin8441842634075517985;
select sum(v52) from res;