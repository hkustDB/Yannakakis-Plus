create or replace view aggView3066054481503422395 as select id as v23 from keyword as k where keyword IN ('superhero','sequel','second-part','marvel-comics','based-on-comic','tv-special','fight','violence');
create or replace view aggJoin8775974887570363248 as select movie_id as v40 from movie_keyword as mk, aggView3066054481503422395 where mk.keyword_id=aggView3066054481503422395.v23;
create or replace view aggView7026872555292505694 as select id as v5 from comp_cast_type as cct1 where kind= 'cast';
create or replace view aggJoin1554874948744789031 as select movie_id as v40, status_id as v7 from complete_cast as cc, aggView7026872555292505694 where cc.subject_id=aggView7026872555292505694.v5;
create or replace view aggView4347656349292085821 as select id as v31 from name as n;
create or replace view aggJoin7867174825487908535 as select movie_id as v40, person_role_id as v9 from cast_info as ci, aggView4347656349292085821 where ci.person_id=aggView4347656349292085821.v31;
create or replace view aggView9186490157987405265 as select id as v9 from char_name as chn where ((name LIKE '%Tony%Stark%') OR (name LIKE '%Iron%Man%')) and name NOT LIKE '%Sherlock%';
create or replace view aggJoin2553887930643376745 as select v40 from aggJoin7867174825487908535 join aggView9186490157987405265 using(v9);
create or replace view aggView9043944143719071176 as select v40 from aggJoin2553887930643376745 group by v40;
create or replace view aggJoin3437039344266971771 as select v40 from aggJoin8775974887570363248 join aggView9043944143719071176 using(v40);
create or replace view aggView4829449952764231092 as select v40 from aggJoin3437039344266971771 group by v40;
create or replace view aggJoin6314403252811420829 as select id as v40, title as v41, kind_id as v26 from title as t, aggView4829449952764231092 where t.id=aggView4829449952764231092.v40 and production_year>1950;
create or replace view aggView183919402086268209 as select id as v26 from kind_type as kt where kind= 'movie';
create or replace view aggJoin9008100219271065326 as select v40, v41 from aggJoin6314403252811420829 join aggView183919402086268209 using(v26);
create or replace view aggView7242511398829037575 as select v40, MIN(v41) as v52 from aggJoin9008100219271065326 group by v40;
create or replace view aggJoin8279065536142433335 as select v7, v52 from aggJoin1554874948744789031 join aggView7242511398829037575 using(v40);
create or replace view aggView8021303553077413407 as select v7, MIN(v52) as v52 from aggJoin8279065536142433335 group by v7;
create or replace view aggJoin4896712088843748580 as select v52 from comp_cast_type as cct2, aggView8021303553077413407 where cct2.id=aggView8021303553077413407.v7 and kind LIKE '%complete%';
create or replace view res as select MIN(v52) as v52 from aggJoin4896712088843748580;
select sum(v52) from res;