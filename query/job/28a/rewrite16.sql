create or replace view aggView5245603185177768174 as select id as v9, name as v57 from company_name as cn where country_code<> '[us]';
create or replace view aggJoin1341173368230317055 as select movie_id as v45, company_type_id as v16, note as v31, v57 from movie_companies as mc, aggView5245603185177768174 where mc.company_id=aggView5245603185177768174.v9 and note NOT LIKE '%(USA)%' and note LIKE '%(200%)%';
create or replace view aggView1189659845541193199 as select id as v7 from comp_cast_type as cct2 where kind<> 'complete+verified';
create or replace view aggJoin896300000637456796 as select movie_id as v45, subject_id as v5 from complete_cast as cc, aggView1189659845541193199 where cc.status_id=aggView1189659845541193199.v7;
create or replace view aggView8954256508738808836 as select id as v20 from info_type as it2 where info= 'rating';
create or replace view aggJoin1466307069694782156 as select movie_id as v45, info as v40 from movie_info_idx as mi_idx, aggView8954256508738808836 where mi_idx.info_type_id=aggView8954256508738808836.v20 and info<'8.5';
create or replace view aggView2019876460761329498 as select id as v25 from kind_type as kt where kind IN ('movie','episode');
create or replace view aggJoin8561353329545203791 as select id as v45, title as v46 from title as t, aggView2019876460761329498 where t.kind_id=aggView2019876460761329498.v25 and production_year>2000;
create or replace view aggView4200784287708587598 as select id as v16 from company_type as ct;
create or replace view aggJoin820333919390991400 as select v45, v57 from aggJoin1341173368230317055 join aggView4200784287708587598 using(v16);
create or replace view aggView3445824368668558554 as select v45, MIN(v57) as v57 from aggJoin820333919390991400 group by v45;
create or replace view aggJoin8557885381762660921 as select movie_id as v45, keyword_id as v22, v57 from movie_keyword as mk, aggView3445824368668558554 where mk.movie_id=aggView3445824368668558554.v45;
create or replace view aggView8551690154536974050 as select id as v22 from keyword as k where keyword IN ('murder','murder-in-title','blood','violence');
create or replace view aggJoin393412383118994888 as select v45, v57 from aggJoin8557885381762660921 join aggView8551690154536974050 using(v22);
create or replace view aggView386222236495078809 as select id as v18 from info_type as it1 where info= 'countries';
create or replace view aggJoin9000833316463543075 as select movie_id as v45 from movie_info as mi, aggView386222236495078809 where mi.info_type_id=aggView386222236495078809.v18 and info IN ('Sweden','Norway','Germany','Denmark','Swedish','Danish','Norwegian','German','USA','American');
create or replace view aggView7711349429998697975 as select v45, MIN(v57) as v57 from aggJoin393412383118994888 group by v45;
create or replace view aggJoin6896102674842221895 as select v45, v40, v57 from aggJoin1466307069694782156 join aggView7711349429998697975 using(v45);
create or replace view aggView1599906798351727741 as select v45, MIN(v57) as v57, MIN(v40) as v58 from aggJoin6896102674842221895 group by v45;
create or replace view aggJoin641098253332770899 as select v45, v46, v57, v58 from aggJoin8561353329545203791 join aggView1599906798351727741 using(v45);
create or replace view aggView1974844893121354696 as select v45, MIN(v57) as v57, MIN(v58) as v58, MIN(v46) as v59 from aggJoin641098253332770899 group by v45;
create or replace view aggJoin4256976696660408825 as select v45, v57, v58, v59 from aggJoin9000833316463543075 join aggView1974844893121354696 using(v45);
create or replace view aggView7247436808320755223 as select v45, MIN(v57) as v57, MIN(v58) as v58, MIN(v59) as v59 from aggJoin4256976696660408825 group by v45;
create or replace view aggJoin5395653496344075523 as select v5, v57, v58, v59 from aggJoin896300000637456796 join aggView7247436808320755223 using(v45);
create or replace view aggView3193892151551414736 as select v5, MIN(v57) as v57, MIN(v58) as v58, MIN(v59) as v59 from aggJoin5395653496344075523 group by v5;
create or replace view aggJoin7312268808348837062 as select v57, v58, v59 from comp_cast_type as cct1, aggView3193892151551414736 where cct1.id=aggView3193892151551414736.v5 and kind= 'crew';
create or replace view res as select MIN(v57) as v57, MIN(v58) as v58, MIN(v59) as v59 from aggJoin7312268808348837062;
select sum(v57+v58+v59) from res;