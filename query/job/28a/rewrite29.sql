create or replace view aggView2419599753608750665 as select id as v18 from info_type as it1 where info= 'countries';
create or replace view aggJoin6058399287047235705 as select movie_id as v45, info as v35 from movie_info as mi, aggView2419599753608750665 where mi.info_type_id=aggView2419599753608750665.v18 and info IN ('Sweden','Norway','Germany','Denmark','Swedish','Danish','Norwegian','German','USA','American');
create or replace view aggView7915555435760499294 as select id as v20 from info_type as it2 where info= 'rating';
create or replace view aggJoin535061952034982942 as select movie_id as v45, info as v40 from movie_info_idx as mi_idx, aggView7915555435760499294 where mi_idx.info_type_id=aggView7915555435760499294.v20 and info<'8.5';
create or replace view aggView4879335513101108972 as select id as v25 from kind_type as kt where kind IN ('movie','episode');
create or replace view aggJoin146123101119029211 as select id as v45, title as v46, production_year as v49 from title as t, aggView4879335513101108972 where t.kind_id=aggView4879335513101108972.v25 and production_year>2000;
create or replace view aggView5825472440769027492 as select id as v22 from keyword as k where keyword IN ('murder','murder-in-title','blood','violence');
create or replace view aggJoin8122177899958215862 as select movie_id as v45 from movie_keyword as mk, aggView5825472440769027492 where mk.keyword_id=aggView5825472440769027492.v22;
create or replace view aggView8232079707269109826 as select id as v7 from comp_cast_type as cct2 where kind<> 'complete+verified';
create or replace view aggJoin7896251535491120372 as select movie_id as v45, subject_id as v5 from complete_cast as cc, aggView8232079707269109826 where cc.status_id=aggView8232079707269109826.v7;
create or replace view aggView3954744946821730583 as select id as v5 from comp_cast_type as cct1 where kind= 'crew';
create or replace view aggJoin8853530362539688292 as select v45 from aggJoin7896251535491120372 join aggView3954744946821730583 using(v5);
create or replace view aggView6925294189154263493 as select name as v10, id as v9 from company_name as cn where country_code<> '[us]';
create or replace view aggView7388760652382425861 as select v45 from aggJoin8853530362539688292 group by v45;
create or replace view aggJoin3598042788014079022 as select v45 from aggJoin8122177899958215862 join aggView7388760652382425861 using(v45);
create or replace view aggView3230800985527956507 as select v45 from aggJoin6058399287047235705 group by v45;
create or replace view aggJoin5525861470475534131 as select v45, v46, v49 from aggJoin146123101119029211 join aggView3230800985527956507 using(v45);
create or replace view aggView1535993376144887051 as select v46, v45 from aggJoin5525861470475534131;
create or replace view aggView8118127732195718584 as select v45 from aggJoin3598042788014079022 group by v45;
create or replace view aggJoin2945948913509427707 as select v45, v40 from aggJoin535061952034982942 join aggView8118127732195718584 using(v45);
create or replace view aggView3066504868927570083 as select v45, v40 from aggJoin2945948913509427707;
create or replace view aggView6809717948391844653 as select v45, MIN(v40) as v58 from aggView3066504868927570083 group by v45;
create or replace view aggJoin4695218662710884077 as select v46, v45, v58 from aggView1535993376144887051 join aggView6809717948391844653 using(v45);
create or replace view aggView5385435828512744863 as select v45, MIN(v58) as v58, MIN(v46) as v59 from aggJoin4695218662710884077 group by v45;
create or replace view aggJoin6715834376731811314 as select company_id as v9, company_type_id as v16, note as v31, v58, v59 from movie_companies as mc, aggView5385435828512744863 where mc.movie_id=aggView5385435828512744863.v45 and note NOT LIKE '%(USA)%' and note LIKE '%(200%)%';
create or replace view aggView4233846981623789520 as select id as v16 from company_type as ct;
create or replace view aggJoin2750696927347375532 as select v9, v31, v58, v59 from aggJoin6715834376731811314 join aggView4233846981623789520 using(v16);
create or replace view aggView4022547646215254177 as select v9, MIN(v58) as v58, MIN(v59) as v59 from aggJoin2750696927347375532 group by v9;
create or replace view aggJoin6460470768374054540 as select v10, v58, v59 from aggView6925294189154263493 join aggView4022547646215254177 using(v9);
select MIN(v10) as v57,MIN(v58) as v58,MIN(v59) as v59 from aggJoin6460470768374054540;
