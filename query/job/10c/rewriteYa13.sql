create or replace view semiUp2821991318748779926 as select movie_id as v31, company_id as v15, company_type_id as v22 from movie_companies AS mc where (company_type_id) in (select id from company_type AS ct);
create or replace view semiUp5971678007064403138 as select movie_id as v31, person_role_id as v1, role_id as v29 from cast_info AS ci where (role_id) in (select id from role_type AS rt) and note LIKE '%(producer)%';
create or replace view semiUp604501290273779306 as select v31, v1, v29 from semiUp5971678007064403138 where (v1) in (select id from char_name AS chn);
create or replace view semiUp3675031367574685922 as select v31, v15, v22 from semiUp2821991318748779926 where (v15) in (select id from company_name AS cn where country_code= '[us]');
create or replace view semiUp2099224175346109069 as select v31, v1, v29 from semiUp604501290273779306 where (v31) in (select v31 from semiUp3675031367574685922);
create or replace view semiUp7219644891851528715 as select id as v31, title as v32 from title AS t where (id) in (select v31 from semiUp2099224175346109069) and production_year>1990;
create or replace view semiDown40124497126052761 as select v31, v1, v29 from semiUp2099224175346109069 where (v31) in (select v31 from semiUp7219644891851528715);
create or replace view semiDown955711024549027402 as select v31, v15, v22 from semiUp3675031367574685922 where (v31) in (select v31 from semiDown40124497126052761);
create or replace view semiDown4570785836633224179 as select id as v1, name as v2 from char_name AS chn where (id) in (select v1 from semiDown40124497126052761);
create or replace view semiDown4858503741660940967 as select id as v29 from role_type AS rt where (id) in (select v29 from semiDown40124497126052761);
create or replace view semiDown1721065975082086390 as select id as v15 from company_name AS cn where (id) in (select v15 from semiDown955711024549027402) and country_code= '[us]';
create or replace view semiDown4135635311195303323 as select id as v22 from company_type AS ct where (id) in (select v22 from semiDown955711024549027402);
create or replace view aggView5548044600454211567 as select v22 from semiDown4135635311195303323;
create or replace view aggJoin6832399207541511534 as select v31, v15 from semiDown955711024549027402 join aggView5548044600454211567 using(v22);
create or replace view aggView2006870598972698579 as select v15 from semiDown1721065975082086390;
create or replace view aggJoin6718813485057738938 as select v31 from aggJoin6832399207541511534 join aggView2006870598972698579 using(v15);
create or replace view aggView8665457153004229973 as select v31 from aggJoin6718813485057738938 group by v31;
create or replace view aggJoin8741554767168404767 as select v31, v1, v29 from semiDown40124497126052761 join aggView8665457153004229973 using(v31);
create or replace view aggView3325260696243580067 as select v1, v2 as v43 from semiDown4570785836633224179;
create or replace view aggJoin482069463476955506 as select v31, v29, v43 from aggJoin8741554767168404767 join aggView3325260696243580067 using(v1);
create or replace view aggView3864146962790666248 as select v29 from semiDown4858503741660940967;
create or replace view aggJoin2728341066301812415 as select v31, v43 from aggJoin482069463476955506 join aggView3864146962790666248 using(v29);
create or replace view aggView8223121837982848371 as select v31, MIN(v43) as v43 from aggJoin2728341066301812415 group by v31;
create or replace view aggJoin4095170192494699325 as select v32, v43 from semiUp7219644891851528715 join aggView8223121837982848371 using(v31);
create or replace view res as select MIN(v43) as v43, MIN(v32) as v44 from aggJoin4095170192494699325;
select sum(v43), sum(v44) from res;
