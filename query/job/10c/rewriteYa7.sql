create or replace view semiUp6043882258456967403 as select movie_id as v31, person_role_id as v1, role_id as v29 from cast_info AS ci where (role_id) in (select id from role_type AS rt) and note LIKE '%(producer)%';
create or replace view semiUp2507222819229143238 as select v31, v1, v29 from semiUp6043882258456967403 where (v31) in (select id from title AS t where production_year>1990);
create or replace view semiUp8082516709906016185 as select movie_id as v31, company_id as v15, company_type_id as v22 from movie_companies AS mc where (company_id) in (select id from company_name AS cn where country_code= '[us]');
create or replace view semiUp8683867849454920926 as select v31, v1, v29 from semiUp2507222819229143238 where (v1) in (select id from char_name AS chn);
create or replace view semiUp7887036467474875788 as select v31, v15, v22 from semiUp8082516709906016185 where (v22) in (select id from company_type AS ct);
create or replace view semiUp4551450358585128022 as select v31, v15, v22 from semiUp7887036467474875788 where (v31) in (select v31 from semiUp8683867849454920926);
create or replace view semiDown278770639203415016 as select v31, v1, v29 from semiUp8683867849454920926 where (v31) in (select v31 from semiUp4551450358585128022);
create or replace view semiDown4254641595852984151 as select id as v15 from company_name AS cn where (id) in (select v15 from semiUp4551450358585128022) and country_code= '[us]';
create or replace view semiDown4659828873693362678 as select id as v22 from company_type AS ct where (id) in (select v22 from semiUp4551450358585128022);
create or replace view semiDown9037298974113140554 as select id as v1, name as v2 from char_name AS chn where (id) in (select v1 from semiDown278770639203415016);
create or replace view semiDown6029378658058500210 as select id as v31, title as v32 from title AS t where (id) in (select v31 from semiDown278770639203415016) and production_year>1990;
create or replace view semiDown6542043305387745011 as select id as v29 from role_type AS rt where (id) in (select v29 from semiDown278770639203415016);
create or replace view aggView1225652062353328887 as select v1, v2 as v43 from semiDown9037298974113140554;
create or replace view aggJoin8079311911654748033 as select v31, v29, v43 from semiDown278770639203415016 join aggView1225652062353328887 using(v1);
create or replace view aggView7803008349921290520 as select v15 from semiDown4254641595852984151;
create or replace view aggJoin9022355195499019754 as select v31, v22 from semiUp4551450358585128022 join aggView7803008349921290520 using(v15);
create or replace view aggView8102429180777769521 as select v22 from semiDown4659828873693362678;
create or replace view aggJoin8969744902541376912 as select v31 from aggJoin9022355195499019754 join aggView8102429180777769521 using(v22);
create or replace view aggView1758612687661780593 as select v29 from semiDown6542043305387745011;
create or replace view aggJoin6034156766224406135 as select v31, v43 from aggJoin8079311911654748033 join aggView1758612687661780593 using(v29);
create or replace view aggView6022649457570244644 as select v31, v32 as v44 from semiDown6029378658058500210;
create or replace view aggJoin97988285812343925 as select v31, v43, v44 from aggJoin6034156766224406135 join aggView6022649457570244644 using(v31);
create or replace view aggView95716769036450412 as select v31, MIN(v43) as v43, MIN(v44) as v44 from aggJoin97988285812343925 group by v31;
create or replace view aggJoin6738827443612876226 as select v43, v44 from aggJoin8969744902541376912 join aggView95716769036450412 using(v31);
create or replace view res as select MIN(v43) as v43, MIN(v44) as v44 from aggJoin6738827443612876226;
select sum(v43), sum(v44) from res;
