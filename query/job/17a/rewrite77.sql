create or replace view aggView8482542318915157864 as select id as v26, name as v47 from name as n where name LIKE 'B%';
create or replace view aggJoin1298907863793953795 as select movie_id as v3, v47 from cast_info as ci, aggView8482542318915157864 where ci.person_id=aggView8482542318915157864.v26;
create or replace view aggView652245408271283142 as select v3, MIN(v47) as v47 from aggJoin1298907863793953795 group by v3;
create or replace view aggJoin1550926065619367117 as select movie_id as v3, company_id as v20, v47 from movie_companies as mc, aggView652245408271283142 where mc.movie_id=aggView652245408271283142.v3;
create or replace view aggView6425694634158491002 as select id as v25 from keyword as k where keyword= 'character-name-in-title';
create or replace view aggJoin8477975359990027418 as select movie_id as v3 from movie_keyword as mk, aggView6425694634158491002 where mk.keyword_id=aggView6425694634158491002.v25;
create or replace view aggView1745520228120065394 as select v3 from aggJoin8477975359990027418 group by v3;
create or replace view aggJoin6264979728301594857 as select v3, v20, v47 as v47 from aggJoin1550926065619367117 join aggView1745520228120065394 using(v3);
create or replace view aggView3543991817139221243 as select id as v3 from title as t;
create or replace view aggJoin3674238770418775411 as select v20, v47 from aggJoin6264979728301594857 join aggView3543991817139221243 using(v3);
create or replace view aggView2213487545343673825 as select v20, MIN(v47) as v47 from aggJoin3674238770418775411 group by v20;
create or replace view aggJoin5515974426260923310 as select country_code as v10, v47 from company_name as cn, aggView2213487545343673825 where cn.id=aggView2213487545343673825.v20 and country_code= '[us]';
create or replace view res as select MIN(v47) as v47 from aggJoin5515974426260923310;
select sum(v47) from res;