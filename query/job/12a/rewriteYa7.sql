create or replace view semiUp3693685309101375769 as select movie_id as v29, info_type_id as v26, info as v27 from movie_info_idx AS mi_idx where (info_type_id) in (select (id) from info_type AS it2 where info= 'rating') and info>'8.0';
create or replace view semiUp2679380793906447477 as select movie_id as v29, company_id as v1, company_type_id as v8 from movie_companies AS mc where (company_type_id) in (select (id) from company_type AS ct where kind= 'production companies');
create or replace view semiUp7242162409016259211 as select id as v29, title as v30 from title AS t where (id) in (select (v29) from semiUp3693685309101375769) and production_year<=2008 and production_year>=2005;
create or replace view semiUp1821424918515317143 as select movie_id as v29, info_type_id as v21 from movie_info AS mi where (movie_id) in (select (v29) from semiUp7242162409016259211) and info IN ('Drama','Horror');
create or replace view semiUp1953400759960164415 as select v29, v1, v8 from semiUp2679380793906447477 where (v1) in (select (id) from company_name AS cn where country_code= '[us]');
create or replace view semiUp1720630140092600640 as select v29, v21 from semiUp1821424918515317143 where (v29) in (select (v29) from semiUp1953400759960164415);
create or replace view semiUp6865055654167135352 as select id as v21 from info_type AS it1 where (id) in (select (v21) from semiUp1720630140092600640) and info= 'genres';
create or replace view semiDown5336253910502710183 as select v29, v21 from semiUp1720630140092600640 where (v21) in (select (v21) from semiUp6865055654167135352);
create or replace view semiDown2759346693681848796 as select v29, v30 from semiUp7242162409016259211 where (v29) in (select (v29) from semiDown5336253910502710183);
create or replace view semiDown3789037824277661639 as select v29, v1, v8 from semiUp1953400759960164415 where (v29) in (select (v29) from semiDown5336253910502710183);
create or replace view semiDown2675318453206924762 as select v29, v26, v27 from semiUp3693685309101375769 where (v29) in (select (v29) from semiDown2759346693681848796);
create or replace view semiDown7545965134233597198 as select id as v8 from company_type AS ct where (id) in (select (v8) from semiDown3789037824277661639) and kind= 'production companies';
create or replace view semiDown9071719187738123084 as select id as v1, name as v2 from company_name AS cn where (id) in (select (v1) from semiDown3789037824277661639) and country_code= '[us]';
create or replace view semiDown3074380923302218048 as select id as v26 from info_type AS it2 where (id) in (select (v26) from semiDown2675318453206924762) and info= 'rating';
create or replace view aggView7281739673729548026 as select v1, v2 as v41 from semiDown9071719187738123084;
create or replace view aggJoin954962540476420074 as select v29, v8, v41 from semiDown3789037824277661639 join aggView7281739673729548026 using(v1);
create or replace view aggView2892145598325211487 as select v26 from semiDown3074380923302218048;
create or replace view aggJoin3742144930968286046 as select v29, v27 from semiDown2675318453206924762 join aggView2892145598325211487 using(v26);
create or replace view aggView6317003350207015731 as select v29, MIN(v27) as v42 from aggJoin3742144930968286046 group by v29;
create or replace view aggJoin2332107503684861295 as select v29, v30, v42 from semiDown2759346693681848796 join aggView6317003350207015731 using(v29);
create or replace view aggView7947106789249055378 as select v8 from semiDown7545965134233597198;
create or replace view aggJoin819769001583499465 as select v29, v41 from aggJoin954962540476420074 join aggView7947106789249055378 using(v8);
create or replace view aggView4708154677568341718 as select v29, MIN(v41) as v41 from aggJoin819769001583499465 group by v29;
create or replace view aggJoin4879295462367926593 as select v29, v21, v41 from semiDown5336253910502710183 join aggView4708154677568341718 using(v29);
create or replace view aggView5575936139480937626 as select v29, MIN(v42) as v42, MIN(v30) as v43 from aggJoin2332107503684861295 group by v29;
create or replace view aggJoin2309629540366018287 as select v21, v41 as v41, v42, v43 from aggJoin4879295462367926593 join aggView5575936139480937626 using(v29);
create or replace view aggView8092927507320651018 as select v21, MIN(v41) as v41, MIN(v42) as v42, MIN(v43) as v43 from aggJoin2309629540366018287 group by v21;
create or replace view aggJoin1291363050253172892 as select v41, v42, v43 from semiUp6865055654167135352 join aggView8092927507320651018 using(v21);
select MIN(v41) as v41,MIN(v42) as v42,MIN(v43) as v43 from aggJoin1291363050253172892;
