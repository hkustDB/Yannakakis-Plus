create or replace view semiUp6773429132346674335 as select movie_id as v29, company_id as v1, company_type_id as v8 from movie_companies AS mc where (company_id) in (select (id) from company_name AS cn where country_code= '[us]');
create or replace view semiUp7123273889560785541 as select movie_id as v29, info_type_id as v26, info as v27 from movie_info_idx AS mi_idx where (info_type_id) in (select (id) from info_type AS it2 where info= 'rating') and info>'8.0';
create or replace view semiUp3352159386097749753 as select movie_id as v29, info_type_id as v21 from movie_info AS mi where (info_type_id) in (select (id) from info_type AS it1 where info= 'genres') and info IN ('Drama','Horror');
create or replace view semiUp642055055635017043 as select id as v29, title as v30 from title AS t where (id) in (select (v29) from semiUp3352159386097749753) and production_year<=2008 and production_year>=2005;
create or replace view semiUp7441995909597181411 as select v29, v26, v27 from semiUp7123273889560785541 where (v29) in (select (v29) from semiUp642055055635017043);
create or replace view semiUp8732290393225927502 as select v29, v1, v8 from semiUp6773429132346674335 where (v29) in (select (v29) from semiUp7441995909597181411);
create or replace view semiUp3424524287614848615 as select id as v8 from company_type AS ct where (id) in (select (v8) from semiUp8732290393225927502) and kind= 'production companies';
create or replace view semiDown6887196349829615151 as select v29, v1, v8 from semiUp8732290393225927502 where (v8) in (select (v8) from semiUp3424524287614848615);
create or replace view semiDown3727749320558185155 as select v29, v26, v27 from semiUp7441995909597181411 where (v29) in (select (v29) from semiDown6887196349829615151);
create or replace view semiDown644345268804615860 as select id as v1, name as v2 from company_name AS cn where (id) in (select (v1) from semiDown6887196349829615151) and country_code= '[us]';
create or replace view semiDown8156520084936697684 as select v29, v30 from semiUp642055055635017043 where (v29) in (select (v29) from semiDown3727749320558185155);
create or replace view semiDown6284502301097691356 as select id as v26 from info_type AS it2 where (id) in (select (v26) from semiDown3727749320558185155) and info= 'rating';
create or replace view semiDown5487739015739027806 as select v29, v21 from semiUp3352159386097749753 where (v29) in (select (v29) from semiDown8156520084936697684);
create or replace view semiDown1135928857399586738 as select id as v21 from info_type AS it1 where (id) in (select (v21) from semiDown5487739015739027806) and info= 'genres';
create or replace view aggView7404927639419035509 as select v21 from semiDown1135928857399586738;
create or replace view aggJoin4280489457363692354 as select v29 from semiDown5487739015739027806 join aggView7404927639419035509 using(v21);
create or replace view aggView3739994984434836842 as select v29 from aggJoin4280489457363692354 group by v29;
create or replace view aggJoin2737267535012272785 as select v29, v30 from semiDown8156520084936697684 join aggView3739994984434836842 using(v29);
create or replace view aggView8596224937437314938 as select v26 from semiDown6284502301097691356;
create or replace view aggJoin7244519573287327288 as select v29, v27 from semiDown3727749320558185155 join aggView8596224937437314938 using(v26);
create or replace view aggView6393885640229089716 as select v29, MIN(v30) as v43 from aggJoin2737267535012272785 group by v29;
create or replace view aggJoin4148356648005507389 as select v29, v27, v43 from aggJoin7244519573287327288 join aggView6393885640229089716 using(v29);
create or replace view aggView2041373517789623977 as select v1, v2 as v41 from semiDown644345268804615860;
create or replace view aggJoin7206919692153457257 as select v29, v8, v41 from semiDown6887196349829615151 join aggView2041373517789623977 using(v1);
create or replace view aggView6991338464125882964 as select v29, MIN(v43) as v43, MIN(v27) as v42 from aggJoin4148356648005507389 group by v29;
create or replace view aggJoin6323381521352019210 as select v8, v41 as v41, v43, v42 from aggJoin7206919692153457257 join aggView6991338464125882964 using(v29);
create or replace view aggView3809784714169299160 as select v8, MIN(v41) as v41, MIN(v43) as v43, MIN(v42) as v42 from aggJoin6323381521352019210 group by v8;
create or replace view aggJoin1600088047810594882 as select v41, v43, v42 from semiUp3424524287614848615 join aggView3809784714169299160 using(v8);
select MIN(v41) as v41,MIN(v42) as v42,MIN(v43) as v43 from aggJoin1600088047810594882;
