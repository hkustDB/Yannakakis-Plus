create or replace view semiUp5967704853478523971 as select movie_id as v29, company_id as v1, company_type_id as v8 from movie_companies AS mc where (company_type_id) in (select (id) from company_type AS ct where kind= 'production companies');
create or replace view semiUp1615818083674114595 as select v29, v1, v8 from semiUp5967704853478523971 where (v1) in (select (id) from company_name AS cn where country_code= '[us]');
create or replace view semiUp4799980759103266236 as select id as v29, title as v30 from title AS t where (id) in (select (v29) from semiUp1615818083674114595) and production_year<=2008 and production_year>=2005;
create or replace view semiUp6522479195832286513 as select movie_id as v29, info_type_id as v26, info as v27 from movie_info_idx AS mi_idx where (info_type_id) in (select (id) from info_type AS it2 where info= 'rating') and info>'8.0';
create or replace view semiUp5576887008893356792 as select v29, v30 from semiUp4799980759103266236 where (v29) in (select (v29) from semiUp6522479195832286513);
create or replace view semiUp3516344540019685986 as select movie_id as v29, info_type_id as v21 from movie_info AS mi where (movie_id) in (select (v29) from semiUp5576887008893356792) and info IN ('Drama','Horror');
create or replace view semiUp1052316764130065223 as select id as v21 from info_type AS it1 where (id) in (select (v21) from semiUp3516344540019685986) and info= 'genres';
create or replace view semiDown127435426109983956 as select v29, v21 from semiUp3516344540019685986 where (v21) in (select (v21) from semiUp1052316764130065223);
create or replace view semiDown5627988205626465447 as select v29, v30 from semiUp5576887008893356792 where (v29) in (select (v29) from semiDown127435426109983956);
create or replace view semiDown6457502831620910696 as select v29, v1, v8 from semiUp1615818083674114595 where (v29) in (select (v29) from semiDown5627988205626465447);
create or replace view semiDown3418282365729119220 as select v29, v26, v27 from semiUp6522479195832286513 where (v29) in (select (v29) from semiDown5627988205626465447);
create or replace view semiDown8778836708153392517 as select id as v8 from company_type AS ct where (id) in (select (v8) from semiDown6457502831620910696) and kind= 'production companies';
create or replace view semiDown3439982952113387937 as select id as v1, name as v2 from company_name AS cn where (id) in (select (v1) from semiDown6457502831620910696) and country_code= '[us]';
create or replace view semiDown6490372526123588006 as select id as v26 from info_type AS it2 where (id) in (select (v26) from semiDown3418282365729119220) and info= 'rating';
create or replace view aggView7120541372933274737 as select v1, v2 as v41 from semiDown3439982952113387937;
create or replace view aggJoin3888222096866124871 as select v29, v8, v41 from semiDown6457502831620910696 join aggView7120541372933274737 using(v1);
create or replace view aggView4456712297663001630 as select v26 from semiDown6490372526123588006;
create or replace view aggJoin2270640860453198088 as select v29, v27 from semiDown3418282365729119220 join aggView4456712297663001630 using(v26);
create or replace view aggView953773459234054486 as select v8 from semiDown8778836708153392517;
create or replace view aggJoin8902435051505671604 as select v29, v41 from aggJoin3888222096866124871 join aggView953773459234054486 using(v8);
create or replace view aggView1473173943075802384 as select v29, MIN(v27) as v42 from aggJoin2270640860453198088 group by v29;
create or replace view aggJoin8643916447663806125 as select v29, v30, v42 from semiDown5627988205626465447 join aggView1473173943075802384 using(v29);
create or replace view aggView8153416525698808093 as select v29, MIN(v41) as v41 from aggJoin8902435051505671604 group by v29;
create or replace view aggJoin8638578396516760377 as select v29, v30, v42 as v42, v41 from aggJoin8643916447663806125 join aggView8153416525698808093 using(v29);
create or replace view aggView4972283265260464975 as select v29, MIN(v42) as v42, MIN(v41) as v41, MIN(v30) as v43 from aggJoin8638578396516760377 group by v29;
create or replace view aggJoin6525543535418685451 as select v21, v42, v41, v43 from semiDown127435426109983956 join aggView4972283265260464975 using(v29);
create or replace view aggView5808760747902120481 as select v21, MIN(v42) as v42, MIN(v41) as v41, MIN(v43) as v43 from aggJoin6525543535418685451 group by v21;
create or replace view aggJoin4237585833489400684 as select v42, v41, v43 from semiUp1052316764130065223 join aggView5808760747902120481 using(v21);
select MIN(v41) as v41,MIN(v42) as v42,MIN(v43) as v43 from aggJoin4237585833489400684;
