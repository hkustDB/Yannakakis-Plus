create or replace view semiUp4467111859433398267 as select movie_id as v29, info_type_id as v21 from movie_info AS mi where (info_type_id) in (select (id) from info_type AS it1 where info= 'genres') and info IN ('Drama','Horror');
create or replace view semiUp8221700177392227105 as select movie_id as v29, info_type_id as v26, info as v27 from movie_info_idx AS mi_idx where (info_type_id) in (select (id) from info_type AS it2 where info= 'rating') and info>'8.0';
create or replace view semiUp4555792635283256659 as select v29, v26, v27 from semiUp8221700177392227105 where (v29) in (select (v29) from semiUp4467111859433398267);
create or replace view semiUp8921451278408642027 as select id as v29, title as v30 from title AS t where (id) in (select (v29) from semiUp4555792635283256659) and production_year<=2008 and production_year>=2005;
create or replace view semiUp8603713698069692501 as select movie_id as v29, company_id as v1, company_type_id as v8 from movie_companies AS mc where (company_id) in (select (id) from company_name AS cn where country_code= '[us]');
create or replace view semiUp5085171536218066538 as select v29, v1, v8 from semiUp8603713698069692501 where (v29) in (select (v29) from semiUp8921451278408642027);
create or replace view semiUp109428794536852015 as select id as v8 from company_type AS ct where (id) in (select (v8) from semiUp5085171536218066538) and kind= 'production companies';
create or replace view semiDown8287159922751824677 as select v29, v1, v8 from semiUp5085171536218066538 where (v8) in (select (v8) from semiUp109428794536852015);
create or replace view semiDown3089461696929213738 as select v29, v30 from semiUp8921451278408642027 where (v29) in (select (v29) from semiDown8287159922751824677);
create or replace view semiDown8045572386082726002 as select id as v1, name as v2 from company_name AS cn where (id) in (select (v1) from semiDown8287159922751824677) and country_code= '[us]';
create or replace view semiDown2299247847175865941 as select v29, v26, v27 from semiUp4555792635283256659 where (v29) in (select (v29) from semiDown3089461696929213738);
create or replace view semiDown6777104988887249639 as select v29, v21 from semiUp4467111859433398267 where (v29) in (select (v29) from semiDown2299247847175865941);
create or replace view semiDown5322791639889587009 as select id as v26 from info_type AS it2 where (id) in (select (v26) from semiDown2299247847175865941) and info= 'rating';
create or replace view semiDown2289128239578302336 as select id as v21 from info_type AS it1 where (id) in (select (v21) from semiDown6777104988887249639) and info= 'genres';
create or replace view aggView5383553069872732456 as select v21 from semiDown2289128239578302336;
create or replace view aggJoin88985466602943073 as select v29 from semiDown6777104988887249639 join aggView5383553069872732456 using(v21);
create or replace view aggView5697911393449276317 as select v29 from aggJoin88985466602943073 group by v29;
create or replace view aggJoin5115731640772910867 as select v29, v26, v27 from semiDown2299247847175865941 join aggView5697911393449276317 using(v29);
create or replace view aggView2520091926461148842 as select v26 from semiDown5322791639889587009;
create or replace view aggJoin3882530037222973970 as select v29, v27 from aggJoin5115731640772910867 join aggView2520091926461148842 using(v26);
create or replace view aggView8219074258947789892 as select v29, MIN(v27) as v42 from aggJoin3882530037222973970 group by v29;
create or replace view aggJoin1136295170309451797 as select v29, v30, v42 from semiDown3089461696929213738 join aggView8219074258947789892 using(v29);
create or replace view aggView237455859799055183 as select v1, v2 as v41 from semiDown8045572386082726002;
create or replace view aggJoin3987731359044280503 as select v29, v8, v41 from semiDown8287159922751824677 join aggView237455859799055183 using(v1);
create or replace view aggView8564867704662203198 as select v29, MIN(v42) as v42, MIN(v30) as v43 from aggJoin1136295170309451797 group by v29;
create or replace view aggJoin8831681642344466862 as select v8, v41 as v41, v42, v43 from aggJoin3987731359044280503 join aggView8564867704662203198 using(v29);
create or replace view aggView4482365852547120503 as select v8, MIN(v41) as v41, MIN(v42) as v42, MIN(v43) as v43 from aggJoin8831681642344466862 group by v8;
create or replace view aggJoin8197694041811743320 as select v41, v42, v43 from semiUp109428794536852015 join aggView4482365852547120503 using(v8);
select MIN(v41) as v41,MIN(v42) as v42,MIN(v43) as v43 from aggJoin8197694041811743320;
