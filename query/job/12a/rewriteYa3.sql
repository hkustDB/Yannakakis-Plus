create or replace view semiUp7481569980063791406 as select movie_id as v29, info_type_id as v26, info as v27 from movie_info_idx AS mi_idx where (info_type_id) in (select (id) from info_type AS it2 where info= 'rating') and info>'8.0';
create or replace view semiUp1380078304659451987 as select movie_id as v29, info_type_id as v21 from movie_info AS mi where (movie_id) in (select (v29) from semiUp7481569980063791406) and info IN ('Drama','Horror');
create or replace view semiUp3220848848682857419 as select movie_id as v29, company_id as v1, company_type_id as v8 from movie_companies AS mc where (company_id) in (select (id) from company_name AS cn where country_code= '[us]');
create or replace view semiUp7092366087527977273 as select v29, v21 from semiUp1380078304659451987 where (v21) in (select (id) from info_type AS it1 where info= 'genres');
create or replace view semiUp8242611765360478524 as select id as v29, title as v30 from title AS t where (id) in (select (v29) from semiUp7092366087527977273) and production_year<=2008 and production_year>=2005;
create or replace view semiUp6043813603425798015 as select v29, v1, v8 from semiUp3220848848682857419 where (v29) in (select (v29) from semiUp8242611765360478524);
create or replace view semiUp6717115053785648471 as select id as v8 from company_type AS ct where (id) in (select (v8) from semiUp6043813603425798015) and kind= 'production companies';
create or replace view semiDown5029934533834069995 as select v29, v1, v8 from semiUp6043813603425798015 where (v8) in (select (v8) from semiUp6717115053785648471);
create or replace view semiDown8026210741562010420 as select v29, v30 from semiUp8242611765360478524 where (v29) in (select (v29) from semiDown5029934533834069995);
create or replace view semiDown7620475738278211317 as select id as v1, name as v2 from company_name AS cn where (id) in (select (v1) from semiDown5029934533834069995) and country_code= '[us]';
create or replace view semiDown558892908349350549 as select v29, v21 from semiUp7092366087527977273 where (v29) in (select (v29) from semiDown8026210741562010420);
create or replace view semiDown3213468416327207876 as select v29, v26, v27 from semiUp7481569980063791406 where (v29) in (select (v29) from semiDown558892908349350549);
create or replace view semiDown7328337499468223555 as select id as v21 from info_type AS it1 where (id) in (select (v21) from semiDown558892908349350549) and info= 'genres';
create or replace view semiDown2020076391884287304 as select id as v26 from info_type AS it2 where (id) in (select (v26) from semiDown3213468416327207876) and info= 'rating';
create or replace view aggView8534734328184986945 as select v1, v2 as v41 from semiDown7620475738278211317;
create or replace view aggJoin5205388768430022906 as select v29, v8, v41 from semiDown5029934533834069995 join aggView8534734328184986945 using(v1);
create or replace view aggView819028413776199452 as select v21 from semiDown7328337499468223555;
create or replace view aggJoin472371805570969615 as select v29 from semiDown558892908349350549 join aggView819028413776199452 using(v21);
create or replace view aggView8351636420147660191 as select v26 from semiDown2020076391884287304;
create or replace view aggJoin7901938978806586704 as select v29, v27 from semiDown3213468416327207876 join aggView8351636420147660191 using(v26);
create or replace view aggView7584913094439748819 as select v29, MIN(v27) as v42 from aggJoin7901938978806586704 group by v29;
create or replace view aggJoin4799442738233225055 as select v29, v42 from aggJoin472371805570969615 join aggView7584913094439748819 using(v29);
create or replace view aggView5027082109710150 as select v29, MIN(v42) as v42 from aggJoin4799442738233225055 group by v29;
create or replace view aggJoin6085753968106382268 as select v29, v30, v42 from semiDown8026210741562010420 join aggView5027082109710150 using(v29);
create or replace view aggView83659991322854904 as select v29, MIN(v42) as v42, MIN(v30) as v43 from aggJoin6085753968106382268 group by v29;
create or replace view aggJoin5408014553144720420 as select v8, v41 as v41, v42, v43 from aggJoin5205388768430022906 join aggView83659991322854904 using(v29);
create or replace view aggView2124793972075410674 as select v8, MIN(v41) as v41, MIN(v42) as v42, MIN(v43) as v43 from aggJoin5408014553144720420 group by v8;
create or replace view aggJoin2831189102692759520 as select v41, v42, v43 from semiUp6717115053785648471 join aggView2124793972075410674 using(v8);
select MIN(v41) as v41,MIN(v42) as v42,MIN(v43) as v43 from aggJoin2831189102692759520;
