create or replace view semiUp5608300901363597063 as select movie_id as v29, info_type_id as v21 from movie_info AS mi where (info_type_id) in (select (id) from info_type AS it1 where info= 'genres') and info IN ('Drama','Horror');
create or replace view semiUp1636142416297206173 as select movie_id as v29, company_id as v1, company_type_id as v8 from movie_companies AS mc where (company_type_id) in (select (id) from company_type AS ct where kind= 'production companies');
create or replace view semiUp954454677237265847 as select v29, v1, v8 from semiUp1636142416297206173 where (v1) in (select (id) from company_name AS cn where country_code= '[us]');
create or replace view semiUp4643449998704115715 as select movie_id as v29, info_type_id as v26, info as v27 from movie_info_idx AS mi_idx where (info_type_id) in (select (id) from info_type AS it2 where info= 'rating') and info>'8.0';
create or replace view semiUp364185176564886828 as select v29, v26, v27 from semiUp4643449998704115715 where (v29) in (select (v29) from semiUp954454677237265847);
create or replace view semiUp2720520282955624254 as select id as v29, title as v30 from title AS t where (id) in (select (v29) from semiUp364185176564886828) and production_year<=2008 and production_year>=2005;
create or replace view semiUp2021082828786026948 as select v29, v21 from semiUp5608300901363597063 where (v29) in (select (v29) from semiUp2720520282955624254);
create or replace view semiDown2902246332273707959 as select id as v21 from info_type AS it1 where (id) in (select (v21) from semiUp2021082828786026948) and info= 'genres';
create or replace view semiDown7592226327835763557 as select v29, v30 from semiUp2720520282955624254 where (v29) in (select (v29) from semiUp2021082828786026948);
create or replace view semiDown4930686559375758479 as select v29, v26, v27 from semiUp364185176564886828 where (v29) in (select (v29) from semiDown7592226327835763557);
create or replace view semiDown8474035226894142853 as select v29, v1, v8 from semiUp954454677237265847 where (v29) in (select (v29) from semiDown4930686559375758479);
create or replace view semiDown7341017142786802594 as select id as v26 from info_type AS it2 where (id) in (select (v26) from semiDown4930686559375758479) and info= 'rating';
create or replace view semiDown2791654677740713527 as select id as v8 from company_type AS ct where (id) in (select (v8) from semiDown8474035226894142853) and kind= 'production companies';
create or replace view semiDown1247371808567475513 as select id as v1, name as v2 from company_name AS cn where (id) in (select (v1) from semiDown8474035226894142853) and country_code= '[us]';
create or replace view aggView2402933605704810095 as select v1, v2 as v41 from semiDown1247371808567475513;
create or replace view aggJoin7659181530934665194 as select v29, v8, v41 from semiDown8474035226894142853 join aggView2402933605704810095 using(v1);
create or replace view aggView5281164101212302280 as select v8 from semiDown2791654677740713527;
create or replace view aggJoin3072130188286913201 as select v29, v41 from aggJoin7659181530934665194 join aggView5281164101212302280 using(v8);
create or replace view aggView1753532830318091051 as select v29, MIN(v41) as v41 from aggJoin3072130188286913201 group by v29;
create or replace view aggJoin4477146073352390989 as select v29, v26, v27, v41 from semiDown4930686559375758479 join aggView1753532830318091051 using(v29);
create or replace view aggView341130024579747133 as select v21 from semiDown2902246332273707959;
create or replace view aggJoin860689752737320845 as select v29 from semiUp2021082828786026948 join aggView341130024579747133 using(v21);
create or replace view aggView8651051642837707911 as select v26 from semiDown7341017142786802594;
create or replace view aggJoin5347541915763874423 as select v29, v27, v41 from aggJoin4477146073352390989 join aggView8651051642837707911 using(v26);
create or replace view aggView656035434515371179 as select v29, MIN(v41) as v41, MIN(v27) as v42 from aggJoin5347541915763874423 group by v29;
create or replace view aggJoin1700830996913240366 as select v29, v30, v41, v42 from semiDown7592226327835763557 join aggView656035434515371179 using(v29);
create or replace view aggView521713439455000987 as select v29, MIN(v41) as v41, MIN(v42) as v42, MIN(v30) as v43 from aggJoin1700830996913240366 group by v29;
create or replace view aggJoin4746987992713858852 as select v41, v42, v43 from aggJoin860689752737320845 join aggView521713439455000987 using(v29);
select MIN(v41) as v41,MIN(v42) as v42,MIN(v43) as v43 from aggJoin4746987992713858852;
