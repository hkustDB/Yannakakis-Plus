create or replace view semiUp5396837766935619590 as select movie_id as v29, info_type_id as v26, info as v27 from movie_info_idx AS mi_idx where (movie_id) in (select (id) from title AS t where production_year<=2008 and production_year>=2005) and info>'8.0';
create or replace view semiUp3887478072091634738 as select movie_id as v29, info_type_id as v21 from movie_info AS mi where (info_type_id) in (select (id) from info_type AS it1 where info= 'genres') and info IN ('Drama','Horror');
create or replace view semiUp6025632586606196176 as select movie_id as v29, company_id as v1, company_type_id as v8 from movie_companies AS mc where (company_type_id) in (select (id) from company_type AS ct where kind= 'production companies');
create or replace view semiUp7932593054587693738 as select v29, v1, v8 from semiUp6025632586606196176 where (v1) in (select (id) from company_name AS cn where country_code= '[us]');
create or replace view semiUp5470264700906802894 as select v29, v21 from semiUp3887478072091634738 where (v29) in (select (v29) from semiUp7932593054587693738);
create or replace view semiUp7268683413144856389 as select v29, v26, v27 from semiUp5396837766935619590 where (v29) in (select (v29) from semiUp5470264700906802894);
create or replace view semiUp1494844016719053921 as select id as v26 from info_type AS it2 where (id) in (select (v26) from semiUp7268683413144856389) and info= 'rating';
create or replace view semiDown6333250389049560392 as select v29, v26, v27 from semiUp7268683413144856389 where (v26) in (select (v26) from semiUp1494844016719053921);
create or replace view semiDown831032818755986843 as select v29, v21 from semiUp5470264700906802894 where (v29) in (select (v29) from semiDown6333250389049560392);
create or replace view semiDown9171666146304155721 as select id as v29, title as v30 from title AS t where (id) in (select (v29) from semiDown6333250389049560392) and production_year<=2008 and production_year>=2005;
create or replace view semiDown4249126253005032177 as select id as v21 from info_type AS it1 where (id) in (select (v21) from semiDown831032818755986843) and info= 'genres';
create or replace view semiDown7821847530619680311 as select v29, v1, v8 from semiUp7932593054587693738 where (v29) in (select (v29) from semiDown831032818755986843);
create or replace view semiDown7042116991674750345 as select id as v8 from company_type AS ct where (id) in (select (v8) from semiDown7821847530619680311) and kind= 'production companies';
create or replace view semiDown8329584311359301761 as select id as v1, name as v2 from company_name AS cn where (id) in (select (v1) from semiDown7821847530619680311) and country_code= '[us]';
create or replace view aggView3386015799194779742 as select v1, v2 as v41 from semiDown8329584311359301761;
create or replace view aggJoin3162251665281053655 as select v29, v8, v41 from semiDown7821847530619680311 join aggView3386015799194779742 using(v1);
create or replace view aggView712613474623183216 as select v21 from semiDown4249126253005032177;
create or replace view aggJoin2622053112664854492 as select v29 from semiDown831032818755986843 join aggView712613474623183216 using(v21);
create or replace view aggView1585946659408185307 as select v8 from semiDown7042116991674750345;
create or replace view aggJoin4982614614158833140 as select v29, v41 from aggJoin3162251665281053655 join aggView1585946659408185307 using(v8);
create or replace view aggView1178448170432116879 as select v29, v30 as v43 from semiDown9171666146304155721;
create or replace view aggJoin5666633517422758582 as select v29, v26, v27, v43 from semiDown6333250389049560392 join aggView1178448170432116879 using(v29);
create or replace view aggView2193764364982107846 as select v29, MIN(v41) as v41 from aggJoin4982614614158833140 group by v29;
create or replace view aggJoin1679472604624918866 as select v29, v41 from aggJoin2622053112664854492 join aggView2193764364982107846 using(v29);
create or replace view aggView56463004833779184 as select v29, MIN(v41) as v41 from aggJoin1679472604624918866 group by v29;
create or replace view aggJoin8655067286088370381 as select v26, v27, v43 as v43, v41 from aggJoin5666633517422758582 join aggView56463004833779184 using(v29);
create or replace view aggView6928530088610742870 as select v26, MIN(v43) as v43, MIN(v41) as v41, MIN(v27) as v42 from aggJoin8655067286088370381 group by v26;
create or replace view aggJoin6733329224434760495 as select v43, v41, v42 from semiUp1494844016719053921 join aggView6928530088610742870 using(v26);
select MIN(v41) as v41,MIN(v42) as v42,MIN(v43) as v43 from aggJoin6733329224434760495;
