create or replace view aggView5227448873638756580 as select id as v26 from info_type as it2 where info= 'rating';
create or replace view aggJoin2251287899010001754 as select movie_id as v29, info as v27 from movie_info_idx as mi_idx, aggView5227448873638756580 where mi_idx.info_type_id=aggView5227448873638756580.v26;
create or replace view aggView5041971262943075270 as select id as v21 from info_type as it1 where info= 'genres';
create or replace view aggJoin8399655178872725670 as select movie_id as v29, info as v22 from movie_info as mi, aggView5041971262943075270 where mi.info_type_id=aggView5041971262943075270.v21 and info IN ('Drama','Horror');
create or replace view aggView7400668146259665489 as select v29, v27 from aggJoin2251287899010001754;
create or replace view aggJoin1588132200182561818 as select v29, v27 from aggView7400668146259665489 where v27>'8.0';
create or replace view aggView1119940211524315700 as select name as v2, id as v1 from company_name as cn where country_code= '[us]';
create or replace view aggView2884644482823586808 as select v29 from aggJoin8399655178872725670 group by v29;
create or replace view aggJoin2124100432460866103 as select id as v29, title as v30, production_year as v33 from title as t, aggView2884644482823586808 where t.id=aggView2884644482823586808.v29 and production_year<=2008 and production_year>=2005;
create or replace view aggView7754125029306086459 as select v29, v30 from aggJoin2124100432460866103;
create or replace view aggView5497685408247868169 as select v29, MIN(v27) as v42 from aggJoin1588132200182561818 group by v29;
create or replace view aggJoin1076773549948559712 as select movie_id as v29, company_id as v1, company_type_id as v8, v42 from movie_companies as mc, aggView5497685408247868169 where mc.movie_id=aggView5497685408247868169.v29;
create or replace view aggView2513430864633116264 as select v1, MIN(v2) as v41 from aggView1119940211524315700 group by v1;
create or replace view aggJoin5002826148314216759 as select v29, v8, v42 as v42, v41 from aggJoin1076773549948559712 join aggView2513430864633116264 using(v1);
create or replace view aggView2659646145585242641 as select id as v8 from company_type as ct where kind= 'production companies';
create or replace view aggJoin1304876005036595600 as select v29, v42, v41 from aggJoin5002826148314216759 join aggView2659646145585242641 using(v8);
create or replace view aggView6444902253118619211 as select v29, MIN(v42) as v42, MIN(v41) as v41 from aggJoin1304876005036595600 group by v29;
create or replace view aggJoin3415553172349401461 as select v30, v42, v41 from aggView7754125029306086459 join aggView6444902253118619211 using(v29);
select MIN(v41) as v41,MIN(v42) as v42,MIN(v30) as v43 from aggJoin3415553172349401461;
