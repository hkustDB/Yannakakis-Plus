create or replace view semiUp7827238516707474169 as select movie_id as v29, info_type_id as v21 from movie_info AS mi where (info_type_id) in (select (id) from info_type AS it1 where info= 'genres') and info IN ('Drama','Horror');
create or replace view semiUp8989639239337597362 as select movie_id as v29, company_id as v1, company_type_id as v8 from movie_companies AS mc where (company_type_id) in (select (id) from company_type AS ct where kind= 'production companies');
create or replace view semiUp4965486562253292112 as select v29, v1, v8 from semiUp8989639239337597362 where (v1) in (select (id) from company_name AS cn where country_code= '[us]');
create or replace view semiUp6911242344432939210 as select id as v29, title as v30 from title AS t where (id) in (select (v29) from semiUp4965486562253292112) and production_year<=2008 and production_year>=2005;
create or replace view semiUp8100484014619435200 as select movie_id as v29, info_type_id as v26, info as v27 from movie_info_idx AS mi_idx where (movie_id) in (select (v29) from semiUp6911242344432939210) and info>'8.0';
create or replace view semiUp4347371834630756703 as select v29, v26, v27 from semiUp8100484014619435200 where (v26) in (select (id) from info_type AS it2 where info= 'rating');
create or replace view semiUp5035032429254420115 as select v29, v21 from semiUp7827238516707474169 where (v29) in (select (v29) from semiUp4347371834630756703);
create or replace view semiDown6766963264834004809 as select v29, v26, v27 from semiUp4347371834630756703 where (v29) in (select (v29) from semiUp5035032429254420115);
create or replace view semiDown6961635886550971644 as select id as v21 from info_type AS it1 where (id) in (select (v21) from semiUp5035032429254420115) and info= 'genres';
create or replace view semiDown905847025310329049 as select v29, v30 from semiUp6911242344432939210 where (v29) in (select (v29) from semiDown6766963264834004809);
create or replace view semiDown529765240219915541 as select id as v26 from info_type AS it2 where (id) in (select (v26) from semiDown6766963264834004809) and info= 'rating';
create or replace view semiDown7050279675962716705 as select v29, v1, v8 from semiUp4965486562253292112 where (v29) in (select (v29) from semiDown905847025310329049);
create or replace view semiDown4174809786539723642 as select id as v8 from company_type AS ct where (id) in (select (v8) from semiDown7050279675962716705) and kind= 'production companies';
create or replace view semiDown4897093524997886146 as select id as v1, name as v2 from company_name AS cn where (id) in (select (v1) from semiDown7050279675962716705) and country_code= '[us]';
create or replace view aggView1790085646145195755 as select v26 from semiDown529765240219915541;
create or replace view aggJoin2334134413409189523 as select v29, v27 from semiDown6766963264834004809 join aggView1790085646145195755 using(v26);
create or replace view aggView5921115353163781803 as select v21 from semiDown6961635886550971644;
create or replace view aggJoin2075807338963828715 as select v29 from semiUp5035032429254420115 join aggView5921115353163781803 using(v21);
create or replace view aggView7065921065866064154 as select v1, v2 as v41 from semiDown4897093524997886146;
create or replace view aggJoin6753763128030521479 as select v29, v8, v41 from semiDown7050279675962716705 join aggView7065921065866064154 using(v1);
create or replace view aggView1105878924859415455 as select v8 from semiDown4174809786539723642;
create or replace view aggJoin3993581777997239590 as select v29, v41 from aggJoin6753763128030521479 join aggView1105878924859415455 using(v8);
create or replace view aggView3019885130944324909 as select v29, MIN(v41) as v41 from aggJoin3993581777997239590 group by v29;
create or replace view aggJoin7926752577748044730 as select v29, v30, v41 from semiDown905847025310329049 join aggView3019885130944324909 using(v29);
create or replace view aggView3961263940220396241 as select v29, MIN(v41) as v41, MIN(v30) as v43 from aggJoin7926752577748044730 group by v29;
create or replace view aggJoin5951089247145612219 as select v29, v27, v41, v43 from aggJoin2334134413409189523 join aggView3961263940220396241 using(v29);
create or replace view aggView6042760177785398696 as select v29, MIN(v41) as v41, MIN(v43) as v43, MIN(v27) as v42 from aggJoin5951089247145612219 group by v29;
create or replace view aggJoin2281229941135371211 as select v41, v43, v42 from aggJoin2075807338963828715 join aggView6042760177785398696 using(v29);
select MIN(v41) as v41,MIN(v42) as v42,MIN(v43) as v43 from aggJoin2281229941135371211;
