create or replace view aggView7018644368631708312 as select id as v21 from info_type as it1 where info= 'genres';
create or replace view aggJoin4927372601154260885 as select movie_id as v29, info as v22 from movie_info as mi, aggView7018644368631708312 where mi.info_type_id=aggView7018644368631708312.v21 and info IN ('Drama','Horror');
create or replace view aggView5986622043006849761 as select id as v26 from info_type as it2 where info= 'rating';
create or replace view aggJoin2126344833291968776 as select movie_id as v29, info as v27 from movie_info_idx as mi_idx, aggView5986622043006849761 where mi_idx.info_type_id=aggView5986622043006849761.v26 and info>'8.0';
create or replace view aggView3938856914968953149 as select v29 from aggJoin4927372601154260885 group by v29;
create or replace view aggJoin6528683239536947721 as select v29, v27 from aggJoin2126344833291968776 join aggView3938856914968953149 using(v29);
create or replace view aggView5713673513883885080 as select v29, MIN(v27) as v42 from aggJoin6528683239536947721 group by v29;
create or replace view aggJoin77714051581472761 as select id as v29, title as v30, production_year as v33, v42 from title as t, aggView5713673513883885080 where t.id=aggView5713673513883885080.v29 and production_year<=2008 and production_year>=2005;
create or replace view aggView2804857059962923172 as select id as v8 from company_type as ct where kind= 'production companies';
create or replace view aggJoin7928600685019891497 as select movie_id as v29, company_id as v1 from movie_companies as mc, aggView2804857059962923172 where mc.company_type_id=aggView2804857059962923172.v8;
create or replace view aggView2438316039353915725 as select v29, MIN(v42) as v42, MIN(v30) as v43 from aggJoin77714051581472761 group by v29;
create or replace view aggJoin8834557695173852275 as select v1, v42, v43 from aggJoin7928600685019891497 join aggView2438316039353915725 using(v29);
create or replace view aggView2011347244864018020 as select id as v1, name as v41 from company_name as cn where country_code= '[us]';
create or replace view aggJoin3172217188857617679 as select v42, v43, v41 from aggJoin8834557695173852275 join aggView2011347244864018020 using(v1);
select MIN(v41) as v41,MIN(v42) as v42,MIN(v43) as v43 from aggJoin3172217188857617679;
