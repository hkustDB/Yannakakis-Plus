create or replace view aggView1977553858434034983 as select id as v1, name as v41 from company_name as cn where country_code= '[us]';
create or replace view aggJoin6647238690580758950 as select movie_id as v29, company_type_id as v8, v41 from movie_companies as mc, aggView1977553858434034983 where mc.company_id=aggView1977553858434034983.v1;
create or replace view aggView6078425578933339796 as select id as v29, title as v43 from title as t where production_year<=2008 and production_year>=2005;
create or replace view aggJoin5074908301620994107 as select movie_id as v29, info_type_id as v21, info as v22, v43 from movie_info as mi, aggView6078425578933339796 where mi.movie_id=aggView6078425578933339796.v29 and info IN ('Drama','Horror');
create or replace view aggView1402595174605381 as select id as v26 from info_type as it2 where info= 'rating';
create or replace view aggJoin3630509546283591405 as select movie_id as v29, info as v27 from movie_info_idx as mi_idx, aggView1402595174605381 where mi_idx.info_type_id=aggView1402595174605381.v26 and info>'8.0';
create or replace view aggView5103179771497116491 as select id as v21 from info_type as it1 where info= 'genres';
create or replace view aggJoin814943981557145241 as select v29, v43 from aggJoin5074908301620994107 join aggView5103179771497116491 using(v21);
create or replace view aggView7928090629336702894 as select v29, MIN(v43) as v43 from aggJoin814943981557145241 group by v29;
create or replace view aggJoin6231886340644371590 as select v29, v27, v43 from aggJoin3630509546283591405 join aggView7928090629336702894 using(v29);
create or replace view aggView7049603251818629107 as select v29, MIN(v43) as v43, MIN(v27) as v42 from aggJoin6231886340644371590 group by v29;
create or replace view aggJoin2289762967755643265 as select v8, v41 as v41, v43, v42 from aggJoin6647238690580758950 join aggView7049603251818629107 using(v29);
create or replace view aggView6006864010743540276 as select id as v8 from company_type as ct where kind= 'production companies';
create or replace view aggJoin327149406513494665 as select v41, v43, v42 from aggJoin2289762967755643265 join aggView6006864010743540276 using(v8);
create or replace view res as select MIN(v41) as v41, MIN(v42) as v42, MIN(v43) as v43 from aggJoin327149406513494665;
select sum(v41+v42+v43) from res;