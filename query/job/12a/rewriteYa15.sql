create or replace view semiUp657839966898989809 as select movie_id as v29, info_type_id as v26, info as v27 from movie_info_idx AS mi_idx where (info_type_id) in (select (id) from info_type AS it2 where info= 'rating') and info>'8.0';
create or replace view semiUp2501353799711321272 as select movie_id as v29, info_type_id as v21 from movie_info AS mi where (info_type_id) in (select (id) from info_type AS it1 where info= 'genres') and info IN ('Drama','Horror');
create or replace view semiUp7550837244169512543 as select movie_id as v29, company_id as v1, company_type_id as v8 from movie_companies AS mc where (company_id) in (select (id) from company_name AS cn where country_code= '[us]');
create or replace view semiUp6616822156859158065 as select v29, v1, v8 from semiUp7550837244169512543 where (v8) in (select (id) from company_type AS ct where kind= 'production companies');
create or replace view semiUp187190209884114154 as select id as v29, title as v30 from title AS t where (id) in (select (v29) from semiUp6616822156859158065) and production_year<=2008 and production_year>=2005;
create or replace view semiUp6179041171915906821 as select v29, v21 from semiUp2501353799711321272 where (v29) in (select (v29) from semiUp187190209884114154);
create or replace view semiUp1255774297004921576 as select v29, v26, v27 from semiUp657839966898989809 where (v29) in (select (v29) from semiUp6179041171915906821);
create or replace view semiDown2172487046364336958 as select v29, v21 from semiUp6179041171915906821 where (v29) in (select (v29) from semiUp1255774297004921576);
create or replace view semiDown655871267824224204 as select id as v26 from info_type AS it2 where (id) in (select (v26) from semiUp1255774297004921576) and info= 'rating';
create or replace view semiDown1081592482787813584 as select id as v21 from info_type AS it1 where (id) in (select (v21) from semiDown2172487046364336958) and info= 'genres';
create or replace view semiDown5568347210422264868 as select v29, v30 from semiUp187190209884114154 where (v29) in (select (v29) from semiDown2172487046364336958);
create or replace view semiDown750667501902798321 as select v29, v1, v8 from semiUp6616822156859158065 where (v29) in (select (v29) from semiDown5568347210422264868);
create or replace view semiDown8333353028986883806 as select id as v8 from company_type AS ct where (id) in (select (v8) from semiDown750667501902798321) and kind= 'production companies';
create or replace view semiDown8633086046801768427 as select id as v1, name as v2 from company_name AS cn where (id) in (select (v1) from semiDown750667501902798321) and country_code= '[us]';
create or replace view aggView5620924991162815752 as select v26 from semiDown655871267824224204;
create or replace view aggJoin4727239781703361654 as select v29, v27 from semiUp1255774297004921576 join aggView5620924991162815752 using(v26);
create or replace view aggView2457057412754729647 as select v8 from semiDown8333353028986883806;
create or replace view aggJoin576603857326798296 as select v29, v1 from semiDown750667501902798321 join aggView2457057412754729647 using(v8);
create or replace view aggView70636982218001194 as select v1, v2 as v41 from semiDown8633086046801768427;
create or replace view aggJoin4396636228903121518 as select v29, v41 from aggJoin576603857326798296 join aggView70636982218001194 using(v1);
create or replace view aggView6289482655693608726 as select v29, MIN(v41) as v41 from aggJoin4396636228903121518 group by v29;
create or replace view aggJoin6753497972594717236 as select v29, v30, v41 from semiDown5568347210422264868 join aggView6289482655693608726 using(v29);
create or replace view aggView1527110392837523822 as select v29, MIN(v41) as v41, MIN(v30) as v43 from aggJoin6753497972594717236 group by v29;
create or replace view aggJoin2318384482708932989 as select v29, v21, v41, v43 from semiDown2172487046364336958 join aggView1527110392837523822 using(v29);
create or replace view aggView8212332530587572000 as select v21 from semiDown1081592482787813584;
create or replace view aggJoin1373320176984505395 as select v29, v41, v43 from aggJoin2318384482708932989 join aggView8212332530587572000 using(v21);
create or replace view aggView7319205551165375247 as select v29, MIN(v41) as v41, MIN(v43) as v43 from aggJoin1373320176984505395 group by v29;
create or replace view aggJoin2580700710340859301 as select v27, v41, v43 from aggJoin4727239781703361654 join aggView7319205551165375247 using(v29);
select MIN(v41) as v41,MIN(v27) as v42,MIN(v43) as v43 from aggJoin2580700710340859301;
