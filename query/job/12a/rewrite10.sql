create or replace view aggView292838684380481293 as select id as v26 from info_type as it2 where info= 'rating';
create or replace view aggJoin3469099878548194620 as select movie_id as v29, info as v27 from movie_info_idx as mi_idx, aggView292838684380481293 where mi_idx.info_type_id=aggView292838684380481293.v26 and info>'8.0';
create or replace view aggView7327949710983996992 as select id as v21 from info_type as it1 where info= 'genres';
create or replace view aggJoin3209488702697595223 as select movie_id as v29 from movie_info as mi, aggView7327949710983996992 where mi.info_type_id=aggView7327949710983996992.v21 and info IN ('Drama','Horror');
create or replace view aggView1910849118115446209 as select v29 from aggJoin3209488702697595223 group by v29;
create or replace view aggJoin5250813600265236162 as select id as v29, title as v30 from title as t, aggView1910849118115446209 where t.id=aggView1910849118115446209.v29 and production_year<=2008 and production_year>=2005;
create or replace view aggView8577301932188335170 as select v29, MIN(v30) as v43 from aggJoin5250813600265236162 group by v29;
create or replace view aggJoin8253335549568140210 as select v29, v27, v43 from aggJoin3469099878548194620 join aggView8577301932188335170 using(v29);
create or replace view aggView3573622729874662405 as select v29, MIN(v43) as v43, MIN(v27) as v42 from aggJoin8253335549568140210 group by v29;
create or replace view aggJoin8546972113606301741 as select company_id as v1, company_type_id as v8, v43, v42 from movie_companies as mc, aggView3573622729874662405 where mc.movie_id=aggView3573622729874662405.v29;
create or replace view aggView1582350305449563412 as select id as v8 from company_type as ct where kind= 'production companies';
create or replace view aggJoin3925451981317288823 as select v1, v43, v42 from aggJoin8546972113606301741 join aggView1582350305449563412 using(v8);
create or replace view aggView3225253419745510146 as select v1, MIN(v43) as v43, MIN(v42) as v42 from aggJoin3925451981317288823 group by v1;
create or replace view aggJoin6942910697620361406 as select name as v2, v43, v42 from company_name as cn, aggView3225253419745510146 where cn.id=aggView3225253419745510146.v1 and country_code= '[us]';
create or replace view res as select MIN(v2) as v41, MIN(v42) as v42, MIN(v43) as v43 from aggJoin6942910697620361406;
select sum(v41+v42+v43) from res;