create or replace view semiUp4020496018571029349 as select movie_id as v29, company_id as v1, company_type_id as v8 from movie_companies AS mc where (company_id) in (select (id) from company_name AS cn where country_code= '[us]');
create or replace view semiUp4513927251617219695 as select movie_id as v29, info_type_id as v21 from movie_info AS mi where (info_type_id) in (select (id) from info_type AS it1 where info= 'genres') and info IN ('Drama','Horror');
create or replace view semiUp7253693468696985555 as select v29, v1, v8 from semiUp4020496018571029349 where (v8) in (select (id) from company_type AS ct where kind= 'production companies');
create or replace view semiUp989430362699923688 as select v29, v21 from semiUp4513927251617219695 where (v29) in (select (v29) from semiUp7253693468696985555);
create or replace view semiUp4080796307765536820 as select id as v29, title as v30 from title AS t where (id) in (select (v29) from semiUp989430362699923688) and production_year<=2008 and production_year>=2005;
create or replace view semiUp8775747893767913374 as select movie_id as v29, info_type_id as v26, info as v27 from movie_info_idx AS mi_idx where (movie_id) in (select (v29) from semiUp4080796307765536820) and info>'8.0';
create or replace view semiUp4414255987266257910 as select id as v26 from info_type AS it2 where (id) in (select (v26) from semiUp8775747893767913374) and info= 'rating';
create or replace view semiDown3010311646924493890 as select v29, v26, v27 from semiUp8775747893767913374 where (v26) in (select (v26) from semiUp4414255987266257910);
create or replace view semiDown2392027930444532304 as select v29, v30 from semiUp4080796307765536820 where (v29) in (select (v29) from semiDown3010311646924493890);
create or replace view semiDown284923196929540036 as select v29, v21 from semiUp989430362699923688 where (v29) in (select (v29) from semiDown2392027930444532304);
create or replace view semiDown2972803480035725693 as select id as v21 from info_type AS it1 where (id) in (select (v21) from semiDown284923196929540036) and info= 'genres';
create or replace view semiDown3307486543383898777 as select v29, v1, v8 from semiUp7253693468696985555 where (v29) in (select (v29) from semiDown284923196929540036);
create or replace view semiDown5250168639480058596 as select id as v8 from company_type AS ct where (id) in (select (v8) from semiDown3307486543383898777) and kind= 'production companies';
create or replace view semiDown7941646544446155449 as select id as v1, name as v2 from company_name AS cn where (id) in (select (v1) from semiDown3307486543383898777) and country_code= '[us]';
create or replace view aggView1736095190219794855 as select v1, v2 as v41 from semiDown7941646544446155449;
create or replace view aggJoin1389609324340374003 as select v29, v8, v41 from semiDown3307486543383898777 join aggView1736095190219794855 using(v1);
create or replace view aggView8819029569331285331 as select v8 from semiDown5250168639480058596;
create or replace view aggJoin1142695229285557 as select v29, v41 from aggJoin1389609324340374003 join aggView8819029569331285331 using(v8);
create or replace view aggView3738310814084132065 as select v21 from semiDown2972803480035725693;
create or replace view aggJoin9093145273881694274 as select v29 from semiDown284923196929540036 join aggView3738310814084132065 using(v21);
create or replace view aggView8850114546826067056 as select v29, MIN(v41) as v41 from aggJoin1142695229285557 group by v29;
create or replace view aggJoin5421708281033464121 as select v29, v41 from aggJoin9093145273881694274 join aggView8850114546826067056 using(v29);
create or replace view aggView7667843238870476680 as select v29, MIN(v41) as v41 from aggJoin5421708281033464121 group by v29;
create or replace view aggJoin1746281472350090796 as select v29, v30, v41 from semiDown2392027930444532304 join aggView7667843238870476680 using(v29);
create or replace view aggView19331940289106439 as select v29, MIN(v41) as v41, MIN(v30) as v43 from aggJoin1746281472350090796 group by v29;
create or replace view aggJoin2900626638090302249 as select v26, v27, v41, v43 from semiDown3010311646924493890 join aggView19331940289106439 using(v29);
create or replace view aggView253739920490305932 as select v26, MIN(v41) as v41, MIN(v43) as v43, MIN(v27) as v42 from aggJoin2900626638090302249 group by v26;
create or replace view aggJoin4163526114828803971 as select v41, v43, v42 from semiUp4414255987266257910 join aggView253739920490305932 using(v26);
select MIN(v41) as v41,MIN(v42) as v42,MIN(v43) as v43 from aggJoin4163526114828803971;
