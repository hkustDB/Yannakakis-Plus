create or replace view semiUp2168345297145182511 as select movie_id as v29, info_type_id as v26, info as v27 from movie_info_idx AS mi_idx where (info_type_id) in (select (id) from info_type AS it2 where info= 'rating') and info>'8.0';
create or replace view semiUp7824791326158886553 as select movie_id as v29, company_id as v1, company_type_id as v8 from movie_companies AS mc where (company_type_id) in (select (id) from company_type AS ct where kind= 'production companies');
create or replace view semiUp8597966772775775148 as select v29, v1, v8 from semiUp7824791326158886553 where (v1) in (select (id) from company_name AS cn where country_code= '[us]');
create or replace view semiUp1752524964561873972 as select v29, v26, v27 from semiUp2168345297145182511 where (v29) in (select (v29) from semiUp8597966772775775148);
create or replace view semiUp8269012296753970362 as select id as v29, title as v30 from title AS t where (id) in (select (v29) from semiUp1752524964561873972) and production_year<=2008 and production_year>=2005;
create or replace view semiUp3973684068387858697 as select movie_id as v29, info_type_id as v21 from movie_info AS mi where (movie_id) in (select (v29) from semiUp8269012296753970362) and info IN ('Drama','Horror');
create or replace view semiUp4057207901612861241 as select id as v21 from info_type AS it1 where (id) in (select (v21) from semiUp3973684068387858697) and info= 'genres';
create or replace view semiDown4235856139764804943 as select v29, v21 from semiUp3973684068387858697 where (v21) in (select (v21) from semiUp4057207901612861241);
create or replace view semiDown6893056029467751365 as select v29, v30 from semiUp8269012296753970362 where (v29) in (select (v29) from semiDown4235856139764804943);
create or replace view semiDown4278043786563944785 as select v29, v26, v27 from semiUp1752524964561873972 where (v29) in (select (v29) from semiDown6893056029467751365);
create or replace view semiDown3008555592964504153 as select v29, v1, v8 from semiUp8597966772775775148 where (v29) in (select (v29) from semiDown4278043786563944785);
create or replace view semiDown1550439318788453764 as select id as v26 from info_type AS it2 where (id) in (select (v26) from semiDown4278043786563944785) and info= 'rating';
create or replace view semiDown3155635716909594876 as select id as v8 from company_type AS ct where (id) in (select (v8) from semiDown3008555592964504153) and kind= 'production companies';
create or replace view semiDown3381073204733682998 as select id as v1, name as v2 from company_name AS cn where (id) in (select (v1) from semiDown3008555592964504153) and country_code= '[us]';
create or replace view aggView6700736764856719378 as select v8 from semiDown3155635716909594876;
create or replace view aggJoin5908916072194953203 as select v29, v1 from semiDown3008555592964504153 join aggView6700736764856719378 using(v8);
create or replace view aggView2562090202498393846 as select v1, v2 as v41 from semiDown3381073204733682998;
create or replace view aggJoin4983783818613614555 as select v29, v41 from aggJoin5908916072194953203 join aggView2562090202498393846 using(v1);
create or replace view aggView3623591596463408547 as select v29, MIN(v41) as v41 from aggJoin4983783818613614555 group by v29;
create or replace view aggJoin6281939783189549090 as select v29, v26, v27, v41 from semiDown4278043786563944785 join aggView3623591596463408547 using(v29);
create or replace view aggView3740217170471025067 as select v26 from semiDown1550439318788453764;
create or replace view aggJoin1064583848444095645 as select v29, v27, v41 from aggJoin6281939783189549090 join aggView3740217170471025067 using(v26);
create or replace view aggView7210758574796500146 as select v29, MIN(v41) as v41, MIN(v27) as v42 from aggJoin1064583848444095645 group by v29;
create or replace view aggJoin6139406708743253629 as select v29, v30, v41, v42 from semiDown6893056029467751365 join aggView7210758574796500146 using(v29);
create or replace view aggView93131951505885027 as select v29, MIN(v41) as v41, MIN(v42) as v42, MIN(v30) as v43 from aggJoin6139406708743253629 group by v29;
create or replace view aggJoin4701023709210675278 as select v21, v41, v42, v43 from semiDown4235856139764804943 join aggView93131951505885027 using(v29);
create or replace view aggView3501186719961613446 as select v21, MIN(v41) as v41, MIN(v42) as v42, MIN(v43) as v43 from aggJoin4701023709210675278 group by v21;
create or replace view aggJoin1294764681574700585 as select v41, v42, v43 from semiUp4057207901612861241 join aggView3501186719961613446 using(v21);
select MIN(v41) as v41,MIN(v42) as v42,MIN(v43) as v43 from aggJoin1294764681574700585;
