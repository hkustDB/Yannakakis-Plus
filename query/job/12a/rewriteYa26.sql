create or replace view semiUp1334387202213670099 as select movie_id as v29, info_type_id as v26, info as v27 from movie_info_idx AS mi_idx where (info_type_id) in (select (id) from info_type AS it2 where info= 'rating') and info>'8.0';
create or replace view semiUp8472861501321649738 as select movie_id as v29, company_id as v1, company_type_id as v8 from movie_companies AS mc where (company_id) in (select (id) from company_name AS cn where country_code= '[us]');
create or replace view semiUp3196739235008492139 as select v29, v1, v8 from semiUp8472861501321649738 where (v8) in (select (id) from company_type AS ct where kind= 'production companies');
create or replace view semiUp4668107688227419656 as select id as v29, title as v30 from title AS t where (id) in (select (v29) from semiUp3196739235008492139) and production_year<=2008 and production_year>=2005;
create or replace view semiUp7542162276453262939 as select v29, v26, v27 from semiUp1334387202213670099 where (v29) in (select (v29) from semiUp4668107688227419656);
create or replace view semiUp7656298935294379073 as select movie_id as v29, info_type_id as v21 from movie_info AS mi where (movie_id) in (select (v29) from semiUp7542162276453262939) and info IN ('Drama','Horror');
create or replace view semiUp7130507733420848157 as select id as v21 from info_type AS it1 where (id) in (select (v21) from semiUp7656298935294379073) and info= 'genres';
create or replace view semiDown4375540113410325302 as select v29, v21 from semiUp7656298935294379073 where (v21) in (select (v21) from semiUp7130507733420848157);
create or replace view semiDown6504865915414616376 as select v29, v26, v27 from semiUp7542162276453262939 where (v29) in (select (v29) from semiDown4375540113410325302);
create or replace view semiDown7241271156418192899 as select v29, v30 from semiUp4668107688227419656 where (v29) in (select (v29) from semiDown6504865915414616376);
create or replace view semiDown2662760404803527387 as select id as v26 from info_type AS it2 where (id) in (select (v26) from semiDown6504865915414616376) and info= 'rating';
create or replace view semiDown4161178425139551013 as select v29, v1, v8 from semiUp3196739235008492139 where (v29) in (select (v29) from semiDown7241271156418192899);
create or replace view semiDown8074307723985657231 as select id as v8 from company_type AS ct where (id) in (select (v8) from semiDown4161178425139551013) and kind= 'production companies';
create or replace view semiDown5293166104598127662 as select id as v1, name as v2 from company_name AS cn where (id) in (select (v1) from semiDown4161178425139551013) and country_code= '[us]';
create or replace view aggView5864869867656707647 as select v8 from semiDown8074307723985657231;
create or replace view aggJoin1126994912923258435 as select v29, v1 from semiDown4161178425139551013 join aggView5864869867656707647 using(v8);
create or replace view aggView7491326664270980581 as select v1, v2 as v41 from semiDown5293166104598127662;
create or replace view aggJoin5821753978317598380 as select v29, v41 from aggJoin1126994912923258435 join aggView7491326664270980581 using(v1);
create or replace view aggView8324888958817323146 as select v26 from semiDown2662760404803527387;
create or replace view aggJoin4339666191424916831 as select v29, v27 from semiDown6504865915414616376 join aggView8324888958817323146 using(v26);
create or replace view aggView8645589922646409161 as select v29, MIN(v41) as v41 from aggJoin5821753978317598380 group by v29;
create or replace view aggJoin2713873770279024221 as select v29, v30, v41 from semiDown7241271156418192899 join aggView8645589922646409161 using(v29);
create or replace view aggView232114112039769824 as select v29, MIN(v41) as v41, MIN(v30) as v43 from aggJoin2713873770279024221 group by v29;
create or replace view aggJoin7934260078533782632 as select v29, v27, v41, v43 from aggJoin4339666191424916831 join aggView232114112039769824 using(v29);
create or replace view aggView622918698640646286 as select v29, MIN(v41) as v41, MIN(v43) as v43, MIN(v27) as v42 from aggJoin7934260078533782632 group by v29;
create or replace view aggJoin1288591693569852491 as select v21, v41, v43, v42 from semiDown4375540113410325302 join aggView622918698640646286 using(v29);
create or replace view aggView3847201589460732311 as select v21, MIN(v41) as v41, MIN(v43) as v43, MIN(v42) as v42 from aggJoin1288591693569852491 group by v21;
create or replace view aggJoin7547834438550349761 as select v41, v43, v42 from semiUp7130507733420848157 join aggView3847201589460732311 using(v21);
select MIN(v41) as v41,MIN(v42) as v42,MIN(v43) as v43 from aggJoin7547834438550349761;
