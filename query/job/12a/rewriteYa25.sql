create or replace view semiUp3955840217893401700 as select movie_id as v29, info_type_id as v26, info as v27 from movie_info_idx AS mi_idx where (info_type_id) in (select (id) from info_type AS it2 where info= 'rating') and info>'8.0';
create or replace view semiUp2479241738669495049 as select movie_id as v29, company_id as v1, company_type_id as v8 from movie_companies AS mc where (company_id) in (select (id) from company_name AS cn where country_code= '[us]');
create or replace view semiUp8799290378914035547 as select v29, v1, v8 from semiUp2479241738669495049 where (v8) in (select (id) from company_type AS ct where kind= 'production companies');
create or replace view semiUp2113381112164663653 as select v29, v26, v27 from semiUp3955840217893401700 where (v29) in (select (v29) from semiUp8799290378914035547);
create or replace view semiUp4287010011338536196 as select movie_id as v29, info_type_id as v21 from movie_info AS mi where (info_type_id) in (select (id) from info_type AS it1 where info= 'genres') and info IN ('Drama','Horror');
create or replace view semiUp8171754662730203486 as select v29, v21 from semiUp4287010011338536196 where (v29) in (select (v29) from semiUp2113381112164663653);
create or replace view semiUp8347872899160999086 as select id as v29, title as v30 from title AS t where (id) in (select (v29) from semiUp8171754662730203486) and production_year<=2008 and production_year>=2005;
create or replace view semiDown2615149646838952698 as select v29, v21 from semiUp8171754662730203486 where (v29) in (select (v29) from semiUp8347872899160999086);
create or replace view semiDown6875918758613771383 as select v29, v26, v27 from semiUp2113381112164663653 where (v29) in (select (v29) from semiDown2615149646838952698);
create or replace view semiDown5019461484687604846 as select id as v21 from info_type AS it1 where (id) in (select (v21) from semiDown2615149646838952698) and info= 'genres';
create or replace view semiDown3343675040686827818 as select v29, v1, v8 from semiUp8799290378914035547 where (v29) in (select (v29) from semiDown6875918758613771383);
create or replace view semiDown6684956129866475691 as select id as v26 from info_type AS it2 where (id) in (select (v26) from semiDown6875918758613771383) and info= 'rating';
create or replace view semiDown3451476101321887468 as select id as v8 from company_type AS ct where (id) in (select (v8) from semiDown3343675040686827818) and kind= 'production companies';
create or replace view semiDown8328719372465596059 as select id as v1, name as v2 from company_name AS cn where (id) in (select (v1) from semiDown3343675040686827818) and country_code= '[us]';
create or replace view aggView3619799797750159743 as select v1, v2 as v41 from semiDown8328719372465596059;
create or replace view aggJoin5873262631441477874 as select v29, v8, v41 from semiDown3343675040686827818 join aggView3619799797750159743 using(v1);
create or replace view aggView1851728246866238765 as select v26 from semiDown6684956129866475691;
create or replace view aggJoin521821590373279637 as select v29, v27 from semiDown6875918758613771383 join aggView1851728246866238765 using(v26);
create or replace view aggView3110609632754314497 as select v8 from semiDown3451476101321887468;
create or replace view aggJoin765787469221533536 as select v29, v41 from aggJoin5873262631441477874 join aggView3110609632754314497 using(v8);
create or replace view aggView5339910078508460881 as select v29, MIN(v41) as v41 from aggJoin765787469221533536 group by v29;
create or replace view aggJoin3949867058768698257 as select v29, v27, v41 from aggJoin521821590373279637 join aggView5339910078508460881 using(v29);
create or replace view aggView2549167429332624900 as select v29, MIN(v41) as v41, MIN(v27) as v42 from aggJoin3949867058768698257 group by v29;
create or replace view aggJoin3538512713683536450 as select v29, v21, v41, v42 from semiDown2615149646838952698 join aggView2549167429332624900 using(v29);
create or replace view aggView604231295289909519 as select v21 from semiDown5019461484687604846;
create or replace view aggJoin6494753930042209946 as select v29, v41, v42 from aggJoin3538512713683536450 join aggView604231295289909519 using(v21);
create or replace view aggView1119733855556307057 as select v29, MIN(v41) as v41, MIN(v42) as v42 from aggJoin6494753930042209946 group by v29;
create or replace view aggJoin6368343731966506781 as select v30, v41, v42 from semiUp8347872899160999086 join aggView1119733855556307057 using(v29);
select MIN(v41) as v41,MIN(v42) as v42,MIN(v30) as v43 from aggJoin6368343731966506781;
