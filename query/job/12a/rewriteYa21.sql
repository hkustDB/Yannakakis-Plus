create or replace view semiUp1873900749054931897 as select movie_id as v29, company_id as v1, company_type_id as v8 from movie_companies AS mc where (company_type_id) in (select (id) from company_type AS ct where kind= 'production companies');
create or replace view semiUp69103165439482281 as select movie_id as v29, info_type_id as v21 from movie_info AS mi where (movie_id) in (select (id) from title AS t where production_year<=2008 and production_year>=2005) and info IN ('Drama','Horror');
create or replace view semiUp7665074429867546176 as select v29, v21 from semiUp69103165439482281 where (v21) in (select (id) from info_type AS it1 where info= 'genres');
create or replace view semiUp5549162550984128146 as select v29, v1, v8 from semiUp1873900749054931897 where (v1) in (select (id) from company_name AS cn where country_code= '[us]');
create or replace view semiUp455115189377121164 as select movie_id as v29, info_type_id as v26, info as v27 from movie_info_idx AS mi_idx where (movie_id) in (select (v29) from semiUp7665074429867546176) and info>'8.0';
create or replace view semiUp854957357789033911 as select v29, v26, v27 from semiUp455115189377121164 where (v29) in (select (v29) from semiUp5549162550984128146);
create or replace view semiUp1458979837686096084 as select id as v26 from info_type AS it2 where (id) in (select (v26) from semiUp854957357789033911) and info= 'rating';
create or replace view semiDown2969237815579641003 as select v29, v26, v27 from semiUp854957357789033911 where (v26) in (select (v26) from semiUp1458979837686096084);
create or replace view semiDown9022593754816300044 as select v29, v1, v8 from semiUp5549162550984128146 where (v29) in (select (v29) from semiDown2969237815579641003);
create or replace view semiDown3348380085218654510 as select v29, v21 from semiUp7665074429867546176 where (v29) in (select (v29) from semiDown2969237815579641003);
create or replace view semiDown2742282429523296966 as select id as v8 from company_type AS ct where (id) in (select (v8) from semiDown9022593754816300044) and kind= 'production companies';
create or replace view semiDown1818496026132481699 as select id as v1, name as v2 from company_name AS cn where (id) in (select (v1) from semiDown9022593754816300044) and country_code= '[us]';
create or replace view semiDown101140084202190750 as select id as v21 from info_type AS it1 where (id) in (select (v21) from semiDown3348380085218654510) and info= 'genres';
create or replace view semiDown5208450507176180177 as select id as v29, title as v30 from title AS t where (id) in (select (v29) from semiDown3348380085218654510) and production_year<=2008 and production_year>=2005;
create or replace view aggView158993665867162839 as select v21 from semiDown101140084202190750;
create or replace view aggJoin6861255062991199735 as select v29 from semiDown3348380085218654510 join aggView158993665867162839 using(v21);
create or replace view aggView6840675276144454931 as select v1, v2 as v41 from semiDown1818496026132481699;
create or replace view aggJoin3048452911155509866 as select v29, v8, v41 from semiDown9022593754816300044 join aggView6840675276144454931 using(v1);
create or replace view aggView6073324962304857489 as select v8 from semiDown2742282429523296966;
create or replace view aggJoin682339856461871336 as select v29, v41 from aggJoin3048452911155509866 join aggView6073324962304857489 using(v8);
create or replace view aggView1362082533010941937 as select v29, MIN(v41) as v41 from aggJoin682339856461871336 group by v29;
create or replace view aggJoin2953886428915559900 as select v29, v26, v27, v41 from semiDown2969237815579641003 join aggView1362082533010941937 using(v29);
create or replace view aggView5155750966403872434 as select v29, v30 as v43 from semiDown5208450507176180177;
create or replace view aggJoin8011170492554799009 as select v29, v43 from aggJoin6861255062991199735 join aggView5155750966403872434 using(v29);
create or replace view aggView7118029302098788946 as select v29, MIN(v43) as v43 from aggJoin8011170492554799009 group by v29;
create or replace view aggJoin3881350576094508933 as select v26, v27, v41 as v41, v43 from aggJoin2953886428915559900 join aggView7118029302098788946 using(v29);
create or replace view aggView2300401752019261387 as select v26, MIN(v41) as v41, MIN(v43) as v43, MIN(v27) as v42 from aggJoin3881350576094508933 group by v26;
create or replace view aggJoin239464607836006334 as select v41, v43, v42 from semiUp1458979837686096084 join aggView2300401752019261387 using(v26);
select MIN(v41) as v41,MIN(v42) as v42,MIN(v43) as v43 from aggJoin239464607836006334;
