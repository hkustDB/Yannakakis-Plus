create or replace view semiUp9001746444654093916 as select movie_id as v29, info_type_id as v21 from movie_info AS mi where (info_type_id) in (select (id) from info_type AS it1 where info= 'genres') and info IN ('Drama','Horror');
create or replace view semiUp2841416409468788738 as select movie_id as v29, company_id as v1, company_type_id as v8 from movie_companies AS mc where (company_type_id) in (select (id) from company_type AS ct where kind= 'production companies');
create or replace view semiUp9063746305720741548 as select v29, v1, v8 from semiUp2841416409468788738 where (v1) in (select (id) from company_name AS cn where country_code= '[us]');
create or replace view semiUp1038346331266775362 as select movie_id as v29, info_type_id as v26, info as v27 from movie_info_idx AS mi_idx where (info_type_id) in (select (id) from info_type AS it2 where info= 'rating') and info>'8.0';
create or replace view semiUp2350043819712248119 as select id as v29, title as v30 from title AS t where (id) in (select (v29) from semiUp9001746444654093916) and production_year<=2008 and production_year>=2005;
create or replace view semiUp5587523356607245737 as select v29, v26, v27 from semiUp1038346331266775362 where (v29) in (select (v29) from semiUp9063746305720741548);
create or replace view semiUp2344476330483361340 as select v29, v30 from semiUp2350043819712248119 where (v29) in (select (v29) from semiUp5587523356607245737);
create or replace view semiDown6896808430229721397 as select v29, v21 from semiUp9001746444654093916 where (v29) in (select (v29) from semiUp2344476330483361340);
create or replace view semiDown270085393423779109 as select v29, v26, v27 from semiUp5587523356607245737 where (v29) in (select (v29) from semiUp2344476330483361340);
create or replace view semiDown1993281918066954003 as select id as v21 from info_type AS it1 where (id) in (select (v21) from semiDown6896808430229721397) and info= 'genres';
create or replace view semiDown5815804310840320570 as select v29, v1, v8 from semiUp9063746305720741548 where (v29) in (select (v29) from semiDown270085393423779109);
create or replace view semiDown6285879830345599090 as select id as v26 from info_type AS it2 where (id) in (select (v26) from semiDown270085393423779109) and info= 'rating';
create or replace view semiDown833385247429302451 as select id as v8 from company_type AS ct where (id) in (select (v8) from semiDown5815804310840320570) and kind= 'production companies';
create or replace view semiDown1499685169905032869 as select id as v1, name as v2 from company_name AS cn where (id) in (select (v1) from semiDown5815804310840320570) and country_code= '[us]';
create or replace view aggView8240525491844507458 as select v8 from semiDown833385247429302451;
create or replace view aggJoin3529564901359267461 as select v29, v1 from semiDown5815804310840320570 join aggView8240525491844507458 using(v8);
create or replace view aggView9054174102287894050 as select v26 from semiDown6285879830345599090;
create or replace view aggJoin6035447499142251547 as select v29, v27 from semiDown270085393423779109 join aggView9054174102287894050 using(v26);
create or replace view aggView7022510276537632390 as select v21 from semiDown1993281918066954003;
create or replace view aggJoin2455607644431351818 as select v29 from semiDown6896808430229721397 join aggView7022510276537632390 using(v21);
create or replace view aggView1567823209229976765 as select v1, v2 as v41 from semiDown1499685169905032869;
create or replace view aggJoin1660392575631061884 as select v29, v41 from aggJoin3529564901359267461 join aggView1567823209229976765 using(v1);
create or replace view aggView2576071105446299151 as select v29 from aggJoin2455607644431351818 group by v29;
create or replace view aggJoin3001533831421636445 as select v29, v30 from semiUp2344476330483361340 join aggView2576071105446299151 using(v29);
create or replace view aggView6663995686627976798 as select v29, MIN(v41) as v41 from aggJoin1660392575631061884 group by v29;
create or replace view aggJoin713061672066034908 as select v29, v27, v41 from aggJoin6035447499142251547 join aggView6663995686627976798 using(v29);
create or replace view aggView229998850277121518 as select v29, MIN(v41) as v41, MIN(v27) as v42 from aggJoin713061672066034908 group by v29;
create or replace view aggJoin1847238618266135664 as select v30, v41, v42 from aggJoin3001533831421636445 join aggView229998850277121518 using(v29);
select MIN(v41) as v41,MIN(v42) as v42,MIN(v30) as v43 from aggJoin1847238618266135664;
