create or replace view semiUp4463411375213204810 as select movie_id as v29, company_id as v1, company_type_id as v8 from movie_companies AS mc where (company_id) in (select (id) from company_name AS cn where country_code= '[us]');
create or replace view semiUp8998927524347430989 as select movie_id as v29, info_type_id as v21 from movie_info AS mi where (info_type_id) in (select (id) from info_type AS it1 where info= 'genres') and info IN ('Drama','Horror');
create or replace view semiUp5437550233169610198 as select id as v29, title as v30 from title AS t where (id) in (select (v29) from semiUp8998927524347430989) and production_year<=2008 and production_year>=2005;
create or replace view semiUp713185970614238272 as select movie_id as v29, info_type_id as v26, info as v27 from movie_info_idx AS mi_idx where (movie_id) in (select (v29) from semiUp5437550233169610198) and info>'8.0';
create or replace view semiUp5513851856937925845 as select v29, v1, v8 from semiUp4463411375213204810 where (v8) in (select (id) from company_type AS ct where kind= 'production companies');
create or replace view semiUp7743157649182950108 as select v29, v26, v27 from semiUp713185970614238272 where (v29) in (select (v29) from semiUp5513851856937925845);
create or replace view semiUp8940159685237028252 as select id as v26 from info_type AS it2 where (id) in (select (v26) from semiUp7743157649182950108) and info= 'rating';
create or replace view semiDown657470894600809272 as select v29, v26, v27 from semiUp7743157649182950108 where (v26) in (select (v26) from semiUp8940159685237028252);
create or replace view semiDown8317182514675061796 as select v29, v1, v8 from semiUp5513851856937925845 where (v29) in (select (v29) from semiDown657470894600809272);
create or replace view semiDown3060617342101080615 as select v29, v30 from semiUp5437550233169610198 where (v29) in (select (v29) from semiDown657470894600809272);
create or replace view semiDown9008133740643553369 as select id as v8 from company_type AS ct where (id) in (select (v8) from semiDown8317182514675061796) and kind= 'production companies';
create or replace view semiDown8388359346394494621 as select id as v1, name as v2 from company_name AS cn where (id) in (select (v1) from semiDown8317182514675061796) and country_code= '[us]';
create or replace view semiDown4190161557071640022 as select v29, v21 from semiUp8998927524347430989 where (v29) in (select (v29) from semiDown3060617342101080615);
create or replace view semiDown1723094081463701480 as select id as v21 from info_type AS it1 where (id) in (select (v21) from semiDown4190161557071640022) and info= 'genres';
create or replace view aggView5810666367624562345 as select v1, v2 as v41 from semiDown8388359346394494621;
create or replace view aggJoin7148718923792329140 as select v29, v8, v41 from semiDown8317182514675061796 join aggView5810666367624562345 using(v1);
create or replace view aggView4526778738294540976 as select v21 from semiDown1723094081463701480;
create or replace view aggJoin8073023700696372183 as select v29 from semiDown4190161557071640022 join aggView4526778738294540976 using(v21);
create or replace view aggView514245094527600550 as select v29 from aggJoin8073023700696372183 group by v29;
create or replace view aggJoin5749545437952530801 as select v29, v30 from semiDown3060617342101080615 join aggView514245094527600550 using(v29);
create or replace view aggView8798506029302747330 as select v29, MIN(v30) as v43 from aggJoin5749545437952530801 group by v29;
create or replace view aggJoin7041111610017679486 as select v29, v26, v27, v43 from semiDown657470894600809272 join aggView8798506029302747330 using(v29);
create or replace view aggView5589630323997207630 as select v8 from semiDown9008133740643553369;
create or replace view aggJoin886753954808792025 as select v29, v41 from aggJoin7148718923792329140 join aggView5589630323997207630 using(v8);
create or replace view aggView2743875727641996355 as select v29, MIN(v41) as v41 from aggJoin886753954808792025 group by v29;
create or replace view aggJoin7212739926552787326 as select v26, v27, v43 as v43, v41 from aggJoin7041111610017679486 join aggView2743875727641996355 using(v29);
create or replace view aggView256357297548242262 as select v26, MIN(v43) as v43, MIN(v41) as v41, MIN(v27) as v42 from aggJoin7212739926552787326 group by v26;
create or replace view aggJoin5936710652101995654 as select v43, v41, v42 from semiUp8940159685237028252 join aggView256357297548242262 using(v26);
select MIN(v41) as v41,MIN(v42) as v42,MIN(v43) as v43 from aggJoin5936710652101995654;
