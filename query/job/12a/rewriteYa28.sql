create or replace view semiUp4832666416765339183 as select movie_id as v29, company_id as v1, company_type_id as v8 from movie_companies AS mc where (company_id) in (select (id) from company_name AS cn where country_code= '[us]');
create or replace view semiUp7001106088687073730 as select movie_id as v29, info_type_id as v21 from movie_info AS mi where (info_type_id) in (select (id) from info_type AS it1 where info= 'genres') and info IN ('Drama','Horror');
create or replace view semiUp4560845664727696046 as select movie_id as v29, info_type_id as v26, info as v27 from movie_info_idx AS mi_idx where (info_type_id) in (select (id) from info_type AS it2 where info= 'rating') and info>'8.0';
create or replace view semiUp2283965753848226933 as select v29, v21 from semiUp7001106088687073730 where (v29) in (select (id) from title AS t where production_year<=2008 and production_year>=2005);
create or replace view semiUp999055361042002079 as select v29, v26, v27 from semiUp4560845664727696046 where (v29) in (select (v29) from semiUp2283965753848226933);
create or replace view semiUp7765176416530815698 as select v29, v1, v8 from semiUp4832666416765339183 where (v29) in (select (v29) from semiUp999055361042002079);
create or replace view semiUp8343752282421106727 as select id as v8 from company_type AS ct where (id) in (select (v8) from semiUp7765176416530815698) and kind= 'production companies';
create or replace view semiDown349941454952358969 as select v29, v1, v8 from semiUp7765176416530815698 where (v8) in (select (v8) from semiUp8343752282421106727);
create or replace view semiDown3538722317620793531 as select v29, v26, v27 from semiUp999055361042002079 where (v29) in (select (v29) from semiDown349941454952358969);
create or replace view semiDown2262219370780246336 as select id as v1, name as v2 from company_name AS cn where (id) in (select (v1) from semiDown349941454952358969) and country_code= '[us]';
create or replace view semiDown5870671571425355924 as select v29, v21 from semiUp2283965753848226933 where (v29) in (select (v29) from semiDown3538722317620793531);
create or replace view semiDown2989133637911469817 as select id as v26 from info_type AS it2 where (id) in (select (v26) from semiDown3538722317620793531) and info= 'rating';
create or replace view semiDown9096214168618006745 as select id as v21 from info_type AS it1 where (id) in (select (v21) from semiDown5870671571425355924) and info= 'genres';
create or replace view semiDown5146642775068461084 as select id as v29, title as v30 from title AS t where (id) in (select (v29) from semiDown5870671571425355924) and production_year<=2008 and production_year>=2005;
create or replace view aggView4973592955751855972 as select v29, v30 as v43 from semiDown5146642775068461084;
create or replace view aggJoin8167223477604536652 as select v29, v21, v43 from semiDown5870671571425355924 join aggView4973592955751855972 using(v29);
create or replace view aggView429555444410065516 as select v21 from semiDown9096214168618006745;
create or replace view aggJoin2734266165989446410 as select v29, v43 from aggJoin8167223477604536652 join aggView429555444410065516 using(v21);
create or replace view aggView2956644757056915408 as select v1, v2 as v41 from semiDown2262219370780246336;
create or replace view aggJoin8361275402584120958 as select v29, v8, v41 from semiDown349941454952358969 join aggView2956644757056915408 using(v1);
create or replace view aggView653955205982552116 as select v26 from semiDown2989133637911469817;
create or replace view aggJoin1127169201254487546 as select v29, v27 from semiDown3538722317620793531 join aggView653955205982552116 using(v26);
create or replace view aggView1920074407970102052 as select v29, MIN(v43) as v43 from aggJoin2734266165989446410 group by v29;
create or replace view aggJoin7954385418047704379 as select v29, v27, v43 from aggJoin1127169201254487546 join aggView1920074407970102052 using(v29);
create or replace view aggView2529650349528754426 as select v29, MIN(v43) as v43, MIN(v27) as v42 from aggJoin7954385418047704379 group by v29;
create or replace view aggJoin8918240582770232734 as select v8, v41 as v41, v43, v42 from aggJoin8361275402584120958 join aggView2529650349528754426 using(v29);
create or replace view aggView2598460180580239609 as select v8, MIN(v41) as v41, MIN(v43) as v43, MIN(v42) as v42 from aggJoin8918240582770232734 group by v8;
create or replace view aggJoin5018929330002397844 as select v41, v43, v42 from semiUp8343752282421106727 join aggView2598460180580239609 using(v8);
select MIN(v41) as v41,MIN(v42) as v42,MIN(v43) as v43 from aggJoin5018929330002397844;
