create or replace view semiUp4659273563271714672 as select movie_id as v29, company_id as v1, company_type_id as v8 from movie_companies AS mc where (company_type_id) in (select (id) from company_type AS ct where kind= 'production companies');
create or replace view semiUp1030395733520102485 as select movie_id as v29, info_type_id as v21 from movie_info AS mi where (info_type_id) in (select (id) from info_type AS it1 where info= 'genres') and info IN ('Drama','Horror');
create or replace view semiUp3848309841813341484 as select v29, v1, v8 from semiUp4659273563271714672 where (v1) in (select (id) from company_name AS cn where country_code= '[us]');
create or replace view semiUp7241330058120706977 as select id as v29, title as v30 from title AS t where (id) in (select (v29) from semiUp3848309841813341484) and production_year<=2008 and production_year>=2005;
create or replace view semiUp2432047320253519282 as select v29, v21 from semiUp1030395733520102485 where (v29) in (select (v29) from semiUp7241330058120706977);
create or replace view semiUp3156061878025359278 as select movie_id as v29, info_type_id as v26, info as v27 from movie_info_idx AS mi_idx where (movie_id) in (select (v29) from semiUp2432047320253519282) and info>'8.0';
create or replace view semiUp300167167309909772 as select id as v26 from info_type AS it2 where (id) in (select (v26) from semiUp3156061878025359278) and info= 'rating';
create or replace view semiDown6633711787352172946 as select v29, v26, v27 from semiUp3156061878025359278 where (v26) in (select (v26) from semiUp300167167309909772);
create or replace view semiDown8283407737435804670 as select v29, v21 from semiUp2432047320253519282 where (v29) in (select (v29) from semiDown6633711787352172946);
create or replace view semiDown6848257415263378718 as select id as v21 from info_type AS it1 where (id) in (select (v21) from semiDown8283407737435804670) and info= 'genres';
create or replace view semiDown165031439851019506 as select v29, v30 from semiUp7241330058120706977 where (v29) in (select (v29) from semiDown8283407737435804670);
create or replace view semiDown1558970945086276704 as select v29, v1, v8 from semiUp3848309841813341484 where (v29) in (select (v29) from semiDown165031439851019506);
create or replace view semiDown4571113454556361252 as select id as v8 from company_type AS ct where (id) in (select (v8) from semiDown1558970945086276704) and kind= 'production companies';
create or replace view semiDown7298267605168487793 as select id as v1, name as v2 from company_name AS cn where (id) in (select (v1) from semiDown1558970945086276704) and country_code= '[us]';
create or replace view aggView1664679045070824714 as select v21 from semiDown6848257415263378718;
create or replace view aggJoin5602713665926849071 as select v29 from semiDown8283407737435804670 join aggView1664679045070824714 using(v21);
create or replace view aggView5086940458447602679 as select v8 from semiDown4571113454556361252;
create or replace view aggJoin3223742529076566691 as select v29, v1 from semiDown1558970945086276704 join aggView5086940458447602679 using(v8);
create or replace view aggView857384138558212335 as select v1, v2 as v41 from semiDown7298267605168487793;
create or replace view aggJoin6440711390125744954 as select v29, v41 from aggJoin3223742529076566691 join aggView857384138558212335 using(v1);
create or replace view aggView9013853476159644164 as select v29, MIN(v41) as v41 from aggJoin6440711390125744954 group by v29;
create or replace view aggJoin8379895758573850347 as select v29, v30, v41 from semiDown165031439851019506 join aggView9013853476159644164 using(v29);
create or replace view aggView2010306513166754379 as select v29, MIN(v41) as v41, MIN(v30) as v43 from aggJoin8379895758573850347 group by v29;
create or replace view aggJoin321200810510758459 as select v29, v41, v43 from aggJoin5602713665926849071 join aggView2010306513166754379 using(v29);
create or replace view aggView3464418611934038864 as select v29, MIN(v41) as v41, MIN(v43) as v43 from aggJoin321200810510758459 group by v29;
create or replace view aggJoin6262945356649133626 as select v26, v27, v41, v43 from semiDown6633711787352172946 join aggView3464418611934038864 using(v29);
create or replace view aggView1810135552238786799 as select v26, MIN(v41) as v41, MIN(v43) as v43, MIN(v27) as v42 from aggJoin6262945356649133626 group by v26;
create or replace view aggJoin486545494493540850 as select v41, v43, v42 from semiUp300167167309909772 join aggView1810135552238786799 using(v26);
select MIN(v41) as v41,MIN(v42) as v42,MIN(v43) as v43 from aggJoin486545494493540850;
