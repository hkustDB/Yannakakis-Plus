create or replace view semiUp9154714996054945693 as select movie_id as v29, info_type_id as v26, info as v27 from movie_info_idx AS mi_idx where (info_type_id) in (select (id) from info_type AS it2 where info= 'rating') and info>'8.0';
create or replace view semiUp5955385544044919711 as select movie_id as v29, info_type_id as v21 from movie_info AS mi where (movie_id) in (select (v29) from semiUp9154714996054945693) and info IN ('Drama','Horror');
create or replace view semiUp6397492037734791941 as select movie_id as v29, company_id as v1, company_type_id as v8 from movie_companies AS mc where (company_id) in (select (id) from company_name AS cn where country_code= '[us]');
create or replace view semiUp673305448461042698 as select v29, v21 from semiUp5955385544044919711 where (v21) in (select (id) from info_type AS it1 where info= 'genres');
create or replace view semiUp3789282377348704338 as select v29, v1, v8 from semiUp6397492037734791941 where (v8) in (select (id) from company_type AS ct where kind= 'production companies');
create or replace view semiUp5839642904644581000 as select id as v29, title as v30 from title AS t where (id) in (select (v29) from semiUp3789282377348704338) and production_year<=2008 and production_year>=2005;
create or replace view semiUp629223165070066305 as select v29, v30 from semiUp5839642904644581000 where (v29) in (select (v29) from semiUp673305448461042698);
create or replace view semiDown3009276163914041957 as select v29, v1, v8 from semiUp3789282377348704338 where (v29) in (select (v29) from semiUp629223165070066305);
create or replace view semiDown4488173886743262660 as select v29, v21 from semiUp673305448461042698 where (v29) in (select (v29) from semiUp629223165070066305);
create or replace view semiDown6200160260859643106 as select id as v8 from company_type AS ct where (id) in (select (v8) from semiDown3009276163914041957) and kind= 'production companies';
create or replace view semiDown1069542460511971555 as select id as v1, name as v2 from company_name AS cn where (id) in (select (v1) from semiDown3009276163914041957) and country_code= '[us]';
create or replace view semiDown8071376947344145625 as select v29, v26, v27 from semiUp9154714996054945693 where (v29) in (select (v29) from semiDown4488173886743262660);
create or replace view semiDown2302549333565427467 as select id as v21 from info_type AS it1 where (id) in (select (v21) from semiDown4488173886743262660) and info= 'genres';
create or replace view semiDown1439606303874040029 as select id as v26 from info_type AS it2 where (id) in (select (v26) from semiDown8071376947344145625) and info= 'rating';
create or replace view aggView3139656038188879713 as select v8 from semiDown6200160260859643106;
create or replace view aggJoin3459989380384926675 as select v29, v1 from semiDown3009276163914041957 join aggView3139656038188879713 using(v8);
create or replace view aggView374540976092172061 as select v1, v2 as v41 from semiDown1069542460511971555;
create or replace view aggJoin6071758584581542455 as select v29, v41 from aggJoin3459989380384926675 join aggView374540976092172061 using(v1);
create or replace view aggView4101375179034266374 as select v26 from semiDown1439606303874040029;
create or replace view aggJoin3289182950854475888 as select v29, v27 from semiDown8071376947344145625 join aggView4101375179034266374 using(v26);
create or replace view aggView2548295006133258909 as select v21 from semiDown2302549333565427467;
create or replace view aggJoin2477018004820836956 as select v29 from semiDown4488173886743262660 join aggView2548295006133258909 using(v21);
create or replace view aggView3532058801969806465 as select v29, MIN(v27) as v42 from aggJoin3289182950854475888 group by v29;
create or replace view aggJoin8946210448612081988 as select v29, v42 from aggJoin2477018004820836956 join aggView3532058801969806465 using(v29);
create or replace view aggView8105240296225952086 as select v29, MIN(v42) as v42 from aggJoin8946210448612081988 group by v29;
create or replace view aggJoin2831756640455680024 as select v29, v30, v42 from semiUp629223165070066305 join aggView8105240296225952086 using(v29);
create or replace view aggView7324697758509935498 as select v29, MIN(v41) as v41 from aggJoin6071758584581542455 group by v29;
create or replace view aggJoin799528531046522450 as select v30, v42 as v42, v41 from aggJoin2831756640455680024 join aggView7324697758509935498 using(v29);
select MIN(v41) as v41,MIN(v42) as v42,MIN(v30) as v43 from aggJoin799528531046522450;
