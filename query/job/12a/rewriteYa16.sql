create or replace view semiUp8226015807572640910 as select movie_id as v29, company_id as v1, company_type_id as v8 from movie_companies AS mc where (company_type_id) in (select (id) from company_type AS ct where kind= 'production companies');
create or replace view semiUp1127033501069350804 as select v29, v1, v8 from semiUp8226015807572640910 where (v1) in (select (id) from company_name AS cn where country_code= '[us]');
create or replace view semiUp3379471178736044322 as select movie_id as v29, info_type_id as v21 from movie_info AS mi where (info_type_id) in (select (id) from info_type AS it1 where info= 'genres') and info IN ('Drama','Horror');
create or replace view semiUp6480455510643052353 as select movie_id as v29, info_type_id as v26, info as v27 from movie_info_idx AS mi_idx where (movie_id) in (select (v29) from semiUp3379471178736044322) and info>'8.0';
create or replace view semiUp7343858120850670757 as select id as v29, title as v30 from title AS t where (id) in (select (v29) from semiUp1127033501069350804) and production_year<=2008 and production_year>=2005;
create or replace view semiUp3771146721932436684 as select v29, v26, v27 from semiUp6480455510643052353 where (v29) in (select (v29) from semiUp7343858120850670757);
create or replace view semiUp799676165887357121 as select id as v26 from info_type AS it2 where (id) in (select (v26) from semiUp3771146721932436684) and info= 'rating';
create or replace view semiDown6533943325288644094 as select v29, v26, v27 from semiUp3771146721932436684 where (v26) in (select (v26) from semiUp799676165887357121);
create or replace view semiDown2472943937447990617 as select v29, v21 from semiUp3379471178736044322 where (v29) in (select (v29) from semiDown6533943325288644094);
create or replace view semiDown1658587438858246466 as select v29, v30 from semiUp7343858120850670757 where (v29) in (select (v29) from semiDown6533943325288644094);
create or replace view semiDown3207932547875779778 as select id as v21 from info_type AS it1 where (id) in (select (v21) from semiDown2472943937447990617) and info= 'genres';
create or replace view semiDown6727078421017150145 as select v29, v1, v8 from semiUp1127033501069350804 where (v29) in (select (v29) from semiDown1658587438858246466);
create or replace view semiDown8183387813499502521 as select id as v8 from company_type AS ct where (id) in (select (v8) from semiDown6727078421017150145) and kind= 'production companies';
create or replace view semiDown2554400149097369082 as select id as v1, name as v2 from company_name AS cn where (id) in (select (v1) from semiDown6727078421017150145) and country_code= '[us]';
create or replace view aggView3577736366886941036 as select v8 from semiDown8183387813499502521;
create or replace view aggJoin3344977067824589312 as select v29, v1 from semiDown6727078421017150145 join aggView3577736366886941036 using(v8);
create or replace view aggView815216847685483338 as select v1, v2 as v41 from semiDown2554400149097369082;
create or replace view aggJoin8262323556032246149 as select v29, v41 from aggJoin3344977067824589312 join aggView815216847685483338 using(v1);
create or replace view aggView467814558878209361 as select v21 from semiDown3207932547875779778;
create or replace view aggJoin4209915082546037998 as select v29 from semiDown2472943937447990617 join aggView467814558878209361 using(v21);
create or replace view aggView2984839671828109382 as select v29, MIN(v41) as v41 from aggJoin8262323556032246149 group by v29;
create or replace view aggJoin2498604410371986582 as select v29, v30, v41 from semiDown1658587438858246466 join aggView2984839671828109382 using(v29);
create or replace view aggView3492771548836804183 as select v29, MIN(v41) as v41, MIN(v30) as v43 from aggJoin2498604410371986582 group by v29;
create or replace view aggJoin6004767844617004817 as select v29, v26, v27, v41, v43 from semiDown6533943325288644094 join aggView3492771548836804183 using(v29);
create or replace view aggView4454717007931737530 as select v29 from aggJoin4209915082546037998 group by v29;
create or replace view aggJoin877989090582694263 as select v26, v27, v41 as v41, v43 as v43 from aggJoin6004767844617004817 join aggView4454717007931737530 using(v29);
create or replace view aggView6152439613175183069 as select v26, MIN(v41) as v41, MIN(v43) as v43, MIN(v27) as v42 from aggJoin877989090582694263 group by v26;
create or replace view aggJoin6517255187855111105 as select v41, v43, v42 from semiUp799676165887357121 join aggView6152439613175183069 using(v26);
select MIN(v41) as v41,MIN(v42) as v42,MIN(v43) as v43 from aggJoin6517255187855111105;
