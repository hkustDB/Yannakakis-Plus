create or replace view semiUp6873533924703515632 as select movie_id as v29, info_type_id as v26, info as v27 from movie_info_idx AS mi_idx where (info_type_id) in (select (id) from info_type AS it2 where info= 'rating') and info>'8.0';
create or replace view semiUp6227203268497959394 as select movie_id as v29, company_id as v1, company_type_id as v8 from movie_companies AS mc where (company_id) in (select (id) from company_name AS cn where country_code= '[us]');
create or replace view semiUp8401136784289174198 as select movie_id as v29, info_type_id as v21 from movie_info AS mi where (info_type_id) in (select (id) from info_type AS it1 where info= 'genres') and info IN ('Drama','Horror');
create or replace view semiUp4527508021446723313 as select id as v29, title as v30 from title AS t where (id) in (select (v29) from semiUp6873533924703515632) and production_year<=2008 and production_year>=2005;
create or replace view semiUp2815580269484153475 as select v29, v21 from semiUp8401136784289174198 where (v29) in (select (v29) from semiUp4527508021446723313);
create or replace view semiUp1954160951785051018 as select v29, v1, v8 from semiUp6227203268497959394 where (v29) in (select (v29) from semiUp2815580269484153475);
create or replace view semiUp1284363422861134209 as select id as v8 from company_type AS ct where (id) in (select (v8) from semiUp1954160951785051018) and kind= 'production companies';
create or replace view semiDown733249620251800016 as select v29, v1, v8 from semiUp1954160951785051018 where (v8) in (select (v8) from semiUp1284363422861134209);
create or replace view semiDown9222538973373717997 as select id as v1, name as v2 from company_name AS cn where (id) in (select (v1) from semiDown733249620251800016) and country_code= '[us]';
create or replace view semiDown5949883226570074763 as select v29, v21 from semiUp2815580269484153475 where (v29) in (select (v29) from semiDown733249620251800016);
create or replace view semiDown5510420615416175077 as select id as v21 from info_type AS it1 where (id) in (select (v21) from semiDown5949883226570074763) and info= 'genres';
create or replace view semiDown1301165939430808088 as select v29, v30 from semiUp4527508021446723313 where (v29) in (select (v29) from semiDown5949883226570074763);
create or replace view semiDown2917979238760651692 as select v29, v26, v27 from semiUp6873533924703515632 where (v29) in (select (v29) from semiDown1301165939430808088);
create or replace view semiDown9040454444092327480 as select id as v26 from info_type AS it2 where (id) in (select (v26) from semiDown2917979238760651692) and info= 'rating';
create or replace view aggView198061313913506101 as select v1, v2 as v41 from semiDown9222538973373717997;
create or replace view aggJoin2806502442705648108 as select v29, v8, v41 from semiDown733249620251800016 join aggView198061313913506101 using(v1);
create or replace view aggView4194223543842327755 as select v21 from semiDown5510420615416175077;
create or replace view aggJoin8412527733326415351 as select v29 from semiDown5949883226570074763 join aggView4194223543842327755 using(v21);
create or replace view aggView7206416842405662355 as select v26 from semiDown9040454444092327480;
create or replace view aggJoin3303942430752700327 as select v29, v27 from semiDown2917979238760651692 join aggView7206416842405662355 using(v26);
create or replace view aggView4772105580322487696 as select v29, MIN(v27) as v42 from aggJoin3303942430752700327 group by v29;
create or replace view aggJoin6282349511985995979 as select v29, v30, v42 from semiDown1301165939430808088 join aggView4772105580322487696 using(v29);
create or replace view aggView2337131936467882776 as select v29, MIN(v42) as v42, MIN(v30) as v43 from aggJoin6282349511985995979 group by v29;
create or replace view aggJoin8564811276495318151 as select v29, v42, v43 from aggJoin8412527733326415351 join aggView2337131936467882776 using(v29);
create or replace view aggView3039698655494855712 as select v29, MIN(v42) as v42, MIN(v43) as v43 from aggJoin8564811276495318151 group by v29;
create or replace view aggJoin7881357874807623474 as select v8, v41 as v41, v42, v43 from aggJoin2806502442705648108 join aggView3039698655494855712 using(v29);
create or replace view aggView3740470679553349679 as select v8, MIN(v41) as v41, MIN(v42) as v42, MIN(v43) as v43 from aggJoin7881357874807623474 group by v8;
create or replace view aggJoin837213872857704362 as select v41, v42, v43 from semiUp1284363422861134209 join aggView3740470679553349679 using(v8);
select MIN(v41) as v41,MIN(v42) as v42,MIN(v43) as v43 from aggJoin837213872857704362;
