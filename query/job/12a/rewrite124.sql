create or replace view aggView2239435799355900578 as select id as v1, name as v41 from company_name as cn where country_code= '[us]';
create or replace view aggJoin485756114670639174 as select movie_id as v29, company_type_id as v8, v41 from movie_companies as mc, aggView2239435799355900578 where mc.company_id=aggView2239435799355900578.v1;
create or replace view aggView3040010588897125326 as select id as v29, title as v43 from title as t where production_year<=2008 and production_year>=2005;
create or replace view aggJoin2969584688033469846 as select v29, v8, v41, v43 from aggJoin485756114670639174 join aggView3040010588897125326 using(v29);
create or replace view aggView9105155029323579832 as select id as v26 from info_type as it2 where info= 'rating';
create or replace view aggJoin710814920539865971 as select movie_id as v29, info as v27 from movie_info_idx as mi_idx, aggView9105155029323579832 where mi_idx.info_type_id=aggView9105155029323579832.v26 and info>'8.0';
create or replace view aggView2090462428541424796 as select id as v21 from info_type as it1 where info= 'genres';
create or replace view aggJoin1394192041930927483 as select movie_id as v29 from movie_info as mi, aggView2090462428541424796 where mi.info_type_id=aggView2090462428541424796.v21 and info IN ('Drama','Horror');
create or replace view aggView4337271801967547327 as select v29 from aggJoin1394192041930927483 group by v29;
create or replace view aggJoin6713957482739300251 as select v29, v8, v41 as v41, v43 as v43 from aggJoin2969584688033469846 join aggView4337271801967547327 using(v29);
create or replace view aggView4798707986973723252 as select id as v8 from company_type as ct where kind= 'production companies';
create or replace view aggJoin682743079876185963 as select v29, v41, v43 from aggJoin6713957482739300251 join aggView4798707986973723252 using(v8);
create or replace view aggView256347265924701470 as select v29, MIN(v41) as v41, MIN(v43) as v43 from aggJoin682743079876185963 group by v29;
create or replace view aggJoin7481752648522317786 as select v27, v41, v43 from aggJoin710814920539865971 join aggView256347265924701470 using(v29);
create or replace view res as select MIN(v41) as v41, MIN(v27) as v42, MIN(v43) as v43 from aggJoin7481752648522317786;
select sum(v41+v42+v43) from res;