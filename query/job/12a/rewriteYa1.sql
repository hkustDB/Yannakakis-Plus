create or replace view semiUp6919348935363999707 as select movie_id as v29, company_id as v1, company_type_id as v8 from movie_companies AS mc where (company_type_id) in (select (id) from company_type AS ct where kind= 'production companies');
create or replace view semiUp8763925622750634000 as select movie_id as v29, info_type_id as v21 from movie_info AS mi where (info_type_id) in (select (id) from info_type AS it1 where info= 'genres') and info IN ('Drama','Horror');
create or replace view semiUp6758963451397168261 as select v29, v1, v8 from semiUp6919348935363999707 where (v1) in (select (id) from company_name AS cn where country_code= '[us]');
create or replace view semiUp7824203615504428375 as select id as v29, title as v30 from title AS t where (id) in (select (v29) from semiUp6758963451397168261) and production_year<=2008 and production_year>=2005;
create or replace view semiUp9007407804586161214 as select movie_id as v29, info_type_id as v26, info as v27 from movie_info_idx AS mi_idx where (info_type_id) in (select (id) from info_type AS it2 where info= 'rating') and info>'8.0';
create or replace view semiUp484171381627700361 as select v29, v30 from semiUp7824203615504428375 where (v29) in (select (v29) from semiUp9007407804586161214);
create or replace view semiUp6009840586116404364 as select v29, v21 from semiUp8763925622750634000 where (v29) in (select (v29) from semiUp484171381627700361);
create or replace view semiDown7090395376403792076 as select id as v21 from info_type AS it1 where (id) in (select (v21) from semiUp6009840586116404364) and info= 'genres';
create or replace view semiDown1194680351079418344 as select v29, v30 from semiUp484171381627700361 where (v29) in (select (v29) from semiUp6009840586116404364);
create or replace view semiDown620075803559062878 as select v29, v1, v8 from semiUp6758963451397168261 where (v29) in (select (v29) from semiDown1194680351079418344);
create or replace view semiDown6819345193289096426 as select v29, v26, v27 from semiUp9007407804586161214 where (v29) in (select (v29) from semiDown1194680351079418344);
create or replace view semiDown6189094697210011788 as select id as v8 from company_type AS ct where (id) in (select (v8) from semiDown620075803559062878) and kind= 'production companies';
create or replace view semiDown7717912689627020089 as select id as v1, name as v2 from company_name AS cn where (id) in (select (v1) from semiDown620075803559062878) and country_code= '[us]';
create or replace view semiDown4655027607200019667 as select id as v26 from info_type AS it2 where (id) in (select (v26) from semiDown6819345193289096426) and info= 'rating';
create or replace view aggView7894656760701249857 as select v26 from semiDown4655027607200019667;
create or replace view aggJoin2348266908526016153 as select v29, v27 from semiDown6819345193289096426 join aggView7894656760701249857 using(v26);
create or replace view aggView3998684348452527960 as select v21 from semiDown7090395376403792076;
create or replace view aggJoin3844578502791542289 as select v29 from semiUp6009840586116404364 join aggView3998684348452527960 using(v21);
create or replace view aggView2468943685924360863 as select v8 from semiDown6189094697210011788;
create or replace view aggJoin8928498550236065510 as select v29, v1 from semiDown620075803559062878 join aggView2468943685924360863 using(v8);
create or replace view aggView8511628649961003751 as select v1, v2 as v41 from semiDown7717912689627020089;
create or replace view aggJoin5354767047854109192 as select v29, v41 from aggJoin8928498550236065510 join aggView8511628649961003751 using(v1);
create or replace view aggView7597412951367577638 as select v29, MIN(v41) as v41 from aggJoin5354767047854109192 group by v29;
create or replace view aggJoin275996595486146340 as select v29, v30, v41 from semiDown1194680351079418344 join aggView7597412951367577638 using(v29);
create or replace view aggView5350479550646111311 as select v29, MIN(v27) as v42 from aggJoin2348266908526016153 group by v29;
create or replace view aggJoin7368895813085027059 as select v29, v30, v41 as v41, v42 from aggJoin275996595486146340 join aggView5350479550646111311 using(v29);
create or replace view aggView2061420924615088063 as select v29, MIN(v41) as v41, MIN(v42) as v42, MIN(v30) as v43 from aggJoin7368895813085027059 group by v29;
create or replace view aggJoin3186270048881716207 as select v41, v42, v43 from aggJoin3844578502791542289 join aggView2061420924615088063 using(v29);
select MIN(v41) as v41,MIN(v42) as v42,MIN(v43) as v43 from aggJoin3186270048881716207;
