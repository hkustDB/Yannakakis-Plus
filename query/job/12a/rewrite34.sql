create or replace view aggView1157119119980423873 as select id as v26 from info_type as it2 where info= 'rating';
create or replace view aggJoin3480578078373325450 as select movie_id as v29, info as v27 from movie_info_idx as mi_idx, aggView1157119119980423873 where mi_idx.info_type_id=aggView1157119119980423873.v26;
create or replace view aggView3058111759648885605 as select v29, v27 from aggJoin3480578078373325450;
create or replace view aggJoin3480023856090362945 as select v29, v27 from aggView3058111759648885605 where v27>'8.0';
create or replace view aggView3924154672577570593 as select name as v2, id as v1 from company_name as cn where country_code= '[us]';
create or replace view aggView4703729674195879202 as select id as v29, title as v30 from title as t where production_year<=2008 and production_year>=2005;
create or replace view aggView4962730535869783784 as select v1, MIN(v2) as v41 from aggView3924154672577570593 group by v1;
create or replace view aggJoin3294345865734293576 as select movie_id as v29, company_type_id as v8, v41 from movie_companies as mc, aggView4962730535869783784 where mc.company_id=aggView4962730535869783784.v1;
create or replace view aggView4848981815582128964 as select v29, MIN(v30) as v43 from aggView4703729674195879202 group by v29;
create or replace view aggJoin4228402564238817391 as select v29, v8, v41 as v41, v43 from aggJoin3294345865734293576 join aggView4848981815582128964 using(v29);
create or replace view aggView7586926438858424607 as select id as v8 from company_type as ct where kind= 'production companies';
create or replace view aggJoin1474980065916447871 as select v29, v41, v43 from aggJoin4228402564238817391 join aggView7586926438858424607 using(v8);
create or replace view aggView8249341100691249143 as select id as v21 from info_type as it1 where info= 'genres';
create or replace view aggJoin710840330285475142 as select movie_id as v29, info as v22 from movie_info as mi, aggView8249341100691249143 where mi.info_type_id=aggView8249341100691249143.v21 and info IN ('Drama','Horror');
create or replace view aggView3898759115372645583 as select v29 from aggJoin710840330285475142 group by v29;
create or replace view aggJoin9146140743005512694 as select v29, v41 as v41, v43 as v43 from aggJoin1474980065916447871 join aggView3898759115372645583 using(v29);
create or replace view aggView908763298380884376 as select v29, MIN(v41) as v41, MIN(v43) as v43 from aggJoin9146140743005512694 group by v29;
create or replace view aggJoin902701228432847041 as select v27, v41, v43 from aggJoin3480023856090362945 join aggView908763298380884376 using(v29);
select MIN(v41) as v41,MIN(v27) as v42,MIN(v43) as v43 from aggJoin902701228432847041;
