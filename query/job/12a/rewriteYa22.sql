create or replace view semiUp3941216857845762941 as select movie_id as v29, company_id as v1, company_type_id as v8 from movie_companies AS mc where (company_id) in (select (id) from company_name AS cn where country_code= '[us]');
create or replace view semiUp1447656954206813753 as select v29, v1, v8 from semiUp3941216857845762941 where (v8) in (select (id) from company_type AS ct where kind= 'production companies');
create or replace view semiUp5925938814490938241 as select movie_id as v29, info_type_id as v21 from movie_info AS mi where (info_type_id) in (select (id) from info_type AS it1 where info= 'genres') and info IN ('Drama','Horror');
create or replace view semiUp3082035558353408235 as select v29, v21 from semiUp5925938814490938241 where (v29) in (select (v29) from semiUp1447656954206813753);
create or replace view semiUp2691634443342640223 as select id as v29, title as v30 from title AS t where (id) in (select (v29) from semiUp3082035558353408235) and production_year<=2008 and production_year>=2005;
create or replace view semiUp6807775750952200175 as select movie_id as v29, info_type_id as v26, info as v27 from movie_info_idx AS mi_idx where (info_type_id) in (select (id) from info_type AS it2 where info= 'rating') and info>'8.0';
create or replace view semiUp8658613446651169562 as select v29, v30 from semiUp2691634443342640223 where (v29) in (select (v29) from semiUp6807775750952200175);
create or replace view semiDown7612496844553809928 as select v29, v21 from semiUp3082035558353408235 where (v29) in (select (v29) from semiUp8658613446651169562);
create or replace view semiDown7754685681278107087 as select v29, v26, v27 from semiUp6807775750952200175 where (v29) in (select (v29) from semiUp8658613446651169562);
create or replace view semiDown710524241328838329 as select id as v21 from info_type AS it1 where (id) in (select (v21) from semiDown7612496844553809928) and info= 'genres';
create or replace view semiDown2984929943949830512 as select v29, v1, v8 from semiUp1447656954206813753 where (v29) in (select (v29) from semiDown7612496844553809928);
create or replace view semiDown2769873146133727377 as select id as v26 from info_type AS it2 where (id) in (select (v26) from semiDown7754685681278107087) and info= 'rating';
create or replace view semiDown5315687256190104143 as select id as v8 from company_type AS ct where (id) in (select (v8) from semiDown2984929943949830512) and kind= 'production companies';
create or replace view semiDown3740443926511567425 as select id as v1, name as v2 from company_name AS cn where (id) in (select (v1) from semiDown2984929943949830512) and country_code= '[us]';
create or replace view aggView9088121380465046705 as select v21 from semiDown710524241328838329;
create or replace view aggJoin6524169143806767197 as select v29 from semiDown7612496844553809928 join aggView9088121380465046705 using(v21);
create or replace view aggView8479140114188477755 as select v1, v2 as v41 from semiDown3740443926511567425;
create or replace view aggJoin5029701127673910392 as select v29, v8, v41 from semiDown2984929943949830512 join aggView8479140114188477755 using(v1);
create or replace view aggView4680417690750295630 as select v26 from semiDown2769873146133727377;
create or replace view aggJoin7724639676139781913 as select v29, v27 from semiDown7754685681278107087 join aggView4680417690750295630 using(v26);
create or replace view aggView5879059425329029226 as select v29, MIN(v27) as v42 from aggJoin7724639676139781913 group by v29;
create or replace view aggJoin4101773634479220191 as select v29, v30, v42 from semiUp8658613446651169562 join aggView5879059425329029226 using(v29);
create or replace view aggView3166588155434833626 as select v8 from semiDown5315687256190104143;
create or replace view aggJoin594922491514272660 as select v29, v41 from aggJoin5029701127673910392 join aggView3166588155434833626 using(v8);
create or replace view aggView1452071263309427395 as select v29, MIN(v41) as v41 from aggJoin594922491514272660 group by v29;
create or replace view aggJoin1282345071806940375 as select v29, v41 from aggJoin6524169143806767197 join aggView1452071263309427395 using(v29);
create or replace view aggView1195030156399129871 as select v29, MIN(v41) as v41 from aggJoin1282345071806940375 group by v29;
create or replace view aggJoin2303961671939983801 as select v30, v42 as v42, v41 from aggJoin4101773634479220191 join aggView1195030156399129871 using(v29);
select MIN(v41) as v41,MIN(v42) as v42,MIN(v30) as v43 from aggJoin2303961671939983801;
