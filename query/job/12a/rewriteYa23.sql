create or replace view semiUp7939744573449295739 as select movie_id as v29, info_type_id as v26, info as v27 from movie_info_idx AS mi_idx where (info_type_id) in (select (id) from info_type AS it2 where info= 'rating') and info>'8.0';
create or replace view semiUp7985907115267476949 as select movie_id as v29, company_id as v1, company_type_id as v8 from movie_companies AS mc where (company_type_id) in (select (id) from company_type AS ct where kind= 'production companies');
create or replace view semiUp1058167861247278080 as select v29, v1, v8 from semiUp7985907115267476949 where (v1) in (select (id) from company_name AS cn where country_code= '[us]');
create or replace view semiUp3891328410678808382 as select movie_id as v29, info_type_id as v21 from movie_info AS mi where (info_type_id) in (select (id) from info_type AS it1 where info= 'genres') and info IN ('Drama','Horror');
create or replace view semiUp536648468289311137 as select id as v29, title as v30 from title AS t where (id) in (select (v29) from semiUp1058167861247278080) and production_year<=2008 and production_year>=2005;
create or replace view semiUp7517586701634314570 as select v29, v30 from semiUp536648468289311137 where (v29) in (select (v29) from semiUp3891328410678808382);
create or replace view semiUp3163993808143464385 as select v29, v26, v27 from semiUp7939744573449295739 where (v29) in (select (v29) from semiUp7517586701634314570);
create or replace view semiDown5095332844176145136 as select v29, v30 from semiUp7517586701634314570 where (v29) in (select (v29) from semiUp3163993808143464385);
create or replace view semiDown6102383166013602836 as select id as v26 from info_type AS it2 where (id) in (select (v26) from semiUp3163993808143464385) and info= 'rating';
create or replace view semiDown6233682720862960201 as select v29, v1, v8 from semiUp1058167861247278080 where (v29) in (select (v29) from semiDown5095332844176145136);
create or replace view semiDown1503573790165393979 as select v29, v21 from semiUp3891328410678808382 where (v29) in (select (v29) from semiDown5095332844176145136);
create or replace view semiDown8516165677545691041 as select id as v8 from company_type AS ct where (id) in (select (v8) from semiDown6233682720862960201) and kind= 'production companies';
create or replace view semiDown8089514517879131546 as select id as v1, name as v2 from company_name AS cn where (id) in (select (v1) from semiDown6233682720862960201) and country_code= '[us]';
create or replace view semiDown1612983183846470968 as select id as v21 from info_type AS it1 where (id) in (select (v21) from semiDown1503573790165393979) and info= 'genres';
create or replace view aggView5144501305656396498 as select v26 from semiDown6102383166013602836;
create or replace view aggJoin3598829327340182140 as select v29, v27 from semiUp3163993808143464385 join aggView5144501305656396498 using(v26);
create or replace view aggView6940138911732838645 as select v21 from semiDown1612983183846470968;
create or replace view aggJoin1819886754374227248 as select v29 from semiDown1503573790165393979 join aggView6940138911732838645 using(v21);
create or replace view aggView448769664662845552 as select v1, v2 as v41 from semiDown8089514517879131546;
create or replace view aggJoin4615735323352011111 as select v29, v8, v41 from semiDown6233682720862960201 join aggView448769664662845552 using(v1);
create or replace view aggView8188052580718058963 as select v29 from aggJoin1819886754374227248 group by v29;
create or replace view aggJoin73019222012251547 as select v29, v30 from semiDown5095332844176145136 join aggView8188052580718058963 using(v29);
create or replace view aggView2244924215759969589 as select v8 from semiDown8516165677545691041;
create or replace view aggJoin4025577235436335851 as select v29, v41 from aggJoin4615735323352011111 join aggView2244924215759969589 using(v8);
create or replace view aggView929537490444092629 as select v29, MIN(v41) as v41 from aggJoin4025577235436335851 group by v29;
create or replace view aggJoin6671271105002785373 as select v29, v30, v41 from aggJoin73019222012251547 join aggView929537490444092629 using(v29);
create or replace view aggView9078524667633520667 as select v29, MIN(v41) as v41, MIN(v30) as v43 from aggJoin6671271105002785373 group by v29;
create or replace view aggJoin1058105305575398298 as select v27, v41, v43 from aggJoin3598829327340182140 join aggView9078524667633520667 using(v29);
select MIN(v41) as v41,MIN(v27) as v42,MIN(v43) as v43 from aggJoin1058105305575398298;
