create or replace view semiUp2674711639255909419 as select movie_id as v37, company_id as v1, company_type_id as v8 from movie_companies AS mc where (company_id) in (select (id) from company_name AS cn where country_code<> '[us]') and note NOT LIKE '%(USA)%' and note LIKE '%(200%)%';
create or replace view semiUp7622188449469159204 as select id as v37, title as v38, kind_id as v17 from title AS t where (kind_id) in (select (id) from kind_type AS kt where kind IN ('movie','episode')) and production_year>2009;
create or replace view semiUp3824315049284513517 as select movie_id as v37, info_type_id as v12, info as v32 from movie_info_idx AS mi_idx where (info_type_id) in (select (id) from info_type AS it2 where info= 'rating') and info<'7.0';
create or replace view semiUp8246105269688465157 as select movie_id as v37, keyword_id as v14 from movie_keyword AS mk where (keyword_id) in (select (id) from keyword AS k where keyword IN ('murder','murder-in-title','blood','violence'));
create or replace view semiUp2228881469656291234 as select v37, v12, v32 from semiUp3824315049284513517 where (v37) in (select (v37) from semiUp8246105269688465157);
create or replace view semiUp3521056416529772353 as select v37, v1, v8 from semiUp2674711639255909419 where (v8) in (select (id) from company_type AS ct);
create or replace view semiUp3621886153505227466 as select movie_id as v37, info_type_id as v10 from movie_info AS mi where (movie_id) in (select (v37) from semiUp2228881469656291234) and info IN ('Germany','German','USA','American');
create or replace view semiUp5668671873572061646 as select v37, v38, v17 from semiUp7622188449469159204 where (v37) in (select (v37) from semiUp3521056416529772353);
create or replace view semiUp7251441091439492122 as select v37, v10 from semiUp3621886153505227466 where (v37) in (select (v37) from semiUp5668671873572061646);
create or replace view semiUp4820972109370303007 as select id as v10 from info_type AS it1 where (id) in (select (v10) from semiUp7251441091439492122) and info= 'countries';
create or replace view semiDown2706860026959861882 as select v37, v10 from semiUp7251441091439492122 where (v10) in (select (v10) from semiUp4820972109370303007);
create or replace view semiDown4826609410626966377 as select v37, v38, v17 from semiUp5668671873572061646 where (v37) in (select (v37) from semiDown2706860026959861882);
create or replace view semiDown1710896982739239145 as select v37, v12, v32 from semiUp2228881469656291234 where (v37) in (select (v37) from semiDown2706860026959861882);
create or replace view semiDown8177458599844243475 as select v37, v1, v8 from semiUp3521056416529772353 where (v37) in (select (v37) from semiDown4826609410626966377);
create or replace view semiDown8624006211946308343 as select id as v17 from kind_type AS kt where (id) in (select (v17) from semiDown4826609410626966377) and kind IN ('movie','episode');
create or replace view semiDown5860485561440750626 as select v37, v14 from semiUp8246105269688465157 where (v37) in (select (v37) from semiDown1710896982739239145);
create or replace view semiDown9042828355789938177 as select id as v12 from info_type AS it2 where (id) in (select (v12) from semiDown1710896982739239145) and info= 'rating';
create or replace view semiDown7068444384100825636 as select id as v1, name as v2 from company_name AS cn where (id) in (select (v1) from semiDown8177458599844243475) and country_code<> '[us]';
create or replace view semiDown3412660318830990705 as select id as v8 from company_type AS ct where (id) in (select (v8) from semiDown8177458599844243475);
create or replace view semiDown6072810014326997983 as select id as v14 from keyword AS k where (id) in (select (v14) from semiDown5860485561440750626) and keyword IN ('murder','murder-in-title','blood','violence');
create or replace view aggView7189842512042380623 as select v17 from semiDown8624006211946308343;
create or replace view aggJoin3066229918523120969 as select v37, v38 from semiDown4826609410626966377 join aggView7189842512042380623 using(v17);
create or replace view aggView2794289901600163797 as select v14 from semiDown6072810014326997983;
create or replace view aggJoin7853382725105992906 as select v37 from semiDown5860485561440750626 join aggView2794289901600163797 using(v14);
create or replace view aggView6634864774099063711 as select v12 from semiDown9042828355789938177;
create or replace view aggJoin7672304062311341885 as select v37, v32 from semiDown1710896982739239145 join aggView6634864774099063711 using(v12);
create or replace view aggView7613702827117305606 as select v1, v2 as v49 from semiDown7068444384100825636;
create or replace view aggJoin4172716797514540783 as select v37, v8, v49 from semiDown8177458599844243475 join aggView7613702827117305606 using(v1);
create or replace view aggView4606505276051450926 as select v8 from semiDown3412660318830990705;
create or replace view aggJoin4745858130046904899 as select v37, v49 from aggJoin4172716797514540783 join aggView4606505276051450926 using(v8);
create or replace view aggView818615128943138553 as select v37 from aggJoin7853382725105992906 group by v37;
create or replace view aggJoin4727529954916152338 as select v37, v32 from aggJoin7672304062311341885 join aggView818615128943138553 using(v37);
create or replace view aggView1937441053839141740 as select v37, MIN(v49) as v49 from aggJoin4745858130046904899 group by v37;
create or replace view aggJoin1344542674852574196 as select v37, v38, v49 from aggJoin3066229918523120969 join aggView1937441053839141740 using(v37);
create or replace view aggView5750312669876185074 as select v37, MIN(v32) as v50 from aggJoin4727529954916152338 group by v37;
create or replace view aggJoin1149348712892875224 as select v37, v10, v50 from semiDown2706860026959861882 join aggView5750312669876185074 using(v37);
create or replace view aggView6383879572759592089 as select v37, MIN(v49) as v49, MIN(v38) as v51 from aggJoin1344542674852574196 group by v37;
create or replace view aggJoin1256226277693238429 as select v10, v50 as v50, v49, v51 from aggJoin1149348712892875224 join aggView6383879572759592089 using(v37);
create or replace view aggView631165436063780459 as select v10, MIN(v50) as v50, MIN(v49) as v49, MIN(v51) as v51 from aggJoin1256226277693238429 group by v10;
create or replace view aggJoin2780717927823856309 as select v50, v49, v51 from semiUp4820972109370303007 join aggView631165436063780459 using(v10);
select MIN(v49) as v49,MIN(v50) as v50,MIN(v51) as v51 from aggJoin2780717927823856309;
