create or replace view aggView4193829623243097209 as select id as v1, name as v49 from company_name as cn where country_code<> '[us]';
create or replace view aggJoin7194635408985245606 as select movie_id as v37, company_type_id as v8, note as v23, v49 from movie_companies as mc, aggView4193829623243097209 where mc.company_id=aggView4193829623243097209.v1 and note NOT LIKE '%(USA)%' and note LIKE '%(200%)%';
create or replace view aggView6057960413523242970 as select id as v12 from info_type as it2 where info= 'rating';
create or replace view aggJoin7885710215495824195 as select movie_id as v37, info as v32 from movie_info_idx as mi_idx, aggView6057960413523242970 where mi_idx.info_type_id=aggView6057960413523242970.v12 and info<'7.0';
create or replace view aggView4219140030873762882 as select v37, MIN(v32) as v50 from aggJoin7885710215495824195 group by v37;
create or replace view aggJoin3500898360362587656 as select movie_id as v37, info_type_id as v10, v50 from movie_info as mi, aggView4219140030873762882 where mi.movie_id=aggView4219140030873762882.v37 and info IN ('Germany','German','USA','American');
create or replace view aggView2252359373258618007 as select id as v17 from kind_type as kt where kind IN ('movie','episode');
create or replace view aggJoin7973185295950734540 as select id as v37, title as v38 from title as t, aggView2252359373258618007 where t.kind_id=aggView2252359373258618007.v17 and production_year>2009;
create or replace view aggView8159307768252780244 as select id as v10 from info_type as it1 where info= 'countries';
create or replace view aggJoin6153916056624860233 as select v37, v50 from aggJoin3500898360362587656 join aggView8159307768252780244 using(v10);
create or replace view aggView8508823962413719547 as select v37, MIN(v50) as v50 from aggJoin6153916056624860233 group by v37;
create or replace view aggJoin7600249457507571371 as select movie_id as v37, keyword_id as v14, v50 from movie_keyword as mk, aggView8508823962413719547 where mk.movie_id=aggView8508823962413719547.v37;
create or replace view aggView602146214605847120 as select id as v14 from keyword as k where keyword IN ('murder','murder-in-title','blood','violence');
create or replace view aggJoin1767245072757995520 as select v37, v50 from aggJoin7600249457507571371 join aggView602146214605847120 using(v14);
create or replace view aggView8395935772036230785 as select v37, MIN(v50) as v50 from aggJoin1767245072757995520 group by v37;
create or replace view aggJoin6744248701918266132 as select v37, v38, v50 from aggJoin7973185295950734540 join aggView8395935772036230785 using(v37);
create or replace view aggView7807528285771110319 as select v37, MIN(v50) as v50, MIN(v38) as v51 from aggJoin6744248701918266132 group by v37;
create or replace view aggJoin4837308837348396653 as select v8, v49 as v49, v50, v51 from aggJoin7194635408985245606 join aggView7807528285771110319 using(v37);
create or replace view aggView8628420257128896844 as select v8, MIN(v49) as v49, MIN(v50) as v50, MIN(v51) as v51 from aggJoin4837308837348396653 group by v8;
create or replace view aggJoin8926063131201387858 as select v49, v50, v51 from company_type as ct, aggView8628420257128896844 where ct.id=aggView8628420257128896844.v8;
create or replace view res as select MIN(v49) as v49, MIN(v50) as v50, MIN(v51) as v51 from aggJoin8926063131201387858;
select sum(v49+v50+v51) from res;