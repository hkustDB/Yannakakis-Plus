create or replace view aggView7271257792384556252 as select id as v1, name as v49 from company_name as cn where country_code<> '[us]';
create or replace view aggJoin5706459904222235717 as select movie_id as v37, company_type_id as v8, note as v23, v49 from movie_companies as mc, aggView7271257792384556252 where mc.company_id=aggView7271257792384556252.v1 and note NOT LIKE '%(USA)%' and note LIKE '%(200%)%';
create or replace view aggView7086901189619711342 as select id as v8 from company_type as ct;
create or replace view aggJoin7934533397355594592 as select v37, v23, v49 from aggJoin5706459904222235717 join aggView7086901189619711342 using(v8);
create or replace view aggView7623206465892042312 as select id as v12 from info_type as it2 where info= 'rating';
create or replace view aggJoin11363647279798627 as select movie_id as v37, info as v32 from movie_info_idx as mi_idx, aggView7623206465892042312 where mi_idx.info_type_id=aggView7623206465892042312.v12 and info<'7.0';
create or replace view aggView9025689626525854268 as select id as v17 from kind_type as kt where kind IN ('movie','episode');
create or replace view aggJoin5269006744979480137 as select id as v37, title as v38 from title as t, aggView9025689626525854268 where t.kind_id=aggView9025689626525854268.v17 and production_year>2009;
create or replace view aggView4736126144299582164 as select v37, MIN(v38) as v51 from aggJoin5269006744979480137 group by v37;
create or replace view aggJoin8367014984963981341 as select v37, v32, v51 from aggJoin11363647279798627 join aggView4736126144299582164 using(v37);
create or replace view aggView1582196798407954115 as select v37, MIN(v51) as v51, MIN(v32) as v50 from aggJoin8367014984963981341 group by v37;
create or replace view aggJoin910876062264825903 as select movie_id as v37, keyword_id as v14, v51, v50 from movie_keyword as mk, aggView1582196798407954115 where mk.movie_id=aggView1582196798407954115.v37;
create or replace view aggView5708275615181808798 as select v37, MIN(v49) as v49 from aggJoin7934533397355594592 group by v37;
create or replace view aggJoin3319160546942174766 as select movie_id as v37, info_type_id as v10, v49 from movie_info as mi, aggView5708275615181808798 where mi.movie_id=aggView5708275615181808798.v37 and info IN ('Germany','German','USA','American');
create or replace view aggView2731899637855588493 as select id as v10 from info_type as it1 where info= 'countries';
create or replace view aggJoin2939945053470027393 as select v37, v49 from aggJoin3319160546942174766 join aggView2731899637855588493 using(v10);
create or replace view aggView6499769770003563984 as select v37, MIN(v49) as v49 from aggJoin2939945053470027393 group by v37;
create or replace view aggJoin7597805087441633948 as select v14, v51 as v51, v50 as v50, v49 from aggJoin910876062264825903 join aggView6499769770003563984 using(v37);
create or replace view aggView3976481234520926764 as select v14, MIN(v51) as v51, MIN(v50) as v50, MIN(v49) as v49 from aggJoin7597805087441633948 group by v14;
create or replace view aggJoin178722977483810991 as select v51, v50, v49 from keyword as k, aggView3976481234520926764 where k.id=aggView3976481234520926764.v14 and keyword IN ('murder','murder-in-title','blood','violence');
create or replace view res as select MIN(v49) as v49, MIN(v50) as v50, MIN(v51) as v51 from aggJoin178722977483810991;
select sum(v49+v50+v51) from res;