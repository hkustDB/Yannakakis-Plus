create or replace view aggView1304858616399307767 as select id as v1, name as v49 from company_name as cn where country_code<> '[us]';
create or replace view aggJoin5165043558202256927 as select movie_id as v37, company_type_id as v8, note as v23, v49 from movie_companies as mc, aggView1304858616399307767 where mc.company_id=aggView1304858616399307767.v1 and note NOT LIKE '%(USA)%' and note LIKE '%(200%)%';
create or replace view aggView5533598584700607452 as select id as v8 from company_type as ct;
create or replace view aggJoin1972995621282798140 as select v37, v23, v49 from aggJoin5165043558202256927 join aggView5533598584700607452 using(v8);
create or replace view aggView3679344340818022430 as select id as v12 from info_type as it2 where info= 'rating';
create or replace view aggJoin4563991075199225695 as select movie_id as v37, info as v32 from movie_info_idx as mi_idx, aggView3679344340818022430 where mi_idx.info_type_id=aggView3679344340818022430.v12 and info<'7.0';
create or replace view aggView8357370504304331574 as select v37, MIN(v49) as v49 from aggJoin1972995621282798140 group by v37;
create or replace view aggJoin386334626048824255 as select v37, v32, v49 from aggJoin4563991075199225695 join aggView8357370504304331574 using(v37);
create or replace view aggView6224030174272939245 as select v37, MIN(v49) as v49, MIN(v32) as v50 from aggJoin386334626048824255 group by v37;
create or replace view aggJoin17458022269298982 as select movie_id as v37, keyword_id as v14, v49, v50 from movie_keyword as mk, aggView6224030174272939245 where mk.movie_id=aggView6224030174272939245.v37;
create or replace view aggView1159402561871723730 as select id as v14 from keyword as k where keyword IN ('murder','murder-in-title','blood','violence');
create or replace view aggJoin3904865139941782942 as select v37, v49, v50 from aggJoin17458022269298982 join aggView1159402561871723730 using(v14);
create or replace view aggView1636748304283989397 as select v37, MIN(v49) as v49, MIN(v50) as v50 from aggJoin3904865139941782942 group by v37;
create or replace view aggJoin8182947223347809032 as select id as v37, title as v38, kind_id as v17, v49, v50 from title as t, aggView1636748304283989397 where t.id=aggView1636748304283989397.v37 and production_year>2009;
create or replace view aggView6104448042213338264 as select id as v10 from info_type as it1 where info= 'countries';
create or replace view aggJoin8410698536041942436 as select movie_id as v37 from movie_info as mi, aggView6104448042213338264 where mi.info_type_id=aggView6104448042213338264.v10 and info IN ('Germany','German','USA','American');
create or replace view aggView6975724319692373337 as select v37 from aggJoin8410698536041942436 group by v37;
create or replace view aggJoin7520486007073089003 as select v38, v17, v49 as v49, v50 as v50 from aggJoin8182947223347809032 join aggView6975724319692373337 using(v37);
create or replace view aggView8417728543621043730 as select v17, MIN(v49) as v49, MIN(v50) as v50, MIN(v38) as v51 from aggJoin7520486007073089003 group by v17;
create or replace view aggJoin8303000629659043427 as select v49, v50, v51 from kind_type as kt, aggView8417728543621043730 where kt.id=aggView8417728543621043730.v17 and kind IN ('movie','episode');
create or replace view res as select MIN(v49) as v49, MIN(v50) as v50, MIN(v51) as v51 from aggJoin8303000629659043427;
select sum(v49+v50+v51) from res;