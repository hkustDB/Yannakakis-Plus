create or replace view aggView1064430639814733758 as select id as v17 from kind_type as kt where kind IN ('movie','episode');
create or replace view aggJoin7556166641717737734 as select id as v37, title as v38, production_year as v41 from title as t, aggView1064430639814733758 where t.kind_id=aggView1064430639814733758.v17 and production_year>2009;
create or replace view aggView7252409384453992287 as select id as v12 from info_type as it2 where info= 'rating';
create or replace view aggJoin2680658192625355438 as select movie_id as v37, info as v32 from movie_info_idx as mi_idx, aggView7252409384453992287 where mi_idx.info_type_id=aggView7252409384453992287.v12 and info<'7.0';
create or replace view aggView6889538840989943196 as select v37, MIN(v32) as v50 from aggJoin2680658192625355438 group by v37;
create or replace view aggJoin6581293640071045891 as select v37, v38, v41, v50 from aggJoin7556166641717737734 join aggView6889538840989943196 using(v37);
create or replace view aggView4942444932799907042 as select v37, MIN(v50) as v50, MIN(v38) as v51 from aggJoin6581293640071045891 group by v37;
create or replace view aggJoin4575671509418615484 as select movie_id as v37, company_id as v1, company_type_id as v8, note as v23, v50, v51 from movie_companies as mc, aggView4942444932799907042 where mc.movie_id=aggView4942444932799907042.v37 and note NOT LIKE '%(USA)%' and note LIKE '%(200%)%';
create or replace view aggView8743751451986258499 as select v1, v8, v37, MIN(v50) as v50, MIN(v51) as v51 from aggJoin4575671509418615484 group by v1,v8,v37;
create or replace view aggJoin4373263996681525961 as select name as v2, country_code as v3, v8, v37, v50, v51 from company_name as cn, aggView8743751451986258499 where cn.id=aggView8743751451986258499.v1 and country_code<> '[us]';
create or replace view aggView3617332556646693743 as select v37, v8, MIN(v50) as v50, MIN(v51) as v51, MIN(v2) as v49 from aggJoin4373263996681525961 group by v37,v8;
create or replace view aggJoin7447260772954937831 as select movie_id as v37, info_type_id as v10, info as v27, v8, v50, v51, v49 from movie_info as mi, aggView3617332556646693743 where mi.movie_id=aggView3617332556646693743.v37 and info IN ('Germany','German','USA','American');
create or replace view aggView2055053979842628569 as select id as v10 from info_type as it1 where info= 'countries';
create or replace view aggJoin8818960195434891 as select v37, v27, v8, v50, v51, v49 from aggJoin7447260772954937831 join aggView2055053979842628569 using(v10);
create or replace view aggView1055092750048429097 as select v37, v8, MIN(v50) as v50, MIN(v51) as v51, MIN(v49) as v49 from aggJoin8818960195434891 group by v37,v8;
create or replace view aggJoin5175536054543752923 as select keyword_id as v14, v8, v50, v51, v49 from movie_keyword as mk, aggView1055092750048429097 where mk.movie_id=aggView1055092750048429097.v37;
create or replace view aggView6804471500470072910 as select v14, v8, MIN(v50) as v50, MIN(v51) as v51, MIN(v49) as v49 from aggJoin5175536054543752923 group by v14,v8;
create or replace view aggJoin3888557682805837716 as select keyword as v15, v8, v50, v51, v49 from keyword as k, aggView6804471500470072910 where k.id=aggView6804471500470072910.v14 and keyword IN ('murder','murder-in-title','blood','violence');
create or replace view aggView7545047003095187130 as select v8, MIN(v50) as v50, MIN(v51) as v51, MIN(v49) as v49 from aggJoin3888557682805837716 group by v8;
create or replace view aggJoin8069312043530359188 as select v50, v51, v49 from company_type as ct, aggView7545047003095187130 where ct.id=aggView7545047003095187130.v8;
select MIN(v49) as v49,MIN(v50) as v50,MIN(v51) as v51 from aggJoin8069312043530359188;
