create or replace view semiUp5548102686442876112 as select movie_id as v37, company_id as v1, company_type_id as v8 from movie_companies AS mc where (company_id) in (select (id) from company_name AS cn where country_code<> '[us]') and note NOT LIKE '%(USA)%' and note LIKE '%(200%)%';
create or replace view semiUp6930244869858629470 as select movie_id as v37, info_type_id as v12, info as v32 from movie_info_idx AS mi_idx where (info_type_id) in (select (id) from info_type AS it2 where info= 'rating') and info<'7.0';
create or replace view semiUp4143382757875184485 as select id as v37, title as v38, kind_id as v17 from title AS t where (kind_id) in (select (id) from kind_type AS kt where kind IN ('movie','episode')) and production_year>2009;
create or replace view semiUp4877056977571737852 as select movie_id as v37, info_type_id as v10 from movie_info AS mi where (movie_id) in (select (v37) from semiUp6930244869858629470) and info IN ('Germany','German','USA','American');
create or replace view semiUp8556516541853005415 as select v37, v10 from semiUp4877056977571737852 where (v10) in (select (id) from info_type AS it1 where info= 'countries');
create or replace view semiUp4685241432889105670 as select movie_id as v37, keyword_id as v14 from movie_keyword AS mk where (keyword_id) in (select (id) from keyword AS k where keyword IN ('murder','murder-in-title','blood','violence'));
create or replace view semiUp7963267547323673224 as select v37, v38, v17 from semiUp4143382757875184485 where (v37) in (select (v37) from semiUp8556516541853005415);
create or replace view semiUp4424700205330996889 as select v37, v14 from semiUp4685241432889105670 where (v37) in (select (v37) from semiUp7963267547323673224);
create or replace view semiUp3357849904269907505 as select v37, v1, v8 from semiUp5548102686442876112 where (v37) in (select (v37) from semiUp4424700205330996889);
create or replace view semiUp4308947659350261781 as select id as v8 from company_type AS ct where (id) in (select (v8) from semiUp3357849904269907505);
create or replace view semiDown3920163602295091811 as select v37, v1, v8 from semiUp3357849904269907505 where (v8) in (select (v8) from semiUp4308947659350261781);
create or replace view semiDown6364367431360674631 as select id as v1, name as v2 from company_name AS cn where (id) in (select (v1) from semiDown3920163602295091811) and country_code<> '[us]';
create or replace view semiDown8022882494976270624 as select v37, v14 from semiUp4424700205330996889 where (v37) in (select (v37) from semiDown3920163602295091811);
create or replace view semiDown5026583970171119427 as select id as v14 from keyword AS k where (id) in (select (v14) from semiDown8022882494976270624) and keyword IN ('murder','murder-in-title','blood','violence');
create or replace view semiDown2961323856578365881 as select v37, v38, v17 from semiUp7963267547323673224 where (v37) in (select (v37) from semiDown8022882494976270624);
create or replace view semiDown7767884010657972909 as select v37, v10 from semiUp8556516541853005415 where (v37) in (select (v37) from semiDown2961323856578365881);
create or replace view semiDown8205278228698711728 as select id as v17 from kind_type AS kt where (id) in (select (v17) from semiDown2961323856578365881) and kind IN ('movie','episode');
create or replace view semiDown5463607537113443027 as select id as v10 from info_type AS it1 where (id) in (select (v10) from semiDown7767884010657972909) and info= 'countries';
create or replace view semiDown1148664162838396309 as select v37, v12, v32 from semiUp6930244869858629470 where (v37) in (select (v37) from semiDown7767884010657972909);
create or replace view semiDown1373027506269925333 as select id as v12 from info_type AS it2 where (id) in (select (v12) from semiDown1148664162838396309) and info= 'rating';
create or replace view aggView7456161707688420887 as select v17 from semiDown8205278228698711728;
create or replace view aggJoin7551672137151097439 as select v37, v38 from semiDown2961323856578365881 join aggView7456161707688420887 using(v17);
create or replace view aggView7004387963648519488 as select v1, v2 as v49 from semiDown6364367431360674631;
create or replace view aggJoin4046120463144558575 as select v37, v8, v49 from semiDown3920163602295091811 join aggView7004387963648519488 using(v1);
create or replace view aggView2845442060940411517 as select v12 from semiDown1373027506269925333;
create or replace view aggJoin5189149473619448625 as select v37, v32 from semiDown1148664162838396309 join aggView2845442060940411517 using(v12);
create or replace view aggView3540821099633442170 as select v37, MIN(v32) as v50 from aggJoin5189149473619448625 group by v37;
create or replace view aggJoin4540955187671064809 as select v37, v10, v50 from semiDown7767884010657972909 join aggView3540821099633442170 using(v37);
create or replace view aggView1521439630086082117 as select v14 from semiDown5026583970171119427;
create or replace view aggJoin4911004261778335894 as select v37 from semiDown8022882494976270624 join aggView1521439630086082117 using(v14);
create or replace view aggView7705920182115893372 as select v10 from semiDown5463607537113443027;
create or replace view aggJoin760233105796656117 as select v37, v50 from aggJoin4540955187671064809 join aggView7705920182115893372 using(v10);
create or replace view aggView7333559196406293956 as select v37, MIN(v50) as v50 from aggJoin760233105796656117 group by v37;
create or replace view aggJoin2982733248599963559 as select v37, v38, v50 from aggJoin7551672137151097439 join aggView7333559196406293956 using(v37);
create or replace view aggView4171550115491168431 as select v37, MIN(v50) as v50, MIN(v38) as v51 from aggJoin2982733248599963559 group by v37;
create or replace view aggJoin2274924535541601193 as select v37, v50, v51 from aggJoin4911004261778335894 join aggView4171550115491168431 using(v37);
create or replace view aggView4367588311034658083 as select v37, MIN(v50) as v50, MIN(v51) as v51 from aggJoin2274924535541601193 group by v37;
create or replace view aggJoin1463514870507849211 as select v8, v49 as v49, v50, v51 from aggJoin4046120463144558575 join aggView4367588311034658083 using(v37);
create or replace view aggView8646266348226930533 as select v8, MIN(v49) as v49, MIN(v50) as v50, MIN(v51) as v51 from aggJoin1463514870507849211 group by v8;
create or replace view aggJoin7695312410982795497 as select v49, v50, v51 from semiUp4308947659350261781 join aggView8646266348226930533 using(v8);
select MIN(v49) as v49,MIN(v50) as v50,MIN(v51) as v51 from aggJoin7695312410982795497;
