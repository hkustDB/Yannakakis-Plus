create or replace view aggView134150926133427730 as select id as v8 from company_type as ct;
create or replace view aggJoin5039521044970901608 as select movie_id as v37, company_id as v1, note as v23 from movie_companies as mc, aggView134150926133427730 where mc.company_type_id=aggView134150926133427730.v8 and note NOT LIKE '%(USA)%' and note LIKE '%(200%)%';
create or replace view aggView5928916387452336545 as select id as v12 from info_type as it2 where info= 'rating';
create or replace view aggJoin7142971769187256957 as select movie_id as v37, info as v32 from movie_info_idx as mi_idx, aggView5928916387452336545 where mi_idx.info_type_id=aggView5928916387452336545.v12 and info<'7.0';
create or replace view aggView4028400972087077107 as select id as v17 from kind_type as kt where kind IN ('movie','episode');
create or replace view aggJoin6209459173108879501 as select id as v37, title as v38 from title as t, aggView4028400972087077107 where t.kind_id=aggView4028400972087077107.v17 and production_year>2009;
create or replace view aggView6165603555114922052 as select id as v14 from keyword as k where keyword IN ('murder','murder-in-title','blood','violence');
create or replace view aggJoin4368092060455390588 as select movie_id as v37 from movie_keyword as mk, aggView6165603555114922052 where mk.keyword_id=aggView6165603555114922052.v14;
create or replace view aggView2622207506065516133 as select v37 from aggJoin4368092060455390588 group by v37;
create or replace view aggJoin3577963620197252547 as select v37, v38 from aggJoin6209459173108879501 join aggView2622207506065516133 using(v37);
create or replace view aggView3293611720002388914 as select v37, MIN(v38) as v51 from aggJoin3577963620197252547 group by v37;
create or replace view aggJoin2976259794366637632 as select movie_id as v37, info_type_id as v10, v51 from movie_info as mi, aggView3293611720002388914 where mi.movie_id=aggView3293611720002388914.v37 and info IN ('Germany','German','USA','American');
create or replace view aggView6754656391654349148 as select id as v10 from info_type as it1 where info= 'countries';
create or replace view aggJoin6142916806816198054 as select v37, v51 from aggJoin2976259794366637632 join aggView6754656391654349148 using(v10);
create or replace view aggView6776590126002882159 as select v37, MIN(v51) as v51 from aggJoin6142916806816198054 group by v37;
create or replace view aggJoin3083335738076495672 as select v37, v32, v51 from aggJoin7142971769187256957 join aggView6776590126002882159 using(v37);
create or replace view aggView4917072245920138037 as select v37, MIN(v51) as v51, MIN(v32) as v50 from aggJoin3083335738076495672 group by v37;
create or replace view aggJoin48270286822139901 as select v1, v51, v50 from aggJoin5039521044970901608 join aggView4917072245920138037 using(v37);
create or replace view aggView8868790059321056172 as select v1, MIN(v51) as v51, MIN(v50) as v50 from aggJoin48270286822139901 group by v1;
create or replace view aggJoin6662258433999065295 as select name as v2, v51, v50 from company_name as cn, aggView8868790059321056172 where cn.id=aggView8868790059321056172.v1 and country_code<> '[us]';
create or replace view res as select MIN(v2) as v49, MIN(v50) as v50, MIN(v51) as v51 from aggJoin6662258433999065295;
select sum(v49+v50+v51) from res;