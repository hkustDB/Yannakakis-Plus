create or replace view aggView3199575345061087755 as select id as v1, name as v49 from company_name as cn where country_code<> '[us]';
create or replace view aggJoin4624817555821163287 as select movie_id as v37, company_type_id as v8, note as v23, v49 from movie_companies as mc, aggView3199575345061087755 where mc.company_id=aggView3199575345061087755.v1 and note NOT LIKE '%(USA)%' and note LIKE '%(200%)%';
create or replace view aggView8630755814656514554 as select id as v12 from info_type as it2 where info= 'rating';
create or replace view aggJoin6970628677340891378 as select movie_id as v37, info as v32 from movie_info_idx as mi_idx, aggView8630755814656514554 where mi_idx.info_type_id=aggView8630755814656514554.v12 and info<'7.0';
create or replace view aggView1280434708311634821 as select v37, MIN(v32) as v50 from aggJoin6970628677340891378 group by v37;
create or replace view aggJoin3636533303831007449 as select id as v37, title as v38, kind_id as v17, v50 from title as t, aggView1280434708311634821 where t.id=aggView1280434708311634821.v37 and production_year>2009;
create or replace view aggView1481697685526598812 as select id as v17 from kind_type as kt where kind IN ('movie','episode');
create or replace view aggJoin8779254767209356998 as select v37, v38, v50 from aggJoin3636533303831007449 join aggView1481697685526598812 using(v17);
create or replace view aggView9085470567612447050 as select v37, MIN(v50) as v50, MIN(v38) as v51 from aggJoin8779254767209356998 group by v37;
create or replace view aggJoin3677040051053265534 as select movie_id as v37, keyword_id as v14, v50, v51 from movie_keyword as mk, aggView9085470567612447050 where mk.movie_id=aggView9085470567612447050.v37;
create or replace view aggView8534473411958558661 as select id as v14 from keyword as k where keyword IN ('murder','murder-in-title','blood','violence');
create or replace view aggJoin72889816064729590 as select v37, v50, v51 from aggJoin3677040051053265534 join aggView8534473411958558661 using(v14);
create or replace view aggView1952547486784473736 as select v37, MIN(v50) as v50, MIN(v51) as v51 from aggJoin72889816064729590 group by v37;
create or replace view aggJoin2383663154334904971 as select movie_id as v37, info_type_id as v10, v50, v51 from movie_info as mi, aggView1952547486784473736 where mi.movie_id=aggView1952547486784473736.v37 and info IN ('Germany','German','USA','American');
create or replace view aggView7748352709672515951 as select id as v10 from info_type as it1 where info= 'countries';
create or replace view aggJoin6577678646175944301 as select v37, v50, v51 from aggJoin2383663154334904971 join aggView7748352709672515951 using(v10);
create or replace view aggView5098937697577963240 as select v37, MIN(v50) as v50, MIN(v51) as v51 from aggJoin6577678646175944301 group by v37;
create or replace view aggJoin6845180491967329089 as select v8, v49 as v49, v50, v51 from aggJoin4624817555821163287 join aggView5098937697577963240 using(v37);
create or replace view aggView1607306459715933738 as select v8, MIN(v49) as v49, MIN(v50) as v50, MIN(v51) as v51 from aggJoin6845180491967329089 group by v8;
create or replace view aggJoin3020660911035849430 as select v49, v50, v51 from company_type as ct, aggView1607306459715933738 where ct.id=aggView1607306459715933738.v8;
create or replace view res as select MIN(v49) as v49, MIN(v50) as v50, MIN(v51) as v51 from aggJoin3020660911035849430;
select sum(v49+v50+v51) from res;