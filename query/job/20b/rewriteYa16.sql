create or replace view semiUp6030087347993449207 as select movie_id as v40, keyword_id as v23 from movie_keyword AS mk where (keyword_id) in (select (id) from keyword AS k where keyword IN ('superhero','sequel','second-part','marvel-comics','based-on-comic','tv-special','fight','violence'));
create or replace view semiUp8179429368494434562 as select movie_id as v40, subject_id as v5, status_id as v7 from complete_cast AS cc where (subject_id) in (select (id) from comp_cast_type AS cct1 where kind= 'cast');
create or replace view semiUp2188584898374423912 as select id as v40, title as v41, kind_id as v26 from title AS t where (kind_id) in (select (id) from kind_type AS kt where kind= 'movie') and production_year>2000;
create or replace view semiUp4087082713586627949 as select person_id as v31, movie_id as v40, person_role_id as v9 from cast_info AS ci where (person_id) in (select (id) from name AS n where name LIKE '%Downey%Robert%');
create or replace view semiUp2744156567769639902 as select v40, v5, v7 from semiUp8179429368494434562 where (v40) in (select (v40) from semiUp2188584898374423912);
create or replace view semiUp8762199092324654909 as select v40, v5, v7 from semiUp2744156567769639902 where (v7) in (select (id) from comp_cast_type AS cct2 where kind LIKE '%complete%');
create or replace view semiUp367772699706445310 as select v40, v23 from semiUp6030087347993449207 where (v40) in (select (v40) from semiUp8762199092324654909);
create or replace view semiUp6864416113220326646 as select v31, v40, v9 from semiUp4087082713586627949 where (v40) in (select (v40) from semiUp367772699706445310);
create or replace view semiUp3042121779014914253 as select id as v9 from char_name AS chn where (id) in (select (v9) from semiUp6864416113220326646) and ((name LIKE '%Tony%Stark%') OR (name LIKE '%Iron%Man%')) and name NOT LIKE '%Sherlock%';
create or replace view semiDown8065550611393755606 as select v31, v40, v9 from semiUp6864416113220326646 where (v9) in (select (v9) from semiUp3042121779014914253);
create or replace view semiDown7863975738833676328 as select id as v31 from name AS n where (id) in (select (v31) from semiDown8065550611393755606) and name LIKE '%Downey%Robert%';
create or replace view semiDown6476925850888733289 as select v40, v23 from semiUp367772699706445310 where (v40) in (select (v40) from semiDown8065550611393755606);
create or replace view semiDown952221475685242651 as select id as v23 from keyword AS k where (id) in (select (v23) from semiDown6476925850888733289) and keyword IN ('superhero','sequel','second-part','marvel-comics','based-on-comic','tv-special','fight','violence');
create or replace view semiDown7781883824548720753 as select v40, v5, v7 from semiUp8762199092324654909 where (v40) in (select (v40) from semiDown6476925850888733289);
create or replace view semiDown3847999961529212623 as select id as v5 from comp_cast_type AS cct1 where (id) in (select (v5) from semiDown7781883824548720753) and kind= 'cast';
create or replace view semiDown5667598190262461819 as select v40, v41, v26 from semiUp2188584898374423912 where (v40) in (select (v40) from semiDown7781883824548720753);
create or replace view semiDown1700340210875710746 as select id as v7 from comp_cast_type AS cct2 where (id) in (select (v7) from semiDown7781883824548720753) and kind LIKE '%complete%';
create or replace view semiDown7938425544229930657 as select id as v26 from kind_type AS kt where (id) in (select (v26) from semiDown5667598190262461819) and kind= 'movie';
create or replace view aggView7206946744570011745 as select v31 from semiDown7863975738833676328;
create or replace view aggJoin2950943186433744353 as select v40, v9 from semiDown8065550611393755606 join aggView7206946744570011745 using(v31);
create or replace view aggView5989162618401780328 as select v26 from semiDown7938425544229930657;
create or replace view aggJoin2784796880687491557 as select v40, v41 from semiDown5667598190262461819 join aggView5989162618401780328 using(v26);
create or replace view aggView848918600118353730 as select v40, MIN(v41) as v52 from aggJoin2784796880687491557 group by v40;
create or replace view aggJoin6444748269235957167 as select v40, v5, v7, v52 from semiDown7781883824548720753 join aggView848918600118353730 using(v40);
create or replace view aggView3594168467684956378 as select v5 from semiDown3847999961529212623;
create or replace view aggJoin6790387903474765836 as select v40, v7, v52 from aggJoin6444748269235957167 join aggView3594168467684956378 using(v5);
create or replace view aggView4523900944055555382 as select v23 from semiDown952221475685242651;
create or replace view aggJoin6852303664410962884 as select v40 from semiDown6476925850888733289 join aggView4523900944055555382 using(v23);
create or replace view aggView2387849870935394946 as select v7 from semiDown1700340210875710746;
create or replace view aggJoin31147788083676951 as select v40, v52 from aggJoin6790387903474765836 join aggView2387849870935394946 using(v7);
create or replace view aggView7242722109092427233 as select v40, MIN(v52) as v52 from aggJoin31147788083676951 group by v40;
create or replace view aggJoin4040273145324982331 as select v40, v52 from aggJoin6852303664410962884 join aggView7242722109092427233 using(v40);
create or replace view aggView7359315600979740140 as select v40, MIN(v52) as v52 from aggJoin4040273145324982331 group by v40;
create or replace view aggJoin4044699000052199715 as select v9, v52 from aggJoin2950943186433744353 join aggView7359315600979740140 using(v40);
create or replace view aggView2116582257981498099 as select v9, MIN(v52) as v52 from aggJoin4044699000052199715 group by v9;
create or replace view aggJoin1720809844925953132 as select v52 from semiUp3042121779014914253 join aggView2116582257981498099 using(v9);
select MIN(v52) as v52 from aggJoin1720809844925953132;
