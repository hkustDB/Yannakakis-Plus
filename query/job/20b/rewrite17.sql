create or replace view aggView730125706005206101 as select id as v5 from comp_cast_type as cct1 where kind= 'cast';
create or replace view aggJoin6127587110572773411 as select movie_id as v40, status_id as v7 from complete_cast as cc, aggView730125706005206101 where cc.subject_id=aggView730125706005206101.v5;
create or replace view aggView3655769404102005846 as select id as v31 from name as n where name LIKE '%Downey%Robert%';
create or replace view aggJoin7678069016629761054 as select movie_id as v40, person_role_id as v9 from cast_info as ci, aggView3655769404102005846 where ci.person_id=aggView3655769404102005846.v31;
create or replace view aggView6323282854967612941 as select id as v7 from comp_cast_type as cct2 where kind LIKE '%complete%';
create or replace view aggJoin5315851173148825561 as select v40 from aggJoin6127587110572773411 join aggView6323282854967612941 using(v7);
create or replace view aggView1319575116611262987 as select id as v9 from char_name as chn where ((name LIKE '%Tony%Stark%') OR (name LIKE '%Iron%Man%')) and name NOT LIKE '%Sherlock%';
create or replace view aggJoin4515569861151022061 as select v40 from aggJoin7678069016629761054 join aggView1319575116611262987 using(v9);
create or replace view aggView3919236925677011836 as select id as v26 from kind_type as kt where kind= 'movie';
create or replace view aggJoin1673960023020193449 as select id as v40, title as v41 from title as t, aggView3919236925677011836 where t.kind_id=aggView3919236925677011836.v26 and production_year>2000;
create or replace view aggView7401794348036691748 as select v40, MIN(v41) as v52 from aggJoin1673960023020193449 group by v40;
create or replace view aggJoin818962672230015367 as select v40, v52 from aggJoin4515569861151022061 join aggView7401794348036691748 using(v40);
create or replace view aggView8844325815301040322 as select v40, MIN(v52) as v52 from aggJoin818962672230015367 group by v40;
create or replace view aggJoin4978129953156062335 as select v40, v52 from aggJoin5315851173148825561 join aggView8844325815301040322 using(v40);
create or replace view aggView2763373308712760068 as select v40, MIN(v52) as v52 from aggJoin4978129953156062335 group by v40;
create or replace view aggJoin7192712915646048152 as select keyword_id as v23, v52 from movie_keyword as mk, aggView2763373308712760068 where mk.movie_id=aggView2763373308712760068.v40;
create or replace view aggView210362122571734584 as select v23, MIN(v52) as v52 from aggJoin7192712915646048152 group by v23;
create or replace view aggJoin5104037832918201883 as select v52 from keyword as k, aggView210362122571734584 where k.id=aggView210362122571734584.v23 and keyword IN ('superhero','sequel','second-part','marvel-comics','based-on-comic','tv-special','fight','violence');
create or replace view res as select MIN(v52) as v52 from aggJoin5104037832918201883;
select sum(v52) from res;