create or replace view aggView8734938707635396163 as select id as v5 from comp_cast_type as cct1 where kind= 'cast';
create or replace view aggJoin3401990391266773981 as select movie_id as v40, status_id as v7 from complete_cast as cc, aggView8734938707635396163 where cc.subject_id=aggView8734938707635396163.v5;
create or replace view aggView6083267420863905887 as select id as v31 from name as n where name LIKE '%Downey%Robert%';
create or replace view aggJoin344153976228957939 as select movie_id as v40, person_role_id as v9 from cast_info as ci, aggView6083267420863905887 where ci.person_id=aggView6083267420863905887.v31;
create or replace view aggView2145877088757153246 as select id as v7 from comp_cast_type as cct2 where kind LIKE '%complete%';
create or replace view aggJoin4004497683995578275 as select v40 from aggJoin3401990391266773981 join aggView2145877088757153246 using(v7);
create or replace view aggView7036607250745344419 as select id as v9 from char_name as chn where ((name LIKE '%Tony%Stark%') OR (name LIKE '%Iron%Man%')) and name NOT LIKE '%Sherlock%';
create or replace view aggJoin6972385452703646949 as select v40 from aggJoin344153976228957939 join aggView7036607250745344419 using(v9);
create or replace view aggView8006188350703426845 as select v40 from aggJoin6972385452703646949 group by v40;
create or replace view aggJoin9030112418675197408 as select id as v40, title as v41, kind_id as v26 from title as t, aggView8006188350703426845 where t.id=aggView8006188350703426845.v40 and production_year>2000;
create or replace view aggView6405766045154417346 as select id as v26 from kind_type as kt where kind= 'movie';
create or replace view aggJoin4141374729474068890 as select v40, v41 from aggJoin9030112418675197408 join aggView6405766045154417346 using(v26);
create or replace view aggView5525473764557280986 as select v40, MIN(v41) as v52 from aggJoin4141374729474068890 group by v40;
create or replace view aggJoin9090176134002066093 as select v40, v52 from aggJoin4004497683995578275 join aggView5525473764557280986 using(v40);
create or replace view aggView57538140202582329 as select v40, MIN(v52) as v52 from aggJoin9090176134002066093 group by v40;
create or replace view aggJoin1545592948450397069 as select keyword_id as v23, v52 from movie_keyword as mk, aggView57538140202582329 where mk.movie_id=aggView57538140202582329.v40;
create or replace view aggView8879176609659547529 as select v23, MIN(v52) as v52 from aggJoin1545592948450397069 group by v23;
create or replace view aggJoin2588166893548635124 as select v52 from keyword as k, aggView8879176609659547529 where k.id=aggView8879176609659547529.v23 and keyword IN ('superhero','sequel','second-part','marvel-comics','based-on-comic','tv-special','fight','violence');
create or replace view res as select MIN(v52) as v52 from aggJoin2588166893548635124;
select sum(v52) from res;