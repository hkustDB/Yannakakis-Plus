create or replace view semiUp1815677174635442121 as select person_id as v31, movie_id as v40, person_role_id as v9 from cast_info AS ci where (person_role_id) in (select id from char_name AS chn where ((name LIKE '%Tony%Stark%') OR (name LIKE '%Iron%Man%')) and name NOT LIKE '%Sherlock%');
create or replace view semiUp8563659849897243946 as select movie_id as v40, subject_id as v5, status_id as v7 from complete_cast AS cc where (status_id) in (select id from comp_cast_type AS cct2 where kind LIKE '%complete%');
create or replace view semiUp4472724769672302956 as select id as v40, title as v41, kind_id as v26 from title AS t where (kind_id) in (select id from kind_type AS kt where kind= 'movie') and production_year>2000;
create or replace view semiUp154558115126211528 as select v40, v5, v7 from semiUp8563659849897243946 where (v5) in (select id from comp_cast_type AS cct1 where kind= 'cast');
create or replace view semiUp1571318208677677262 as select v31, v40, v9 from semiUp1815677174635442121 where (v31) in (select id from name AS n where name LIKE '%Downey%Robert%');
create or replace view semiUp1047101732562557315 as select v31, v40, v9 from semiUp1571318208677677262 where (v40) in (select v40 from semiUp154558115126211528);
create or replace view semiUp1027430460566304250 as select v40, v41, v26 from semiUp4472724769672302956 where (v40) in (select v40 from semiUp1047101732562557315);
create or replace view semiUp7026754709257185031 as select movie_id as v40, keyword_id as v23 from movie_keyword AS mk where (movie_id) in (select v40 from semiUp1027430460566304250);
create or replace view semiUp7612172806038456234 as select id as v23 from keyword AS k where (id) in (select v23 from semiUp7026754709257185031) and keyword IN ('superhero','sequel','second-part','marvel-comics','based-on-comic','tv-special','fight','violence');
create or replace view semiDown1513320104666564504 as select v40, v23 from semiUp7026754709257185031 where (v23) in (select v23 from semiUp7612172806038456234);
create or replace view semiDown6108825998538823706 as select v40, v41, v26 from semiUp1027430460566304250 where (v40) in (select v40 from semiDown1513320104666564504);
create or replace view semiDown4421075627014051436 as select v31, v40, v9 from semiUp1047101732562557315 where (v40) in (select v40 from semiDown6108825998538823706);
create or replace view semiDown7106457028863580458 as select id as v26 from kind_type AS kt where (id) in (select v26 from semiDown6108825998538823706) and kind= 'movie';
create or replace view semiDown7473555180207618843 as select v40, v5, v7 from semiUp154558115126211528 where (v40) in (select v40 from semiDown4421075627014051436);
create or replace view semiDown5523187671264073999 as select id as v9 from char_name AS chn where (id) in (select v9 from semiDown4421075627014051436) and ((name LIKE '%Tony%Stark%') OR (name LIKE '%Iron%Man%')) and name NOT LIKE '%Sherlock%';
create or replace view semiDown3446967935479805029 as select id as v31 from name AS n where (id) in (select v31 from semiDown4421075627014051436) and name LIKE '%Downey%Robert%';
create or replace view semiDown1436765939467561709 as select id as v5 from comp_cast_type AS cct1 where (id) in (select v5 from semiDown7473555180207618843) and kind= 'cast';
create or replace view semiDown821277034990367520 as select id as v7 from comp_cast_type AS cct2 where (id) in (select v7 from semiDown7473555180207618843) and kind LIKE '%complete%';
create or replace view aggView2933473629495910893 as select v26 from semiDown7106457028863580458;
create or replace view aggJoin3407769313310190844 as select v40, v41 from semiDown6108825998538823706 join aggView2933473629495910893 using(v26);
create or replace view aggView3916879925949332296 as select v9 from semiDown5523187671264073999;
create or replace view aggJoin1898483638274105651 as select v31, v40 from semiDown4421075627014051436 join aggView3916879925949332296 using(v9);
create or replace view aggView880113147008291282 as select v5 from semiDown1436765939467561709;
create or replace view aggJoin727821042990697548 as select v40, v7 from semiDown7473555180207618843 join aggView880113147008291282 using(v5);
create or replace view aggView2822812682111545483 as select v7 from semiDown821277034990367520;
create or replace view aggJoin1311605104973332454 as select v40 from aggJoin727821042990697548 join aggView2822812682111545483 using(v7);
create or replace view aggView8525612566899245980 as select v31 from semiDown3446967935479805029;
create or replace view aggJoin6836680412279864531 as select v40 from aggJoin1898483638274105651 join aggView8525612566899245980 using(v31);
create or replace view aggView2899840123404602275 as select v40 from aggJoin1311605104973332454 group by v40;
create or replace view aggJoin8559866242922026908 as select v40 from aggJoin6836680412279864531 join aggView2899840123404602275 using(v40);
create or replace view aggView4427219507121030233 as select v40 from aggJoin8559866242922026908 group by v40;
create or replace view aggJoin710831002048776798 as select v40, v41 from aggJoin3407769313310190844 join aggView4427219507121030233 using(v40);
create or replace view aggView1390318838988342486 as select v40, MIN(v41) as v52 from aggJoin710831002048776798 group by v40;
create or replace view aggJoin4710077460817231908 as select v23, v52 from semiDown1513320104666564504 join aggView1390318838988342486 using(v40);
create or replace view aggView6956665842109923189 as select v23, MIN(v52) as v52 from aggJoin4710077460817231908 group by v23;
create or replace view aggJoin7022823124299557407 as select v52 from semiUp7612172806038456234 join aggView6956665842109923189 using(v23);
create or replace view res as select MIN(v52) as v52 from aggJoin7022823124299557407;
select sum(v52) from res;
