create or replace view aggView985365637144620044 as select id as v5 from comp_cast_type as cct1 where kind= 'cast';
create or replace view aggJoin3915808257296999276 as select movie_id as v40, status_id as v7 from complete_cast as cc, aggView985365637144620044 where cc.subject_id=aggView985365637144620044.v5;
create or replace view aggView7869658609314000812 as select id as v31 from name as n where name LIKE '%Downey%Robert%';
create or replace view aggJoin3418618618580692108 as select movie_id as v40, person_role_id as v9 from cast_info as ci, aggView7869658609314000812 where ci.person_id=aggView7869658609314000812.v31;
create or replace view aggView538370174275169418 as select id as v23 from keyword as k where keyword IN ('superhero','sequel','second-part','marvel-comics','based-on-comic','tv-special','fight','violence');
create or replace view aggJoin3603486157775478479 as select movie_id as v40 from movie_keyword as mk, aggView538370174275169418 where mk.keyword_id=aggView538370174275169418.v23;
create or replace view aggView2426303826136044682 as select v40 from aggJoin3603486157775478479 group by v40;
create or replace view aggJoin906931793668478815 as select v40, v9 from aggJoin3418618618580692108 join aggView2426303826136044682 using(v40);
create or replace view aggView3566914130702274308 as select id as v7 from comp_cast_type as cct2 where kind LIKE '%complete%';
create or replace view aggJoin7696886100851336338 as select v40 from aggJoin3915808257296999276 join aggView3566914130702274308 using(v7);
create or replace view aggView606268848909465493 as select v40 from aggJoin7696886100851336338 group by v40;
create or replace view aggJoin3217863683522396077 as select v40, v9 from aggJoin906931793668478815 join aggView606268848909465493 using(v40);
create or replace view aggView8887045227666364938 as select id as v9 from char_name as chn where ((name LIKE '%Tony%Stark%') OR (name LIKE '%Iron%Man%')) and name NOT LIKE '%Sherlock%';
create or replace view aggJoin7633280165781509260 as select v40 from aggJoin3217863683522396077 join aggView8887045227666364938 using(v9);
create or replace view aggView1274347349790614763 as select v40 from aggJoin7633280165781509260 group by v40;
create or replace view aggJoin4089189924651663130 as select title as v41, kind_id as v26 from title as t, aggView1274347349790614763 where t.id=aggView1274347349790614763.v40 and production_year>2000;
create or replace view aggView580156372361202414 as select id as v26 from kind_type as kt where kind= 'movie';
create or replace view aggJoin3544003418410415015 as select v41 from aggJoin4089189924651663130 join aggView580156372361202414 using(v26);
create or replace view res as select MIN(v41) as v52 from aggJoin3544003418410415015;
select sum(v52) from res;