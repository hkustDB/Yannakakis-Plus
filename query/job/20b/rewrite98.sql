create or replace view aggView1057689645960644742 as select id as v31 from name as n where name LIKE '%Downey%Robert%';
create or replace view aggJoin538136121191996546 as select movie_id as v40, person_role_id as v9 from cast_info as ci, aggView1057689645960644742 where ci.person_id=aggView1057689645960644742.v31;
create or replace view aggView6080878354271394773 as select id as v23 from keyword as k where keyword IN ('superhero','sequel','second-part','marvel-comics','based-on-comic','tv-special','fight','violence');
create or replace view aggJoin4420341181986432323 as select movie_id as v40 from movie_keyword as mk, aggView6080878354271394773 where mk.keyword_id=aggView6080878354271394773.v23;
create or replace view aggView1205982158115905947 as select v40 from aggJoin4420341181986432323 group by v40;
create or replace view aggJoin4089550832159309031 as select v40, v9 from aggJoin538136121191996546 join aggView1205982158115905947 using(v40);
create or replace view aggView5682216348659588144 as select id as v7 from comp_cast_type as cct2 where kind LIKE '%complete%';
create or replace view aggJoin6088638994606911809 as select movie_id as v40, subject_id as v5 from complete_cast as cc, aggView5682216348659588144 where cc.status_id=aggView5682216348659588144.v7;
create or replace view aggView584640250284047662 as select id as v9 from char_name as chn where ((name LIKE '%Tony%Stark%') OR (name LIKE '%Iron%Man%')) and name NOT LIKE '%Sherlock%';
create or replace view aggJoin1913048705568372785 as select v40 from aggJoin4089550832159309031 join aggView584640250284047662 using(v9);
create or replace view aggView83302974743544958 as select v40 from aggJoin1913048705568372785 group by v40;
create or replace view aggJoin3389133331929648703 as select id as v40, title as v41, kind_id as v26 from title as t, aggView83302974743544958 where t.id=aggView83302974743544958.v40 and production_year>2000;
create or replace view aggView9001661980414826794 as select id as v26 from kind_type as kt where kind= 'movie';
create or replace view aggJoin5044361186920054323 as select v40, v41 from aggJoin3389133331929648703 join aggView9001661980414826794 using(v26);
create or replace view aggView1989839550726883853 as select v40, MIN(v41) as v52 from aggJoin5044361186920054323 group by v40;
create or replace view aggJoin9027825238383063945 as select v5, v52 from aggJoin6088638994606911809 join aggView1989839550726883853 using(v40);
create or replace view aggView2677827975183180068 as select v5, MIN(v52) as v52 from aggJoin9027825238383063945 group by v5;
create or replace view aggJoin5867603518516117252 as select v52 from comp_cast_type as cct1, aggView2677827975183180068 where cct1.id=aggView2677827975183180068.v5 and kind= 'cast';
create or replace view res as select MIN(v52) as v52 from aggJoin5867603518516117252;
select sum(v52) from res;