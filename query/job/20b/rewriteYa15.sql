create or replace view semiUp85031410499319516 as select person_id as v31, movie_id as v40, person_role_id as v9 from cast_info AS ci where (person_id) in (select (id) from name AS n where name LIKE '%Downey%Robert%');
create or replace view semiUp3702104410350895164 as select movie_id as v40, keyword_id as v23 from movie_keyword AS mk where (keyword_id) in (select (id) from keyword AS k where keyword IN ('superhero','sequel','second-part','marvel-comics','based-on-comic','tv-special','fight','violence'));
create or replace view semiUp2953462254127345523 as select v31, v40, v9 from semiUp85031410499319516 where (v9) in (select (id) from char_name AS chn where ((name LIKE '%Tony%Stark%') OR (name LIKE '%Iron%Man%')) and name NOT LIKE '%Sherlock%');
create or replace view semiUp5089975252793047600 as select v40, v23 from semiUp3702104410350895164 where (v40) in (select (v40) from semiUp2953462254127345523);
create or replace view semiUp5756739979483785286 as select id as v40, title as v41, kind_id as v26 from title AS t where (kind_id) in (select (id) from kind_type AS kt where kind= 'movie') and production_year>2000;
create or replace view semiUp6003430106679967305 as select v40, v23 from semiUp5089975252793047600 where (v40) in (select (v40) from semiUp5756739979483785286);
create or replace view semiUp1109678072461977018 as select movie_id as v40, subject_id as v5, status_id as v7 from complete_cast AS cc where (status_id) in (select (id) from comp_cast_type AS cct2 where kind LIKE '%complete%');
create or replace view semiUp8931592143800855272 as select v40, v5, v7 from semiUp1109678072461977018 where (v40) in (select (v40) from semiUp6003430106679967305);
create or replace view semiUp5597202517289221514 as select id as v5 from comp_cast_type AS cct1 where (id) in (select (v5) from semiUp8931592143800855272) and kind= 'cast';
create or replace view semiDown4687398482644932548 as select v40, v5, v7 from semiUp8931592143800855272 where (v5) in (select (v5) from semiUp5597202517289221514);
create or replace view semiDown2675973099088629605 as select id as v7 from comp_cast_type AS cct2 where (id) in (select (v7) from semiDown4687398482644932548) and kind LIKE '%complete%';
create or replace view semiDown6649235617090537781 as select v40, v23 from semiUp6003430106679967305 where (v40) in (select (v40) from semiDown4687398482644932548);
create or replace view semiDown7978959258673578505 as select v40, v41, v26 from semiUp5756739979483785286 where (v40) in (select (v40) from semiDown6649235617090537781);
create or replace view semiDown2480700743808345902 as select id as v23 from keyword AS k where (id) in (select (v23) from semiDown6649235617090537781) and keyword IN ('superhero','sequel','second-part','marvel-comics','based-on-comic','tv-special','fight','violence');
create or replace view semiDown7419377331672041680 as select v31, v40, v9 from semiUp2953462254127345523 where (v40) in (select (v40) from semiDown6649235617090537781);
create or replace view semiDown1823534417289157466 as select id as v26 from kind_type AS kt where (id) in (select (v26) from semiDown7978959258673578505) and kind= 'movie';
create or replace view semiDown1027254621105296025 as select id as v31 from name AS n where (id) in (select (v31) from semiDown7419377331672041680) and name LIKE '%Downey%Robert%';
create or replace view semiDown250527719011809900 as select id as v9 from char_name AS chn where (id) in (select (v9) from semiDown7419377331672041680) and ((name LIKE '%Tony%Stark%') OR (name LIKE '%Iron%Man%')) and name NOT LIKE '%Sherlock%';
create or replace view aggView919363511477614397 as select v26 from semiDown1823534417289157466;
create or replace view aggJoin5246862859503085057 as select v40, v41 from semiDown7978959258673578505 join aggView919363511477614397 using(v26);
create or replace view aggView5713620864620114457 as select v9 from semiDown250527719011809900;
create or replace view aggJoin7700226422834231268 as select v31, v40 from semiDown7419377331672041680 join aggView5713620864620114457 using(v9);
create or replace view aggView1030057230011814606 as select v40, MIN(v41) as v52 from aggJoin5246862859503085057 group by v40;
create or replace view aggJoin6619046065098601154 as select v40, v23, v52 from semiDown6649235617090537781 join aggView1030057230011814606 using(v40);
create or replace view aggView7417092859873684129 as select v31 from semiDown1027254621105296025;
create or replace view aggJoin5036086026845634062 as select v40 from aggJoin7700226422834231268 join aggView7417092859873684129 using(v31);
create or replace view aggView7313636811751288808 as select v23 from semiDown2480700743808345902;
create or replace view aggJoin7395388198588981381 as select v40, v52 from aggJoin6619046065098601154 join aggView7313636811751288808 using(v23);
create or replace view aggView3778675770543554462 as select v7 from semiDown2675973099088629605;
create or replace view aggJoin6535137857484331112 as select v40, v5 from semiDown4687398482644932548 join aggView3778675770543554462 using(v7);
create or replace view aggView4497915761025510652 as select v40 from aggJoin5036086026845634062 group by v40;
create or replace view aggJoin1798392927500909433 as select v40, v52 as v52 from aggJoin7395388198588981381 join aggView4497915761025510652 using(v40);
create or replace view aggView5312403546315166438 as select v40, MIN(v52) as v52 from aggJoin1798392927500909433 group by v40;
create or replace view aggJoin7461842836718693717 as select v5, v52 from aggJoin6535137857484331112 join aggView5312403546315166438 using(v40);
create or replace view aggView7275987430802199969 as select v5, MIN(v52) as v52 from aggJoin7461842836718693717 group by v5;
create or replace view aggJoin5714726106623322100 as select v52 from semiUp5597202517289221514 join aggView7275987430802199969 using(v5);
select MIN(v52) as v52 from aggJoin5714726106623322100;
