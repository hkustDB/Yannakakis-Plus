create or replace view semiUp6559595855953864239 as select person_id as v31, movie_id as v40, person_role_id as v9 from cast_info AS ci where (person_role_id) in (select id from char_name AS chn where ((name LIKE '%Tony%Stark%') OR (name LIKE '%Iron%Man%')) and name NOT LIKE '%Sherlock%');
create or replace view semiUp3250397408166362094 as select movie_id as v40, keyword_id as v23 from movie_keyword AS mk where (keyword_id) in (select id from keyword AS k where keyword IN ('superhero','sequel','second-part','marvel-comics','based-on-comic','tv-special','fight','violence'));
create or replace view semiUp930771278835944962 as select id as v40, title as v41, kind_id as v26 from title AS t where (kind_id) in (select id from kind_type AS kt where kind= 'movie') and production_year>2000;
create or replace view semiUp5018612007288681500 as select movie_id as v40, subject_id as v5, status_id as v7 from complete_cast AS cc where (subject_id) in (select id from comp_cast_type AS cct1 where kind= 'cast');
create or replace view semiUp3867009112360550377 as select v31, v40, v9 from semiUp6559595855953864239 where (v31) in (select id from name AS n where name LIKE '%Downey%Robert%');
create or replace view semiUp505122618310905147 as select v40, v23 from semiUp3250397408166362094 where (v40) in (select v40 from semiUp3867009112360550377);
create or replace view semiUp3595549079152822119 as select v40, v41, v26 from semiUp930771278835944962 where (v40) in (select v40 from semiUp505122618310905147);
create or replace view semiUp6373094757955314096 as select v40, v5, v7 from semiUp5018612007288681500 where (v40) in (select v40 from semiUp3595549079152822119);
create or replace view semiUp3951973890353793428 as select id as v7 from comp_cast_type AS cct2 where (id) in (select v7 from semiUp6373094757955314096) and kind LIKE '%complete%';
create or replace view semiDown8456144795590316188 as select v40, v5, v7 from semiUp6373094757955314096 where (v7) in (select v7 from semiUp3951973890353793428);
create or replace view semiDown6417001437287725297 as select v40, v41, v26 from semiUp3595549079152822119 where (v40) in (select v40 from semiDown8456144795590316188);
create or replace view semiDown9038357550714016375 as select id as v5 from comp_cast_type AS cct1 where (id) in (select v5 from semiDown8456144795590316188) and kind= 'cast';
create or replace view semiDown3508049074073260336 as select v40, v23 from semiUp505122618310905147 where (v40) in (select v40 from semiDown6417001437287725297);
create or replace view semiDown1906731337683948192 as select id as v26 from kind_type AS kt where (id) in (select v26 from semiDown6417001437287725297) and kind= 'movie';
create or replace view semiDown1782558990100851908 as select id as v23 from keyword AS k where (id) in (select v23 from semiDown3508049074073260336) and keyword IN ('superhero','sequel','second-part','marvel-comics','based-on-comic','tv-special','fight','violence');
create or replace view semiDown7998131478819606438 as select v31, v40, v9 from semiUp3867009112360550377 where (v40) in (select v40 from semiDown3508049074073260336);
create or replace view semiDown5493915538382035272 as select id as v9 from char_name AS chn where (id) in (select v9 from semiDown7998131478819606438) and ((name LIKE '%Tony%Stark%') OR (name LIKE '%Iron%Man%')) and name NOT LIKE '%Sherlock%';
create or replace view semiDown4311114579581453973 as select id as v31 from name AS n where (id) in (select v31 from semiDown7998131478819606438) and name LIKE '%Downey%Robert%';
create or replace view aggView4686055382251275100 as select v5 from semiDown9038357550714016375;
create or replace view aggJoin8536281856135406947 as select v40, v7 from semiDown8456144795590316188 join aggView4686055382251275100 using(v5);
create or replace view aggView4729339768058739708 as select v26 from semiDown1906731337683948192;
create or replace view aggJoin5427867059120030522 as select v40, v41 from semiDown6417001437287725297 join aggView4729339768058739708 using(v26);
create or replace view aggView5730097409905597443 as select v23 from semiDown1782558990100851908;
create or replace view aggJoin4944022525026952472 as select v40 from semiDown3508049074073260336 join aggView5730097409905597443 using(v23);
create or replace view aggView4307144806363885136 as select v31 from semiDown4311114579581453973;
create or replace view aggJoin5718567836911043385 as select v40, v9 from semiDown7998131478819606438 join aggView4307144806363885136 using(v31);
create or replace view aggView8041097109160165523 as select v9 from semiDown5493915538382035272;
create or replace view aggJoin3309384211448195722 as select v40 from aggJoin5718567836911043385 join aggView8041097109160165523 using(v9);
create or replace view aggView1977233975938471648 as select v40 from aggJoin3309384211448195722 group by v40;
create or replace view aggJoin5258723255914970153 as select v40 from aggJoin4944022525026952472 join aggView1977233975938471648 using(v40);
create or replace view aggView1148763822827517213 as select v40 from aggJoin5258723255914970153 group by v40;
create or replace view aggJoin7829414596844263265 as select v40, v41 from aggJoin5427867059120030522 join aggView1148763822827517213 using(v40);
create or replace view aggView898659114135173983 as select v40, MIN(v41) as v52 from aggJoin7829414596844263265 group by v40;
create or replace view aggJoin8843186667587946644 as select v7, v52 from aggJoin8536281856135406947 join aggView898659114135173983 using(v40);
create or replace view aggView2855496709285159949 as select v7, MIN(v52) as v52 from aggJoin8843186667587946644 group by v7;
create or replace view aggJoin3729809046574742536 as select v52 from semiUp3951973890353793428 join aggView2855496709285159949 using(v7);
create or replace view res as select MIN(v52) as v52 from aggJoin3729809046574742536;
select sum(v52) from res;
