create or replace view semiUp4970870775226880763 as select id as v40, title as v41, kind_id as v26 from title AS t where (kind_id) in (select (id) from kind_type AS kt where kind= 'movie') and production_year>2000;
create or replace view semiUp1331663977698324558 as select movie_id as v40, subject_id as v5, status_id as v7 from complete_cast AS cc where (subject_id) in (select (id) from comp_cast_type AS cct1 where kind= 'cast');
create or replace view semiUp892137486183717944 as select person_id as v31, movie_id as v40, person_role_id as v9 from cast_info AS ci where (person_role_id) in (select (id) from char_name AS chn where ((name LIKE '%Tony%Stark%') OR (name LIKE '%Iron%Man%')) and name NOT LIKE '%Sherlock%');
create or replace view semiUp8589728690447579957 as select v31, v40, v9 from semiUp892137486183717944 where (v31) in (select (id) from name AS n where name LIKE '%Downey%Robert%');
create or replace view semiUp4200436381497393008 as select movie_id as v40, keyword_id as v23 from movie_keyword AS mk where (movie_id) in (select (v40) from semiUp8589728690447579957);
create or replace view semiUp1054219948463850541 as select v40, v23 from semiUp4200436381497393008 where (v23) in (select (id) from keyword AS k where keyword IN ('superhero','sequel','second-part','marvel-comics','based-on-comic','tv-special','fight','violence'));
create or replace view semiUp8507388687170346521 as select v40, v41, v26 from semiUp4970870775226880763 where (v40) in (select (v40) from semiUp1054219948463850541);
create or replace view semiUp6608353993198740970 as select v40, v5, v7 from semiUp1331663977698324558 where (v40) in (select (v40) from semiUp8507388687170346521);
create or replace view semiUp4740866277649160891 as select id as v7 from comp_cast_type AS cct2 where (id) in (select (v7) from semiUp6608353993198740970) and kind LIKE '%complete%';
create or replace view semiDown3386770045684823437 as select v40, v5, v7 from semiUp6608353993198740970 where (v7) in (select (v7) from semiUp4740866277649160891);
create or replace view semiDown3665404444948416964 as select id as v5 from comp_cast_type AS cct1 where (id) in (select (v5) from semiDown3386770045684823437) and kind= 'cast';
create or replace view semiDown2293936547061262411 as select v40, v41, v26 from semiUp8507388687170346521 where (v40) in (select (v40) from semiDown3386770045684823437);
create or replace view semiDown4341232391828997044 as select v40, v23 from semiUp1054219948463850541 where (v40) in (select (v40) from semiDown2293936547061262411);
create or replace view semiDown8736117250207552157 as select id as v26 from kind_type AS kt where (id) in (select (v26) from semiDown2293936547061262411) and kind= 'movie';
create or replace view semiDown8512808809906836995 as select id as v23 from keyword AS k where (id) in (select (v23) from semiDown4341232391828997044) and keyword IN ('superhero','sequel','second-part','marvel-comics','based-on-comic','tv-special','fight','violence');
create or replace view semiDown4593239573154517312 as select v31, v40, v9 from semiUp8589728690447579957 where (v40) in (select (v40) from semiDown4341232391828997044);
create or replace view semiDown7801685218307573544 as select id as v31 from name AS n where (id) in (select (v31) from semiDown4593239573154517312) and name LIKE '%Downey%Robert%';
create or replace view semiDown201816276044993273 as select id as v9 from char_name AS chn where (id) in (select (v9) from semiDown4593239573154517312) and ((name LIKE '%Tony%Stark%') OR (name LIKE '%Iron%Man%')) and name NOT LIKE '%Sherlock%';
create or replace view aggView7682334691851578463 as select v31 from semiDown7801685218307573544;
create or replace view aggJoin4596935366589717718 as select v40, v9 from semiDown4593239573154517312 join aggView7682334691851578463 using(v31);
create or replace view aggView4135757026122230450 as select v26 from semiDown8736117250207552157;
create or replace view aggJoin6259470903938026257 as select v40, v41 from semiDown2293936547061262411 join aggView4135757026122230450 using(v26);
create or replace view aggView7304073755765831123 as select v23 from semiDown8512808809906836995;
create or replace view aggJoin5921270926742492014 as select v40 from semiDown4341232391828997044 join aggView7304073755765831123 using(v23);
create or replace view aggView845839187863574123 as select v9 from semiDown201816276044993273;
create or replace view aggJoin1631280020096675774 as select v40 from aggJoin4596935366589717718 join aggView845839187863574123 using(v9);
create or replace view aggView7946557405253978467 as select v5 from semiDown3665404444948416964;
create or replace view aggJoin3097926253027867431 as select v40, v7 from semiDown3386770045684823437 join aggView7946557405253978467 using(v5);
create or replace view aggView2421157460767900570 as select v40 from aggJoin1631280020096675774 group by v40;
create or replace view aggJoin2898989614103822908 as select v40 from aggJoin5921270926742492014 join aggView2421157460767900570 using(v40);
create or replace view aggView1622897214807197291 as select v40 from aggJoin2898989614103822908 group by v40;
create or replace view aggJoin2149083015571009543 as select v40, v41 from aggJoin6259470903938026257 join aggView1622897214807197291 using(v40);
create or replace view aggView3760331185016646947 as select v40, MIN(v41) as v52 from aggJoin2149083015571009543 group by v40;
create or replace view aggJoin8235018018820354987 as select v7, v52 from aggJoin3097926253027867431 join aggView3760331185016646947 using(v40);
create or replace view aggView8565628018631756264 as select v7, MIN(v52) as v52 from aggJoin8235018018820354987 group by v7;
create or replace view aggJoin465725289297085505 as select v52 from semiUp4740866277649160891 join aggView8565628018631756264 using(v7);
select MIN(v52) as v52 from aggJoin465725289297085505;
