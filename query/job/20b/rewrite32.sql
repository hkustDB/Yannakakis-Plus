create or replace view aggView2401683268824764054 as select id as v5 from comp_cast_type as cct1 where kind= 'cast';
create or replace view aggJoin7435625424765358468 as select movie_id as v40, status_id as v7 from complete_cast as cc, aggView2401683268824764054 where cc.subject_id=aggView2401683268824764054.v5;
create or replace view aggView7733420787439614879 as select id as v31 from name as n where name LIKE '%Downey%Robert%';
create or replace view aggJoin8275127734104476650 as select movie_id as v40, person_role_id as v9 from cast_info as ci, aggView7733420787439614879 where ci.person_id=aggView7733420787439614879.v31;
create or replace view aggView8696521766181114719 as select id as v7 from comp_cast_type as cct2 where kind LIKE '%complete%';
create or replace view aggJoin1877831716658016727 as select v40 from aggJoin7435625424765358468 join aggView8696521766181114719 using(v7);
create or replace view aggView7363494359605177470 as select v40 from aggJoin1877831716658016727 group by v40;
create or replace view aggJoin4115907188219680268 as select v40, v9 from aggJoin8275127734104476650 join aggView7363494359605177470 using(v40);
create or replace view aggView7979228839433463591 as select id as v9 from char_name as chn where ((name LIKE '%Tony%Stark%') OR (name LIKE '%Iron%Man%')) and name NOT LIKE '%Sherlock%';
create or replace view aggJoin5026208873452388436 as select v40 from aggJoin4115907188219680268 join aggView7979228839433463591 using(v9);
create or replace view aggView1988460280729187356 as select v40 from aggJoin5026208873452388436 group by v40;
create or replace view aggJoin1851357938754659633 as select movie_id as v40, keyword_id as v23 from movie_keyword as mk, aggView1988460280729187356 where mk.movie_id=aggView1988460280729187356.v40;
create or replace view aggView6496800764191965755 as select id as v26 from kind_type as kt where kind= 'movie';
create or replace view aggJoin8467294706815738490 as select id as v40, title as v41 from title as t, aggView6496800764191965755 where t.kind_id=aggView6496800764191965755.v26 and production_year>2000;
create or replace view aggView2144232668099603872 as select v40, MIN(v41) as v52 from aggJoin8467294706815738490 group by v40;
create or replace view aggJoin3201204391402244217 as select v23, v52 from aggJoin1851357938754659633 join aggView2144232668099603872 using(v40);
create or replace view aggView3092839333579857046 as select v23, MIN(v52) as v52 from aggJoin3201204391402244217 group by v23;
create or replace view aggJoin29621632825937414 as select v52 from keyword as k, aggView3092839333579857046 where k.id=aggView3092839333579857046.v23 and keyword IN ('superhero','sequel','second-part','marvel-comics','based-on-comic','tv-special','fight','violence');
create or replace view res as select MIN(v52) as v52 from aggJoin29621632825937414;
select sum(v52) from res;