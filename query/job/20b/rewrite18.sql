create or replace view aggView1136361970202722840 as select id as v5 from comp_cast_type as cct1 where kind= 'cast';
create or replace view aggJoin924450646001033430 as select movie_id as v40, status_id as v7 from complete_cast as cc, aggView1136361970202722840 where cc.subject_id=aggView1136361970202722840.v5;
create or replace view aggView4850735571879450944 as select id as v23 from keyword as k where keyword IN ('superhero','sequel','second-part','marvel-comics','based-on-comic','tv-special','fight','violence');
create or replace view aggJoin6773712089116332030 as select movie_id as v40 from movie_keyword as mk, aggView4850735571879450944 where mk.keyword_id=aggView4850735571879450944.v23;
create or replace view aggView442515895106686265 as select v40 from aggJoin6773712089116332030 group by v40;
create or replace view aggJoin7121251181617730711 as select person_id as v31, movie_id as v40, person_role_id as v9 from cast_info as ci, aggView442515895106686265 where ci.movie_id=aggView442515895106686265.v40;
create or replace view aggView1813521346140486942 as select id as v7 from comp_cast_type as cct2 where kind LIKE '%complete%';
create or replace view aggJoin4365833917938231399 as select v40 from aggJoin924450646001033430 join aggView1813521346140486942 using(v7);
create or replace view aggView7765453536013094671 as select id as v9 from char_name as chn where ((name LIKE '%Tony%Stark%') OR (name LIKE '%Iron%Man%')) and name NOT LIKE '%Sherlock%';
create or replace view aggJoin441173340671386499 as select v31, v40 from aggJoin7121251181617730711 join aggView7765453536013094671 using(v9);
create or replace view aggView2576340738654063235 as select id as v26 from kind_type as kt where kind= 'movie';
create or replace view aggJoin7543614926398427403 as select id as v40, title as v41 from title as t, aggView2576340738654063235 where t.kind_id=aggView2576340738654063235.v26 and production_year>2000;
create or replace view aggView8035614307357567495 as select v40, MIN(v41) as v52 from aggJoin7543614926398427403 group by v40;
create or replace view aggJoin4815495818998658813 as select v40, v52 from aggJoin4365833917938231399 join aggView8035614307357567495 using(v40);
create or replace view aggView6344918589977355514 as select v40, MIN(v52) as v52 from aggJoin4815495818998658813 group by v40;
create or replace view aggJoin6669376722030710830 as select v31, v52 from aggJoin441173340671386499 join aggView6344918589977355514 using(v40);
create or replace view aggView8109868878651180942 as select v31, MIN(v52) as v52 from aggJoin6669376722030710830 group by v31;
create or replace view aggJoin6031492807321515206 as select v52 from name as n, aggView8109868878651180942 where n.id=aggView8109868878651180942.v31 and name LIKE '%Downey%Robert%';
create or replace view res as select MIN(v52) as v52 from aggJoin6031492807321515206;
select sum(v52) from res;