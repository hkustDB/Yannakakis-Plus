create or replace view aggView5628711442500841349 as select id as v5 from comp_cast_type as cct1 where kind= 'cast';
create or replace view aggJoin2291173911201956008 as select movie_id as v40, status_id as v7 from complete_cast as cc, aggView5628711442500841349 where cc.subject_id=aggView5628711442500841349.v5;
create or replace view aggView7402647821184861654 as select id as v31 from name as n where name LIKE '%Downey%Robert%';
create or replace view aggJoin2705401247684296731 as select movie_id as v40, person_role_id as v9 from cast_info as ci, aggView7402647821184861654 where ci.person_id=aggView7402647821184861654.v31;
create or replace view aggView7154058852799658432 as select id as v23 from keyword as k where keyword IN ('superhero','sequel','second-part','marvel-comics','based-on-comic','tv-special','fight','violence');
create or replace view aggJoin8078415409514020433 as select movie_id as v40 from movie_keyword as mk, aggView7154058852799658432 where mk.keyword_id=aggView7154058852799658432.v23;
create or replace view aggView6606828754749019930 as select v40 from aggJoin8078415409514020433 group by v40;
create or replace view aggJoin9149089964566539924 as select v40, v9 from aggJoin2705401247684296731 join aggView6606828754749019930 using(v40);
create or replace view aggView1407448875978634879 as select id as v9 from char_name as chn where ((name LIKE '%Tony%Stark%') OR (name LIKE '%Iron%Man%')) and name NOT LIKE '%Sherlock%';
create or replace view aggJoin6398756566013426409 as select v40 from aggJoin9149089964566539924 join aggView1407448875978634879 using(v9);
create or replace view aggView7810989652644189502 as select v40 from aggJoin6398756566013426409 group by v40;
create or replace view aggJoin3545283361495527685 as select id as v40, title as v41, kind_id as v26 from title as t, aggView7810989652644189502 where t.id=aggView7810989652644189502.v40 and production_year>2000;
create or replace view aggView801536033551257492 as select id as v26 from kind_type as kt where kind= 'movie';
create or replace view aggJoin5764252374827628899 as select v40, v41 from aggJoin3545283361495527685 join aggView801536033551257492 using(v26);
create or replace view aggView3221150112579665339 as select v40, MIN(v41) as v52 from aggJoin5764252374827628899 group by v40;
create or replace view aggJoin2578932135185531607 as select v7, v52 from aggJoin2291173911201956008 join aggView3221150112579665339 using(v40);
create or replace view aggView2972521438652073286 as select v7, MIN(v52) as v52 from aggJoin2578932135185531607 group by v7;
create or replace view aggJoin454902767485574497 as select v52 from comp_cast_type as cct2, aggView2972521438652073286 where cct2.id=aggView2972521438652073286.v7 and kind LIKE '%complete%';
create or replace view res as select MIN(v52) as v52 from aggJoin454902767485574497;
select sum(v52) from res;