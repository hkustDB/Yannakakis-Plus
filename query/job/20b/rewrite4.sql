create or replace view aggView6837573398665401352 as select id as v5 from comp_cast_type as cct1 where kind= 'cast';
create or replace view aggJoin5443635000834715129 as select movie_id as v40, status_id as v7 from complete_cast as cc, aggView6837573398665401352 where cc.subject_id=aggView6837573398665401352.v5;
create or replace view aggView8811613293017476621 as select id as v31 from name as n where name LIKE '%Downey%Robert%';
create or replace view aggJoin2797185386194304567 as select movie_id as v40, person_role_id as v9 from cast_info as ci, aggView8811613293017476621 where ci.person_id=aggView8811613293017476621.v31;
create or replace view aggView7329249524410600704 as select id as v7 from comp_cast_type as cct2 where kind LIKE '%complete%';
create or replace view aggJoin309270842582169838 as select v40 from aggJoin5443635000834715129 join aggView7329249524410600704 using(v7);
create or replace view aggView1429569696440494046 as select v40 from aggJoin309270842582169838 group by v40;
create or replace view aggJoin109880383241603647 as select id as v40, title as v41, kind_id as v26 from title as t, aggView1429569696440494046 where t.id=aggView1429569696440494046.v40 and production_year>2000;
create or replace view aggView8982288708770720819 as select id as v9 from char_name as chn where ((name LIKE '%Tony%Stark%') OR (name LIKE '%Iron%Man%')) and name NOT LIKE '%Sherlock%';
create or replace view aggJoin6314585395770430002 as select v40 from aggJoin2797185386194304567 join aggView8982288708770720819 using(v9);
create or replace view aggView3657049230761578324 as select v40 from aggJoin6314585395770430002 group by v40;
create or replace view aggJoin7934986384579064745 as select movie_id as v40, keyword_id as v23 from movie_keyword as mk, aggView3657049230761578324 where mk.movie_id=aggView3657049230761578324.v40;
create or replace view aggView4459273817736226030 as select id as v26 from kind_type as kt where kind= 'movie';
create or replace view aggJoin3677394635522779993 as select v40, v41 from aggJoin109880383241603647 join aggView4459273817736226030 using(v26);
create or replace view aggView7935279205858479922 as select v40, MIN(v41) as v52 from aggJoin3677394635522779993 group by v40;
create or replace view aggJoin7753156674622375277 as select v23, v52 from aggJoin7934986384579064745 join aggView7935279205858479922 using(v40);
create or replace view aggView372345895378411496 as select v23, MIN(v52) as v52 from aggJoin7753156674622375277 group by v23;
create or replace view aggJoin7915367841257827240 as select v52 from keyword as k, aggView372345895378411496 where k.id=aggView372345895378411496.v23 and keyword IN ('superhero','sequel','second-part','marvel-comics','based-on-comic','tv-special','fight','violence');
create or replace view res as select MIN(v52) as v52 from aggJoin7915367841257827240;
select sum(v52) from res;