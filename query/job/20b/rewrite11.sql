create or replace view aggView2402711792010268342 as select id as v26 from kind_type as kt where kind= 'movie';
create or replace view aggJoin3388218354425073166 as select id as v40, title as v41, production_year as v44 from title as t, aggView2402711792010268342 where t.kind_id=aggView2402711792010268342.v26 and production_year>2000;
create or replace view aggView5956804305653938727 as select id as v9 from char_name as chn where ((name LIKE '%Tony%Stark%') OR (name LIKE '%Iron%Man%')) and name NOT LIKE '%Sherlock%';
create or replace view aggJoin9108706230588826273 as select person_id as v31, movie_id as v40 from cast_info as ci, aggView5956804305653938727 where ci.person_role_id=aggView5956804305653938727.v9;
create or replace view aggView3845743953357380971 as select id as v7 from comp_cast_type as cct2 where kind LIKE '%complete%';
create or replace view aggJoin2022457795823095913 as select movie_id as v40, subject_id as v5 from complete_cast as cc, aggView3845743953357380971 where cc.status_id=aggView3845743953357380971.v7;
create or replace view aggView784513401082996431 as select id as v23 from keyword as k where keyword IN ('superhero','sequel','second-part','marvel-comics','based-on-comic','tv-special','fight','violence');
create or replace view aggJoin365538723675614619 as select movie_id as v40 from movie_keyword as mk, aggView784513401082996431 where mk.keyword_id=aggView784513401082996431.v23;
create or replace view aggView3290543175415634935 as select v40 from aggJoin365538723675614619 group by v40;
create or replace view aggJoin1380737653179795737 as select v40, v41, v44 from aggJoin3388218354425073166 join aggView3290543175415634935 using(v40);
create or replace view aggView7415481752855092165 as select id as v31 from name as n where name LIKE '%Downey%Robert%';
create or replace view aggJoin473054827521495710 as select v40 from aggJoin9108706230588826273 join aggView7415481752855092165 using(v31);
create or replace view aggView5216174878738795378 as select id as v5 from comp_cast_type as cct1 where kind= 'cast';
create or replace view aggJoin4481168917161292328 as select v40 from aggJoin2022457795823095913 join aggView5216174878738795378 using(v5);
create or replace view aggView7006606623267131616 as select v40 from aggJoin4481168917161292328 group by v40;
create or replace view aggJoin3935755432173896533 as select v40 from aggJoin473054827521495710 join aggView7006606623267131616 using(v40);
create or replace view aggView4188204549104469460 as select v40 from aggJoin3935755432173896533 group by v40;
create or replace view aggJoin2629167245514747249 as select v41, v44 from aggJoin1380737653179795737 join aggView4188204549104469460 using(v40);
create or replace view aggView5346102914793263870 as select v41 from aggJoin2629167245514747249 group by v41;
select MIN(v41) as v52 from aggView5346102914793263870;
