create or replace view aggView7992523996301069897 as select id as v5 from comp_cast_type as cct1 where kind= 'cast';
create or replace view aggJoin4024174867443809878 as select movie_id as v40, status_id as v7 from complete_cast as cc, aggView7992523996301069897 where cc.subject_id=aggView7992523996301069897.v5;
create or replace view aggView8446487593139857844 as select id as v31 from name as n where name LIKE '%Downey%Robert%';
create or replace view aggJoin7115921602747194500 as select movie_id as v40, person_role_id as v9 from cast_info as ci, aggView8446487593139857844 where ci.person_id=aggView8446487593139857844.v31;
create or replace view aggView5285035094950281753 as select id as v23 from keyword as k where keyword IN ('superhero','sequel','second-part','marvel-comics','based-on-comic','tv-special','fight','violence');
create or replace view aggJoin72437335756137772 as select movie_id as v40 from movie_keyword as mk, aggView5285035094950281753 where mk.keyword_id=aggView5285035094950281753.v23;
create or replace view aggView4749188516912704691 as select id as v7 from comp_cast_type as cct2 where kind LIKE '%complete%';
create or replace view aggJoin2406049585085502101 as select v40 from aggJoin4024174867443809878 join aggView4749188516912704691 using(v7);
create or replace view aggView9182046640702310689 as select v40 from aggJoin2406049585085502101 group by v40;
create or replace view aggJoin7963759833458748606 as select v40 from aggJoin72437335756137772 join aggView9182046640702310689 using(v40);
create or replace view aggView7773923721346316678 as select id as v9 from char_name as chn where ((name LIKE '%Tony%Stark%') OR (name LIKE '%Iron%Man%')) and name NOT LIKE '%Sherlock%';
create or replace view aggJoin8207583667661236873 as select v40 from aggJoin7115921602747194500 join aggView7773923721346316678 using(v9);
create or replace view aggView2277137069229495044 as select id as v26 from kind_type as kt where kind= 'movie';
create or replace view aggJoin1730352384332843243 as select id as v40, title as v41 from title as t, aggView2277137069229495044 where t.kind_id=aggView2277137069229495044.v26 and production_year>2000;
create or replace view aggView4234095791044525217 as select v40, MIN(v41) as v52 from aggJoin1730352384332843243 group by v40;
create or replace view aggJoin8502666841332795075 as select v40, v52 from aggJoin8207583667661236873 join aggView4234095791044525217 using(v40);
create or replace view aggView3337373288863766564 as select v40, MIN(v52) as v52 from aggJoin8502666841332795075 group by v40;
create or replace view aggJoin1983299238610675254 as select v52 from aggJoin7963759833458748606 join aggView3337373288863766564 using(v40);
create or replace view res as select MIN(v52) as v52 from aggJoin1983299238610675254;
select sum(v52) from res;