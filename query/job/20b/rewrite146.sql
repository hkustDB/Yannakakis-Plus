create or replace view aggView2299711519512864036 as select id as v5 from comp_cast_type as cct1 where kind= 'cast';
create or replace view aggJoin339842587444443312 as select movie_id as v40, status_id as v7 from complete_cast as cc, aggView2299711519512864036 where cc.subject_id=aggView2299711519512864036.v5;
create or replace view aggView4343926794367859260 as select id as v31 from name as n where name LIKE '%Downey%Robert%';
create or replace view aggJoin1026368650044801275 as select movie_id as v40, person_role_id as v9 from cast_info as ci, aggView4343926794367859260 where ci.person_id=aggView4343926794367859260.v31;
create or replace view aggView9188746708324379383 as select id as v23 from keyword as k where keyword IN ('superhero','sequel','second-part','marvel-comics','based-on-comic','tv-special','fight','violence');
create or replace view aggJoin6762677345727555784 as select movie_id as v40 from movie_keyword as mk, aggView9188746708324379383 where mk.keyword_id=aggView9188746708324379383.v23;
create or replace view aggView8900415116042211237 as select v40 from aggJoin6762677345727555784 group by v40;
create or replace view aggJoin6479174738150188067 as select id as v40, title as v41, kind_id as v26 from title as t, aggView8900415116042211237 where t.id=aggView8900415116042211237.v40 and production_year>2000;
create or replace view aggView1483747497660333618 as select id as v7 from comp_cast_type as cct2 where kind LIKE '%complete%';
create or replace view aggJoin2953417838687796631 as select v40 from aggJoin339842587444443312 join aggView1483747497660333618 using(v7);
create or replace view aggView3021682259298839557 as select id as v9 from char_name as chn where ((name LIKE '%Tony%Stark%') OR (name LIKE '%Iron%Man%')) and name NOT LIKE '%Sherlock%';
create or replace view aggJoin1657951938679185102 as select v40 from aggJoin1026368650044801275 join aggView3021682259298839557 using(v9);
create or replace view aggView1412861513422935172 as select v40 from aggJoin1657951938679185102 group by v40;
create or replace view aggJoin3911199355075393742 as select v40 from aggJoin2953417838687796631 join aggView1412861513422935172 using(v40);
create or replace view aggView9138488050186206876 as select id as v26 from kind_type as kt where kind= 'movie';
create or replace view aggJoin7531511995437084625 as select v40, v41 from aggJoin6479174738150188067 join aggView9138488050186206876 using(v26);
create or replace view aggView344657331587067739 as select v40, MIN(v41) as v52 from aggJoin7531511995437084625 group by v40;
create or replace view aggJoin1827054153290899105 as select v52 from aggJoin3911199355075393742 join aggView344657331587067739 using(v40);
create or replace view res as select MIN(v52) as v52 from aggJoin1827054153290899105;
select sum(v52) from res;