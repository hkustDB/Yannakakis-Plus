create or replace view aggView2757170704556444738 as select id as v5 from comp_cast_type as cct1 where kind= 'cast';
create or replace view aggJoin3184772986473857789 as select movie_id as v40, status_id as v7 from complete_cast as cc, aggView2757170704556444738 where cc.subject_id=aggView2757170704556444738.v5;
create or replace view aggView4045320104077859668 as select id as v31 from name as n where name LIKE '%Downey%Robert%';
create or replace view aggJoin5257252663203490735 as select movie_id as v40, person_role_id as v9 from cast_info as ci, aggView4045320104077859668 where ci.person_id=aggView4045320104077859668.v31;
create or replace view aggView4637891375605300017 as select id as v23 from keyword as k where keyword IN ('superhero','sequel','second-part','marvel-comics','based-on-comic','tv-special','fight','violence');
create or replace view aggJoin5597644868642880322 as select movie_id as v40 from movie_keyword as mk, aggView4637891375605300017 where mk.keyword_id=aggView4637891375605300017.v23;
create or replace view aggView5646473271786884716 as select v40 from aggJoin5597644868642880322 group by v40;
create or replace view aggJoin3808144281932717695 as select v40, v9 from aggJoin5257252663203490735 join aggView5646473271786884716 using(v40);
create or replace view aggView1430637486163726403 as select id as v7 from comp_cast_type as cct2 where kind LIKE '%complete%';
create or replace view aggJoin3367992239906594686 as select v40 from aggJoin3184772986473857789 join aggView1430637486163726403 using(v7);
create or replace view aggView2828740122065421931 as select id as v26 from kind_type as kt where kind= 'movie';
create or replace view aggJoin9077670328157239431 as select id as v40, title as v41 from title as t, aggView2828740122065421931 where t.kind_id=aggView2828740122065421931.v26 and production_year>2000;
create or replace view aggView559013274205775303 as select v40, MIN(v41) as v52 from aggJoin9077670328157239431 group by v40;
create or replace view aggJoin648966667810138585 as select v40, v52 from aggJoin3367992239906594686 join aggView559013274205775303 using(v40);
create or replace view aggView1341519665135106703 as select v40, MIN(v52) as v52 from aggJoin648966667810138585 group by v40;
create or replace view aggJoin7892706444320928227 as select v9, v52 from aggJoin3808144281932717695 join aggView1341519665135106703 using(v40);
create or replace view aggView6331002083757526341 as select v9, MIN(v52) as v52 from aggJoin7892706444320928227 group by v9;
create or replace view aggJoin7536075431254396133 as select v52 from char_name as chn, aggView6331002083757526341 where chn.id=aggView6331002083757526341.v9 and ((name LIKE '%Tony%Stark%') OR (name LIKE '%Iron%Man%')) and name NOT LIKE '%Sherlock%';
create or replace view res as select MIN(v52) as v52 from aggJoin7536075431254396133;
select sum(v52) from res;