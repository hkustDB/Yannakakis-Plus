create or replace view aggView4627144939422069375 as select id as v5 from comp_cast_type as cct1 where kind= 'cast';
create or replace view aggJoin7602444433660691766 as select movie_id as v40, status_id as v7 from complete_cast as cc, aggView4627144939422069375 where cc.subject_id=aggView4627144939422069375.v5;
create or replace view aggView5970280759913889429 as select id as v31 from name as n where name LIKE '%Downey%Robert%';
create or replace view aggJoin3735292629000246511 as select movie_id as v40, person_role_id as v9 from cast_info as ci, aggView5970280759913889429 where ci.person_id=aggView5970280759913889429.v31;
create or replace view aggView3930823580625690259 as select id as v23 from keyword as k where keyword IN ('superhero','sequel','second-part','marvel-comics','based-on-comic','tv-special','fight','violence');
create or replace view aggJoin4053620554193156643 as select movie_id as v40 from movie_keyword as mk, aggView3930823580625690259 where mk.keyword_id=aggView3930823580625690259.v23;
create or replace view aggView1135006155187002769 as select v40 from aggJoin4053620554193156643 group by v40;
create or replace view aggJoin586989881525249085 as select id as v40, title as v41, kind_id as v26 from title as t, aggView1135006155187002769 where t.id=aggView1135006155187002769.v40 and production_year>2000;
create or replace view aggView3115401521665382247 as select id as v7 from comp_cast_type as cct2 where kind LIKE '%complete%';
create or replace view aggJoin5702259933649485526 as select v40 from aggJoin7602444433660691766 join aggView3115401521665382247 using(v7);
create or replace view aggView3889131487175537437 as select id as v9 from char_name as chn where ((name LIKE '%Tony%Stark%') OR (name LIKE '%Iron%Man%')) and name NOT LIKE '%Sherlock%';
create or replace view aggJoin9077676151705424161 as select v40 from aggJoin3735292629000246511 join aggView3889131487175537437 using(v9);
create or replace view aggView7651726217842625603 as select id as v26 from kind_type as kt where kind= 'movie';
create or replace view aggJoin6021811757534145481 as select v40, v41 from aggJoin586989881525249085 join aggView7651726217842625603 using(v26);
create or replace view aggView4981779277543380392 as select v40, MIN(v41) as v52 from aggJoin6021811757534145481 group by v40;
create or replace view aggJoin4635290343182969994 as select v40, v52 from aggJoin9077676151705424161 join aggView4981779277543380392 using(v40);
create or replace view aggView5033388817377788368 as select v40, MIN(v52) as v52 from aggJoin4635290343182969994 group by v40;
create or replace view aggJoin2770536410867155221 as select v52 from aggJoin5702259933649485526 join aggView5033388817377788368 using(v40);
create or replace view res as select MIN(v52) as v52 from aggJoin2770536410867155221;
select sum(v52) from res;