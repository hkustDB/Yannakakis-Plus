create or replace view aggView5747506865636949735 as select id as v5 from comp_cast_type as cct1 where kind= 'cast';
create or replace view aggJoin2667408917396215673 as select movie_id as v40, status_id as v7 from complete_cast as cc, aggView5747506865636949735 where cc.subject_id=aggView5747506865636949735.v5;
create or replace view aggView8522919970888870030 as select id as v31 from name as n where name LIKE '%Downey%Robert%';
create or replace view aggJoin658912908090931146 as select movie_id as v40, person_role_id as v9 from cast_info as ci, aggView8522919970888870030 where ci.person_id=aggView8522919970888870030.v31;
create or replace view aggView4419165599283143721 as select id as v7 from comp_cast_type as cct2 where kind LIKE '%complete%';
create or replace view aggJoin6454661818767114201 as select v40 from aggJoin2667408917396215673 join aggView4419165599283143721 using(v7);
create or replace view aggView8721788209747802986 as select v40 from aggJoin6454661818767114201 group by v40;
create or replace view aggJoin1492250596032199479 as select v40, v9 from aggJoin658912908090931146 join aggView8721788209747802986 using(v40);
create or replace view aggView6922403071858516780 as select id as v9 from char_name as chn where ((name LIKE '%Tony%Stark%') OR (name LIKE '%Iron%Man%')) and name NOT LIKE '%Sherlock%';
create or replace view aggJoin3267161267518992067 as select v40 from aggJoin1492250596032199479 join aggView6922403071858516780 using(v9);
create or replace view aggView2398837486905011671 as select v40 from aggJoin3267161267518992067 group by v40;
create or replace view aggJoin8577820725692089243 as select id as v40, title as v41, kind_id as v26 from title as t, aggView2398837486905011671 where t.id=aggView2398837486905011671.v40 and production_year>2000;
create or replace view aggView3924716444841165804 as select id as v26 from kind_type as kt where kind= 'movie';
create or replace view aggJoin7057152422477577745 as select v40, v41 from aggJoin8577820725692089243 join aggView3924716444841165804 using(v26);
create or replace view aggView2031540699898599847 as select v40, MIN(v41) as v52 from aggJoin7057152422477577745 group by v40;
create or replace view aggJoin192451893032458192 as select keyword_id as v23, v52 from movie_keyword as mk, aggView2031540699898599847 where mk.movie_id=aggView2031540699898599847.v40;
create or replace view aggView231470374210374221 as select v23, MIN(v52) as v52 from aggJoin192451893032458192 group by v23;
create or replace view aggJoin740386597688873146 as select v52 from keyword as k, aggView231470374210374221 where k.id=aggView231470374210374221.v23 and keyword IN ('superhero','sequel','second-part','marvel-comics','based-on-comic','tv-special','fight','violence');
create or replace view res as select MIN(v52) as v52 from aggJoin740386597688873146;
select sum(v52) from res;