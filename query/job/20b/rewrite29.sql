create or replace view aggView3605287675186406655 as select id as v5 from comp_cast_type as cct1 where kind= 'cast';
create or replace view aggJoin5285774332868769252 as select movie_id as v40, status_id as v7 from complete_cast as cc, aggView3605287675186406655 where cc.subject_id=aggView3605287675186406655.v5;
create or replace view aggView6293188624140248713 as select id as v23 from keyword as k where keyword IN ('superhero','sequel','second-part','marvel-comics','based-on-comic','tv-special','fight','violence');
create or replace view aggJoin8814107004391836564 as select movie_id as v40 from movie_keyword as mk, aggView6293188624140248713 where mk.keyword_id=aggView6293188624140248713.v23;
create or replace view aggView3725025972136603001 as select v40 from aggJoin8814107004391836564 group by v40;
create or replace view aggJoin4965567771413539922 as select person_id as v31, movie_id as v40, person_role_id as v9 from cast_info as ci, aggView3725025972136603001 where ci.movie_id=aggView3725025972136603001.v40;
create or replace view aggView1143892155320022517 as select id as v7 from comp_cast_type as cct2 where kind LIKE '%complete%';
create or replace view aggJoin5623999496244035598 as select v40 from aggJoin5285774332868769252 join aggView1143892155320022517 using(v7);
create or replace view aggView3668593795571538196 as select v40 from aggJoin5623999496244035598 group by v40;
create or replace view aggJoin3799748087460405176 as select id as v40, title as v41, kind_id as v26 from title as t, aggView3668593795571538196 where t.id=aggView3668593795571538196.v40 and production_year>2000;
create or replace view aggView957572433521017934 as select id as v9 from char_name as chn where ((name LIKE '%Tony%Stark%') OR (name LIKE '%Iron%Man%')) and name NOT LIKE '%Sherlock%';
create or replace view aggJoin6654886464115132132 as select v31, v40 from aggJoin4965567771413539922 join aggView957572433521017934 using(v9);
create or replace view aggView6642861017462480578 as select id as v26 from kind_type as kt where kind= 'movie';
create or replace view aggJoin511557669465172795 as select v40, v41 from aggJoin3799748087460405176 join aggView6642861017462480578 using(v26);
create or replace view aggView619720010588620823 as select v40, MIN(v41) as v52 from aggJoin511557669465172795 group by v40;
create or replace view aggJoin4734352042873039370 as select v31, v52 from aggJoin6654886464115132132 join aggView619720010588620823 using(v40);
create or replace view aggView5668136238081193667 as select v31, MIN(v52) as v52 from aggJoin4734352042873039370 group by v31;
create or replace view aggJoin4664334798257122480 as select v52 from name as n, aggView5668136238081193667 where n.id=aggView5668136238081193667.v31 and name LIKE '%Downey%Robert%';
create or replace view res as select MIN(v52) as v52 from aggJoin4664334798257122480;
select sum(v52) from res;