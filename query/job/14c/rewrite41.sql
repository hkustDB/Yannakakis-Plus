create or replace view aggView5128725342105536386 as select id as v3 from info_type as it2 where info= 'rating';
create or replace view aggJoin7613358960300966791 as select movie_id as v23, info as v18 from movie_info_idx as mi_idx, aggView5128725342105536386 where mi_idx.info_type_id=aggView5128725342105536386.v3 and info<'8.5';
create or replace view aggView3279310646320659602 as select v23, MIN(v18) as v35 from aggJoin7613358960300966791 group by v23;
create or replace view aggJoin86957075858015348 as select id as v23, title as v24, kind_id as v8, v35 from title as t, aggView3279310646320659602 where t.id=aggView3279310646320659602.v23 and production_year>2005;
create or replace view aggView2316278243584896731 as select id as v8 from kind_type as kt where kind IN ('movie','episode');
create or replace view aggJoin820877089198015936 as select v23, v24, v35 from aggJoin86957075858015348 join aggView2316278243584896731 using(v8);
create or replace view aggView7618508927322078132 as select v23, MIN(v35) as v35, MIN(v24) as v36 from aggJoin820877089198015936 group by v23;
create or replace view aggJoin2286365950070267033 as select movie_id as v23, info_type_id as v1, v35, v36 from movie_info as mi, aggView7618508927322078132 where mi.movie_id=aggView7618508927322078132.v23 and info IN ('Sweden','Norway','Germany','Denmark','Swedish','Danish','Norwegian','German','USA','American');
create or replace view aggView1852435638765048583 as select id as v5 from keyword as k where keyword IN ('murder','murder-in-title','blood','violence');
create or replace view aggJoin7475375283058255422 as select movie_id as v23 from movie_keyword as mk, aggView1852435638765048583 where mk.keyword_id=aggView1852435638765048583.v5;
create or replace view aggView3628005272008554444 as select v23 from aggJoin7475375283058255422 group by v23;
create or replace view aggJoin2050883509490767877 as select v1, v35 as v35, v36 as v36 from aggJoin2286365950070267033 join aggView3628005272008554444 using(v23);
create or replace view aggView1278148337583487543 as select v1, MIN(v35) as v35, MIN(v36) as v36 from aggJoin2050883509490767877 group by v1;
create or replace view aggJoin7477776274653114960 as select v35, v36 from info_type as it1, aggView1278148337583487543 where it1.id=aggView1278148337583487543.v1 and info= 'countries';
create or replace view res as select MIN(v35) as v35, MIN(v36) as v36 from aggJoin7477776274653114960;
select sum(v35+v36) from res;