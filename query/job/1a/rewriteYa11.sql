create or replace view semiUp4775916756404270616 as select movie_id as v15, company_type_id as v1, note as v9 from movie_companies AS mc where (company_type_id) in (select (id) from company_type AS ct where kind= 'production companies') and note NOT LIKE '%(as Metro-Goldwyn-Mayer Pictures)%' and ((note LIKE '%(co-production)%') OR (note LIKE '%(presents)%'));
create or replace view semiUp8380612404867216347 as select movie_id as v15, info_type_id as v3 from movie_info_idx AS mi_idx where (info_type_id) in (select (id) from info_type AS it where info= 'top 250 rank');
create or replace view semiUp9101772058812901025 as select id as v15, title as v16, production_year as v19 from title AS t where (id) in (select (v15) from semiUp8380612404867216347);
create or replace view semiUp2524530808682943159 as select v15, v1, v9 from semiUp4775916756404270616 where (v15) in (select (v15) from semiUp9101772058812901025);
create or replace view semiDown4132717150396265646 as select id as v1 from company_type AS ct where (id) in (select (v1) from semiUp2524530808682943159) and kind= 'production companies';
create or replace view semiDown927641319040652681 as select v15, v16, v19 from semiUp9101772058812901025 where (v15) in (select (v15) from semiUp2524530808682943159);
create or replace view semiDown593530157854001688 as select v15, v3 from semiUp8380612404867216347 where (v15) in (select (v15) from semiDown927641319040652681);
create or replace view semiDown5918365792305120799 as select id as v3 from info_type AS it where (id) in (select (v3) from semiDown593530157854001688) and info= 'top 250 rank';
create or replace view aggView4716862635169614747 as select v1 from semiDown4132717150396265646;
create or replace view aggJoin6152512699934521910 as select v15, v9 from semiUp2524530808682943159 join aggView4716862635169614747 using(v1);
create or replace view aggView7676862564291282217 as select v3 from semiDown5918365792305120799;
create or replace view aggJoin3897338237721344047 as select v15 from semiDown593530157854001688 join aggView7676862564291282217 using(v3);
create or replace view aggView354516513291833867 as select v15 from aggJoin3897338237721344047 group by v15;
create or replace view aggJoin8780722557965283167 as select v15, v16, v19 from semiDown927641319040652681 join aggView354516513291833867 using(v15);
create or replace view aggView7395555822219843592 as select v15, MIN(v16) as v28, MIN(v19) as v29 from aggJoin8780722557965283167 group by v15;
create or replace view aggJoin672834152422832532 as select v9, v28, v29 from aggJoin6152512699934521910 join aggView7395555822219843592 using(v15);
select MIN(v9) as v27,MIN(v28) as v28,MIN(v29) as v29 from aggJoin672834152422832532;
