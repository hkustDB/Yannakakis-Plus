create or replace view semiUp856965981490730017 as select movie_id as v15, info_type_id as v3 from movie_info_idx AS mi_idx where (info_type_id) in (select (id) from info_type AS it where info= 'top 250 rank');
create or replace view semiUp6279566207964758775 as select movie_id as v15, company_type_id as v1, note as v9 from movie_companies AS mc where (movie_id) in (select (id) from title AS t) and note NOT LIKE '%(as Metro-Goldwyn-Mayer Pictures)%' and ((note LIKE '%(co-production)%') OR (note LIKE '%(presents)%'));
create or replace view semiUp8658975722603909426 as select v15, v1, v9 from semiUp6279566207964758775 where (v1) in (select (id) from company_type AS ct where kind= 'production companies');
create or replace view semiUp7355228909236964976 as select v15, v3 from semiUp856965981490730017 where (v15) in (select (v15) from semiUp8658975722603909426);
create or replace view semiDown5660388421780736358 as select id as v3 from info_type AS it where (id) in (select (v3) from semiUp7355228909236964976) and info= 'top 250 rank';
create or replace view semiDown2207835713787096630 as select v15, v1, v9 from semiUp8658975722603909426 where (v15) in (select (v15) from semiUp7355228909236964976);
create or replace view semiDown7802300813511477363 as select id as v15, title as v16, production_year as v19 from title AS t where (id) in (select (v15) from semiDown2207835713787096630);
create or replace view semiDown8175305364101368208 as select id as v1 from company_type AS ct where (id) in (select (v1) from semiDown2207835713787096630) and kind= 'production companies';
create or replace view aggView7881882174358062885 as select v3 from semiDown5660388421780736358;
create or replace view aggJoin5911397367480322832 as select v15 from semiUp7355228909236964976 join aggView7881882174358062885 using(v3);
create or replace view aggView8113501205213148575 as select v15, v16 as v28, v19 as v29 from semiDown7802300813511477363;
create or replace view aggJoin2755893113867574333 as select v15, v1, v9, v28, v29 from semiDown2207835713787096630 join aggView8113501205213148575 using(v15);
create or replace view aggView142756216060197192 as select v1 from semiDown8175305364101368208;
create or replace view aggJoin1247669652110720953 as select v15, v9, v28, v29 from aggJoin2755893113867574333 join aggView142756216060197192 using(v1);
create or replace view aggView7594320830209522010 as select v15, MIN(v28) as v28, MIN(v29) as v29, MIN(v9) as v27 from aggJoin1247669652110720953 group by v15;
create or replace view aggJoin7505906498227940217 as select v28, v29, v27 from aggJoin5911397367480322832 join aggView7594320830209522010 using(v15);
select MIN(v27) as v27,MIN(v28) as v28,MIN(v29) as v29 from aggJoin7505906498227940217;
