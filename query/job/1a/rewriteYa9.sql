create or replace view semiUp8201571300466168295 as select movie_id as v15, info_type_id as v3 from movie_info_idx AS mi_idx where (movie_id) in (select (id) from title AS t);
create or replace view semiUp8885491068819973416 as select movie_id as v15, company_type_id as v1, note as v9 from movie_companies AS mc where (company_type_id) in (select (id) from company_type AS ct where kind= 'production companies') and note NOT LIKE '%(as Metro-Goldwyn-Mayer Pictures)%' and ((note LIKE '%(co-production)%') OR (note LIKE '%(presents)%'));
create or replace view semiUp8223301943518826433 as select v15, v3 from semiUp8201571300466168295 where (v3) in (select (id) from info_type AS it where info= 'top 250 rank');
create or replace view semiUp5408189736710420400 as select v15, v1, v9 from semiUp8885491068819973416 where (v15) in (select (v15) from semiUp8223301943518826433);
create or replace view semiDown3155354611580028310 as select id as v1 from company_type AS ct where (id) in (select (v1) from semiUp5408189736710420400) and kind= 'production companies';
create or replace view semiDown1117652174014599132 as select v15, v3 from semiUp8223301943518826433 where (v15) in (select (v15) from semiUp5408189736710420400);
create or replace view semiDown2950035819184176876 as select id as v15, title as v16, production_year as v19 from title AS t where (id) in (select (v15) from semiDown1117652174014599132);
create or replace view semiDown6584078348953014016 as select id as v3 from info_type AS it where (id) in (select (v3) from semiDown1117652174014599132) and info= 'top 250 rank';
create or replace view aggView88263620830592386 as select v3 from semiDown6584078348953014016;
create or replace view aggJoin3218913350070887212 as select v15 from semiDown1117652174014599132 join aggView88263620830592386 using(v3);
create or replace view aggView3953405541462938460 as select v1 from semiDown3155354611580028310;
create or replace view aggJoin4127635713692410816 as select v15, v9 from semiUp5408189736710420400 join aggView3953405541462938460 using(v1);
create or replace view aggView8124342291527079313 as select v15, v16 as v28, v19 as v29 from semiDown2950035819184176876;
create or replace view aggJoin1642837980280710796 as select v15, v28, v29 from aggJoin3218913350070887212 join aggView8124342291527079313 using(v15);
create or replace view aggView4215298786006938378 as select v15, MIN(v28) as v28, MIN(v29) as v29 from aggJoin1642837980280710796 group by v15;
create or replace view aggJoin843689785651233116 as select v9, v28, v29 from aggJoin4127635713692410816 join aggView4215298786006938378 using(v15);
select MIN(v9) as v27,MIN(v28) as v28,MIN(v29) as v29 from aggJoin843689785651233116;
