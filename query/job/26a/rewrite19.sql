create or replace view aggView8793788028029866685 as select id as v9, name as v59 from char_name as chn where ((name LIKE '%man%') OR (name LIKE '%Man%'));
create or replace view aggJoin1279760861176181886 as select person_id as v38, movie_id as v47, v59 from cast_info as ci, aggView8793788028029866685 where ci.person_role_id=aggView8793788028029866685.v9;
create or replace view aggView5681380456824273014 as select id as v38, name as v61 from name as n;
create or replace view aggJoin6530959603890015466 as select v47, v59, v61 from aggJoin1279760861176181886 join aggView5681380456824273014 using(v38);
create or replace view aggView1629221253863801725 as select id as v28 from kind_type as kt where kind= 'movie';
create or replace view aggJoin5036354685462334789 as select id as v47, title as v48 from title as t, aggView1629221253863801725 where t.kind_id=aggView1629221253863801725.v28 and production_year>2000;
create or replace view aggView3973385920954693128 as select id as v5 from comp_cast_type as cct1 where kind= 'cast';
create or replace view aggJoin2534634065192830208 as select movie_id as v47, status_id as v7 from complete_cast as cc, aggView3973385920954693128 where cc.subject_id=aggView3973385920954693128.v5;
create or replace view aggView8124708887727648484 as select v47, MIN(v59) as v59, MIN(v61) as v61 from aggJoin6530959603890015466 group by v47;
create or replace view aggJoin365310798408484390 as select v47, v48, v59, v61 from aggJoin5036354685462334789 join aggView8124708887727648484 using(v47);
create or replace view aggView7742428710372522530 as select v47, MIN(v59) as v59, MIN(v61) as v61, MIN(v48) as v62 from aggJoin365310798408484390 group by v47;
create or replace view aggJoin4143754943711478507 as select movie_id as v47, keyword_id as v25, v59, v61, v62 from movie_keyword as mk, aggView7742428710372522530 where mk.movie_id=aggView7742428710372522530.v47;
create or replace view aggView338991689014170848 as select id as v7 from comp_cast_type as cct2 where kind LIKE '%complete%';
create or replace view aggJoin6571534888165481668 as select v47 from aggJoin2534634065192830208 join aggView338991689014170848 using(v7);
create or replace view aggView5388011450088161045 as select v47 from aggJoin6571534888165481668 group by v47;
create or replace view aggJoin5813488905263055017 as select movie_id as v47, info_type_id as v23, info as v33 from movie_info_idx as mi_idx, aggView5388011450088161045 where mi_idx.movie_id=aggView5388011450088161045.v47 and info>'7.0';
create or replace view aggView9171892349939817433 as select id as v25 from keyword as k where keyword IN ('superhero','marvel-comics','based-on-comic','tv-special','fight','violence','magnet','web','claw','laser');
create or replace view aggJoin8710932629313268664 as select v47, v59, v61, v62 from aggJoin4143754943711478507 join aggView9171892349939817433 using(v25);
create or replace view aggView3639343920218742523 as select v47, MIN(v59) as v59, MIN(v61) as v61, MIN(v62) as v62 from aggJoin8710932629313268664 group by v47;
create or replace view aggJoin2673425903272315657 as select v23, v33, v59, v61, v62 from aggJoin5813488905263055017 join aggView3639343920218742523 using(v47);
create or replace view aggView5425713608378852032 as select v23, MIN(v59) as v59, MIN(v61) as v61, MIN(v62) as v62, MIN(v33) as v60 from aggJoin2673425903272315657 group by v23;
create or replace view aggJoin8201966665110216869 as select v59, v61, v62, v60 from info_type as it2, aggView5425713608378852032 where it2.id=aggView5425713608378852032.v23 and info= 'rating';
create or replace view res as select MIN(v59) as v59, MIN(v60) as v60, MIN(v61) as v61, MIN(v62) as v62 from aggJoin8201966665110216869;
select sum(v59+v60+v61+v62) from res;