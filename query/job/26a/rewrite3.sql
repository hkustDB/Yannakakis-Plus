create or replace view aggView8431374933427172350 as select id as v9, name as v59 from char_name as chn where ((name LIKE '%man%') OR (name LIKE '%Man%'));
create or replace view aggJoin2661054937883767751 as select person_id as v38, movie_id as v47, v59 from cast_info as ci, aggView8431374933427172350 where ci.person_role_id=aggView8431374933427172350.v9;
create or replace view aggView1832705441880018358 as select id as v28 from kind_type as kt where kind= 'movie';
create or replace view aggJoin7715374025165402832 as select id as v47, title as v48 from title as t, aggView1832705441880018358 where t.kind_id=aggView1832705441880018358.v28 and production_year>2000;
create or replace view aggView999094844978794974 as select id as v23 from info_type as it2 where info= 'rating';
create or replace view aggJoin7552752193139948169 as select movie_id as v47, info as v33 from movie_info_idx as mi_idx, aggView999094844978794974 where mi_idx.info_type_id=aggView999094844978794974.v23 and info>'7.0';
create or replace view aggView8439514670647844018 as select id as v5 from comp_cast_type as cct1 where kind= 'cast';
create or replace view aggJoin1325414461818879266 as select movie_id as v47, status_id as v7 from complete_cast as cc, aggView8439514670647844018 where cc.subject_id=aggView8439514670647844018.v5;
create or replace view aggView5636085183564337555 as select id as v7 from comp_cast_type as cct2 where kind LIKE '%complete%';
create or replace view aggJoin5706498699830229184 as select v47 from aggJoin1325414461818879266 join aggView5636085183564337555 using(v7);
create or replace view aggView8759131471583418047 as select v47 from aggJoin5706498699830229184 group by v47;
create or replace view aggJoin5178563094792592281 as select v47, v33 from aggJoin7552752193139948169 join aggView8759131471583418047 using(v47);
create or replace view aggView7397036444908670304 as select v47, MIN(v33) as v60 from aggJoin5178563094792592281 group by v47;
create or replace view aggJoin3316722396172647967 as select v47, v48, v60 from aggJoin7715374025165402832 join aggView7397036444908670304 using(v47);
create or replace view aggView8377974764074913237 as select v47, MIN(v60) as v60, MIN(v48) as v62 from aggJoin3316722396172647967 group by v47;
create or replace view aggJoin4074337620295591599 as select movie_id as v47, keyword_id as v25, v60, v62 from movie_keyword as mk, aggView8377974764074913237 where mk.movie_id=aggView8377974764074913237.v47;
create or replace view aggView6862151044108737720 as select id as v25 from keyword as k where keyword IN ('superhero','marvel-comics','based-on-comic','tv-special','fight','violence','magnet','web','claw','laser');
create or replace view aggJoin7615247884682897408 as select v47, v60, v62 from aggJoin4074337620295591599 join aggView6862151044108737720 using(v25);
create or replace view aggView8508223961588942544 as select v47, MIN(v60) as v60, MIN(v62) as v62 from aggJoin7615247884682897408 group by v47;
create or replace view aggJoin8469152843737214346 as select v38, v59 as v59, v60, v62 from aggJoin2661054937883767751 join aggView8508223961588942544 using(v47);
create or replace view aggView8634555740845572049 as select v38, MIN(v59) as v59, MIN(v60) as v60, MIN(v62) as v62 from aggJoin8469152843737214346 group by v38;
create or replace view aggJoin7484305418296240284 as select name as v39, v59, v60, v62 from name as n, aggView8634555740845572049 where n.id=aggView8634555740845572049.v38;
create or replace view res as select MIN(v59) as v59, MIN(v60) as v60, MIN(v39) as v61, MIN(v62) as v62 from aggJoin7484305418296240284;
select sum(v59+v60+v61+v62) from res;