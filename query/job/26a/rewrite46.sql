create or replace view aggView7234995207811116779 as select id as v9, name as v59 from char_name as chn where ((name LIKE '%man%') OR (name LIKE '%Man%'));
create or replace view aggJoin3570756277956167002 as select person_id as v38, movie_id as v47, v59 from cast_info as ci, aggView7234995207811116779 where ci.person_role_id=aggView7234995207811116779.v9;
create or replace view aggView8618175327440863450 as select id as v38, name as v61 from name as n;
create or replace view aggJoin6409748101963338711 as select v47, v59, v61 from aggJoin3570756277956167002 join aggView8618175327440863450 using(v38);
create or replace view aggView1953679797311265226 as select id as v28 from kind_type as kt where kind= 'movie';
create or replace view aggJoin7727995400253591217 as select id as v47, title as v48 from title as t, aggView1953679797311265226 where t.kind_id=aggView1953679797311265226.v28 and production_year>2000;
create or replace view aggView6089586103642977351 as select v47, MIN(v48) as v62 from aggJoin7727995400253591217 group by v47;
create or replace view aggJoin3991799800987593895 as select movie_id as v47, keyword_id as v25, v62 from movie_keyword as mk, aggView6089586103642977351 where mk.movie_id=aggView6089586103642977351.v47;
create or replace view aggView4324337476286443482 as select id as v23 from info_type as it2 where info= 'rating';
create or replace view aggJoin2937782803963878732 as select movie_id as v47, info as v33 from movie_info_idx as mi_idx, aggView4324337476286443482 where mi_idx.info_type_id=aggView4324337476286443482.v23 and info>'7.0';
create or replace view aggView8145478441071129113 as select id as v5 from comp_cast_type as cct1 where kind= 'cast';
create or replace view aggJoin5883867297179243249 as select movie_id as v47, status_id as v7 from complete_cast as cc, aggView8145478441071129113 where cc.subject_id=aggView8145478441071129113.v5;
create or replace view aggView1276970761351692971 as select v47, MIN(v59) as v59, MIN(v61) as v61 from aggJoin6409748101963338711 group by v47;
create or replace view aggJoin7473446646955290360 as select v47, v33, v59, v61 from aggJoin2937782803963878732 join aggView1276970761351692971 using(v47);
create or replace view aggView626700037918101943 as select id as v7 from comp_cast_type as cct2 where kind LIKE '%complete%';
create or replace view aggJoin4028528979972971589 as select v47 from aggJoin5883867297179243249 join aggView626700037918101943 using(v7);
create or replace view aggView8174430056652076175 as select v47 from aggJoin4028528979972971589 group by v47;
create or replace view aggJoin7125249749847479963 as select v47, v25, v62 as v62 from aggJoin3991799800987593895 join aggView8174430056652076175 using(v47);
create or replace view aggView8968403229680529453 as select id as v25 from keyword as k where keyword IN ('superhero','marvel-comics','based-on-comic','tv-special','fight','violence','magnet','web','claw','laser');
create or replace view aggJoin1326592671834555886 as select v47, v62 from aggJoin7125249749847479963 join aggView8968403229680529453 using(v25);
create or replace view aggView7839708301834266391 as select v47, MIN(v62) as v62 from aggJoin1326592671834555886 group by v47;
create or replace view aggJoin6456483416151827052 as select v33, v59 as v59, v61 as v61, v62 from aggJoin7473446646955290360 join aggView7839708301834266391 using(v47);
create or replace view res as select MIN(v59) as v59, MIN(v33) as v60, MIN(v61) as v61, MIN(v62) as v62 from aggJoin6456483416151827052;
select sum(v59+v60+v61+v62) from res;