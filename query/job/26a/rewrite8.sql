create or replace view aggView5184630383022948171 as select id as v9, name as v59 from char_name as chn where ((name LIKE '%man%') OR (name LIKE '%Man%'));
create or replace view aggJoin2284471501083060330 as select person_id as v38, movie_id as v47, v59 from cast_info as ci, aggView5184630383022948171 where ci.person_role_id=aggView5184630383022948171.v9;
create or replace view aggView2135693997715045621 as select id as v38, name as v61 from name as n;
create or replace view aggJoin4986975739067876229 as select v47, v59, v61 from aggJoin2284471501083060330 join aggView2135693997715045621 using(v38);
create or replace view aggView5202657129637000244 as select id as v28 from kind_type as kt where kind= 'movie';
create or replace view aggJoin5389958521637824115 as select id as v47, title as v48 from title as t, aggView5202657129637000244 where t.kind_id=aggView5202657129637000244.v28 and production_year>2000;
create or replace view aggView5921011943420224155 as select v47, MIN(v59) as v59, MIN(v61) as v61 from aggJoin4986975739067876229 group by v47;
create or replace view aggJoin2193059982719362701 as select movie_id as v47, keyword_id as v25, v59, v61 from movie_keyword as mk, aggView5921011943420224155 where mk.movie_id=aggView5921011943420224155.v47;
create or replace view aggView6449771069269607037 as select id as v23 from info_type as it2 where info= 'rating';
create or replace view aggJoin5744611156152782396 as select movie_id as v47, info as v33 from movie_info_idx as mi_idx, aggView6449771069269607037 where mi_idx.info_type_id=aggView6449771069269607037.v23 and info>'7.0';
create or replace view aggView154349648819726671 as select id as v7 from comp_cast_type as cct2 where kind LIKE '%complete%';
create or replace view aggJoin1562159116358324285 as select movie_id as v47, subject_id as v5 from complete_cast as cc, aggView154349648819726671 where cc.status_id=aggView154349648819726671.v7;
create or replace view aggView421889081858532977 as select id as v25 from keyword as k where keyword IN ('superhero','marvel-comics','based-on-comic','tv-special','fight','violence','magnet','web','claw','laser');
create or replace view aggJoin4801236506796889520 as select v47, v59, v61 from aggJoin2193059982719362701 join aggView421889081858532977 using(v25);
create or replace view aggView4611470257710842640 as select v47, MIN(v59) as v59, MIN(v61) as v61 from aggJoin4801236506796889520 group by v47;
create or replace view aggJoin8432281448131719366 as select v47, v33, v59, v61 from aggJoin5744611156152782396 join aggView4611470257710842640 using(v47);
create or replace view aggView4088676986549977505 as select v47, MIN(v59) as v59, MIN(v61) as v61, MIN(v33) as v60 from aggJoin8432281448131719366 group by v47;
create or replace view aggJoin1009102269722964530 as select v47, v48, v59, v61, v60 from aggJoin5389958521637824115 join aggView4088676986549977505 using(v47);
create or replace view aggView888144772244765115 as select v47, MIN(v59) as v59, MIN(v61) as v61, MIN(v60) as v60, MIN(v48) as v62 from aggJoin1009102269722964530 group by v47;
create or replace view aggJoin5759372667790574300 as select v5, v59, v61, v60, v62 from aggJoin1562159116358324285 join aggView888144772244765115 using(v47);
create or replace view aggView9162030578420215259 as select v5, MIN(v59) as v59, MIN(v61) as v61, MIN(v60) as v60, MIN(v62) as v62 from aggJoin5759372667790574300 group by v5;
create or replace view aggJoin9092898084314532779 as select v59, v61, v60, v62 from comp_cast_type as cct1, aggView9162030578420215259 where cct1.id=aggView9162030578420215259.v5 and kind= 'cast';
create or replace view res as select MIN(v59) as v59, MIN(v60) as v60, MIN(v61) as v61, MIN(v62) as v62 from aggJoin9092898084314532779;
select sum(v59+v60+v61+v62) from res;