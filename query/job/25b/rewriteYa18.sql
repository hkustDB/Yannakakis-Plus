create or replace view semiUp5922272724513349729 as select person_id as v28, movie_id as v37 from cast_info AS ci where (person_id) in (select (id) from name AS n where gender= 'm') and note IN ('(writer)','(head writer)','(written by)','(story)','(story editor)');
create or replace view semiUp8729606291264337214 as select movie_id as v37, keyword_id as v12 from movie_keyword AS mk where (keyword_id) in (select (id) from keyword AS k where keyword IN ('murder','blood','gore','death','female-nudity'));
create or replace view semiUp5053694085276835794 as select movie_id as v37, info_type_id as v10, info as v23 from movie_info_idx AS mi_idx where (info_type_id) in (select (id) from info_type AS it2 where info= 'votes');
create or replace view semiUp8746202797613038633 as select movie_id as v37, info_type_id as v8, info as v18 from movie_info AS mi where (movie_id) in (select (v37) from semiUp8729606291264337214) and info= 'Horror';
create or replace view semiUp779976982963768999 as select v37, v8, v18 from semiUp8746202797613038633 where (v8) in (select (id) from info_type AS it1 where info= 'genres');
create or replace view semiUp215396392084185311 as select v37, v10, v23 from semiUp5053694085276835794 where (v37) in (select (v37) from semiUp779976982963768999);
create or replace view semiUp853263425974061032 as select v28, v37 from semiUp5922272724513349729 where (v37) in (select (v37) from semiUp215396392084185311);
create or replace view semiUp6130635338129518505 as select id as v37, title as v38 from title AS t where (id) in (select (v37) from semiUp853263425974061032) and production_year>2010 and title LIKE 'Vampire%';
create or replace view semiDown7193267981950391469 as select v28, v37 from semiUp853263425974061032 where (v37) in (select (v37) from semiUp6130635338129518505);
create or replace view semiDown6853100373337113889 as select v37, v10, v23 from semiUp215396392084185311 where (v37) in (select (v37) from semiDown7193267981950391469);
create or replace view semiDown3155941231759124316 as select id as v28, name as v29 from name AS n where (id) in (select (v28) from semiDown7193267981950391469) and gender= 'm';
create or replace view semiDown1403969534914463062 as select v37, v8, v18 from semiUp779976982963768999 where (v37) in (select (v37) from semiDown6853100373337113889);
create or replace view semiDown877834178451848962 as select id as v10 from info_type AS it2 where (id) in (select (v10) from semiDown6853100373337113889) and info= 'votes';
create or replace view semiDown8117342508520900078 as select id as v8 from info_type AS it1 where (id) in (select (v8) from semiDown1403969534914463062) and info= 'genres';
create or replace view semiDown8010861125952446456 as select v37, v12 from semiUp8729606291264337214 where (v37) in (select (v37) from semiDown1403969534914463062);
create or replace view semiDown3806941598211428823 as select id as v12 from keyword AS k where (id) in (select (v12) from semiDown8010861125952446456) and keyword IN ('murder','blood','gore','death','female-nudity');
create or replace view aggView7386655957593065856 as select v12 from semiDown3806941598211428823;
create or replace view aggJoin6779305189021831485 as select v37 from semiDown8010861125952446456 join aggView7386655957593065856 using(v12);
create or replace view aggView7995630552099351966 as select v37 from aggJoin6779305189021831485 group by v37;
create or replace view aggJoin7532594205620147267 as select v37, v8, v18 from semiDown1403969534914463062 join aggView7995630552099351966 using(v37);
create or replace view aggView8278858143439266978 as select v10 from semiDown877834178451848962;
create or replace view aggJoin8680895307492368251 as select v37, v23 from semiDown6853100373337113889 join aggView8278858143439266978 using(v10);
create or replace view aggView8156581180210976479 as select v28, v29 as v51 from semiDown3155941231759124316;
create or replace view aggJoin7811129943794635867 as select v37, v51 from semiDown7193267981950391469 join aggView8156581180210976479 using(v28);
create or replace view aggView2925176287505124936 as select v8 from semiDown8117342508520900078;
create or replace view aggJoin6703758516046076365 as select v37, v18 from aggJoin7532594205620147267 join aggView2925176287505124936 using(v8);
create or replace view aggView3816618253529982000 as select v37, MIN(v18) as v49 from aggJoin6703758516046076365 group by v37;
create or replace view aggJoin5408163977277851594 as select v37, v23, v49 from aggJoin8680895307492368251 join aggView3816618253529982000 using(v37);
create or replace view aggView5327802514215571168 as select v37, MIN(v49) as v49, MIN(v23) as v50 from aggJoin5408163977277851594 group by v37;
create or replace view aggJoin8553987570088043733 as select v37, v51 as v51, v49, v50 from aggJoin7811129943794635867 join aggView5327802514215571168 using(v37);
create or replace view aggView4361834270819450374 as select v37, MIN(v51) as v51, MIN(v49) as v49, MIN(v50) as v50 from aggJoin8553987570088043733 group by v37;
create or replace view aggJoin4652155712024796271 as select v38, v51, v49, v50 from semiUp6130635338129518505 join aggView4361834270819450374 using(v37);
select MIN(v49) as v49,MIN(v50) as v50,MIN(v51) as v51,MIN(v38) as v52 from aggJoin4652155712024796271;
