create or replace view aggView8914389040820292124 as select id as v28, name as v51 from name as n where gender= 'm';
create or replace view aggJoin2559932241570387065 as select movie_id as v37, note as v5, v51 from cast_info as ci, aggView8914389040820292124 where ci.person_id=aggView8914389040820292124.v28 and note IN ('(writer)','(head writer)','(written by)','(story)','(story editor)');
create or replace view aggView4335054637720943457 as select id as v8 from info_type as it1 where info= 'genres';
create or replace view aggJoin6201478124328169901 as select movie_id as v37, info as v18 from movie_info as mi, aggView4335054637720943457 where mi.info_type_id=aggView4335054637720943457.v8 and info= 'Horror';
create or replace view aggView670907256917851512 as select id as v10 from info_type as it2 where info= 'votes';
create or replace view aggJoin2016371861244279662 as select movie_id as v37, info as v23 from movie_info_idx as mi_idx, aggView670907256917851512 where mi_idx.info_type_id=aggView670907256917851512.v10;
create or replace view aggView1585323084314078238 as select v37, MIN(v23) as v50 from aggJoin2016371861244279662 group by v37;
create or replace view aggJoin8968764275342830421 as select id as v37, title as v38, production_year as v41, v50 from title as t, aggView1585323084314078238 where t.id=aggView1585323084314078238.v37 and production_year>2010 and title LIKE 'Vampire%';
create or replace view aggView7926902004959027552 as select v37, MIN(v50) as v50, MIN(v38) as v52 from aggJoin8968764275342830421 group by v37;
create or replace view aggJoin2872929111720783786 as select v37, v18, v50, v52 from aggJoin6201478124328169901 join aggView7926902004959027552 using(v37);
create or replace view aggView9062639205441137528 as select v37, MIN(v50) as v50, MIN(v52) as v52, MIN(v18) as v49 from aggJoin2872929111720783786 group by v37;
create or replace view aggJoin3332157050702006353 as select v37, v5, v51 as v51, v50, v52, v49 from aggJoin2559932241570387065 join aggView9062639205441137528 using(v37);
create or replace view aggView335498003192837559 as select v37, MIN(v51) as v51, MIN(v50) as v50, MIN(v52) as v52, MIN(v49) as v49 from aggJoin3332157050702006353 group by v37;
create or replace view aggJoin7438127662395266043 as select keyword_id as v12, v51, v50, v52, v49 from movie_keyword as mk, aggView335498003192837559 where mk.movie_id=aggView335498003192837559.v37;
create or replace view aggView8669111737366251214 as select v12, MIN(v51) as v51, MIN(v50) as v50, MIN(v52) as v52, MIN(v49) as v49 from aggJoin7438127662395266043 group by v12;
create or replace view aggJoin2568860403110658823 as select keyword as v13, v51, v50, v52, v49 from keyword as k, aggView8669111737366251214 where k.id=aggView8669111737366251214.v12 and keyword IN ('murder','blood','gore','death','female-nudity');
create or replace view res as select MIN(v49) as v49, MIN(v50) as v50, MIN(v51) as v51, MIN(v52) as v52 from aggJoin2568860403110658823;
select sum(v49+v50+v51+v52) from res;