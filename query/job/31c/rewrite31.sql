create or replace view aggView6873878207553978621 as select id as v40, name as v63 from name as n;
create or replace view aggJoin2214840686110748896 as select movie_id as v49, note as v5, v63 from cast_info as ci, aggView6873878207553978621 where ci.person_id=aggView6873878207553978621.v40 and note IN ('(writer)','(head writer)','(written by)','(story)','(story editor)');
create or replace view aggView5713353968460846277 as select id as v15 from info_type as it1 where info= 'genres';
create or replace view aggJoin7467653863557958096 as select movie_id as v49, info as v30 from movie_info as mi, aggView5713353968460846277 where mi.info_type_id=aggView5713353968460846277.v15 and info IN ('Horror','Action','Sci-Fi','Thriller','Crime','War');
create or replace view aggView5770749997563821653 as select v49, MIN(v30) as v61 from aggJoin7467653863557958096 group by v49;
create or replace view aggJoin8516777173915311425 as select id as v49, title as v50, v61 from title as t, aggView5770749997563821653 where t.id=aggView5770749997563821653.v49;
create or replace view aggView7333095531362039713 as select id as v8 from company_name as cn where name LIKE 'Lionsgate%';
create or replace view aggJoin97831402720520336 as select movie_id as v49 from movie_companies as mc, aggView7333095531362039713 where mc.company_id=aggView7333095531362039713.v8;
create or replace view aggView7165024430930242633 as select v49 from aggJoin97831402720520336 group by v49;
create or replace view aggJoin7150946131753275828 as select v49, v5, v63 as v63 from aggJoin2214840686110748896 join aggView7165024430930242633 using(v49);
create or replace view aggView3207051553581899976 as select v49, MIN(v63) as v63 from aggJoin7150946131753275828 group by v49;
create or replace view aggJoin7962726953139368742 as select movie_id as v49, keyword_id as v19, v63 from movie_keyword as mk, aggView3207051553581899976 where mk.movie_id=aggView3207051553581899976.v49;
create or replace view aggView1768443036051997459 as select id as v19 from keyword as k where keyword IN ('murder','violence','blood','gore','death','female-nudity','hospital');
create or replace view aggJoin1110010828277651333 as select v49, v63 from aggJoin7962726953139368742 join aggView1768443036051997459 using(v19);
create or replace view aggView3848482225791321304 as select v49, MIN(v63) as v63 from aggJoin1110010828277651333 group by v49;
create or replace view aggJoin3323299804372882282 as select v49, v50, v61 as v61, v63 from aggJoin8516777173915311425 join aggView3848482225791321304 using(v49);
create or replace view aggView6722627020013084755 as select v49, MIN(v61) as v61, MIN(v63) as v63, MIN(v50) as v64 from aggJoin3323299804372882282 group by v49;
create or replace view aggJoin8976817019585950105 as select info_type_id as v17, info as v35, v61, v63, v64 from movie_info_idx as mi_idx, aggView6722627020013084755 where mi_idx.movie_id=aggView6722627020013084755.v49;
create or replace view aggView3604187569530115896 as select v17, MIN(v61) as v61, MIN(v63) as v63, MIN(v64) as v64, MIN(v35) as v62 from aggJoin8976817019585950105 group by v17;
create or replace view aggJoin8311496446941986170 as select info as v18, v61, v63, v64, v62 from info_type as it2, aggView3604187569530115896 where it2.id=aggView3604187569530115896.v17 and info= 'votes';
create or replace view res as select MIN(v61) as v61, MIN(v62) as v62, MIN(v63) as v63, MIN(v64) as v64 from aggJoin8311496446941986170;
select sum(v61+v62+v63+v64) from res;