create or replace view aggView6118284784606490437 as select id as v18 from keyword as k where keyword= 'character-name-in-title';
create or replace view aggJoin7625633175122098512 as select movie_id as v12 from movie_keyword as mk, aggView6118284784606490437 where mk.keyword_id=aggView6118284784606490437.v18;
create or replace view aggView508475663852339628 as select v12 from aggJoin7625633175122098512 group by v12;
create or replace view aggJoin3787869994696321449 as select id as v12, title as v20 from title as t, aggView508475663852339628 where t.id=aggView508475663852339628.v12;
create or replace view aggView6128194162091230023 as select id as v1 from company_name as cn where country_code= '[sm]';
create or replace view aggJoin3880357369795939624 as select movie_id as v12 from movie_companies as mc, aggView6128194162091230023 where mc.company_id=aggView6128194162091230023.v1;
create or replace view aggView2631455229055718684 as select v12 from aggJoin3880357369795939624 group by v12;
create or replace view aggJoin1822182388192613878 as select v20 from aggJoin3787869994696321449 join aggView2631455229055718684 using(v12);
create or replace view res as select MIN(v20) as v31 from aggJoin1822182388192613878;
select sum(v31) from res;