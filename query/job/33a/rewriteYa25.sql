create or replace view semiUp8128743431314595767 as select id as v49, title as v50, kind_id as v19 from title AS t1 where (kind_id) in (select id from kind_type AS kt1 where kind= 'tv series');
create or replace view semiUp3470786772863423346 as select movie_id as v61, info_type_id as v17, info as v43 from movie_info_idx AS mi_idx2 where (info_type_id) in (select id from info_type AS it2 where info= 'rating') and info<'3.0';
create or replace view semiUp8989803066834127173 as select movie_id as v61, company_id as v8 from movie_companies AS mc2 where (company_id) in (select id from company_name AS cn2);
create or replace view semiUp5050950205093241321 as select movie_id as v49, info_type_id as v15, info as v38 from movie_info_idx AS mi_idx1 where (info_type_id) in (select id from info_type AS it1 where info= 'rating');
create or replace view semiUp8041144189699331026 as select movie_id as v49, company_id as v1 from movie_companies AS mc1 where (company_id) in (select id from company_name AS cn1 where country_code= '[us]');
create or replace view semiUp2804303042365746261 as select id as v61, title as v62, kind_id as v21 from title AS t2 where (id) in (select v61 from semiUp3470786772863423346) and production_year<=2008 and production_year>=2005;
create or replace view semiUp2322400711412266207 as select v49, v50, v19 from semiUp8128743431314595767 where (v49) in (select v49 from semiUp8041144189699331026);
create or replace view semiUp5636954445120087934 as select movie_id as v49, linked_movie_id as v61, link_type_id as v23 from movie_link AS ml where (link_type_id) in (select id from link_type AS lt where link IN ('sequel','follows','followed by'));
create or replace view semiUp5701511441533409023 as select v49, v15, v38 from semiUp5050950205093241321 where (v49) in (select v49 from semiUp2322400711412266207);
create or replace view semiUp1360160058677821532 as select v49, v61, v23 from semiUp5636954445120087934 where (v49) in (select v49 from semiUp5701511441533409023);
create or replace view semiUp5849341282585647740 as select v61, v8 from semiUp8989803066834127173 where (v61) in (select v61 from semiUp1360160058677821532);
create or replace view semiUp3792342468746197631 as select v61, v62, v21 from semiUp2804303042365746261 where (v61) in (select v61 from semiUp5849341282585647740);
create or replace view semiUp5649077376824553479 as select id as v21 from kind_type AS kt2 where (id) in (select v21 from semiUp3792342468746197631) and kind= 'tv series';
create or replace view semiDown5608158070012254368 as select v61, v62, v21 from semiUp3792342468746197631 where (v21) in (select v21 from semiUp5649077376824553479);
create or replace view semiDown9111589520077614085 as select v61, v8 from semiUp5849341282585647740 where (v61) in (select v61 from semiDown5608158070012254368);
create or replace view semiDown8971035204672574879 as select v61, v17, v43 from semiUp3470786772863423346 where (v61) in (select v61 from semiDown5608158070012254368);
create or replace view semiDown3923335252924954494 as select id as v8, name as v9 from company_name AS cn2 where (id) in (select v8 from semiDown9111589520077614085);
create or replace view semiDown6942149905329887567 as select v49, v61, v23 from semiUp1360160058677821532 where (v61) in (select v61 from semiDown9111589520077614085);
create or replace view semiDown381657527432939005 as select id as v17 from info_type AS it2 where (id) in (select v17 from semiDown8971035204672574879) and info= 'rating';
create or replace view semiDown7546321248326722095 as select id as v23 from link_type AS lt where (id) in (select v23 from semiDown6942149905329887567) and link IN ('sequel','follows','followed by');
create or replace view semiDown8017971404804266369 as select v49, v15, v38 from semiUp5701511441533409023 where (v49) in (select v49 from semiDown6942149905329887567);
create or replace view semiDown6069595721655011090 as select v49, v50, v19 from semiUp2322400711412266207 where (v49) in (select v49 from semiDown8017971404804266369);
create or replace view semiDown6506855152575101628 as select id as v15 from info_type AS it1 where (id) in (select v15 from semiDown8017971404804266369) and info= 'rating';
create or replace view semiDown3092275382657452133 as select v49, v1 from semiUp8041144189699331026 where (v49) in (select v49 from semiDown6069595721655011090);
create or replace view semiDown83840569226890496 as select id as v19 from kind_type AS kt1 where (id) in (select v19 from semiDown6069595721655011090) and kind= 'tv series';
create or replace view semiDown1320556795352569997 as select id as v1, name as v2 from company_name AS cn1 where (id) in (select v1 from semiDown3092275382657452133) and country_code= '[us]';
create or replace view aggView5212227578535374661 as select v1, v2 as v73 from semiDown1320556795352569997;
create or replace view aggJoin6898983575523907275 as select v49, v73 from semiDown3092275382657452133 join aggView5212227578535374661 using(v1);
create or replace view aggView5181172316146053366 as select v17 from semiDown381657527432939005;
create or replace view aggJoin7297926250275432302 as select v61, v43 from semiDown8971035204672574879 join aggView5181172316146053366 using(v17);
create or replace view aggView730055037936452672 as select v49, MIN(v73) as v73 from aggJoin6898983575523907275 group by v49;
create or replace view aggJoin1391946543537499353 as select v49, v50, v19, v73 from semiDown6069595721655011090 join aggView730055037936452672 using(v49);
create or replace view aggView7919245497333958344 as select v15 from semiDown6506855152575101628;
create or replace view aggJoin3341864471382970317 as select v49, v38 from semiDown8017971404804266369 join aggView7919245497333958344 using(v15);
create or replace view aggView1707196123831659394 as select v61, MIN(v43) as v76 from aggJoin7297926250275432302 group by v61;
create or replace view aggJoin5775148515782506907 as select v61, v62, v21, v76 from semiDown5608158070012254368 join aggView1707196123831659394 using(v61);
create or replace view aggView7613511518981930774 as select v23 from semiDown7546321248326722095;
create or replace view aggJoin4426955636415070108 as select v49, v61 from semiDown6942149905329887567 join aggView7613511518981930774 using(v23);
create or replace view aggView1144120460785284793 as select v19 from semiDown83840569226890496;
create or replace view aggJoin1185354263570138981 as select v49, v50, v73 from aggJoin1391946543537499353 join aggView1144120460785284793 using(v19);
create or replace view aggView9037900748564761456 as select v49, MIN(v73) as v73, MIN(v50) as v77 from aggJoin1185354263570138981 group by v49;
create or replace view aggJoin7403580722855471867 as select v49, v38, v73, v77 from aggJoin3341864471382970317 join aggView9037900748564761456 using(v49);
create or replace view aggView1032107639458416734 as select v49, MIN(v73) as v73, MIN(v77) as v77, MIN(v38) as v75 from aggJoin7403580722855471867 group by v49;
create or replace view aggJoin6208961059259013876 as select v61, v73, v77, v75 from aggJoin4426955636415070108 join aggView1032107639458416734 using(v49);
create or replace view aggView8971850850752681817 as select v61, MIN(v73) as v73, MIN(v77) as v77, MIN(v75) as v75 from aggJoin6208961059259013876 group by v61;
create or replace view aggJoin6100148779094498598 as select v61, v8, v73, v77, v75 from semiDown9111589520077614085 join aggView8971850850752681817 using(v61);
create or replace view aggView5031827435768582780 as select v8, v9 as v74 from semiDown3923335252924954494;
create or replace view aggJoin6467536363863120356 as select v61, v73, v77, v75, v74 from aggJoin6100148779094498598 join aggView5031827435768582780 using(v8);
create or replace view aggView8260864062919956579 as select v61, MIN(v73) as v73, MIN(v77) as v77, MIN(v75) as v75, MIN(v74) as v74 from aggJoin6467536363863120356 group by v61;
create or replace view aggJoin5233454864451256996 as select v62, v21, v76 as v76, v73, v77, v75, v74 from aggJoin5775148515782506907 join aggView8260864062919956579 using(v61);
create or replace view aggView242817141658012961 as select v21, MIN(v76) as v76, MIN(v73) as v73, MIN(v77) as v77, MIN(v75) as v75, MIN(v74) as v74, MIN(v62) as v78 from aggJoin5233454864451256996 group by v21;
create or replace view aggJoin2334958610035630016 as select v76, v73, v77, v75, v74, v78 from semiUp5649077376824553479 join aggView242817141658012961 using(v21);
create or replace view res as select MIN(v73) as v73, MIN(v74) as v74, MIN(v75) as v75, MIN(v76) as v76, MIN(v77) as v77, MIN(v78) as v78 from aggJoin2334958610035630016;
select sum(v73+v74+v75+v76+v77+v78) from res;
