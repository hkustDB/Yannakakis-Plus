create or replace view aggView6012714479170455945 as select id as v8, name as v74 from company_name as cn2;
create or replace view aggJoin2350146226482542721 as select movie_id as v61, v74 from movie_companies as mc2, aggView6012714479170455945 where mc2.company_id=aggView6012714479170455945.v8;
create or replace view aggView4389541709303402904 as select id as v1, name as v73 from company_name as cn1 where country_code= '[us]';
create or replace view aggJoin3510396149892915030 as select movie_id as v49, v73 from movie_companies as mc1, aggView4389541709303402904 where mc1.company_id=aggView4389541709303402904.v1;
create or replace view aggView8191342515807124290 as select id as v19 from kind_type as kt1 where kind= 'tv series';
create or replace view aggJoin8592848519082775678 as select id as v49, title as v50 from title as t1, aggView8191342515807124290 where t1.kind_id=aggView8191342515807124290.v19;
create or replace view aggView7203237733677224429 as select v49, MIN(v50) as v77 from aggJoin8592848519082775678 group by v49;
create or replace view aggJoin3052561011456005381 as select movie_id as v49, info_type_id as v15, info as v38, v77 from movie_info_idx as mi_idx1, aggView7203237733677224429 where mi_idx1.movie_id=aggView7203237733677224429.v49;
create or replace view aggView7440638978188476044 as select id as v17 from info_type as it2 where info= 'rating';
create or replace view aggJoin1087087084043145409 as select movie_id as v61, info as v43 from movie_info_idx as mi_idx2, aggView7440638978188476044 where mi_idx2.info_type_id=aggView7440638978188476044.v17 and info<'3.0';
create or replace view aggView5363412089947052493 as select id as v23 from link_type as lt where link IN ('sequel','follows','followed by');
create or replace view aggJoin4842537914116626275 as select movie_id as v49, linked_movie_id as v61 from movie_link as ml, aggView5363412089947052493 where ml.link_type_id=aggView5363412089947052493.v23;
create or replace view aggView8428773709874226293 as select id as v21 from kind_type as kt2 where kind= 'tv series';
create or replace view aggJoin6705607375538908644 as select id as v61, title as v62 from title as t2, aggView8428773709874226293 where t2.kind_id=aggView8428773709874226293.v21 and production_year<=2008 and production_year>=2005;
create or replace view aggView4538343702249755929 as select v61, MIN(v62) as v78 from aggJoin6705607375538908644 group by v61;
create or replace view aggJoin3881258192192189030 as select v61, v74 as v74, v78 from aggJoin2350146226482542721 join aggView4538343702249755929 using(v61);
create or replace view aggView6949377325360302358 as select v61, MIN(v74) as v74, MIN(v78) as v78 from aggJoin3881258192192189030 group by v61;
create or replace view aggJoin8060541300228321367 as select v61, v43, v74, v78 from aggJoin1087087084043145409 join aggView6949377325360302358 using(v61);
create or replace view aggView9171169542279873236 as select v61, MIN(v74) as v74, MIN(v78) as v78, MIN(v43) as v76 from aggJoin8060541300228321367 group by v61;
create or replace view aggJoin7270704925219067671 as select v49, v74, v78, v76 from aggJoin4842537914116626275 join aggView9171169542279873236 using(v61);
create or replace view aggView7247642294078319171 as select v49, MIN(v74) as v74, MIN(v78) as v78, MIN(v76) as v76 from aggJoin7270704925219067671 group by v49;
create or replace view aggJoin2198426840535481880 as select v49, v73 as v73, v74, v78, v76 from aggJoin3510396149892915030 join aggView7247642294078319171 using(v49);
create or replace view aggView4090059373936431884 as select v49, MIN(v73) as v73, MIN(v74) as v74, MIN(v78) as v78, MIN(v76) as v76 from aggJoin2198426840535481880 group by v49;
create or replace view aggJoin7547473143539382196 as select v15, v38, v77 as v77, v73, v74, v78, v76 from aggJoin3052561011456005381 join aggView4090059373936431884 using(v49);
create or replace view aggView1918581915767482631 as select v15, MIN(v77) as v77, MIN(v73) as v73, MIN(v74) as v74, MIN(v78) as v78, MIN(v76) as v76, MIN(v38) as v75 from aggJoin7547473143539382196 group by v15;
create or replace view aggJoin2393262366289444295 as select v77, v73, v74, v78, v76, v75 from info_type as it1, aggView1918581915767482631 where it1.id=aggView1918581915767482631.v15 and info= 'rating';
create or replace view res as select MIN(v73) as v73, MIN(v74) as v74, MIN(v75) as v75, MIN(v76) as v76, MIN(v77) as v77, MIN(v78) as v78 from aggJoin2393262366289444295;
select sum(v73+v74+v75+v76+v77+v78) from res;