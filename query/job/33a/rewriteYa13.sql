create or replace view semiUp997644252730756137 as select movie_id as v49, company_id as v1 from movie_companies AS mc1 where (company_id) in (select id from company_name AS cn1 where country_code= '[us]');
create or replace view semiUp6537796776326545878 as select movie_id as v61, company_id as v8 from movie_companies AS mc2 where (company_id) in (select id from company_name AS cn2);
create or replace view semiUp82067992639217433 as select movie_id as v61, info_type_id as v17, info as v43 from movie_info_idx AS mi_idx2 where (movie_id) in (select v61 from semiUp6537796776326545878) and info<'3.0';
create or replace view semiUp5590637042821029262 as select movie_id as v49, linked_movie_id as v61, link_type_id as v23 from movie_link AS ml where (link_type_id) in (select id from link_type AS lt where link IN ('sequel','follows','followed by'));
create or replace view semiUp112291956715374113 as select movie_id as v49, info_type_id as v15, info as v38 from movie_info_idx AS mi_idx1 where (info_type_id) in (select id from info_type AS it1 where info= 'rating');
create or replace view semiUp7038852421250152543 as select v61, v17, v43 from semiUp82067992639217433 where (v17) in (select id from info_type AS it2 where info= 'rating');
create or replace view semiUp503900849930807556 as select id as v49, title as v50, kind_id as v19 from title AS t1 where (kind_id) in (select id from kind_type AS kt1 where kind= 'tv series');
create or replace view semiUp1453278250553218503 as select id as v61, title as v62, kind_id as v21 from title AS t2 where (id) in (select v61 from semiUp7038852421250152543) and production_year<=2008 and production_year>=2005;
create or replace view semiUp4239467651620253414 as select v49, v1 from semiUp997644252730756137 where (v49) in (select v49 from semiUp503900849930807556);
create or replace view semiUp465158939039782590 as select v49, v15, v38 from semiUp112291956715374113 where (v49) in (select v49 from semiUp4239467651620253414);
create or replace view semiUp8120558642645330141 as select v49, v61, v23 from semiUp5590637042821029262 where (v49) in (select v49 from semiUp465158939039782590);
create or replace view semiUp8714785549370557943 as select v61, v62, v21 from semiUp1453278250553218503 where (v61) in (select v61 from semiUp8120558642645330141);
create or replace view semiUp307076777186276944 as select id as v21 from kind_type AS kt2 where (id) in (select v21 from semiUp8714785549370557943) and kind= 'tv series';
create or replace view semiDown6407077425942443586 as select v61, v62, v21 from semiUp8714785549370557943 where (v21) in (select v21 from semiUp307076777186276944);
create or replace view semiDown7821507516919126545 as select v49, v61, v23 from semiUp8120558642645330141 where (v61) in (select v61 from semiDown6407077425942443586);
create or replace view semiDown6565604241336172449 as select v61, v17, v43 from semiUp7038852421250152543 where (v61) in (select v61 from semiDown6407077425942443586);
create or replace view semiDown547056175398015606 as select id as v23 from link_type AS lt where (id) in (select v23 from semiDown7821507516919126545) and link IN ('sequel','follows','followed by');
create or replace view semiDown599892003732206616 as select v49, v15, v38 from semiUp465158939039782590 where (v49) in (select v49 from semiDown7821507516919126545);
create or replace view semiDown8180154074563632578 as select v61, v8 from semiUp6537796776326545878 where (v61) in (select v61 from semiDown6565604241336172449);
create or replace view semiDown5042740740482934482 as select id as v17 from info_type AS it2 where (id) in (select v17 from semiDown6565604241336172449) and info= 'rating';
create or replace view semiDown5550165464358299251 as select v49, v1 from semiUp4239467651620253414 where (v49) in (select v49 from semiDown599892003732206616);
create or replace view semiDown2721625599585240707 as select id as v15 from info_type AS it1 where (id) in (select v15 from semiDown599892003732206616) and info= 'rating';
create or replace view semiDown5919982583769621422 as select id as v8, name as v9 from company_name AS cn2 where (id) in (select v8 from semiDown8180154074563632578);
create or replace view semiDown5648177001071768928 as select v49, v50, v19 from semiUp503900849930807556 where (v49) in (select v49 from semiDown5550165464358299251);
create or replace view semiDown2751681772911209164 as select id as v1, name as v2 from company_name AS cn1 where (id) in (select v1 from semiDown5550165464358299251) and country_code= '[us]';
create or replace view semiDown4140059375586925759 as select id as v19 from kind_type AS kt1 where (id) in (select v19 from semiDown5648177001071768928) and kind= 'tv series';
create or replace view aggView4230463549595246926 as select v15 from semiDown2721625599585240707;
create or replace view aggJoin6454509078650216114 as select v49, v38 from semiDown599892003732206616 join aggView4230463549595246926 using(v15);
create or replace view aggView6363778905345381732 as select v23 from semiDown547056175398015606;
create or replace view aggJoin5714435390980199223 as select v49, v61 from semiDown7821507516919126545 join aggView6363778905345381732 using(v23);
create or replace view aggView6041941958480609829 as select v1, v2 as v73 from semiDown2751681772911209164;
create or replace view aggJoin1117643145099479686 as select v49, v73 from semiDown5550165464358299251 join aggView6041941958480609829 using(v1);
create or replace view aggView2687854293285905698 as select v8, v9 as v74 from semiDown5919982583769621422;
create or replace view aggJoin699656136374536640 as select v61, v74 from semiDown8180154074563632578 join aggView2687854293285905698 using(v8);
create or replace view aggView4446732184966441349 as select v19 from semiDown4140059375586925759;
create or replace view aggJoin3880115532802078334 as select v49, v50 from semiDown5648177001071768928 join aggView4446732184966441349 using(v19);
create or replace view aggView3933508494148851816 as select v49, MIN(v50) as v77 from aggJoin3880115532802078334 group by v49;
create or replace view aggJoin7852719446516616225 as select v49, v73 as v73, v77 from aggJoin1117643145099479686 join aggView3933508494148851816 using(v49);
create or replace view aggView2914248053126047958 as select v49, MIN(v73) as v73, MIN(v77) as v77 from aggJoin7852719446516616225 group by v49;
create or replace view aggJoin4870271932986726704 as select v49, v38, v73, v77 from aggJoin6454509078650216114 join aggView2914248053126047958 using(v49);
create or replace view aggView5064015198861518138 as select v17 from semiDown5042740740482934482;
create or replace view aggJoin7829267128360509773 as select v61, v43 from semiDown6565604241336172449 join aggView5064015198861518138 using(v17);
create or replace view aggView6695820138501676769 as select v61, MIN(v74) as v74 from aggJoin699656136374536640 group by v61;
create or replace view aggJoin5240876929697391036 as select v61, v43, v74 from aggJoin7829267128360509773 join aggView6695820138501676769 using(v61);
create or replace view aggView2607938648334653328 as select v49, MIN(v73) as v73, MIN(v77) as v77, MIN(v38) as v75 from aggJoin4870271932986726704 group by v49;
create or replace view aggJoin7576128929985039014 as select v61, v73, v77, v75 from aggJoin5714435390980199223 join aggView2607938648334653328 using(v49);
create or replace view aggView7257223146705414916 as select v61, MIN(v73) as v73, MIN(v77) as v77, MIN(v75) as v75 from aggJoin7576128929985039014 group by v61;
create or replace view aggJoin56163350887145539 as select v61, v62, v21, v73, v77, v75 from semiDown6407077425942443586 join aggView7257223146705414916 using(v61);
create or replace view aggView9216750688735607244 as select v61, MIN(v74) as v74, MIN(v43) as v76 from aggJoin5240876929697391036 group by v61;
create or replace view aggJoin7454225613478411241 as select v62, v21, v73 as v73, v77 as v77, v75 as v75, v74, v76 from aggJoin56163350887145539 join aggView9216750688735607244 using(v61);
create or replace view aggView7783366175591526766 as select v21, MIN(v73) as v73, MIN(v77) as v77, MIN(v75) as v75, MIN(v74) as v74, MIN(v76) as v76, MIN(v62) as v78 from aggJoin7454225613478411241 group by v21;
create or replace view aggJoin8879341649239547043 as select v73, v77, v75, v74, v76, v78 from semiUp307076777186276944 join aggView7783366175591526766 using(v21);
create or replace view res as select MIN(v73) as v73, MIN(v74) as v74, MIN(v75) as v75, MIN(v76) as v76, MIN(v77) as v77, MIN(v78) as v78 from aggJoin8879341649239547043;
select sum(v73+v74+v75+v76+v77+v78) from res;
