create or replace view semiUp2058250198079288884 as select movie_id as v49, company_id as v1 from movie_companies AS mc1 where (company_id) in (select id from company_name AS cn1 where country_code= '[us]');
create or replace view semiUp3991873485241811141 as select id as v49, title as v50, kind_id as v19 from title AS t1 where (kind_id) in (select id from kind_type AS kt1 where kind= 'tv series');
create or replace view semiUp9163135873888957935 as select movie_id as v61, info_type_id as v17, info as v43 from movie_info_idx AS mi_idx2 where (info_type_id) in (select id from info_type AS it2 where info= 'rating') and info<'3.0';
create or replace view semiUp6734351958787470228 as select id as v61, title as v62, kind_id as v21 from title AS t2 where (kind_id) in (select id from kind_type AS kt2 where kind= 'tv series') and production_year<=2008 and production_year>=2005;
create or replace view semiUp4847003649335961187 as select movie_id as v49, info_type_id as v15, info as v38 from movie_info_idx AS mi_idx1 where (movie_id) in (select v49 from semiUp3991873485241811141);
create or replace view semiUp1817347637334035885 as select movie_id as v61, company_id as v8 from movie_companies AS mc2 where (company_id) in (select id from company_name AS cn2);
create or replace view semiUp8950933015710788273 as select v61, v17, v43 from semiUp9163135873888957935 where (v61) in (select v61 from semiUp1817347637334035885);
create or replace view semiUp2719492342809034587 as select v61, v62, v21 from semiUp6734351958787470228 where (v61) in (select v61 from semiUp8950933015710788273);
create or replace view semiUp825872941329868301 as select v49, v15, v38 from semiUp4847003649335961187 where (v15) in (select id from info_type AS it1 where info= 'rating');
create or replace view semiUp5113880744745331294 as select movie_id as v49, linked_movie_id as v61, link_type_id as v23 from movie_link AS ml where (linked_movie_id) in (select v61 from semiUp2719492342809034587);
create or replace view semiUp3724713352832762376 as select v49, v1 from semiUp2058250198079288884 where (v49) in (select v49 from semiUp825872941329868301);
create or replace view semiUp7553319139968514584 as select v49, v61, v23 from semiUp5113880744745331294 where (v49) in (select v49 from semiUp3724713352832762376);
create or replace view semiUp9100520118800888216 as select id as v23 from link_type AS lt where (id) in (select v23 from semiUp7553319139968514584) and link IN ('sequel','follows','followed by');
create or replace view semiDown735862809750629586 as select v49, v61, v23 from semiUp7553319139968514584 where (v23) in (select v23 from semiUp9100520118800888216);
create or replace view semiDown4980704133758471801 as select v61, v62, v21 from semiUp2719492342809034587 where (v61) in (select v61 from semiDown735862809750629586);
create or replace view semiDown7772933869222176518 as select v49, v1 from semiUp3724713352832762376 where (v49) in (select v49 from semiDown735862809750629586);
create or replace view semiDown4431733189707083949 as select v61, v17, v43 from semiUp8950933015710788273 where (v61) in (select v61 from semiDown4980704133758471801);
create or replace view semiDown7848777152346038804 as select id as v21 from kind_type AS kt2 where (id) in (select v21 from semiDown4980704133758471801) and kind= 'tv series';
create or replace view semiDown8651097342940558374 as select v49, v15, v38 from semiUp825872941329868301 where (v49) in (select v49 from semiDown7772933869222176518);
create or replace view semiDown6232930056791537577 as select id as v1, name as v2 from company_name AS cn1 where (id) in (select v1 from semiDown7772933869222176518) and country_code= '[us]';
create or replace view semiDown1996666850705800565 as select v61, v8 from semiUp1817347637334035885 where (v61) in (select v61 from semiDown4431733189707083949);
create or replace view semiDown3192479247252507197 as select id as v17 from info_type AS it2 where (id) in (select v17 from semiDown4431733189707083949) and info= 'rating';
create or replace view semiDown9209048238695950594 as select v49, v50, v19 from semiUp3991873485241811141 where (v49) in (select v49 from semiDown8651097342940558374);
create or replace view semiDown6646941156520258657 as select id as v15 from info_type AS it1 where (id) in (select v15 from semiDown8651097342940558374) and info= 'rating';
create or replace view semiDown130254929518687161 as select id as v8, name as v9 from company_name AS cn2 where (id) in (select v8 from semiDown1996666850705800565);
create or replace view semiDown1838673294070227579 as select id as v19 from kind_type AS kt1 where (id) in (select v19 from semiDown9209048238695950594) and kind= 'tv series';
create or replace view aggView8014355211507055953 as select v21 from semiDown7848777152346038804;
create or replace view aggJoin6822985149738380163 as select v61, v62 from semiDown4980704133758471801 join aggView8014355211507055953 using(v21);
create or replace view aggView3794631527315551531 as select v8, v9 as v74 from semiDown130254929518687161;
create or replace view aggJoin7924940318042403070 as select v61, v74 from semiDown1996666850705800565 join aggView3794631527315551531 using(v8);
create or replace view aggView6803125836450694219 as select v15 from semiDown6646941156520258657;
create or replace view aggJoin160639819349563806 as select v49, v38 from semiDown8651097342940558374 join aggView6803125836450694219 using(v15);
create or replace view aggView3839319058042334760 as select v61, MIN(v74) as v74 from aggJoin7924940318042403070 group by v61;
create or replace view aggJoin4672413044367816280 as select v61, v17, v43, v74 from semiDown4431733189707083949 join aggView3839319058042334760 using(v61);
create or replace view aggView8272549981391515055 as select v1, v2 as v73 from semiDown6232930056791537577;
create or replace view aggJoin9085079443374068944 as select v49, v73 from semiDown7772933869222176518 join aggView8272549981391515055 using(v1);
create or replace view aggView7952260101982414620 as select v17 from semiDown3192479247252507197;
create or replace view aggJoin3719387873510198573 as select v61, v43, v74 from aggJoin4672413044367816280 join aggView7952260101982414620 using(v17);
create or replace view aggView5041554982436803160 as select v61, MIN(v74) as v74, MIN(v43) as v76 from aggJoin3719387873510198573 group by v61;
create or replace view aggJoin2123832362331706976 as select v61, v62, v74, v76 from aggJoin6822985149738380163 join aggView5041554982436803160 using(v61);
create or replace view aggView3299688759489744653 as select v19 from semiDown1838673294070227579;
create or replace view aggJoin4163396101689309133 as select v49, v50 from semiDown9209048238695950594 join aggView3299688759489744653 using(v19);
create or replace view aggView5276076757794462384 as select v49, MIN(v50) as v77 from aggJoin4163396101689309133 group by v49;
create or replace view aggJoin6162927408664560228 as select v49, v38, v77 from aggJoin160639819349563806 join aggView5276076757794462384 using(v49);
create or replace view aggView8725518457922245217 as select v61, MIN(v74) as v74, MIN(v76) as v76, MIN(v62) as v78 from aggJoin2123832362331706976 group by v61;
create or replace view aggJoin1041019323013842808 as select v49, v23, v74, v76, v78 from semiDown735862809750629586 join aggView8725518457922245217 using(v61);
create or replace view aggView3056264219828546992 as select v49, MIN(v77) as v77, MIN(v38) as v75 from aggJoin6162927408664560228 group by v49;
create or replace view aggJoin4539795001805247929 as select v49, v73 as v73, v77, v75 from aggJoin9085079443374068944 join aggView3056264219828546992 using(v49);
create or replace view aggView4939286776483345809 as select v49, MIN(v73) as v73, MIN(v77) as v77, MIN(v75) as v75 from aggJoin4539795001805247929 group by v49;
create or replace view aggJoin147443721383051232 as select v23, v74 as v74, v76 as v76, v78 as v78, v73, v77, v75 from aggJoin1041019323013842808 join aggView4939286776483345809 using(v49);
create or replace view aggView4468342655915734813 as select v23, MIN(v74) as v74, MIN(v76) as v76, MIN(v78) as v78, MIN(v73) as v73, MIN(v77) as v77, MIN(v75) as v75 from aggJoin147443721383051232 group by v23;
create or replace view aggJoin8836896445348876021 as select v74, v76, v78, v73, v77, v75 from semiUp9100520118800888216 join aggView4468342655915734813 using(v23);
create or replace view res as select MIN(v73) as v73, MIN(v74) as v74, MIN(v75) as v75, MIN(v76) as v76, MIN(v77) as v77, MIN(v78) as v78 from aggJoin8836896445348876021;
select sum(v73+v74+v75+v76+v77+v78) from res;
