create or replace view aggView3491968250852442415 as select id as v8, name as v74 from company_name as cn2;
create or replace view aggJoin2047551832730360709 as select movie_id as v61, v74 from movie_companies as mc2, aggView3491968250852442415 where mc2.company_id=aggView3491968250852442415.v8;
create or replace view aggView6186017914946795541 as select id as v1, name as v73 from company_name as cn1 where country_code= '[us]';
create or replace view aggJoin7098831686063991766 as select movie_id as v49, v73 from movie_companies as mc1, aggView6186017914946795541 where mc1.company_id=aggView6186017914946795541.v1;
create or replace view aggView6216671490984477917 as select id as v19 from kind_type as kt1 where kind= 'tv series';
create or replace view aggJoin6795437452207966919 as select id as v49, title as v50 from title as t1, aggView6216671490984477917 where t1.kind_id=aggView6216671490984477917.v19;
create or replace view aggView6996024162179489225 as select id as v17 from info_type as it2 where info= 'rating';
create or replace view aggJoin5986900983215691063 as select movie_id as v61, info as v43 from movie_info_idx as mi_idx2, aggView6996024162179489225 where mi_idx2.info_type_id=aggView6996024162179489225.v17 and info<'3.0';
create or replace view aggView7415258463736172423 as select id as v23 from link_type as lt where link IN ('sequel','follows','followed by');
create or replace view aggJoin1888644008960527536 as select movie_id as v49, linked_movie_id as v61 from movie_link as ml, aggView7415258463736172423 where ml.link_type_id=aggView7415258463736172423.v23;
create or replace view aggView4364989544229951702 as select id as v15 from info_type as it1 where info= 'rating';
create or replace view aggJoin7526080435782575339 as select movie_id as v49, info as v38 from movie_info_idx as mi_idx1, aggView4364989544229951702 where mi_idx1.info_type_id=aggView4364989544229951702.v15;
create or replace view aggView1856159274837116638 as select v49, MIN(v38) as v75 from aggJoin7526080435782575339 group by v49;
create or replace view aggJoin8574645109335528994 as select v49, v50, v75 from aggJoin6795437452207966919 join aggView1856159274837116638 using(v49);
create or replace view aggView619321033566177842 as select v49, MIN(v75) as v75, MIN(v50) as v77 from aggJoin8574645109335528994 group by v49;
create or replace view aggJoin5207735999902179988 as select v49, v73 as v73, v75, v77 from aggJoin7098831686063991766 join aggView619321033566177842 using(v49);
create or replace view aggView6791418841096382650 as select v49, MIN(v73) as v73, MIN(v75) as v75, MIN(v77) as v77 from aggJoin5207735999902179988 group by v49;
create or replace view aggJoin4385198943024784156 as select v61, v73, v75, v77 from aggJoin1888644008960527536 join aggView6791418841096382650 using(v49);
create or replace view aggView3949373182944735537 as select v61, MIN(v73) as v73, MIN(v75) as v75, MIN(v77) as v77 from aggJoin4385198943024784156 group by v61;
create or replace view aggJoin3318215116302887582 as select id as v61, title as v62, kind_id as v21, v73, v75, v77 from title as t2, aggView3949373182944735537 where t2.id=aggView3949373182944735537.v61 and production_year<=2008 and production_year>=2005;
create or replace view aggView4709149531208305885 as select v61, MIN(v74) as v74 from aggJoin2047551832730360709 group by v61;
create or replace view aggJoin2710215386417740498 as select v61, v43, v74 from aggJoin5986900983215691063 join aggView4709149531208305885 using(v61);
create or replace view aggView2147993954911140677 as select v61, MIN(v74) as v74, MIN(v43) as v76 from aggJoin2710215386417740498 group by v61;
create or replace view aggJoin7218336001153451094 as select v62, v21, v73 as v73, v75 as v75, v77 as v77, v74, v76 from aggJoin3318215116302887582 join aggView2147993954911140677 using(v61);
create or replace view aggView3284531143974804943 as select v21, MIN(v73) as v73, MIN(v75) as v75, MIN(v77) as v77, MIN(v74) as v74, MIN(v76) as v76, MIN(v62) as v78 from aggJoin7218336001153451094 group by v21;
create or replace view aggJoin3541003126297620527 as select v73, v75, v77, v74, v76, v78 from kind_type as kt2, aggView3284531143974804943 where kt2.id=aggView3284531143974804943.v21 and kind= 'tv series';
create or replace view res as select MIN(v73) as v73, MIN(v74) as v74, MIN(v75) as v75, MIN(v76) as v76, MIN(v77) as v77, MIN(v78) as v78 from aggJoin3541003126297620527;
select sum(v73+v74+v75+v76+v77+v78) from res;