create or replace view aggView3115556205909532721 as select id as v8, name as v74 from company_name as cn2;
create or replace view aggJoin1367028922971393574 as select movie_id as v61, v74 from movie_companies as mc2, aggView3115556205909532721 where mc2.company_id=aggView3115556205909532721.v8;
create or replace view aggView2876326811595110341 as select id as v1, name as v73 from company_name as cn1 where country_code= '[us]';
create or replace view aggJoin844520202469135068 as select movie_id as v49, v73 from movie_companies as mc1, aggView2876326811595110341 where mc1.company_id=aggView2876326811595110341.v1;
create or replace view aggView7522649185773724372 as select id as v19 from kind_type as kt1 where kind= 'tv series';
create or replace view aggJoin2273830987301779220 as select id as v49, title as v50 from title as t1, aggView7522649185773724372 where t1.kind_id=aggView7522649185773724372.v19;
create or replace view aggView6403806225556857435 as select id as v17 from info_type as it2 where info= 'rating';
create or replace view aggJoin8551077571308775856 as select movie_id as v61, info as v43 from movie_info_idx as mi_idx2, aggView6403806225556857435 where mi_idx2.info_type_id=aggView6403806225556857435.v17 and info<'3.0';
create or replace view aggView7464441813188278029 as select v61, MIN(v43) as v76 from aggJoin8551077571308775856 group by v61;
create or replace view aggJoin746196438770726264 as select v61, v74 as v74, v76 from aggJoin1367028922971393574 join aggView7464441813188278029 using(v61);
create or replace view aggView3313728500125995761 as select id as v23 from link_type as lt where link IN ('sequel','follows','followed by');
create or replace view aggJoin3753823779020473318 as select movie_id as v49, linked_movie_id as v61 from movie_link as ml, aggView3313728500125995761 where ml.link_type_id=aggView3313728500125995761.v23;
create or replace view aggView467062260459012132 as select v61, MIN(v74) as v74, MIN(v76) as v76 from aggJoin746196438770726264 group by v61;
create or replace view aggJoin2065930664960476913 as select id as v61, title as v62, kind_id as v21, v74, v76 from title as t2, aggView467062260459012132 where t2.id=aggView467062260459012132.v61 and production_year<=2008 and production_year>=2005;
create or replace view aggView4388442420424157255 as select id as v21 from kind_type as kt2 where kind= 'tv series';
create or replace view aggJoin5582155524028841534 as select v61, v62, v74, v76 from aggJoin2065930664960476913 join aggView4388442420424157255 using(v21);
create or replace view aggView4615269774138669792 as select v61, MIN(v74) as v74, MIN(v76) as v76, MIN(v62) as v78 from aggJoin5582155524028841534 group by v61;
create or replace view aggJoin5511480862785856799 as select v49, v74, v76, v78 from aggJoin3753823779020473318 join aggView4615269774138669792 using(v61);
create or replace view aggView378227847603569156 as select v49, MIN(v74) as v74, MIN(v76) as v76, MIN(v78) as v78 from aggJoin5511480862785856799 group by v49;
create or replace view aggJoin1091240318540567634 as select v49, v73 as v73, v74, v76, v78 from aggJoin844520202469135068 join aggView378227847603569156 using(v49);
create or replace view aggView4078422280834141742 as select v49, MIN(v73) as v73, MIN(v74) as v74, MIN(v76) as v76, MIN(v78) as v78 from aggJoin1091240318540567634 group by v49;
create or replace view aggJoin5549922680869653055 as select v49, v50, v73, v74, v76, v78 from aggJoin2273830987301779220 join aggView4078422280834141742 using(v49);
create or replace view aggView6502390380684516844 as select v49, MIN(v73) as v73, MIN(v74) as v74, MIN(v76) as v76, MIN(v78) as v78, MIN(v50) as v77 from aggJoin5549922680869653055 group by v49;
create or replace view aggJoin6080135064316628072 as select info_type_id as v15, info as v38, v73, v74, v76, v78, v77 from movie_info_idx as mi_idx1, aggView6502390380684516844 where mi_idx1.movie_id=aggView6502390380684516844.v49;
create or replace view aggView8414740855569206882 as select v15, MIN(v73) as v73, MIN(v74) as v74, MIN(v76) as v76, MIN(v78) as v78, MIN(v77) as v77, MIN(v38) as v75 from aggJoin6080135064316628072 group by v15;
create or replace view aggJoin2872631435830087047 as select v73, v74, v76, v78, v77, v75 from info_type as it1, aggView8414740855569206882 where it1.id=aggView8414740855569206882.v15 and info= 'rating';
create or replace view res as select MIN(v73) as v73, MIN(v74) as v74, MIN(v75) as v75, MIN(v76) as v76, MIN(v77) as v77, MIN(v78) as v78 from aggJoin2872631435830087047;
select sum(v73+v74+v75+v76+v77+v78) from res;