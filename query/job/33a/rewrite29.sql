create or replace view aggView2774183066984254206 as select id as v8, name as v74 from company_name as cn2;
create or replace view aggJoin1759619076934777594 as select movie_id as v61, v74 from movie_companies as mc2, aggView2774183066984254206 where mc2.company_id=aggView2774183066984254206.v8;
create or replace view aggView6265784854885810121 as select id as v1, name as v73 from company_name as cn1 where country_code= '[us]';
create or replace view aggJoin1023735890769744468 as select movie_id as v49, v73 from movie_companies as mc1, aggView6265784854885810121 where mc1.company_id=aggView6265784854885810121.v1;
create or replace view aggView7844711019391578653 as select id as v17 from info_type as it2 where info= 'rating';
create or replace view aggJoin5277845004733165637 as select movie_id as v61, info as v43 from movie_info_idx as mi_idx2, aggView7844711019391578653 where mi_idx2.info_type_id=aggView7844711019391578653.v17 and info<'3.0';
create or replace view aggView9021969017108468971 as select id as v23 from link_type as lt where link IN ('sequel','follows','followed by');
create or replace view aggJoin6913237595065041489 as select movie_id as v49, linked_movie_id as v61 from movie_link as ml, aggView9021969017108468971 where ml.link_type_id=aggView9021969017108468971.v23;
create or replace view aggView6638134059547050014 as select id as v15 from info_type as it1 where info= 'rating';
create or replace view aggJoin3957759686558679536 as select movie_id as v49, info as v38 from movie_info_idx as mi_idx1, aggView6638134059547050014 where mi_idx1.info_type_id=aggView6638134059547050014.v15;
create or replace view aggView7313650171482956830 as select v49, MIN(v38) as v75 from aggJoin3957759686558679536 group by v49;
create or replace view aggJoin981566570552622118 as select v49, v73 as v73, v75 from aggJoin1023735890769744468 join aggView7313650171482956830 using(v49);
create or replace view aggView7981822157102204115 as select id as v21 from kind_type as kt2 where kind= 'tv series';
create or replace view aggJoin1805255240876065227 as select id as v61, title as v62 from title as t2, aggView7981822157102204115 where t2.kind_id=aggView7981822157102204115.v21 and production_year<=2008 and production_year>=2005;
create or replace view aggView8551625629752150393 as select v61, MIN(v62) as v78 from aggJoin1805255240876065227 group by v61;
create or replace view aggJoin2835290218082533530 as select v61, v43, v78 from aggJoin5277845004733165637 join aggView8551625629752150393 using(v61);
create or replace view aggView5210105958229283970 as select v61, MIN(v78) as v78, MIN(v43) as v76 from aggJoin2835290218082533530 group by v61;
create or replace view aggJoin5680353303002099053 as select v61, v74 as v74, v78, v76 from aggJoin1759619076934777594 join aggView5210105958229283970 using(v61);
create or replace view aggView33550762054241926 as select v61, MIN(v74) as v74, MIN(v78) as v78, MIN(v76) as v76 from aggJoin5680353303002099053 group by v61;
create or replace view aggJoin3524630949870493359 as select v49, v74, v78, v76 from aggJoin6913237595065041489 join aggView33550762054241926 using(v61);
create or replace view aggView8675356273249894671 as select v49, MIN(v74) as v74, MIN(v78) as v78, MIN(v76) as v76 from aggJoin3524630949870493359 group by v49;
create or replace view aggJoin3320932331008323743 as select id as v49, title as v50, kind_id as v19, v74, v78, v76 from title as t1, aggView8675356273249894671 where t1.id=aggView8675356273249894671.v49;
create or replace view aggView6874020020946557551 as select v49, MIN(v73) as v73, MIN(v75) as v75 from aggJoin981566570552622118 group by v49;
create or replace view aggJoin3123987903518377037 as select v50, v19, v74 as v74, v78 as v78, v76 as v76, v73, v75 from aggJoin3320932331008323743 join aggView6874020020946557551 using(v49);
create or replace view aggView2398539439142866507 as select v19, MIN(v74) as v74, MIN(v78) as v78, MIN(v76) as v76, MIN(v73) as v73, MIN(v75) as v75, MIN(v50) as v77 from aggJoin3123987903518377037 group by v19;
create or replace view aggJoin1948825555707106633 as select v74, v78, v76, v73, v75, v77 from kind_type as kt1, aggView2398539439142866507 where kt1.id=aggView2398539439142866507.v19 and kind= 'tv series';
create or replace view res as select MIN(v73) as v73, MIN(v74) as v74, MIN(v75) as v75, MIN(v76) as v76, MIN(v77) as v77, MIN(v78) as v78 from aggJoin1948825555707106633;
select sum(v73+v74+v75+v76+v77+v78) from res;