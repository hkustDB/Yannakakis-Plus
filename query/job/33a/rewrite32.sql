create or replace view aggView8947101400857370369 as select id as v8, name as v74 from company_name as cn2;
create or replace view aggJoin3000705460722075225 as select movie_id as v61, v74 from movie_companies as mc2, aggView8947101400857370369 where mc2.company_id=aggView8947101400857370369.v8;
create or replace view aggView1352162947113040619 as select id as v1, name as v73 from company_name as cn1 where country_code= '[us]';
create or replace view aggJoin724190868375150856 as select movie_id as v49, v73 from movie_companies as mc1, aggView1352162947113040619 where mc1.company_id=aggView1352162947113040619.v1;
create or replace view aggView8774869789883379982 as select id as v19 from kind_type as kt1 where kind= 'tv series';
create or replace view aggJoin6449621659521180730 as select id as v49, title as v50 from title as t1, aggView8774869789883379982 where t1.kind_id=aggView8774869789883379982.v19;
create or replace view aggView3369273097140868462 as select id as v17 from info_type as it2 where info= 'rating';
create or replace view aggJoin7896791484145201022 as select movie_id as v61, info as v43 from movie_info_idx as mi_idx2, aggView3369273097140868462 where mi_idx2.info_type_id=aggView3369273097140868462.v17 and info<'3.0';
create or replace view aggView6767106003119472986 as select v61, MIN(v43) as v76 from aggJoin7896791484145201022 group by v61;
create or replace view aggJoin8410131060939176111 as select v61, v74 as v74, v76 from aggJoin3000705460722075225 join aggView6767106003119472986 using(v61);
create or replace view aggView7956142404033994135 as select v61, MIN(v74) as v74, MIN(v76) as v76 from aggJoin8410131060939176111 group by v61;
create or replace view aggJoin9142391292225880349 as select id as v61, title as v62, kind_id as v21, v74, v76 from title as t2, aggView7956142404033994135 where t2.id=aggView7956142404033994135.v61 and production_year<=2008 and production_year>=2005;
create or replace view aggView3390816531996841563 as select id as v15 from info_type as it1 where info= 'rating';
create or replace view aggJoin3656734677417008265 as select movie_id as v49, info as v38 from movie_info_idx as mi_idx1, aggView3390816531996841563 where mi_idx1.info_type_id=aggView3390816531996841563.v15;
create or replace view aggView4317783527177625400 as select v49, MIN(v38) as v75 from aggJoin3656734677417008265 group by v49;
create or replace view aggJoin5318240030296504766 as select v49, v73 as v73, v75 from aggJoin724190868375150856 join aggView4317783527177625400 using(v49);
create or replace view aggView2239184278142845236 as select id as v21 from kind_type as kt2 where kind= 'tv series';
create or replace view aggJoin8762942174469499366 as select v61, v62, v74, v76 from aggJoin9142391292225880349 join aggView2239184278142845236 using(v21);
create or replace view aggView6611397037837241795 as select v61, MIN(v74) as v74, MIN(v76) as v76, MIN(v62) as v78 from aggJoin8762942174469499366 group by v61;
create or replace view aggJoin5636740293593967767 as select movie_id as v49, link_type_id as v23, v74, v76, v78 from movie_link as ml, aggView6611397037837241795 where ml.linked_movie_id=aggView6611397037837241795.v61;
create or replace view aggView7093206557342476299 as select v49, MIN(v73) as v73, MIN(v75) as v75 from aggJoin5318240030296504766 group by v49;
create or replace view aggJoin2499691051125837948 as select v49, v50, v73, v75 from aggJoin6449621659521180730 join aggView7093206557342476299 using(v49);
create or replace view aggView7059482162384951750 as select v49, MIN(v73) as v73, MIN(v75) as v75, MIN(v50) as v77 from aggJoin2499691051125837948 group by v49;
create or replace view aggJoin1653898813515205019 as select v23, v74 as v74, v76 as v76, v78 as v78, v73, v75, v77 from aggJoin5636740293593967767 join aggView7059482162384951750 using(v49);
create or replace view aggView2270927228091271605 as select v23, MIN(v74) as v74, MIN(v76) as v76, MIN(v78) as v78, MIN(v73) as v73, MIN(v75) as v75, MIN(v77) as v77 from aggJoin1653898813515205019 group by v23;
create or replace view aggJoin7185544415363841356 as select v74, v76, v78, v73, v75, v77 from link_type as lt, aggView2270927228091271605 where lt.id=aggView2270927228091271605.v23 and link IN ('sequel','follows','followed by');
create or replace view res as select MIN(v73) as v73, MIN(v74) as v74, MIN(v75) as v75, MIN(v76) as v76, MIN(v77) as v77, MIN(v78) as v78 from aggJoin7185544415363841356;
select sum(v73+v74+v75+v76+v77+v78) from res;