create or replace view aggView2551451424440847274 as select id as v8, name as v74 from company_name as cn2;
create or replace view aggJoin6302420352295676016 as select movie_id as v61, v74 from movie_companies as mc2, aggView2551451424440847274 where mc2.company_id=aggView2551451424440847274.v8;
create or replace view aggView2551035650603646356 as select id as v1, name as v73 from company_name as cn1 where country_code= '[us]';
create or replace view aggJoin7209670579960557189 as select movie_id as v49, v73 from movie_companies as mc1, aggView2551035650603646356 where mc1.company_id=aggView2551035650603646356.v1;
create or replace view aggView1045601792285107461 as select id as v19 from kind_type as kt1 where kind= 'tv series';
create or replace view aggJoin7024079106862698625 as select id as v49, title as v50 from title as t1, aggView1045601792285107461 where t1.kind_id=aggView1045601792285107461.v19;
create or replace view aggView660304590263994327 as select v49, MIN(v50) as v77 from aggJoin7024079106862698625 group by v49;
create or replace view aggJoin5601443753874107046 as select v49, v73 as v73, v77 from aggJoin7209670579960557189 join aggView660304590263994327 using(v49);
create or replace view aggView6268489757064609177 as select id as v17 from info_type as it2 where info= 'rating';
create or replace view aggJoin8404016033739105246 as select movie_id as v61, info as v43 from movie_info_idx as mi_idx2, aggView6268489757064609177 where mi_idx2.info_type_id=aggView6268489757064609177.v17 and info<'3.0';
create or replace view aggView7884467596061327565 as select id as v15 from info_type as it1 where info= 'rating';
create or replace view aggJoin8710209141784705852 as select movie_id as v49, info as v38 from movie_info_idx as mi_idx1, aggView7884467596061327565 where mi_idx1.info_type_id=aggView7884467596061327565.v15;
create or replace view aggView485643898215425257 as select v49, MIN(v73) as v73, MIN(v77) as v77 from aggJoin5601443753874107046 group by v49;
create or replace view aggJoin5685521642982377506 as select v49, v38, v73, v77 from aggJoin8710209141784705852 join aggView485643898215425257 using(v49);
create or replace view aggView8689948469450132474 as select v49, MIN(v73) as v73, MIN(v77) as v77, MIN(v38) as v75 from aggJoin5685521642982377506 group by v49;
create or replace view aggJoin2218854746674039711 as select linked_movie_id as v61, link_type_id as v23, v73, v77, v75 from movie_link as ml, aggView8689948469450132474 where ml.movie_id=aggView8689948469450132474.v49;
create or replace view aggView799961112400869988 as select id as v21 from kind_type as kt2 where kind= 'tv series';
create or replace view aggJoin1322418161393271728 as select id as v61, title as v62 from title as t2, aggView799961112400869988 where t2.kind_id=aggView799961112400869988.v21 and production_year<=2008 and production_year>=2005;
create or replace view aggView6497591669575477563 as select v61, MIN(v62) as v78 from aggJoin1322418161393271728 group by v61;
create or replace view aggJoin3635405853721937775 as select v61, v43, v78 from aggJoin8404016033739105246 join aggView6497591669575477563 using(v61);
create or replace view aggView163377569660751651 as select v61, MIN(v78) as v78, MIN(v43) as v76 from aggJoin3635405853721937775 group by v61;
create or replace view aggJoin166232428943084982 as select v61, v74 as v74, v78, v76 from aggJoin6302420352295676016 join aggView163377569660751651 using(v61);
create or replace view aggView6991272782950396936 as select v61, MIN(v74) as v74, MIN(v78) as v78, MIN(v76) as v76 from aggJoin166232428943084982 group by v61;
create or replace view aggJoin4416587600266037362 as select v23, v73 as v73, v77 as v77, v75 as v75, v74, v78, v76 from aggJoin2218854746674039711 join aggView6991272782950396936 using(v61);
create or replace view aggView1271208659319739502 as select v23, MIN(v73) as v73, MIN(v77) as v77, MIN(v75) as v75, MIN(v74) as v74, MIN(v78) as v78, MIN(v76) as v76 from aggJoin4416587600266037362 group by v23;
create or replace view aggJoin6985779153050683158 as select v73, v77, v75, v74, v78, v76 from link_type as lt, aggView1271208659319739502 where lt.id=aggView1271208659319739502.v23 and link IN ('sequel','follows','followed by');
create or replace view res as select MIN(v73) as v73, MIN(v74) as v74, MIN(v75) as v75, MIN(v76) as v76, MIN(v77) as v77, MIN(v78) as v78 from aggJoin6985779153050683158;
select sum(v73+v74+v75+v76+v77+v78) from res;