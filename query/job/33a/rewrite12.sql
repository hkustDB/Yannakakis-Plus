create or replace view aggView7876308771184108278 as select id as v8, name as v74 from company_name as cn2;
create or replace view aggJoin1233871290226610329 as select movie_id as v61, v74 from movie_companies as mc2, aggView7876308771184108278 where mc2.company_id=aggView7876308771184108278.v8;
create or replace view aggView5844364534000719779 as select id as v1, name as v73 from company_name as cn1 where country_code= '[us]';
create or replace view aggJoin5845402667584496854 as select movie_id as v49, v73 from movie_companies as mc1, aggView5844364534000719779 where mc1.company_id=aggView5844364534000719779.v1;
create or replace view aggView6006993506935557374 as select id as v19 from kind_type as kt1 where kind= 'tv series';
create or replace view aggJoin4355990542215501810 as select id as v49, title as v50 from title as t1, aggView6006993506935557374 where t1.kind_id=aggView6006993506935557374.v19;
create or replace view aggView9146835104767736952 as select v49, MIN(v50) as v77 from aggJoin4355990542215501810 group by v49;
create or replace view aggJoin6104843651336802895 as select movie_id as v49, info_type_id as v15, info as v38, v77 from movie_info_idx as mi_idx1, aggView9146835104767736952 where mi_idx1.movie_id=aggView9146835104767736952.v49;
create or replace view aggView7314595079289691980 as select id as v17 from info_type as it2 where info= 'rating';
create or replace view aggJoin742488405256660177 as select movie_id as v61, info as v43 from movie_info_idx as mi_idx2, aggView7314595079289691980 where mi_idx2.info_type_id=aggView7314595079289691980.v17 and info<'3.0';
create or replace view aggView8700096972988916098 as select v61, MIN(v43) as v76 from aggJoin742488405256660177 group by v61;
create or replace view aggJoin7823577204451564217 as select v61, v74 as v74, v76 from aggJoin1233871290226610329 join aggView8700096972988916098 using(v61);
create or replace view aggView8533643649614295907 as select id as v23 from link_type as lt where link IN ('sequel','follows','followed by');
create or replace view aggJoin8354573605371872825 as select movie_id as v49, linked_movie_id as v61 from movie_link as ml, aggView8533643649614295907 where ml.link_type_id=aggView8533643649614295907.v23;
create or replace view aggView4226965888042507269 as select v61, MIN(v74) as v74, MIN(v76) as v76 from aggJoin7823577204451564217 group by v61;
create or replace view aggJoin6012837896265926223 as select id as v61, title as v62, kind_id as v21, v74, v76 from title as t2, aggView4226965888042507269 where t2.id=aggView4226965888042507269.v61 and production_year<=2008 and production_year>=2005;
create or replace view aggView6204636214965248989 as select id as v21 from kind_type as kt2 where kind= 'tv series';
create or replace view aggJoin4871480204813440279 as select v61, v62, v74, v76 from aggJoin6012837896265926223 join aggView6204636214965248989 using(v21);
create or replace view aggView3586236138912608724 as select v61, MIN(v74) as v74, MIN(v76) as v76, MIN(v62) as v78 from aggJoin4871480204813440279 group by v61;
create or replace view aggJoin5376181271387386040 as select v49, v74, v76, v78 from aggJoin8354573605371872825 join aggView3586236138912608724 using(v61);
create or replace view aggView7947787302524465320 as select v49, MIN(v74) as v74, MIN(v76) as v76, MIN(v78) as v78 from aggJoin5376181271387386040 group by v49;
create or replace view aggJoin2889094738299122996 as select v49, v73 as v73, v74, v76, v78 from aggJoin5845402667584496854 join aggView7947787302524465320 using(v49);
create or replace view aggView884603926164463107 as select v49, MIN(v73) as v73, MIN(v74) as v74, MIN(v76) as v76, MIN(v78) as v78 from aggJoin2889094738299122996 group by v49;
create or replace view aggJoin5256824791077737729 as select v15, v38, v77 as v77, v73, v74, v76, v78 from aggJoin6104843651336802895 join aggView884603926164463107 using(v49);
create or replace view aggView5415392306941296028 as select v15, MIN(v77) as v77, MIN(v73) as v73, MIN(v74) as v74, MIN(v76) as v76, MIN(v78) as v78, MIN(v38) as v75 from aggJoin5256824791077737729 group by v15;
create or replace view aggJoin4702475411881167258 as select v77, v73, v74, v76, v78, v75 from info_type as it1, aggView5415392306941296028 where it1.id=aggView5415392306941296028.v15 and info= 'rating';
create or replace view res as select MIN(v73) as v73, MIN(v74) as v74, MIN(v75) as v75, MIN(v76) as v76, MIN(v77) as v77, MIN(v78) as v78 from aggJoin4702475411881167258;
select sum(v73+v74+v75+v76+v77+v78) from res;