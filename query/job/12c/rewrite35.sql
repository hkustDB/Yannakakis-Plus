create or replace view aggView5621974214840810400 as select id as v26 from info_type as it2 where info= 'rating';
create or replace view aggJoin5681693918438869829 as select movie_id as v29, info as v27 from movie_info_idx as mi_idx, aggView5621974214840810400 where mi_idx.info_type_id=aggView5621974214840810400.v26 and info>'7.0';
create or replace view aggView7169582128393028704 as select name as v2, id as v1 from company_name as cn where country_code= '[us]';
create or replace view aggView4765016214267755981 as select v27, v29 from aggJoin5681693918438869829;
create or replace view aggView5845795729849891272 as select title as v30, id as v29 from title as t where production_year>=2000 and production_year<=2010;
create or replace view aggView7642251208283734121 as select v1, MIN(v2) as v41 from aggView7169582128393028704 group by v1;
create or replace view aggJoin694647370185910639 as select movie_id as v29, company_type_id as v8, v41 from movie_companies as mc, aggView7642251208283734121 where mc.company_id=aggView7642251208283734121.v1;
create or replace view aggView2914764651671827803 as select v29, MIN(v30) as v43 from aggView5845795729849891272 group by v29;
create or replace view aggJoin6681736305909365324 as select v29, v8, v41 as v41, v43 from aggJoin694647370185910639 join aggView2914764651671827803 using(v29);
create or replace view aggView5776342095238386150 as select id as v21 from info_type as it1 where info= 'genres';
create or replace view aggJoin3359025366087476460 as select movie_id as v29, info as v22 from movie_info as mi, aggView5776342095238386150 where mi.info_type_id=aggView5776342095238386150.v21 and info IN ('Drama','Horror','Western','Family');
create or replace view aggView1541883595810308009 as select id as v8 from company_type as ct where kind= 'production companies';
create or replace view aggJoin4783613587399221570 as select v29, v41, v43 from aggJoin6681736305909365324 join aggView1541883595810308009 using(v8);
create or replace view aggView640015795786441734 as select v29 from aggJoin3359025366087476460 group by v29;
create or replace view aggJoin1549963243562495342 as select v29, v41 as v41, v43 as v43 from aggJoin4783613587399221570 join aggView640015795786441734 using(v29);
create or replace view aggView8142477705808951902 as select v29, MIN(v41) as v41, MIN(v43) as v43 from aggJoin1549963243562495342 group by v29;
create or replace view aggJoin6752940160025009179 as select v27, v41, v43 from aggView4765016214267755981 join aggView8142477705808951902 using(v29);
select MIN(v41) as v41,MIN(v27) as v42,MIN(v43) as v43 from aggJoin6752940160025009179;
