create or replace view semiUp6359231443406113284 as select movie_id as v29, info_type_id as v26, info as v27 from movie_info_idx AS mi_idx where (info_type_id) in (select (id) from info_type AS it2 where info= 'rating') and info>'7.0';
create or replace view semiUp1537992766862797498 as select movie_id as v29, company_id as v1, company_type_id as v8 from movie_companies AS mc where (company_id) in (select (id) from company_name AS cn where country_code= '[us]');
create or replace view semiUp5586795892696643154 as select movie_id as v29, info_type_id as v21 from movie_info AS mi where (info_type_id) in (select (id) from info_type AS it1 where info= 'genres') and info IN ('Drama','Horror','Western','Family');
create or replace view semiUp1217284029256297430 as select v29, v1, v8 from semiUp1537992766862797498 where (v8) in (select (id) from company_type AS ct where kind= 'production companies');
create or replace view semiUp9100545194513955800 as select id as v29, title as v30 from title AS t where (id) in (select (v29) from semiUp1217284029256297430) and production_year>=2000 and production_year<=2010;
create or replace view semiUp2000030784485636205 as select v29, v21 from semiUp5586795892696643154 where (v29) in (select (v29) from semiUp9100545194513955800);
create or replace view semiUp2034437165270197901 as select v29, v26, v27 from semiUp6359231443406113284 where (v29) in (select (v29) from semiUp2000030784485636205);
create or replace view semiDown8269741575832626283 as select v29, v21 from semiUp2000030784485636205 where (v29) in (select (v29) from semiUp2034437165270197901);
create or replace view semiDown7948266165724441084 as select id as v26 from info_type AS it2 where (id) in (select (v26) from semiUp2034437165270197901) and info= 'rating';
create or replace view semiDown5219738220903253425 as select id as v21 from info_type AS it1 where (id) in (select (v21) from semiDown8269741575832626283) and info= 'genres';
create or replace view semiDown5254100182374579859 as select v29, v30 from semiUp9100545194513955800 where (v29) in (select (v29) from semiDown8269741575832626283);
create or replace view semiDown3474105396660488713 as select v29, v1, v8 from semiUp1217284029256297430 where (v29) in (select (v29) from semiDown5254100182374579859);
create or replace view semiDown6273595545081917151 as select id as v8 from company_type AS ct where (id) in (select (v8) from semiDown3474105396660488713) and kind= 'production companies';
create or replace view semiDown1175070769688462340 as select id as v1, name as v2 from company_name AS cn where (id) in (select (v1) from semiDown3474105396660488713) and country_code= '[us]';
create or replace view aggView2083004012303517471 as select v26 from semiDown7948266165724441084;
create or replace view aggJoin8158085163863589138 as select v29, v27 from semiUp2034437165270197901 join aggView2083004012303517471 using(v26);
create or replace view aggView786425798804814100 as select v21 from semiDown5219738220903253425;
create or replace view aggJoin3999475756922750732 as select v29 from semiDown8269741575832626283 join aggView786425798804814100 using(v21);
create or replace view aggView1612237485980704932 as select v8 from semiDown6273595545081917151;
create or replace view aggJoin7906335549755142368 as select v29, v1 from semiDown3474105396660488713 join aggView1612237485980704932 using(v8);
create or replace view aggView7039007908437505606 as select v1, v2 as v41 from semiDown1175070769688462340;
create or replace view aggJoin958875804290540836 as select v29, v41 from aggJoin7906335549755142368 join aggView7039007908437505606 using(v1);
create or replace view aggView1469376039863009841 as select v29, MIN(v41) as v41 from aggJoin958875804290540836 group by v29;
create or replace view aggJoin2187195909306426240 as select v29, v30, v41 from semiDown5254100182374579859 join aggView1469376039863009841 using(v29);
create or replace view aggView5887323918132132326 as select v29, MIN(v41) as v41, MIN(v30) as v43 from aggJoin2187195909306426240 group by v29;
create or replace view aggJoin1186798966395005834 as select v29, v41, v43 from aggJoin3999475756922750732 join aggView5887323918132132326 using(v29);
create or replace view aggView968474926336758882 as select v29, MIN(v41) as v41, MIN(v43) as v43 from aggJoin1186798966395005834 group by v29;
create or replace view aggJoin1583356503666479590 as select v27, v41, v43 from aggJoin8158085163863589138 join aggView968474926336758882 using(v29);
select MIN(v41) as v41,MIN(v27) as v42,MIN(v43) as v43 from aggJoin1583356503666479590;
