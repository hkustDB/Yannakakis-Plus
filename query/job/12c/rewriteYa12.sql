create or replace view semiUp3869348241414024281 as select movie_id as v29, company_id as v1, company_type_id as v8 from movie_companies AS mc where (company_id) in (select (id) from company_name AS cn where country_code= '[us]');
create or replace view semiUp3935273969111694526 as select movie_id as v29, info_type_id as v26, info as v27 from movie_info_idx AS mi_idx where (info_type_id) in (select (id) from info_type AS it2 where info= 'rating') and info>'7.0';
create or replace view semiUp5959684583651107508 as select movie_id as v29, info_type_id as v21 from movie_info AS mi where (info_type_id) in (select (id) from info_type AS it1 where info= 'genres') and info IN ('Drama','Horror','Western','Family');
create or replace view semiUp5903941718371324899 as select v29, v1, v8 from semiUp3869348241414024281 where (v8) in (select (id) from company_type AS ct where kind= 'production companies');
create or replace view semiUp5053362825345740519 as select v29, v26, v27 from semiUp3935273969111694526 where (v29) in (select (v29) from semiUp5903941718371324899);
create or replace view semiUp8960054643584994617 as select id as v29, title as v30 from title AS t where (id) in (select (v29) from semiUp5053362825345740519) and production_year>=2000 and production_year<=2010;
create or replace view semiUp4344953884087240682 as select v29, v21 from semiUp5959684583651107508 where (v29) in (select (v29) from semiUp8960054643584994617);
create or replace view semiDown3504302122376522940 as select id as v21 from info_type AS it1 where (id) in (select (v21) from semiUp4344953884087240682) and info= 'genres';
create or replace view semiDown4667348395244534513 as select v29, v30 from semiUp8960054643584994617 where (v29) in (select (v29) from semiUp4344953884087240682);
create or replace view semiDown4225070656302101697 as select v29, v26, v27 from semiUp5053362825345740519 where (v29) in (select (v29) from semiDown4667348395244534513);
create or replace view semiDown79122698087760280 as select v29, v1, v8 from semiUp5903941718371324899 where (v29) in (select (v29) from semiDown4225070656302101697);
create or replace view semiDown8067657739513279882 as select id as v26 from info_type AS it2 where (id) in (select (v26) from semiDown4225070656302101697) and info= 'rating';
create or replace view semiDown7539613530122266210 as select id as v8 from company_type AS ct where (id) in (select (v8) from semiDown79122698087760280) and kind= 'production companies';
create or replace view semiDown1739111516786918602 as select id as v1, name as v2 from company_name AS cn where (id) in (select (v1) from semiDown79122698087760280) and country_code= '[us]';
create or replace view aggView8104237012076794257 as select v1, v2 as v41 from semiDown1739111516786918602;
create or replace view aggJoin4644020290865225901 as select v29, v8, v41 from semiDown79122698087760280 join aggView8104237012076794257 using(v1);
create or replace view aggView872608466368905913 as select v8 from semiDown7539613530122266210;
create or replace view aggJoin1697591555429434165 as select v29, v41 from aggJoin4644020290865225901 join aggView872608466368905913 using(v8);
create or replace view aggView1214829653002730703 as select v26 from semiDown8067657739513279882;
create or replace view aggJoin6803044868043783418 as select v29, v27 from semiDown4225070656302101697 join aggView1214829653002730703 using(v26);
create or replace view aggView2971938485596507331 as select v21 from semiDown3504302122376522940;
create or replace view aggJoin6822481953149877141 as select v29 from semiUp4344953884087240682 join aggView2971938485596507331 using(v21);
create or replace view aggView5759314896017678472 as select v29, MIN(v41) as v41 from aggJoin1697591555429434165 group by v29;
create or replace view aggJoin2019346606184444357 as select v29, v27, v41 from aggJoin6803044868043783418 join aggView5759314896017678472 using(v29);
create or replace view aggView8408815124161427060 as select v29, MIN(v41) as v41, MIN(v27) as v42 from aggJoin2019346606184444357 group by v29;
create or replace view aggJoin3874594178703154040 as select v29, v30, v41, v42 from semiDown4667348395244534513 join aggView8408815124161427060 using(v29);
create or replace view aggView4994618583751936711 as select v29, MIN(v41) as v41, MIN(v42) as v42, MIN(v30) as v43 from aggJoin3874594178703154040 group by v29;
create or replace view aggJoin8350629479404290798 as select v41, v42, v43 from aggJoin6822481953149877141 join aggView4994618583751936711 using(v29);
select MIN(v41) as v41,MIN(v42) as v42,MIN(v43) as v43 from aggJoin8350629479404290798;
