create or replace view semiUp1467735178416748764 as select movie_id as v29, company_id as v1, company_type_id as v8 from movie_companies AS mc where (company_id) in (select (id) from company_name AS cn where country_code= '[us]');
create or replace view semiUp8312444954108249844 as select movie_id as v29, info_type_id as v21 from movie_info AS mi where (info_type_id) in (select (id) from info_type AS it1 where info= 'genres') and info IN ('Drama','Horror','Western','Family');
create or replace view semiUp5926140961886378834 as select v29, v1, v8 from semiUp1467735178416748764 where (v8) in (select (id) from company_type AS ct where kind= 'production companies');
create or replace view semiUp4976744123789310545 as select id as v29, title as v30 from title AS t where (id) in (select (v29) from semiUp5926140961886378834) and production_year>=2000 and production_year<=2010;
create or replace view semiUp4172914810053834746 as select v29, v21 from semiUp8312444954108249844 where (v29) in (select (v29) from semiUp4976744123789310545);
create or replace view semiUp6725386920126760292 as select movie_id as v29, info_type_id as v26, info as v27 from movie_info_idx AS mi_idx where (movie_id) in (select (v29) from semiUp4172914810053834746) and info>'7.0';
create or replace view semiUp113330362659873890 as select id as v26 from info_type AS it2 where (id) in (select (v26) from semiUp6725386920126760292) and info= 'rating';
create or replace view semiDown2284815940962498775 as select v29, v26, v27 from semiUp6725386920126760292 where (v26) in (select (v26) from semiUp113330362659873890);
create or replace view semiDown1471271302064554256 as select v29, v21 from semiUp4172914810053834746 where (v29) in (select (v29) from semiDown2284815940962498775);
create or replace view semiDown315658404244576806 as select id as v21 from info_type AS it1 where (id) in (select (v21) from semiDown1471271302064554256) and info= 'genres';
create or replace view semiDown2598975704919498513 as select v29, v30 from semiUp4976744123789310545 where (v29) in (select (v29) from semiDown1471271302064554256);
create or replace view semiDown3186388636449956190 as select v29, v1, v8 from semiUp5926140961886378834 where (v29) in (select (v29) from semiDown2598975704919498513);
create or replace view semiDown4175868358367773000 as select id as v8 from company_type AS ct where (id) in (select (v8) from semiDown3186388636449956190) and kind= 'production companies';
create or replace view semiDown6104501480522914483 as select id as v1, name as v2 from company_name AS cn where (id) in (select (v1) from semiDown3186388636449956190) and country_code= '[us]';
create or replace view aggView7683877649530889231 as select v1, v2 as v41 from semiDown6104501480522914483;
create or replace view aggJoin4747753819742069245 as select v29, v8, v41 from semiDown3186388636449956190 join aggView7683877649530889231 using(v1);
create or replace view aggView9076737372016155731 as select v8 from semiDown4175868358367773000;
create or replace view aggJoin7409488544090608110 as select v29, v41 from aggJoin4747753819742069245 join aggView9076737372016155731 using(v8);
create or replace view aggView2846113718232704713 as select v29, MIN(v41) as v41 from aggJoin7409488544090608110 group by v29;
create or replace view aggJoin4225298640026022635 as select v29, v30, v41 from semiDown2598975704919498513 join aggView2846113718232704713 using(v29);
create or replace view aggView8893034632985327851 as select v21 from semiDown315658404244576806;
create or replace view aggJoin134602154708341160 as select v29 from semiDown1471271302064554256 join aggView8893034632985327851 using(v21);
create or replace view aggView865700226440476267 as select v29, MIN(v41) as v41, MIN(v30) as v43 from aggJoin4225298640026022635 group by v29;
create or replace view aggJoin7471621415648626807 as select v29, v41, v43 from aggJoin134602154708341160 join aggView865700226440476267 using(v29);
create or replace view aggView5122142601030471045 as select v29, MIN(v41) as v41, MIN(v43) as v43 from aggJoin7471621415648626807 group by v29;
create or replace view aggJoin8836578845288974648 as select v26, v27, v41, v43 from semiDown2284815940962498775 join aggView5122142601030471045 using(v29);
create or replace view aggView4365193819925410742 as select v26, MIN(v41) as v41, MIN(v43) as v43, MIN(v27) as v42 from aggJoin8836578845288974648 group by v26;
create or replace view aggJoin6413103694599370789 as select v41, v43, v42 from semiUp113330362659873890 join aggView4365193819925410742 using(v26);
select MIN(v41) as v41,MIN(v42) as v42,MIN(v43) as v43 from aggJoin6413103694599370789;
