create or replace view semiUp4462995951376196484 as select movie_id as v29, info_type_id as v26, info as v27 from movie_info_idx AS mi_idx where (info_type_id) in (select (id) from info_type AS it2 where info= 'rating') and info>'7.0';
create or replace view semiUp1534241269356846866 as select movie_id as v29, info_type_id as v21 from movie_info AS mi where (info_type_id) in (select (id) from info_type AS it1 where info= 'genres') and info IN ('Drama','Horror','Western','Family');
create or replace view semiUp4716795351376854065 as select movie_id as v29, company_id as v1, company_type_id as v8 from movie_companies AS mc where (company_id) in (select (id) from company_name AS cn where country_code= '[us]');
create or replace view semiUp508991900331374175 as select v29, v21 from semiUp1534241269356846866 where (v29) in (select (id) from title AS t where production_year>=2000 and production_year<=2010);
create or replace view semiUp5439069828484180066 as select v29, v26, v27 from semiUp4462995951376196484 where (v29) in (select (v29) from semiUp508991900331374175);
create or replace view semiUp8242010968112353961 as select v29, v1, v8 from semiUp4716795351376854065 where (v29) in (select (v29) from semiUp5439069828484180066);
create or replace view semiUp372651886787986931 as select id as v8 from company_type AS ct where (id) in (select (v8) from semiUp8242010968112353961) and kind= 'production companies';
create or replace view semiDown9180112004228152601 as select v29, v1, v8 from semiUp8242010968112353961 where (v8) in (select (v8) from semiUp372651886787986931);
create or replace view semiDown8992563378408661736 as select v29, v26, v27 from semiUp5439069828484180066 where (v29) in (select (v29) from semiDown9180112004228152601);
create or replace view semiDown6344278044465054136 as select id as v1, name as v2 from company_name AS cn where (id) in (select (v1) from semiDown9180112004228152601) and country_code= '[us]';
create or replace view semiDown697977747690319574 as select v29, v21 from semiUp508991900331374175 where (v29) in (select (v29) from semiDown8992563378408661736);
create or replace view semiDown4701589889909253698 as select id as v26 from info_type AS it2 where (id) in (select (v26) from semiDown8992563378408661736) and info= 'rating';
create or replace view semiDown4936801149611120756 as select id as v21 from info_type AS it1 where (id) in (select (v21) from semiDown697977747690319574) and info= 'genres';
create or replace view semiDown6031228943169295834 as select id as v29, title as v30 from title AS t where (id) in (select (v29) from semiDown697977747690319574) and production_year>=2000 and production_year<=2010;
create or replace view aggView5639798211450505619 as select v21 from semiDown4936801149611120756;
create or replace view aggJoin8537417874420347146 as select v29 from semiDown697977747690319574 join aggView5639798211450505619 using(v21);
create or replace view aggView3311800881118995088 as select v29, v30 as v43 from semiDown6031228943169295834;
create or replace view aggJoin3829918618496691117 as select v29, v43 from aggJoin8537417874420347146 join aggView3311800881118995088 using(v29);
create or replace view aggView6771012301623026529 as select v29, MIN(v43) as v43 from aggJoin3829918618496691117 group by v29;
create or replace view aggJoin5831927814431347287 as select v29, v26, v27, v43 from semiDown8992563378408661736 join aggView6771012301623026529 using(v29);
create or replace view aggView8464024375420428181 as select v1, v2 as v41 from semiDown6344278044465054136;
create or replace view aggJoin71590760230402225 as select v29, v8, v41 from semiDown9180112004228152601 join aggView8464024375420428181 using(v1);
create or replace view aggView3257038325499629675 as select v26 from semiDown4701589889909253698;
create or replace view aggJoin2018594213817553105 as select v29, v27, v43 from aggJoin5831927814431347287 join aggView3257038325499629675 using(v26);
create or replace view aggView2075458916819040498 as select v29, MIN(v43) as v43, MIN(v27) as v42 from aggJoin2018594213817553105 group by v29;
create or replace view aggJoin994927558632347238 as select v8, v41 as v41, v43, v42 from aggJoin71590760230402225 join aggView2075458916819040498 using(v29);
create or replace view aggView8886633373844271350 as select v8, MIN(v41) as v41, MIN(v43) as v43, MIN(v42) as v42 from aggJoin994927558632347238 group by v8;
create or replace view aggJoin480184604975550269 as select v41, v43, v42 from semiUp372651886787986931 join aggView8886633373844271350 using(v8);
select MIN(v41) as v41,MIN(v42) as v42,MIN(v43) as v43 from aggJoin480184604975550269;
