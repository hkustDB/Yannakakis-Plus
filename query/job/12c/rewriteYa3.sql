create or replace view semiUp5753469473603284990 as select movie_id as v29, company_id as v1, company_type_id as v8 from movie_companies AS mc where (company_id) in (select (id) from company_name AS cn where country_code= '[us]');
create or replace view semiUp4915635109602276439 as select v29, v1, v8 from semiUp5753469473603284990 where (v8) in (select (id) from company_type AS ct where kind= 'production companies');
create or replace view semiUp2096433223179987326 as select movie_id as v29, info_type_id as v26, info as v27 from movie_info_idx AS mi_idx where (movie_id) in (select (v29) from semiUp4915635109602276439) and info>'7.0';
create or replace view semiUp3671153242928269414 as select v29, v26, v27 from semiUp2096433223179987326 where (v26) in (select (id) from info_type AS it2 where info= 'rating');
create or replace view semiUp1788463763611862665 as select id as v29, title as v30 from title AS t where (id) in (select (v29) from semiUp3671153242928269414) and production_year>=2000 and production_year<=2010;
create or replace view semiUp6766016316357311722 as select movie_id as v29, info_type_id as v21 from movie_info AS mi where (movie_id) in (select (v29) from semiUp1788463763611862665) and info IN ('Drama','Horror','Western','Family');
create or replace view semiUp3949203358938374274 as select id as v21 from info_type AS it1 where (id) in (select (v21) from semiUp6766016316357311722) and info= 'genres';
create or replace view semiDown920741317721360349 as select v29, v21 from semiUp6766016316357311722 where (v21) in (select (v21) from semiUp3949203358938374274);
create or replace view semiDown3287798217267896379 as select v29, v30 from semiUp1788463763611862665 where (v29) in (select (v29) from semiDown920741317721360349);
create or replace view semiDown8001463448019432174 as select v29, v26, v27 from semiUp3671153242928269414 where (v29) in (select (v29) from semiDown3287798217267896379);
create or replace view semiDown3405090559639581347 as select v29, v1, v8 from semiUp4915635109602276439 where (v29) in (select (v29) from semiDown8001463448019432174);
create or replace view semiDown8489577741966166469 as select id as v26 from info_type AS it2 where (id) in (select (v26) from semiDown8001463448019432174) and info= 'rating';
create or replace view semiDown8711752029293125060 as select id as v8 from company_type AS ct where (id) in (select (v8) from semiDown3405090559639581347) and kind= 'production companies';
create or replace view semiDown6721216547841500664 as select id as v1, name as v2 from company_name AS cn where (id) in (select (v1) from semiDown3405090559639581347) and country_code= '[us]';
create or replace view aggView4483607894626063109 as select v8 from semiDown8711752029293125060;
create or replace view aggJoin2303746828590809832 as select v29, v1 from semiDown3405090559639581347 join aggView4483607894626063109 using(v8);
create or replace view aggView2163260464646080351 as select v26 from semiDown8489577741966166469;
create or replace view aggJoin2502007608286929959 as select v29, v27 from semiDown8001463448019432174 join aggView2163260464646080351 using(v26);
create or replace view aggView4569060670111631930 as select v1, v2 as v41 from semiDown6721216547841500664;
create or replace view aggJoin6559061571756703476 as select v29, v41 from aggJoin2303746828590809832 join aggView4569060670111631930 using(v1);
create or replace view aggView7575791696459088537 as select v29, MIN(v41) as v41 from aggJoin6559061571756703476 group by v29;
create or replace view aggJoin1864375113892872705 as select v29, v27, v41 from aggJoin2502007608286929959 join aggView7575791696459088537 using(v29);
create or replace view aggView7397914150073648501 as select v29, MIN(v41) as v41, MIN(v27) as v42 from aggJoin1864375113892872705 group by v29;
create or replace view aggJoin1769027508754227735 as select v29, v30, v41, v42 from semiDown3287798217267896379 join aggView7397914150073648501 using(v29);
create or replace view aggView409571701911429818 as select v29, MIN(v41) as v41, MIN(v42) as v42, MIN(v30) as v43 from aggJoin1769027508754227735 group by v29;
create or replace view aggJoin4821553359591096813 as select v21, v41, v42, v43 from semiDown920741317721360349 join aggView409571701911429818 using(v29);
create or replace view aggView8066351099638036078 as select v21, MIN(v41) as v41, MIN(v42) as v42, MIN(v43) as v43 from aggJoin4821553359591096813 group by v21;
create or replace view aggJoin7616104626532921680 as select v41, v42, v43 from semiUp3949203358938374274 join aggView8066351099638036078 using(v21);
select MIN(v41) as v41,MIN(v42) as v42,MIN(v43) as v43 from aggJoin7616104626532921680;
