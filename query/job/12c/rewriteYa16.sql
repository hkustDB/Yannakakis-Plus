create or replace view semiUp7245150191774656753 as select movie_id as v29, info_type_id as v26, info as v27 from movie_info_idx AS mi_idx where (movie_id) in (select (id) from title AS t where production_year>=2000 and production_year<=2010) and info>'7.0';
create or replace view semiUp1254343226530149293 as select movie_id as v29, info_type_id as v21 from movie_info AS mi where (info_type_id) in (select (id) from info_type AS it1 where info= 'genres') and info IN ('Drama','Horror','Western','Family');
create or replace view semiUp4890284608804504795 as select movie_id as v29, company_id as v1, company_type_id as v8 from movie_companies AS mc where (company_id) in (select (id) from company_name AS cn where country_code= '[us]');
create or replace view semiUp2121696272379910757 as select v29, v1, v8 from semiUp4890284608804504795 where (v8) in (select (id) from company_type AS ct where kind= 'production companies');
create or replace view semiUp1237867425625019693 as select v29, v21 from semiUp1254343226530149293 where (v29) in (select (v29) from semiUp2121696272379910757);
create or replace view semiUp1977315495657558885 as select v29, v26, v27 from semiUp7245150191774656753 where (v29) in (select (v29) from semiUp1237867425625019693);
create or replace view semiUp1207209292816887851 as select id as v26 from info_type AS it2 where (id) in (select (v26) from semiUp1977315495657558885) and info= 'rating';
create or replace view semiDown7141338619207872992 as select v29, v26, v27 from semiUp1977315495657558885 where (v26) in (select (v26) from semiUp1207209292816887851);
create or replace view semiDown5886846466390262172 as select v29, v21 from semiUp1237867425625019693 where (v29) in (select (v29) from semiDown7141338619207872992);
create or replace view semiDown7835348988129638706 as select id as v29, title as v30 from title AS t where (id) in (select (v29) from semiDown7141338619207872992) and production_year>=2000 and production_year<=2010;
create or replace view semiDown1451855091464353544 as select id as v21 from info_type AS it1 where (id) in (select (v21) from semiDown5886846466390262172) and info= 'genres';
create or replace view semiDown7359614310092601895 as select v29, v1, v8 from semiUp2121696272379910757 where (v29) in (select (v29) from semiDown5886846466390262172);
create or replace view semiDown374834769103782531 as select id as v8 from company_type AS ct where (id) in (select (v8) from semiDown7359614310092601895) and kind= 'production companies';
create or replace view semiDown4195110972479637293 as select id as v1, name as v2 from company_name AS cn where (id) in (select (v1) from semiDown7359614310092601895) and country_code= '[us]';
create or replace view aggView1380495373333044121 as select v8 from semiDown374834769103782531;
create or replace view aggJoin3956144413697144492 as select v29, v1 from semiDown7359614310092601895 join aggView1380495373333044121 using(v8);
create or replace view aggView7358576960293930089 as select v1, v2 as v41 from semiDown4195110972479637293;
create or replace view aggJoin8513383754000740075 as select v29, v41 from aggJoin3956144413697144492 join aggView7358576960293930089 using(v1);
create or replace view aggView2283611648588302531 as select v21 from semiDown1451855091464353544;
create or replace view aggJoin2051212077990922199 as select v29 from semiDown5886846466390262172 join aggView2283611648588302531 using(v21);
create or replace view aggView5671579612145146309 as select v29, v30 as v43 from semiDown7835348988129638706;
create or replace view aggJoin693606287131176981 as select v29, v26, v27, v43 from semiDown7141338619207872992 join aggView5671579612145146309 using(v29);
create or replace view aggView5140997053901880480 as select v29, MIN(v41) as v41 from aggJoin8513383754000740075 group by v29;
create or replace view aggJoin1099365516409605754 as select v29, v41 from aggJoin2051212077990922199 join aggView5140997053901880480 using(v29);
create or replace view aggView2664352194689919865 as select v29, MIN(v41) as v41 from aggJoin1099365516409605754 group by v29;
create or replace view aggJoin2925774908712320985 as select v26, v27, v43 as v43, v41 from aggJoin693606287131176981 join aggView2664352194689919865 using(v29);
create or replace view aggView2276723925138602911 as select v26, MIN(v43) as v43, MIN(v41) as v41, MIN(v27) as v42 from aggJoin2925774908712320985 group by v26;
create or replace view aggJoin4712292244578601382 as select v43, v41, v42 from semiUp1207209292816887851 join aggView2276723925138602911 using(v26);
select MIN(v41) as v41,MIN(v42) as v42,MIN(v43) as v43 from aggJoin4712292244578601382;
