create or replace view semiUp5823837502965672573 as select movie_id as v29, company_id as v1, company_type_id as v8 from movie_companies AS mc where (company_id) in (select (id) from company_name AS cn where country_code= '[us]');
create or replace view semiUp8600952252216048212 as select movie_id as v29, info_type_id as v26, info as v27 from movie_info_idx AS mi_idx where (info_type_id) in (select (id) from info_type AS it2 where info= 'rating') and info>'7.0';
create or replace view semiUp7134340795756426830 as select v29, v1, v8 from semiUp5823837502965672573 where (v8) in (select (id) from company_type AS ct where kind= 'production companies');
create or replace view semiUp686558090761865865 as select v29, v26, v27 from semiUp8600952252216048212 where (v29) in (select (id) from title AS t where production_year>=2000 and production_year<=2010);
create or replace view semiUp8586128843257927587 as select movie_id as v29, info_type_id as v21 from movie_info AS mi where (movie_id) in (select (v29) from semiUp686558090761865865) and info IN ('Drama','Horror','Western','Family');
create or replace view semiUp4902456779171260545 as select v29, v21 from semiUp8586128843257927587 where (v29) in (select (v29) from semiUp7134340795756426830);
create or replace view semiUp7045719069676642974 as select id as v21 from info_type AS it1 where (id) in (select (v21) from semiUp4902456779171260545) and info= 'genres';
create or replace view semiDown1762161258001661556 as select v29, v21 from semiUp4902456779171260545 where (v21) in (select (v21) from semiUp7045719069676642974);
create or replace view semiDown2676287621719726281 as select v29, v26, v27 from semiUp686558090761865865 where (v29) in (select (v29) from semiDown1762161258001661556);
create or replace view semiDown5356168451742018961 as select v29, v1, v8 from semiUp7134340795756426830 where (v29) in (select (v29) from semiDown1762161258001661556);
create or replace view semiDown4856124875795631201 as select id as v29, title as v30 from title AS t where (id) in (select (v29) from semiDown2676287621719726281) and production_year>=2000 and production_year<=2010;
create or replace view semiDown2604813932947912457 as select id as v26 from info_type AS it2 where (id) in (select (v26) from semiDown2676287621719726281) and info= 'rating';
create or replace view semiDown480374710803255130 as select id as v8 from company_type AS ct where (id) in (select (v8) from semiDown5356168451742018961) and kind= 'production companies';
create or replace view semiDown9075585880924880320 as select id as v1, name as v2 from company_name AS cn where (id) in (select (v1) from semiDown5356168451742018961) and country_code= '[us]';
create or replace view aggView3781689765847317371 as select v26 from semiDown2604813932947912457;
create or replace view aggJoin7130350541351703819 as select v29, v27 from semiDown2676287621719726281 join aggView3781689765847317371 using(v26);
create or replace view aggView7431161990354428302 as select v1, v2 as v41 from semiDown9075585880924880320;
create or replace view aggJoin1121383805883896777 as select v29, v8, v41 from semiDown5356168451742018961 join aggView7431161990354428302 using(v1);
create or replace view aggView8735660713077851717 as select v29, v30 as v43 from semiDown4856124875795631201;
create or replace view aggJoin5519589779551460161 as select v29, v27, v43 from aggJoin7130350541351703819 join aggView8735660713077851717 using(v29);
create or replace view aggView7337758768632983318 as select v8 from semiDown480374710803255130;
create or replace view aggJoin3383648569232101027 as select v29, v41 from aggJoin1121383805883896777 join aggView7337758768632983318 using(v8);
create or replace view aggView6783928049968950681 as select v29, MIN(v41) as v41 from aggJoin3383648569232101027 group by v29;
create or replace view aggJoin6508783217487873314 as select v29, v21, v41 from semiDown1762161258001661556 join aggView6783928049968950681 using(v29);
create or replace view aggView1653495660579607930 as select v29, MIN(v43) as v43, MIN(v27) as v42 from aggJoin5519589779551460161 group by v29;
create or replace view aggJoin7726517218608095005 as select v21, v41 as v41, v43, v42 from aggJoin6508783217487873314 join aggView1653495660579607930 using(v29);
create or replace view aggView8740626117209887538 as select v21, MIN(v41) as v41, MIN(v43) as v43, MIN(v42) as v42 from aggJoin7726517218608095005 group by v21;
create or replace view aggJoin7185421935925806830 as select v41, v43, v42 from semiUp7045719069676642974 join aggView8740626117209887538 using(v21);
select MIN(v41) as v41,MIN(v42) as v42,MIN(v43) as v43 from aggJoin7185421935925806830;
