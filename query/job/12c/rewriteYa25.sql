create or replace view semiUp4043875696775869904 as select movie_id as v29, company_id as v1, company_type_id as v8 from movie_companies AS mc where (company_id) in (select (id) from company_name AS cn where country_code= '[us]');
create or replace view semiUp5228279010334745504 as select movie_id as v29, info_type_id as v26, info as v27 from movie_info_idx AS mi_idx where (info_type_id) in (select (id) from info_type AS it2 where info= 'rating') and info>'7.0';
create or replace view semiUp2806398914610296752 as select movie_id as v29, info_type_id as v21 from movie_info AS mi where (movie_id) in (select (v29) from semiUp5228279010334745504) and info IN ('Drama','Horror','Western','Family');
create or replace view semiUp1806396567284967473 as select v29, v1, v8 from semiUp4043875696775869904 where (v8) in (select (id) from company_type AS ct where kind= 'production companies');
create or replace view semiUp3423278943399847566 as select id as v29, title as v30 from title AS t where (id) in (select (v29) from semiUp1806396567284967473) and production_year>=2000 and production_year<=2010;
create or replace view semiUp5630038427863836277 as select v29, v21 from semiUp2806398914610296752 where (v29) in (select (v29) from semiUp3423278943399847566);
create or replace view semiUp411829676272288336 as select id as v21 from info_type AS it1 where (id) in (select (v21) from semiUp5630038427863836277) and info= 'genres';
create or replace view semiDown7451971895117036104 as select v29, v21 from semiUp5630038427863836277 where (v21) in (select (v21) from semiUp411829676272288336);
create or replace view semiDown5797831605760968797 as select v29, v26, v27 from semiUp5228279010334745504 where (v29) in (select (v29) from semiDown7451971895117036104);
create or replace view semiDown7536917212396266684 as select v29, v30 from semiUp3423278943399847566 where (v29) in (select (v29) from semiDown7451971895117036104);
create or replace view semiDown7830142686470414511 as select id as v26 from info_type AS it2 where (id) in (select (v26) from semiDown5797831605760968797) and info= 'rating';
create or replace view semiDown9003421735533308747 as select v29, v1, v8 from semiUp1806396567284967473 where (v29) in (select (v29) from semiDown7536917212396266684);
create or replace view semiDown1787551987560311084 as select id as v8 from company_type AS ct where (id) in (select (v8) from semiDown9003421735533308747) and kind= 'production companies';
create or replace view semiDown8923676376423580369 as select id as v1, name as v2 from company_name AS cn where (id) in (select (v1) from semiDown9003421735533308747) and country_code= '[us]';
create or replace view aggView1474816953471029938 as select v8 from semiDown1787551987560311084;
create or replace view aggJoin7256584587358282360 as select v29, v1 from semiDown9003421735533308747 join aggView1474816953471029938 using(v8);
create or replace view aggView3836524372994425875 as select v26 from semiDown7830142686470414511;
create or replace view aggJoin7739330016029195304 as select v29, v27 from semiDown5797831605760968797 join aggView3836524372994425875 using(v26);
create or replace view aggView5203714516162143182 as select v1, v2 as v41 from semiDown8923676376423580369;
create or replace view aggJoin988562398418541983 as select v29, v41 from aggJoin7256584587358282360 join aggView5203714516162143182 using(v1);
create or replace view aggView2624481468462074055 as select v29, MIN(v41) as v41 from aggJoin988562398418541983 group by v29;
create or replace view aggJoin7108869358643376026 as select v29, v30, v41 from semiDown7536917212396266684 join aggView2624481468462074055 using(v29);
create or replace view aggView158223903759843324 as select v29, MIN(v41) as v41, MIN(v30) as v43 from aggJoin7108869358643376026 group by v29;
create or replace view aggJoin7276290367719751545 as select v29, v21, v41, v43 from semiDown7451971895117036104 join aggView158223903759843324 using(v29);
create or replace view aggView2533040834200880089 as select v29, MIN(v27) as v42 from aggJoin7739330016029195304 group by v29;
create or replace view aggJoin4281612687745159853 as select v21, v41 as v41, v43 as v43, v42 from aggJoin7276290367719751545 join aggView2533040834200880089 using(v29);
create or replace view aggView4431928196436698978 as select v21, MIN(v41) as v41, MIN(v43) as v43, MIN(v42) as v42 from aggJoin4281612687745159853 group by v21;
create or replace view aggJoin6690718522364219770 as select v41, v43, v42 from semiUp411829676272288336 join aggView4431928196436698978 using(v21);
select MIN(v41) as v41,MIN(v42) as v42,MIN(v43) as v43 from aggJoin6690718522364219770;
