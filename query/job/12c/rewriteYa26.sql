create or replace view semiUp1348816538094172601 as select movie_id as v29, info_type_id as v26, info as v27 from movie_info_idx AS mi_idx where (info_type_id) in (select (id) from info_type AS it2 where info= 'rating') and info>'7.0';
create or replace view semiUp6508629909182240828 as select movie_id as v29, info_type_id as v21 from movie_info AS mi where (info_type_id) in (select (id) from info_type AS it1 where info= 'genres') and info IN ('Drama','Horror','Western','Family');
create or replace view semiUp2996923069125427526 as select v29, v21 from semiUp6508629909182240828 where (v29) in (select (id) from title AS t where production_year>=2000 and production_year<=2010);
create or replace view semiUp3424094493109143335 as select movie_id as v29, company_id as v1, company_type_id as v8 from movie_companies AS mc where (company_type_id) in (select (id) from company_type AS ct where kind= 'production companies');
create or replace view semiUp5531692371591259366 as select v29, v26, v27 from semiUp1348816538094172601 where (v29) in (select (v29) from semiUp2996923069125427526);
create or replace view semiUp2949150959898140389 as select v29, v1, v8 from semiUp3424094493109143335 where (v29) in (select (v29) from semiUp5531692371591259366);
create or replace view semiUp8943262320340026063 as select id as v1, name as v2 from company_name AS cn where (id) in (select (v1) from semiUp2949150959898140389) and country_code= '[us]';
create or replace view semiDown693404741766034646 as select v29, v1, v8 from semiUp2949150959898140389 where (v1) in (select (v1) from semiUp8943262320340026063);
create or replace view semiDown1046552579866179274 as select v29, v26, v27 from semiUp5531692371591259366 where (v29) in (select (v29) from semiDown693404741766034646);
create or replace view semiDown432322839670531540 as select id as v8 from company_type AS ct where (id) in (select (v8) from semiDown693404741766034646) and kind= 'production companies';
create or replace view semiDown6836755571437865173 as select v29, v21 from semiUp2996923069125427526 where (v29) in (select (v29) from semiDown1046552579866179274);
create or replace view semiDown9004783417066656214 as select id as v26 from info_type AS it2 where (id) in (select (v26) from semiDown1046552579866179274) and info= 'rating';
create or replace view semiDown3877560597906158838 as select id as v21 from info_type AS it1 where (id) in (select (v21) from semiDown6836755571437865173) and info= 'genres';
create or replace view semiDown474516830053396890 as select id as v29, title as v30 from title AS t where (id) in (select (v29) from semiDown6836755571437865173) and production_year>=2000 and production_year<=2010;
create or replace view aggView2833258855073093066 as select v29, v30 as v43 from semiDown474516830053396890;
create or replace view aggJoin2363317759523826644 as select v29, v21, v43 from semiDown6836755571437865173 join aggView2833258855073093066 using(v29);
create or replace view aggView7258019505882894766 as select v26 from semiDown9004783417066656214;
create or replace view aggJoin3485844513112412057 as select v29, v27 from semiDown1046552579866179274 join aggView7258019505882894766 using(v26);
create or replace view aggView3583183191058137196 as select v8 from semiDown432322839670531540;
create or replace view aggJoin9117068822459294150 as select v29, v1 from semiDown693404741766034646 join aggView3583183191058137196 using(v8);
create or replace view aggView3840270252177507504 as select v21 from semiDown3877560597906158838;
create or replace view aggJoin5540226362485995616 as select v29, v43 from aggJoin2363317759523826644 join aggView3840270252177507504 using(v21);
create or replace view aggView7211902186015078021 as select v29, MIN(v43) as v43 from aggJoin5540226362485995616 group by v29;
create or replace view aggJoin8613955279870367359 as select v29, v27, v43 from aggJoin3485844513112412057 join aggView7211902186015078021 using(v29);
create or replace view aggView2483419166828374774 as select v29, MIN(v43) as v43, MIN(v27) as v42 from aggJoin8613955279870367359 group by v29;
create or replace view aggJoin6003664001357906273 as select v1, v43, v42 from aggJoin9117068822459294150 join aggView2483419166828374774 using(v29);
create or replace view aggView3701114588180976127 as select v1, MIN(v43) as v43, MIN(v42) as v42 from aggJoin6003664001357906273 group by v1;
create or replace view aggJoin7938495857454334040 as select v2, v43, v42 from semiUp8943262320340026063 join aggView3701114588180976127 using(v1);
select MIN(v2) as v41,MIN(v42) as v42,MIN(v43) as v43 from aggJoin7938495857454334040;
