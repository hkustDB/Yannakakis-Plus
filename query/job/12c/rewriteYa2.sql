create or replace view semiUp2746268357917574577 as select movie_id as v29, company_id as v1, company_type_id as v8 from movie_companies AS mc where (company_type_id) in (select (id) from company_type AS ct where kind= 'production companies');
create or replace view semiUp1324814162329100003 as select movie_id as v29, info_type_id as v21 from movie_info AS mi where (info_type_id) in (select (id) from info_type AS it1 where info= 'genres') and info IN ('Drama','Horror','Western','Family');
create or replace view semiUp1116251025579982696 as select id as v29, title as v30 from title AS t where (id) in (select (v29) from semiUp1324814162329100003) and production_year>=2000 and production_year<=2010;
create or replace view semiUp4210327902244868150 as select v29, v1, v8 from semiUp2746268357917574577 where (v1) in (select (id) from company_name AS cn where country_code= '[us]');
create or replace view semiUp6494264872425341730 as select v29, v30 from semiUp1116251025579982696 where (v29) in (select (v29) from semiUp4210327902244868150);
create or replace view semiUp9197774380113761280 as select movie_id as v29, info_type_id as v26, info as v27 from movie_info_idx AS mi_idx where (movie_id) in (select (v29) from semiUp6494264872425341730) and info>'7.0';
create or replace view semiUp7859900813129171318 as select id as v26 from info_type AS it2 where (id) in (select (v26) from semiUp9197774380113761280) and info= 'rating';
create or replace view semiDown3577785780790321789 as select v29, v26, v27 from semiUp9197774380113761280 where (v26) in (select (v26) from semiUp7859900813129171318);
create or replace view semiDown6550522762709652586 as select v29, v30 from semiUp6494264872425341730 where (v29) in (select (v29) from semiDown3577785780790321789);
create or replace view semiDown3892281392948340530 as select v29, v1, v8 from semiUp4210327902244868150 where (v29) in (select (v29) from semiDown6550522762709652586);
create or replace view semiDown7993997110404868055 as select v29, v21 from semiUp1324814162329100003 where (v29) in (select (v29) from semiDown6550522762709652586);
create or replace view semiDown6236311612581126195 as select id as v8 from company_type AS ct where (id) in (select (v8) from semiDown3892281392948340530) and kind= 'production companies';
create or replace view semiDown1987805875818896465 as select id as v1, name as v2 from company_name AS cn where (id) in (select (v1) from semiDown3892281392948340530) and country_code= '[us]';
create or replace view semiDown6500240403202035365 as select id as v21 from info_type AS it1 where (id) in (select (v21) from semiDown7993997110404868055) and info= 'genres';
create or replace view aggView4288922535870317157 as select v1, v2 as v41 from semiDown1987805875818896465;
create or replace view aggJoin8731947173176580551 as select v29, v8, v41 from semiDown3892281392948340530 join aggView4288922535870317157 using(v1);
create or replace view aggView3219180542168167709 as select v21 from semiDown6500240403202035365;
create or replace view aggJoin4023213918144146049 as select v29 from semiDown7993997110404868055 join aggView3219180542168167709 using(v21);
create or replace view aggView3281190052814833280 as select v29 from aggJoin4023213918144146049 group by v29;
create or replace view aggJoin8487276144105303170 as select v29, v30 from semiDown6550522762709652586 join aggView3281190052814833280 using(v29);
create or replace view aggView5536101089671648883 as select v8 from semiDown6236311612581126195;
create or replace view aggJoin9178188104746890666 as select v29, v41 from aggJoin8731947173176580551 join aggView5536101089671648883 using(v8);
create or replace view aggView4887004445326931249 as select v29, MIN(v41) as v41 from aggJoin9178188104746890666 group by v29;
create or replace view aggJoin7026688631954823991 as select v29, v30, v41 from aggJoin8487276144105303170 join aggView4887004445326931249 using(v29);
create or replace view aggView5236609678009148719 as select v29, MIN(v41) as v41, MIN(v30) as v43 from aggJoin7026688631954823991 group by v29;
create or replace view aggJoin4137534646777265017 as select v26, v27, v41, v43 from semiDown3577785780790321789 join aggView5236609678009148719 using(v29);
create or replace view aggView4339863874121419840 as select v26, MIN(v41) as v41, MIN(v43) as v43, MIN(v27) as v42 from aggJoin4137534646777265017 group by v26;
create or replace view aggJoin3241208579257980906 as select v41, v43, v42 from semiUp7859900813129171318 join aggView4339863874121419840 using(v26);
select MIN(v41) as v41,MIN(v42) as v42,MIN(v43) as v43 from aggJoin3241208579257980906;
