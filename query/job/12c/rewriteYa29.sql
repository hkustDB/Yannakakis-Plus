create or replace view semiUp687884790708065930 as select movie_id as v29, info_type_id as v21 from movie_info AS mi where (info_type_id) in (select (id) from info_type AS it1 where info= 'genres') and info IN ('Drama','Horror','Western','Family');
create or replace view semiUp3297645523033318549 as select movie_id as v29, info_type_id as v26, info as v27 from movie_info_idx AS mi_idx where (info_type_id) in (select (id) from info_type AS it2 where info= 'rating') and info>'7.0';
create or replace view semiUp9185655056349811206 as select movie_id as v29, company_id as v1, company_type_id as v8 from movie_companies AS mc where (company_type_id) in (select (id) from company_type AS ct where kind= 'production companies');
create or replace view semiUp670652172548434298 as select v29, v26, v27 from semiUp3297645523033318549 where (v29) in (select (v29) from semiUp687884790708065930);
create or replace view semiUp962346049517708290 as select id as v29, title as v30 from title AS t where (id) in (select (v29) from semiUp670652172548434298) and production_year>=2000 and production_year<=2010;
create or replace view semiUp4735320055108847010 as select v29, v1, v8 from semiUp9185655056349811206 where (v29) in (select (v29) from semiUp962346049517708290);
create or replace view semiUp4841599531933571736 as select id as v1, name as v2 from company_name AS cn where (id) in (select (v1) from semiUp4735320055108847010) and country_code= '[us]';
create or replace view semiDown2369799390945646966 as select v29, v1, v8 from semiUp4735320055108847010 where (v1) in (select (v1) from semiUp4841599531933571736);
create or replace view semiDown8124188801848004132 as select v29, v30 from semiUp962346049517708290 where (v29) in (select (v29) from semiDown2369799390945646966);
create or replace view semiDown3352317673663113726 as select id as v8 from company_type AS ct where (id) in (select (v8) from semiDown2369799390945646966) and kind= 'production companies';
create or replace view semiDown4736740349090034528 as select v29, v26, v27 from semiUp670652172548434298 where (v29) in (select (v29) from semiDown8124188801848004132);
create or replace view semiDown8463803921337159871 as select v29, v21 from semiUp687884790708065930 where (v29) in (select (v29) from semiDown4736740349090034528);
create or replace view semiDown5941207554065320640 as select id as v26 from info_type AS it2 where (id) in (select (v26) from semiDown4736740349090034528) and info= 'rating';
create or replace view semiDown6398216226080619276 as select id as v21 from info_type AS it1 where (id) in (select (v21) from semiDown8463803921337159871) and info= 'genres';
create or replace view aggView72843876949364032 as select v26 from semiDown5941207554065320640;
create or replace view aggJoin957453363993752643 as select v29, v27 from semiDown4736740349090034528 join aggView72843876949364032 using(v26);
create or replace view aggView2273030628466539204 as select v8 from semiDown3352317673663113726;
create or replace view aggJoin6137200797258994210 as select v29, v1 from semiDown2369799390945646966 join aggView2273030628466539204 using(v8);
create or replace view aggView1710855586935384087 as select v21 from semiDown6398216226080619276;
create or replace view aggJoin1321891384535076988 as select v29 from semiDown8463803921337159871 join aggView1710855586935384087 using(v21);
create or replace view aggView2064038068598310528 as select v29 from aggJoin1321891384535076988 group by v29;
create or replace view aggJoin5760270443494170955 as select v29, v27 from aggJoin957453363993752643 join aggView2064038068598310528 using(v29);
create or replace view aggView500931638495931270 as select v29, MIN(v27) as v42 from aggJoin5760270443494170955 group by v29;
create or replace view aggJoin7281620492507010698 as select v29, v30, v42 from semiDown8124188801848004132 join aggView500931638495931270 using(v29);
create or replace view aggView6470068689556876524 as select v29, MIN(v42) as v42, MIN(v30) as v43 from aggJoin7281620492507010698 group by v29;
create or replace view aggJoin6535462514029599910 as select v1, v42, v43 from aggJoin6137200797258994210 join aggView6470068689556876524 using(v29);
create or replace view aggView1923064564601827639 as select v1, MIN(v42) as v42, MIN(v43) as v43 from aggJoin6535462514029599910 group by v1;
create or replace view aggJoin3616095917119738603 as select v2, v42, v43 from semiUp4841599531933571736 join aggView1923064564601827639 using(v1);
select MIN(v2) as v41,MIN(v42) as v42,MIN(v43) as v43 from aggJoin3616095917119738603;
