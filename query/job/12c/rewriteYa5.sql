create or replace view semiUp3940930411701698874 as select movie_id as v29, company_id as v1, company_type_id as v8 from movie_companies AS mc where (company_id) in (select (id) from company_name AS cn where country_code= '[us]');
create or replace view semiUp349137833700312220 as select movie_id as v29, info_type_id as v26, info as v27 from movie_info_idx AS mi_idx where (info_type_id) in (select (id) from info_type AS it2 where info= 'rating') and info>'7.0';
create or replace view semiUp6549174837331518945 as select id as v29, title as v30 from title AS t where (id) in (select (v29) from semiUp349137833700312220) and production_year>=2000 and production_year<=2010;
create or replace view semiUp5638948943808171502 as select movie_id as v29, info_type_id as v21 from movie_info AS mi where (movie_id) in (select (v29) from semiUp6549174837331518945) and info IN ('Drama','Horror','Western','Family');
create or replace view semiUp8249114684357742738 as select v29, v1, v8 from semiUp3940930411701698874 where (v8) in (select (id) from company_type AS ct where kind= 'production companies');
create or replace view semiUp5810874874917307494 as select v29, v21 from semiUp5638948943808171502 where (v29) in (select (v29) from semiUp8249114684357742738);
create or replace view semiUp5011280005264188337 as select id as v21 from info_type AS it1 where (id) in (select (v21) from semiUp5810874874917307494) and info= 'genres';
create or replace view semiDown4337917216473976176 as select v29, v21 from semiUp5810874874917307494 where (v21) in (select (v21) from semiUp5011280005264188337);
create or replace view semiDown7710993800730859678 as select v29, v30 from semiUp6549174837331518945 where (v29) in (select (v29) from semiDown4337917216473976176);
create or replace view semiDown652153912022464748 as select v29, v1, v8 from semiUp8249114684357742738 where (v29) in (select (v29) from semiDown4337917216473976176);
create or replace view semiDown4005627522724724068 as select v29, v26, v27 from semiUp349137833700312220 where (v29) in (select (v29) from semiDown7710993800730859678);
create or replace view semiDown5226016379089263185 as select id as v8 from company_type AS ct where (id) in (select (v8) from semiDown652153912022464748) and kind= 'production companies';
create or replace view semiDown5047826895560513037 as select id as v1, name as v2 from company_name AS cn where (id) in (select (v1) from semiDown652153912022464748) and country_code= '[us]';
create or replace view semiDown1965981291590660360 as select id as v26 from info_type AS it2 where (id) in (select (v26) from semiDown4005627522724724068) and info= 'rating';
create or replace view aggView2152406118697149643 as select v26 from semiDown1965981291590660360;
create or replace view aggJoin6870311929267906729 as select v29, v27 from semiDown4005627522724724068 join aggView2152406118697149643 using(v26);
create or replace view aggView9096189450895522049 as select v8 from semiDown5226016379089263185;
create or replace view aggJoin6535488035447686211 as select v29, v1 from semiDown652153912022464748 join aggView9096189450895522049 using(v8);
create or replace view aggView1944596569206448403 as select v1, v2 as v41 from semiDown5047826895560513037;
create or replace view aggJoin2704890604437881968 as select v29, v41 from aggJoin6535488035447686211 join aggView1944596569206448403 using(v1);
create or replace view aggView7862302576271730683 as select v29, MIN(v41) as v41 from aggJoin2704890604437881968 group by v29;
create or replace view aggJoin7600710771644995262 as select v29, v21, v41 from semiDown4337917216473976176 join aggView7862302576271730683 using(v29);
create or replace view aggView4755452767615146782 as select v29, MIN(v27) as v42 from aggJoin6870311929267906729 group by v29;
create or replace view aggJoin5930695965689533020 as select v29, v30, v42 from semiDown7710993800730859678 join aggView4755452767615146782 using(v29);
create or replace view aggView8766723226109659507 as select v29, MIN(v42) as v42, MIN(v30) as v43 from aggJoin5930695965689533020 group by v29;
create or replace view aggJoin546766288092962379 as select v21, v41 as v41, v42, v43 from aggJoin7600710771644995262 join aggView8766723226109659507 using(v29);
create or replace view aggView5857712435462868839 as select v21, MIN(v41) as v41, MIN(v42) as v42, MIN(v43) as v43 from aggJoin546766288092962379 group by v21;
create or replace view aggJoin4729422970202309693 as select v41, v42, v43 from semiUp5011280005264188337 join aggView5857712435462868839 using(v21);
select MIN(v41) as v41,MIN(v42) as v42,MIN(v43) as v43 from aggJoin4729422970202309693;
