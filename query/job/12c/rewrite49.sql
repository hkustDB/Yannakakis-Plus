create or replace view aggView2408998601741602857 as select id as v29, title as v43 from title as t where production_year>=2000 and production_year<=2010;
create or replace view aggJoin7974364558435780277 as select movie_id as v29, info_type_id as v21, info as v22, v43 from movie_info as mi, aggView2408998601741602857 where mi.movie_id=aggView2408998601741602857.v29 and info IN ('Drama','Horror','Western','Family');
create or replace view aggView752363498994978073 as select id as v1, name as v41 from company_name as cn where country_code= '[us]';
create or replace view aggJoin526251655979836211 as select movie_id as v29, company_type_id as v8, v41 from movie_companies as mc, aggView752363498994978073 where mc.company_id=aggView752363498994978073.v1;
create or replace view aggView8222086300610781941 as select id as v21 from info_type as it1 where info= 'genres';
create or replace view aggJoin193082139755197092 as select v29, v22, v43 from aggJoin7974364558435780277 join aggView8222086300610781941 using(v21);
create or replace view aggView338638386751521885 as select v29, MIN(v43) as v43 from aggJoin193082139755197092 group by v29;
create or replace view aggJoin8247650535482771823 as select movie_id as v29, info_type_id as v26, info as v27, v43 from movie_info_idx as mi_idx, aggView338638386751521885 where mi_idx.movie_id=aggView338638386751521885.v29 and info>'7.0';
create or replace view aggView8799246781300626141 as select id as v8 from company_type as ct where kind= 'production companies';
create or replace view aggJoin111596467976431971 as select v29, v41 from aggJoin526251655979836211 join aggView8799246781300626141 using(v8);
create or replace view aggView2704021890297696501 as select v29, MIN(v41) as v41 from aggJoin111596467976431971 group by v29;
create or replace view aggJoin8606572921598656494 as select v26, v27, v43 as v43, v41 from aggJoin8247650535482771823 join aggView2704021890297696501 using(v29);
create or replace view aggView2644838491503469241 as select id as v26 from info_type as it2 where info= 'rating';
create or replace view aggJoin6301495641344517512 as select v27, v43, v41 from aggJoin8606572921598656494 join aggView2644838491503469241 using(v26);
create or replace view res as select MIN(v41) as v41, MIN(v27) as v42, MIN(v43) as v43 from aggJoin6301495641344517512;
select sum(v41+v42+v43) from res;