create or replace view semiUp6885720621575268378 as select movie_id as v29, info_type_id as v26, info as v27 from movie_info_idx AS mi_idx where (info_type_id) in (select (id) from info_type AS it2 where info= 'rating') and info>'7.0';
create or replace view semiUp7957636383194037877 as select movie_id as v29, company_id as v1, company_type_id as v8 from movie_companies AS mc where (company_id) in (select (id) from company_name AS cn where country_code= '[us]');
create or replace view semiUp1918783560259552117 as select v29, v1, v8 from semiUp7957636383194037877 where (v8) in (select (id) from company_type AS ct where kind= 'production companies');
create or replace view semiUp3842942034798669106 as select movie_id as v29, info_type_id as v21 from movie_info AS mi where (info_type_id) in (select (id) from info_type AS it1 where info= 'genres') and info IN ('Drama','Horror','Western','Family');
create or replace view semiUp9210463156656118012 as select v29, v26, v27 from semiUp6885720621575268378 where (v29) in (select (v29) from semiUp1918783560259552117);
create or replace view semiUp1074711371549262683 as select id as v29, title as v30 from title AS t where (id) in (select (v29) from semiUp9210463156656118012) and production_year>=2000 and production_year<=2010;
create or replace view semiUp2361152453434522885 as select v29, v30 from semiUp1074711371549262683 where (v29) in (select (v29) from semiUp3842942034798669106);
create or replace view semiDown379702347882060325 as select v29, v21 from semiUp3842942034798669106 where (v29) in (select (v29) from semiUp2361152453434522885);
create or replace view semiDown4794225929670776043 as select v29, v26, v27 from semiUp9210463156656118012 where (v29) in (select (v29) from semiUp2361152453434522885);
create or replace view semiDown6507948031658130236 as select id as v21 from info_type AS it1 where (id) in (select (v21) from semiDown379702347882060325) and info= 'genres';
create or replace view semiDown1158067297486531509 as select v29, v1, v8 from semiUp1918783560259552117 where (v29) in (select (v29) from semiDown4794225929670776043);
create or replace view semiDown2952615731804840004 as select id as v26 from info_type AS it2 where (id) in (select (v26) from semiDown4794225929670776043) and info= 'rating';
create or replace view semiDown4992855373768734715 as select id as v8 from company_type AS ct where (id) in (select (v8) from semiDown1158067297486531509) and kind= 'production companies';
create or replace view semiDown4198885426828630894 as select id as v1, name as v2 from company_name AS cn where (id) in (select (v1) from semiDown1158067297486531509) and country_code= '[us]';
create or replace view aggView8810677309309898179 as select v21 from semiDown6507948031658130236;
create or replace view aggJoin5035931568403039924 as select v29 from semiDown379702347882060325 join aggView8810677309309898179 using(v21);
create or replace view aggView7711470997629501169 as select v1, v2 as v41 from semiDown4198885426828630894;
create or replace view aggJoin5657609983865893424 as select v29, v8, v41 from semiDown1158067297486531509 join aggView7711470997629501169 using(v1);
create or replace view aggView561241847115452507 as select v26 from semiDown2952615731804840004;
create or replace view aggJoin5587956617864722526 as select v29, v27 from semiDown4794225929670776043 join aggView561241847115452507 using(v26);
create or replace view aggView2702351548597281818 as select v8 from semiDown4992855373768734715;
create or replace view aggJoin3542282245157280187 as select v29, v41 from aggJoin5657609983865893424 join aggView2702351548597281818 using(v8);
create or replace view aggView1775636969688905254 as select v29, MIN(v41) as v41 from aggJoin3542282245157280187 group by v29;
create or replace view aggJoin1175619151985583770 as select v29, v27, v41 from aggJoin5587956617864722526 join aggView1775636969688905254 using(v29);
create or replace view aggView8800940229387205846 as select v29 from aggJoin5035931568403039924 group by v29;
create or replace view aggJoin7041512165159814927 as select v29, v30 from semiUp2361152453434522885 join aggView8800940229387205846 using(v29);
create or replace view aggView8568002121772028207 as select v29, MIN(v41) as v41, MIN(v27) as v42 from aggJoin1175619151985583770 group by v29;
create or replace view aggJoin7292037815836303479 as select v30, v41, v42 from aggJoin7041512165159814927 join aggView8568002121772028207 using(v29);
select MIN(v41) as v41,MIN(v42) as v42,MIN(v30) as v43 from aggJoin7292037815836303479;
