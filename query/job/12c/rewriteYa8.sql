create or replace view semiUp3355365939990022754 as select movie_id as v29, info_type_id as v26, info as v27 from movie_info_idx AS mi_idx where (movie_id) in (select (id) from title AS t where production_year>=2000 and production_year<=2010) and info>'7.0';
create or replace view semiUp7673817033466851150 as select movie_id as v29, company_id as v1, company_type_id as v8 from movie_companies AS mc where (company_id) in (select (id) from company_name AS cn where country_code= '[us]');
create or replace view semiUp1605090510566713656 as select v29, v26, v27 from semiUp3355365939990022754 where (v26) in (select (id) from info_type AS it2 where info= 'rating');
create or replace view semiUp1620412479344315139 as select movie_id as v29, info_type_id as v21 from movie_info AS mi where (movie_id) in (select (v29) from semiUp1605090510566713656) and info IN ('Drama','Horror','Western','Family');
create or replace view semiUp5882262712172773965 as select v29, v21 from semiUp1620412479344315139 where (v21) in (select (id) from info_type AS it1 where info= 'genres');
create or replace view semiUp3741350062154470389 as select v29, v1, v8 from semiUp7673817033466851150 where (v29) in (select (v29) from semiUp5882262712172773965);
create or replace view semiUp8233740518704188794 as select id as v8 from company_type AS ct where (id) in (select (v8) from semiUp3741350062154470389) and kind= 'production companies';
create or replace view semiDown7177061806918525224 as select v29, v1, v8 from semiUp3741350062154470389 where (v8) in (select (v8) from semiUp8233740518704188794);
create or replace view semiDown1972666943793403106 as select id as v1, name as v2 from company_name AS cn where (id) in (select (v1) from semiDown7177061806918525224) and country_code= '[us]';
create or replace view semiDown9183408701014899317 as select v29, v21 from semiUp5882262712172773965 where (v29) in (select (v29) from semiDown7177061806918525224);
create or replace view semiDown2630692496575586465 as select v29, v26, v27 from semiUp1605090510566713656 where (v29) in (select (v29) from semiDown9183408701014899317);
create or replace view semiDown7684490762679697324 as select id as v21 from info_type AS it1 where (id) in (select (v21) from semiDown9183408701014899317) and info= 'genres';
create or replace view semiDown5532770522528349256 as select id as v29, title as v30 from title AS t where (id) in (select (v29) from semiDown2630692496575586465) and production_year>=2000 and production_year<=2010;
create or replace view semiDown5600604179096973566 as select id as v26 from info_type AS it2 where (id) in (select (v26) from semiDown2630692496575586465) and info= 'rating';
create or replace view aggView2255597350111343255 as select v21 from semiDown7684490762679697324;
create or replace view aggJoin9172118856604882571 as select v29 from semiDown9183408701014899317 join aggView2255597350111343255 using(v21);
create or replace view aggView9069198884946405874 as select v29, v30 as v43 from semiDown5532770522528349256;
create or replace view aggJoin5893481345975907522 as select v29, v26, v27, v43 from semiDown2630692496575586465 join aggView9069198884946405874 using(v29);
create or replace view aggView4431137486620076794 as select v1, v2 as v41 from semiDown1972666943793403106;
create or replace view aggJoin6519822417929396323 as select v29, v8, v41 from semiDown7177061806918525224 join aggView4431137486620076794 using(v1);
create or replace view aggView5003015612012409581 as select v26 from semiDown5600604179096973566;
create or replace view aggJoin254226843334904334 as select v29, v27, v43 from aggJoin5893481345975907522 join aggView5003015612012409581 using(v26);
create or replace view aggView6982616598245147745 as select v29, MIN(v43) as v43, MIN(v27) as v42 from aggJoin254226843334904334 group by v29;
create or replace view aggJoin6504542047692326872 as select v29, v43, v42 from aggJoin9172118856604882571 join aggView6982616598245147745 using(v29);
create or replace view aggView6098509630328615530 as select v29, MIN(v43) as v43, MIN(v42) as v42 from aggJoin6504542047692326872 group by v29;
create or replace view aggJoin8089842605131601460 as select v8, v41 as v41, v43, v42 from aggJoin6519822417929396323 join aggView6098509630328615530 using(v29);
create or replace view aggView4049246887832022777 as select v8, MIN(v41) as v41, MIN(v43) as v43, MIN(v42) as v42 from aggJoin8089842605131601460 group by v8;
create or replace view aggJoin5911317362048272716 as select v41, v43, v42 from semiUp8233740518704188794 join aggView4049246887832022777 using(v8);
select MIN(v41) as v41,MIN(v42) as v42,MIN(v43) as v43 from aggJoin5911317362048272716;
