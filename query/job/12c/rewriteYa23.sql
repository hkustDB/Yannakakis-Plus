create or replace view semiUp2674787878859667471 as select movie_id as v29, company_id as v1, company_type_id as v8 from movie_companies AS mc where (company_type_id) in (select (id) from company_type AS ct where kind= 'production companies');
create or replace view semiUp740287661012795636 as select movie_id as v29, info_type_id as v26, info as v27 from movie_info_idx AS mi_idx where (info_type_id) in (select (id) from info_type AS it2 where info= 'rating') and info>'7.0';
create or replace view semiUp1103090224301820678 as select id as v29, title as v30 from title AS t where (id) in (select (v29) from semiUp740287661012795636) and production_year>=2000 and production_year<=2010;
create or replace view semiUp2092003020116955289 as select v29, v1, v8 from semiUp2674787878859667471 where (v1) in (select (id) from company_name AS cn where country_code= '[us]');
create or replace view semiUp6800266700538183976 as select v29, v30 from semiUp1103090224301820678 where (v29) in (select (v29) from semiUp2092003020116955289);
create or replace view semiUp271660819169613937 as select movie_id as v29, info_type_id as v21 from movie_info AS mi where (movie_id) in (select (v29) from semiUp6800266700538183976) and info IN ('Drama','Horror','Western','Family');
create or replace view semiUp136955760065389728 as select id as v21 from info_type AS it1 where (id) in (select (v21) from semiUp271660819169613937) and info= 'genres';
create or replace view semiDown5820637021982351234 as select v29, v21 from semiUp271660819169613937 where (v21) in (select (v21) from semiUp136955760065389728);
create or replace view semiDown1767706329893750236 as select v29, v30 from semiUp6800266700538183976 where (v29) in (select (v29) from semiDown5820637021982351234);
create or replace view semiDown5978495508923990460 as select v29, v1, v8 from semiUp2092003020116955289 where (v29) in (select (v29) from semiDown1767706329893750236);
create or replace view semiDown1434270578069714241 as select v29, v26, v27 from semiUp740287661012795636 where (v29) in (select (v29) from semiDown1767706329893750236);
create or replace view semiDown3942678593053062356 as select id as v8 from company_type AS ct where (id) in (select (v8) from semiDown5978495508923990460) and kind= 'production companies';
create or replace view semiDown7372117899870026617 as select id as v1, name as v2 from company_name AS cn where (id) in (select (v1) from semiDown5978495508923990460) and country_code= '[us]';
create or replace view semiDown3774132388491777966 as select id as v26 from info_type AS it2 where (id) in (select (v26) from semiDown1434270578069714241) and info= 'rating';
create or replace view aggView6035562473756550456 as select v26 from semiDown3774132388491777966;
create or replace view aggJoin8341914101850061179 as select v29, v27 from semiDown1434270578069714241 join aggView6035562473756550456 using(v26);
create or replace view aggView3565772307483393662 as select v29, MIN(v27) as v42 from aggJoin8341914101850061179 group by v29;
create or replace view aggJoin3112472655288682880 as select v29, v30, v42 from semiDown1767706329893750236 join aggView3565772307483393662 using(v29);
create or replace view aggView212780066610227064 as select v1, v2 as v41 from semiDown7372117899870026617;
create or replace view aggJoin3617646958568348318 as select v29, v8, v41 from semiDown5978495508923990460 join aggView212780066610227064 using(v1);
create or replace view aggView2507760023665594696 as select v8 from semiDown3942678593053062356;
create or replace view aggJoin3735825681826311286 as select v29, v41 from aggJoin3617646958568348318 join aggView2507760023665594696 using(v8);
create or replace view aggView7131363750488037659 as select v29, MIN(v41) as v41 from aggJoin3735825681826311286 group by v29;
create or replace view aggJoin4695007849630802285 as select v29, v30, v42 as v42, v41 from aggJoin3112472655288682880 join aggView7131363750488037659 using(v29);
create or replace view aggView5477600442631488434 as select v29, MIN(v42) as v42, MIN(v41) as v41, MIN(v30) as v43 from aggJoin4695007849630802285 group by v29;
create or replace view aggJoin4553576969193666689 as select v21, v42, v41, v43 from semiDown5820637021982351234 join aggView5477600442631488434 using(v29);
create or replace view aggView6618482294181766245 as select v21, MIN(v42) as v42, MIN(v41) as v41, MIN(v43) as v43 from aggJoin4553576969193666689 group by v21;
create or replace view aggJoin2665792265796884108 as select v42, v41, v43 from semiUp136955760065389728 join aggView6618482294181766245 using(v21);
select MIN(v41) as v41,MIN(v42) as v42,MIN(v43) as v43 from aggJoin2665792265796884108;
