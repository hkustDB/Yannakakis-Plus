create or replace view semiUp4337675745290538776 as select movie_id as v29, info_type_id as v26, info as v27 from movie_info_idx AS mi_idx where (info_type_id) in (select (id) from info_type AS it2 where info= 'rating') and info>'7.0';
create or replace view semiUp447326840527080578 as select movie_id as v29, company_id as v1, company_type_id as v8 from movie_companies AS mc where (company_id) in (select (id) from company_name AS cn where country_code= '[us]');
create or replace view semiUp1205094745531840996 as select v29, v1, v8 from semiUp447326840527080578 where (v8) in (select (id) from company_type AS ct where kind= 'production companies');
create or replace view semiUp3748994066209496382 as select movie_id as v29, info_type_id as v21 from movie_info AS mi where (movie_id) in (select (v29) from semiUp1205094745531840996) and info IN ('Drama','Horror','Western','Family');
create or replace view semiUp2204344973712595945 as select v29, v21 from semiUp3748994066209496382 where (v21) in (select (id) from info_type AS it1 where info= 'genres');
create or replace view semiUp303090817535286966 as select id as v29, title as v30 from title AS t where (id) in (select (v29) from semiUp2204344973712595945) and production_year>=2000 and production_year<=2010;
create or replace view semiUp402114043457601319 as select v29, v26, v27 from semiUp4337675745290538776 where (v29) in (select (v29) from semiUp303090817535286966);
create or replace view semiDown5374294046614011695 as select v29, v30 from semiUp303090817535286966 where (v29) in (select (v29) from semiUp402114043457601319);
create or replace view semiDown3984049507340261281 as select id as v26 from info_type AS it2 where (id) in (select (v26) from semiUp402114043457601319) and info= 'rating';
create or replace view semiDown88579237345084309 as select v29, v21 from semiUp2204344973712595945 where (v29) in (select (v29) from semiDown5374294046614011695);
create or replace view semiDown4279841726542728559 as select id as v21 from info_type AS it1 where (id) in (select (v21) from semiDown88579237345084309) and info= 'genres';
create or replace view semiDown2343526697381468603 as select v29, v1, v8 from semiUp1205094745531840996 where (v29) in (select (v29) from semiDown88579237345084309);
create or replace view semiDown7639282408204145466 as select id as v8 from company_type AS ct where (id) in (select (v8) from semiDown2343526697381468603) and kind= 'production companies';
create or replace view semiDown1754279108941429463 as select id as v1, name as v2 from company_name AS cn where (id) in (select (v1) from semiDown2343526697381468603) and country_code= '[us]';
create or replace view aggView6010696842010311192 as select v1, v2 as v41 from semiDown1754279108941429463;
create or replace view aggJoin7998141032297792017 as select v29, v8, v41 from semiDown2343526697381468603 join aggView6010696842010311192 using(v1);
create or replace view aggView8442133351087838783 as select v21 from semiDown4279841726542728559;
create or replace view aggJoin1489553055320036195 as select v29 from semiDown88579237345084309 join aggView8442133351087838783 using(v21);
create or replace view aggView2241629298245921417 as select v26 from semiDown3984049507340261281;
create or replace view aggJoin7509738685290098814 as select v29, v27 from semiUp402114043457601319 join aggView2241629298245921417 using(v26);
create or replace view aggView6610926821327790741 as select v8 from semiDown7639282408204145466;
create or replace view aggJoin6647933529685754538 as select v29, v41 from aggJoin7998141032297792017 join aggView6610926821327790741 using(v8);
create or replace view aggView3068260179073683719 as select v29, MIN(v41) as v41 from aggJoin6647933529685754538 group by v29;
create or replace view aggJoin9081076145015990088 as select v29, v41 from aggJoin1489553055320036195 join aggView3068260179073683719 using(v29);
create or replace view aggView1529224802932199859 as select v29, MIN(v41) as v41 from aggJoin9081076145015990088 group by v29;
create or replace view aggJoin6624780590160841429 as select v29, v30, v41 from semiDown5374294046614011695 join aggView1529224802932199859 using(v29);
create or replace view aggView8530153472314274711 as select v29, MIN(v41) as v41, MIN(v30) as v43 from aggJoin6624780590160841429 group by v29;
create or replace view aggJoin1401127035443940093 as select v27, v41, v43 from aggJoin7509738685290098814 join aggView8530153472314274711 using(v29);
select MIN(v41) as v41,MIN(v27) as v42,MIN(v43) as v43 from aggJoin1401127035443940093;
