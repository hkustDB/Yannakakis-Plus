create or replace view semiUp5679282517635617045 as select movie_id as v29, company_id as v1, company_type_id as v8 from movie_companies AS mc where (company_id) in (select (id) from company_name AS cn where country_code= '[us]');
create or replace view semiUp2968722037672252196 as select movie_id as v29, info_type_id as v26, info as v27 from movie_info_idx AS mi_idx where (info_type_id) in (select (id) from info_type AS it2 where info= 'rating') and info>'7.0';
create or replace view semiUp3920977225794561045 as select movie_id as v29, info_type_id as v21 from movie_info AS mi where (info_type_id) in (select (id) from info_type AS it1 where info= 'genres') and info IN ('Drama','Horror','Western','Family');
create or replace view semiUp4927065963036712511 as select v29, v1, v8 from semiUp5679282517635617045 where (v8) in (select (id) from company_type AS ct where kind= 'production companies');
create or replace view semiUp123375930862136197 as select v29, v21 from semiUp3920977225794561045 where (v29) in (select (v29) from semiUp4927065963036712511);
create or replace view semiUp5189139623465727867 as select v29, v26, v27 from semiUp2968722037672252196 where (v29) in (select (v29) from semiUp123375930862136197);
create or replace view semiUp5561060613039243925 as select id as v29, title as v30 from title AS t where (id) in (select (v29) from semiUp5189139623465727867) and production_year>=2000 and production_year<=2010;
create or replace view semiDown7213805774453429032 as select v29, v26, v27 from semiUp5189139623465727867 where (v29) in (select (v29) from semiUp5561060613039243925);
create or replace view semiDown875176793142385177 as select v29, v21 from semiUp123375930862136197 where (v29) in (select (v29) from semiDown7213805774453429032);
create or replace view semiDown4879390796169998433 as select id as v26 from info_type AS it2 where (id) in (select (v26) from semiDown7213805774453429032) and info= 'rating';
create or replace view semiDown4662335441115458658 as select id as v21 from info_type AS it1 where (id) in (select (v21) from semiDown875176793142385177) and info= 'genres';
create or replace view semiDown6115228348002419321 as select v29, v1, v8 from semiUp4927065963036712511 where (v29) in (select (v29) from semiDown875176793142385177);
create or replace view semiDown6144202344014828012 as select id as v8 from company_type AS ct where (id) in (select (v8) from semiDown6115228348002419321) and kind= 'production companies';
create or replace view semiDown7865627269900590838 as select id as v1, name as v2 from company_name AS cn where (id) in (select (v1) from semiDown6115228348002419321) and country_code= '[us]';
create or replace view aggView800707223386894933 as select v8 from semiDown6144202344014828012;
create or replace view aggJoin6808178714682360325 as select v29, v1 from semiDown6115228348002419321 join aggView800707223386894933 using(v8);
create or replace view aggView1053193443153133627 as select v26 from semiDown4879390796169998433;
create or replace view aggJoin2853968322259841453 as select v29, v27 from semiDown7213805774453429032 join aggView1053193443153133627 using(v26);
create or replace view aggView5322079570392594578 as select v21 from semiDown4662335441115458658;
create or replace view aggJoin8814034588875285486 as select v29 from semiDown875176793142385177 join aggView5322079570392594578 using(v21);
create or replace view aggView153498452929126944 as select v1, v2 as v41 from semiDown7865627269900590838;
create or replace view aggJoin7921300702968621682 as select v29, v41 from aggJoin6808178714682360325 join aggView153498452929126944 using(v1);
create or replace view aggView8362035439788914939 as select v29, MIN(v41) as v41 from aggJoin7921300702968621682 group by v29;
create or replace view aggJoin9051554867139358884 as select v29, v41 from aggJoin8814034588875285486 join aggView8362035439788914939 using(v29);
create or replace view aggView5648195285175677717 as select v29, MIN(v41) as v41 from aggJoin9051554867139358884 group by v29;
create or replace view aggJoin475985247547339832 as select v29, v27, v41 from aggJoin2853968322259841453 join aggView5648195285175677717 using(v29);
create or replace view aggView6838373569436973127 as select v29, MIN(v41) as v41, MIN(v27) as v42 from aggJoin475985247547339832 group by v29;
create or replace view aggJoin5671767345660012930 as select v30, v41, v42 from semiUp5561060613039243925 join aggView6838373569436973127 using(v29);
select MIN(v41) as v41,MIN(v42) as v42,MIN(v30) as v43 from aggJoin5671767345660012930;
