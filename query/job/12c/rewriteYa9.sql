create or replace view semiUp6736547220043327734 as select movie_id as v29, company_id as v1, company_type_id as v8 from movie_companies AS mc where (company_type_id) in (select (id) from company_type AS ct where kind= 'production companies');
create or replace view semiUp5583795154803018729 as select v29, v1, v8 from semiUp6736547220043327734 where (v1) in (select (id) from company_name AS cn where country_code= '[us]');
create or replace view semiUp8943011903496819385 as select movie_id as v29, info_type_id as v26, info as v27 from movie_info_idx AS mi_idx where (info_type_id) in (select (id) from info_type AS it2 where info= 'rating') and info>'7.0';
create or replace view semiUp4154692544292423770 as select id as v29, title as v30 from title AS t where (id) in (select (v29) from semiUp5583795154803018729) and production_year>=2000 and production_year<=2010;
create or replace view semiUp329839138483356578 as select v29, v26, v27 from semiUp8943011903496819385 where (v29) in (select (v29) from semiUp4154692544292423770);
create or replace view semiUp6828340563426215844 as select movie_id as v29, info_type_id as v21 from movie_info AS mi where (movie_id) in (select (v29) from semiUp329839138483356578) and info IN ('Drama','Horror','Western','Family');
create or replace view semiUp5338079200922802476 as select id as v21 from info_type AS it1 where (id) in (select (v21) from semiUp6828340563426215844) and info= 'genres';
create or replace view semiDown5093724330515040823 as select v29, v21 from semiUp6828340563426215844 where (v21) in (select (v21) from semiUp5338079200922802476);
create or replace view semiDown8976186644361877315 as select v29, v26, v27 from semiUp329839138483356578 where (v29) in (select (v29) from semiDown5093724330515040823);
create or replace view semiDown8117081708514868391 as select v29, v30 from semiUp4154692544292423770 where (v29) in (select (v29) from semiDown8976186644361877315);
create or replace view semiDown1150524318580383247 as select id as v26 from info_type AS it2 where (id) in (select (v26) from semiDown8976186644361877315) and info= 'rating';
create or replace view semiDown1567647263438697686 as select v29, v1, v8 from semiUp5583795154803018729 where (v29) in (select (v29) from semiDown8117081708514868391);
create or replace view semiDown4090079767393244077 as select id as v8 from company_type AS ct where (id) in (select (v8) from semiDown1567647263438697686) and kind= 'production companies';
create or replace view semiDown3224963215973268018 as select id as v1, name as v2 from company_name AS cn where (id) in (select (v1) from semiDown1567647263438697686) and country_code= '[us]';
create or replace view aggView7813718392689262084 as select v1, v2 as v41 from semiDown3224963215973268018;
create or replace view aggJoin3177205144667122092 as select v29, v8, v41 from semiDown1567647263438697686 join aggView7813718392689262084 using(v1);
create or replace view aggView7598303033894422667 as select v26 from semiDown1150524318580383247;
create or replace view aggJoin8316456701570674322 as select v29, v27 from semiDown8976186644361877315 join aggView7598303033894422667 using(v26);
create or replace view aggView3110718697618859442 as select v8 from semiDown4090079767393244077;
create or replace view aggJoin6855040337411561017 as select v29, v41 from aggJoin3177205144667122092 join aggView3110718697618859442 using(v8);
create or replace view aggView4937588472158536593 as select v29, MIN(v41) as v41 from aggJoin6855040337411561017 group by v29;
create or replace view aggJoin6008533871758465085 as select v29, v30, v41 from semiDown8117081708514868391 join aggView4937588472158536593 using(v29);
create or replace view aggView5811002759997957616 as select v29, MIN(v41) as v41, MIN(v30) as v43 from aggJoin6008533871758465085 group by v29;
create or replace view aggJoin6438393401921392382 as select v29, v27, v41, v43 from aggJoin8316456701570674322 join aggView5811002759997957616 using(v29);
create or replace view aggView3545066489886782494 as select v29, MIN(v41) as v41, MIN(v43) as v43, MIN(v27) as v42 from aggJoin6438393401921392382 group by v29;
create or replace view aggJoin1443284770345336629 as select v21, v41, v43, v42 from semiDown5093724330515040823 join aggView3545066489886782494 using(v29);
create or replace view aggView3078929632785245510 as select v21, MIN(v41) as v41, MIN(v43) as v43, MIN(v42) as v42 from aggJoin1443284770345336629 group by v21;
create or replace view aggJoin6796946092965303815 as select v41, v43, v42 from semiUp5338079200922802476 join aggView3078929632785245510 using(v21);
select MIN(v41) as v41,MIN(v42) as v42,MIN(v43) as v43 from aggJoin6796946092965303815;
