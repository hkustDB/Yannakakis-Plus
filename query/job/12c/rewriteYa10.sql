create or replace view semiUp8909089552823285037 as select movie_id as v29, info_type_id as v26, info as v27 from movie_info_idx AS mi_idx where (info_type_id) in (select (id) from info_type AS it2 where info= 'rating') and info>'7.0';
create or replace view semiUp7034820934355905688 as select movie_id as v29, company_id as v1, company_type_id as v8 from movie_companies AS mc where (company_id) in (select (id) from company_name AS cn where country_code= '[us]');
create or replace view semiUp8270851034224380934 as select v29, v1, v8 from semiUp7034820934355905688 where (v8) in (select (id) from company_type AS ct where kind= 'production companies');
create or replace view semiUp794955002303371194 as select id as v29, title as v30 from title AS t where (id) in (select (v29) from semiUp8909089552823285037) and production_year>=2000 and production_year<=2010;
create or replace view semiUp2130112971569625554 as select movie_id as v29, info_type_id as v21 from movie_info AS mi where (info_type_id) in (select (id) from info_type AS it1 where info= 'genres') and info IN ('Drama','Horror','Western','Family');
create or replace view semiUp2271483631317490307 as select v29, v30 from semiUp794955002303371194 where (v29) in (select (v29) from semiUp8270851034224380934);
create or replace view semiUp1243690821052503638 as select v29, v21 from semiUp2130112971569625554 where (v29) in (select (v29) from semiUp2271483631317490307);
create or replace view semiDown3946894839627138387 as select id as v21 from info_type AS it1 where (id) in (select (v21) from semiUp1243690821052503638) and info= 'genres';
create or replace view semiDown3782824288955166260 as select v29, v30 from semiUp2271483631317490307 where (v29) in (select (v29) from semiUp1243690821052503638);
create or replace view semiDown4731686688756528962 as select v29, v1, v8 from semiUp8270851034224380934 where (v29) in (select (v29) from semiDown3782824288955166260);
create or replace view semiDown4143519178736184415 as select v29, v26, v27 from semiUp8909089552823285037 where (v29) in (select (v29) from semiDown3782824288955166260);
create or replace view semiDown5500856127946286088 as select id as v8 from company_type AS ct where (id) in (select (v8) from semiDown4731686688756528962) and kind= 'production companies';
create or replace view semiDown7642832096613524719 as select id as v1, name as v2 from company_name AS cn where (id) in (select (v1) from semiDown4731686688756528962) and country_code= '[us]';
create or replace view semiDown8796944729947643150 as select id as v26 from info_type AS it2 where (id) in (select (v26) from semiDown4143519178736184415) and info= 'rating';
create or replace view aggView1580754725974986197 as select v1, v2 as v41 from semiDown7642832096613524719;
create or replace view aggJoin1806345974845310956 as select v29, v8, v41 from semiDown4731686688756528962 join aggView1580754725974986197 using(v1);
create or replace view aggView4553537176334005286 as select v21 from semiDown3946894839627138387;
create or replace view aggJoin6403801640757751585 as select v29 from semiUp1243690821052503638 join aggView4553537176334005286 using(v21);
create or replace view aggView2666222461503533739 as select v8 from semiDown5500856127946286088;
create or replace view aggJoin2904144996955689178 as select v29, v41 from aggJoin1806345974845310956 join aggView2666222461503533739 using(v8);
create or replace view aggView7583913824713779231 as select v26 from semiDown8796944729947643150;
create or replace view aggJoin6482269294858080383 as select v29, v27 from semiDown4143519178736184415 join aggView7583913824713779231 using(v26);
create or replace view aggView8888803622840370085 as select v29, MIN(v27) as v42 from aggJoin6482269294858080383 group by v29;
create or replace view aggJoin5381560201200029066 as select v29, v30, v42 from semiDown3782824288955166260 join aggView8888803622840370085 using(v29);
create or replace view aggView5990581671611209614 as select v29, MIN(v41) as v41 from aggJoin2904144996955689178 group by v29;
create or replace view aggJoin8396560884216480598 as select v29, v30, v42 as v42, v41 from aggJoin5381560201200029066 join aggView5990581671611209614 using(v29);
create or replace view aggView2671841808664766517 as select v29, MIN(v42) as v42, MIN(v41) as v41, MIN(v30) as v43 from aggJoin8396560884216480598 group by v29;
create or replace view aggJoin7159417584835732195 as select v42, v41, v43 from aggJoin6403801640757751585 join aggView2671841808664766517 using(v29);
select MIN(v41) as v41,MIN(v42) as v42,MIN(v43) as v43 from aggJoin7159417584835732195;
