create or replace view semiUp2554178070243555502 as select movie_id as v29, company_id as v1, company_type_id as v8 from movie_companies AS mc where (company_id) in (select (id) from company_name AS cn where country_code= '[us]');
create or replace view semiUp4053656057663248048 as select v29, v1, v8 from semiUp2554178070243555502 where (v8) in (select (id) from company_type AS ct where kind= 'production companies');
create or replace view semiUp8476769195030621073 as select movie_id as v29, info_type_id as v26, info as v27 from movie_info_idx AS mi_idx where (info_type_id) in (select (id) from info_type AS it2 where info= 'rating') and info>'7.0';
create or replace view semiUp5972706553399611066 as select id as v29, title as v30 from title AS t where (id) in (select (v29) from semiUp4053656057663248048) and production_year>=2000 and production_year<=2010;
create or replace view semiUp4965377341278391670 as select movie_id as v29, info_type_id as v21 from movie_info AS mi where (info_type_id) in (select (id) from info_type AS it1 where info= 'genres') and info IN ('Drama','Horror','Western','Family');
create or replace view semiUp5418386578008834595 as select v29, v30 from semiUp5972706553399611066 where (v29) in (select (v29) from semiUp4965377341278391670);
create or replace view semiUp2264328346983332961 as select v29, v26, v27 from semiUp8476769195030621073 where (v29) in (select (v29) from semiUp5418386578008834595);
create or replace view semiDown6515209968172724547 as select v29, v30 from semiUp5418386578008834595 where (v29) in (select (v29) from semiUp2264328346983332961);
create or replace view semiDown7078941414286648595 as select id as v26 from info_type AS it2 where (id) in (select (v26) from semiUp2264328346983332961) and info= 'rating';
create or replace view semiDown6025423114798079064 as select v29, v1, v8 from semiUp4053656057663248048 where (v29) in (select (v29) from semiDown6515209968172724547);
create or replace view semiDown7520467526860434692 as select v29, v21 from semiUp4965377341278391670 where (v29) in (select (v29) from semiDown6515209968172724547);
create or replace view semiDown9175590793144121640 as select id as v8 from company_type AS ct where (id) in (select (v8) from semiDown6025423114798079064) and kind= 'production companies';
create or replace view semiDown5235177998190503600 as select id as v1, name as v2 from company_name AS cn where (id) in (select (v1) from semiDown6025423114798079064) and country_code= '[us]';
create or replace view semiDown28245961890038287 as select id as v21 from info_type AS it1 where (id) in (select (v21) from semiDown7520467526860434692) and info= 'genres';
create or replace view aggView7908454546171772578 as select v26 from semiDown7078941414286648595;
create or replace view aggJoin7410421166769464420 as select v29, v27 from semiUp2264328346983332961 join aggView7908454546171772578 using(v26);
create or replace view aggView3373076903418075552 as select v21 from semiDown28245961890038287;
create or replace view aggJoin3858002595178804130 as select v29 from semiDown7520467526860434692 join aggView3373076903418075552 using(v21);
create or replace view aggView136934019600901126 as select v8 from semiDown9175590793144121640;
create or replace view aggJoin1434194546560959874 as select v29, v1 from semiDown6025423114798079064 join aggView136934019600901126 using(v8);
create or replace view aggView6841680818204491105 as select v1, v2 as v41 from semiDown5235177998190503600;
create or replace view aggJoin3545306728560160679 as select v29, v41 from aggJoin1434194546560959874 join aggView6841680818204491105 using(v1);
create or replace view aggView4918711841987010092 as select v29, MIN(v41) as v41 from aggJoin3545306728560160679 group by v29;
create or replace view aggJoin6255311531495912137 as select v29, v30, v41 from semiDown6515209968172724547 join aggView4918711841987010092 using(v29);
create or replace view aggView1194797456698622613 as select v29 from aggJoin3858002595178804130 group by v29;
create or replace view aggJoin4280755546267639276 as select v29, v30, v41 as v41 from aggJoin6255311531495912137 join aggView1194797456698622613 using(v29);
create or replace view aggView1934995214581928270 as select v29, MIN(v41) as v41, MIN(v30) as v43 from aggJoin4280755546267639276 group by v29;
create or replace view aggJoin8656225020957158211 as select v27, v41, v43 from aggJoin7410421166769464420 join aggView1934995214581928270 using(v29);
select MIN(v41) as v41,MIN(v27) as v42,MIN(v43) as v43 from aggJoin8656225020957158211;
