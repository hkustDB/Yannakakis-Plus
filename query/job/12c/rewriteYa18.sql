create or replace view semiUp3965412652230576033 as select movie_id as v29, company_id as v1, company_type_id as v8 from movie_companies AS mc where (company_type_id) in (select (id) from company_type AS ct where kind= 'production companies');
create or replace view semiUp674555554142775344 as select movie_id as v29, info_type_id as v26, info as v27 from movie_info_idx AS mi_idx where (info_type_id) in (select (id) from info_type AS it2 where info= 'rating') and info>'7.0';
create or replace view semiUp6372517808957579304 as select movie_id as v29, info_type_id as v21 from movie_info AS mi where (movie_id) in (select (id) from title AS t where production_year>=2000 and production_year<=2010) and info IN ('Drama','Horror','Western','Family');
create or replace view semiUp7675022878475650146 as select v29, v1, v8 from semiUp3965412652230576033 where (v1) in (select (id) from company_name AS cn where country_code= '[us]');
create or replace view semiUp5658904406567783260 as select v29, v26, v27 from semiUp674555554142775344 where (v29) in (select (v29) from semiUp7675022878475650146);
create or replace view semiUp5854399612600489168 as select v29, v21 from semiUp6372517808957579304 where (v29) in (select (v29) from semiUp5658904406567783260);
create or replace view semiUp103659176533664223 as select id as v21 from info_type AS it1 where (id) in (select (v21) from semiUp5854399612600489168) and info= 'genres';
create or replace view semiDown6480619740021832481 as select v29, v21 from semiUp5854399612600489168 where (v21) in (select (v21) from semiUp103659176533664223);
create or replace view semiDown1077745443012049803 as select v29, v26, v27 from semiUp5658904406567783260 where (v29) in (select (v29) from semiDown6480619740021832481);
create or replace view semiDown5403236861290226301 as select id as v29, title as v30 from title AS t where (id) in (select (v29) from semiDown6480619740021832481) and production_year>=2000 and production_year<=2010;
create or replace view semiDown2894470763879781886 as select v29, v1, v8 from semiUp7675022878475650146 where (v29) in (select (v29) from semiDown1077745443012049803);
create or replace view semiDown4516520838196150419 as select id as v26 from info_type AS it2 where (id) in (select (v26) from semiDown1077745443012049803) and info= 'rating';
create or replace view semiDown310786446725144966 as select id as v8 from company_type AS ct where (id) in (select (v8) from semiDown2894470763879781886) and kind= 'production companies';
create or replace view semiDown4413103557322661150 as select id as v1, name as v2 from company_name AS cn where (id) in (select (v1) from semiDown2894470763879781886) and country_code= '[us]';
create or replace view aggView7263580836598227589 as select v1, v2 as v41 from semiDown4413103557322661150;
create or replace view aggJoin5557381230026130774 as select v29, v8, v41 from semiDown2894470763879781886 join aggView7263580836598227589 using(v1);
create or replace view aggView2084711144203333427 as select v29, v30 as v43 from semiDown5403236861290226301;
create or replace view aggJoin4944224262565313666 as select v29, v21, v43 from semiDown6480619740021832481 join aggView2084711144203333427 using(v29);
create or replace view aggView4833086186956173066 as select v26 from semiDown4516520838196150419;
create or replace view aggJoin27815871045247668 as select v29, v27 from semiDown1077745443012049803 join aggView4833086186956173066 using(v26);
create or replace view aggView8157945993741308434 as select v8 from semiDown310786446725144966;
create or replace view aggJoin3859315092580006426 as select v29, v41 from aggJoin5557381230026130774 join aggView8157945993741308434 using(v8);
create or replace view aggView2298730425245017448 as select v29, MIN(v41) as v41 from aggJoin3859315092580006426 group by v29;
create or replace view aggJoin539197042447756719 as select v29, v27, v41 from aggJoin27815871045247668 join aggView2298730425245017448 using(v29);
create or replace view aggView1576963028296168528 as select v29, MIN(v41) as v41, MIN(v27) as v42 from aggJoin539197042447756719 group by v29;
create or replace view aggJoin2992716841576882232 as select v21, v43 as v43, v41, v42 from aggJoin4944224262565313666 join aggView1576963028296168528 using(v29);
create or replace view aggView6937203775496628142 as select v21, MIN(v43) as v43, MIN(v41) as v41, MIN(v42) as v42 from aggJoin2992716841576882232 group by v21;
create or replace view aggJoin8517386273345127227 as select v43, v41, v42 from semiUp103659176533664223 join aggView6937203775496628142 using(v21);
select MIN(v41) as v41,MIN(v42) as v42,MIN(v43) as v43 from aggJoin8517386273345127227;
