create or replace view semiUp1427593408715064559 as select movie_id as v29, info_type_id as v26, info as v27 from movie_info_idx AS mi_idx where (info_type_id) in (select (id) from info_type AS it2 where info= 'rating') and info>'7.0';
create or replace view semiUp2151113191735573143 as select movie_id as v29, company_id as v1, company_type_id as v8 from movie_companies AS mc where (company_type_id) in (select (id) from company_type AS ct where kind= 'production companies');
create or replace view semiUp3864954014152007283 as select movie_id as v29, info_type_id as v21 from movie_info AS mi where (info_type_id) in (select (id) from info_type AS it1 where info= 'genres') and info IN ('Drama','Horror','Western','Family');
create or replace view semiUp6932696113074440744 as select v29, v21 from semiUp3864954014152007283 where (v29) in (select (v29) from semiUp1427593408715064559);
create or replace view semiUp1760089635802770869 as select id as v29, title as v30 from title AS t where (id) in (select (v29) from semiUp6932696113074440744) and production_year>=2000 and production_year<=2010;
create or replace view semiUp4687903815759607098 as select v29, v1, v8 from semiUp2151113191735573143 where (v29) in (select (v29) from semiUp1760089635802770869);
create or replace view semiUp5563108695302318602 as select id as v1, name as v2 from company_name AS cn where (id) in (select (v1) from semiUp4687903815759607098) and country_code= '[us]';
create or replace view semiDown5406484801372268546 as select v29, v1, v8 from semiUp4687903815759607098 where (v1) in (select (v1) from semiUp5563108695302318602);
create or replace view semiDown8436946552945726628 as select v29, v30 from semiUp1760089635802770869 where (v29) in (select (v29) from semiDown5406484801372268546);
create or replace view semiDown1913407810446840968 as select id as v8 from company_type AS ct where (id) in (select (v8) from semiDown5406484801372268546) and kind= 'production companies';
create or replace view semiDown5439602128349244265 as select v29, v21 from semiUp6932696113074440744 where (v29) in (select (v29) from semiDown8436946552945726628);
create or replace view semiDown8737498367621664451 as select v29, v26, v27 from semiUp1427593408715064559 where (v29) in (select (v29) from semiDown5439602128349244265);
create or replace view semiDown354330164841940464 as select id as v21 from info_type AS it1 where (id) in (select (v21) from semiDown5439602128349244265) and info= 'genres';
create or replace view semiDown8309967083999933183 as select id as v26 from info_type AS it2 where (id) in (select (v26) from semiDown8737498367621664451) and info= 'rating';
create or replace view aggView8971642498146690364 as select v26 from semiDown8309967083999933183;
create or replace view aggJoin8642455740239704624 as select v29, v27 from semiDown8737498367621664451 join aggView8971642498146690364 using(v26);
create or replace view aggView4179774948489019410 as select v29, MIN(v27) as v42 from aggJoin8642455740239704624 group by v29;
create or replace view aggJoin6681356607039368310 as select v29, v21, v42 from semiDown5439602128349244265 join aggView4179774948489019410 using(v29);
create or replace view aggView6911199028434481608 as select v21 from semiDown354330164841940464;
create or replace view aggJoin6552518479090949497 as select v29, v42 from aggJoin6681356607039368310 join aggView6911199028434481608 using(v21);
create or replace view aggView7574401466191227038 as select v8 from semiDown1913407810446840968;
create or replace view aggJoin3849580530185593538 as select v29, v1 from semiDown5406484801372268546 join aggView7574401466191227038 using(v8);
create or replace view aggView2654358696235115296 as select v29, MIN(v42) as v42 from aggJoin6552518479090949497 group by v29;
create or replace view aggJoin942756990008787326 as select v29, v30, v42 from semiDown8436946552945726628 join aggView2654358696235115296 using(v29);
create or replace view aggView496848628261567973 as select v29, MIN(v42) as v42, MIN(v30) as v43 from aggJoin942756990008787326 group by v29;
create or replace view aggJoin4366653683870790783 as select v1, v42, v43 from aggJoin3849580530185593538 join aggView496848628261567973 using(v29);
create or replace view aggView5844930937339574980 as select v1, MIN(v42) as v42, MIN(v43) as v43 from aggJoin4366653683870790783 group by v1;
create or replace view aggJoin7670618586201402800 as select v2, v42, v43 from semiUp5563108695302318602 join aggView5844930937339574980 using(v1);
select MIN(v2) as v41,MIN(v42) as v42,MIN(v43) as v43 from aggJoin7670618586201402800;
