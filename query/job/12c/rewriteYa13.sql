create or replace view semiUp590322654588855805 as select movie_id as v29, company_id as v1, company_type_id as v8 from movie_companies AS mc where (company_id) in (select (id) from company_name AS cn where country_code= '[us]');
create or replace view semiUp237477425794291769 as select movie_id as v29, info_type_id as v26, info as v27 from movie_info_idx AS mi_idx where (info_type_id) in (select (id) from info_type AS it2 where info= 'rating') and info>'7.0';
create or replace view semiUp3974619159909657995 as select movie_id as v29, info_type_id as v21 from movie_info AS mi where (movie_id) in (select (v29) from semiUp237477425794291769) and info IN ('Drama','Horror','Western','Family');
create or replace view semiUp2263007867214439012 as select v29, v21 from semiUp3974619159909657995 where (v21) in (select (id) from info_type AS it1 where info= 'genres');
create or replace view semiUp3967141441585758629 as select id as v29, title as v30 from title AS t where (id) in (select (v29) from semiUp2263007867214439012) and production_year>=2000 and production_year<=2010;
create or replace view semiUp5280656043281535702 as select v29, v1, v8 from semiUp590322654588855805 where (v29) in (select (v29) from semiUp3967141441585758629);
create or replace view semiUp5803784962624302930 as select id as v8 from company_type AS ct where (id) in (select (v8) from semiUp5280656043281535702) and kind= 'production companies';
create or replace view semiDown6021905958970833125 as select v29, v1, v8 from semiUp5280656043281535702 where (v8) in (select (v8) from semiUp5803784962624302930);
create or replace view semiDown4749059234652036626 as select v29, v30 from semiUp3967141441585758629 where (v29) in (select (v29) from semiDown6021905958970833125);
create or replace view semiDown6206018513690315463 as select id as v1, name as v2 from company_name AS cn where (id) in (select (v1) from semiDown6021905958970833125) and country_code= '[us]';
create or replace view semiDown2438331954254549792 as select v29, v21 from semiUp2263007867214439012 where (v29) in (select (v29) from semiDown4749059234652036626);
create or replace view semiDown8602636457136757353 as select v29, v26, v27 from semiUp237477425794291769 where (v29) in (select (v29) from semiDown2438331954254549792);
create or replace view semiDown67835954588905374 as select id as v21 from info_type AS it1 where (id) in (select (v21) from semiDown2438331954254549792) and info= 'genres';
create or replace view semiDown2039189947795775027 as select id as v26 from info_type AS it2 where (id) in (select (v26) from semiDown8602636457136757353) and info= 'rating';
create or replace view aggView5038219947284403999 as select v26 from semiDown2039189947795775027;
create or replace view aggJoin6697367770818276462 as select v29, v27 from semiDown8602636457136757353 join aggView5038219947284403999 using(v26);
create or replace view aggView2374102064242099010 as select v1, v2 as v41 from semiDown6206018513690315463;
create or replace view aggJoin6192938951641956843 as select v29, v8, v41 from semiDown6021905958970833125 join aggView2374102064242099010 using(v1);
create or replace view aggView1093493821222374656 as select v29, MIN(v27) as v42 from aggJoin6697367770818276462 group by v29;
create or replace view aggJoin5613542331095237418 as select v29, v21, v42 from semiDown2438331954254549792 join aggView1093493821222374656 using(v29);
create or replace view aggView5096035505110246530 as select v21 from semiDown67835954588905374;
create or replace view aggJoin5713004259300723672 as select v29, v42 from aggJoin5613542331095237418 join aggView5096035505110246530 using(v21);
create or replace view aggView5381410458087386848 as select v29, MIN(v42) as v42 from aggJoin5713004259300723672 group by v29;
create or replace view aggJoin3244213177414556349 as select v29, v30, v42 from semiDown4749059234652036626 join aggView5381410458087386848 using(v29);
create or replace view aggView9029264487386405460 as select v29, MIN(v42) as v42, MIN(v30) as v43 from aggJoin3244213177414556349 group by v29;
create or replace view aggJoin7692792983182738224 as select v8, v41 as v41, v42, v43 from aggJoin6192938951641956843 join aggView9029264487386405460 using(v29);
create or replace view aggView4259247206202669199 as select v8, MIN(v41) as v41, MIN(v42) as v42, MIN(v43) as v43 from aggJoin7692792983182738224 group by v8;
create or replace view aggJoin2553478438204888791 as select v41, v42, v43 from semiUp5803784962624302930 join aggView4259247206202669199 using(v8);
select MIN(v41) as v41,MIN(v42) as v42,MIN(v43) as v43 from aggJoin2553478438204888791;
