create or replace view semiUp6491229000013890208 as select person_id as v2, movie_id as v11, role_id as v15 from cast_info AS ci where (person_id) in (select id from name AS n1);
create or replace view semiUp5262234941120487891 as select v2, v11, v15 from semiUp6491229000013890208 where (v2) in (select person_id from aka_name AS a1);
create or replace view semiUp828123844287343902 as select v2, v11, v15 from semiUp5262234941120487891 where (v15) in (select id from role_type AS rt where role= 'writer');
create or replace view semiUp4913579906300907784 as select id as v11, title as v40 from title AS t where (id) in (select v11 from semiUp828123844287343902);
create or replace view semiUp8925361832128495482 as select movie_id as v11, company_id as v25 from movie_companies AS mc where (movie_id) in (select v11 from semiUp4913579906300907784);
create or replace view semiUp7946129221531360398 as select id as v25 from company_name AS cn where (id) in (select v25 from semiUp8925361832128495482) and country_code= '[us]';
create or replace view semiDown358845270388617672 as select v11, v25 from semiUp8925361832128495482 where (v25) in (select v25 from semiUp7946129221531360398);
create or replace view semiDown6022532421384504974 as select v11, v40 from semiUp4913579906300907784 where (v11) in (select v11 from semiDown358845270388617672);
create or replace view semiDown8140948607640518954 as select v2, v11, v15 from semiUp828123844287343902 where (v11) in (select v11 from semiDown6022532421384504974);
create or replace view semiDown3255081437686500699 as select id as v15 from role_type AS rt where (id) in (select v15 from semiDown8140948607640518954) and role= 'writer';
create or replace view semiDown6081357855495628589 as select person_id as v2, name as v3 from aka_name AS a1 where (person_id) in (select v2 from semiDown8140948607640518954);
create or replace view semiDown2620076376246476791 as select id as v2 from name AS n1 where (id) in (select v2 from semiDown8140948607640518954);
create or replace view aggView1507028290969708200 as select v2 from semiDown2620076376246476791;
create or replace view aggJoin178000053426352521 as select v2, v11, v15 from semiDown8140948607640518954 join aggView1507028290969708200 using(v2);
create or replace view aggView4735136042597601796 as select v2, MIN(v3) as v51 from semiDown6081357855495628589 group by v2;
create or replace view aggJoin943353482758567998 as select v11, v15, v51 from aggJoin178000053426352521 join aggView4735136042597601796 using(v2);
create or replace view aggView6324561818116009515 as select v15 from semiDown3255081437686500699;
create or replace view aggJoin3916337162427754049 as select v11, v51 from aggJoin943353482758567998 join aggView6324561818116009515 using(v15);
create or replace view aggView2373267748721254966 as select v11, MIN(v51) as v51 from aggJoin3916337162427754049 group by v11;
create or replace view aggJoin6891369837978764508 as select v11, v40, v51 from semiDown6022532421384504974 join aggView2373267748721254966 using(v11);
create or replace view aggView2547194101445146260 as select v11, MIN(v51) as v51, MIN(v40) as v52 from aggJoin6891369837978764508 group by v11;
create or replace view aggJoin3888868030461340538 as select v25, v51, v52 from semiDown358845270388617672 join aggView2547194101445146260 using(v11);
create or replace view aggView8988311274721952041 as select v25, MIN(v51) as v51, MIN(v52) as v52 from aggJoin3888868030461340538 group by v25;
create or replace view aggJoin547714417741578271 as select v51, v52 from semiUp7946129221531360398 join aggView8988311274721952041 using(v25);
create or replace view res as select MIN(v51) as v51, MIN(v52) as v52 from aggJoin547714417741578271;
select sum(v51), sum(v52) from res;
