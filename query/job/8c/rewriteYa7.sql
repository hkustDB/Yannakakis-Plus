create or replace view semiUp332984330445876770 as select id as v2 from name AS n1 where (id) in (select person_id from aka_name AS a1);
create or replace view semiUp3458297350413159899 as select person_id as v2, movie_id as v11, role_id as v15 from cast_info AS ci where (person_id) in (select v2 from semiUp332984330445876770);
create or replace view semiUp8073740419828523293 as select v2, v11, v15 from semiUp3458297350413159899 where (v15) in (select id from role_type AS rt where role= 'writer');
create or replace view semiUp6577703631126496455 as select id as v11, title as v40 from title AS t where (id) in (select v11 from semiUp8073740419828523293);
create or replace view semiUp4880125902845546185 as select movie_id as v11, company_id as v25 from movie_companies AS mc where (movie_id) in (select v11 from semiUp6577703631126496455);
create or replace view semiUp2683314704106376775 as select id as v25 from company_name AS cn where (id) in (select v25 from semiUp4880125902845546185) and country_code= '[us]';
create or replace view semiDown7024812101177248595 as select v11, v25 from semiUp4880125902845546185 where (v25) in (select v25 from semiUp2683314704106376775);
create or replace view semiDown4820604462635165721 as select v11, v40 from semiUp6577703631126496455 where (v11) in (select v11 from semiDown7024812101177248595);
create or replace view semiDown6746451911312871034 as select v2, v11, v15 from semiUp8073740419828523293 where (v11) in (select v11 from semiDown4820604462635165721);
create or replace view semiDown8173150035001355951 as select id as v15 from role_type AS rt where (id) in (select v15 from semiDown6746451911312871034) and role= 'writer';
create or replace view semiDown7674866613368205989 as select v2 from semiUp332984330445876770 where (v2) in (select v2 from semiDown6746451911312871034);
create or replace view semiDown869918287903105706 as select person_id as v2, name as v3 from aka_name AS a1 where (person_id) in (select v2 from semiDown7674866613368205989);
create or replace view aggView3978892724204533648 as select v2, MIN(v3) as v51 from semiDown869918287903105706 group by v2;
create or replace view aggJoin7732658463778748695 as select v2, v51 from semiDown7674866613368205989 join aggView3978892724204533648 using(v2);
create or replace view aggView964036455881577405 as select v15 from semiDown8173150035001355951;
create or replace view aggJoin9095697217561235026 as select v2, v11 from semiDown6746451911312871034 join aggView964036455881577405 using(v15);
create or replace view aggView1381911196713524472 as select v2, MIN(v51) as v51 from aggJoin7732658463778748695 group by v2;
create or replace view aggJoin7315510994430927107 as select v11, v51 from aggJoin9095697217561235026 join aggView1381911196713524472 using(v2);
create or replace view aggView3169400971902083978 as select v11, MIN(v51) as v51 from aggJoin7315510994430927107 group by v11;
create or replace view aggJoin4088511819711344337 as select v11, v40, v51 from semiDown4820604462635165721 join aggView3169400971902083978 using(v11);
create or replace view aggView4973138946922111083 as select v11, MIN(v51) as v51, MIN(v40) as v52 from aggJoin4088511819711344337 group by v11;
create or replace view aggJoin1641267417225726182 as select v25, v51, v52 from semiDown7024812101177248595 join aggView4973138946922111083 using(v11);
create or replace view aggView4869372238233088053 as select v25, MIN(v51) as v51, MIN(v52) as v52 from aggJoin1641267417225726182 group by v25;
create or replace view aggJoin4696865828035594527 as select v51, v52 from semiUp2683314704106376775 join aggView4869372238233088053 using(v25);
create or replace view res as select MIN(v51) as v51, MIN(v52) as v52 from aggJoin4696865828035594527;
select sum(v51), sum(v52) from res;
