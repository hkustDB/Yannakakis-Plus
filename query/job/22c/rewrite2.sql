create or replace view aggView4337161667548315646 as select name as v2, id as v1 from company_name as cn where country_code<> '[us]';
create or replace view aggView1387237049739337701 as select id as v17 from kind_type as kt where kind IN ('movie','episode');
create or replace view aggJoin4300746538776574198 as select id as v37, title as v38, production_year as v41 from title as t, aggView1387237049739337701 where t.kind_id=aggView1387237049739337701.v17 and production_year>2005;
create or replace view aggView1685030627252822962 as select v38, v37 from aggJoin4300746538776574198 group by v38,v37;
create or replace view aggView8765278576018303439 as select id as v12 from info_type as it2 where info= 'rating';
create or replace view aggJoin891545351114489528 as select movie_id as v37, info as v32 from movie_info_idx as mi_idx, aggView8765278576018303439 where mi_idx.info_type_id=aggView8765278576018303439.v12;
create or replace view aggView2613733368135776801 as select id as v14 from keyword as k where keyword IN ('murder','murder-in-title','blood','violence');
create or replace view aggJoin3770343540708859184 as select movie_id as v37 from movie_keyword as mk, aggView2613733368135776801 where mk.keyword_id=aggView2613733368135776801.v14;
create or replace view aggView601258636957692731 as select v37 from aggJoin3770343540708859184 group by v37;
create or replace view aggJoin2402719138929123135 as select movie_id as v37, info_type_id as v10, info as v27 from movie_info as mi, aggView601258636957692731 where mi.movie_id=aggView601258636957692731.v37 and info IN ('Sweden','Norway','Germany','Denmark','Swedish','Danish','Norwegian','German','USA','American');
create or replace view aggView1774807294822029139 as select id as v10 from info_type as it1 where info= 'countries';
create or replace view aggJoin2587102521681056609 as select v37, v27 from aggJoin2402719138929123135 join aggView1774807294822029139 using(v10);
create or replace view aggView6237310049979486585 as select v37 from aggJoin2587102521681056609 group by v37;
create or replace view aggJoin740295222993391016 as select v37, v32 from aggJoin891545351114489528 join aggView6237310049979486585 using(v37);
create or replace view aggView6729119735744405724 as select v32, v37 from aggJoin740295222993391016 group by v32,v37;
create or replace view aggJoin2430696800529198934 as select v37, v32 from aggView6729119735744405724 where v32<'8.5';
create or replace view aggView5823221589418750139 as select v37, MIN(v38) as v51 from aggView1685030627252822962 group by v37;
create or replace view aggJoin3203872249439691136 as select v37, v32, v51 from aggJoin2430696800529198934 join aggView5823221589418750139 using(v37);
create or replace view aggView736305600844061492 as select v37, MIN(v51) as v51, MIN(v32) as v50 from aggJoin3203872249439691136 group by v37,v51;
create or replace view aggJoin5312631425592653121 as select company_id as v1, company_type_id as v8, note as v23, v51, v50 from movie_companies as mc, aggView736305600844061492 where mc.movie_id=aggView736305600844061492.v37 and note NOT LIKE '%(USA)%' and note LIKE '%(200%)%';
create or replace view aggView6622250894673068240 as select id as v8 from company_type as ct;
create or replace view aggJoin2426902228014762349 as select v1, v23, v51, v50 from aggJoin5312631425592653121 join aggView6622250894673068240 using(v8);
create or replace view aggView8149350672750257549 as select v1, MIN(v51) as v51, MIN(v50) as v50 from aggJoin2426902228014762349 group by v1,v51,v50;
create or replace view aggJoin4275165473724438086 as select v2, v51, v50 from aggView4337161667548315646 join aggView8149350672750257549 using(v1);
select MIN(v2) as v49,MIN(v50) as v50,MIN(v51) as v51 from aggJoin4275165473724438086;
