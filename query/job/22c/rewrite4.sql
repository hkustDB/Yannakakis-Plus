create or replace view aggView6960103210645276201 as select name as v2, id as v1 from company_name as cn where country_code<> '[us]';
create or replace view aggView6547168574806822126 as select id as v17 from kind_type as kt where kind IN ('movie','episode');
create or replace view aggJoin5243796981421298882 as select id as v37, title as v38, production_year as v41 from title as t, aggView6547168574806822126 where t.kind_id=aggView6547168574806822126.v17 and production_year>2005;
create or replace view aggView6152324909329720681 as select id as v12 from info_type as it2 where info= 'rating';
create or replace view aggJoin995680249780620720 as select movie_id as v37, info as v32 from movie_info_idx as mi_idx, aggView6152324909329720681 where mi_idx.info_type_id=aggView6152324909329720681.v12 and info<'8.5';
create or replace view aggView5000227092408884783 as select id as v14 from keyword as k where keyword IN ('murder','murder-in-title','blood','violence');
create or replace view aggJoin6386996921709070157 as select movie_id as v37 from movie_keyword as mk, aggView5000227092408884783 where mk.keyword_id=aggView5000227092408884783.v14;
create or replace view aggView4514955220668928067 as select v37 from aggJoin6386996921709070157 group by v37;
create or replace view aggJoin6844836933410976267 as select v37, v38, v41 from aggJoin5243796981421298882 join aggView4514955220668928067 using(v37);
create or replace view aggView3649612150695534420 as select v38, v37 from aggJoin6844836933410976267 group by v38,v37;
create or replace view aggView1572988063612540032 as select id as v10 from info_type as it1 where info= 'countries';
create or replace view aggJoin8157757900842914592 as select movie_id as v37, info as v27 from movie_info as mi, aggView1572988063612540032 where mi.info_type_id=aggView1572988063612540032.v10 and info IN ('Sweden','Norway','Germany','Denmark','Swedish','Danish','Norwegian','German','USA','American');
create or replace view aggView3798765159880039879 as select v37 from aggJoin8157757900842914592 group by v37;
create or replace view aggJoin2612776205760658509 as select v37, v32 from aggJoin995680249780620720 join aggView3798765159880039879 using(v37);
create or replace view aggView6738264092196041821 as select v32, v37 from aggJoin2612776205760658509 group by v32,v37;
create or replace view aggView4381598681640739175 as select v37, MIN(v38) as v51 from aggView3649612150695534420 group by v37;
create or replace view aggJoin7704724016760418427 as select v32, v37, v51 from aggView6738264092196041821 join aggView4381598681640739175 using(v37);
create or replace view aggView6073644537366579961 as select v37, MIN(v51) as v51, MIN(v32) as v50 from aggJoin7704724016760418427 group by v37,v51;
create or replace view aggJoin1390641852535476523 as select company_id as v1, company_type_id as v8, note as v23, v51, v50 from movie_companies as mc, aggView6073644537366579961 where mc.movie_id=aggView6073644537366579961.v37 and note NOT LIKE '%(USA)%' and note LIKE '%(200%)%';
create or replace view aggView8726177576703017918 as select id as v8 from company_type as ct;
create or replace view aggJoin5459691667720514068 as select v1, v23, v51, v50 from aggJoin1390641852535476523 join aggView8726177576703017918 using(v8);
create or replace view aggView5036178615430924878 as select v1, MIN(v51) as v51, MIN(v50) as v50 from aggJoin5459691667720514068 group by v1,v51,v50;
create or replace view aggJoin3319261237317470633 as select v2, v51, v50 from aggView6960103210645276201 join aggView5036178615430924878 using(v1);
select MIN(v2) as v49,MIN(v50) as v50,MIN(v51) as v51 from aggJoin3319261237317470633;
