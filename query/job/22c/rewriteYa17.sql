create or replace view semiUp3884191698845336309 as select movie_id as v37, info_type_id as v12, info as v32 from movie_info_idx AS mi_idx where (info_type_id) in (select (id) from info_type AS it2 where info= 'rating') and info<'8.5';
create or replace view semiUp7899882782369493298 as select movie_id as v37, info_type_id as v10 from movie_info AS mi where (info_type_id) in (select (id) from info_type AS it1 where info= 'countries') and info IN ('Sweden','Norway','Germany','Denmark','Swedish','Danish','Norwegian','German','USA','American');
create or replace view semiUp8252599998849431934 as select movie_id as v37, keyword_id as v14 from movie_keyword AS mk where (movie_id) in (select (v37) from semiUp3884191698845336309);
create or replace view semiUp4542103887213003614 as select movie_id as v37, company_id as v1, company_type_id as v8 from movie_companies AS mc where (company_id) in (select (id) from company_name AS cn where country_code<> '[us]') and note NOT LIKE '%(USA)%' and note LIKE '%(200%)%';
create or replace view semiUp3786477976290897870 as select v37, v14 from semiUp8252599998849431934 where (v14) in (select (id) from keyword AS k where keyword IN ('murder','murder-in-title','blood','violence'));
create or replace view semiUp7902259666900848617 as select v37, v10 from semiUp7899882782369493298 where (v37) in (select (v37) from semiUp3786477976290897870);
create or replace view semiUp5678058371467154844 as select id as v37, title as v38, kind_id as v17 from title AS t where (id) in (select (v37) from semiUp7902259666900848617) and production_year>2005;
create or replace view semiUp5211890629254117515 as select v37, v38, v17 from semiUp5678058371467154844 where (v17) in (select (id) from kind_type AS kt where kind IN ('movie','episode'));
create or replace view semiUp8679359732890645226 as select v37, v1, v8 from semiUp4542103887213003614 where (v37) in (select (v37) from semiUp5211890629254117515);
create or replace view semiUp7537019137083137960 as select id as v8 from company_type AS ct where (id) in (select (v8) from semiUp8679359732890645226);
create or replace view semiDown8557148484497228590 as select v37, v1, v8 from semiUp8679359732890645226 where (v8) in (select (v8) from semiUp7537019137083137960);
create or replace view semiDown8765125537370408673 as select id as v1, name as v2 from company_name AS cn where (id) in (select (v1) from semiDown8557148484497228590) and country_code<> '[us]';
create or replace view semiDown3029831503429895913 as select v37, v38, v17 from semiUp5211890629254117515 where (v37) in (select (v37) from semiDown8557148484497228590);
create or replace view semiDown3076465158920617899 as select id as v17 from kind_type AS kt where (id) in (select (v17) from semiDown3029831503429895913) and kind IN ('movie','episode');
create or replace view semiDown6193335829245422732 as select v37, v10 from semiUp7902259666900848617 where (v37) in (select (v37) from semiDown3029831503429895913);
create or replace view semiDown875122037124228827 as select v37, v14 from semiUp3786477976290897870 where (v37) in (select (v37) from semiDown6193335829245422732);
create or replace view semiDown4365180692401888632 as select id as v10 from info_type AS it1 where (id) in (select (v10) from semiDown6193335829245422732) and info= 'countries';
create or replace view semiDown4484774542736403621 as select v37, v12, v32 from semiUp3884191698845336309 where (v37) in (select (v37) from semiDown875122037124228827);
create or replace view semiDown6268626627925771232 as select id as v14 from keyword AS k where (id) in (select (v14) from semiDown875122037124228827) and keyword IN ('murder','murder-in-title','blood','violence');
create or replace view semiDown7960639261373159140 as select id as v12 from info_type AS it2 where (id) in (select (v12) from semiDown4484774542736403621) and info= 'rating';
create or replace view aggView155202969747870418 as select v1, v2 as v49 from semiDown8765125537370408673;
create or replace view aggJoin6004260367403491331 as select v37, v8, v49 from semiDown8557148484497228590 join aggView155202969747870418 using(v1);
create or replace view aggView8560622665303757 as select v17 from semiDown3076465158920617899;
create or replace view aggJoin4067298719782098352 as select v37, v38 from semiDown3029831503429895913 join aggView8560622665303757 using(v17);
create or replace view aggView6489241622604981465 as select v12 from semiDown7960639261373159140;
create or replace view aggJoin8945989486283583235 as select v37, v32 from semiDown4484774542736403621 join aggView6489241622604981465 using(v12);
create or replace view aggView4889211530583564368 as select v14 from semiDown6268626627925771232;
create or replace view aggJoin4791739269604048201 as select v37 from semiDown875122037124228827 join aggView4889211530583564368 using(v14);
create or replace view aggView9200856575133319333 as select v37, MIN(v32) as v50 from aggJoin8945989486283583235 group by v37;
create or replace view aggJoin8405074084881305154 as select v37, v50 from aggJoin4791739269604048201 join aggView9200856575133319333 using(v37);
create or replace view aggView5754144728882713433 as select v10 from semiDown4365180692401888632;
create or replace view aggJoin4669251018543350847 as select v37 from semiDown6193335829245422732 join aggView5754144728882713433 using(v10);
create or replace view aggView1740568246574960572 as select v37, MIN(v50) as v50 from aggJoin8405074084881305154 group by v37;
create or replace view aggJoin4755764491286970021 as select v37, v50 from aggJoin4669251018543350847 join aggView1740568246574960572 using(v37);
create or replace view aggView3466108783764830263 as select v37, MIN(v50) as v50 from aggJoin4755764491286970021 group by v37;
create or replace view aggJoin1296959013938598626 as select v37, v38, v50 from aggJoin4067298719782098352 join aggView3466108783764830263 using(v37);
create or replace view aggView6608579131004138719 as select v37, MIN(v50) as v50, MIN(v38) as v51 from aggJoin1296959013938598626 group by v37;
create or replace view aggJoin4361495548424362882 as select v8, v49 as v49, v50, v51 from aggJoin6004260367403491331 join aggView6608579131004138719 using(v37);
create or replace view aggView1937760415555554576 as select v8, MIN(v49) as v49, MIN(v50) as v50, MIN(v51) as v51 from aggJoin4361495548424362882 group by v8;
create or replace view aggJoin6900729019189663738 as select v49, v50, v51 from semiUp7537019137083137960 join aggView1937760415555554576 using(v8);
select MIN(v49) as v49,MIN(v50) as v50,MIN(v51) as v51 from aggJoin6900729019189663738;
