create or replace view aggView5314831349016835322 as select name as v2, id as v1 from company_name as cn where country_code<> '[us]';
create or replace view aggView1984976572269606007 as select id as v17 from kind_type as kt where kind IN ('movie','episode');
create or replace view aggJoin6248850307435898003 as select id as v37, title as v38, production_year as v41 from title as t, aggView1984976572269606007 where t.kind_id=aggView1984976572269606007.v17 and production_year>2005;
create or replace view aggView2092340684295429517 as select v38, v37 from aggJoin6248850307435898003 group by v38,v37;
create or replace view aggView1060008714200711602 as select id as v12 from info_type as it2 where info= 'rating';
create or replace view aggJoin7872214852907589007 as select movie_id as v37, info as v32 from movie_info_idx as mi_idx, aggView1060008714200711602 where mi_idx.info_type_id=aggView1060008714200711602.v12 and info<'8.5';
create or replace view aggView1531209478180260162 as select v32, v37 from aggJoin7872214852907589007 group by v32,v37;
create or replace view aggView1927933643930257758 as select v37, MIN(v38) as v51 from aggView2092340684295429517 group by v37;
create or replace view aggJoin1922133429125344916 as select v32, v37, v51 from aggView1531209478180260162 join aggView1927933643930257758 using(v37);
create or replace view aggView3871190438693268941 as select v37, MIN(v51) as v51, MIN(v32) as v50 from aggJoin1922133429125344916 group by v37,v51;
create or replace view aggJoin8261762962985498996 as select movie_id as v37, company_id as v1, company_type_id as v8, note as v23, v51, v50 from movie_companies as mc, aggView3871190438693268941 where mc.movie_id=aggView3871190438693268941.v37 and note NOT LIKE '%(USA)%' and note LIKE '%(200%)%';
create or replace view aggView2020943949237767930 as select id as v8 from company_type as ct;
create or replace view aggJoin6186634289065367745 as select v37, v1, v23, v51, v50 from aggJoin8261762962985498996 join aggView2020943949237767930 using(v8);
create or replace view aggView2882805285155471604 as select id as v14 from keyword as k where keyword IN ('murder','murder-in-title','blood','violence');
create or replace view aggJoin7039814724513689403 as select movie_id as v37 from movie_keyword as mk, aggView2882805285155471604 where mk.keyword_id=aggView2882805285155471604.v14;
create or replace view aggView1711876065616350105 as select v37 from aggJoin7039814724513689403 group by v37;
create or replace view aggJoin3213337624053248961 as select movie_id as v37, info_type_id as v10, info as v27 from movie_info as mi, aggView1711876065616350105 where mi.movie_id=aggView1711876065616350105.v37 and info IN ('Sweden','Norway','Germany','Denmark','Swedish','Danish','Norwegian','German','USA','American');
create or replace view aggView6878387627585939110 as select id as v10 from info_type as it1 where info= 'countries';
create or replace view aggJoin7116704850023526217 as select v37, v27 from aggJoin3213337624053248961 join aggView6878387627585939110 using(v10);
create or replace view aggView3784324786455564251 as select v37 from aggJoin7116704850023526217 group by v37;
create or replace view aggJoin4152414058775224692 as select v1, v23, v51 as v51, v50 as v50 from aggJoin6186634289065367745 join aggView3784324786455564251 using(v37);
create or replace view aggView450817182588210330 as select v1, MIN(v51) as v51, MIN(v50) as v50 from aggJoin4152414058775224692 group by v1,v51,v50;
create or replace view aggJoin1397088458192683030 as select v2, v51, v50 from aggView5314831349016835322 join aggView450817182588210330 using(v1);
select MIN(v2) as v49,MIN(v50) as v50,MIN(v51) as v51 from aggJoin1397088458192683030;
