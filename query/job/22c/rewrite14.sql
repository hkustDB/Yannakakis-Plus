create or replace view aggView770657571872254556 as select id as v1, name as v49 from company_name as cn where country_code<> '[us]';
create or replace view aggJoin3372404787398537813 as select movie_id as v37, company_type_id as v8, note as v23, v49 from movie_companies as mc, aggView770657571872254556 where mc.company_id=aggView770657571872254556.v1 and note NOT LIKE '%(USA)%' and note LIKE '%(200%)%';
create or replace view aggView4147762349077875345 as select id as v17 from kind_type as kt where kind IN ('movie','episode');
create or replace view aggJoin2450772908613134921 as select id as v37, title as v38, production_year as v41 from title as t, aggView4147762349077875345 where t.kind_id=aggView4147762349077875345.v17 and production_year>2005;
create or replace view aggView6145060049833718452 as select id as v12 from info_type as it2 where info= 'rating';
create or replace view aggJoin5517867179706633357 as select movie_id as v37, info as v32 from movie_info_idx as mi_idx, aggView6145060049833718452 where mi_idx.info_type_id=aggView6145060049833718452.v12 and info<'8.5';
create or replace view aggView7884109655092857493 as select id as v8 from company_type as ct;
create or replace view aggJoin1872113203310739871 as select v37, v23, v49 from aggJoin3372404787398537813 join aggView7884109655092857493 using(v8);
create or replace view aggView409993264683796892 as select v37, MIN(v49) as v49 from aggJoin1872113203310739871 group by v37,v49;
create or replace view aggJoin5409115376378154050 as select v37, v38, v41, v49 from aggJoin2450772908613134921 join aggView409993264683796892 using(v37);
create or replace view aggView6792553649666829010 as select v37, MIN(v49) as v49, MIN(v38) as v51 from aggJoin5409115376378154050 group by v37,v49;
create or replace view aggJoin1982032016834551137 as select v37, v32, v49, v51 from aggJoin5517867179706633357 join aggView6792553649666829010 using(v37);
create or replace view aggView3773095433245727954 as select v37, MIN(v49) as v49, MIN(v51) as v51, MIN(v32) as v50 from aggJoin1982032016834551137 group by v37,v49,v51;
create or replace view aggJoin2622431981468161257 as select movie_id as v37, keyword_id as v14, v49, v51, v50 from movie_keyword as mk, aggView3773095433245727954 where mk.movie_id=aggView3773095433245727954.v37;
create or replace view aggView359090303091780035 as select id as v14 from keyword as k where keyword IN ('murder','murder-in-title','blood','violence');
create or replace view aggJoin2515280655125320380 as select v37, v49, v51, v50 from aggJoin2622431981468161257 join aggView359090303091780035 using(v14);
create or replace view aggView5908373910300521739 as select v37, MIN(v49) as v49, MIN(v51) as v51, MIN(v50) as v50 from aggJoin2515280655125320380 group by v37,v49,v50,v51;
create or replace view aggJoin875259320470834879 as select info_type_id as v10, info as v27, v49, v51, v50 from movie_info as mi, aggView5908373910300521739 where mi.movie_id=aggView5908373910300521739.v37 and info IN ('Sweden','Norway','Germany','Denmark','Swedish','Danish','Norwegian','German','USA','American');
create or replace view aggView3400687472602352073 as select id as v10 from info_type as it1 where info= 'countries';
create or replace view aggJoin7361965116609886058 as select v49, v51, v50 from aggJoin875259320470834879 join aggView3400687472602352073 using(v10);
select MIN(v49) as v49,MIN(v50) as v50,MIN(v51) as v51 from aggJoin7361965116609886058;
