create or replace view aggView4078688277613008880 as select id as v16 from info_type as it1 where info= 'genres';
create or replace view aggJoin1557491452949716968 as select movie_id as v45, info as v26 from movie_info as mi, aggView4078688277613008880 where mi.info_type_id=aggView4078688277613008880.v16 and info IN ('Horror','Thriller');
create or replace view aggView5759744083577808388 as select v45, MIN(v26) as v57 from aggJoin1557491452949716968 group by v45;
create or replace view aggJoin8924736437062928316 as select id as v45, title as v46, v57 from title as t, aggView5759744083577808388 where t.id=aggView5759744083577808388.v45 and production_year>2000;
create or replace view aggView8457347673442642991 as select id as v20 from keyword as k where keyword IN ('murder','violence','blood','gore','death','female-nudity','hospital');
create or replace view aggJoin6711270327572573266 as select movie_id as v45 from movie_keyword as mk, aggView8457347673442642991 where mk.keyword_id=aggView8457347673442642991.v20;
create or replace view aggView8443309110486833257 as select id as v7 from comp_cast_type as cct2 where kind= 'complete+verified';
create or replace view aggJoin4721210472569467469 as select movie_id as v45, subject_id as v5 from complete_cast as cc, aggView8443309110486833257 where cc.status_id=aggView8443309110486833257.v7;
create or replace view aggView1817434162098700070 as select id as v5 from comp_cast_type as cct1 where kind IN ('cast','crew');
create or replace view aggJoin1343731539392436836 as select v45 from aggJoin4721210472569467469 join aggView1817434162098700070 using(v5);
create or replace view aggView6964773571249774238 as select v45 from aggJoin1343731539392436836 group by v45;
create or replace view aggJoin1274393252149303022 as select v45, v46, v57 as v57 from aggJoin8924736437062928316 join aggView6964773571249774238 using(v45);
create or replace view aggView4213945676988520254 as select v45, MIN(v57) as v57, MIN(v46) as v60 from aggJoin1274393252149303022 group by v45;
create or replace view aggJoin2125220986730015580 as select v45, v57, v60 from aggJoin6711270327572573266 join aggView4213945676988520254 using(v45);
create or replace view aggView9169310940039615942 as select v45, MIN(v57) as v57, MIN(v60) as v60 from aggJoin2125220986730015580 group by v45;
create or replace view aggJoin515176850239734536 as select movie_id as v45, info_type_id as v18, info as v31, v57, v60 from movie_info_idx as mi_idx, aggView9169310940039615942 where mi_idx.movie_id=aggView9169310940039615942.v45;
create or replace view aggView7700434161899131704 as select id as v18 from info_type as it2 where info= 'votes';
create or replace view aggJoin8082477416601265476 as select v45, v31, v57, v60 from aggJoin515176850239734536 join aggView7700434161899131704 using(v18);
create or replace view aggView2057902863622138459 as select v45, MIN(v57) as v57, MIN(v60) as v60, MIN(v31) as v58 from aggJoin8082477416601265476 group by v45;
create or replace view aggJoin7783451268100205272 as select person_id as v36, v57, v60, v58 from cast_info as ci, aggView2057902863622138459 where ci.movie_id=aggView2057902863622138459.v45 and note IN ('(writer)','(head writer)','(written by)','(story)','(story editor)');
create or replace view aggView2074953588936315870 as select v36, MIN(v57) as v57, MIN(v60) as v60, MIN(v58) as v58 from aggJoin7783451268100205272 group by v36;
create or replace view aggJoin4266863665063058495 as select name as v37, v57, v60, v58 from name as n, aggView2074953588936315870 where n.id=aggView2074953588936315870.v36 and gender= 'm';
create or replace view res as select MIN(v57) as v57, MIN(v58) as v58, MIN(v37) as v59, MIN(v60) as v60 from aggJoin4266863665063058495;
select sum(v57+v58+v59+v60) from res;