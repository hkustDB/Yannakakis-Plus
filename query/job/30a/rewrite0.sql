create or replace view aggView8783555252229564553 as select id as v9, name as v10 from company_name as cn where country_code<> '[us]';
create or replace view aggView4836153271789561960 as select id as v25 from kind_type as kt where kind IN ('movie','episode');
create or replace view aggJoin1033415634772099085 as select id as v45, title as v46, production_year as v49 from title as t, aggView4836153271789561960 where t.kind_id=aggView4836153271789561960.v25 and production_year>2005;
create or replace view aggView2105463250311760356 as select id as v20 from info_type as it2 where info= 'rating';
create or replace view aggJoin4944928388959895997 as select movie_id as v45, info as v40 from movie_info_idx as mi_idx, aggView2105463250311760356 where mi_idx.info_type_id=aggView2105463250311760356.v20;
create or replace view aggView7568971701947566190 as select v45, v40 from aggJoin4944928388959895997 group by v45,v40;
create or replace view aggJoin2500493305540529681 as select v45, v40 from aggView7568971701947566190 where v40<'8.5';
create or replace view aggView3430539252122821960 as select id as v22 from keyword as k where keyword IN ('murder','murder-in-title','blood','violence');
create or replace view aggJoin4132503692646500998 as select movie_id as v45 from movie_keyword as mk, aggView3430539252122821960 where mk.keyword_id=aggView3430539252122821960.v22;
create or replace view aggView8968165057976039435 as select v45 from aggJoin4132503692646500998 group by v45;
create or replace view aggJoin8904453912014662055 as select v45, v46, v49 from aggJoin1033415634772099085 join aggView8968165057976039435 using(v45);
create or replace view aggView8010366939738096065 as select v46, v45 from aggJoin8904453912014662055 group by v46,v45;
create or replace view aggView7763530588566089999 as select v9, MIN(v10) as v57 from aggView8783555252229564553 group by v9;
create or replace view aggJoin8897308603090074939 as select movie_id as v45, company_type_id as v16, note as v31, v57 from movie_companies as mc, aggView7763530588566089999 where mc.company_id=aggView7763530588566089999.v9 and note NOT LIKE '%(USA)%' and note LIKE '%(200%)%';
create or replace view aggView6540413316156116804 as select id as v16 from company_type as ct;
create or replace view aggJoin1915934571758618850 as select v45, v31, v57 from aggJoin8897308603090074939 join aggView6540413316156116804 using(v16);
create or replace view aggView4272438202963059112 as select id as v5 from comp_cast_type as cct1 where kind= 'cast';
create or replace view aggJoin4656777151443969569 as select movie_id as v45, status_id as v7 from complete_cast as cc, aggView4272438202963059112 where cc.subject_id=aggView4272438202963059112.v5;
create or replace view aggView6523919455786758577 as select id as v7 from comp_cast_type as cct2 where kind= 'complete';
create or replace view aggJoin1583683292992489439 as select v45 from aggJoin4656777151443969569 join aggView6523919455786758577 using(v7);
create or replace view aggView6207880473343872613 as select id as v18 from info_type as it1 where info= 'countries';
create or replace view aggJoin6773261090767240598 as select movie_id as v45, info as v35 from movie_info as mi, aggView6207880473343872613 where mi.info_type_id=aggView6207880473343872613.v18 and info IN ('Sweden','Norway','Germany','Denmark','Swedish','Danish','Norwegian','German','USA','American');
create or replace view aggView5304531133534496180 as select v45 from aggJoin6773261090767240598 group by v45;
create or replace view aggJoin695895345100572189 as select v45 from aggJoin1583683292992489439 join aggView5304531133534496180 using(v45);
create or replace view aggView2820086107992459603 as select v45 from aggJoin695895345100572189 group by v45;
create or replace view aggJoin4191733585214912709 as select v45, v31, v57 as v57 from aggJoin1915934571758618850 join aggView2820086107992459603 using(v45);
create or replace view aggView8560874217247930192 as select v45, MIN(v57) as v57 from aggJoin4191733585214912709 group by v45,v57;
create or replace view aggJoin7130704184933427891 as select v45, v40, v57 from aggJoin2500493305540529681 join aggView8560874217247930192 using(v45);
create or replace view aggView8877499121707760220 as select v45, MIN(v57) as v57, MIN(v40) as v58 from aggJoin7130704184933427891 group by v45,v57;
create or replace view aggJoin3865224614173270414 as select v46, v57, v58 from aggView8010366939738096065 join aggView8877499121707760220 using(v45);
select MIN(v57) as v57,MIN(v58) as v58,MIN(v46) as v59 from aggJoin3865224614173270414;
