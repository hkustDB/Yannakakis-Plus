create or replace view aggView3431734346020500994 as select id as v9, name as v10 from company_name as cn where country_code<> '[us]';
create or replace view aggView7538569653742444543 as select id as v5 from comp_cast_type as cct1 where kind= 'cast';
create or replace view aggJoin8964736799503697059 as select movie_id as v45, status_id as v7 from complete_cast as cc, aggView7538569653742444543 where cc.subject_id=aggView7538569653742444543.v5;
create or replace view aggView2432579371827838538 as select id as v25 from kind_type as kt where kind IN ('movie','episode');
create or replace view aggJoin956698821002226910 as select id as v45, title as v46, production_year as v49 from title as t, aggView2432579371827838538 where t.kind_id=aggView2432579371827838538.v25 and production_year>2005;
create or replace view aggView1116248633857076920 as select v46, v45 from aggJoin956698821002226910 group by v46,v45;
create or replace view aggView6440452666647606659 as select id as v20 from info_type as it2 where info= 'rating';
create or replace view aggJoin3977032053877920304 as select movie_id as v45, info as v40 from movie_info_idx as mi_idx, aggView6440452666647606659 where mi_idx.info_type_id=aggView6440452666647606659.v20;
create or replace view aggView830320260535679034 as select id as v7 from comp_cast_type as cct2 where kind= 'complete';
create or replace view aggJoin2149390559697848341 as select v45 from aggJoin8964736799503697059 join aggView830320260535679034 using(v7);
create or replace view aggView5329698405976410933 as select id as v18 from info_type as it1 where info= 'countries';
create or replace view aggJoin2386166267913054230 as select movie_id as v45, info as v35 from movie_info as mi, aggView5329698405976410933 where mi.info_type_id=aggView5329698405976410933.v18 and info IN ('Sweden','Norway','Germany','Denmark','Swedish','Danish','Norwegian','German','USA','American');
create or replace view aggView1028126430585789369 as select v45 from aggJoin2386166267913054230 group by v45;
create or replace view aggJoin4331788463857642288 as select v45 from aggJoin2149390559697848341 join aggView1028126430585789369 using(v45);
create or replace view aggView7796727907709158275 as select v45 from aggJoin4331788463857642288 group by v45;
create or replace view aggJoin1261248194051197993 as select v45, v40 from aggJoin3977032053877920304 join aggView7796727907709158275 using(v45);
create or replace view aggView817470209904018623 as select v45, v40 from aggJoin1261248194051197993 group by v45,v40;
create or replace view aggJoin3759079160818680863 as select v45, v40 from aggView817470209904018623 where v40<'8.5';
create or replace view aggView7093291814374651524 as select v45, MIN(v46) as v59 from aggView1116248633857076920 group by v45;
create or replace view aggJoin4339436239669251088 as select v45, v40, v59 from aggJoin3759079160818680863 join aggView7093291814374651524 using(v45);
create or replace view aggView9103473456476792052 as select v45, MIN(v59) as v59, MIN(v40) as v58 from aggJoin4339436239669251088 group by v45,v59;
create or replace view aggJoin282477269996286325 as select movie_id as v45, company_id as v9, company_type_id as v16, note as v31, v59, v58 from movie_companies as mc, aggView9103473456476792052 where mc.movie_id=aggView9103473456476792052.v45 and note NOT LIKE '%(USA)%' and note LIKE '%(200%)%';
create or replace view aggView1829090840869488933 as select id as v16 from company_type as ct;
create or replace view aggJoin3973792818448441063 as select v45, v9, v31, v59, v58 from aggJoin282477269996286325 join aggView1829090840869488933 using(v16);
create or replace view aggView7121214027423634813 as select id as v22 from keyword as k where keyword IN ('murder','murder-in-title','blood','violence');
create or replace view aggJoin6662764700176544960 as select movie_id as v45 from movie_keyword as mk, aggView7121214027423634813 where mk.keyword_id=aggView7121214027423634813.v22;
create or replace view aggView7979799021859541594 as select v45 from aggJoin6662764700176544960 group by v45;
create or replace view aggJoin1078847913284829690 as select v9, v31, v59 as v59, v58 as v58 from aggJoin3973792818448441063 join aggView7979799021859541594 using(v45);
create or replace view aggView9107628031100454365 as select v9, MIN(v59) as v59, MIN(v58) as v58 from aggJoin1078847913284829690 group by v9,v58,v59;
create or replace view aggJoin1259880716683617909 as select v10, v59, v58 from aggView3431734346020500994 join aggView9107628031100454365 using(v9);
select MIN(v10) as v57,MIN(v58) as v58,MIN(v59) as v59 from aggJoin1259880716683617909;
