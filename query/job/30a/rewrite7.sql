create or replace view aggView3072334850095783470 as select id as v36, name as v59 from name as n where gender= 'm';
create or replace view aggJoin4455169589367668638 as select movie_id as v45, note as v13, v59 from cast_info as ci, aggView3072334850095783470 where ci.person_id=aggView3072334850095783470.v36 and note IN ('(writer)','(head writer)','(written by)','(story)','(story editor)');
create or replace view aggView2203481230164420007 as select id as v16 from info_type as it1 where info= 'genres';
create or replace view aggJoin7079470417349832134 as select movie_id as v45, info as v26 from movie_info as mi, aggView2203481230164420007 where mi.info_type_id=aggView2203481230164420007.v16 and info IN ('Horror','Thriller');
create or replace view aggView7817922016421805696 as select id as v20 from keyword as k where keyword IN ('murder','violence','blood','gore','death','female-nudity','hospital');
create or replace view aggJoin3122797182548209784 as select movie_id as v45 from movie_keyword as mk, aggView7817922016421805696 where mk.keyword_id=aggView7817922016421805696.v20;
create or replace view aggView7430028164510108884 as select id as v7 from comp_cast_type as cct2 where kind= 'complete+verified';
create or replace view aggJoin1808166145414715027 as select movie_id as v45, subject_id as v5 from complete_cast as cc, aggView7430028164510108884 where cc.status_id=aggView7430028164510108884.v7;
create or replace view aggView6795391239365128930 as select id as v5 from comp_cast_type as cct1 where kind IN ('cast','crew');
create or replace view aggJoin4670721058184039714 as select v45 from aggJoin1808166145414715027 join aggView6795391239365128930 using(v5);
create or replace view aggView3089362327772545532 as select v45 from aggJoin4670721058184039714 group by v45;
create or replace view aggJoin4053423208774241669 as select v45 from aggJoin3122797182548209784 join aggView3089362327772545532 using(v45);
create or replace view aggView58644536041526174 as select v45 from aggJoin4053423208774241669 group by v45;
create or replace view aggJoin7997001016227200179 as select v45, v26 from aggJoin7079470417349832134 join aggView58644536041526174 using(v45);
create or replace view aggView5017976731691840006 as select v45, MIN(v26) as v57 from aggJoin7997001016227200179 group by v45;
create or replace view aggJoin6981723828476677435 as select id as v45, title as v46, v57 from title as t, aggView5017976731691840006 where t.id=aggView5017976731691840006.v45 and production_year>2000;
create or replace view aggView8336480901886863182 as select id as v18 from info_type as it2 where info= 'votes';
create or replace view aggJoin2326928462076737536 as select movie_id as v45, info as v31 from movie_info_idx as mi_idx, aggView8336480901886863182 where mi_idx.info_type_id=aggView8336480901886863182.v18;
create or replace view aggView1129258413786713882 as select v45, MIN(v31) as v58 from aggJoin2326928462076737536 group by v45;
create or replace view aggJoin5508827822521766571 as select v45, v59 as v59, v58 from aggJoin4455169589367668638 join aggView1129258413786713882 using(v45);
create or replace view aggView8368863756752872341 as select v45, MIN(v59) as v59, MIN(v58) as v58 from aggJoin5508827822521766571 group by v45;
create or replace view aggJoin8065989099314865562 as select v46, v57 as v57, v59, v58 from aggJoin6981723828476677435 join aggView8368863756752872341 using(v45);
create or replace view res as select MIN(v57) as v57, MIN(v58) as v58, MIN(v59) as v59, MIN(v46) as v60 from aggJoin8065989099314865562;
select sum(v57+v58+v59+v60) from res;