create or replace view aggView7601594031897473671 as select id as v1, name as v49 from company_name as cn where country_code<> '[us]';
create or replace view aggJoin7662845032107052843 as select movie_id as v37, company_type_id as v8, v49 from movie_companies as mc, aggView7601594031897473671 where mc.company_id=aggView7601594031897473671.v1;
create or replace view aggView4270183055294046952 as select id as v12 from info_type as it2 where info= 'rating';
create or replace view aggJoin2221823888867689689 as select movie_id as v37, info as v32 from movie_info_idx as mi_idx, aggView4270183055294046952 where mi_idx.info_type_id=aggView4270183055294046952.v12 and info<'8.5';
create or replace view aggView377761964371770031 as select id as v8 from company_type as ct;
create or replace view aggJoin3669777950644376404 as select v37, v49 from aggJoin7662845032107052843 join aggView377761964371770031 using(v8);
create or replace view aggView7207245555084689976 as select v37, MIN(v49) as v49 from aggJoin3669777950644376404 group by v37;
create or replace view aggJoin1590432439751117989 as select movie_id as v37, keyword_id as v14, v49 from movie_keyword as mk, aggView7207245555084689976 where mk.movie_id=aggView7207245555084689976.v37;
create or replace view aggView181807263836684472 as select id as v14 from keyword as k where keyword IN ('murder','murder-in-title','blood','violence');
create or replace view aggJoin317401555440224953 as select v37, v49 from aggJoin1590432439751117989 join aggView181807263836684472 using(v14);
create or replace view aggView9032673580493015773 as select v37, MIN(v49) as v49 from aggJoin317401555440224953 group by v37;
create or replace view aggJoin7845408344119786331 as select id as v37, title as v38, kind_id as v17, v49 from title as t, aggView9032673580493015773 where t.id=aggView9032673580493015773.v37 and production_year>2005;
create or replace view aggView6594399052345565344 as select id as v10 from info_type as it1 where info= 'countries';
create or replace view aggJoin5472614961679079403 as select movie_id as v37 from movie_info as mi, aggView6594399052345565344 where mi.info_type_id=aggView6594399052345565344.v10 and info IN ('Sweden','Norway','Germany','Denmark','Swedish','Danish','Norwegian','German','USA','American');
create or replace view aggView4153644663520979235 as select v37 from aggJoin5472614961679079403 group by v37;
create or replace view aggJoin3914791562375029539 as select v37, v32 from aggJoin2221823888867689689 join aggView4153644663520979235 using(v37);
create or replace view aggView3716911162643509755 as select v37, MIN(v32) as v50 from aggJoin3914791562375029539 group by v37;
create or replace view aggJoin3878609438456863885 as select v38, v17, v49 as v49, v50 from aggJoin7845408344119786331 join aggView3716911162643509755 using(v37);
create or replace view aggView5775794567756947548 as select v17, MIN(v49) as v49, MIN(v50) as v50, MIN(v38) as v51 from aggJoin3878609438456863885 group by v17;
create or replace view aggJoin542724051199491732 as select v49, v50, v51 from kind_type as kt, aggView5775794567756947548 where kt.id=aggView5775794567756947548.v17 and kind IN ('movie','episode');
create or replace view res as select MIN(v49) as v49, MIN(v50) as v50, MIN(v51) as v51 from aggJoin542724051199491732;
select sum(v49+v50+v51) from res;