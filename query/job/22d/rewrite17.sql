create or replace view aggView6613199279899956125 as select id as v1, name as v49 from company_name as cn where country_code<> '[us]';
create or replace view aggJoin6817969809607372140 as select movie_id as v37, company_type_id as v8, v49 from movie_companies as mc, aggView6613199279899956125 where mc.company_id=aggView6613199279899956125.v1;
create or replace view aggView444451957253409149 as select id as v10 from info_type as it1 where info= 'countries';
create or replace view aggJoin4570653804755639804 as select movie_id as v37, info as v27 from movie_info as mi, aggView444451957253409149 where mi.info_type_id=aggView444451957253409149.v10 and info IN ('Sweden','Norway','Germany','Denmark','Swedish','Danish','Norwegian','German','USA','American');
create or replace view aggView7735107441202633938 as select id as v14 from keyword as k where keyword IN ('murder','murder-in-title','blood','violence');
create or replace view aggJoin2817306713878951025 as select movie_id as v37 from movie_keyword as mk, aggView7735107441202633938 where mk.keyword_id=aggView7735107441202633938.v14;
create or replace view aggView408066872825709815 as select id as v8 from company_type as ct;
create or replace view aggJoin3378526735564451487 as select v37, v49 from aggJoin6817969809607372140 join aggView408066872825709815 using(v8);
create or replace view aggView4023075153968119249 as select id as v12 from info_type as it2 where info= 'rating';
create or replace view aggJoin11963486599113959 as select movie_id as v37, info as v32 from movie_info_idx as mi_idx, aggView4023075153968119249 where mi_idx.info_type_id=aggView4023075153968119249.v12 and info<'8.5';
create or replace view aggView7156082925628554026 as select v37, MIN(v49) as v49 from aggJoin3378526735564451487 group by v37,v49;
create or replace view aggJoin546941144650840236 as select v37, v49 from aggJoin2817306713878951025 join aggView7156082925628554026 using(v37);
create or replace view aggView993138389821008189 as select v37, MIN(v49) as v49 from aggJoin546941144650840236 group by v37,v49;
create or replace view aggJoin5963718206021951022 as select id as v37, title as v38, kind_id as v17, production_year as v41, v49 from title as t, aggView993138389821008189 where t.id=aggView993138389821008189.v37 and production_year>2005;
create or replace view aggView6810683328303960061 as select id as v17 from kind_type as kt where kind IN ('movie','episode');
create or replace view aggJoin528258113333004260 as select v37, v38, v41, v49 from aggJoin5963718206021951022 join aggView6810683328303960061 using(v17);
create or replace view aggView4912139492803030968 as select v37, MIN(v49) as v49, MIN(v38) as v51 from aggJoin528258113333004260 group by v37,v49;
create or replace view aggJoin6366746485425451551 as select v37, v32, v49, v51 from aggJoin11963486599113959 join aggView4912139492803030968 using(v37);
create or replace view aggView9116070582665437991 as select v37, MIN(v49) as v49, MIN(v51) as v51, MIN(v32) as v50 from aggJoin6366746485425451551 group by v37,v49,v51;
create or replace view aggJoin570334389863130429 as select v49, v51, v50 from aggJoin4570653804755639804 join aggView9116070582665437991 using(v37);
select MIN(v49) as v49,MIN(v50) as v50,MIN(v51) as v51 from aggJoin570334389863130429;
