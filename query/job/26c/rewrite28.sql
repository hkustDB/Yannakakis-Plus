create or replace view aggView5163433700215012988 as select id as v28 from kind_type as kt where kind= 'movie';
create or replace view aggJoin1442672111693674688 as select id as v47, title as v48 from title as t, aggView5163433700215012988 where t.kind_id=aggView5163433700215012988.v28 and production_year>2000;
create or replace view aggView4590439920467653434 as select id as v38 from name as n;
create or replace view aggJoin9032329208665410318 as select movie_id as v47, person_role_id as v9 from cast_info as ci, aggView4590439920467653434 where ci.person_id=aggView4590439920467653434.v38;
create or replace view aggView474225365853086068 as select id as v23 from info_type as it2 where info= 'rating';
create or replace view aggJoin3367177932112352883 as select movie_id as v47, info as v33 from movie_info_idx as mi_idx, aggView474225365853086068 where mi_idx.info_type_id=aggView474225365853086068.v23;
create or replace view aggView320972170522769131 as select id as v5 from comp_cast_type as cct1 where kind= 'cast';
create or replace view aggJoin4098633117980233661 as select movie_id as v47, status_id as v7 from complete_cast as cc, aggView320972170522769131 where cc.subject_id=aggView320972170522769131.v5;
create or replace view aggView973983581546542707 as select id as v7 from comp_cast_type as cct2 where kind LIKE '%complete%';
create or replace view aggJoin6364353933822407865 as select v47 from aggJoin4098633117980233661 join aggView973983581546542707 using(v7);
create or replace view aggView388002188790189410 as select v47 from aggJoin6364353933822407865 group by v47;
create or replace view aggJoin6686616353964661803 as select v47, v48 from aggJoin1442672111693674688 join aggView388002188790189410 using(v47);
create or replace view aggView2777355414997251155 as select v47, MIN(v48) as v61 from aggJoin6686616353964661803 group by v47;
create or replace view aggJoin1333446561401558140 as select movie_id as v47, keyword_id as v25, v61 from movie_keyword as mk, aggView2777355414997251155 where mk.movie_id=aggView2777355414997251155.v47;
create or replace view aggView52037890512183314 as select id as v25 from keyword as k where keyword IN ('superhero','marvel-comics','based-on-comic','tv-special','fight','violence','magnet','web','claw','laser');
create or replace view aggJoin5943286920113668937 as select v47, v61 from aggJoin1333446561401558140 join aggView52037890512183314 using(v25);
create or replace view aggView6976567230958243383 as select v47, MIN(v61) as v61 from aggJoin5943286920113668937 group by v47;
create or replace view aggJoin8531101857595068034 as select v47, v33, v61 from aggJoin3367177932112352883 join aggView6976567230958243383 using(v47);
create or replace view aggView6405937284684168331 as select v47, MIN(v61) as v61, MIN(v33) as v60 from aggJoin8531101857595068034 group by v47;
create or replace view aggJoin4493473161782018830 as select v9, v61, v60 from aggJoin9032329208665410318 join aggView6405937284684168331 using(v47);
create or replace view aggView5201158819940287522 as select v9, MIN(v61) as v61, MIN(v60) as v60 from aggJoin4493473161782018830 group by v9;
create or replace view aggJoin5995646229503569487 as select name as v10, v61, v60 from char_name as chn, aggView5201158819940287522 where chn.id=aggView5201158819940287522.v9 and ((name LIKE '%man%') OR (name LIKE '%Man%'));
create or replace view res as select MIN(v10) as v59, MIN(v60) as v60, MIN(v61) as v61 from aggJoin5995646229503569487;
select sum(v59+v60+v61) from res;