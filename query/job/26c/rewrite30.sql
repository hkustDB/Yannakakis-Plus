create or replace view aggView9051190634572748185 as select id as v9, name as v59 from char_name as chn where ((name LIKE '%man%') OR (name LIKE '%Man%'));
create or replace view aggJoin5344444432968603001 as select person_id as v38, movie_id as v47, v59 from cast_info as ci, aggView9051190634572748185 where ci.person_role_id=aggView9051190634572748185.v9;
create or replace view aggView2616940131706674619 as select id as v28 from kind_type as kt where kind= 'movie';
create or replace view aggJoin9011550729123709993 as select id as v47, title as v48 from title as t, aggView2616940131706674619 where t.kind_id=aggView2616940131706674619.v28 and production_year>2000;
create or replace view aggView2156016124212328759 as select id as v38 from name as n;
create or replace view aggJoin574354347256409971 as select v47, v59 from aggJoin5344444432968603001 join aggView2156016124212328759 using(v38);
create or replace view aggView4154800768795999649 as select id as v23 from info_type as it2 where info= 'rating';
create or replace view aggJoin6595883784907880524 as select movie_id as v47, info as v33 from movie_info_idx as mi_idx, aggView4154800768795999649 where mi_idx.info_type_id=aggView4154800768795999649.v23;
create or replace view aggView7089664503551386091 as select id as v7 from comp_cast_type as cct2 where kind LIKE '%complete%';
create or replace view aggJoin1579226493691965678 as select movie_id as v47, subject_id as v5 from complete_cast as cc, aggView7089664503551386091 where cc.status_id=aggView7089664503551386091.v7;
create or replace view aggView6022787402712581145 as select v47, MIN(v59) as v59 from aggJoin574354347256409971 group by v47;
create or replace view aggJoin1939324508842368747 as select v47, v48, v59 from aggJoin9011550729123709993 join aggView6022787402712581145 using(v47);
create or replace view aggView1225095039881982232 as select v47, MIN(v59) as v59, MIN(v48) as v61 from aggJoin1939324508842368747 group by v47;
create or replace view aggJoin4528921438089883044 as select v47, v33, v59, v61 from aggJoin6595883784907880524 join aggView1225095039881982232 using(v47);
create or replace view aggView6876405255820818495 as select v47, MIN(v59) as v59, MIN(v61) as v61, MIN(v33) as v60 from aggJoin4528921438089883044 group by v47;
create or replace view aggJoin2803938843364622126 as select movie_id as v47, keyword_id as v25, v59, v61, v60 from movie_keyword as mk, aggView6876405255820818495 where mk.movie_id=aggView6876405255820818495.v47;
create or replace view aggView4681523428827323051 as select id as v25 from keyword as k where keyword IN ('superhero','marvel-comics','based-on-comic','tv-special','fight','violence','magnet','web','claw','laser');
create or replace view aggJoin3593459399087477027 as select v47, v59, v61, v60 from aggJoin2803938843364622126 join aggView4681523428827323051 using(v25);
create or replace view aggView3246114505072935900 as select v47, MIN(v59) as v59, MIN(v61) as v61, MIN(v60) as v60 from aggJoin3593459399087477027 group by v47;
create or replace view aggJoin8765767120996649750 as select v5, v59, v61, v60 from aggJoin1579226493691965678 join aggView3246114505072935900 using(v47);
create or replace view aggView2656759470451755284 as select v5, MIN(v59) as v59, MIN(v61) as v61, MIN(v60) as v60 from aggJoin8765767120996649750 group by v5;
create or replace view aggJoin9202419571740844423 as select v59, v61, v60 from comp_cast_type as cct1, aggView2656759470451755284 where cct1.id=aggView2656759470451755284.v5 and kind= 'cast';
create or replace view res as select MIN(v59) as v59, MIN(v60) as v60, MIN(v61) as v61 from aggJoin9202419571740844423;
select sum(v59+v60+v61) from res;