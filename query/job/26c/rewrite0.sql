create or replace view aggView8781707792912060173 as select id as v9, name as v59 from char_name as chn where ((name LIKE '%man%') OR (name LIKE '%Man%'));
create or replace view aggJoin6647540837933434016 as select person_id as v38, movie_id as v47, v59 from cast_info as ci, aggView8781707792912060173 where ci.person_role_id=aggView8781707792912060173.v9;
create or replace view aggView6501029690974037228 as select id as v28 from kind_type as kt where kind= 'movie';
create or replace view aggJoin7767023211286256438 as select id as v47, title as v48 from title as t, aggView6501029690974037228 where t.kind_id=aggView6501029690974037228.v28 and production_year>2000;
create or replace view aggView2498522756553650311 as select id as v38 from name as n;
create or replace view aggJoin5377945486062254356 as select v47, v59 from aggJoin6647540837933434016 join aggView2498522756553650311 using(v38);
create or replace view aggView1753500857467688276 as select id as v23 from info_type as it2 where info= 'rating';
create or replace view aggJoin5965063174605885442 as select movie_id as v47, info as v33 from movie_info_idx as mi_idx, aggView1753500857467688276 where mi_idx.info_type_id=aggView1753500857467688276.v23;
create or replace view aggView7927188434322634289 as select v47, MIN(v59) as v59 from aggJoin5377945486062254356 group by v47;
create or replace view aggJoin1957334922919684410 as select v47, v33, v59 from aggJoin5965063174605885442 join aggView7927188434322634289 using(v47);
create or replace view aggView4476024510178031778 as select v47, MIN(v59) as v59, MIN(v33) as v60 from aggJoin1957334922919684410 group by v47;
create or replace view aggJoin3562683087485648254 as select movie_id as v47, keyword_id as v25, v59, v60 from movie_keyword as mk, aggView4476024510178031778 where mk.movie_id=aggView4476024510178031778.v47;
create or replace view aggView227140544168380115 as select id as v7 from comp_cast_type as cct2 where kind LIKE '%complete%';
create or replace view aggJoin6735967166432217361 as select movie_id as v47, subject_id as v5 from complete_cast as cc, aggView227140544168380115 where cc.status_id=aggView227140544168380115.v7;
create or replace view aggView8729504079429790375 as select id as v25 from keyword as k where keyword IN ('superhero','marvel-comics','based-on-comic','tv-special','fight','violence','magnet','web','claw','laser');
create or replace view aggJoin3401105711319352235 as select v47, v59, v60 from aggJoin3562683087485648254 join aggView8729504079429790375 using(v25);
create or replace view aggView2836223024722430060 as select v47, MIN(v59) as v59, MIN(v60) as v60 from aggJoin3401105711319352235 group by v47;
create or replace view aggJoin2619555902384565915 as select v47, v48, v59, v60 from aggJoin7767023211286256438 join aggView2836223024722430060 using(v47);
create or replace view aggView7020967032702763712 as select v47, MIN(v59) as v59, MIN(v60) as v60, MIN(v48) as v61 from aggJoin2619555902384565915 group by v47;
create or replace view aggJoin774381739343449606 as select v5, v59, v60, v61 from aggJoin6735967166432217361 join aggView7020967032702763712 using(v47);
create or replace view aggView7144046525125556905 as select v5, MIN(v59) as v59, MIN(v60) as v60, MIN(v61) as v61 from aggJoin774381739343449606 group by v5;
create or replace view aggJoin2098097540537821895 as select v59, v60, v61 from comp_cast_type as cct1, aggView7144046525125556905 where cct1.id=aggView7144046525125556905.v5 and kind= 'cast';
create or replace view res as select MIN(v59) as v59, MIN(v60) as v60, MIN(v61) as v61 from aggJoin2098097540537821895;
select sum(v59+v60+v61) from res;