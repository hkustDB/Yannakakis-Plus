create or replace view aggView6436018600701236731 as select id as v9, name as v59 from char_name as chn where ((name LIKE '%man%') OR (name LIKE '%Man%'));
create or replace view aggJoin2662050336925658767 as select person_id as v38, movie_id as v47, v59 from cast_info as ci, aggView6436018600701236731 where ci.person_role_id=aggView6436018600701236731.v9;
create or replace view aggView1053297181275949071 as select id as v28 from kind_type as kt where kind= 'movie';
create or replace view aggJoin4034844379449647588 as select id as v47, title as v48 from title as t, aggView1053297181275949071 where t.kind_id=aggView1053297181275949071.v28 and production_year>2000;
create or replace view aggView2694455256959384293 as select id as v38 from name as n;
create or replace view aggJoin4778692607061856954 as select v47, v59 from aggJoin2662050336925658767 join aggView2694455256959384293 using(v38);
create or replace view aggView16918372850759044 as select id as v5 from comp_cast_type as cct1 where kind= 'cast';
create or replace view aggJoin2336126167466356704 as select movie_id as v47, status_id as v7 from complete_cast as cc, aggView16918372850759044 where cc.subject_id=aggView16918372850759044.v5;
create or replace view aggView4878306983224139463 as select id as v7 from comp_cast_type as cct2 where kind LIKE '%complete%';
create or replace view aggJoin8933166260998145929 as select v47 from aggJoin2336126167466356704 join aggView4878306983224139463 using(v7);
create or replace view aggView4396510775219979218 as select v47 from aggJoin8933166260998145929 group by v47;
create or replace view aggJoin7123528724079080630 as select movie_id as v47, keyword_id as v25 from movie_keyword as mk, aggView4396510775219979218 where mk.movie_id=aggView4396510775219979218.v47;
create or replace view aggView3040566248796589755 as select v47, MIN(v59) as v59 from aggJoin4778692607061856954 group by v47;
create or replace view aggJoin1567936997154866803 as select v47, v48, v59 from aggJoin4034844379449647588 join aggView3040566248796589755 using(v47);
create or replace view aggView1899722891919968047 as select v47, MIN(v59) as v59, MIN(v48) as v61 from aggJoin1567936997154866803 group by v47;
create or replace view aggJoin1376002041699373785 as select movie_id as v47, info_type_id as v23, info as v33, v59, v61 from movie_info_idx as mi_idx, aggView1899722891919968047 where mi_idx.movie_id=aggView1899722891919968047.v47;
create or replace view aggView5366973818551261244 as select id as v25 from keyword as k where keyword IN ('superhero','marvel-comics','based-on-comic','tv-special','fight','violence','magnet','web','claw','laser');
create or replace view aggJoin3130360158502732466 as select v47 from aggJoin7123528724079080630 join aggView5366973818551261244 using(v25);
create or replace view aggView7634284427876147538 as select v47 from aggJoin3130360158502732466 group by v47;
create or replace view aggJoin6061500142150356830 as select v23, v33, v59 as v59, v61 as v61 from aggJoin1376002041699373785 join aggView7634284427876147538 using(v47);
create or replace view aggView2720968282508285449 as select v23, MIN(v59) as v59, MIN(v61) as v61, MIN(v33) as v60 from aggJoin6061500142150356830 group by v23;
create or replace view aggJoin4862198390151393582 as select v59, v61, v60 from info_type as it2, aggView2720968282508285449 where it2.id=aggView2720968282508285449.v23 and info= 'rating';
create or replace view res as select MIN(v59) as v59, MIN(v60) as v60, MIN(v61) as v61 from aggJoin4862198390151393582;
select sum(v59+v60+v61) from res;