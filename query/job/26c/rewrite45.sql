create or replace view aggView3309848067587295963 as select id as v9, name as v59 from char_name as chn where ((name LIKE '%man%') OR (name LIKE '%Man%'));
create or replace view aggJoin6803359217712086571 as select person_id as v38, movie_id as v47, v59 from cast_info as ci, aggView3309848067587295963 where ci.person_role_id=aggView3309848067587295963.v9;
create or replace view aggView5737012803466929217 as select id as v28 from kind_type as kt where kind= 'movie';
create or replace view aggJoin8897658761640927582 as select id as v47, title as v48 from title as t, aggView5737012803466929217 where t.kind_id=aggView5737012803466929217.v28 and production_year>2000;
create or replace view aggView31114513938305344 as select v47, MIN(v48) as v61 from aggJoin8897658761640927582 group by v47;
create or replace view aggJoin4234597638497979238 as select movie_id as v47, subject_id as v5, status_id as v7, v61 from complete_cast as cc, aggView31114513938305344 where cc.movie_id=aggView31114513938305344.v47;
create or replace view aggView4954552297333618932 as select id as v38 from name as n;
create or replace view aggJoin1509391821215913138 as select v47, v59 from aggJoin6803359217712086571 join aggView4954552297333618932 using(v38);
create or replace view aggView8921726616225644831 as select id as v23 from info_type as it2 where info= 'rating';
create or replace view aggJoin1088880359891783545 as select movie_id as v47, info as v33 from movie_info_idx as mi_idx, aggView8921726616225644831 where mi_idx.info_type_id=aggView8921726616225644831.v23;
create or replace view aggView773105435841504144 as select id as v5 from comp_cast_type as cct1 where kind= 'cast';
create or replace view aggJoin6484443372587935918 as select v47, v7, v61 from aggJoin4234597638497979238 join aggView773105435841504144 using(v5);
create or replace view aggView3932678899172448074 as select id as v7 from comp_cast_type as cct2 where kind LIKE '%complete%';
create or replace view aggJoin2331308242326890133 as select v47, v61 from aggJoin6484443372587935918 join aggView3932678899172448074 using(v7);
create or replace view aggView6044365392636518044 as select v47, MIN(v61) as v61 from aggJoin2331308242326890133 group by v47;
create or replace view aggJoin5178372585426875552 as select v47, v33, v61 from aggJoin1088880359891783545 join aggView6044365392636518044 using(v47);
create or replace view aggView5918968008342932677 as select id as v25 from keyword as k where keyword IN ('superhero','marvel-comics','based-on-comic','tv-special','fight','violence','magnet','web','claw','laser');
create or replace view aggJoin5277096407148764783 as select movie_id as v47 from movie_keyword as mk, aggView5918968008342932677 where mk.keyword_id=aggView5918968008342932677.v25;
create or replace view aggView7660657547728955315 as select v47 from aggJoin5277096407148764783 group by v47;
create or replace view aggJoin3209765445993703429 as select v47, v59 as v59 from aggJoin1509391821215913138 join aggView7660657547728955315 using(v47);
create or replace view aggView2064711064486105719 as select v47, MIN(v59) as v59 from aggJoin3209765445993703429 group by v47;
create or replace view aggJoin6337849690486616894 as select v33, v61 as v61, v59 from aggJoin5178372585426875552 join aggView2064711064486105719 using(v47);
create or replace view res as select MIN(v59) as v59, MIN(v33) as v60, MIN(v61) as v61 from aggJoin6337849690486616894;
select sum(v59+v60+v61) from res;