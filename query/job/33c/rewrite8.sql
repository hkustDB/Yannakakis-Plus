create or replace view aggView6962424256485810603 as select id as v1, name as v73 from company_name as cn1 where country_code<> '[us]';
create or replace view aggJoin7453961313777845122 as select movie_id as v49, v73 from movie_companies as mc1, aggView6962424256485810603 where mc1.company_id=aggView6962424256485810603.v1;
create or replace view aggView8455640016695435820 as select id as v8, name as v74 from company_name as cn2;
create or replace view aggJoin5558777775189860561 as select movie_id as v61, v74 from movie_companies as mc2, aggView8455640016695435820 where mc2.company_id=aggView8455640016695435820.v8;
create or replace view aggView7223084744824155405 as select id as v19 from kind_type as kt1 where kind IN ('tv series','episode');
create or replace view aggJoin3491944851871459736 as select id as v49, title as v50 from title as t1, aggView7223084744824155405 where t1.kind_id=aggView7223084744824155405.v19;
create or replace view aggView2100036355986314672 as select v49, MIN(v73) as v73 from aggJoin7453961313777845122 group by v49;
create or replace view aggJoin5472090726713285883 as select v49, v50, v73 from aggJoin3491944851871459736 join aggView2100036355986314672 using(v49);
create or replace view aggView8112080568607230006 as select v49, MIN(v73) as v73, MIN(v50) as v77 from aggJoin5472090726713285883 group by v49;
create or replace view aggJoin70469105992826439 as select movie_id as v49, info_type_id as v15, info as v38, v73, v77 from movie_info_idx as mi_idx1, aggView8112080568607230006 where mi_idx1.movie_id=aggView8112080568607230006.v49;
create or replace view aggView4491650353301197541 as select id as v15 from info_type as it1 where info= 'rating';
create or replace view aggJoin1861586021167798629 as select v49, v38, v73, v77 from aggJoin70469105992826439 join aggView4491650353301197541 using(v15);
create or replace view aggView6127631062979723602 as select v49, MIN(v73) as v73, MIN(v77) as v77, MIN(v38) as v75 from aggJoin1861586021167798629 group by v49;
create or replace view aggJoin1256028868884750676 as select linked_movie_id as v61, link_type_id as v23, v73, v77, v75 from movie_link as ml, aggView6127631062979723602 where ml.movie_id=aggView6127631062979723602.v49;
create or replace view aggView1681485090892111388 as select id as v17 from info_type as it2 where info= 'rating';
create or replace view aggJoin791592499214132022 as select movie_id as v61, info as v43 from movie_info_idx as mi_idx2, aggView1681485090892111388 where mi_idx2.info_type_id=aggView1681485090892111388.v17 and info<'3.5';
create or replace view aggView2437223916884117954 as select id as v23 from link_type as lt where link IN ('sequel','follows','followed by');
create or replace view aggJoin7557437193424875299 as select v61, v73, v77, v75 from aggJoin1256028868884750676 join aggView2437223916884117954 using(v23);
create or replace view aggView4292300478829351947 as select v61, MIN(v73) as v73, MIN(v77) as v77, MIN(v75) as v75 from aggJoin7557437193424875299 group by v61;
create or replace view aggJoin1333257644785377978 as select v61, v43, v73, v77, v75 from aggJoin791592499214132022 join aggView4292300478829351947 using(v61);
create or replace view aggView8241693034651267214 as select v61, MIN(v73) as v73, MIN(v77) as v77, MIN(v75) as v75, MIN(v43) as v76 from aggJoin1333257644785377978 group by v61;
create or replace view aggJoin923467298265345368 as select v61, v74 as v74, v73, v77, v75, v76 from aggJoin5558777775189860561 join aggView8241693034651267214 using(v61);
create or replace view aggView7853759200470769753 as select v61, MIN(v74) as v74, MIN(v73) as v73, MIN(v77) as v77, MIN(v75) as v75, MIN(v76) as v76 from aggJoin923467298265345368 group by v61;
create or replace view aggJoin5938062817435977280 as select title as v62, kind_id as v21, v74, v73, v77, v75, v76 from title as t2, aggView7853759200470769753 where t2.id=aggView7853759200470769753.v61 and production_year>=2000 and production_year<=2010;
create or replace view aggView7172404938987400178 as select v21, MIN(v74) as v74, MIN(v73) as v73, MIN(v77) as v77, MIN(v75) as v75, MIN(v76) as v76, MIN(v62) as v78 from aggJoin5938062817435977280 group by v21;
create or replace view aggJoin1524140859681081063 as select v74, v73, v77, v75, v76, v78 from kind_type as kt2, aggView7172404938987400178 where kt2.id=aggView7172404938987400178.v21 and kind IN ('tv series','episode');
create or replace view res as select MIN(v73) as v73, MIN(v74) as v74, MIN(v75) as v75, MIN(v76) as v76, MIN(v77) as v77, MIN(v78) as v78 from aggJoin1524140859681081063;
select sum(v73+v74+v75+v76+v77+v78) from res;