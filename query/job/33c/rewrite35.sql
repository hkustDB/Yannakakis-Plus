create or replace view aggView4148919930181461854 as select id as v1, name as v73 from company_name as cn1 where country_code<> '[us]';
create or replace view aggJoin6274437338869538027 as select movie_id as v49, v73 from movie_companies as mc1, aggView4148919930181461854 where mc1.company_id=aggView4148919930181461854.v1;
create or replace view aggView9151145828805360492 as select id as v8, name as v74 from company_name as cn2;
create or replace view aggJoin8122123937107848657 as select movie_id as v61, v74 from movie_companies as mc2, aggView9151145828805360492 where mc2.company_id=aggView9151145828805360492.v8;
create or replace view aggView5331184499398474654 as select id as v21 from kind_type as kt2 where kind IN ('tv series','episode');
create or replace view aggJoin335073113972897850 as select id as v61, title as v62 from title as t2, aggView5331184499398474654 where t2.kind_id=aggView5331184499398474654.v21 and production_year>=2000 and production_year<=2010;
create or replace view aggView4360984792576653303 as select v61, MIN(v62) as v78 from aggJoin335073113972897850 group by v61;
create or replace view aggJoin1924172344381193495 as select v61, v74 as v74, v78 from aggJoin8122123937107848657 join aggView4360984792576653303 using(v61);
create or replace view aggView6749107015424504553 as select id as v15 from info_type as it1 where info= 'rating';
create or replace view aggJoin4719420263652565031 as select movie_id as v49, info as v38 from movie_info_idx as mi_idx1, aggView6749107015424504553 where mi_idx1.info_type_id=aggView6749107015424504553.v15;
create or replace view aggView8881916463569892817 as select v61, MIN(v74) as v74, MIN(v78) as v78 from aggJoin1924172344381193495 group by v61;
create or replace view aggJoin2523440494388909003 as select movie_id as v61, info_type_id as v17, info as v43, v74, v78 from movie_info_idx as mi_idx2, aggView8881916463569892817 where mi_idx2.movie_id=aggView8881916463569892817.v61 and info<'3.5';
create or replace view aggView6413466133846472981 as select v49, MIN(v73) as v73 from aggJoin6274437338869538027 group by v49;
create or replace view aggJoin4548926176003027330 as select v49, v38, v73 from aggJoin4719420263652565031 join aggView6413466133846472981 using(v49);
create or replace view aggView6496337593598618685 as select v49, MIN(v73) as v73, MIN(v38) as v75 from aggJoin4548926176003027330 group by v49;
create or replace view aggJoin7049465767073057967 as select id as v49, title as v50, kind_id as v19, v73, v75 from title as t1, aggView6496337593598618685 where t1.id=aggView6496337593598618685.v49;
create or replace view aggView7995135704902781676 as select id as v17 from info_type as it2 where info= 'rating';
create or replace view aggJoin8942864989340506070 as select v61, v43, v74, v78 from aggJoin2523440494388909003 join aggView7995135704902781676 using(v17);
create or replace view aggView5652613122398222152 as select v61, MIN(v74) as v74, MIN(v78) as v78, MIN(v43) as v76 from aggJoin8942864989340506070 group by v61;
create or replace view aggJoin2143486824249235532 as select movie_id as v49, link_type_id as v23, v74, v78, v76 from movie_link as ml, aggView5652613122398222152 where ml.linked_movie_id=aggView5652613122398222152.v61;
create or replace view aggView4267407772307557548 as select id as v23 from link_type as lt where link IN ('sequel','follows','followed by');
create or replace view aggJoin449763790763270887 as select v49, v74, v78, v76 from aggJoin2143486824249235532 join aggView4267407772307557548 using(v23);
create or replace view aggView7096541650953989991 as select v49, MIN(v74) as v74, MIN(v78) as v78, MIN(v76) as v76 from aggJoin449763790763270887 group by v49;
create or replace view aggJoin875502247530179238 as select v50, v19, v73 as v73, v75 as v75, v74, v78, v76 from aggJoin7049465767073057967 join aggView7096541650953989991 using(v49);
create or replace view aggView4483632842339063744 as select v19, MIN(v73) as v73, MIN(v75) as v75, MIN(v74) as v74, MIN(v78) as v78, MIN(v76) as v76, MIN(v50) as v77 from aggJoin875502247530179238 group by v19;
create or replace view aggJoin661009358956972901 as select v73, v75, v74, v78, v76, v77 from kind_type as kt1, aggView4483632842339063744 where kt1.id=aggView4483632842339063744.v19 and kind IN ('tv series','episode');
create or replace view res as select MIN(v73) as v73, MIN(v74) as v74, MIN(v75) as v75, MIN(v76) as v76, MIN(v77) as v77, MIN(v78) as v78 from aggJoin661009358956972901;
select sum(v73+v74+v75+v76+v77+v78) from res;