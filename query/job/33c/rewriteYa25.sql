create or replace view semiUp5550811049529862023 as select id as v49, title as v50, kind_id as v19 from title AS t1 where (kind_id) in (select id from kind_type AS kt1 where kind IN ('tv series','episode'));
create or replace view semiUp6933248170144462244 as select movie_id as v49, info_type_id as v15, info as v38 from movie_info_idx AS mi_idx1 where (info_type_id) in (select id from info_type AS it1 where info= 'rating');
create or replace view semiUp7613616878037285380 as select movie_id as v49, company_id as v1 from movie_companies AS mc1 where (company_id) in (select id from company_name AS cn1 where country_code<> '[us]');
create or replace view semiUp7983505288819038731 as select movie_id as v61, info_type_id as v17, info as v43 from movie_info_idx AS mi_idx2 where (info_type_id) in (select id from info_type AS it2 where info= 'rating') and info<'3.5';
create or replace view semiUp2922901740227445084 as select v49, v15, v38 from semiUp6933248170144462244 where (v49) in (select v49 from semiUp5550811049529862023);
create or replace view semiUp6080546956062620351 as select movie_id as v49, linked_movie_id as v61, link_type_id as v23 from movie_link AS ml where (link_type_id) in (select id from link_type AS lt where link IN ('sequel','follows','followed by'));
create or replace view semiUp56957744842438083 as select id as v61, title as v62, kind_id as v21 from title AS t2 where (id) in (select v61 from semiUp7983505288819038731) and production_year>=2000 and production_year<=2010;
create or replace view semiUp5650054148552931696 as select v61, v62, v21 from semiUp56957744842438083 where (v21) in (select id from kind_type AS kt2 where kind IN ('tv series','episode'));
create or replace view semiUp3152901291650627995 as select movie_id as v61, company_id as v8 from movie_companies AS mc2 where (movie_id) in (select v61 from semiUp5650054148552931696);
create or replace view semiUp947021655466017919 as select v49, v1 from semiUp7613616878037285380 where (v49) in (select v49 from semiUp2922901740227445084);
create or replace view semiUp5453921231490857997 as select v49, v61, v23 from semiUp6080546956062620351 where (v49) in (select v49 from semiUp947021655466017919);
create or replace view semiUp1701080061202208763 as select v61, v8 from semiUp3152901291650627995 where (v61) in (select v61 from semiUp5453921231490857997);
create or replace view semiUp6568305831042042132 as select id as v8, name as v9 from company_name AS cn2 where (id) in (select v8 from semiUp1701080061202208763);
create or replace view semiDown7277955240472742530 as select v61, v8 from semiUp1701080061202208763 where (v8) in (select v8 from semiUp6568305831042042132);
create or replace view semiDown7794233275815318647 as select v61, v62, v21 from semiUp5650054148552931696 where (v61) in (select v61 from semiDown7277955240472742530);
create or replace view semiDown5106159579029802302 as select v49, v61, v23 from semiUp5453921231490857997 where (v61) in (select v61 from semiDown7277955240472742530);
create or replace view semiDown7313973523959942682 as select id as v21 from kind_type AS kt2 where (id) in (select v21 from semiDown7794233275815318647) and kind IN ('tv series','episode');
create or replace view semiDown722553260236178250 as select v61, v17, v43 from semiUp7983505288819038731 where (v61) in (select v61 from semiDown7794233275815318647);
create or replace view semiDown7377420435905488563 as select id as v23 from link_type AS lt where (id) in (select v23 from semiDown5106159579029802302) and link IN ('sequel','follows','followed by');
create or replace view semiDown5185407232295675975 as select v49, v1 from semiUp947021655466017919 where (v49) in (select v49 from semiDown5106159579029802302);
create or replace view semiDown5693167241053095115 as select id as v17 from info_type AS it2 where (id) in (select v17 from semiDown722553260236178250) and info= 'rating';
create or replace view semiDown9019547964264206884 as select v49, v15, v38 from semiUp2922901740227445084 where (v49) in (select v49 from semiDown5185407232295675975);
create or replace view semiDown8118399149147359421 as select id as v1, name as v2 from company_name AS cn1 where (id) in (select v1 from semiDown5185407232295675975) and country_code<> '[us]';
create or replace view semiDown904347081572658924 as select v49, v50, v19 from semiUp5550811049529862023 where (v49) in (select v49 from semiDown9019547964264206884);
create or replace view semiDown6068674870511416867 as select id as v15 from info_type AS it1 where (id) in (select v15 from semiDown9019547964264206884) and info= 'rating';
create or replace view semiDown4008389435445443041 as select id as v19 from kind_type AS kt1 where (id) in (select v19 from semiDown904347081572658924) and kind IN ('tv series','episode');
create or replace view aggView4680144873260826699 as select v19 from semiDown4008389435445443041;
create or replace view aggJoin3371640857893722888 as select v49, v50 from semiDown904347081572658924 join aggView4680144873260826699 using(v19);
create or replace view aggView3749117599877603039 as select v17 from semiDown5693167241053095115;
create or replace view aggJoin1579281350282224508 as select v61, v43 from semiDown722553260236178250 join aggView3749117599877603039 using(v17);
create or replace view aggView5608849329741967766 as select v15 from semiDown6068674870511416867;
create or replace view aggJoin7275032081444209338 as select v49, v38 from semiDown9019547964264206884 join aggView5608849329741967766 using(v15);
create or replace view aggView2113482948553046027 as select v49, MIN(v50) as v77 from aggJoin3371640857893722888 group by v49;
create or replace view aggJoin1476637112184137870 as select v49, v38, v77 from aggJoin7275032081444209338 join aggView2113482948553046027 using(v49);
create or replace view aggView6113527167184209532 as select v49, MIN(v77) as v77, MIN(v38) as v75 from aggJoin1476637112184137870 group by v49;
create or replace view aggJoin1002717760710390261 as select v49, v1, v77, v75 from semiDown5185407232295675975 join aggView6113527167184209532 using(v49);
create or replace view aggView6716836018452200961 as select v21 from semiDown7313973523959942682;
create or replace view aggJoin6016501187740027076 as select v61, v62 from semiDown7794233275815318647 join aggView6716836018452200961 using(v21);
create or replace view aggView1230539212116070469 as select v61, MIN(v43) as v76 from aggJoin1579281350282224508 group by v61;
create or replace view aggJoin1042114186201764948 as select v61, v62, v76 from aggJoin6016501187740027076 join aggView1230539212116070469 using(v61);
create or replace view aggView8225377880486185556 as select v1, v2 as v73 from semiDown8118399149147359421;
create or replace view aggJoin74872590572408602 as select v49, v77, v75, v73 from aggJoin1002717760710390261 join aggView8225377880486185556 using(v1);
create or replace view aggView7647377550807451645 as select v49, MIN(v77) as v77, MIN(v75) as v75, MIN(v73) as v73 from aggJoin74872590572408602 group by v49;
create or replace view aggJoin4812856054150201348 as select v61, v23, v77, v75, v73 from semiDown5106159579029802302 join aggView7647377550807451645 using(v49);
create or replace view aggView2539393785908506898 as select v23 from semiDown7377420435905488563;
create or replace view aggJoin5270920143218817016 as select v61, v77, v75, v73 from aggJoin4812856054150201348 join aggView2539393785908506898 using(v23);
create or replace view aggView8613794043810374428 as select v61, MIN(v77) as v77, MIN(v75) as v75, MIN(v73) as v73 from aggJoin5270920143218817016 group by v61;
create or replace view aggJoin5078468552690952957 as select v61, v8, v77, v75, v73 from semiDown7277955240472742530 join aggView8613794043810374428 using(v61);
create or replace view aggView4261335325199137486 as select v61, MIN(v76) as v76, MIN(v62) as v78 from aggJoin1042114186201764948 group by v61;
create or replace view aggJoin1604806568250550578 as select v8, v77 as v77, v75 as v75, v73 as v73, v76, v78 from aggJoin5078468552690952957 join aggView4261335325199137486 using(v61);
create or replace view aggView3258372571001940000 as select v8, MIN(v77) as v77, MIN(v75) as v75, MIN(v73) as v73, MIN(v76) as v76, MIN(v78) as v78 from aggJoin1604806568250550578 group by v8;
create or replace view aggJoin7690601341724923929 as select v9, v77, v75, v73, v76, v78 from semiUp6568305831042042132 join aggView3258372571001940000 using(v8);
create or replace view res as select MIN(v73) as v73, MIN(v9) as v74, MIN(v75) as v75, MIN(v76) as v76, MIN(v77) as v77, MIN(v78) as v78 from aggJoin7690601341724923929;
select sum(v73+v74+v75+v76+v77+v78) from res;
