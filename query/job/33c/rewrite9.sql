create or replace view aggView7415346351863303104 as select id as v1, name as v73 from company_name as cn1 where country_code<> '[us]';
create or replace view aggJoin7165255735423992389 as select movie_id as v49, v73 from movie_companies as mc1, aggView7415346351863303104 where mc1.company_id=aggView7415346351863303104.v1;
create or replace view aggView8673011185157729255 as select id as v8, name as v74 from company_name as cn2;
create or replace view aggJoin1823560459353074173 as select movie_id as v61, v74 from movie_companies as mc2, aggView8673011185157729255 where mc2.company_id=aggView8673011185157729255.v8;
create or replace view aggView116034539023320103 as select id as v21 from kind_type as kt2 where kind IN ('tv series','episode');
create or replace view aggJoin3213106636430127716 as select id as v61, title as v62 from title as t2, aggView116034539023320103 where t2.kind_id=aggView116034539023320103.v21 and production_year>=2000 and production_year<=2010;
create or replace view aggView5363767052797411145 as select id as v19 from kind_type as kt1 where kind IN ('tv series','episode');
create or replace view aggJoin92073582454806161 as select id as v49, title as v50 from title as t1, aggView5363767052797411145 where t1.kind_id=aggView5363767052797411145.v19;
create or replace view aggView1629853098510096499 as select v49, MIN(v73) as v73 from aggJoin7165255735423992389 group by v49;
create or replace view aggJoin713206440874401696 as select movie_id as v49, info_type_id as v15, info as v38, v73 from movie_info_idx as mi_idx1, aggView1629853098510096499 where mi_idx1.movie_id=aggView1629853098510096499.v49;
create or replace view aggView2171408511558151285 as select id as v17 from info_type as it2 where info= 'rating';
create or replace view aggJoin6508814236594302977 as select movie_id as v61, info as v43 from movie_info_idx as mi_idx2, aggView2171408511558151285 where mi_idx2.info_type_id=aggView2171408511558151285.v17 and info<'3.5';
create or replace view aggView2674378250465699910 as select v61, MIN(v43) as v76 from aggJoin6508814236594302977 group by v61;
create or replace view aggJoin307147842599399634 as select v61, v74 as v74, v76 from aggJoin1823560459353074173 join aggView2674378250465699910 using(v61);
create or replace view aggView8260019774106472432 as select v61, MIN(v74) as v74, MIN(v76) as v76 from aggJoin307147842599399634 group by v61;
create or replace view aggJoin5566157059335051447 as select v61, v62, v74, v76 from aggJoin3213106636430127716 join aggView8260019774106472432 using(v61);
create or replace view aggView6308029230401845825 as select v61, MIN(v74) as v74, MIN(v76) as v76, MIN(v62) as v78 from aggJoin5566157059335051447 group by v61;
create or replace view aggJoin3966478584410275012 as select movie_id as v49, link_type_id as v23, v74, v76, v78 from movie_link as ml, aggView6308029230401845825 where ml.linked_movie_id=aggView6308029230401845825.v61;
create or replace view aggView4154765848189373576 as select id as v23 from link_type as lt where link IN ('sequel','follows','followed by');
create or replace view aggJoin3160145644328425554 as select v49, v74, v76, v78 from aggJoin3966478584410275012 join aggView4154765848189373576 using(v23);
create or replace view aggView8996863982244393185 as select v49, MIN(v74) as v74, MIN(v76) as v76, MIN(v78) as v78 from aggJoin3160145644328425554 group by v49;
create or replace view aggJoin8777758815711989680 as select v49, v50, v74, v76, v78 from aggJoin92073582454806161 join aggView8996863982244393185 using(v49);
create or replace view aggView7584852244414237376 as select v49, MIN(v74) as v74, MIN(v76) as v76, MIN(v78) as v78, MIN(v50) as v77 from aggJoin8777758815711989680 group by v49;
create or replace view aggJoin5811617221104028450 as select v15, v38, v73 as v73, v74, v76, v78, v77 from aggJoin713206440874401696 join aggView7584852244414237376 using(v49);
create or replace view aggView421809935719936036 as select v15, MIN(v73) as v73, MIN(v74) as v74, MIN(v76) as v76, MIN(v78) as v78, MIN(v77) as v77, MIN(v38) as v75 from aggJoin5811617221104028450 group by v15;
create or replace view aggJoin2989885285598019068 as select v73, v74, v76, v78, v77, v75 from info_type as it1, aggView421809935719936036 where it1.id=aggView421809935719936036.v15 and info= 'rating';
create or replace view res as select MIN(v73) as v73, MIN(v74) as v74, MIN(v75) as v75, MIN(v76) as v76, MIN(v77) as v77, MIN(v78) as v78 from aggJoin2989885285598019068;
select sum(v73+v74+v75+v76+v77+v78) from res;