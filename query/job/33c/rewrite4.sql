create or replace view aggView6929031026015119441 as select id as v1, name as v73 from company_name as cn1 where country_code<> '[us]';
create or replace view aggJoin2904366236527019492 as select movie_id as v49, v73 from movie_companies as mc1, aggView6929031026015119441 where mc1.company_id=aggView6929031026015119441.v1;
create or replace view aggView8120970323767716698 as select id as v8, name as v74 from company_name as cn2;
create or replace view aggJoin632363171552819381 as select movie_id as v61, v74 from movie_companies as mc2, aggView8120970323767716698 where mc2.company_id=aggView8120970323767716698.v8;
create or replace view aggView5902333697652452867 as select id as v21 from kind_type as kt2 where kind IN ('tv series','episode');
create or replace view aggJoin8977448861088365451 as select id as v61, title as v62 from title as t2, aggView5902333697652452867 where t2.kind_id=aggView5902333697652452867.v21 and production_year>=2000 and production_year<=2010;
create or replace view aggView5792777254799736187 as select id as v19 from kind_type as kt1 where kind IN ('tv series','episode');
create or replace view aggJoin3694496534988086568 as select id as v49, title as v50 from title as t1, aggView5792777254799736187 where t1.kind_id=aggView5792777254799736187.v19;
create or replace view aggView4273841762667071539 as select v49, MIN(v50) as v77 from aggJoin3694496534988086568 group by v49;
create or replace view aggJoin6995097625897917120 as select movie_id as v49, info_type_id as v15, info as v38, v77 from movie_info_idx as mi_idx1, aggView4273841762667071539 where mi_idx1.movie_id=aggView4273841762667071539.v49;
create or replace view aggView8380592829359648891 as select id as v15 from info_type as it1 where info= 'rating';
create or replace view aggJoin5418697253801843341 as select v49, v38, v77 from aggJoin6995097625897917120 join aggView8380592829359648891 using(v15);
create or replace view aggView3582862402329033640 as select v49, MIN(v77) as v77, MIN(v38) as v75 from aggJoin5418697253801843341 group by v49;
create or replace view aggJoin6893511354104905280 as select v49, v73 as v73, v77, v75 from aggJoin2904366236527019492 join aggView3582862402329033640 using(v49);
create or replace view aggView6316323254568972527 as select v49, MIN(v73) as v73, MIN(v77) as v77, MIN(v75) as v75 from aggJoin6893511354104905280 group by v49;
create or replace view aggJoin2592465502383201881 as select linked_movie_id as v61, link_type_id as v23, v73, v77, v75 from movie_link as ml, aggView6316323254568972527 where ml.movie_id=aggView6316323254568972527.v49;
create or replace view aggView4885252366555813600 as select id as v17 from info_type as it2 where info= 'rating';
create or replace view aggJoin2373964017053732170 as select movie_id as v61, info as v43 from movie_info_idx as mi_idx2, aggView4885252366555813600 where mi_idx2.info_type_id=aggView4885252366555813600.v17 and info<'3.5';
create or replace view aggView5347972733870136150 as select v61, MIN(v43) as v76 from aggJoin2373964017053732170 group by v61;
create or replace view aggJoin2025210125998909996 as select v61, v62, v76 from aggJoin8977448861088365451 join aggView5347972733870136150 using(v61);
create or replace view aggView5376350418856103955 as select v61, MIN(v76) as v76, MIN(v62) as v78 from aggJoin2025210125998909996 group by v61;
create or replace view aggJoin2110063167879720597 as select v61, v74 as v74, v76, v78 from aggJoin632363171552819381 join aggView5376350418856103955 using(v61);
create or replace view aggView4319052774569018809 as select v61, MIN(v74) as v74, MIN(v76) as v76, MIN(v78) as v78 from aggJoin2110063167879720597 group by v61;
create or replace view aggJoin3450556313600228700 as select v23, v73 as v73, v77 as v77, v75 as v75, v74, v76, v78 from aggJoin2592465502383201881 join aggView4319052774569018809 using(v61);
create or replace view aggView916990937336891610 as select v23, MIN(v73) as v73, MIN(v77) as v77, MIN(v75) as v75, MIN(v74) as v74, MIN(v76) as v76, MIN(v78) as v78 from aggJoin3450556313600228700 group by v23;
create or replace view aggJoin6464756212566465119 as select v73, v77, v75, v74, v76, v78 from link_type as lt, aggView916990937336891610 where lt.id=aggView916990937336891610.v23 and link IN ('sequel','follows','followed by');
create or replace view res as select MIN(v73) as v73, MIN(v74) as v74, MIN(v75) as v75, MIN(v76) as v76, MIN(v77) as v77, MIN(v78) as v78 from aggJoin6464756212566465119;
select sum(v73+v74+v75+v76+v77+v78) from res;