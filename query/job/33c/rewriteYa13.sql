create or replace view semiUp9216425474112273458 as select movie_id as v49, info_type_id as v15, info as v38 from movie_info_idx AS mi_idx1 where (info_type_id) in (select id from info_type AS it1 where info= 'rating');
create or replace view semiUp5052964091767844660 as select id as v49, title as v50, kind_id as v19 from title AS t1 where (kind_id) in (select id from kind_type AS kt1 where kind IN ('tv series','episode'));
create or replace view semiUp7083496662308671655 as select movie_id as v49, company_id as v1 from movie_companies AS mc1 where (company_id) in (select id from company_name AS cn1 where country_code<> '[us]');
create or replace view semiUp9106775852834222784 as select v49, v1 from semiUp7083496662308671655 where (v49) in (select v49 from semiUp5052964091767844660);
create or replace view semiUp3261302627401332872 as select id as v61, title as v62, kind_id as v21 from title AS t2 where (kind_id) in (select id from kind_type AS kt2 where kind IN ('tv series','episode')) and production_year>=2000 and production_year<=2010;
create or replace view semiUp1955965198695382454 as select v49, v15, v38 from semiUp9216425474112273458 where (v49) in (select v49 from semiUp9106775852834222784);
create or replace view semiUp955503522937169753 as select movie_id as v49, linked_movie_id as v61, link_type_id as v23 from movie_link AS ml where (movie_id) in (select v49 from semiUp1955965198695382454);
create or replace view semiUp5770776276036406883 as select movie_id as v61, info_type_id as v17, info as v43 from movie_info_idx AS mi_idx2 where (info_type_id) in (select id from info_type AS it2 where info= 'rating') and info<'3.5';
create or replace view semiUp7671722002234643971 as select v49, v61, v23 from semiUp955503522937169753 where (v23) in (select id from link_type AS lt where link IN ('sequel','follows','followed by'));
create or replace view semiUp3936885735222217607 as select v61, v17, v43 from semiUp5770776276036406883 where (v61) in (select v61 from semiUp7671722002234643971);
create or replace view semiUp2768933851363055024 as select v61, v62, v21 from semiUp3261302627401332872 where (v61) in (select v61 from semiUp3936885735222217607);
create or replace view semiUp881790712662885138 as select movie_id as v61, company_id as v8 from movie_companies AS mc2 where (movie_id) in (select v61 from semiUp2768933851363055024);
create or replace view semiUp1410659068332421245 as select id as v8, name as v9 from company_name AS cn2 where (id) in (select v8 from semiUp881790712662885138);
create or replace view semiDown6540004667278790247 as select v61, v8 from semiUp881790712662885138 where (v8) in (select v8 from semiUp1410659068332421245);
create or replace view semiDown5778229626116710364 as select v61, v62, v21 from semiUp2768933851363055024 where (v61) in (select v61 from semiDown6540004667278790247);
create or replace view semiDown4826933141888357753 as select id as v21 from kind_type AS kt2 where (id) in (select v21 from semiDown5778229626116710364) and kind IN ('tv series','episode');
create or replace view semiDown321322784553046954 as select v61, v17, v43 from semiUp3936885735222217607 where (v61) in (select v61 from semiDown5778229626116710364);
create or replace view semiDown8349674969946556931 as select id as v17 from info_type AS it2 where (id) in (select v17 from semiDown321322784553046954) and info= 'rating';
create or replace view semiDown2887103680606314466 as select v49, v61, v23 from semiUp7671722002234643971 where (v61) in (select v61 from semiDown321322784553046954);
create or replace view semiDown5426781328062165716 as select id as v23 from link_type AS lt where (id) in (select v23 from semiDown2887103680606314466) and link IN ('sequel','follows','followed by');
create or replace view semiDown6144826571393619774 as select v49, v15, v38 from semiUp1955965198695382454 where (v49) in (select v49 from semiDown2887103680606314466);
create or replace view semiDown3946741110383182119 as select v49, v1 from semiUp9106775852834222784 where (v49) in (select v49 from semiDown6144826571393619774);
create or replace view semiDown1734416602607567591 as select id as v15 from info_type AS it1 where (id) in (select v15 from semiDown6144826571393619774) and info= 'rating';
create or replace view semiDown100367242037453346 as select id as v1, name as v2 from company_name AS cn1 where (id) in (select v1 from semiDown3946741110383182119) and country_code<> '[us]';
create or replace view semiDown1048063738757563759 as select v49, v50, v19 from semiUp5052964091767844660 where (v49) in (select v49 from semiDown3946741110383182119);
create or replace view semiDown5474949786955784543 as select id as v19 from kind_type AS kt1 where (id) in (select v19 from semiDown1048063738757563759) and kind IN ('tv series','episode');
create or replace view aggView6295039827655331480 as select v21 from semiDown4826933141888357753;
create or replace view aggJoin8543521618969258168 as select v61, v62 from semiDown5778229626116710364 join aggView6295039827655331480 using(v21);
create or replace view aggView978891808786377431 as select v23 from semiDown5426781328062165716;
create or replace view aggJoin8271599109951819695 as select v49, v61 from semiDown2887103680606314466 join aggView978891808786377431 using(v23);
create or replace view aggView1204501870150821910 as select v19 from semiDown5474949786955784543;
create or replace view aggJoin4765687830240424698 as select v49, v50 from semiDown1048063738757563759 join aggView1204501870150821910 using(v19);
create or replace view aggView5952060777598153362 as select v1, v2 as v73 from semiDown100367242037453346;
create or replace view aggJoin6314122391314024611 as select v49, v73 from semiDown3946741110383182119 join aggView5952060777598153362 using(v1);
create or replace view aggView7388638383461898686 as select v17 from semiDown8349674969946556931;
create or replace view aggJoin470249437511414762 as select v61, v43 from semiDown321322784553046954 join aggView7388638383461898686 using(v17);
create or replace view aggView8572865365269839088 as select v15 from semiDown1734416602607567591;
create or replace view aggJoin5052660831247226883 as select v49, v38 from semiDown6144826571393619774 join aggView8572865365269839088 using(v15);
create or replace view aggView6849272182289178117 as select v49, MIN(v50) as v77 from aggJoin4765687830240424698 group by v49;
create or replace view aggJoin5934030702380883405 as select v49, v73 as v73, v77 from aggJoin6314122391314024611 join aggView6849272182289178117 using(v49);
create or replace view aggView765787627700711719 as select v49, MIN(v73) as v73, MIN(v77) as v77 from aggJoin5934030702380883405 group by v49;
create or replace view aggJoin5369915070957610292 as select v49, v38, v73, v77 from aggJoin5052660831247226883 join aggView765787627700711719 using(v49);
create or replace view aggView7618571728019047342 as select v49, MIN(v73) as v73, MIN(v77) as v77, MIN(v38) as v75 from aggJoin5369915070957610292 group by v49;
create or replace view aggJoin852104300550590474 as select v61, v73, v77, v75 from aggJoin8271599109951819695 join aggView7618571728019047342 using(v49);
create or replace view aggView5277182455801541075 as select v61, MIN(v73) as v73, MIN(v77) as v77, MIN(v75) as v75 from aggJoin852104300550590474 group by v61;
create or replace view aggJoin2485941580325327821 as select v61, v43, v73, v77, v75 from aggJoin470249437511414762 join aggView5277182455801541075 using(v61);
create or replace view aggView2923355471995528234 as select v61, MIN(v73) as v73, MIN(v77) as v77, MIN(v75) as v75, MIN(v43) as v76 from aggJoin2485941580325327821 group by v61;
create or replace view aggJoin7592416167237927867 as select v61, v62, v73, v77, v75, v76 from aggJoin8543521618969258168 join aggView2923355471995528234 using(v61);
create or replace view aggView580604127389305662 as select v61, MIN(v73) as v73, MIN(v77) as v77, MIN(v75) as v75, MIN(v76) as v76, MIN(v62) as v78 from aggJoin7592416167237927867 group by v61;
create or replace view aggJoin3737109103564178715 as select v8, v73, v77, v75, v76, v78 from semiDown6540004667278790247 join aggView580604127389305662 using(v61);
create or replace view aggView8904740994536005298 as select v8, MIN(v73) as v73, MIN(v77) as v77, MIN(v75) as v75, MIN(v76) as v76, MIN(v78) as v78 from aggJoin3737109103564178715 group by v8;
create or replace view aggJoin7669300205988724715 as select v9, v73, v77, v75, v76, v78 from semiUp1410659068332421245 join aggView8904740994536005298 using(v8);
create or replace view res as select MIN(v73) as v73, MIN(v9) as v74, MIN(v75) as v75, MIN(v76) as v76, MIN(v77) as v77, MIN(v78) as v78 from aggJoin7669300205988724715;
select sum(v73+v74+v75+v76+v77+v78) from res;
