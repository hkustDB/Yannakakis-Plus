create or replace view semiUp8797754309815564948 as select movie_id as v49, company_id as v1 from movie_companies AS mc1 where (company_id) in (select id from company_name AS cn1 where country_code<> '[us]');
create or replace view semiUp3790941749295860536 as select id as v49, title as v50, kind_id as v19 from title AS t1 where (id) in (select v49 from semiUp8797754309815564948);
create or replace view semiUp1691705070139158534 as select movie_id as v49, info_type_id as v15, info as v38 from movie_info_idx AS mi_idx1 where (info_type_id) in (select id from info_type AS it1 where info= 'rating');
create or replace view semiUp1773274710559020182 as select id as v61, title as v62, kind_id as v21 from title AS t2 where (kind_id) in (select id from kind_type AS kt2 where kind IN ('tv series','episode')) and production_year>=2000 and production_year<=2010;
create or replace view semiUp6440753100399151453 as select movie_id as v61, info_type_id as v17, info as v43 from movie_info_idx AS mi_idx2 where (info_type_id) in (select id from info_type AS it2 where info= 'rating') and info<'3.5';
create or replace view semiUp5161858271560630380 as select movie_id as v49, linked_movie_id as v61, link_type_id as v23 from movie_link AS ml where (link_type_id) in (select id from link_type AS lt where link IN ('sequel','follows','followed by'));
create or replace view semiUp935950243623649127 as select movie_id as v61, company_id as v8 from movie_companies AS mc2 where (company_id) in (select id from company_name AS cn2);
create or replace view semiUp4733012763388301349 as select v61, v62, v21 from semiUp1773274710559020182 where (v61) in (select v61 from semiUp6440753100399151453);
create or replace view semiUp1773316226086132612 as select v61, v8 from semiUp935950243623649127 where (v61) in (select v61 from semiUp4733012763388301349);
create or replace view semiUp8549933201561286327 as select v49, v61, v23 from semiUp5161858271560630380 where (v61) in (select v61 from semiUp1773316226086132612);
create or replace view semiUp3288512344105274262 as select v49, v15, v38 from semiUp1691705070139158534 where (v49) in (select v49 from semiUp8549933201561286327);
create or replace view semiUp4105582895024829602 as select v49, v50, v19 from semiUp3790941749295860536 where (v49) in (select v49 from semiUp3288512344105274262);
create or replace view semiUp2017297853656007174 as select id as v19 from kind_type AS kt1 where (id) in (select v19 from semiUp4105582895024829602) and kind IN ('tv series','episode');
create or replace view semiDown7020500758190340035 as select v49, v50, v19 from semiUp4105582895024829602 where (v19) in (select v19 from semiUp2017297853656007174);
create or replace view semiDown1892034887048354396 as select v49, v15, v38 from semiUp3288512344105274262 where (v49) in (select v49 from semiDown7020500758190340035);
create or replace view semiDown2657797415395427554 as select v49, v1 from semiUp8797754309815564948 where (v49) in (select v49 from semiDown7020500758190340035);
create or replace view semiDown341861888390142090 as select v49, v61, v23 from semiUp8549933201561286327 where (v49) in (select v49 from semiDown1892034887048354396);
create or replace view semiDown1818674300626902029 as select id as v15 from info_type AS it1 where (id) in (select v15 from semiDown1892034887048354396) and info= 'rating';
create or replace view semiDown5085923252214507081 as select id as v1, name as v2 from company_name AS cn1 where (id) in (select v1 from semiDown2657797415395427554) and country_code<> '[us]';
create or replace view semiDown4283363023195358942 as select id as v23 from link_type AS lt where (id) in (select v23 from semiDown341861888390142090) and link IN ('sequel','follows','followed by');
create or replace view semiDown3732989454389990233 as select v61, v8 from semiUp1773316226086132612 where (v61) in (select v61 from semiDown341861888390142090);
create or replace view semiDown6279809124399715665 as select v61, v62, v21 from semiUp4733012763388301349 where (v61) in (select v61 from semiDown3732989454389990233);
create or replace view semiDown3066556431138892397 as select id as v8, name as v9 from company_name AS cn2 where (id) in (select v8 from semiDown3732989454389990233);
create or replace view semiDown765006774748437991 as select id as v21 from kind_type AS kt2 where (id) in (select v21 from semiDown6279809124399715665) and kind IN ('tv series','episode');
create or replace view semiDown5501420184187325143 as select v61, v17, v43 from semiUp6440753100399151453 where (v61) in (select v61 from semiDown6279809124399715665);
create or replace view semiDown2678546411571752742 as select id as v17 from info_type AS it2 where (id) in (select v17 from semiDown5501420184187325143) and info= 'rating';
create or replace view aggView2748855526000978633 as select v1, v2 as v73 from semiDown5085923252214507081;
create or replace view aggJoin2632828366327348515 as select v49, v73 from semiDown2657797415395427554 join aggView2748855526000978633 using(v1);
create or replace view aggView5327097571335197876 as select v8, v9 as v74 from semiDown3066556431138892397;
create or replace view aggJoin2586968043111863049 as select v61, v74 from semiDown3732989454389990233 join aggView5327097571335197876 using(v8);
create or replace view aggView2626036210833735704 as select v21 from semiDown765006774748437991;
create or replace view aggJoin4903975863162613961 as select v61, v62 from semiDown6279809124399715665 join aggView2626036210833735704 using(v21);
create or replace view aggView4401215356818659979 as select v15 from semiDown1818674300626902029;
create or replace view aggJoin3784315207096503742 as select v49, v38 from semiDown1892034887048354396 join aggView4401215356818659979 using(v15);
create or replace view aggView7459423545388590787 as select v17 from semiDown2678546411571752742;
create or replace view aggJoin448775874678293833 as select v61, v43 from semiDown5501420184187325143 join aggView7459423545388590787 using(v17);
create or replace view aggView8957799782747071735 as select v23 from semiDown4283363023195358942;
create or replace view aggJoin2107480329667016585 as select v49, v61 from semiDown341861888390142090 join aggView8957799782747071735 using(v23);
create or replace view aggView3129277601618556108 as select v49, MIN(v73) as v73 from aggJoin2632828366327348515 group by v49;
create or replace view aggJoin5564349473632589168 as select v49, v50, v19, v73 from semiDown7020500758190340035 join aggView3129277601618556108 using(v49);
create or replace view aggView5085982614870471683 as select v61, MIN(v43) as v76 from aggJoin448775874678293833 group by v61;
create or replace view aggJoin2085708106752067582 as select v61, v62, v76 from aggJoin4903975863162613961 join aggView5085982614870471683 using(v61);
create or replace view aggView4826252385258600146 as select v61, MIN(v76) as v76, MIN(v62) as v78 from aggJoin2085708106752067582 group by v61;
create or replace view aggJoin5300246473098818462 as select v61, v74 as v74, v76, v78 from aggJoin2586968043111863049 join aggView4826252385258600146 using(v61);
create or replace view aggView4212127145285287100 as select v61, MIN(v74) as v74, MIN(v76) as v76, MIN(v78) as v78 from aggJoin5300246473098818462 group by v61;
create or replace view aggJoin986423359156990893 as select v49, v74, v76, v78 from aggJoin2107480329667016585 join aggView4212127145285287100 using(v61);
create or replace view aggView1645115600569286068 as select v49, MIN(v74) as v74, MIN(v76) as v76, MIN(v78) as v78 from aggJoin986423359156990893 group by v49;
create or replace view aggJoin194753216763151488 as select v49, v38, v74, v76, v78 from aggJoin3784315207096503742 join aggView1645115600569286068 using(v49);
create or replace view aggView5426449657420186035 as select v49, MIN(v74) as v74, MIN(v76) as v76, MIN(v78) as v78, MIN(v38) as v75 from aggJoin194753216763151488 group by v49;
create or replace view aggJoin2343251493952715357 as select v50, v19, v73 as v73, v74, v76, v78, v75 from aggJoin5564349473632589168 join aggView5426449657420186035 using(v49);
create or replace view aggView5807722464203081903 as select v19, MIN(v73) as v73, MIN(v74) as v74, MIN(v76) as v76, MIN(v78) as v78, MIN(v75) as v75, MIN(v50) as v77 from aggJoin2343251493952715357 group by v19;
create or replace view aggJoin4552365567924521926 as select v73, v74, v76, v78, v75, v77 from semiUp2017297853656007174 join aggView5807722464203081903 using(v19);
create or replace view res as select MIN(v73) as v73, MIN(v74) as v74, MIN(v75) as v75, MIN(v76) as v76, MIN(v77) as v77, MIN(v78) as v78 from aggJoin4552365567924521926;
select sum(v73+v74+v75+v76+v77+v78) from res;
