create or replace view aggView7724892773305137397 as select id as v1, name as v73 from company_name as cn1 where country_code<> '[us]';
create or replace view aggJoin6206135361866298567 as select movie_id as v49, v73 from movie_companies as mc1, aggView7724892773305137397 where mc1.company_id=aggView7724892773305137397.v1;
create or replace view aggView6811031407090952428 as select id as v8, name as v74 from company_name as cn2;
create or replace view aggJoin619567288923250852 as select movie_id as v61, v74 from movie_companies as mc2, aggView6811031407090952428 where mc2.company_id=aggView6811031407090952428.v8;
create or replace view aggView376425990978931244 as select id as v21 from kind_type as kt2 where kind IN ('tv series','episode');
create or replace view aggJoin1705269553591323224 as select id as v61, title as v62 from title as t2, aggView376425990978931244 where t2.kind_id=aggView376425990978931244.v21 and production_year>=2000 and production_year<=2010;
create or replace view aggView8968860155729887085 as select v61, MIN(v62) as v78 from aggJoin1705269553591323224 group by v61;
create or replace view aggJoin5578677683105578209 as select movie_id as v61, info_type_id as v17, info as v43, v78 from movie_info_idx as mi_idx2, aggView8968860155729887085 where mi_idx2.movie_id=aggView8968860155729887085.v61 and info<'3.5';
create or replace view aggView6419392536462212300 as select v49, MIN(v73) as v73 from aggJoin6206135361866298567 group by v49;
create or replace view aggJoin2428953269355166762 as select id as v49, title as v50, kind_id as v19, v73 from title as t1, aggView6419392536462212300 where t1.id=aggView6419392536462212300.v49;
create or replace view aggView4704212177423034631 as select id as v15 from info_type as it1 where info= 'rating';
create or replace view aggJoin2215456049218887651 as select movie_id as v49, info as v38 from movie_info_idx as mi_idx1, aggView4704212177423034631 where mi_idx1.info_type_id=aggView4704212177423034631.v15;
create or replace view aggView7486171646233725503 as select id as v17 from info_type as it2 where info= 'rating';
create or replace view aggJoin4293368144177006823 as select v61, v43, v78 from aggJoin5578677683105578209 join aggView7486171646233725503 using(v17);
create or replace view aggView7029924769133412553 as select v61, MIN(v78) as v78, MIN(v43) as v76 from aggJoin4293368144177006823 group by v61;
create or replace view aggJoin3617727837204188090 as select v61, v74 as v74, v78, v76 from aggJoin619567288923250852 join aggView7029924769133412553 using(v61);
create or replace view aggView2697343849357794698 as select v61, MIN(v74) as v74, MIN(v78) as v78, MIN(v76) as v76 from aggJoin3617727837204188090 group by v61;
create or replace view aggJoin1297988466523352572 as select movie_id as v49, link_type_id as v23, v74, v78, v76 from movie_link as ml, aggView2697343849357794698 where ml.linked_movie_id=aggView2697343849357794698.v61;
create or replace view aggView4148460575935420827 as select id as v23 from link_type as lt where link IN ('sequel','follows','followed by');
create or replace view aggJoin6267103205257791283 as select v49, v74, v78, v76 from aggJoin1297988466523352572 join aggView4148460575935420827 using(v23);
create or replace view aggView6359733255774523018 as select v49, MIN(v74) as v74, MIN(v78) as v78, MIN(v76) as v76 from aggJoin6267103205257791283 group by v49;
create or replace view aggJoin2381620610314714015 as select v49, v38, v74, v78, v76 from aggJoin2215456049218887651 join aggView6359733255774523018 using(v49);
create or replace view aggView2379405166992286634 as select v49, MIN(v74) as v74, MIN(v78) as v78, MIN(v76) as v76, MIN(v38) as v75 from aggJoin2381620610314714015 group by v49;
create or replace view aggJoin6505970090265427864 as select v50, v19, v73 as v73, v74, v78, v76, v75 from aggJoin2428953269355166762 join aggView2379405166992286634 using(v49);
create or replace view aggView1164861623314446938 as select v19, MIN(v73) as v73, MIN(v74) as v74, MIN(v78) as v78, MIN(v76) as v76, MIN(v75) as v75, MIN(v50) as v77 from aggJoin6505970090265427864 group by v19;
create or replace view aggJoin3640178671969008165 as select v73, v74, v78, v76, v75, v77 from kind_type as kt1, aggView1164861623314446938 where kt1.id=aggView1164861623314446938.v19 and kind IN ('tv series','episode');
create or replace view res as select MIN(v73) as v73, MIN(v74) as v74, MIN(v75) as v75, MIN(v76) as v76, MIN(v77) as v77, MIN(v78) as v78 from aggJoin3640178671969008165;
select sum(v73+v74+v75+v76+v77+v78) from res;