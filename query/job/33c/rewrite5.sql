create or replace view aggView1839148046926330422 as select id as v1, name as v73 from company_name as cn1 where country_code<> '[us]';
create or replace view aggJoin6335682238973062227 as select movie_id as v49, v73 from movie_companies as mc1, aggView1839148046926330422 where mc1.company_id=aggView1839148046926330422.v1;
create or replace view aggView3445401754592714763 as select id as v8, name as v74 from company_name as cn2;
create or replace view aggJoin7859922965401378165 as select movie_id as v61, v74 from movie_companies as mc2, aggView3445401754592714763 where mc2.company_id=aggView3445401754592714763.v8;
create or replace view aggView5831409246254171396 as select id as v19 from kind_type as kt1 where kind IN ('tv series','episode');
create or replace view aggJoin8251247853423168094 as select id as v49, title as v50 from title as t1, aggView5831409246254171396 where t1.kind_id=aggView5831409246254171396.v19;
create or replace view aggView2251115670254762104 as select id as v15 from info_type as it1 where info= 'rating';
create or replace view aggJoin8229619246854517312 as select movie_id as v49, info as v38 from movie_info_idx as mi_idx1, aggView2251115670254762104 where mi_idx1.info_type_id=aggView2251115670254762104.v15;
create or replace view aggView2167984547803546169 as select v49, MIN(v38) as v75 from aggJoin8229619246854517312 group by v49;
create or replace view aggJoin1298012684004110525 as select v49, v73 as v73, v75 from aggJoin6335682238973062227 join aggView2167984547803546169 using(v49);
create or replace view aggView3423916917915023058 as select v49, MIN(v73) as v73, MIN(v75) as v75 from aggJoin1298012684004110525 group by v49;
create or replace view aggJoin5295566841962556923 as select v49, v50, v73, v75 from aggJoin8251247853423168094 join aggView3423916917915023058 using(v49);
create or replace view aggView8235697533849724473 as select v49, MIN(v73) as v73, MIN(v75) as v75, MIN(v50) as v77 from aggJoin5295566841962556923 group by v49;
create or replace view aggJoin1689036051638540886 as select linked_movie_id as v61, link_type_id as v23, v73, v75, v77 from movie_link as ml, aggView8235697533849724473 where ml.movie_id=aggView8235697533849724473.v49;
create or replace view aggView7155034332559041898 as select id as v17 from info_type as it2 where info= 'rating';
create or replace view aggJoin6488277057412508265 as select movie_id as v61, info as v43 from movie_info_idx as mi_idx2, aggView7155034332559041898 where mi_idx2.info_type_id=aggView7155034332559041898.v17 and info<'3.5';
create or replace view aggView3286990990510259983 as select v61, MIN(v43) as v76 from aggJoin6488277057412508265 group by v61;
create or replace view aggJoin3987482953436444685 as select id as v61, title as v62, kind_id as v21, v76 from title as t2, aggView3286990990510259983 where t2.id=aggView3286990990510259983.v61 and production_year>=2000 and production_year<=2010;
create or replace view aggView8215698544813243096 as select id as v23 from link_type as lt where link IN ('sequel','follows','followed by');
create or replace view aggJoin1148642968428451605 as select v61, v73, v75, v77 from aggJoin1689036051638540886 join aggView8215698544813243096 using(v23);
create or replace view aggView7593946584735142717 as select v61, MIN(v73) as v73, MIN(v75) as v75, MIN(v77) as v77 from aggJoin1148642968428451605 group by v61;
create or replace view aggJoin6101593027129772827 as select v61, v74 as v74, v73, v75, v77 from aggJoin7859922965401378165 join aggView7593946584735142717 using(v61);
create or replace view aggView2591777204955281537 as select v61, MIN(v74) as v74, MIN(v73) as v73, MIN(v75) as v75, MIN(v77) as v77 from aggJoin6101593027129772827 group by v61;
create or replace view aggJoin7122690232628519797 as select v62, v21, v76 as v76, v74, v73, v75, v77 from aggJoin3987482953436444685 join aggView2591777204955281537 using(v61);
create or replace view aggView3905601331644062986 as select v21, MIN(v76) as v76, MIN(v74) as v74, MIN(v73) as v73, MIN(v75) as v75, MIN(v77) as v77, MIN(v62) as v78 from aggJoin7122690232628519797 group by v21;
create or replace view aggJoin2119897124474039953 as select v76, v74, v73, v75, v77, v78 from kind_type as kt2, aggView3905601331644062986 where kt2.id=aggView3905601331644062986.v21 and kind IN ('tv series','episode');
create or replace view res as select MIN(v73) as v73, MIN(v74) as v74, MIN(v75) as v75, MIN(v76) as v76, MIN(v77) as v77, MIN(v78) as v78 from aggJoin2119897124474039953;
select sum(v73+v74+v75+v76+v77+v78) from res;