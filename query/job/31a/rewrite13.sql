create or replace view aggView6103474156887146523 as select id as v40, name as v63 from name as n where gender= 'm';
create or replace view aggJoin6095257401656405977 as select movie_id as v49, note as v5, v63 from cast_info as ci, aggView6103474156887146523 where ci.person_id=aggView6103474156887146523.v40 and note IN ('(writer)','(head writer)','(written by)','(story)','(story editor)');
create or replace view aggView5638939833496803031 as select id as v49, title as v64 from title as t;
create or replace view aggJoin2004851479385113315 as select movie_id as v49, company_id as v8, v64 from movie_companies as mc, aggView5638939833496803031 where mc.movie_id=aggView5638939833496803031.v49;
create or replace view aggView8172336039549073864 as select id as v19 from keyword as k where keyword IN ('murder','violence','blood','gore','death','female-nudity','hospital');
create or replace view aggJoin4885014587456824285 as select movie_id as v49 from movie_keyword as mk, aggView8172336039549073864 where mk.keyword_id=aggView8172336039549073864.v19;
create or replace view aggView1373457469646609126 as select id as v17 from info_type as it2 where info= 'votes';
create or replace view aggJoin7038346616302357478 as select movie_id as v49, info as v35 from movie_info_idx as mi_idx, aggView1373457469646609126 where mi_idx.info_type_id=aggView1373457469646609126.v17;
create or replace view aggView5475470972698641452 as select id as v8 from company_name as cn where name LIKE 'Lionsgate%';
create or replace view aggJoin4849365472309857191 as select v49, v64 from aggJoin2004851479385113315 join aggView5475470972698641452 using(v8);
create or replace view aggView7995590964851354724 as select v49, MIN(v64) as v64 from aggJoin4849365472309857191 group by v49;
create or replace view aggJoin5331468715884287287 as select v49, v35, v64 from aggJoin7038346616302357478 join aggView7995590964851354724 using(v49);
create or replace view aggView6248786417487667071 as select v49, MIN(v64) as v64, MIN(v35) as v62 from aggJoin5331468715884287287 group by v49;
create or replace view aggJoin7709914229593838936 as select movie_id as v49, info_type_id as v15, info as v30, v64, v62 from movie_info as mi, aggView6248786417487667071 where mi.movie_id=aggView6248786417487667071.v49 and info IN ('Horror','Thriller');
create or replace view aggView5902460414999416886 as select v49 from aggJoin4885014587456824285 group by v49;
create or replace view aggJoin7748256872457327826 as select v49, v5, v63 as v63 from aggJoin6095257401656405977 join aggView5902460414999416886 using(v49);
create or replace view aggView581659274423601238 as select v49, MIN(v63) as v63 from aggJoin7748256872457327826 group by v49;
create or replace view aggJoin2625423557577543311 as select v15, v30, v64 as v64, v62 as v62, v63 from aggJoin7709914229593838936 join aggView581659274423601238 using(v49);
create or replace view aggView6219604378483097154 as select v15, MIN(v64) as v64, MIN(v62) as v62, MIN(v63) as v63, MIN(v30) as v61 from aggJoin2625423557577543311 group by v15;
create or replace view aggJoin4566992778310898910 as select info as v16, v64, v62, v63, v61 from info_type as it1, aggView6219604378483097154 where it1.id=aggView6219604378483097154.v15 and info= 'genres';
create or replace view res as select MIN(v61) as v61, MIN(v62) as v62, MIN(v63) as v63, MIN(v64) as v64 from aggJoin4566992778310898910;
select sum(v61+v62+v63+v64) from res;