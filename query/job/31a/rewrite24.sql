create or replace view aggView7919256468160247603 as select id as v17 from info_type as it2 where info= 'votes';
create or replace view aggJoin6247330038499836885 as select movie_id as v49, info as v35 from movie_info_idx as mi_idx, aggView7919256468160247603 where mi_idx.info_type_id=aggView7919256468160247603.v17;
create or replace view aggView3153368938932576382 as select v49, MIN(v35) as v62 from aggJoin6247330038499836885 group by v49;
create or replace view aggJoin933758786935038701 as select movie_id as v49, keyword_id as v19, v62 from movie_keyword as mk, aggView3153368938932576382 where mk.movie_id=aggView3153368938932576382.v49;
create or replace view aggView8171411238704983852 as select id as v19 from keyword as k where keyword IN ('murder','violence','blood','gore','death','female-nudity','hospital');
create or replace view aggJoin7461249065501651242 as select v49, v62 from aggJoin933758786935038701 join aggView8171411238704983852 using(v19);
create or replace view aggView3337372706269198691 as select id as v8 from company_name as cn where name LIKE 'Lionsgate%';
create or replace view aggJoin4091122134490997276 as select movie_id as v49 from movie_companies as mc, aggView3337372706269198691 where mc.company_id=aggView3337372706269198691.v8;
create or replace view aggView8596800105139367025 as select id as v15 from info_type as it1 where info= 'genres';
create or replace view aggJoin1627804833169527717 as select movie_id as v49, info as v30 from movie_info as mi, aggView8596800105139367025 where mi.info_type_id=aggView8596800105139367025.v15 and info IN ('Horror','Thriller');
create or replace view aggView4737230289912517560 as select v49, MIN(v30) as v61 from aggJoin1627804833169527717 group by v49;
create or replace view aggJoin8284739384477050699 as select id as v49, title as v50, v61 from title as t, aggView4737230289912517560 where t.id=aggView4737230289912517560.v49;
create or replace view aggView2929537326278174866 as select v49, MIN(v62) as v62 from aggJoin7461249065501651242 group by v49;
create or replace view aggJoin7823321312305816753 as select person_id as v40, movie_id as v49, note as v5, v62 from cast_info as ci, aggView2929537326278174866 where ci.movie_id=aggView2929537326278174866.v49 and note IN ('(writer)','(head writer)','(written by)','(story)','(story editor)');
create or replace view aggView7336640129231700566 as select v49 from aggJoin4091122134490997276 group by v49;
create or replace view aggJoin4175693044470636284 as select v49, v50, v61 as v61 from aggJoin8284739384477050699 join aggView7336640129231700566 using(v49);
create or replace view aggView3193128581585143785 as select v49, MIN(v61) as v61, MIN(v50) as v64 from aggJoin4175693044470636284 group by v49;
create or replace view aggJoin94578777896413111 as select v40, v5, v62 as v62, v61, v64 from aggJoin7823321312305816753 join aggView3193128581585143785 using(v49);
create or replace view aggView8818613763823092346 as select v40, MIN(v62) as v62, MIN(v61) as v61, MIN(v64) as v64 from aggJoin94578777896413111 group by v40;
create or replace view aggJoin4226060040625678300 as select name as v41, gender as v44, v62, v61, v64 from name as n, aggView8818613763823092346 where n.id=aggView8818613763823092346.v40 and gender= 'm';
create or replace view res as select MIN(v61) as v61, MIN(v62) as v62, MIN(v41) as v63, MIN(v64) as v64 from aggJoin4226060040625678300;
select sum(v61+v62+v63+v64) from res;