create or replace view aggView6347170666018038152 as select id as v40, name as v63 from name as n where gender= 'm';
create or replace view aggJoin90640772292406459 as select movie_id as v49, note as v5, v63 from cast_info as ci, aggView6347170666018038152 where ci.person_id=aggView6347170666018038152.v40 and note IN ('(writer)','(head writer)','(written by)','(story)','(story editor)');
create or replace view aggView2937431280707113691 as select id as v19 from keyword as k where keyword IN ('murder','violence','blood','gore','death','female-nudity','hospital');
create or replace view aggJoin9031181333003367027 as select movie_id as v49 from movie_keyword as mk, aggView2937431280707113691 where mk.keyword_id=aggView2937431280707113691.v19;
create or replace view aggView6408077174234584330 as select id as v17 from info_type as it2 where info= 'votes';
create or replace view aggJoin9055173807099973890 as select movie_id as v49, info as v35 from movie_info_idx as mi_idx, aggView6408077174234584330 where mi_idx.info_type_id=aggView6408077174234584330.v17;
create or replace view aggView1510242801110133304 as select v49 from aggJoin9031181333003367027 group by v49;
create or replace view aggJoin1208157030227549844 as select id as v49, title as v50 from title as t, aggView1510242801110133304 where t.id=aggView1510242801110133304.v49;
create or replace view aggView7519981598181160260 as select v49, MIN(v50) as v64 from aggJoin1208157030227549844 group by v49;
create or replace view aggJoin3261570047033119078 as select v49, v35, v64 from aggJoin9055173807099973890 join aggView7519981598181160260 using(v49);
create or replace view aggView5843457254538981218 as select v49, MIN(v64) as v64, MIN(v35) as v62 from aggJoin3261570047033119078 group by v49;
create or replace view aggJoin7393431243562028100 as select v49, v5, v63 as v63, v64, v62 from aggJoin90640772292406459 join aggView5843457254538981218 using(v49);
create or replace view aggView2770103862112096246 as select v49, MIN(v63) as v63, MIN(v64) as v64, MIN(v62) as v62 from aggJoin7393431243562028100 group by v49;
create or replace view aggJoin6167018693241731584 as select movie_id as v49, company_id as v8, v63, v64, v62 from movie_companies as mc, aggView2770103862112096246 where mc.movie_id=aggView2770103862112096246.v49;
create or replace view aggView2026485848811525246 as select id as v8 from company_name as cn where name LIKE 'Lionsgate%';
create or replace view aggJoin8181009404646315789 as select v49, v63, v64, v62 from aggJoin6167018693241731584 join aggView2026485848811525246 using(v8);
create or replace view aggView8719175779879926337 as select v49, MIN(v63) as v63, MIN(v64) as v64, MIN(v62) as v62 from aggJoin8181009404646315789 group by v49;
create or replace view aggJoin8958116933192850752 as select info_type_id as v15, info as v30, v63, v64, v62 from movie_info as mi, aggView8719175779879926337 where mi.movie_id=aggView8719175779879926337.v49 and info IN ('Horror','Thriller');
create or replace view aggView2736084306601321839 as select v15, MIN(v63) as v63, MIN(v64) as v64, MIN(v62) as v62, MIN(v30) as v61 from aggJoin8958116933192850752 group by v15;
create or replace view aggJoin1771716613446466002 as select info as v16, v63, v64, v62, v61 from info_type as it1, aggView2736084306601321839 where it1.id=aggView2736084306601321839.v15 and info= 'genres';
create or replace view res as select MIN(v61) as v61, MIN(v62) as v62, MIN(v63) as v63, MIN(v64) as v64 from aggJoin1771716613446466002;
select sum(v61+v62+v63+v64) from res;