create or replace view semiUp8132619671032040790 as select movie_id as v24, company_id as v17, company_type_id as v18, note as v19 from movie_companies AS mc where (company_type_id) in (select (id) from company_type AS ct where kind<> 'production companies');
create or replace view semiUp5619678912249200929 as select v24, v17, v18, v19 from semiUp8132619671032040790 where (v17) in (select (id) from company_name AS cn where country_code<> '[pl]');
create or replace view semiUp6405692091027101790 as select movie_id as v24, keyword_id as v22 from movie_keyword AS mk where (keyword_id) in (select (id) from keyword AS k where keyword IN ('sequel','revenge','based-on-novel'));
create or replace view semiUp2509056357169589628 as select v24, v22 from semiUp6405692091027101790 where (v24) in (select (v24) from semiUp5619678912249200929);
create or replace view semiUp3958257659888257193 as select movie_id as v24, link_type_id as v13 from movie_link AS ml where (link_type_id) in (select (id) from link_type AS lt);
create or replace view semiUp1950599645387028284 as select id as v24, title as v28 from title AS t where (id) in (select (v24) from semiUp2509056357169589628) and production_year>1950;
create or replace view semiUp6670156742432817971 as select v24, v28 from semiUp1950599645387028284 where (v24) in (select (v24) from semiUp3958257659888257193);
create or replace view semiDown3909020186580311143 as select v24, v22 from semiUp2509056357169589628 where (v24) in (select (v24) from semiUp6670156742432817971);
create or replace view semiDown160157788290599569 as select v24, v13 from semiUp3958257659888257193 where (v24) in (select (v24) from semiUp6670156742432817971);
create or replace view semiDown5883440127112608376 as select id as v22 from keyword AS k where (id) in (select (v22) from semiDown3909020186580311143) and keyword IN ('sequel','revenge','based-on-novel');
create or replace view semiDown8559523663985484330 as select v24, v17, v18, v19 from semiUp5619678912249200929 where (v24) in (select (v24) from semiDown3909020186580311143);
create or replace view semiDown2027367904992585038 as select id as v13 from link_type AS lt where (id) in (select (v13) from semiDown160157788290599569);
create or replace view semiDown7135606879332672697 as select id as v18 from company_type AS ct where (id) in (select (v18) from semiDown8559523663985484330) and kind<> 'production companies';
create or replace view semiDown3589064547256136380 as select id as v17, name as v2 from company_name AS cn where (id) in (select (v17) from semiDown8559523663985484330) and country_code<> '[pl]';
create or replace view aggView2495715549404325560 as select v13 from semiDown2027367904992585038;
create or replace view aggJoin6511298943621993445 as select v24 from semiDown160157788290599569 join aggView2495715549404325560 using(v13);
create or replace view aggView5605263364427425942 as select v24 from aggJoin6511298943621993445 group by v24;
create or replace view aggJoin1760210022122014293 as select v24, v28 from semiUp6670156742432817971 join aggView5605263364427425942 using(v24);
create or replace view aggView1376531951486155723 as select v18 from semiDown7135606879332672697;
create or replace view aggJoin741219283541191989 as select v24, v17, v19 from semiDown8559523663985484330 join aggView1376531951486155723 using(v18);
create or replace view aggView1100428809997113325 as select v22 from semiDown5883440127112608376;
create or replace view aggJoin662759853001099154 as select v24 from semiDown3909020186580311143 join aggView1100428809997113325 using(v22);
create or replace view aggView2186174214653354314 as select v17, v2 as v39 from semiDown3589064547256136380;
create or replace view aggJoin8866300959610316702 as select v24, v19, v39 from aggJoin741219283541191989 join aggView2186174214653354314 using(v17);
create or replace view aggView4966515662001414610 as select v24, MIN(v39) as v39, MIN(v19) as v40 from aggJoin8866300959610316702 group by v24;
create or replace view aggJoin8591159394738311823 as select v24, v39, v40 from aggJoin662759853001099154 join aggView4966515662001414610 using(v24);
create or replace view aggView5289328078765583465 as select v24, MIN(v39) as v39, MIN(v40) as v40 from aggJoin8591159394738311823 group by v24;
create or replace view aggJoin8080461135643116928 as select v28, v39, v40 from aggJoin1760210022122014293 join aggView5289328078765583465 using(v24);
select MIN(v39) as v39,MIN(v40) as v40,MIN(v28) as v41 from aggJoin8080461135643116928;
