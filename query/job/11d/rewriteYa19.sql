create or replace view semiUp5890499776700717326 as select movie_id as v24, company_id as v17, company_type_id as v18, note as v19 from movie_companies AS mc where (company_id) in (select id from company_name AS cn where country_code<> '[pl]');
create or replace view semiUp6728386589724160742 as select movie_id as v24, keyword_id as v22 from movie_keyword AS mk where (keyword_id) in (select id from keyword AS k where keyword IN ('sequel','revenge','based-on-novel'));
create or replace view semiUp1848884287906635309 as select v24, v17, v18, v19 from semiUp5890499776700717326 where (v18) in (select id from company_type AS ct where kind<> 'production companies');
create or replace view semiUp3856839187922147890 as select id as v24, title as v28 from title AS t where (id) in (select v24 from semiUp1848884287906635309) and production_year>1950;
create or replace view semiUp3470227095887688875 as select movie_id as v24, link_type_id as v13 from movie_link AS ml where (link_type_id) in (select id from link_type AS lt);
create or replace view semiUp2230168589357509315 as select v24, v13 from semiUp3470227095887688875 where (v24) in (select v24 from semiUp6728386589724160742);
create or replace view semiUp5436325741540601536 as select v24, v28 from semiUp3856839187922147890 where (v24) in (select v24 from semiUp2230168589357509315);
create or replace view semiDown2587930879689746926 as select v24, v17, v18, v19 from semiUp1848884287906635309 where (v24) in (select v24 from semiUp5436325741540601536);
create or replace view semiDown3175081517999946854 as select v24, v13 from semiUp2230168589357509315 where (v24) in (select v24 from semiUp5436325741540601536);
create or replace view semiDown1823539310471937517 as select id as v17, name as v2 from company_name AS cn where (id) in (select v17 from semiDown2587930879689746926) and country_code<> '[pl]';
create or replace view semiDown8771204991570391775 as select id as v18 from company_type AS ct where (id) in (select v18 from semiDown2587930879689746926) and kind<> 'production companies';
create or replace view semiDown6268736028270234612 as select v24, v22 from semiUp6728386589724160742 where (v24) in (select v24 from semiDown3175081517999946854);
create or replace view semiDown427896303149727624 as select id as v13 from link_type AS lt where (id) in (select v13 from semiDown3175081517999946854);
create or replace view semiDown3238239051434154782 as select id as v22 from keyword AS k where (id) in (select v22 from semiDown6268736028270234612) and keyword IN ('sequel','revenge','based-on-novel');
create or replace view aggView4133742657815112686 as select v17, v2 as v39 from semiDown1823539310471937517;
create or replace view aggJoin94322926922614079 as select v24, v18, v19, v39 from semiDown2587930879689746926 join aggView4133742657815112686 using(v17);
create or replace view aggView7320791614889179209 as select v22 from semiDown3238239051434154782;
create or replace view aggJoin8838205322412779220 as select v24 from semiDown6268736028270234612 join aggView7320791614889179209 using(v22);
create or replace view aggView8790200175164857917 as select v24 from aggJoin8838205322412779220 group by v24;
create or replace view aggJoin4717131834846943189 as select v24, v13 from semiDown3175081517999946854 join aggView8790200175164857917 using(v24);
create or replace view aggView5812747506806704143 as select v18 from semiDown8771204991570391775;
create or replace view aggJoin8408691788555862129 as select v24, v19, v39 from aggJoin94322926922614079 join aggView5812747506806704143 using(v18);
create or replace view aggView7062963743569158828 as select v13 from semiDown427896303149727624;
create or replace view aggJoin1118367570283320503 as select v24 from aggJoin4717131834846943189 join aggView7062963743569158828 using(v13);
create or replace view aggView2638398361069231476 as select v24 from aggJoin1118367570283320503 group by v24;
create or replace view aggJoin860862244019067925 as select v24, v28 from semiUp5436325741540601536 join aggView2638398361069231476 using(v24);
create or replace view aggView7787057298638205442 as select v24, MIN(v39) as v39, MIN(v19) as v40 from aggJoin8408691788555862129 group by v24;
create or replace view aggJoin4370167705262567183 as select v28, v39, v40 from aggJoin860862244019067925 join aggView7787057298638205442 using(v24);
create or replace view res as select MIN(v39) as v39, MIN(v40) as v40, MIN(v28) as v41 from aggJoin4370167705262567183;
select sum(v39+v40+v41) from res;
