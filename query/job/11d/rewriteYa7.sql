create or replace view semiUp5519424570418745095 as select movie_id as v24, keyword_id as v22 from movie_keyword AS mk where (keyword_id) in (select id from keyword AS k where keyword IN ('sequel','revenge','based-on-novel'));
create or replace view semiUp489324617333286604 as select movie_id as v24, company_id as v17, company_type_id as v18, note as v19 from movie_companies AS mc where (company_id) in (select id from company_name AS cn where country_code<> '[pl]');
create or replace view semiUp1349830021868610875 as select v24, v17, v18, v19 from semiUp489324617333286604 where (v18) in (select id from company_type AS ct where kind<> 'production companies');
create or replace view semiUp4506407590677922684 as select id as v24, title as v28 from title AS t where (id) in (select v24 from semiUp1349830021868610875) and production_year>1950;
create or replace view semiUp8221143597383338317 as select v24, v22 from semiUp5519424570418745095 where (v24) in (select v24 from semiUp4506407590677922684);
create or replace view semiUp3120992864670289400 as select movie_id as v24, link_type_id as v13 from movie_link AS ml where (movie_id) in (select v24 from semiUp8221143597383338317);
create or replace view semiUp1767063522892775409 as select id as v13 from link_type AS lt where (id) in (select v13 from semiUp3120992864670289400);
create or replace view semiDown7196917383910468972 as select v24, v13 from semiUp3120992864670289400 where (v13) in (select v13 from semiUp1767063522892775409);
create or replace view semiDown7776691274802848744 as select v24, v22 from semiUp8221143597383338317 where (v24) in (select v24 from semiDown7196917383910468972);
create or replace view semiDown8467352999480266506 as select v24, v28 from semiUp4506407590677922684 where (v24) in (select v24 from semiDown7776691274802848744);
create or replace view semiDown904516911474195907 as select id as v22 from keyword AS k where (id) in (select v22 from semiDown7776691274802848744) and keyword IN ('sequel','revenge','based-on-novel');
create or replace view semiDown6142824547031395267 as select v24, v17, v18, v19 from semiUp1349830021868610875 where (v24) in (select v24 from semiDown8467352999480266506);
create or replace view semiDown9984870465861549 as select id as v17, name as v2 from company_name AS cn where (id) in (select v17 from semiDown6142824547031395267) and country_code<> '[pl]';
create or replace view semiDown5182867090232841554 as select id as v18 from company_type AS ct where (id) in (select v18 from semiDown6142824547031395267) and kind<> 'production companies';
create or replace view aggView8371153365123558827 as select v17, v2 as v39 from semiDown9984870465861549;
create or replace view aggJoin7923182613475141321 as select v24, v18, v19, v39 from semiDown6142824547031395267 join aggView8371153365123558827 using(v17);
create or replace view aggView5202897359196016216 as select v22 from semiDown904516911474195907;
create or replace view aggJoin4794168734944180533 as select v24 from semiDown7776691274802848744 join aggView5202897359196016216 using(v22);
create or replace view aggView368410082379599947 as select v18 from semiDown5182867090232841554;
create or replace view aggJoin8356045168288466233 as select v24, v19, v39 from aggJoin7923182613475141321 join aggView368410082379599947 using(v18);
create or replace view aggView9192783277227224768 as select v24, MIN(v39) as v39, MIN(v19) as v40 from aggJoin8356045168288466233 group by v24;
create or replace view aggJoin2630522064553901070 as select v24, v28, v39, v40 from semiDown8467352999480266506 join aggView9192783277227224768 using(v24);
create or replace view aggView8280785397206691916 as select v24, MIN(v39) as v39, MIN(v40) as v40, MIN(v28) as v41 from aggJoin2630522064553901070 group by v24;
create or replace view aggJoin8609529296469789729 as select v24, v39, v40, v41 from aggJoin4794168734944180533 join aggView8280785397206691916 using(v24);
create or replace view aggView4354095672739303480 as select v24, MIN(v39) as v39, MIN(v40) as v40, MIN(v41) as v41 from aggJoin8609529296469789729 group by v24;
create or replace view aggJoin1450293215311792858 as select v13, v39, v40, v41 from semiDown7196917383910468972 join aggView4354095672739303480 using(v24);
create or replace view aggView1082915693796321133 as select v13, MIN(v39) as v39, MIN(v40) as v40, MIN(v41) as v41 from aggJoin1450293215311792858 group by v13;
create or replace view aggJoin8563908337933907616 as select v39, v40, v41 from semiUp1767063522892775409 join aggView1082915693796321133 using(v13);
create or replace view res as select MIN(v39) as v39, MIN(v40) as v40, MIN(v41) as v41 from aggJoin8563908337933907616;
select sum(v39+v40+v41) from res;
