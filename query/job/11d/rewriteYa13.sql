create or replace view semiUp4120324404206628959 as select movie_id as v24, link_type_id as v13 from movie_link AS ml where (link_type_id) in (select id from link_type AS lt);
create or replace view semiUp4836628971983042658 as select movie_id as v24, company_id as v17, company_type_id as v18, note as v19 from movie_companies AS mc where (company_type_id) in (select id from company_type AS ct where kind<> 'production companies');
create or replace view semiUp2701184651745553310 as select movie_id as v24, keyword_id as v22 from movie_keyword AS mk where (keyword_id) in (select id from keyword AS k where keyword IN ('sequel','revenge','based-on-novel'));
create or replace view semiUp5820971630409442239 as select v24, v17, v18, v19 from semiUp4836628971983042658 where (v17) in (select id from company_name AS cn where country_code<> '[pl]');
create or replace view semiUp8683959184490593091 as select id as v24, title as v28 from title AS t where (id) in (select v24 from semiUp5820971630409442239) and production_year>1950;
create or replace view semiUp3041732813187102793 as select v24, v13 from semiUp4120324404206628959 where (v24) in (select v24 from semiUp8683959184490593091);
create or replace view semiUp3982314761245219704 as select v24, v22 from semiUp2701184651745553310 where (v24) in (select v24 from semiUp3041732813187102793);
create or replace view semiDown7111795555310228000 as select v24, v13 from semiUp3041732813187102793 where (v24) in (select v24 from semiUp3982314761245219704);
create or replace view semiDown5279660230415947511 as select id as v22 from keyword AS k where (id) in (select v22 from semiUp3982314761245219704) and keyword IN ('sequel','revenge','based-on-novel');
create or replace view semiDown3247223730712757966 as select v24, v28 from semiUp8683959184490593091 where (v24) in (select v24 from semiDown7111795555310228000);
create or replace view semiDown1184266737999270770 as select id as v13 from link_type AS lt where (id) in (select v13 from semiDown7111795555310228000);
create or replace view semiDown3679021229531771875 as select v24, v17, v18, v19 from semiUp5820971630409442239 where (v24) in (select v24 from semiDown3247223730712757966);
create or replace view semiDown3512118717636786988 as select id as v17, name as v2 from company_name AS cn where (id) in (select v17 from semiDown3679021229531771875) and country_code<> '[pl]';
create or replace view semiDown4265682247027297817 as select id as v18 from company_type AS ct where (id) in (select v18 from semiDown3679021229531771875) and kind<> 'production companies';
create or replace view aggView8106711191540931726 as select v18 from semiDown4265682247027297817;
create or replace view aggJoin4889864442050612849 as select v24, v17, v19 from semiDown3679021229531771875 join aggView8106711191540931726 using(v18);
create or replace view aggView4113184705866208551 as select v22 from semiDown5279660230415947511;
create or replace view aggJoin61481015012093919 as select v24 from semiUp3982314761245219704 join aggView4113184705866208551 using(v22);
create or replace view aggView7309170169080125630 as select v13 from semiDown1184266737999270770;
create or replace view aggJoin3831939504773461516 as select v24 from semiDown7111795555310228000 join aggView7309170169080125630 using(v13);
create or replace view aggView7248889076048633887 as select v17, v2 as v39 from semiDown3512118717636786988;
create or replace view aggJoin2349300738112963025 as select v24, v19, v39 from aggJoin4889864442050612849 join aggView7248889076048633887 using(v17);
create or replace view aggView4484531794982041639 as select v24, MIN(v39) as v39, MIN(v19) as v40 from aggJoin2349300738112963025 group by v24;
create or replace view aggJoin1190818726351717735 as select v24, v28, v39, v40 from semiDown3247223730712757966 join aggView4484531794982041639 using(v24);
create or replace view aggView818414046610987589 as select v24, MIN(v39) as v39, MIN(v40) as v40, MIN(v28) as v41 from aggJoin1190818726351717735 group by v24;
create or replace view aggJoin8220690383240483313 as select v24, v39, v40, v41 from aggJoin3831939504773461516 join aggView818414046610987589 using(v24);
create or replace view aggView6157140655707821478 as select v24, MIN(v39) as v39, MIN(v40) as v40, MIN(v41) as v41 from aggJoin8220690383240483313 group by v24;
create or replace view aggJoin4498672943485197093 as select v39, v40, v41 from aggJoin61481015012093919 join aggView6157140655707821478 using(v24);
create or replace view res as select MIN(v39) as v39, MIN(v40) as v40, MIN(v41) as v41 from aggJoin4498672943485197093;
select sum(v39+v40+v41) from res;
