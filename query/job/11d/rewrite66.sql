create or replace view aggView2705785736100855202 as select id as v17, name as v39 from company_name as cn where country_code<> '[pl]';
create or replace view aggJoin7419599454090637519 as select movie_id as v24, company_type_id as v18, note as v19, v39 from movie_companies as mc, aggView2705785736100855202 where mc.company_id=aggView2705785736100855202.v17;
create or replace view aggView9041971255636580472 as select id as v24, title as v41 from title as t where production_year>1950;
create or replace view aggJoin8702403146072379926 as select movie_id as v24, link_type_id as v13, v41 from movie_link as ml, aggView9041971255636580472 where ml.movie_id=aggView9041971255636580472.v24;
create or replace view aggView7874375916645970736 as select id as v18 from company_type as ct where kind<> 'production companies';
create or replace view aggJoin5040495218536590728 as select v24, v19, v39 from aggJoin7419599454090637519 join aggView7874375916645970736 using(v18);
create or replace view aggView1681487473813446319 as select v24, MIN(v39) as v39, MIN(v19) as v40 from aggJoin5040495218536590728 group by v24;
create or replace view aggJoin8299256046275879831 as select v24, v13, v41 as v41, v39, v40 from aggJoin8702403146072379926 join aggView1681487473813446319 using(v24);
create or replace view aggView8970413478897363058 as select id as v13 from link_type as lt;
create or replace view aggJoin3260615997416161171 as select v24, v41, v39, v40 from aggJoin8299256046275879831 join aggView8970413478897363058 using(v13);
create or replace view aggView4601632977852257464 as select v24, MIN(v41) as v41, MIN(v39) as v39, MIN(v40) as v40 from aggJoin3260615997416161171 group by v24;
create or replace view aggJoin6764548256681771199 as select keyword_id as v22, v41, v39, v40 from movie_keyword as mk, aggView4601632977852257464 where mk.movie_id=aggView4601632977852257464.v24;
create or replace view aggView7387492885678840852 as select v22, MIN(v41) as v41, MIN(v39) as v39, MIN(v40) as v40 from aggJoin6764548256681771199 group by v22;
create or replace view aggJoin6572546659790657862 as select keyword as v11, v41, v39, v40 from keyword as k, aggView7387492885678840852 where k.id=aggView7387492885678840852.v22 and keyword IN ('sequel','revenge','based-on-novel');
create or replace view res as select MIN(v39) as v39, MIN(v40) as v40, MIN(v41) as v41 from aggJoin6572546659790657862;
select v39, v40, v41 from res;