create or replace view aggView1556688906908804767 as select id as v17, name as v39 from company_name as cn where country_code<> '[pl]';
create or replace view aggJoin3992672005005405182 as select movie_id as v24, company_type_id as v18, note as v19, v39 from movie_companies as mc, aggView1556688906908804767 where mc.company_id=aggView1556688906908804767.v17;
create or replace view aggView9209358732491700978 as select id as v18 from company_type as ct where kind<> 'production companies';
create or replace view aggJoin3270657072946762839 as select v24, v19, v39 from aggJoin3992672005005405182 join aggView9209358732491700978 using(v18);
create or replace view aggView4162165265437177793 as select v24, MIN(v39) as v39, MIN(v19) as v40 from aggJoin3270657072946762839 group by v24;
create or replace view aggJoin4819503486823965701 as select id as v24, title as v28, v39, v40 from title as t, aggView4162165265437177793 where t.id=aggView4162165265437177793.v24 and production_year>1950;
create or replace view aggView4272229024553821998 as select v24, MIN(v39) as v39, MIN(v40) as v40, MIN(v28) as v41 from aggJoin4819503486823965701 group by v24;
create or replace view aggJoin2176482434478307763 as select movie_id as v24, link_type_id as v13, v39, v40, v41 from movie_link as ml, aggView4272229024553821998 where ml.movie_id=aggView4272229024553821998.v24;
create or replace view aggView1731831190452789914 as select id as v13 from link_type as lt;
create or replace view aggJoin2363806124054517331 as select v24, v39, v40, v41 from aggJoin2176482434478307763 join aggView1731831190452789914 using(v13);
create or replace view aggView9026864520801105900 as select v24, MIN(v39) as v39, MIN(v40) as v40, MIN(v41) as v41 from aggJoin2363806124054517331 group by v24;
create or replace view aggJoin7067093020460859198 as select keyword_id as v22, v39, v40, v41 from movie_keyword as mk, aggView9026864520801105900 where mk.movie_id=aggView9026864520801105900.v24;
create or replace view aggView61759121382921613 as select v22, MIN(v39) as v39, MIN(v40) as v40, MIN(v41) as v41 from aggJoin7067093020460859198 group by v22;
create or replace view aggJoin1322443371292531872 as select v39, v40, v41 from keyword as k, aggView61759121382921613 where k.id=aggView61759121382921613.v22 and keyword IN ('sequel','revenge','based-on-novel');
create or replace view res as select MIN(v39) as v39, MIN(v40) as v40, MIN(v41) as v41 from aggJoin1322443371292531872;
select v39, v40, v41 from res;