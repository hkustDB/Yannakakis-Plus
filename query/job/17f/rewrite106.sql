create or replace view aggView9196605099355433155 as select id as v26, name as v47 from name as n where name LIKE '%B%';
create or replace view aggJoin8520843396048082410 as select movie_id as v3, v47 from cast_info as ci, aggView9196605099355433155 where ci.person_id=aggView9196605099355433155.v26;
create or replace view aggView7721069075959042484 as select v3, MIN(v47) as v47 from aggJoin8520843396048082410 group by v3;
create or replace view aggJoin5176151845448507640 as select movie_id as v3, keyword_id as v25, v47 from movie_keyword as mk, aggView7721069075959042484 where mk.movie_id=aggView7721069075959042484.v3;
create or replace view aggView5980306572360572283 as select id as v20 from company_name as cn;
create or replace view aggJoin6433844718572358329 as select movie_id as v3 from movie_companies as mc, aggView5980306572360572283 where mc.company_id=aggView5980306572360572283.v20;
create or replace view aggView6256182543940401132 as select id as v25 from keyword as k where keyword= 'character-name-in-title';
create or replace view aggJoin7861169520747836529 as select v3, v47 from aggJoin5176151845448507640 join aggView6256182543940401132 using(v25);
create or replace view aggView7838931708600232112 as select v3, MIN(v47) as v47 from aggJoin7861169520747836529 group by v3;
create or replace view aggJoin4934363789766986134 as select v3, v47 from aggJoin6433844718572358329 join aggView7838931708600232112 using(v3);
create or replace view aggView4349191311425416744 as select id as v3 from title as t;
create or replace view aggJoin6716642572489666571 as select v47 from aggJoin4934363789766986134 join aggView4349191311425416744 using(v3);
create or replace view res as select MIN(v47) as v47 from aggJoin6716642572489666571;
select sum(v47) from res;