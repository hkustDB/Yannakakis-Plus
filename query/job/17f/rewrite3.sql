create or replace view aggView4942752003422210067 as select id as v20 from company_name as cn;
create or replace view aggJoin3797836390804982420 as select movie_id as v3 from movie_companies as mc, aggView4942752003422210067 where mc.company_id=aggView4942752003422210067.v20;
create or replace view aggView6837087571253599009 as select id as v25 from keyword as k where keyword= 'character-name-in-title';
create or replace view aggJoin7496848017244727387 as select movie_id as v3 from movie_keyword as mk, aggView6837087571253599009 where mk.keyword_id=aggView6837087571253599009.v25;
create or replace view aggView5212246410280177347 as select v3 from aggJoin3797836390804982420 group by v3;
create or replace view aggJoin5621022277899976918 as select id as v3 from title as t, aggView5212246410280177347 where t.id=aggView5212246410280177347.v3;
create or replace view aggView7961884333836063158 as select v3 from aggJoin5621022277899976918 group by v3;
create or replace view aggJoin2067214758358339964 as select v3 from aggJoin7496848017244727387 join aggView7961884333836063158 using(v3);
create or replace view aggView3137483714326032967 as select v3 from aggJoin2067214758358339964 group by v3;
create or replace view aggJoin2514328068363161268 as select person_id as v26 from cast_info as ci, aggView3137483714326032967 where ci.movie_id=aggView3137483714326032967.v3;
create or replace view aggView2121223766400481523 as select v26 from aggJoin2514328068363161268 group by v26;
create or replace view aggJoin7692900023959143490 as select name as v27 from name as n, aggView2121223766400481523 where n.id=aggView2121223766400481523.v26 and name LIKE '%B%';
create or replace view res as select MIN(v27) as v47 from aggJoin7692900023959143490;
select sum(v47) from res;