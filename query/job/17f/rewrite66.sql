create or replace view aggView4149503742212763666 as select id as v26, name as v47 from name as n where name LIKE '%B%';
create or replace view aggJoin597686614709370306 as select movie_id as v3, v47 from cast_info as ci, aggView4149503742212763666 where ci.person_id=aggView4149503742212763666.v26;
create or replace view aggView1097853954710190649 as select id as v25 from keyword as k where keyword= 'character-name-in-title';
create or replace view aggJoin4893989592463596220 as select movie_id as v3 from movie_keyword as mk, aggView1097853954710190649 where mk.keyword_id=aggView1097853954710190649.v25;
create or replace view aggView971201436669945634 as select v3 from aggJoin4893989592463596220 group by v3;
create or replace view aggJoin8849691837790397477 as select id as v3 from title as t, aggView971201436669945634 where t.id=aggView971201436669945634.v3;
create or replace view aggView508907276769204545 as select v3, MIN(v47) as v47 from aggJoin597686614709370306 group by v3;
create or replace view aggJoin2139480899006615675 as select v3, v47 from aggJoin8849691837790397477 join aggView508907276769204545 using(v3);
create or replace view aggView2099546242135248063 as select v3, MIN(v47) as v47 from aggJoin2139480899006615675 group by v3;
create or replace view aggJoin865489935988280018 as select company_id as v20, v47 from movie_companies as mc, aggView2099546242135248063 where mc.movie_id=aggView2099546242135248063.v3;
create or replace view aggView5899027563356922433 as select v20, MIN(v47) as v47 from aggJoin865489935988280018 group by v20;
create or replace view aggJoin8735555362081157516 as select v47 from company_name as cn, aggView5899027563356922433 where cn.id=aggView5899027563356922433.v20;
create or replace view res as select MIN(v47) as v47 from aggJoin8735555362081157516;
select sum(v47) from res;