create or replace view semiUp4541889703586423770 as select movie_id as v15, company_type_id as v1, note as v9 from movie_companies AS mc where (company_type_id) in (select (id) from company_type AS ct where kind= 'production companies') and note LIKE '%(co-production)%' and note NOT LIKE '%(as Metro-Goldwyn-Mayer Pictures)%';
create or replace view semiUp8898795323591371253 as select id as v15, title as v16, production_year as v19 from title AS t where (id) in (select (v15) from semiUp4541889703586423770) and production_year>2010;
create or replace view semiUp7514831758000307660 as select movie_id as v15, info_type_id as v3 from movie_info_idx AS mi_idx where (movie_id) in (select (v15) from semiUp8898795323591371253);
create or replace view semiUp1419706727900457169 as select id as v3 from info_type AS it where (id) in (select (v3) from semiUp7514831758000307660) and info= 'top 250 rank';
create or replace view semiDown6450474273094811211 as select v15, v3 from semiUp7514831758000307660 where (v3) in (select (v3) from semiUp1419706727900457169);
create or replace view semiDown8306298016417860081 as select v15, v16, v19 from semiUp8898795323591371253 where (v15) in (select (v15) from semiDown6450474273094811211);
create or replace view semiDown2818644704582915001 as select v15, v1, v9 from semiUp4541889703586423770 where (v15) in (select (v15) from semiDown8306298016417860081);
create or replace view semiDown121215385200464961 as select id as v1 from company_type AS ct where (id) in (select (v1) from semiDown2818644704582915001) and kind= 'production companies';
create or replace view aggView1467252253403741930 as select v1 from semiDown121215385200464961;
create or replace view aggJoin6844318243387353025 as select v15, v9 from semiDown2818644704582915001 join aggView1467252253403741930 using(v1);
create or replace view aggView5155688670394195174 as select v15, MIN(v9) as v27 from aggJoin6844318243387353025 group by v15;
create or replace view aggJoin6487120442544135228 as select v15, v16, v19, v27 from semiDown8306298016417860081 join aggView5155688670394195174 using(v15);
create or replace view aggView8176467193634472179 as select v15, MIN(v27) as v27, MIN(v16) as v28, MIN(v19) as v29 from aggJoin6487120442544135228 group by v15;
create or replace view aggJoin5289068347180927067 as select v3, v27, v28, v29 from semiDown6450474273094811211 join aggView8176467193634472179 using(v15);
create or replace view aggView3244696387967678748 as select v3, MIN(v27) as v27, MIN(v28) as v28, MIN(v29) as v29 from aggJoin5289068347180927067 group by v3;
create or replace view aggJoin4956454169256145523 as select v27, v28, v29 from semiUp1419706727900457169 join aggView3244696387967678748 using(v3);
select MIN(v27) as v27,MIN(v28) as v28,MIN(v29) as v29 from aggJoin4956454169256145523;
