create or replace view semiUp8483930689032966693 as select movie_id as v15, info_type_id as v3 from movie_info_idx AS mi_idx where (info_type_id) in (select (id) from info_type AS it where info= 'top 250 rank');
create or replace view semiUp7906893946918588371 as select movie_id as v15, company_type_id as v1, note as v9 from movie_companies AS mc where (movie_id) in (select (id) from title AS t where production_year>2010) and note LIKE '%(co-production)%' and note NOT LIKE '%(as Metro-Goldwyn-Mayer Pictures)%';
create or replace view semiUp8383863725807365946 as select v15, v1, v9 from semiUp7906893946918588371 where (v15) in (select (v15) from semiUp8483930689032966693);
create or replace view semiUp561516203412831322 as select id as v1 from company_type AS ct where (id) in (select (v1) from semiUp8383863725807365946) and kind= 'production companies';
create or replace view semiDown3766396576673171849 as select v15, v1, v9 from semiUp8383863725807365946 where (v1) in (select (v1) from semiUp561516203412831322);
create or replace view semiDown3126799496312244007 as select id as v15, title as v16, production_year as v19 from title AS t where (id) in (select (v15) from semiDown3766396576673171849) and production_year>2010;
create or replace view semiDown8058787000970701648 as select v15, v3 from semiUp8483930689032966693 where (v15) in (select (v15) from semiDown3766396576673171849);
create or replace view semiDown3121967008761023625 as select id as v3 from info_type AS it where (id) in (select (v3) from semiDown8058787000970701648) and info= 'top 250 rank';
create or replace view aggView8212702176043035066 as select v15, v16 as v28, v19 as v29 from semiDown3126799496312244007;
create or replace view aggJoin325189651165623484 as select v15, v1, v9, v28, v29 from semiDown3766396576673171849 join aggView8212702176043035066 using(v15);
create or replace view aggView7790508147496569112 as select v3 from semiDown3121967008761023625;
create or replace view aggJoin757701518880564417 as select v15 from semiDown8058787000970701648 join aggView7790508147496569112 using(v3);
create or replace view aggView6993346672741879947 as select v15 from aggJoin757701518880564417 group by v15;
create or replace view aggJoin6240671715427040066 as select v1, v9, v28 as v28, v29 as v29 from aggJoin325189651165623484 join aggView6993346672741879947 using(v15);
create or replace view aggView3546942222877035052 as select v1, MIN(v28) as v28, MIN(v29) as v29, MIN(v9) as v27 from aggJoin6240671715427040066 group by v1;
create or replace view aggJoin4981410396888991004 as select v28, v29, v27 from semiUp561516203412831322 join aggView3546942222877035052 using(v1);
select MIN(v27) as v27,MIN(v28) as v28,MIN(v29) as v29 from aggJoin4981410396888991004;
