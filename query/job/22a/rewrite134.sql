create or replace view aggView6956605416370793467 as select id as v1, name as v49 from company_name as cn where country_code<> '[us]';
create or replace view aggJoin7365597527450595797 as select movie_id as v37, company_type_id as v8, note as v23, v49 from movie_companies as mc, aggView6956605416370793467 where mc.company_id=aggView6956605416370793467.v1 and note NOT LIKE '%(USA)%' and note LIKE '%(200%)%';
create or replace view aggView5971890652507978267 as select id as v17 from kind_type as kt where kind IN ('movie','episode');
create or replace view aggJoin322683229069702592 as select id as v37, title as v38, production_year as v41 from title as t, aggView5971890652507978267 where t.kind_id=aggView5971890652507978267.v17 and production_year>2008;
create or replace view aggView1177298147023213128 as select v37, MIN(v38) as v51 from aggJoin322683229069702592 group by v37;
create or replace view aggJoin1193822164125731321 as select movie_id as v37, info_type_id as v12, info as v32, v51 from movie_info_idx as mi_idx, aggView1177298147023213128 where mi_idx.movie_id=aggView1177298147023213128.v37 and info<'7.0';
create or replace view aggView2434739787065946636 as select id as v12 from info_type as it2 where info= 'rating';
create or replace view aggJoin6919264540032787974 as select v37, v32, v51 from aggJoin1193822164125731321 join aggView2434739787065946636 using(v12);
create or replace view aggView4292330148501781053 as select id as v8 from company_type as ct;
create or replace view aggJoin7815647033744969914 as select v37, v23, v49 from aggJoin7365597527450595797 join aggView4292330148501781053 using(v8);
create or replace view aggView8466104824188770033 as select v37, MIN(v49) as v49 from aggJoin7815647033744969914 group by v37;
create or replace view aggJoin3411702046201251930 as select v37, v32, v51 as v51, v49 from aggJoin6919264540032787974 join aggView8466104824188770033 using(v37);
create or replace view aggView6518378822182659086 as select v37, MIN(v51) as v51, MIN(v49) as v49, MIN(v32) as v50 from aggJoin3411702046201251930 group by v37;
create or replace view aggJoin4719541662075866980 as select movie_id as v37, keyword_id as v14, v51, v49, v50 from movie_keyword as mk, aggView6518378822182659086 where mk.movie_id=aggView6518378822182659086.v37;
create or replace view aggView6381825240990055453 as select id as v14 from keyword as k where keyword IN ('murder','murder-in-title','blood','violence');
create or replace view aggJoin3531890947862790609 as select v37, v51, v49, v50 from aggJoin4719541662075866980 join aggView6381825240990055453 using(v14);
create or replace view aggView8505804522428536077 as select id as v10 from info_type as it1 where info= 'countries';
create or replace view aggJoin1191323627046676874 as select movie_id as v37, info as v27 from movie_info as mi, aggView8505804522428536077 where mi.info_type_id=aggView8505804522428536077.v10 and info IN ('Germany','German','USA','American');
create or replace view aggView7408050900630315548 as select v37 from aggJoin1191323627046676874 group by v37;
create or replace view aggJoin5718207405540433877 as select v51 as v51, v49 as v49, v50 as v50 from aggJoin3531890947862790609 join aggView7408050900630315548 using(v37);
select MIN(v49) as v49,MIN(v50) as v50,MIN(v51) as v51 from aggJoin5718207405540433877;
