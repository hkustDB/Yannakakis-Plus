create or replace view aggView8691479181145260650 as select name as v2, id as v1 from company_name as cn where country_code<> '[us]';
create or replace view aggView8796810415935370173 as select id as v10 from info_type as it1 where info= 'countries';
create or replace view aggJoin2803253013713299008 as select movie_id as v37, info as v27 from movie_info as mi, aggView8796810415935370173 where mi.info_type_id=aggView8796810415935370173.v10 and info IN ('Germany','German','USA','American');
create or replace view aggView537931142471944994 as select v37 from aggJoin2803253013713299008 group by v37;
create or replace view aggJoin8603270960797301641 as select id as v37, title as v38, kind_id as v17, production_year as v41 from title as t, aggView537931142471944994 where t.id=aggView537931142471944994.v37 and production_year>2008;
create or replace view aggView595634569538541966 as select id as v14 from keyword as k where keyword IN ('murder','murder-in-title','blood','violence');
create or replace view aggJoin2759009450391622695 as select movie_id as v37 from movie_keyword as mk, aggView595634569538541966 where mk.keyword_id=aggView595634569538541966.v14;
create or replace view aggView8497197502514363825 as select v37 from aggJoin2759009450391622695 group by v37;
create or replace view aggJoin3232153071871995080 as select v37, v38, v17, v41 from aggJoin8603270960797301641 join aggView8497197502514363825 using(v37);
create or replace view aggView751601651717395959 as select id as v17 from kind_type as kt where kind IN ('movie','episode');
create or replace view aggJoin7137309690484848306 as select v37, v38, v41 from aggJoin3232153071871995080 join aggView751601651717395959 using(v17);
create or replace view aggView7013463762652766370 as select v38, v37 from aggJoin7137309690484848306 group by v38,v37;
create or replace view aggView1400546081899881277 as select id as v12 from info_type as it2 where info= 'rating';
create or replace view aggJoin5388906444518826684 as select movie_id as v37, info as v32 from movie_info_idx as mi_idx, aggView1400546081899881277 where mi_idx.info_type_id=aggView1400546081899881277.v12;
create or replace view aggView6369018226120952719 as select v37, v32 from aggJoin5388906444518826684 group by v37,v32;
create or replace view aggJoin8069987452043229371 as select v37, v32 from aggView6369018226120952719 where v32<'7.0';
create or replace view aggView1403217475253347489 as select v37, MIN(v32) as v50 from aggJoin8069987452043229371 group by v37;
create or replace view aggJoin6620972422959469188 as select movie_id as v37, company_id as v1, company_type_id as v8, note as v23, v50 from movie_companies as mc, aggView1403217475253347489 where mc.movie_id=aggView1403217475253347489.v37 and note NOT LIKE '%(USA)%' and note LIKE '%(200%)%';
create or replace view aggView6687035884645677708 as select v37, MIN(v38) as v51 from aggView7013463762652766370 group by v37;
create or replace view aggJoin2088911071644134953 as select v1, v8, v23, v50 as v50, v51 from aggJoin6620972422959469188 join aggView6687035884645677708 using(v37);
create or replace view aggView8470746619871271456 as select id as v8 from company_type as ct;
create or replace view aggJoin6429417744204312171 as select v1, v23, v50, v51 from aggJoin2088911071644134953 join aggView8470746619871271456 using(v8);
create or replace view aggView3731105217448290792 as select v1, MIN(v50) as v50, MIN(v51) as v51 from aggJoin6429417744204312171 group by v1,v50,v51;
create or replace view aggJoin2937234126309185253 as select v2, v50, v51 from aggView8691479181145260650 join aggView3731105217448290792 using(v1);
select MIN(v2) as v49,MIN(v50) as v50,MIN(v51) as v51 from aggJoin2937234126309185253;
