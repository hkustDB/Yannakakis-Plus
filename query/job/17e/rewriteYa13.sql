create or replace view semiUp806309242784975662 as select movie_id as v3, keyword_id as v25 from movie_keyword AS mk where (keyword_id) in (select id from keyword AS k where keyword= 'character-name-in-title');
create or replace view semiUp1036559866065514850 as select movie_id as v3, company_id as v20 from movie_companies AS mc where (company_id) in (select id from company_name AS cn where country_code= '[us]');
create or replace view semiUp5256539852335755993 as select v3, v25 from semiUp806309242784975662 where (v3) in (select v3 from semiUp1036559866065514850);
create or replace view semiUp1246866392383908308 as select id as v3 from title AS t where (id) in (select v3 from semiUp5256539852335755993);
create or replace view semiUp2677211349784953987 as select person_id as v26, movie_id as v3 from cast_info AS ci where (person_id) in (select id from name AS n);
create or replace view semiUp7057405079694528616 as select v26, v3 from semiUp2677211349784953987 where (v3) in (select v3 from semiUp1246866392383908308);
create or replace view semiDown311777112260522826 as select v3 from semiUp1246866392383908308 where (v3) in (select v3 from semiUp7057405079694528616);
create or replace view semiDown5130098936423053717 as select id as v26, name as v27 from name AS n where (id) in (select v26 from semiUp7057405079694528616);
create or replace view semiDown3875270818707204633 as select v3, v25 from semiUp5256539852335755993 where (v3) in (select v3 from semiDown311777112260522826);
create or replace view semiDown6250031584963636727 as select id as v25 from keyword AS k where (id) in (select v25 from semiDown3875270818707204633) and keyword= 'character-name-in-title';
create or replace view semiDown2422530123071387911 as select v3, v20 from semiUp1036559866065514850 where (v3) in (select v3 from semiDown3875270818707204633);
create or replace view semiDown13927198303612103 as select id as v20 from company_name AS cn where (id) in (select v20 from semiDown2422530123071387911) and country_code= '[us]';
create or replace view aggView2360333378503056944 as select v25 from semiDown6250031584963636727;
create or replace view aggJoin8813776687537471214 as select v3 from semiDown3875270818707204633 join aggView2360333378503056944 using(v25);
create or replace view aggView7526435725837201174 as select v20 from semiDown13927198303612103;
create or replace view aggJoin47943577311747547 as select v3 from semiDown2422530123071387911 join aggView7526435725837201174 using(v20);
create or replace view aggView3880759968173198099 as select v3 from aggJoin47943577311747547 group by v3;
create or replace view aggJoin4702602114597688856 as select v3 from aggJoin8813776687537471214 join aggView3880759968173198099 using(v3);
create or replace view aggView5812528742153007337 as select v3 from aggJoin4702602114597688856 group by v3;
create or replace view aggJoin5767605306013394864 as select v3 from semiDown311777112260522826 join aggView5812528742153007337 using(v3);
create or replace view aggView5454334396702856606 as select v26, v27 as v47 from semiDown5130098936423053717;
create or replace view aggJoin2286417482290723066 as select v3, v47 from semiUp7057405079694528616 join aggView5454334396702856606 using(v26);
create or replace view aggView2961513987677654219 as select v3 from aggJoin5767605306013394864 group by v3;
create or replace view aggJoin1684060224932950594 as select v47 as v47 from aggJoin2286417482290723066 join aggView2961513987677654219 using(v3);
create or replace view res as select MIN(v47) as v47 from aggJoin1684060224932950594;
select sum(v47) from res;
