create or replace view semiUp2240953243488165241 as select person_id as v26, movie_id as v3 from cast_info AS ci where (person_id) in (select id from name AS n);
create or replace view semiUp3297488197829908767 as select movie_id as v3, company_id as v20 from movie_companies AS mc where (company_id) in (select id from company_name AS cn where country_code= '[us]');
create or replace view semiUp4299724233434833549 as select id as v3 from title AS t where (id) in (select v3 from semiUp3297488197829908767);
create or replace view semiUp4913752896548077124 as select movie_id as v3, keyword_id as v25 from movie_keyword AS mk where (keyword_id) in (select id from keyword AS k where keyword= 'character-name-in-title');
create or replace view semiUp6027623336211373464 as select v3, v25 from semiUp4913752896548077124 where (v3) in (select v3 from semiUp4299724233434833549);
create or replace view semiUp1536811988824304226 as select v26, v3 from semiUp2240953243488165241 where (v3) in (select v3 from semiUp6027623336211373464);
create or replace view semiDown5841961323744864364 as select id as v26, name as v27 from name AS n where (id) in (select v26 from semiUp1536811988824304226);
create or replace view semiDown7027085607515584074 as select v3, v25 from semiUp6027623336211373464 where (v3) in (select v3 from semiUp1536811988824304226);
create or replace view semiDown1043517275308946455 as select v3 from semiUp4299724233434833549 where (v3) in (select v3 from semiDown7027085607515584074);
create or replace view semiDown2043729501148769236 as select id as v25 from keyword AS k where (id) in (select v25 from semiDown7027085607515584074) and keyword= 'character-name-in-title';
create or replace view semiDown3044103583730962792 as select v3, v20 from semiUp3297488197829908767 where (v3) in (select v3 from semiDown1043517275308946455);
create or replace view semiDown6389380458390191431 as select id as v20 from company_name AS cn where (id) in (select v20 from semiDown3044103583730962792) and country_code= '[us]';
create or replace view aggView3226605276676554204 as select v26, v27 as v47 from semiDown5841961323744864364;
create or replace view aggJoin9085478912598678744 as select v3, v47 from semiUp1536811988824304226 join aggView3226605276676554204 using(v26);
create or replace view aggView6414219287694182671 as select v20 from semiDown6389380458390191431;
create or replace view aggJoin7690120742380780506 as select v3 from semiDown3044103583730962792 join aggView6414219287694182671 using(v20);
create or replace view aggView3321868024128662917 as select v25 from semiDown2043729501148769236;
create or replace view aggJoin232373238175491680 as select v3 from semiDown7027085607515584074 join aggView3321868024128662917 using(v25);
create or replace view aggView8483890416235510067 as select v3 from aggJoin7690120742380780506 group by v3;
create or replace view aggJoin484113351016270580 as select v3 from semiDown1043517275308946455 join aggView8483890416235510067 using(v3);
create or replace view aggView1614620759863224307 as select v3 from aggJoin484113351016270580 group by v3;
create or replace view aggJoin8102911553272383897 as select v3 from aggJoin232373238175491680 join aggView1614620759863224307 using(v3);
create or replace view aggView3947485094649353662 as select v3 from aggJoin8102911553272383897 group by v3;
create or replace view aggJoin6998925290009948040 as select v47 as v47 from aggJoin9085478912598678744 join aggView3947485094649353662 using(v3);
create or replace view res as select MIN(v47) as v47 from aggJoin6998925290009948040;
select sum(v47) from res;
