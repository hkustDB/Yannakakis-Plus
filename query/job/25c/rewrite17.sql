create or replace view aggView5227053159840656028 as select id as v28, name as v51 from name as n where gender= 'm';
create or replace view aggJoin4027329803199448237 as select movie_id as v37, note as v5, v51 from cast_info as ci, aggView5227053159840656028 where ci.person_id=aggView5227053159840656028.v28 and note IN ('(writer)','(head writer)','(written by)','(story)','(story editor)');
create or replace view aggView2055359003059584687 as select id as v37, title as v52 from title as t;
create or replace view aggJoin2123055664487201177 as select v37, v5, v51, v52 from aggJoin4027329803199448237 join aggView2055359003059584687 using(v37);
create or replace view aggView7129048434329298345 as select id as v10 from info_type as it2 where info= 'votes';
create or replace view aggJoin4449113338180675604 as select movie_id as v37, info as v23 from movie_info_idx as mi_idx, aggView7129048434329298345 where mi_idx.info_type_id=aggView7129048434329298345.v10;
create or replace view aggView3369638518567209186 as select v37, MIN(v51) as v51, MIN(v52) as v52 from aggJoin2123055664487201177 group by v37;
create or replace view aggJoin9032624129101041430 as select movie_id as v37, keyword_id as v12, v51, v52 from movie_keyword as mk, aggView3369638518567209186 where mk.movie_id=aggView3369638518567209186.v37;
create or replace view aggView5817173026041223060 as select id as v8 from info_type as it1 where info= 'genres';
create or replace view aggJoin6502375397313336074 as select movie_id as v37, info as v18 from movie_info as mi, aggView5817173026041223060 where mi.info_type_id=aggView5817173026041223060.v8 and info IN ('Horror','Action','Sci-Fi','Thriller','Crime','War');
create or replace view aggView7609279140415801393 as select v37, MIN(v18) as v49 from aggJoin6502375397313336074 group by v37;
create or replace view aggJoin5201004068006625217 as select v37, v23, v49 from aggJoin4449113338180675604 join aggView7609279140415801393 using(v37);
create or replace view aggView4351892668836021631 as select v37, MIN(v49) as v49, MIN(v23) as v50 from aggJoin5201004068006625217 group by v37;
create or replace view aggJoin7713709948790413977 as select v12, v51 as v51, v52 as v52, v49, v50 from aggJoin9032624129101041430 join aggView4351892668836021631 using(v37);
create or replace view aggView6876344385380985300 as select v12, MIN(v51) as v51, MIN(v52) as v52, MIN(v49) as v49, MIN(v50) as v50 from aggJoin7713709948790413977 group by v12;
create or replace view aggJoin1670809678026642786 as select keyword as v13, v51, v52, v49, v50 from keyword as k, aggView6876344385380985300 where k.id=aggView6876344385380985300.v12 and keyword IN ('murder','violence','blood','gore','death','female-nudity','hospital');
create or replace view res as select MIN(v49) as v49, MIN(v50) as v50, MIN(v51) as v51, MIN(v52) as v52 from aggJoin1670809678026642786;
select sum(v49+v50+v51+v52) from res;