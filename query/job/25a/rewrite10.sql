create or replace view aggView8999481236016143626 as select id as v28, name as v51 from name as n where gender= 'm';
create or replace view aggJoin4836450260046452695 as select movie_id as v37, note as v5, v51 from cast_info as ci, aggView8999481236016143626 where ci.person_id=aggView8999481236016143626.v28 and note IN ('(writer)','(head writer)','(written by)','(story)','(story editor)');
create or replace view aggView6102492463308991614 as select id as v10 from info_type as it2 where info= 'votes';
create or replace view aggJoin91766777463671152 as select movie_id as v37, info as v23 from movie_info_idx as mi_idx, aggView6102492463308991614 where mi_idx.info_type_id=aggView6102492463308991614.v10;
create or replace view aggView6023070499209319126 as select id as v8 from info_type as it1 where info= 'genres';
create or replace view aggJoin647641103142304132 as select movie_id as v37, info as v18 from movie_info as mi, aggView6023070499209319126 where mi.info_type_id=aggView6023070499209319126.v8 and info= 'Horror';
create or replace view aggView7837441365386705899 as select v37, MIN(v18) as v49 from aggJoin647641103142304132 group by v37;
create or replace view aggJoin3659028926567698142 as select id as v37, title as v38, v49 from title as t, aggView7837441365386705899 where t.id=aggView7837441365386705899.v37;
create or replace view aggView7128769360846318880 as select v37, MIN(v49) as v49, MIN(v38) as v52 from aggJoin3659028926567698142 group by v37;
create or replace view aggJoin1662860779208023054 as select v37, v23, v49, v52 from aggJoin91766777463671152 join aggView7128769360846318880 using(v37);
create or replace view aggView5995723804127168016 as select v37, MIN(v49) as v49, MIN(v52) as v52, MIN(v23) as v50 from aggJoin1662860779208023054 group by v37;
create or replace view aggJoin5060875629970266616 as select v37, v5, v51 as v51, v49, v52, v50 from aggJoin4836450260046452695 join aggView5995723804127168016 using(v37);
create or replace view aggView5965178685336983802 as select v37, MIN(v51) as v51, MIN(v49) as v49, MIN(v52) as v52, MIN(v50) as v50 from aggJoin5060875629970266616 group by v37;
create or replace view aggJoin8705018148087369956 as select keyword_id as v12, v51, v49, v52, v50 from movie_keyword as mk, aggView5965178685336983802 where mk.movie_id=aggView5965178685336983802.v37;
create or replace view aggView9202582666191183025 as select v12, MIN(v51) as v51, MIN(v49) as v49, MIN(v52) as v52, MIN(v50) as v50 from aggJoin8705018148087369956 group by v12;
create or replace view aggJoin156227179144942145 as select keyword as v13, v51, v49, v52, v50 from keyword as k, aggView9202582666191183025 where k.id=aggView9202582666191183025.v12 and keyword IN ('murder','blood','gore','death','female-nudity');
create or replace view res as select MIN(v49) as v49, MIN(v50) as v50, MIN(v51) as v51, MIN(v52) as v52 from aggJoin156227179144942145;
select sum(v49+v50+v51+v52) from res;