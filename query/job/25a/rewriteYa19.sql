create or replace view semiUp5828232141814402179 as select person_id as v28, movie_id as v37 from cast_info AS ci where (person_id) in (select id from name AS n where gender= 'm') and note IN ('(writer)','(head writer)','(written by)','(story)','(story editor)');
create or replace view semiUp2643911003764426602 as select movie_id as v37, keyword_id as v12 from movie_keyword AS mk where (keyword_id) in (select id from keyword AS k where keyword IN ('murder','blood','gore','death','female-nudity'));
create or replace view semiUp7457604827600251167 as select movie_id as v37, info_type_id as v8, info as v18 from movie_info AS mi where (info_type_id) in (select id from info_type AS it1 where info= 'genres') and info= 'Horror';
create or replace view semiUp5104424631373957501 as select movie_id as v37, info_type_id as v10, info as v23 from movie_info_idx AS mi_idx where (info_type_id) in (select id from info_type AS it2 where info= 'votes');
create or replace view semiUp3422891754326664688 as select v37, v12 from semiUp2643911003764426602 where (v37) in (select v37 from semiUp7457604827600251167);
create or replace view semiUp1196606788034236975 as select v28, v37 from semiUp5828232141814402179 where (v37) in (select v37 from semiUp3422891754326664688);
create or replace view semiUp1340300748238555436 as select v37, v10, v23 from semiUp5104424631373957501 where (v37) in (select v37 from semiUp1196606788034236975);
create or replace view semiUp5048369857607044571 as select id as v37, title as v38 from title AS t where (id) in (select v37 from semiUp1340300748238555436);
create or replace view semiDown4761633951792387017 as select v37, v10, v23 from semiUp1340300748238555436 where (v37) in (select v37 from semiUp5048369857607044571);
create or replace view semiDown6859505421609162915 as select id as v10 from info_type AS it2 where (id) in (select v10 from semiDown4761633951792387017) and info= 'votes';
create or replace view semiDown3421900202501211887 as select v28, v37 from semiUp1196606788034236975 where (v37) in (select v37 from semiDown4761633951792387017);
create or replace view semiDown2138497615841454284 as select v37, v12 from semiUp3422891754326664688 where (v37) in (select v37 from semiDown3421900202501211887);
create or replace view semiDown5766187444335817107 as select id as v28, name as v29 from name AS n where (id) in (select v28 from semiDown3421900202501211887) and gender= 'm';
create or replace view semiDown2225397519178913646 as select v37, v8, v18 from semiUp7457604827600251167 where (v37) in (select v37 from semiDown2138497615841454284);
create or replace view semiDown380199888962700384 as select id as v12 from keyword AS k where (id) in (select v12 from semiDown2138497615841454284) and keyword IN ('murder','blood','gore','death','female-nudity');
create or replace view semiDown9126918956948604936 as select id as v8 from info_type AS it1 where (id) in (select v8 from semiDown2225397519178913646) and info= 'genres';
create or replace view aggView7673672002684739284 as select v8 from semiDown9126918956948604936;
create or replace view aggJoin8888161780841644636 as select v37, v18 from semiDown2225397519178913646 join aggView7673672002684739284 using(v8);
create or replace view aggView351492386834353642 as select v28, v29 as v51 from semiDown5766187444335817107;
create or replace view aggJoin3364094072220301569 as select v37, v51 from semiDown3421900202501211887 join aggView351492386834353642 using(v28);
create or replace view aggView1976665619103446353 as select v10 from semiDown6859505421609162915;
create or replace view aggJoin4140933535958485631 as select v37, v23 from semiDown4761633951792387017 join aggView1976665619103446353 using(v10);
create or replace view aggView5098295076167203906 as select v37, MIN(v18) as v49 from aggJoin8888161780841644636 group by v37;
create or replace view aggJoin1237680509688712822 as select v37, v12, v49 from semiDown2138497615841454284 join aggView5098295076167203906 using(v37);
create or replace view aggView5461834492700334714 as select v12 from semiDown380199888962700384;
create or replace view aggJoin4402380862915081359 as select v37, v49 from aggJoin1237680509688712822 join aggView5461834492700334714 using(v12);
create or replace view aggView7807987530810222779 as select v37, MIN(v49) as v49 from aggJoin4402380862915081359 group by v37;
create or replace view aggJoin3089063701851847880 as select v37, v51 as v51, v49 from aggJoin3364094072220301569 join aggView7807987530810222779 using(v37);
create or replace view aggView4384068910379273286 as select v37, MIN(v51) as v51, MIN(v49) as v49 from aggJoin3089063701851847880 group by v37;
create or replace view aggJoin3991679534372164567 as select v37, v23, v51, v49 from aggJoin4140933535958485631 join aggView4384068910379273286 using(v37);
create or replace view aggView6038913905279929474 as select v37, MIN(v51) as v51, MIN(v49) as v49, MIN(v23) as v50 from aggJoin3991679534372164567 group by v37;
create or replace view aggJoin402280417738379563 as select v38, v51, v49, v50 from semiUp5048369857607044571 join aggView6038913905279929474 using(v37);
create or replace view res as select MIN(v49) as v49, MIN(v50) as v50, MIN(v51) as v51, MIN(v38) as v52 from aggJoin402280417738379563;
select sum(v49+v50+v51+v52) from res;
