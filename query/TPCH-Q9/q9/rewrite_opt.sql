create or replace view aggView6110518120419292560 as select n_nationkey as v8, n_name as v2, COUNT(*) as annot from nation_5 as nation_5 group by n_nationkey,n_name;
create or replace view aggView4102881658537486424 as select p_partkey as v46, COUNT(*) as annot from part_5 as part_5 where p_name LIKE '%blue%' group by p_partkey;
create or replace view aggJoin6415290918606089891 as select ps_partkey as v46, ps_suppkey as v47, ps_supplycost * annot as v49 from partsupp_5 as partsupp_5, aggView4102881658537486424 where partsupp_5.ps_partkey=aggView4102881658537486424.v46;
create or replace view aggView4266546385004810726 as select v46, v47, SUM(v49) as v49 from aggJoin6415290918606089891 group by v46,v47;
create or replace view aggJoin8568750200684357174 as select l_orderkey as v21, l_suppkey as v47, l_quantity as v34, l_returnflag as v38, v49 from lineitem_5 as lineitem_5, aggView4266546385004810726 where lineitem_5.l_partkey=aggView4266546385004810726.v46 and lineitem_5.l_suppkey=aggView4266546385004810726.v47;
create or replace view aggView2656605629245108991 as select v21, v47, v38, SUM(v49 * v34) as v52 from aggJoin8568750200684357174 group by v21,v47,v38;
create or replace view aggView160265145012676190 as select o_orderkey as v21, COUNT(*) as annot from orders_5 as orders_5 where o_orderdate<DATE '1996-12-31' and o_orderdate>DATE '1996-01-01' group by o_orderkey;
create or replace view aggJoin2645804125524252278 as select v21, v47, v38, v52 * annot as v52 from aggView2656605629245108991 join aggView160265145012676190 using(v21);
create or replace view semiJoinView6441255416163380038 as select s_suppkey as v47, s_nationkey as v8 from supplier_5 AS supplier_5 where (s_nationkey) in (select v8 from aggView6110518120419292560);
create or replace view semiJoinView8500818082392499811 as select v21, v47, v38, v52 from aggJoin2645804125524252278 where (v47) in (select v47 from semiJoinView6441255416163380038);
create or replace view semiEnum9089303700894683643 as select v8, v21, v38, SUM(v52) as v52 from semiJoinView8500818082392499811 join semiJoinView6441255416163380038 using(v47) group by v8,v21,v38;
select v38,v21,v2,SUM(v52 * annot) as v52 from semiEnum9089303700894683643 join aggView6110518120419292560 using(v8) group by v2, v21, v38;
