create or replace view aggView3919432502389096735 as select dst as v2, SUM(src) as v9, COUNT(*) as annot, src as v1 from Graph as g1 group by dst,src;
create or replace view aggJoin3570872353772717923 as select src as v2, dst as v4, v9, v1, annot from Graph as g2, aggView3919432502389096735 where g2.src=aggView3919432502389096735.v2;
create or replace view orderView6884453833669215682 as select src as v6, dst as v8, row_number() over (partition by src order by dst DESC) as rn from Graph as g4;
create or replace view minView5481943321177668679 as select v6, v8 as mfR7281057556794608409 from orderView6884453833669215682 where rn = 1;
create or replace view joinView1796846494401198528 as select src as v4, dst as v6, mfR7281057556794608409 from Graph AS g3, minView5481943321177668679 where g3.dst=minView5481943321177668679.v6;
create or replace view orderView6080150369944812713 as select v4, v6, mfR7281057556794608409, row_number() over (partition by v4 order by mfR7281057556794608409 DESC) as rn from joinView1796846494401198528;
create or replace view minView6183680253224390719 as select v4, mfR7281057556794608409 as mfR6488150178749177720 from orderView6080150369944812713 where rn = 1;
create or replace view joinView8389344330646010843 as select distinct v2, v4, v9, v1, annot, mfR6488150178749177720 from aggJoin3570872353772717923 join minView6183680253224390719 using(v4) where v1<mfR6488150178749177720;
create or replace view sample2577815196885956067 as select * from orderView6080150369944812713 where rn % 5 = 1;
create or replace view maxRn7030922833561544727 as select v4, max(rn) as mrn from joinView8389344330646010843 join sample2577815196885956067 using(v4) where v1<mfR7281057556794608409 group by v4;
create or replace view target4596271331944359685 as select v4, v6, mfR7281057556794608409 from orderView6080150369944812713 join maxRn7030922833561544727 using(v4) where rn < mrn + 5;
create or replace view end4962970722515786128 as select distinct v6, v9, v2, v1, mfR7281057556794608409 from joinView8389344330646010843 join target4596271331944359685 using(v4) where v1<mfR7281057556794608409 group by v6,v2,v1,mfR7281057556794608409;
create or replace view sample3782132636759783025 as select * from orderView6884453833669215682 where rn % 5 = 1;
create or replace view maxRn7747925014547052708 as select v6, max(rn) as mrn from end4962970722515786128 join sample3782132636759783025 using(v6) where v1<v8 group by v6;
create or replace view target5766552921961154457 as select v6, v8 from orderView6884453833669215682 join maxRn7747925014547052708 using(v6) where rn < mrn + 5;
create or replace view end6164703090339578381 as select v9, v2, v8 from end4962970722515786128 join target5766552921961154457 using(v6) where v1<v8 group by v2,v8;
select v2,v8,SUM(v9) as v9 from end6164703090339578381 group by v2, v8;
