create or replace view semiUp2241086707567855078 as select MessageId as v1 from Message_hasTag_Tag AS Message_hasTag_Tag where (MessageId) in (select MessageId from Person_likes_Message AS Person_likes_Message);
create or replace view semiUp4482099403366959627 as select MessageId as v1 from Message_hasCreator_Person AS Message_hasCreator_Person where (MessageId) in (select v1 from semiUp2241086707567855078);
create or replace view semiUp2277445500426894134 as select ParentMessageId as v1 from Comment_replyOf_Message AS Comment_replyOf_Message where (ParentMessageId) in (select v1 from semiUp4482099403366959627);
create or replace view semiDown4779396834640648517 as select v1 from semiUp4482099403366959627 where (v1) in (select v1 from semiUp2277445500426894134);
create or replace view semiDown2426246013810580644 as select v1 from semiUp2241086707567855078 where (v1) in (select v1 from semiDown4779396834640648517);
create or replace view semiDown6833897803057995998 as select MessageId as v1 from Person_likes_Message AS Person_likes_Message where (MessageId) in (select v1 from semiDown2426246013810580644);
create or replace view aggView534637861678271021 as select v1, COUNT(*) as annot from semiDown6833897803057995998 group by v1;
create or replace view aggJoin1536689637732196366 as select v1, annot from semiDown2426246013810580644 join aggView534637861678271021 using(v1);
create or replace view aggView7559251112280663919 as select v1, SUM(annot) as annot from aggJoin1536689637732196366 group by v1;
create or replace view aggJoin6128248763141472104 as select v1, annot from semiDown4779396834640648517 join aggView7559251112280663919 using(v1);
create or replace view aggView632054270383802307 as select v1, SUM(annot) as annot from aggJoin6128248763141472104 group by v1;
create or replace view aggJoin1150607182360976842 as select annot from semiUp2277445500426894134 join aggView632054270383802307 using(v1);
create or replace view res as select SUM(annot) as v9 from aggJoin1150607182360976842;
select sum(v9) from res;
