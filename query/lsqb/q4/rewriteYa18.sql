create or replace view semiUp8720007217014157826 as select MessageId as v1 from Message_hasTag_Tag AS Message_hasTag_Tag where (MessageId) in (select MessageId from Person_likes_Message AS Person_likes_Message);
create or replace view semiUp1342255679420799026 as select ParentMessageId as v1 from Comment_replyOf_Message AS Comment_replyOf_Message where (ParentMessageId) in (select v1 from semiUp8720007217014157826);
create or replace view semiUp2721945623718831943 as select MessageId as v1 from Message_hasCreator_Person AS Message_hasCreator_Person where (MessageId) in (select v1 from semiUp1342255679420799026);
create or replace view semiDown3308828895026989274 as select v1 from semiUp1342255679420799026 where (v1) in (select v1 from semiUp2721945623718831943);
create or replace view semiDown4846526899458708208 as select v1 from semiUp8720007217014157826 where (v1) in (select v1 from semiDown3308828895026989274);
create or replace view semiDown51041115979724554 as select MessageId as v1 from Person_likes_Message AS Person_likes_Message where (MessageId) in (select v1 from semiDown4846526899458708208);
create or replace view aggView6723012399863760577 as select v1, COUNT(*) as annot from semiDown51041115979724554 group by v1;
create or replace view aggJoin3617539757032409788 as select v1, annot from semiDown4846526899458708208 join aggView6723012399863760577 using(v1);
create or replace view aggView6293261772979383149 as select v1, SUM(annot) as annot from aggJoin3617539757032409788 group by v1;
create or replace view aggJoin272841849916330652 as select v1, annot from semiDown3308828895026989274 join aggView6293261772979383149 using(v1);
create or replace view aggView2309591138019093699 as select v1, SUM(annot) as annot from aggJoin272841849916330652 group by v1;
create or replace view aggJoin8848523115208037930 as select annot from semiUp2721945623718831943 join aggView2309591138019093699 using(v1);
create or replace view res as select SUM(annot) as v9 from aggJoin8848523115208037930;
select sum(v9) from res;
