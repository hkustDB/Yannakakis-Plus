create or replace view semiUp5488057886019204669 as select MessageId as v1 from Person_likes_Message AS Person_likes_Message where (MessageId) in (select MessageId from Message_hasTag_Tag AS Message_hasTag_Tag);
create or replace view semiUp2347223215110318395 as select MessageId as v1 from Message_hasCreator_Person AS Message_hasCreator_Person where (MessageId) in (select v1 from semiUp5488057886019204669);
create or replace view semiUp8687532301625518298 as select ParentMessageId as v1 from Comment_replyOf_Message AS Comment_replyOf_Message where (ParentMessageId) in (select v1 from semiUp2347223215110318395);
create or replace view semiDown2451592678685911565 as select v1 from semiUp2347223215110318395 where (v1) in (select v1 from semiUp8687532301625518298);
create or replace view semiDown5642387936362143991 as select v1 from semiUp5488057886019204669 where (v1) in (select v1 from semiDown2451592678685911565);
create or replace view semiDown8823090313806338412 as select MessageId as v1 from Message_hasTag_Tag AS Message_hasTag_Tag where (MessageId) in (select v1 from semiDown5642387936362143991);
create or replace view aggView8192830756131006452 as select v1, COUNT(*) as annot from semiDown8823090313806338412 group by v1;
create or replace view aggJoin3369764936354168787 as select v1, annot from semiDown5642387936362143991 join aggView8192830756131006452 using(v1);
create or replace view aggView7089697530734556010 as select v1, SUM(annot) as annot from aggJoin3369764936354168787 group by v1;
create or replace view aggJoin6799832039394734759 as select v1, annot from semiDown2451592678685911565 join aggView7089697530734556010 using(v1);
create or replace view aggView5853960645871158450 as select v1, SUM(annot) as annot from aggJoin6799832039394734759 group by v1;
create or replace view aggJoin1229811825024038077 as select annot from semiUp8687532301625518298 join aggView5853960645871158450 using(v1);
create or replace view res as select SUM(annot) as v9 from aggJoin1229811825024038077;
select sum(v9) from res;
