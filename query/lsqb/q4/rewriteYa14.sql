create or replace view semiUp5569771109551646460 as select MessageId as v1 from Person_likes_Message AS Person_likes_Message where (MessageId) in (select MessageId from Message_hasTag_Tag AS Message_hasTag_Tag);
create or replace view semiUp8834311615882970321 as select ParentMessageId as v1 from Comment_replyOf_Message AS Comment_replyOf_Message where (ParentMessageId) in (select v1 from semiUp5569771109551646460);
create or replace view semiUp1365193850668774873 as select MessageId as v1 from Message_hasCreator_Person AS Message_hasCreator_Person where (MessageId) in (select v1 from semiUp8834311615882970321);
create or replace view semiDown7950101234733515070 as select v1 from semiUp8834311615882970321 where (v1) in (select v1 from semiUp1365193850668774873);
create or replace view semiDown7779424146675260174 as select v1 from semiUp5569771109551646460 where (v1) in (select v1 from semiDown7950101234733515070);
create or replace view semiDown1005023450081415268 as select MessageId as v1 from Message_hasTag_Tag AS Message_hasTag_Tag where (MessageId) in (select v1 from semiDown7779424146675260174);
create or replace view aggView6221123382230505063 as select v1, COUNT(*) as annot from semiDown1005023450081415268 group by v1;
create or replace view aggJoin197261178385687752 as select v1, annot from semiDown7779424146675260174 join aggView6221123382230505063 using(v1);
create or replace view aggView5163262507978991907 as select v1, SUM(annot) as annot from aggJoin197261178385687752 group by v1;
create or replace view aggJoin2467433689852333497 as select v1, annot from semiDown7950101234733515070 join aggView5163262507978991907 using(v1);
create or replace view aggView9134255379164226912 as select v1, SUM(annot) as annot from aggJoin2467433689852333497 group by v1;
create or replace view aggJoin3720910060701319981 as select annot from semiUp1365193850668774873 join aggView9134255379164226912 using(v1);
create or replace view res as select SUM(annot) as v9 from aggJoin3720910060701319981;
select sum(v9) from res;
