create or replace view semiUp1710144912218010499 as select MessageId as v1 from Message_hasCreator_Person AS Message_hasCreator_Person where (MessageId) in (select MessageId from Person_likes_Message AS Person_likes_Message);
create or replace view semiUp4117055339908918334 as select MessageId as v1 from Message_hasTag_Tag AS Message_hasTag_Tag where (MessageId) in (select v1 from semiUp1710144912218010499);
create or replace view semiUp2893821868974644672 as select v1 from semiUp4117055339908918334 where (v1) in (select ParentMessageId from Comment_replyOf_Message AS Comment_replyOf_Message);
create or replace view semiDown6151522684979817817 as select ParentMessageId as v1 from Comment_replyOf_Message AS Comment_replyOf_Message where (ParentMessageId) in (select v1 from semiUp2893821868974644672);
create or replace view semiDown3116300685216404046 as select v1 from semiUp1710144912218010499 where (v1) in (select v1 from semiUp2893821868974644672);
create or replace view semiDown6237965715892432692 as select MessageId as v1 from Person_likes_Message AS Person_likes_Message where (MessageId) in (select v1 from semiDown3116300685216404046);
create or replace view aggView4938351403756911415 as select v1, COUNT(*) as annot from semiDown6151522684979817817 group by v1;
create or replace view aggJoin6573408229252711790 as select v1, annot from semiUp2893821868974644672 join aggView4938351403756911415 using(v1);
create or replace view aggView7420680544477793031 as select v1, COUNT(*) as annot from semiDown6237965715892432692 group by v1;
create or replace view aggJoin7482160122701057824 as select v1, annot from semiDown3116300685216404046 join aggView7420680544477793031 using(v1);
create or replace view aggView5710435935481213977 as select v1, SUM(annot) as annot from aggJoin7482160122701057824 group by v1;
create or replace view aggJoin2099272081987378835 as select aggJoin6573408229252711790.annot * aggView5710435935481213977.annot as annot from aggJoin6573408229252711790 join aggView5710435935481213977 using(v1);
create or replace view res as select SUM(annot) as v9 from aggJoin2099272081987378835;
select sum(v9) from res;
