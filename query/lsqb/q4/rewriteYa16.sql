create or replace view semiUp1003705985075412139 as select MessageId as v1 from Message_hasCreator_Person AS Message_hasCreator_Person where (MessageId) in (select MessageId from Person_likes_Message AS Person_likes_Message);
create or replace view semiUp5753836752453609083 as select MessageId as v1 from Message_hasTag_Tag AS Message_hasTag_Tag where (MessageId) in (select v1 from semiUp1003705985075412139);
create or replace view semiUp5453640232335733500 as select ParentMessageId as v1 from Comment_replyOf_Message AS Comment_replyOf_Message where (ParentMessageId) in (select v1 from semiUp5753836752453609083);
create or replace view semiDown5046346703985362190 as select v1 from semiUp5753836752453609083 where (v1) in (select v1 from semiUp5453640232335733500);
create or replace view semiDown1131370369877563568 as select v1 from semiUp1003705985075412139 where (v1) in (select v1 from semiDown5046346703985362190);
create or replace view semiDown2407311090669751452 as select MessageId as v1 from Person_likes_Message AS Person_likes_Message where (MessageId) in (select v1 from semiDown1131370369877563568);
create or replace view aggView3996536902629114523 as select v1, COUNT(*) as annot from semiDown2407311090669751452 group by v1;
create or replace view aggJoin1716542453748367812 as select v1, annot from semiDown1131370369877563568 join aggView3996536902629114523 using(v1);
create or replace view aggView2120354869892448297 as select v1, SUM(annot) as annot from aggJoin1716542453748367812 group by v1;
create or replace view aggJoin619496101494653880 as select v1, annot from semiDown5046346703985362190 join aggView2120354869892448297 using(v1);
create or replace view aggView6162799163121361998 as select v1, SUM(annot) as annot from aggJoin619496101494653880 group by v1;
create or replace view aggJoin6630733594987317930 as select annot from semiUp5453640232335733500 join aggView6162799163121361998 using(v1);
create or replace view res as select SUM(annot) as v9 from aggJoin6630733594987317930;
select sum(v9) from res;
