create or replace view semiUp4450521963586005324 as select MessageId as v1 from Person_likes_Message AS Person_likes_Message where (MessageId) in (select ParentMessageId from Comment_replyOf_Message AS Comment_replyOf_Message);
create or replace view semiUp7667712756883274082 as select MessageId as v1 from Message_hasCreator_Person AS Message_hasCreator_Person where (MessageId) in (select v1 from semiUp4450521963586005324);
create or replace view semiUp7436633127453680026 as select MessageId as v1 from Message_hasTag_Tag AS Message_hasTag_Tag where (MessageId) in (select v1 from semiUp7667712756883274082);
create or replace view semiDown1968309487164505216 as select v1 from semiUp7667712756883274082 where (v1) in (select v1 from semiUp7436633127453680026);
create or replace view semiDown3013671007399424823 as select v1 from semiUp4450521963586005324 where (v1) in (select v1 from semiDown1968309487164505216);
create or replace view semiDown1966390799672159854 as select ParentMessageId as v1 from Comment_replyOf_Message AS Comment_replyOf_Message where (ParentMessageId) in (select v1 from semiDown3013671007399424823);
create or replace view aggView1209573737766693677 as select v1, COUNT(*) as annot from semiDown1966390799672159854 group by v1;
create or replace view aggJoin5173477535128402516 as select v1, annot from semiDown3013671007399424823 join aggView1209573737766693677 using(v1);
create or replace view aggView4642423956607818082 as select v1, SUM(annot) as annot from aggJoin5173477535128402516 group by v1;
create or replace view aggJoin7195160993015162517 as select v1, annot from semiDown1968309487164505216 join aggView4642423956607818082 using(v1);
create or replace view aggView8086155589903354154 as select v1, SUM(annot) as annot from aggJoin7195160993015162517 group by v1;
create or replace view aggJoin54775155944506415 as select annot from semiUp7436633127453680026 join aggView8086155589903354154 using(v1);
create or replace view res as select SUM(annot) as v9 from aggJoin54775155944506415;
select sum(v9) from res;
