create or replace view semiUp131062419971713365 as select ParentMessageId as v1 from Comment_replyOf_Message AS Comment_replyOf_Message where (ParentMessageId) in (select MessageId from Message_hasTag_Tag AS Message_hasTag_Tag);
create or replace view semiUp620363811570013787 as select MessageId as v1 from Person_likes_Message AS Person_likes_Message where (MessageId) in (select v1 from semiUp131062419971713365);
create or replace view semiUp5987365088135686649 as select MessageId as v1 from Message_hasCreator_Person AS Message_hasCreator_Person where (MessageId) in (select v1 from semiUp620363811570013787);
create or replace view semiDown7805090986205847972 as select v1 from semiUp620363811570013787 where (v1) in (select v1 from semiUp5987365088135686649);
create or replace view semiDown1152792537415005448 as select v1 from semiUp131062419971713365 where (v1) in (select v1 from semiDown7805090986205847972);
create or replace view semiDown6093631591732768644 as select MessageId as v1 from Message_hasTag_Tag AS Message_hasTag_Tag where (MessageId) in (select v1 from semiDown1152792537415005448);
create or replace view aggView3624013170114003567 as select v1, COUNT(*) as annot from semiDown6093631591732768644 group by v1;
create or replace view aggJoin3599930853736502210 as select v1, annot from semiDown1152792537415005448 join aggView3624013170114003567 using(v1);
create or replace view aggView4815602925814474792 as select v1, SUM(annot) as annot from aggJoin3599930853736502210 group by v1;
create or replace view aggJoin1906496269753920640 as select v1, annot from semiDown7805090986205847972 join aggView4815602925814474792 using(v1);
create or replace view aggView7155278766234153987 as select v1, SUM(annot) as annot from aggJoin1906496269753920640 group by v1;
create or replace view aggJoin7629489569741494652 as select annot from semiUp5987365088135686649 join aggView7155278766234153987 using(v1);
create or replace view res as select SUM(annot) as v9 from aggJoin7629489569741494652;
select sum(v9) from res;
