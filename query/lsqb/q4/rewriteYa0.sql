create or replace view semiUp5694620028941415861 as select MessageId as v1 from Message_hasCreator_Person AS Message_hasCreator_Person where (MessageId) in (select MessageId from Person_likes_Message AS Person_likes_Message);
create or replace view semiUp6405325601585782199 as select ParentMessageId as v1 from Comment_replyOf_Message AS Comment_replyOf_Message where (ParentMessageId) in (select v1 from semiUp5694620028941415861);
create or replace view semiUp4114009068374610590 as select MessageId as v1 from Message_hasTag_Tag AS Message_hasTag_Tag where (MessageId) in (select v1 from semiUp6405325601585782199);
create or replace view semiDown5965375316204024733 as select v1 from semiUp6405325601585782199 where (v1) in (select v1 from semiUp4114009068374610590);
create or replace view semiDown7679220523465973432 as select v1 from semiUp5694620028941415861 where (v1) in (select v1 from semiDown5965375316204024733);
create or replace view semiDown5984085747985032582 as select MessageId as v1 from Person_likes_Message AS Person_likes_Message where (MessageId) in (select v1 from semiDown7679220523465973432);
create or replace view aggView529392990145349530 as select v1, COUNT(*) as annot from semiDown5984085747985032582 group by v1;
create or replace view aggJoin243453949203737666 as select v1, annot from semiDown7679220523465973432 join aggView529392990145349530 using(v1);
create or replace view aggView7694773168486948120 as select v1, SUM(annot) as annot from aggJoin243453949203737666 group by v1;
create or replace view aggJoin1745816548539430958 as select v1, annot from semiDown5965375316204024733 join aggView7694773168486948120 using(v1);
create or replace view aggView375167050396913971 as select v1, SUM(annot) as annot from aggJoin1745816548539430958 group by v1;
create or replace view aggJoin7324302777177028604 as select annot from semiUp4114009068374610590 join aggView375167050396913971 using(v1);
create or replace view res as select SUM(annot) as v9 from aggJoin7324302777177028604;
select sum(v9) from res;
