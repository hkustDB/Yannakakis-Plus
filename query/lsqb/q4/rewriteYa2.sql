create or replace view semiUp5598330832581147782 as select MessageId as v1 from Person_likes_Message AS Person_likes_Message where (MessageId) in (select MessageId from Message_hasCreator_Person AS Message_hasCreator_Person);
create or replace view semiUp5790194074938762 as select MessageId as v1 from Message_hasTag_Tag AS Message_hasTag_Tag where (MessageId) in (select v1 from semiUp5598330832581147782);
create or replace view semiUp7775705377491381893 as select ParentMessageId as v1 from Comment_replyOf_Message AS Comment_replyOf_Message where (ParentMessageId) in (select v1 from semiUp5790194074938762);
create or replace view semiDown6126502158395208819 as select v1 from semiUp5790194074938762 where (v1) in (select v1 from semiUp7775705377491381893);
create or replace view semiDown323760735838944414 as select v1 from semiUp5598330832581147782 where (v1) in (select v1 from semiDown6126502158395208819);
create or replace view semiDown5801071200688843266 as select MessageId as v1 from Message_hasCreator_Person AS Message_hasCreator_Person where (MessageId) in (select v1 from semiDown323760735838944414);
create or replace view aggView5638091537989436710 as select v1 from semiDown5801071200688843266;
create or replace view aggJoin5243454382107576187 as select v1 from semiDown323760735838944414 join aggView5638091537989436710 using(v1);
create or replace view aggView9092996802702696972 as select v1, COUNT(*) as annot from aggJoin5243454382107576187 group by v1;
create or replace view aggJoin2139976349360826303 as select v1, annot from semiDown6126502158395208819 join aggView9092996802702696972 using(v1);
create or replace view aggView3593289600346952829 as select v1, SUM(annot) as annot from aggJoin2139976349360826303 group by v1;
create or replace view aggJoin1704741358763382328 as select annot from semiUp7775705377491381893 join aggView3593289600346952829 using(v1);
create or replace view res as select SUM(annot) as v9 from aggJoin1704741358763382328;
select sum(v9) from res;
