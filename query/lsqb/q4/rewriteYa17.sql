create or replace view semiUp334880187514150743 as select MessageId as v1 from Person_likes_Message AS Person_likes_Message where (MessageId) in (select ParentMessageId from Comment_replyOf_Message AS Comment_replyOf_Message);
create or replace view semiUp1022650018391069593 as select MessageId as v1 from Message_hasTag_Tag AS Message_hasTag_Tag where (MessageId) in (select v1 from semiUp334880187514150743);
create or replace view semiUp3502320654344130617 as select MessageId as v1 from Message_hasCreator_Person AS Message_hasCreator_Person where (MessageId) in (select v1 from semiUp1022650018391069593);
create or replace view semiDown7245010434890598798 as select v1 from semiUp1022650018391069593 where (v1) in (select v1 from semiUp3502320654344130617);
create or replace view semiDown4447326802370310440 as select v1 from semiUp334880187514150743 where (v1) in (select v1 from semiDown7245010434890598798);
create or replace view semiDown3218778445222385271 as select ParentMessageId as v1 from Comment_replyOf_Message AS Comment_replyOf_Message where (ParentMessageId) in (select v1 from semiDown4447326802370310440);
create or replace view aggView6398708072040659258 as select v1, COUNT(*) as annot from semiDown3218778445222385271 group by v1;
create or replace view aggJoin163054385073846883 as select v1, annot from semiDown4447326802370310440 join aggView6398708072040659258 using(v1);
create or replace view aggView6192778223769782702 as select v1, SUM(annot) as annot from aggJoin163054385073846883 group by v1;
create or replace view aggJoin6188592858370005980 as select v1, annot from semiDown7245010434890598798 join aggView6192778223769782702 using(v1);
create or replace view aggView2192572516932734932 as select v1, SUM(annot) as annot from aggJoin6188592858370005980 group by v1;
create or replace view aggJoin4319020453484759659 as select annot from semiUp3502320654344130617 join aggView2192572516932734932 using(v1);
create or replace view res as select SUM(annot) as v9 from aggJoin4319020453484759659;
select sum(v9) from res;
