create or replace view semiUp8958314083660216733 as select MessageId as v1 from Message_hasCreator_Person AS Message_hasCreator_Person where (MessageId) in (select MessageId from Message_hasTag_Tag AS Message_hasTag_Tag);
create or replace view semiUp8768282004612179303 as select ParentMessageId as v1 from Comment_replyOf_Message AS Comment_replyOf_Message where (ParentMessageId) in (select v1 from semiUp8958314083660216733);
create or replace view semiUp6218543692627074611 as select MessageId as v1 from Person_likes_Message AS Person_likes_Message where (MessageId) in (select v1 from semiUp8768282004612179303);
create or replace view semiDown6062327537266935324 as select v1 from semiUp8768282004612179303 where (v1) in (select v1 from semiUp6218543692627074611);
create or replace view semiDown7959668544083499974 as select v1 from semiUp8958314083660216733 where (v1) in (select v1 from semiDown6062327537266935324);
create or replace view semiDown6002083479881381325 as select MessageId as v1 from Message_hasTag_Tag AS Message_hasTag_Tag where (MessageId) in (select v1 from semiDown7959668544083499974);
create or replace view aggView6292348845423185475 as select v1, COUNT(*) as annot from semiDown6002083479881381325 group by v1;
create or replace view aggJoin2165932933740966723 as select v1, annot from semiDown7959668544083499974 join aggView6292348845423185475 using(v1);
create or replace view aggView543813832849399071 as select v1, SUM(annot) as annot from aggJoin2165932933740966723 group by v1;
create or replace view aggJoin1658894372531610137 as select v1, annot from semiDown6062327537266935324 join aggView543813832849399071 using(v1);
create or replace view aggView5611456223543518212 as select v1, SUM(annot) as annot from aggJoin1658894372531610137 group by v1;
create or replace view aggJoin4419826727959218858 as select annot from semiUp6218543692627074611 join aggView5611456223543518212 using(v1);
create or replace view res as select SUM(annot) as v9 from aggJoin4419826727959218858;
select sum(v9) from res;
