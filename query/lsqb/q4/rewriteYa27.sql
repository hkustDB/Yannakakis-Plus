create or replace view semiUp8241959643789647545 as select MessageId as v1 from Message_hasCreator_Person AS Message_hasCreator_Person where (MessageId) in (select ParentMessageId from Comment_replyOf_Message AS Comment_replyOf_Message);
create or replace view semiUp32916444605104547 as select MessageId as v1 from Person_likes_Message AS Person_likes_Message where (MessageId) in (select MessageId from Message_hasTag_Tag AS Message_hasTag_Tag);
create or replace view semiUp5893970672545175185 as select v1 from semiUp32916444605104547 where (v1) in (select v1 from semiUp8241959643789647545);
create or replace view semiDown8292920243142097471 as select MessageId as v1 from Message_hasTag_Tag AS Message_hasTag_Tag where (MessageId) in (select v1 from semiUp5893970672545175185);
create or replace view semiDown5641993666615523318 as select v1 from semiUp8241959643789647545 where (v1) in (select v1 from semiUp5893970672545175185);
create or replace view semiDown7815780451755634257 as select ParentMessageId as v1 from Comment_replyOf_Message AS Comment_replyOf_Message where (ParentMessageId) in (select v1 from semiDown5641993666615523318);
create or replace view aggView5943812946056464223 as select v1, COUNT(*) as annot from semiDown7815780451755634257 group by v1;
create or replace view aggJoin5211484397217878089 as select v1, annot from semiDown5641993666615523318 join aggView5943812946056464223 using(v1);
create or replace view aggView2832417819216909559 as select v1, COUNT(*) as annot from semiDown8292920243142097471 group by v1;
create or replace view aggJoin3199091549963374427 as select v1, annot from semiUp5893970672545175185 join aggView2832417819216909559 using(v1);
create or replace view aggView8896094981219041608 as select v1, SUM(annot) as annot from aggJoin5211484397217878089 group by v1;
create or replace view aggJoin7125558330890808249 as select aggJoin3199091549963374427.annot * aggView8896094981219041608.annot as annot from aggJoin3199091549963374427 join aggView8896094981219041608 using(v1);
create or replace view res as select SUM(annot) as v9 from aggJoin7125558330890808249;
select sum(v9) from res;
