create or replace view semiUp2762172181150628151 as select MessageId as v1 from Message_hasCreator_Person AS Message_hasCreator_Person where (MessageId) in (select MessageId from Message_hasTag_Tag AS Message_hasTag_Tag);
create or replace view semiUp4333788476600588660 as select MessageId as v1 from Person_likes_Message AS Person_likes_Message where (MessageId) in (select v1 from semiUp2762172181150628151);
create or replace view semiUp8770626811600873700 as select ParentMessageId as v1 from Comment_replyOf_Message AS Comment_replyOf_Message where (ParentMessageId) in (select v1 from semiUp4333788476600588660);
create or replace view semiDown7142485909428091047 as select v1 from semiUp4333788476600588660 where (v1) in (select v1 from semiUp8770626811600873700);
create or replace view semiDown2742221870231926791 as select v1 from semiUp2762172181150628151 where (v1) in (select v1 from semiDown7142485909428091047);
create or replace view semiDown6491135580861439321 as select MessageId as v1 from Message_hasTag_Tag AS Message_hasTag_Tag where (MessageId) in (select v1 from semiDown2742221870231926791);
create or replace view aggView5023922409800584498 as select v1, COUNT(*) as annot from semiDown6491135580861439321 group by v1;
create or replace view aggJoin7434216012966092049 as select v1, annot from semiDown2742221870231926791 join aggView5023922409800584498 using(v1);
create or replace view aggView1352326443131328233 as select v1, SUM(annot) as annot from aggJoin7434216012966092049 group by v1;
create or replace view aggJoin8822283161593295708 as select v1, annot from semiDown7142485909428091047 join aggView1352326443131328233 using(v1);
create or replace view aggView1512907609619111829 as select v1, SUM(annot) as annot from aggJoin8822283161593295708 group by v1;
create or replace view aggJoin2080361085306283646 as select annot from semiUp8770626811600873700 join aggView1512907609619111829 using(v1);
create or replace view res as select SUM(annot) as v9 from aggJoin2080361085306283646;
select sum(v9) from res;
