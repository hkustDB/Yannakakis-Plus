create or replace view semiUp1063318984140065920 as select MessageId as v1 from Message_hasTag_Tag AS Message_hasTag_Tag where (MessageId) in (select ParentMessageId from Comment_replyOf_Message AS Comment_replyOf_Message);
create or replace view semiUp7337739504807526108 as select MessageId as v1 from Message_hasCreator_Person AS Message_hasCreator_Person where (MessageId) in (select MessageId from Person_likes_Message AS Person_likes_Message);
create or replace view semiUp1751414887884205240 as select v1 from semiUp7337739504807526108 where (v1) in (select v1 from semiUp1063318984140065920);
create or replace view semiDown613086471329604766 as select v1 from semiUp1063318984140065920 where (v1) in (select v1 from semiUp1751414887884205240);
create or replace view semiDown8531974225591310383 as select MessageId as v1 from Person_likes_Message AS Person_likes_Message where (MessageId) in (select v1 from semiUp1751414887884205240);
create or replace view semiDown8234633386316556612 as select ParentMessageId as v1 from Comment_replyOf_Message AS Comment_replyOf_Message where (ParentMessageId) in (select v1 from semiDown613086471329604766);
create or replace view aggView7086717889538289823 as select v1, COUNT(*) as annot from semiDown8234633386316556612 group by v1;
create or replace view aggJoin1290359138799367706 as select v1, annot from semiDown613086471329604766 join aggView7086717889538289823 using(v1);
create or replace view aggView3044854054004530847 as select v1, SUM(annot) as annot from aggJoin1290359138799367706 group by v1;
create or replace view aggJoin628971253652462655 as select v1, annot from semiUp1751414887884205240 join aggView3044854054004530847 using(v1);
create or replace view aggView1874843412882099767 as select v1, COUNT(*) as annot from semiDown8531974225591310383 group by v1;
create or replace view aggJoin8318773625368202400 as select aggJoin628971253652462655.annot * aggView1874843412882099767.annot as annot from aggJoin628971253652462655 join aggView1874843412882099767 using(v1);
create or replace view res as select SUM(annot) as v9 from aggJoin8318773625368202400;
select sum(v9) from res;
