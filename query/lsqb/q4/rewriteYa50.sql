create or replace view semiUp4992026059156109193 as select MessageId as v1 from Person_likes_Message AS Person_likes_Message where (MessageId) in (select (MessageId) from Message_hasTag_Tag AS Message_hasTag_Tag);
create or replace view semiUp1705496126073261972 as select v1 from semiUp4992026059156109193 where (v1) in (select (ParentMessageId) from Comment_replyOf_Message AS Comment_replyOf_Message);
create or replace view semiUp7194376033381430929 as select MessageId as v1 from Message_hasCreator_Person AS Message_hasCreator_Person where (MessageId) in (select (v1) from semiUp1705496126073261972);
create or replace view semiDown8426817827920692319 as select v1 from semiUp1705496126073261972 where (v1) in (select (v1) from semiUp7194376033381430929);
create or replace view semiDown7078699958768790854 as select MessageId as v1 from Message_hasTag_Tag AS Message_hasTag_Tag where (MessageId) in (select (v1) from semiDown8426817827920692319);
create or replace view semiDown2380825486293070152 as select ParentMessageId as v1 from Comment_replyOf_Message AS Comment_replyOf_Message where (ParentMessageId) in (select (v1) from semiDown8426817827920692319);
create or replace view aggView1252407392484346842 as select v1, COUNT(*) as annot from semiDown7078699958768790854 group by v1;
create or replace view aggJoin5540941055484884004 as select v1, annot from semiDown8426817827920692319 join aggView1252407392484346842 using(v1);
create or replace view aggView8617522588753260305 as select v1, COUNT(*) as annot from semiDown2380825486293070152 group by v1;
create or replace view aggJoin4739988993472454818 as select v1, aggJoin5540941055484884004.annot * aggView8617522588753260305.annot as annot from aggJoin5540941055484884004 join aggView8617522588753260305 using(v1);
create or replace view aggView6979892437602347518 as select v1, SUM(annot) as annot from aggJoin4739988993472454818 group by v1;
create or replace view aggJoin6490402575960957496 as select annot from semiUp7194376033381430929 join aggView6979892437602347518 using(v1);
select SUM(annot) as v9 from aggJoin6490402575960957496;
