create or replace view semiUp355629189225139890 as select MessageId as v1, TagId as v2 from Message_hasTag_Tag AS Message_hasTag_Tag where (TagId) in (select (TagId) from Comment_hasTag_Tag AS cht1);
create or replace view semiUp7562854586712658976 as select CommentId as v3, ParentMessageId as v1 from Comment_replyOf_Message AS Comment_replyOf_Message where (ParentMessageId) in (select (v1) from semiUp355629189225139890);
create or replace view semiUp1425738640151510073 as select CommentId as v3, TagId as cht_TagId from Comment_hasTag_Tag AS cht2 where (CommentId) in (select (v3) from semiUp7562854586712658976);
create or replace view semiDown9178640173833501353 as select v3, v1 from semiUp7562854586712658976 where (v3) in (select (v3) from semiUp1425738640151510073);
create or replace view semiDown838569525986814862 as select v1, v2 from semiUp355629189225139890 where (v1) in (select (v1) from semiDown9178640173833501353);
create or replace view semiDown7313440948518917487 as select TagId as v2 from Comment_hasTag_Tag AS cht1 where (TagId) in (select (v2) from semiDown838569525986814862);
create or replace view aggView2964554186361799866 as select v2, COUNT(*) as annot from semiDown7313440948518917487 group by v2;
create or replace view aggJoin651217259932641454 as select v1, v2, annot from semiDown838569525986814862 join aggView2964554186361799866 using(v2);
create or replace view aggView6261974814036963424 as select v1, v2, SUM(annot) as annot from aggJoin651217259932641454 group by v1, v2;
create or replace view aggJoin8838190940641430126 as select v3, v2, annot from semiDown9178640173833501353 join aggView6261974814036963424 using(v1);
create or replace view aggView8404680705765615710 as select v3, v2, SUM(annot) as annot from aggJoin8838190940641430126 group by v3, v2;
create or replace view aggJoin2879908207729345077 as select annot from semiUp1425738640151510073 join aggView8404680705765615710 using(v3) where v2 < cht_TagId;
select SUM(annot) as v9 from aggJoin2879908207729345077;
