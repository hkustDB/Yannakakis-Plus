create or replace view semiUp5191538638643204723 as select CityId as v6, isPartOf_CountryId as v4 from City AS City where (isPartOf_CountryId) in (select CountryId from Country AS Country);
create or replace view semiUp6029297736884107258 as select PersonId as v8, isLocatedIn_CityId as v6 from Person AS Person where (isLocatedIn_CityId) in (select v6 from semiUp5191538638643204723);
create or replace view semiUp6951452008736481136 as select PostId as v18, Forum_containerOfId as v9 from Post AS Post where (Forum_containerOfId) in (select ForumId from Forum AS Forum);
create or replace view semiUp3142603385759998037 as select TagId as v22, hasType_TagClassId as v23 from Tag AS Tag where (hasType_TagClassId) in (select TagClassId from TagClass AS TagClass);
create or replace view semiUp5368721581513751413 as select CommentId as v20, TagId as v22 from Comment_hasTag_Tag AS Comment_hasTag_Tag where (TagId) in (select v22 from semiUp3142603385759998037);
create or replace view semiUp845474163306442233 as select CommentId as v20, replyOf_PostId as v18 from Comment AS Comment where (CommentId) in (select v20 from semiUp5368721581513751413);
create or replace view semiUp4214082588094625569 as select ForumId as v9, PersonId as v8 from Forum_hasMember_Person AS Forum_hasMember_Person where (PersonId) in (select v8 from semiUp6029297736884107258);
create or replace view semiUp6838362918055876149 as select v18, v9 from semiUp6951452008736481136 where (v9) in (select v9 from semiUp4214082588094625569);
create or replace view semiUp5593570893202222272 as select v20, v18 from semiUp845474163306442233 where (v18) in (select v18 from semiUp6838362918055876149);
create or replace view semiDown7286491632911217906 as select v20, v22 from semiUp5368721581513751413 where (v20) in (select v20 from semiUp5593570893202222272);
create or replace view semiDown1132711571894743079 as select v18, v9 from semiUp6838362918055876149 where (v18) in (select v18 from semiUp5593570893202222272);
create or replace view semiDown5762396388234586305 as select v22, v23 from semiUp3142603385759998037 where (v22) in (select v22 from semiDown7286491632911217906);
create or replace view semiDown3090725587684329740 as select ForumId as v9 from Forum AS Forum where (ForumId) in (select v9 from semiDown1132711571894743079);
create or replace view semiDown1332776624388982214 as select v9, v8 from semiUp4214082588094625569 where (v9) in (select v9 from semiDown1132711571894743079);
create or replace view semiDown1129747109173533588 as select TagClassId as v23 from TagClass AS TagClass where (TagClassId) in (select v23 from semiDown5762396388234586305);
create or replace view semiDown4431125348064691308 as select v8, v6 from semiUp6029297736884107258 where (v8) in (select v8 from semiDown1332776624388982214);
create or replace view semiDown5496760918816132242 as select v6, v4 from semiUp5191538638643204723 where (v6) in (select v6 from semiDown4431125348064691308);
create or replace view semiDown4425257915280055414 as select CountryId as v4 from Country AS Country where (CountryId) in (select v4 from semiDown5496760918816132242);
create or replace view aggView8438902278880836676 as select v9 from semiDown3090725587684329740;
create or replace view aggJoin7269785739887796587 as select v18, v9 from semiDown1132711571894743079 join aggView8438902278880836676 using(v9);
create or replace view aggView7206562701627525753 as select v4 from semiDown4425257915280055414;
create or replace view aggJoin4119215894207665304 as select v6 from semiDown5496760918816132242 join aggView7206562701627525753 using(v4);
create or replace view aggView6601331866374589765 as select v6, COUNT(*) as annot from aggJoin4119215894207665304 group by v6;
create or replace view aggJoin8138175119851995981 as select v8, annot from semiDown4431125348064691308 join aggView6601331866374589765 using(v6);
create or replace view aggView767430620814143032 as select v8, SUM(annot) as annot from aggJoin8138175119851995981 group by v8;
create or replace view aggJoin4878021117415124940 as select v9, annot from semiDown1332776624388982214 join aggView767430620814143032 using(v8);
create or replace view aggView967937343791422797 as select v9, SUM(annot) as annot from aggJoin4878021117415124940 group by v9;
create or replace view aggJoin6270864511489944292 as select v18, annot from aggJoin7269785739887796587 join aggView967937343791422797 using(v9);
create or replace view aggView5757442947926225442 as select v18, SUM(annot) as annot from aggJoin6270864511489944292 group by v18;
create or replace view aggJoin4109676507936688114 as select v20, annot from semiUp5593570893202222272 join aggView5757442947926225442 using(v18);
create or replace view aggView6455857900753788449 as select v23 from semiDown1129747109173533588;
create or replace view aggJoin6880549253955568194 as select v22 from semiDown5762396388234586305 join aggView6455857900753788449 using(v23);
create or replace view aggView8746557319548933501 as select v22, COUNT(*) as annot from aggJoin6880549253955568194 group by v22;
create or replace view aggJoin3935558127514123574 as select v20, annot from semiDown7286491632911217906 join aggView8746557319548933501 using(v22);
create or replace view aggView3990754736541593202 as select v20, SUM(annot) as annot from aggJoin3935558127514123574 group by v20;
create or replace view aggJoin2145287048204083285 as select aggJoin4109676507936688114.annot * aggView3990754736541593202.annot as annot from aggJoin4109676507936688114 join aggView3990754736541593202 using(v20);
create or replace view res as select SUM(annot) as v26 from aggJoin2145287048204083285;
select sum(v26) from res;
