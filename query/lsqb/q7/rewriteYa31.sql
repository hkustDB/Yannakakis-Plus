create or replace view semiUp4023800648580125252 as select MessageId as v1 from Message_hasTag_Tag AS Message_hasTag_Tag where (MessageId) in (select (MessageId) from Person_likes_Message AS Person_likes_Message);
create or replace view semiUp2621883232997725020 as select MessageId as v1 from Message_hasCreator_Person AS Message_hasCreator_Person where (MessageId) in (select (v1) from semiUp4023800648580125252);
create or replace view semiUp7076365521638564273 as select v1 from semiUp2621883232997725020 where (v1) in (select (ParentMessageId) from Comment_replyOf_Message AS Comment_replyOf_Message);
create or replace view semiDown7446929771657820746 as select ParentMessageId as v1 from Comment_replyOf_Message AS Comment_replyOf_Message where (ParentMessageId) in (select (v1) from semiUp7076365521638564273);
create or replace view semiDown7210399416269520102 as select v1 from semiUp4023800648580125252 where (v1) in (select (v1) from semiUp7076365521638564273);
create or replace view semiDown1791785922946457762 as select MessageId as v1 from Person_likes_Message AS Person_likes_Message where (MessageId) in (select (v1) from semiDown7210399416269520102);
create or replace view aggView5464832500103891874 as select v1, COUNT(*) as annot from semiDown7446929771657820746 group by v1;
create or replace view aggJoin6971954775482309236 as select v1, annot from semiUp7076365521638564273 join aggView5464832500103891874 using(v1);
create or replace view aggView4216257683331835744 as select v1, COUNT(*) as annot from semiDown1791785922946457762 group by v1;
create or replace view aggJoin5407597925746964876 as select v1, annot from semiDown7210399416269520102 join aggView4216257683331835744 using(v1);
create or replace view aggView4540691158039884765 as select v1, SUM(annot) as annot from aggJoin5407597925746964876 group by v1;
create or replace view aggJoin3894985446708510181 as select aggJoin6971954775482309236.annot * aggView4540691158039884765.annot as annot from aggJoin6971954775482309236 join aggView4540691158039884765 using(v1);
select SUM(annot) as v9 from aggJoin3894985446708510181;
