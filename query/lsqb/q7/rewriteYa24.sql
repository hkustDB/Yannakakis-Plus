create or replace view semiUp6546342593708858585 as select MessageId as v1 from Message_hasCreator_Person AS Message_hasCreator_Person where (MessageId) in (select MessageId from Person_likes_Message AS Person_likes_Message);
create or replace view semiUp2406937927670773848 as select ParentMessageId as v1 from Comment_replyOf_Message AS Comment_replyOf_Message where (ParentMessageId) in (select MessageId from Message_hasTag_Tag AS Message_hasTag_Tag);
create or replace view semiUp1129041321052811719 as select v1 from semiUp2406937927670773848 where (v1) in (select v1 from semiUp6546342593708858585);
create or replace view semiDown2433970066795421241 as select MessageId as v1 from Message_hasTag_Tag AS Message_hasTag_Tag where (MessageId) in (select v1 from semiUp1129041321052811719);
create or replace view semiDown397113751081648455 as select v1 from semiUp6546342593708858585 where (v1) in (select v1 from semiUp1129041321052811719);
create or replace view semiDown1735548185801925401 as select MessageId as v1 from Person_likes_Message AS Person_likes_Message where (MessageId) in (select v1 from semiDown397113751081648455);
create or replace view aggView4368103425889553503 as select v1, COUNT(*) as annot from semiDown2433970066795421241 group by v1;
create or replace view aggJoin2732230604550072796 as select v1, annot from semiUp1129041321052811719 join aggView4368103425889553503 using(v1);
create or replace view aggView4432081898490677227 as select v1, COUNT(*) as annot from semiDown1735548185801925401 group by v1;
create or replace view aggJoin4195787282205369863 as select v1, annot from semiDown397113751081648455 join aggView4432081898490677227 using(v1);
create or replace view aggView5314174486473084721 as select v1, SUM(annot) as annot from aggJoin4195787282205369863 group by v1;
create or replace view aggJoin7754199000796964307 as select aggJoin2732230604550072796.annot * aggView5314174486473084721.annot as annot from aggJoin2732230604550072796 join aggView5314174486473084721 using(v1);
create or replace view res as select SUM(annot) as v9 from aggJoin7754199000796964307;
select sum(v9) from res;
