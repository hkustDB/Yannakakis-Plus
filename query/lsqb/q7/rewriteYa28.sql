create or replace view semiUp5338563109557214438 as select MessageId as v1 from Message_hasTag_Tag AS Message_hasTag_Tag where (MessageId) in (select MessageId from Person_likes_Message AS Person_likes_Message);
create or replace view semiUp3982929543849974221 as select MessageId as v1 from Message_hasCreator_Person AS Message_hasCreator_Person where (MessageId) in (select v1 from semiUp5338563109557214438);
create or replace view semiUp2604849022161882926 as select v1 from semiUp3982929543849974221 where (v1) in (select ParentMessageId from Comment_replyOf_Message AS Comment_replyOf_Message);
create or replace view semiDown3301870744770868691 as select ParentMessageId as v1 from Comment_replyOf_Message AS Comment_replyOf_Message where (ParentMessageId) in (select v1 from semiUp2604849022161882926);
create or replace view semiDown4535998517898127812 as select v1 from semiUp5338563109557214438 where (v1) in (select v1 from semiUp2604849022161882926);
create or replace view semiDown6322488297610612872 as select MessageId as v1 from Person_likes_Message AS Person_likes_Message where (MessageId) in (select v1 from semiDown4535998517898127812);
create or replace view aggView4459456661742623738 as select v1, COUNT(*) as annot from semiDown6322488297610612872 group by v1;
create or replace view aggJoin1251342484060845237 as select v1, annot from semiDown4535998517898127812 join aggView4459456661742623738 using(v1);
create or replace view aggView8335542278743422776 as select v1, SUM(annot) as annot from aggJoin1251342484060845237 group by v1;
create or replace view aggJoin6926777989804327291 as select v1, annot from semiUp2604849022161882926 join aggView8335542278743422776 using(v1);
create or replace view aggView45341657470967453 as select v1, COUNT(*) as annot from semiDown3301870744770868691 group by v1;
create or replace view aggJoin4962359091824187112 as select aggJoin6926777989804327291.annot * aggView45341657470967453.annot as annot from aggJoin6926777989804327291 join aggView45341657470967453 using(v1);
create or replace view res as select SUM(annot) as v9 from aggJoin4962359091824187112;
select sum(v9) from res;
