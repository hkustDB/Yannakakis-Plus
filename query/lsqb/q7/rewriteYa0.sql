create or replace view semiUp7983581942400214464 as select MessageId as v1 from Person_likes_Message AS Person_likes_Message where (MessageId) in (select ParentMessageId from Comment_replyOf_Message AS Comment_replyOf_Message);
create or replace view semiUp5165074513045839979 as select MessageId as v1 from Message_hasCreator_Person AS Message_hasCreator_Person where (MessageId) in (select v1 from semiUp7983581942400214464);
create or replace view semiUp7350458935809506560 as select MessageId as v1 from Message_hasTag_Tag AS Message_hasTag_Tag where (MessageId) in (select v1 from semiUp5165074513045839979);
create or replace view semiDown2665797274221932183 as select v1 from semiUp5165074513045839979 where (v1) in (select v1 from semiUp7350458935809506560);
create or replace view semiDown656562128280554809 as select v1 from semiUp7983581942400214464 where (v1) in (select v1 from semiDown2665797274221932183);
create or replace view semiDown6312332561633010372 as select ParentMessageId as v1 from Comment_replyOf_Message AS Comment_replyOf_Message where (ParentMessageId) in (select v1 from semiDown656562128280554809);
create or replace view aggView7396840542742001467 as select v1, COUNT(*) as annot from semiDown6312332561633010372 group by v1;
create or replace view aggJoin761179248826211684 as select v1, annot from semiDown656562128280554809 join aggView7396840542742001467 using(v1);
create or replace view aggView8027783106787908757 as select v1, SUM(annot) as annot from aggJoin761179248826211684 group by v1;
create or replace view aggJoin3041214146740260549 as select v1, annot from semiDown2665797274221932183 join aggView8027783106787908757 using(v1);
create or replace view aggView6181545378389141057 as select v1, SUM(annot) as annot from aggJoin3041214146740260549 group by v1;
create or replace view aggJoin3713947737335414740 as select annot from semiUp7350458935809506560 join aggView6181545378389141057 using(v1);
create or replace view res as select SUM(annot) as v9 from aggJoin3713947737335414740;
select sum(v9) from res;
