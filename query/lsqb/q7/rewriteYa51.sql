create or replace view semiUp7990048955332066000 as select MessageId as v1 from Person_likes_Message AS Person_likes_Message where (MessageId) in (select (MessageId) from Message_hasTag_Tag AS Message_hasTag_Tag);
create or replace view semiUp6956435706589887343 as select v1 from semiUp7990048955332066000 where (v1) in (select (ParentMessageId) from Comment_replyOf_Message AS Comment_replyOf_Message);
create or replace view semiUp5905392053105305158 as select MessageId as v1 from Message_hasCreator_Person AS Message_hasCreator_Person where (MessageId) in (select (v1) from semiUp6956435706589887343);
create or replace view semiDown6215750520874008389 as select v1 from semiUp6956435706589887343 where (v1) in (select (v1) from semiUp5905392053105305158);
create or replace view semiDown257104180713103111 as select MessageId as v1 from Message_hasTag_Tag AS Message_hasTag_Tag where (MessageId) in (select (v1) from semiDown6215750520874008389);
create or replace view semiDown8667604625251256486 as select ParentMessageId as v1 from Comment_replyOf_Message AS Comment_replyOf_Message where (ParentMessageId) in (select (v1) from semiDown6215750520874008389);
create or replace view aggView5098802731845844968 as select v1, COUNT(*) as annot from semiDown257104180713103111 group by v1;
create or replace view aggJoin7558181549523962792 as select v1, annot from semiDown6215750520874008389 join aggView5098802731845844968 using(v1);
create or replace view aggView4104295493685563344 as select v1, COUNT(*) as annot from semiDown8667604625251256486 group by v1;
create or replace view aggJoin8744523212996013192 as select v1, aggJoin7558181549523962792.annot * aggView4104295493685563344.annot as annot from aggJoin7558181549523962792 join aggView4104295493685563344 using(v1);
create or replace view aggView649940118431569311 as select v1, SUM(annot) as annot from aggJoin8744523212996013192 group by v1;
create or replace view aggJoin7373328708644421041 as select annot from semiUp5905392053105305158 join aggView649940118431569311 using(v1);
select SUM(annot) as v9 from aggJoin7373328708644421041;
