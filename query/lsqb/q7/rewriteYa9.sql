create or replace view semiUp436829274731515253 as select MessageId as v1 from Message_hasCreator_Person AS Message_hasCreator_Person where (MessageId) in (select ParentMessageId from Comment_replyOf_Message AS Comment_replyOf_Message);
create or replace view semiUp3395850081377218408 as select MessageId as v1 from Person_likes_Message AS Person_likes_Message where (MessageId) in (select v1 from semiUp436829274731515253);
create or replace view semiUp2113069906156633011 as select MessageId as v1 from Message_hasTag_Tag AS Message_hasTag_Tag where (MessageId) in (select v1 from semiUp3395850081377218408);
create or replace view semiDown4788813679665612776 as select v1 from semiUp3395850081377218408 where (v1) in (select v1 from semiUp2113069906156633011);
create or replace view semiDown1714771690122982559 as select v1 from semiUp436829274731515253 where (v1) in (select v1 from semiDown4788813679665612776);
create or replace view semiDown2294004837743102156 as select ParentMessageId as v1 from Comment_replyOf_Message AS Comment_replyOf_Message where (ParentMessageId) in (select v1 from semiDown1714771690122982559);
create or replace view aggView3697604859971278839 as select v1, COUNT(*) as annot from semiDown2294004837743102156 group by v1;
create or replace view aggJoin8352637493043097839 as select v1, annot from semiDown1714771690122982559 join aggView3697604859971278839 using(v1);
create or replace view aggView3064489788433602123 as select v1, SUM(annot) as annot from aggJoin8352637493043097839 group by v1;
create or replace view aggJoin5368831367500821486 as select v1, annot from semiDown4788813679665612776 join aggView3064489788433602123 using(v1);
create or replace view aggView7440665455779071319 as select v1, SUM(annot) as annot from aggJoin5368831367500821486 group by v1;
create or replace view aggJoin5321259630676701988 as select annot from semiUp2113069906156633011 join aggView7440665455779071319 using(v1);
create or replace view res as select SUM(annot) as v9 from aggJoin5321259630676701988;
select sum(v9) from res;
