create or replace view semiUp3351094455870652729 as select MessageId as v1 from Message_hasCreator_Person AS Message_hasCreator_Person where (MessageId) in (select MessageId from Message_hasTag_Tag AS Message_hasTag_Tag);
create or replace view semiUp7476244688106071573 as select ParentMessageId as v1 from Comment_replyOf_Message AS Comment_replyOf_Message where (ParentMessageId) in (select v1 from semiUp3351094455870652729);
create or replace view semiUp6594727335394829280 as select MessageId as v1 from Person_likes_Message AS Person_likes_Message where (MessageId) in (select v1 from semiUp7476244688106071573);
create or replace view semiDown1438859961019733647 as select v1 from semiUp7476244688106071573 where (v1) in (select v1 from semiUp6594727335394829280);
create or replace view semiDown3386667741820472690 as select v1 from semiUp3351094455870652729 where (v1) in (select v1 from semiDown1438859961019733647);
create or replace view semiDown8291765766015882374 as select MessageId as v1 from Message_hasTag_Tag AS Message_hasTag_Tag where (MessageId) in (select v1 from semiDown3386667741820472690);
create or replace view aggView1880875792363007960 as select v1, COUNT(*) as annot from semiDown8291765766015882374 group by v1;
create or replace view aggJoin1859632888623797823 as select v1, annot from semiDown3386667741820472690 join aggView1880875792363007960 using(v1);
create or replace view aggView8574974678309077394 as select v1, SUM(annot) as annot from aggJoin1859632888623797823 group by v1;
create or replace view aggJoin2041798150750751889 as select v1, annot from semiDown1438859961019733647 join aggView8574974678309077394 using(v1);
create or replace view aggView981004301651464102 as select v1, SUM(annot) as annot from aggJoin2041798150750751889 group by v1;
create or replace view aggJoin997923501959728800 as select annot from semiUp6594727335394829280 join aggView981004301651464102 using(v1);
create or replace view res as select SUM(annot) as v9 from aggJoin997923501959728800;
select sum(v9) from res;
