create or replace view semiUp85734699447249537 as select MessageId as v1 from Message_hasTag_Tag AS Message_hasTag_Tag where (MessageId) in (select MessageId from Person_likes_Message AS Person_likes_Message);
create or replace view semiUp6911629983172716470 as select MessageId as v1 from Message_hasCreator_Person AS Message_hasCreator_Person where (MessageId) in (select v1 from semiUp85734699447249537);
create or replace view semiUp3732986235714476476 as select ParentMessageId as v1 from Comment_replyOf_Message AS Comment_replyOf_Message where (ParentMessageId) in (select v1 from semiUp6911629983172716470);
create or replace view semiDown6804362327582928779 as select v1 from semiUp6911629983172716470 where (v1) in (select v1 from semiUp3732986235714476476);
create or replace view semiDown4800096134380737083 as select v1 from semiUp85734699447249537 where (v1) in (select v1 from semiDown6804362327582928779);
create or replace view semiDown3867641081198594490 as select MessageId as v1 from Person_likes_Message AS Person_likes_Message where (MessageId) in (select v1 from semiDown4800096134380737083);
create or replace view aggView7613857121447082520 as select v1, COUNT(*) as annot from semiDown3867641081198594490 group by v1;
create or replace view aggJoin4775724425213812485 as select v1, annot from semiDown4800096134380737083 join aggView7613857121447082520 using(v1);
create or replace view aggView2880636144627461977 as select v1, SUM(annot) as annot from aggJoin4775724425213812485 group by v1;
create or replace view aggJoin1229734441714052406 as select v1, annot from semiDown6804362327582928779 join aggView2880636144627461977 using(v1);
create or replace view aggView1367992106614429198 as select v1, SUM(annot) as annot from aggJoin1229734441714052406 group by v1;
create or replace view aggJoin3950856032789023799 as select annot from semiUp3732986235714476476 join aggView1367992106614429198 using(v1);
create or replace view res as select SUM(annot) as v9 from aggJoin3950856032789023799;
select sum(v9) from res;
