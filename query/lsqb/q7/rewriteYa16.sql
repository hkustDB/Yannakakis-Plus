create or replace view semiUp3339420327861621815 as select MessageId as v1 from Message_hasTag_Tag AS Message_hasTag_Tag where (MessageId) in (select MessageId from Person_likes_Message AS Person_likes_Message);
create or replace view semiUp3142118831371519816 as select ParentMessageId as v1 from Comment_replyOf_Message AS Comment_replyOf_Message where (ParentMessageId) in (select v1 from semiUp3339420327861621815);
create or replace view semiUp3277634142554744291 as select MessageId as v1 from Message_hasCreator_Person AS Message_hasCreator_Person where (MessageId) in (select v1 from semiUp3142118831371519816);
create or replace view semiDown1582190157038106913 as select v1 from semiUp3142118831371519816 where (v1) in (select v1 from semiUp3277634142554744291);
create or replace view semiDown5998675187161652167 as select v1 from semiUp3339420327861621815 where (v1) in (select v1 from semiDown1582190157038106913);
create or replace view semiDown3607506574520414870 as select MessageId as v1 from Person_likes_Message AS Person_likes_Message where (MessageId) in (select v1 from semiDown5998675187161652167);
create or replace view aggView3257764992362263579 as select v1, COUNT(*) as annot from semiDown3607506574520414870 group by v1;
create or replace view aggJoin1211653641583339850 as select v1, annot from semiDown5998675187161652167 join aggView3257764992362263579 using(v1);
create or replace view aggView5562414425573823111 as select v1, SUM(annot) as annot from aggJoin1211653641583339850 group by v1;
create or replace view aggJoin5995347246020752000 as select v1, annot from semiDown1582190157038106913 join aggView5562414425573823111 using(v1);
create or replace view aggView5037816386905251112 as select v1, SUM(annot) as annot from aggJoin5995347246020752000 group by v1;
create or replace view aggJoin1529114806076433914 as select annot from semiUp3277634142554744291 join aggView5037816386905251112 using(v1);
create or replace view res as select SUM(annot) as v9 from aggJoin1529114806076433914;
select sum(v9) from res;
