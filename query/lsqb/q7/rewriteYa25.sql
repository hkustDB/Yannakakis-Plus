create or replace view semiUp8794612046986892509 as select MessageId as v1 from Message_hasTag_Tag AS Message_hasTag_Tag where (MessageId) in (select ParentMessageId from Comment_replyOf_Message AS Comment_replyOf_Message);
create or replace view semiUp579590281755379504 as select MessageId as v1 from Person_likes_Message AS Person_likes_Message where (MessageId) in (select MessageId from Message_hasCreator_Person AS Message_hasCreator_Person);
create or replace view semiUp8366097361845766033 as select v1 from semiUp579590281755379504 where (v1) in (select v1 from semiUp8794612046986892509);
create or replace view semiDown660500598696276985 as select MessageId as v1 from Message_hasCreator_Person AS Message_hasCreator_Person where (MessageId) in (select v1 from semiUp8366097361845766033);
create or replace view semiDown1568841039658476768 as select v1 from semiUp8794612046986892509 where (v1) in (select v1 from semiUp8366097361845766033);
create or replace view semiDown8210088649809273673 as select ParentMessageId as v1 from Comment_replyOf_Message AS Comment_replyOf_Message where (ParentMessageId) in (select v1 from semiDown1568841039658476768);
create or replace view aggView7696809010052513719 as select v1, COUNT(*) as annot from semiDown8210088649809273673 group by v1;
create or replace view aggJoin936413392789240590 as select v1, annot from semiDown1568841039658476768 join aggView7696809010052513719 using(v1);
create or replace view aggView592364377468189205 as select v1, SUM(annot) as annot from aggJoin936413392789240590 group by v1;
create or replace view aggJoin2036387468753141928 as select v1, annot from semiUp8366097361845766033 join aggView592364377468189205 using(v1);
create or replace view aggView7643280387706114709 as select v1 from semiDown660500598696276985;
create or replace view aggJoin4269067567725963209 as select annot from aggJoin2036387468753141928 join aggView7643280387706114709 using(v1);
create or replace view res as select SUM(annot) as v9 from aggJoin4269067567725963209;
select sum(v9) from res;
