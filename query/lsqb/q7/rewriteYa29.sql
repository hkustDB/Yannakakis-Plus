create or replace view semiUp3317382448729790278 as select ParentMessageId as v1 from Comment_replyOf_Message AS Comment_replyOf_Message where (ParentMessageId) in (select MessageId from Person_likes_Message AS Person_likes_Message);
create or replace view semiUp2730570802419380081 as select v1 from semiUp3317382448729790278 where (v1) in (select MessageId from Message_hasTag_Tag AS Message_hasTag_Tag);
create or replace view semiUp1882684970155019411 as select MessageId as v1 from Message_hasCreator_Person AS Message_hasCreator_Person where (MessageId) in (select v1 from semiUp2730570802419380081);
create or replace view semiDown8356581389849937451 as select v1 from semiUp2730570802419380081 where (v1) in (select v1 from semiUp1882684970155019411);
create or replace view semiDown5074597421972340419 as select MessageId as v1 from Message_hasTag_Tag AS Message_hasTag_Tag where (MessageId) in (select v1 from semiDown8356581389849937451);
create or replace view semiDown2169546353761404991 as select MessageId as v1 from Person_likes_Message AS Person_likes_Message where (MessageId) in (select v1 from semiDown8356581389849937451);
create or replace view aggView540391865791736079 as select v1, COUNT(*) as annot from semiDown2169546353761404991 group by v1;
create or replace view aggJoin6053841529405399176 as select v1, annot from semiDown8356581389849937451 join aggView540391865791736079 using(v1);
create or replace view aggView5340311061890550821 as select v1, COUNT(*) as annot from semiDown5074597421972340419 group by v1;
create or replace view aggJoin5602056054659013514 as select v1, aggJoin6053841529405399176.annot * aggView5340311061890550821.annot as annot from aggJoin6053841529405399176 join aggView5340311061890550821 using(v1);
create or replace view aggView1707408002494601357 as select v1, SUM(annot) as annot from aggJoin5602056054659013514 group by v1;
create or replace view aggJoin4535213410349302613 as select annot from semiUp1882684970155019411 join aggView1707408002494601357 using(v1);
create or replace view res as select SUM(annot) as v9 from aggJoin4535213410349302613;
select sum(v9) from res;
