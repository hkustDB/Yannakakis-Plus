create or replace view semiUp2099269456128691 as select MessageId as v1 from Message_hasTag_Tag AS Message_hasTag_Tag where (MessageId) in (select ParentMessageId from Comment_replyOf_Message AS Comment_replyOf_Message);
create or replace view semiUp4270097638407120050 as select MessageId as v1 from Person_likes_Message AS Person_likes_Message where (MessageId) in (select v1 from semiUp2099269456128691);
create or replace view semiUp3958343650011840833 as select MessageId as v1 from Message_hasCreator_Person AS Message_hasCreator_Person where (MessageId) in (select v1 from semiUp4270097638407120050);
create or replace view semiDown4324596741916699937 as select v1 from semiUp4270097638407120050 where (v1) in (select v1 from semiUp3958343650011840833);
create or replace view semiDown8372316248693138606 as select v1 from semiUp2099269456128691 where (v1) in (select v1 from semiDown4324596741916699937);
create or replace view semiDown2276796981917584803 as select ParentMessageId as v1 from Comment_replyOf_Message AS Comment_replyOf_Message where (ParentMessageId) in (select v1 from semiDown8372316248693138606);
create or replace view aggView5958804007361198769 as select v1, COUNT(*) as annot from semiDown2276796981917584803 group by v1;
create or replace view aggJoin5584925405779456095 as select v1, annot from semiDown8372316248693138606 join aggView5958804007361198769 using(v1);
create or replace view aggView5290233509148854062 as select v1, SUM(annot) as annot from aggJoin5584925405779456095 group by v1;
create or replace view aggJoin4825072041849136183 as select v1, annot from semiDown4324596741916699937 join aggView5290233509148854062 using(v1);
create or replace view aggView5063664750308228033 as select v1, SUM(annot) as annot from aggJoin4825072041849136183 group by v1;
create or replace view aggJoin5294403935411741548 as select annot from semiUp3958343650011840833 join aggView5063664750308228033 using(v1);
create or replace view res as select SUM(annot) as v9 from aggJoin5294403935411741548;
select sum(v9) from res;
