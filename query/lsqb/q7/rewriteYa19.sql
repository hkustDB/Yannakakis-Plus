create or replace view semiUp6291153649580931427 as select MessageId as v1 from Person_likes_Message AS Person_likes_Message where (MessageId) in (select MessageId from Message_hasTag_Tag AS Message_hasTag_Tag);
create or replace view semiUp5356643720440158000 as select MessageId as v1 from Message_hasCreator_Person AS Message_hasCreator_Person where (MessageId) in (select v1 from semiUp6291153649580931427);
create or replace view semiUp8055054535218888000 as select ParentMessageId as v1 from Comment_replyOf_Message AS Comment_replyOf_Message where (ParentMessageId) in (select v1 from semiUp5356643720440158000);
create or replace view semiDown1708043733520090131 as select v1 from semiUp5356643720440158000 where (v1) in (select v1 from semiUp8055054535218888000);
create or replace view semiDown2604146599936208170 as select v1 from semiUp6291153649580931427 where (v1) in (select v1 from semiDown1708043733520090131);
create or replace view semiDown7259240672230788098 as select MessageId as v1 from Message_hasTag_Tag AS Message_hasTag_Tag where (MessageId) in (select v1 from semiDown2604146599936208170);
create or replace view aggView4099892061103563975 as select v1, COUNT(*) as annot from semiDown7259240672230788098 group by v1;
create or replace view aggJoin2715966845629253111 as select v1, annot from semiDown2604146599936208170 join aggView4099892061103563975 using(v1);
create or replace view aggView4865475781478976754 as select v1, SUM(annot) as annot from aggJoin2715966845629253111 group by v1;
create or replace view aggJoin5537974459355757273 as select v1, annot from semiDown1708043733520090131 join aggView4865475781478976754 using(v1);
create or replace view aggView4936840245174523567 as select v1, SUM(annot) as annot from aggJoin5537974459355757273 group by v1;
create or replace view aggJoin688255265337591287 as select annot from semiUp8055054535218888000 join aggView4936840245174523567 using(v1);
create or replace view res as select SUM(annot) as v9 from aggJoin688255265337591287;
select sum(v9) from res;
