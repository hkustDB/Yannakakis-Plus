create or replace view semiUp1878837636004265247 as select MessageId as v1 from Person_likes_Message AS Person_likes_Message where (MessageId) in (select MessageId from Message_hasTag_Tag AS Message_hasTag_Tag);
create or replace view semiUp1428969113500187171 as select ParentMessageId as v1 from Comment_replyOf_Message AS Comment_replyOf_Message where (ParentMessageId) in (select v1 from semiUp1878837636004265247);
create or replace view semiUp3618453883830309523 as select MessageId as v1 from Message_hasCreator_Person AS Message_hasCreator_Person where (MessageId) in (select v1 from semiUp1428969113500187171);
create or replace view semiDown4880873320239393138 as select v1 from semiUp1428969113500187171 where (v1) in (select v1 from semiUp3618453883830309523);
create or replace view semiDown5584324366682423567 as select v1 from semiUp1878837636004265247 where (v1) in (select v1 from semiDown4880873320239393138);
create or replace view semiDown3001388779527412255 as select MessageId as v1 from Message_hasTag_Tag AS Message_hasTag_Tag where (MessageId) in (select v1 from semiDown5584324366682423567);
create or replace view aggView2128239164954840792 as select v1, COUNT(*) as annot from semiDown3001388779527412255 group by v1;
create or replace view aggJoin2011523045389647405 as select v1, annot from semiDown5584324366682423567 join aggView2128239164954840792 using(v1);
create or replace view aggView3156346926175303274 as select v1, SUM(annot) as annot from aggJoin2011523045389647405 group by v1;
create or replace view aggJoin1755557268891141802 as select v1, annot from semiDown4880873320239393138 join aggView3156346926175303274 using(v1);
create or replace view aggView1567238432228366065 as select v1, SUM(annot) as annot from aggJoin1755557268891141802 group by v1;
create or replace view aggJoin986405323661629603 as select annot from semiUp3618453883830309523 join aggView1567238432228366065 using(v1);
create or replace view res as select SUM(annot) as v9 from aggJoin986405323661629603;
select sum(v9) from res;
