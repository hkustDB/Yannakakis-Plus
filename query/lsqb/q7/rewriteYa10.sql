create or replace view semiUp4793821653136283680 as select MessageId as v1 from Message_hasCreator_Person AS Message_hasCreator_Person where (MessageId) in (select MessageId from Person_likes_Message AS Person_likes_Message);
create or replace view semiUp6422462933288949521 as select MessageId as v1 from Message_hasTag_Tag AS Message_hasTag_Tag where (MessageId) in (select v1 from semiUp4793821653136283680);
create or replace view semiUp2524722850605257940 as select ParentMessageId as v1 from Comment_replyOf_Message AS Comment_replyOf_Message where (ParentMessageId) in (select v1 from semiUp6422462933288949521);
create or replace view semiDown790493245152173807 as select v1 from semiUp6422462933288949521 where (v1) in (select v1 from semiUp2524722850605257940);
create or replace view semiDown6188702053130148306 as select v1 from semiUp4793821653136283680 where (v1) in (select v1 from semiDown790493245152173807);
create or replace view semiDown3359351353539701701 as select MessageId as v1 from Person_likes_Message AS Person_likes_Message where (MessageId) in (select v1 from semiDown6188702053130148306);
create or replace view aggView8574371655575636430 as select v1, COUNT(*) as annot from semiDown3359351353539701701 group by v1;
create or replace view aggJoin6349575629688110920 as select v1, annot from semiDown6188702053130148306 join aggView8574371655575636430 using(v1);
create or replace view aggView146088617351417024 as select v1, SUM(annot) as annot from aggJoin6349575629688110920 group by v1;
create or replace view aggJoin2320991217060432729 as select v1, annot from semiDown790493245152173807 join aggView146088617351417024 using(v1);
create or replace view aggView1936613215890025137 as select v1, SUM(annot) as annot from aggJoin2320991217060432729 group by v1;
create or replace view aggJoin2500495102641141316 as select annot from semiUp2524722850605257940 join aggView1936613215890025137 using(v1);
create or replace view res as select SUM(annot) as v9 from aggJoin2500495102641141316;
select sum(v9) from res;
