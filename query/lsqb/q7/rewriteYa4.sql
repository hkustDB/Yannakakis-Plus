create or replace view semiUp7737682435307245133 as select MessageId as v1 from Message_hasCreator_Person AS Message_hasCreator_Person where (MessageId) in (select MessageId from Person_likes_Message AS Person_likes_Message);
create or replace view semiUp1971163948733350753 as select ParentMessageId as v1 from Comment_replyOf_Message AS Comment_replyOf_Message where (ParentMessageId) in (select v1 from semiUp7737682435307245133);
create or replace view semiUp4841057611499412764 as select MessageId as v1 from Message_hasTag_Tag AS Message_hasTag_Tag where (MessageId) in (select v1 from semiUp1971163948733350753);
create or replace view semiDown4576059938721849140 as select v1 from semiUp1971163948733350753 where (v1) in (select v1 from semiUp4841057611499412764);
create or replace view semiDown8733882079891410080 as select v1 from semiUp7737682435307245133 where (v1) in (select v1 from semiDown4576059938721849140);
create or replace view semiDown5359215740188601637 as select MessageId as v1 from Person_likes_Message AS Person_likes_Message where (MessageId) in (select v1 from semiDown8733882079891410080);
create or replace view aggView4689045989353527603 as select v1, COUNT(*) as annot from semiDown5359215740188601637 group by v1;
create or replace view aggJoin6664054358958836706 as select v1, annot from semiDown8733882079891410080 join aggView4689045989353527603 using(v1);
create or replace view aggView8136772594569147947 as select v1, SUM(annot) as annot from aggJoin6664054358958836706 group by v1;
create or replace view aggJoin6573525861332597710 as select v1, annot from semiDown4576059938721849140 join aggView8136772594569147947 using(v1);
create or replace view aggView1630629953797348179 as select v1, SUM(annot) as annot from aggJoin6573525861332597710 group by v1;
create or replace view aggJoin8259958019903671635 as select annot from semiUp4841057611499412764 join aggView1630629953797348179 using(v1);
create or replace view res as select SUM(annot) as v9 from aggJoin8259958019903671635;
select sum(v9) from res;
