create or replace view customerAux32 as select c_custkey as v1, c_name as v2, c_address as v3, c_nationkey as v4, c_phone as v5, c_acctbal as v6, c_comment as v8 from customer;
create or replace view nationAux89 as select n_nationkey as v4, n_name as v35 from nation;
create or replace view semiUp5399708120305337815 as select o_orderkey as v18, o_custkey as v1 from orders AS orders where (o_orderkey) in (select l_orderkey from lineitem AS lineitem where l_returnflag= 'R') and o_orderdate>=DATE '1993-10-01' and o_orderdate<DATE '1994-01-01';
create or replace view semiUp3058142646728982288 as select v1, v2, v3, v4, v5, v6, v8 from customerAux32 where (v1) in (select v1 from semiUp5399708120305337815);
create or replace view semiUp3658242855997875082 as select v4, v35 from nationAux89 where (v4) in (select v4 from semiUp3058142646728982288);
create or replace view semiDown3577891905028394812 as select v1, v2, v3, v4, v5, v6, v8 from semiUp3058142646728982288 where (v4) in (select v4 from semiUp3658242855997875082);
create or replace view semiDown6474687278137579423 as select n_nationkey as v4, n_name as v35 from nation AS nation where (n_nationkey, n_name) in (select v4, v35 from semiUp3658242855997875082);
create or replace view semiDown5589446157340454576 as select v18, v1 from semiUp5399708120305337815 where (v1) in (select v1 from semiDown3577891905028394812);
create or replace view semiDown2668859252189665017 as select c_custkey as v1, c_name as v2, c_address as v3, c_nationkey as v4, c_phone as v5, c_acctbal as v6, c_comment as v8 from customer AS customer where (c_custkey, c_phone, c_acctbal, c_name, c_nationkey, c_address, c_comment) in (select v1, v5, v6, v2, v4, v3, v8 from semiDown3577891905028394812);
create or replace view semiDown5232049604572765389 as select l_orderkey as v18, l_extendedprice as v23, l_discount as v24 from lineitem AS lineitem where (l_orderkey) in (select v18 from semiDown5589446157340454576) and l_returnflag= 'R';
create or replace view aggView5477374889399563324 as select v4, v35 from semiDown6474687278137579423;
create or replace view aggView5866073982692431465 as select v1, v5, v6, v2, v4, v3, v8 from semiDown2668859252189665017;
create or replace view aggView975460272418606993 as select v18, SUM(v23 * (1 - v24)) as v39, COUNT(*) as annot from semiDown5232049604572765389 group by v18;
create or replace view aggJoin5191054408561529714 as select v1, v39, annot from semiDown5589446157340454576 join aggView975460272418606993 using(v18);
create or replace view aggView8207906938060902943 as select v1, SUM(v39) as v39, SUM(annot) as annot from aggJoin5191054408561529714 group by v1;
create or replace view aggJoin6978270366222933608 as select v1, v5, v6, v2, v4, v3, v8, v39, annot from aggView5866073982692431465 join aggView8207906938060902943 using(v1);
create or replace view aggView8944158217497435431 as select v4, SUM(v39) as v39, v1, v5, v6, v2, v3, v8, SUM(annot) as annot from aggJoin6978270366222933608 group by v4,v1,v5,v6,v2,v3,v8;
create or replace view aggJoin2489868261595374751 as select v35, v39, v1, v5, v6, v2, v3, v8 from aggView5477374889399563324 join aggView8944158217497435431 using(v4);
create or replace view res as select v1, v2, SUM(v39) as v39, v6, v35, v3, v5, v8 from aggJoin2489868261595374751 group by v1, v2, v6, v5, v35, v3, v8;
select sum(v1), sum(v2), sum(v39), sum(v6), sum(v35), sum(v3), sum(v5), sum(v8) from res;
