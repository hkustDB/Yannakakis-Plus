create or replace view semiUp4661016137937984038 as select l_orderkey as v38, l_partkey as v33, l_suppkey as v10, l_quantity as v21, l_extendedprice as v22, l_discount as v23 from lineitem AS lineitem where (l_suppkey, l_partkey) in (select ps_suppkey, ps_partkey from partsupp AS partsupp);
create or replace view semiUp3827019485190884285 as select s_suppkey as v10, s_nationkey as v13 from supplier AS supplier where (s_nationkey) in (select n_nationkey from nation AS nation);
create or replace view semiUp4408705640728645983 as select v38, v33, v10, v21, v22, v23 from semiUp4661016137937984038 where (v38) in (select o_orderkey from orderswithyear AS orderswithyear);
create or replace view semiUp3152644474369584921 as select v38, v33, v10, v21, v22, v23 from semiUp4408705640728645983 where (v33) in (select p_partkey from part AS part where p_name LIKE '%green%');
create or replace view semiUp4220181414230178855 as select v38, v33, v10, v21, v22, v23 from semiUp3152644474369584921 where (v10) in (select v10 from semiUp3827019485190884285);
create or replace view semiDown8147101657329940770 as select v10, v13 from semiUp3827019485190884285 where (v10) in (select v10 from semiUp4220181414230178855);
create or replace view semiDown1140159442435991556 as select p_partkey as v33 from part AS part where (p_partkey) in (select v33 from semiUp4220181414230178855) and p_name LIKE '%green%';
create or replace view semiDown5982551084187161710 as select ps_partkey as v33, ps_suppkey as v10, ps_supplycost as v36 from partsupp AS partsupp where (ps_suppkey, ps_partkey) in (select v10, v33 from semiUp4220181414230178855);
create or replace view semiDown5742643307522018708 as select o_orderkey as v38, o_year as v39 from orderswithyear AS orderswithyear where (o_orderkey) in (select v38 from semiUp4220181414230178855);
create or replace view semiDown644682581514957365 as select n_nationkey as v13, n_name as v49 from nation AS nation where (n_nationkey) in (select v13 from semiDown8147101657329940770);
create or replace view aggView7947807366504448206 as select v13, v49 from semiDown644682581514957365;
create or replace view aggJoin6240666218427980998 as select v10, v49 from semiDown8147101657329940770 join aggView7947807366504448206 using(v13);
create or replace view aggView330904337092801327 as select v10, v49, COUNT(*) as annot from aggJoin6240666218427980998 group by v10,v49;
create or replace view aggJoin4078806569229901515 as select v38, v33, v10, v21, v22, v23, v49, annot from semiUp4220181414230178855 join aggView330904337092801327 using(v10);
create or replace view aggView4514056328266835179 as select v38, v39 from semiDown5742643307522018708;
create or replace view aggJoin7012982391159638124 as select v33, v10, v21, v22, v23, v49, annot, v39 from aggJoin4078806569229901515 join aggView4514056328266835179 using(v38);
create or replace view aggView5001908620149984723 as select v33 from semiDown1140159442435991556;
create or replace view aggJoin1753132849435233226 as select v33, v10, v21, v22, v23, v49, annot, v39 from aggJoin7012982391159638124 join aggView5001908620149984723 using(v33);
create or replace view aggView8014570825354871941 as select v10, v33, v36 from semiDown5982551084187161710;
create or replace view aggJoin8451677090668581368 as select v21, v22, v23, v49, annot, v39, v36 from aggJoin1753132849435233226 join aggView8014570825354871941 using(v10,v33);
select v49, v39, SUM((v22 * (1 - v23))*annot) as v54, SUM((v36 * v21)*annot) as v55 from aggJoin8451677090668581368 group by v49, v39;

