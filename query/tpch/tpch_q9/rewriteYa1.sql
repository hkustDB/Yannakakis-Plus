create or replace view orderswithyearAux22 as select o_orderkey as v38, o_year as v39 from orderswithyear;
create or replace view nationAux29 as select n_nationkey as v13, n_name as v49 from nation;
create or replace view semiUp1187547690034864688 as select s_suppkey as v10, s_nationkey as v13 from supplier AS supplier where (s_nationkey) in (select v13 from nationAux29);
create or replace view semiUp7740164829460595757 as select ps_partkey as v33, ps_suppkey as v10, ps_supplycost as v36 from partsupp AS partsupp where (ps_partkey) in (select p_partkey from part AS part where p_name LIKE '%green%');
create or replace view semiUp8864472459659442298 as select l_orderkey as v38, l_partkey as v33, l_suppkey as v10, l_quantity as v21, l_extendedprice as v22, l_discount as v23 from lineitem AS lineitem where (l_suppkey) in (select v10 from semiUp1187547690034864688);
create or replace view semiUp6316090209849598780 as select v38, v33, v10, v21, v22, v23 from semiUp8864472459659442298 where (v33, v10) in (select v33, v10 from semiUp7740164829460595757);
create or replace view semiUp4261660063927456400 as select v38, v39 from orderswithyearAux22 where (v38) in (select v38 from semiUp6316090209849598780);
create or replace view semiDown3333481941912007017 as select o_orderkey as v38, o_year as v39 from orderswithyear AS orderswithyear where (o_orderkey, o_year) in (select v38, v39 from semiUp4261660063927456400);
create or replace view semiDown230412020356144667 as select v38, v33, v10, v21, v22, v23 from semiUp6316090209849598780 where (v38) in (select v38 from semiUp4261660063927456400);
create or replace view semiDown5487512683742483439 as select v10, v13 from semiUp1187547690034864688 where (v10) in (select v10 from semiDown230412020356144667);
create or replace view semiDown3370739666921280232 as select v33, v10, v36 from semiUp7740164829460595757 where (v33, v10) in (select v33, v10 from semiDown230412020356144667);
create or replace view semiDown7547312142108191177 as select v13, v49 from nationAux29 where (v13) in (select v13 from semiDown5487512683742483439);
create or replace view semiDown8267570190685072417 as select p_partkey as v33 from part AS part where (p_partkey) in (select v33 from semiDown3370739666921280232) and p_name LIKE '%green%';
create or replace view semiDown1529350494573581621 as select n_nationkey as v13, n_name as v49 from nation AS nation where (n_name, n_nationkey) in (select v49, v13 from semiDown7547312142108191177);
create or replace view aggView1335061463396466658 as select v38, v39 from semiDown3333481941912007017;
create or replace view aggView3192820772676477047 as select v49, v13 from semiDown1529350494573581621;
create or replace view aggView576002304944776108 as select v33 from semiDown8267570190685072417;
create or replace view aggJoin2816459098312706729 as select v33, v10, v36 from semiDown3370739666921280232 join aggView576002304944776108 using(v33);
create or replace view aggView1021181098653847600 as select v33, v10, SUM(v36)/COUNT(*) as v36, COUNT(*) as annot from aggJoin2816459098312706729 group by v33,v10;
create or replace view aggJoin1617509408626848910 as select v38, v10, v21, v22, v23, v36, annot from semiDown230412020356144667 join aggView1021181098653847600 using(v33,v10);
create or replace view aggView223402905614081777 as select v13, v49, COUNT(*) as annot from aggView3192820772676477047 group by v13,v49;
create or replace view aggJoin6609562282975075288 as select v10, v49, annot from semiDown5487512683742483439 join aggView223402905614081777 using(v13);
create or replace view aggView8822222158393124099 as select v10, v49, SUM(annot) as annot from aggJoin6609562282975075288 group by v10,v49;
create or replace view aggJoin4956546601770845716 as select v38, v21, v22, v23, v36, aggJoin1617509408626848910.annot * aggView8822222158393124099.annot as annot, v49 from aggJoin1617509408626848910 join aggView8822222158393124099 using(v10);
create or replace view aggView4935049944201366837 as select v38, SUM((v22 * (1 - v23)) * annot) as v54, SUM((v36 * v21) * annot) as v55, v49, SUM(annot) as annot from aggJoin4956546601770845716 group by v38,v49;
create or replace view aggJoin946505533229212372 as select v39, v54, v55, v49 from aggView1335061463396466658 join aggView4935049944201366837 using(v38);
create or replace view res as select v49, v39, SUM(v54) as v54, SUM(v55) as v55 from aggJoin946505533229212372 group by v49, v39;
select sum(v49+v39+v54+v55) from res;
