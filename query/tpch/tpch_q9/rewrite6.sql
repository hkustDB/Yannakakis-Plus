create or replace view aggView8335962404780338719 as select n_nationkey as v13, n_name as v49 from nation as nation;
create or replace view aggView7485567764167420038 as select o_year as v39, o_orderkey as v38 from orderswithyear as orderswithyear;
create or replace view aggView5455341363085874505 as select ps_partkey as v33, ps_suppkey as v10, ps_supplycost as v36 from partsupp as partsupp;
create or replace view aggJoin3390008630187853453 as select l_orderkey as v38, l_partkey as v33, l_suppkey as v10, l_quantity as v21, l_extendedprice as v22, l_discount as v23, v36 from lineitem as lineitem, aggView5455341363085874505 where lineitem.l_partkey=aggView5455341363085874505.v33 and lineitem.l_suppkey=aggView5455341363085874505.v10;
create or replace view aggView5416540775609949374 as select p_partkey as v33 from part as part where p_name LIKE '%green%';
create or replace view aggJoin5366982625903727168 as select v38, v10, v21, v22, v23, v36 from aggJoin3390008630187853453 join aggView5416540775609949374 using(v33);
create or replace view semiJoinView8882773465603262581 as select v38, v10, v21, v36, (v22 * (1 - v23)) as v54 from aggJoin5366982625903727168 where (v38) in (select v38 from aggView7485567764167420038);
create or replace view semiJoinView330524361899570164 as select s_suppkey as v10, s_nationkey as v13 from supplier AS supplier where (s_nationkey) in (select v13 from aggView8335962404780338719);
create or replace view semiJoinView564780038082146653 as select v10, v13 from semiJoinView330524361899570164 where (v10) in (select v10 from semiJoinView8882773465603262581);
create or replace view semiEnum6159442069360712727 as select v13, v36, v54, v38, v21 from semiJoinView564780038082146653 join semiJoinView8882773465603262581 using(v10);
create or replace view semiEnum4666727288254793683 as select v49, v36, v54, v38, v21 from semiEnum6159442069360712727 join aggView8335962404780338719 using(v13);
create or replace view semiEnum7139937146986624359 as select v39, v49, v36, v54, v21 from semiEnum4666727288254793683 join aggView7485567764167420038 using(v38);
create or replace view res as select v49, v39, SUM(v54) as v54, SUM((v36 * v21)) as v55 from semiEnum7139937146986624359 group by v49, v39;
select sum(v49), sum(v39), sum(v54), sum(v55) from res;
