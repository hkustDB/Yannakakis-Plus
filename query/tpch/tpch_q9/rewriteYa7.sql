create or replace view orderswithyearAux24 as select o_orderkey as v38, o_year as v39 from orderswithyear;
create or replace view nationAux38 as select n_nationkey as v13, n_name as v49 from nation;
create or replace view semiUp635171801985054649 as select s_suppkey as v10, s_nationkey as v13 from supplier AS supplier where (s_nationkey) in (select v13 from nationAux38);
create or replace view semiUp2746944597457506222 as select l_orderkey as v38, l_partkey as v33, l_suppkey as v10, l_quantity as v21, l_extendedprice as v22, l_discount as v23 from lineitem AS lineitem where (l_suppkey) in (select v10 from semiUp635171801985054649);
create or replace view semiUp4842938691630656911 as select v38, v33, v10, v21, v22, v23 from semiUp2746944597457506222 where (v33, v10) in (select ps_partkey, ps_suppkey from partsupp AS partsupp);
create or replace view semiUp1595551892218113007 as select v38, v33, v10, v21, v22, v23 from semiUp4842938691630656911 where (v38) in (select v38 from orderswithyearAux24);
create or replace view semiUp6448870318634443510 as select v38, v33, v10, v21, v22, v23 from semiUp1595551892218113007 where (v33) in (select p_partkey from part AS part where p_name LIKE '%green%');
create or replace view semiDown97845495471531871 as select v10, v13 from semiUp635171801985054649 where (v10) in (select v10 from semiUp6448870318634443510);
create or replace view semiDown2251348434261056786 as select p_partkey as v33 from part AS part where (p_partkey) in (select v33 from semiUp6448870318634443510) and p_name LIKE '%green%';
create or replace view semiDown380286626122587162 as select ps_partkey as v33, ps_suppkey as v10, ps_supplycost as v36 from partsupp AS partsupp where (ps_partkey, ps_suppkey) in (select v33, v10 from semiUp6448870318634443510);
create or replace view semiDown8761962461675680434 as select v38, v39 from orderswithyearAux24 where (v38) in (select v38 from semiUp6448870318634443510);
create or replace view semiDown193813103832825189 as select v13, v49 from nationAux38 where (v13) in (select v13 from semiDown97845495471531871);
create or replace view semiDown5387016987906000403 as select o_orderkey as v38, o_year as v39 from orderswithyear AS orderswithyear where (o_orderkey, o_year) in (select v38, v39 from semiDown8761962461675680434);
create or replace view semiDown3665556588420093153 as select n_nationkey as v13, n_name as v49 from nation AS nation where (n_name, n_nationkey) in (select v49, v13 from semiDown193813103832825189);
create or replace view aggView1638050279230855664 as select v49, v13 from semiDown3665556588420093153;
create or replace view aggView4065964210598644456 as select v38, v39 from semiDown5387016987906000403;
create or replace view aggView7943137278818981379 as select v13, v49, COUNT(*) as annot from aggView1638050279230855664 group by v13,v49;
create or replace view aggJoin5976155576981642820 as select v10, v49, annot from semiDown97845495471531871 join aggView7943137278818981379 using(v13);
create or replace view aggView5383012372977626646 as select v38, v39, COUNT(*) as annot from aggView4065964210598644456 group by v38,v39;
create or replace view aggJoin7618444821035252276 as select v33, v10, v21, v22, v23, v39, annot from semiUp6448870318634443510 join aggView5383012372977626646 using(v38);
create or replace view aggView3678086442765611087 as select v33 from semiDown2251348434261056786;
create or replace view aggJoin4993880090958873859 as select v33, v10, v21, v22, v23, v39, annot from aggJoin7618444821035252276 join aggView3678086442765611087 using(v33);
create or replace view aggView1068429778070875598 as select v10, v49, SUM(annot) as annot from aggJoin5976155576981642820 group by v10,v49;
create or replace view aggJoin5356825932193160031 as select v33, v10, v21, v22, v23, v39, aggJoin4993880090958873859.annot * aggView1068429778070875598.annot as annot, v49 from aggJoin4993880090958873859 join aggView1068429778070875598 using(v10);
create or replace view aggView7285050377914623266 as select v33, v10, v36 from semiDown380286626122587162;
create or replace view aggJoin4838041611458563613 as select v21, v22, v23, v39, annot, v49, v36 from aggJoin5356825932193160031 join aggView7285050377914623266 using(v33,v10);
create or replace view res as select v49, v39, SUM((v22 * (1 - v23))*annot) as v54, SUM((v36 * v21)*annot) as v55 from aggJoin4838041611458563613 group by v49, v39;
select sum(v49+v39+v54+v55) from res;
