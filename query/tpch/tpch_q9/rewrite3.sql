create or replace view aggView7686532726633142518 as select n_nationkey as v13, n_name as v49 from nation as nation;
create or replace view aggView6000058506958812577 as select o_orderkey as v38, o_year as v39 from orderswithyear as orderswithyear;
create or replace view aggView6026189687841160691 as select ps_partkey as v33, ps_suppkey as v10, ps_supplycost as v36 from partsupp as partsupp;
create or replace view aggJoin4856092466361011134 as select l_orderkey as v38, l_partkey as v33, l_suppkey as v10, l_quantity as v21, l_extendedprice as v22, l_discount as v23, v36 from lineitem as lineitem, aggView6026189687841160691 where lineitem.l_partkey=aggView6026189687841160691.v33 and lineitem.l_suppkey=aggView6026189687841160691.v10;
create or replace view aggView4217246184611387446 as select p_partkey as v33 from part as part where p_name LIKE '%green%';
create or replace view aggJoin7323183360886454856 as select v38, v10, v21, v22, v23, v36 from aggJoin4856092466361011134 join aggView4217246184611387446 using(v33);
create or replace view semiJoinView5745947675361386274 as select v38, v10, v21, v36, (v22 * (1 - v23)) as v54 from aggJoin7323183360886454856 where (v38) in (select (v38) from aggView6000058506958812577);
create or replace view semiJoinView5215019904508439067 as select s_suppkey as v10, s_nationkey as v13 from supplier AS supplier where (s_suppkey) in (select (v10) from semiJoinView5745947675361386274);
create or replace view semiJoinView2313360922986487032 as select distinct v13, v49 from aggView7686532726633142518 where (v13) in (select (v13) from semiJoinView5215019904508439067);
create or replace view semiEnum7523732822764298926 as select distinct v10, v49 from semiJoinView2313360922986487032 join semiJoinView5215019904508439067 using(v13);
create or replace view semiEnum2499217880125656334 as select distinct v36, v49, v54, v21, v38 from semiEnum7523732822764298926 join semiJoinView5745947675361386274 using(v10);
create or replace view semiEnum8961977197808260970 as select v36, v49, v39, v54, v21 from semiEnum2499217880125656334 join aggView6000058506958812577 using(v38);
select v49,v39,SUM(v54) as v54,SUM((v36 * v21)) as v55 from semiEnum8961977197808260970 group by v49, v39;
