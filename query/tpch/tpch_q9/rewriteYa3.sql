create or replace view orderswithyearAux24 as select o_orderkey as v38, o_year as v39 from orderswithyear;
create or replace view nationAux38 as select n_nationkey as v13, n_name as v49 from nation;
create or replace view semiUp6612119939438647241 as select s_suppkey as v10, s_nationkey as v13 from supplier AS supplier where (s_nationkey) in (select v13 from nationAux38);
create or replace view semiUp4259083737211014803 as select l_orderkey as v38, l_partkey as v33, l_suppkey as v10, l_quantity as v21, l_extendedprice as v22, l_discount as v23 from lineitem AS lineitem where (l_partkey) in (select p_partkey from part AS part where p_name LIKE '%green%');
create or replace view semiUp4469388347389059644 as select v38, v33, v10, v21, v22, v23 from semiUp4259083737211014803 where (v10) in (select v10 from semiUp6612119939438647241);
create or replace view semiUp7409587342943024460 as select v38, v33, v10, v21, v22, v23 from semiUp4469388347389059644 where (v33, v10) in (select ps_partkey, ps_suppkey from partsupp AS partsupp);
create or replace view semiUp9027222038563601579 as select v38, v39 from orderswithyearAux24 where (v38) in (select v38 from semiUp7409587342943024460);
create or replace view semiDown7136958867284898987 as select o_orderkey as v38, o_year as v39 from orderswithyear AS orderswithyear where (o_orderkey, o_year) in (select v38, v39 from semiUp9027222038563601579);
create or replace view semiDown2534900576831707611 as select v38, v33, v10, v21, v22, v23 from semiUp7409587342943024460 where (v38) in (select v38 from semiUp9027222038563601579);
create or replace view semiDown1613067351478405936 as select v10, v13 from semiUp6612119939438647241 where (v10) in (select v10 from semiDown2534900576831707611);
create or replace view semiDown4476563672629172590 as select p_partkey as v33 from part AS part where (p_partkey) in (select v33 from semiDown2534900576831707611) and p_name LIKE '%green%';
create or replace view semiDown351056320552974696 as select ps_partkey as v33, ps_suppkey as v10, ps_supplycost as v36 from partsupp AS partsupp where (ps_partkey, ps_suppkey) in (select v33, v10 from semiDown2534900576831707611);
create or replace view semiDown1809229355621512223 as select v13, v49 from nationAux38 where (v13) in (select v13 from semiDown1613067351478405936);
create or replace view semiDown5907476661288258896 as select n_nationkey as v13, n_name as v49 from nation AS nation where (n_name, n_nationkey) in (select v49, v13 from semiDown1809229355621512223);
create or replace view aggView3648279544166007740 as select v38, v39 from semiDown7136958867284898987;
create or replace view aggView5501681817504404456 as select v49, v13 from semiDown5907476661288258896;
create or replace view aggView882152364738268713 as select v33, v10, v36 from semiDown351056320552974696;
create or replace view aggJoin1761796355476163439 as select v38, v33, v10, v21, v22, v23, v36 from semiDown2534900576831707611 join aggView882152364738268713 using(v33,v10);
create or replace view aggView6961707744693114905 as select v13, v49, COUNT(*) as annot from aggView5501681817504404456 group by v13,v49;
create or replace view aggJoin8367940982423843819 as select v10, v49, annot from semiDown1613067351478405936 join aggView6961707744693114905 using(v13);
create or replace view aggView5610073996853316227 as select v33 from semiDown4476563672629172590;
create or replace view aggJoin4893243600396003096 as select v38, v10, v21, v22, v23, v36 from aggJoin1761796355476163439 join aggView5610073996853316227 using(v33);
create or replace view aggView1810954655462726003 as select v10, v49, SUM(annot) as annot from aggJoin8367940982423843819 group by v10,v49;
create or replace view aggJoin1674087452916134317 as select v38, v21, v22, v23, v36, v49, annot from aggJoin4893243600396003096 join aggView1810954655462726003 using(v10);
create or replace view aggView4467997379003266133 as select v38, SUM((v22 * (1 - v23)) * annot) as v54, SUM((v36 * v21) * annot) as v55, v49, SUM(annot) as annot from aggJoin1674087452916134317 group by v38,v49;
create or replace view aggJoin1753573788049406982 as select v39, v54, v55, v49 from aggView3648279544166007740 join aggView4467997379003266133 using(v38);
create or replace view res as select v49, v39, SUM(v54) as v54, SUM(v55) as v55 from aggJoin1753573788049406982 group by v49, v39;
select sum(v49+v39+v54+v55) from res;
