create or replace view orderswithyearAux22 as select o_orderkey as v38, o_year as v39 from orderswithyear;
create or replace view nationAux29 as select n_nationkey as v13, n_name as v49 from nation;
create or replace view semiUp135123915723268721 as select l_orderkey as v38, l_partkey as v33, l_suppkey as v10, l_quantity as v21, l_extendedprice as v22, l_discount as v23 from lineitem AS lineitem where (l_orderkey) in (select v38 from orderswithyearAux22);
create or replace view semiUp4720496579538720007 as select s_suppkey as v10, s_nationkey as v13 from supplier AS supplier where (s_nationkey) in (select v13 from nationAux29);
create or replace view semiUp3257068406194685577 as select v38, v33, v10, v21, v22, v23 from semiUp135123915723268721 where (v10) in (select v10 from semiUp4720496579538720007);
create or replace view semiUp2830861059940629205 as select ps_partkey as v33, ps_suppkey as v10, ps_supplycost as v36 from partsupp AS partsupp where (ps_partkey) in (select p_partkey from part AS part where p_name LIKE '%green%');
create or replace view semiUp7399115805359538065 as select v38, v33, v10, v21, v22, v23 from semiUp3257068406194685577 where (v33, v10) in (select v33, v10 from semiUp2830861059940629205);
create or replace view semiDown5613452222226480727 as select v10, v13 from semiUp4720496579538720007 where (v10) in (select v10 from semiUp7399115805359538065);
create or replace view semiDown8879161898127925984 as select v33, v10, v36 from semiUp2830861059940629205 where (v33, v10) in (select v33, v10 from semiUp7399115805359538065);
create or replace view semiDown1517718781873480142 as select v38, v39 from orderswithyearAux22 where (v38) in (select v38 from semiUp7399115805359538065);
create or replace view semiDown1878381061011776183 as select v13, v49 from nationAux29 where (v13) in (select v13 from semiDown5613452222226480727);
create or replace view semiDown62498567005809600 as select p_partkey as v33 from part AS part where (p_partkey) in (select v33 from semiDown8879161898127925984) and p_name LIKE '%green%';
create or replace view semiDown8786882621292197229 as select o_orderkey as v38, o_year as v39 from orderswithyear AS orderswithyear where (o_orderkey, o_year) in (select v38, v39 from semiDown1517718781873480142);
create or replace view semiDown1240032497640550076 as select n_nationkey as v13, n_name as v49 from nation AS nation where (n_name, n_nationkey) in (select v49, v13 from semiDown1878381061011776183);
create or replace view aggView8326481116096856727 as select v38, v39 from semiDown8786882621292197229;
create or replace view aggView184230651126234595 as select v49, v13 from semiDown1240032497640550076;
create or replace view aggView7771807061066846079 as select v33 from semiDown62498567005809600;
create or replace view aggJoin6673764727771493265 as select v33, v10, v36 from semiDown8879161898127925984 join aggView7771807061066846079 using(v33);
create or replace view aggView8344937508879024313 as select v38, v39, COUNT(*) as annot from aggView8326481116096856727 group by v38,v39;
create or replace view aggJoin1903302311766327541 as select v33, v10, v21, v22, v23, v39, annot from semiUp7399115805359538065 join aggView8344937508879024313 using(v38);
create or replace view aggView4602052073257654831 as select v33, v10, SUM(v36)/COUNT(*) as v36, COUNT(*) as annot from aggJoin6673764727771493265 group by v33,v10;
create or replace view aggJoin1170385592583978792 as select v10, v21, v22, v23, v39, aggJoin1903302311766327541.annot * aggView4602052073257654831.annot as annot, v36 from aggJoin1903302311766327541 join aggView4602052073257654831 using(v33,v10);
create or replace view aggView4028534060805384068 as select v13, v49, COUNT(*) as annot from aggView184230651126234595 group by v13,v49;
create or replace view aggJoin8959484076462694687 as select v10, v49, annot from semiDown5613452222226480727 join aggView4028534060805384068 using(v13);
create or replace view aggView7750612595459227426 as select v10, v49, SUM(annot) as annot from aggJoin8959484076462694687 group by v10,v49;
create or replace view aggJoin6866229826135348333 as select v21, v22, v23, v39, aggJoin1170385592583978792.annot * aggView7750612595459227426.annot as annot, v36, v49 from aggJoin1170385592583978792 join aggView7750612595459227426 using(v10);
create or replace view res as select v49, v39, SUM((v22 * (1 - v23))*annot) as v54, SUM((v36 * v21)*annot) as v55 from aggJoin6866229826135348333 group by v49, v39;
select sum(v49+v39+v54+v55) from res;
