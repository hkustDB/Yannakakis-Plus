create or replace view nationAux38 as select n_nationkey as v13, n_name as v49 from nation;
create or replace view orderswithyearAux24 as select o_orderkey as v38, o_year as v39 from orderswithyear;
create or replace view semiUp114260975874536028 as select l_orderkey as v38, l_partkey as v33, l_suppkey as v10, l_quantity as v21, l_extendedprice as v22, l_discount as v23 from lineitem AS lineitem where (l_partkey) in (select p_partkey from part AS part where p_name LIKE '%green%');
create or replace view semiUp8303597563129226693 as select v38, v33, v10, v21, v22, v23 from semiUp114260975874536028 where (v33, v10) in (select ps_partkey, ps_suppkey from partsupp AS partsupp);
create or replace view semiUp1260664995431020697 as select v38, v33, v10, v21, v22, v23 from semiUp8303597563129226693 where (v38) in (select v38 from orderswithyearAux24);
create or replace view semiUp4230041016525526292 as select s_suppkey as v10, s_nationkey as v13 from supplier AS supplier where (s_suppkey) in (select v10 from semiUp1260664995431020697);
create or replace view semiUp6118107700489075768 as select v10, v13 from semiUp4230041016525526292 where (v13) in (select v13 from nationAux38);
create or replace view semiDown8770699396026257053 as select v38, v33, v10, v21, v22, v23 from semiUp1260664995431020697 where (v10) in (select v10 from semiUp6118107700489075768);
create or replace view semiDown2539302721924246064 as select v13, v49 from nationAux38 where (v13) in (select v13 from semiUp6118107700489075768);
create or replace view semiDown7018310284194246613 as select p_partkey as v33 from part AS part where (p_partkey) in (select v33 from semiDown8770699396026257053) and p_name LIKE '%green%';
create or replace view semiDown8581003337571791 as select ps_partkey as v33, ps_suppkey as v10, ps_supplycost as v36 from partsupp AS partsupp where (ps_partkey, ps_suppkey) in (select v33, v10 from semiDown8770699396026257053);
create or replace view semiDown6890210988687944498 as select v38, v39 from orderswithyearAux24 where (v38) in (select v38 from semiDown8770699396026257053);
create or replace view semiDown5261131959786718173 as select n_nationkey as v13, n_name as v49 from nation AS nation where (n_name, n_nationkey) in (select v49, v13 from semiDown2539302721924246064);
create or replace view semiDown5774677327428696511 as select o_orderkey as v38, o_year as v39 from orderswithyear AS orderswithyear where (o_orderkey, o_year) in (select v38, v39 from semiDown6890210988687944498);
create or replace view aggView5817794780720706939 as select v49, v13 from semiDown5261131959786718173;
create or replace view aggView1971029262847796987 as select v38, v39 from semiDown5774677327428696511;
create or replace view aggView8322794604689575834 as select v33 from semiDown7018310284194246613;
create or replace view aggJoin8063498250285662890 as select v38, v33, v10, v21, v22, v23 from semiDown8770699396026257053 join aggView8322794604689575834 using(v33);
create or replace view aggView4055023492993972488 as select v33, v10, v36 from semiDown8581003337571791;
create or replace view aggJoin3736215728882654601 as select v38, v10, v21, v22, v23, v36 from aggJoin8063498250285662890 join aggView4055023492993972488 using(v33,v10);
create or replace view aggView4278273823989673604 as select v38, v39, COUNT(*) as annot from aggView1971029262847796987 group by v38,v39;
create or replace view aggJoin3717119233965941100 as select v10, v21, v22, v23, v36, v39, annot from aggJoin3736215728882654601 join aggView4278273823989673604 using(v38);
create or replace view aggView7266474435392924904 as select v10, SUM((v22 * (1 - v23)) * annot) as v54, SUM((v36 * v21) * annot) as v55, v39, SUM(annot) as annot from aggJoin3717119233965941100 group by v10,v39;
create or replace view aggJoin226786350650127408 as select v13, v54, v55, v39, annot from semiUp6118107700489075768 join aggView7266474435392924904 using(v10);
create or replace view aggView5090426102391257243 as select v13, v49, COUNT(*) as annot from aggView5817794780720706939 group by v13,v49;
create or replace view aggJoin5956217203579218452 as select v54*aggView5090426102391257243.annot as v54, v55*aggView5090426102391257243.annot as v55, v39, v49 from aggJoin226786350650127408 join aggView5090426102391257243 using(v13);
create or replace view res as select v49, v39, SUM(v54) as v54, SUM(v55) as v55 from aggJoin5956217203579218452 group by v49, v39;
select sum(v49+v39+v54+v55) from res;
