create or replace view aggView3189711193641081231 as select n_nationkey as v13, n_name as v49 from nation as nation;
create or replace view aggView2059016303142811515 as select o_year as v39, o_orderkey as v38 from orderswithyear as orderswithyear;
create or replace view aggView4254004110991716037 as select ps_partkey as v33, ps_suppkey as v10, ps_supplycost as v36 from partsupp as partsupp;
create or replace view aggJoin6942900276220313080 as select l_orderkey as v38, l_partkey as v33, l_suppkey as v10, l_quantity as v21, l_extendedprice as v22, l_discount as v23, v36 from lineitem as lineitem, aggView4254004110991716037 where lineitem.l_partkey=aggView4254004110991716037.v33 and lineitem.l_suppkey=aggView4254004110991716037.v10;
create or replace view aggView3990735572683379284 as select p_partkey as v33 from part as part where p_name LIKE '%green%';
create or replace view aggJoin7781922488996059718 as select v38, v10, v21, v22, v23, v36 from aggJoin6942900276220313080 join aggView3990735572683379284 using(v33);
create or replace view semiJoinView1635624134246832931 as select s_suppkey as v10, s_nationkey as v13 from supplier AS supplier where (s_nationkey) in (select v13 from aggView3189711193641081231);
create or replace view semiJoinView3501246778396611024 as select v38, v10, v21, v36, (v22 * (1 - v23)) as v54 from aggJoin7781922488996059718 where (v10) in (select v10 from semiJoinView1635624134246832931);
create or replace view semiJoinView5330412392357311176 as select v39, v38 from aggView2059016303142811515 where (v38) in (select v38 from semiJoinView3501246778396611024);
create or replace view semiEnum5932872704533995607 as select v39, v10, v36, v54, v21 from semiJoinView5330412392357311176 join semiJoinView3501246778396611024 using(v38);
create or replace view semiEnum7621674840884207983 as select v39, v13, v36, v54, v21 from semiEnum5932872704533995607 join semiJoinView1635624134246832931 using(v10);
create or replace view semiEnum8912383535509891565 as select v39, v49, v36, v54, v21 from semiEnum7621674840884207983 join aggView3189711193641081231 using(v13);
create or replace view res as select v49, v39, SUM(v54) as v54, SUM((v36 * v21)) as v55 from semiEnum8912383535509891565 group by v49, v39;
select sum(v49), sum(v39), sum(v54), sum(v55) from res;
