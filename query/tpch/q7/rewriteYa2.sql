create or replace view n1Aux31 as select n_nationkey as v4, n_name as v42 from nation where n_name= 'FRANCE';
create or replace view n2Aux74 as select n_nationkey as v36, n_name as v46 from nation;
create or replace view semiUp7242367958329481527 as select c_custkey as v33, c_nationkey as v36 from customer AS customer where (c_nationkey) in (select (v36) from n2Aux74);
create or replace view semiUp4404661421486812607 as select o_orderkey as v24, o_custkey as v33 from orders AS orders where (o_custkey) in (select (v33) from semiUp7242367958329481527);
create or replace view semiUp5571205082255554946 as select l_orderkey as v24, l_suppkey as v1, l_extendedprice as v13, l_discount as v14, EXTRACT(YEAR FROM l_shipdate) as v49 from lineitem AS lineitem where (l_orderkey) in (select (v24) from semiUp4404661421486812607) and l_shipdate>=DATE '1995-01-01' and l_shipdate<=DATE '1996-12-31';
create or replace view semiUp7999524126329080677 as select s_suppkey as v1, s_nationkey as v4 from supplier AS supplier where (s_suppkey) in (select (v1) from semiUp5571205082255554946);
create or replace view semiUp7676431839401969746 as select v4, v42 from n1Aux31 where (v4) in (select (v4) from semiUp7999524126329080677);
create or replace view semiDown5769202155302941957 as select v1, v4 from semiUp7999524126329080677 where (v4) in (select (v4) from semiUp7676431839401969746);
create or replace view semiDown2118454583910649893 as select n_nationkey as v4, n_name as v42 from nation AS n1 where (n_nationkey, n_name) in (select (v4, v42) from semiUp7676431839401969746) and n_name= 'FRANCE';
create or replace view semiDown3762482288940492143 as select v24, v1, v13, v14, v49 from semiUp5571205082255554946 where (v1) in (select (v1) from semiDown5769202155302941957);
create or replace view semiDown7390681696496437908 as select v24, v33 from semiUp4404661421486812607 where (v24) in (select (v24) from semiDown3762482288940492143);
create or replace view semiDown5719433503152520928 as select v33, v36 from semiUp7242367958329481527 where (v33) in (select (v33) from semiDown7390681696496437908);
create or replace view semiDown4087505115030929894 as select v36, v46 from n2Aux74 where (v36) in (select (v36) from semiDown5719433503152520928);
create or replace view semiDown2626877656714937634 as select n_nationkey as v36, n_name as v46 from nation AS n2 where (n_nationkey, n_name) in (select (v36, v46) from semiDown4087505115030929894);
create or replace view aggView2974705458696817485 as select v4, v42 from semiDown2118454583910649893;
create or replace view aggView4271221056528379847 as select v36, v46 from semiDown2626877656714937634;
create or replace view aggView4841429388471910269 as select v36, v46, COUNT(*) as annot from aggView4271221056528379847 group by v36,v46;
create or replace view aggJoin446640625703333965 as select v33, v46, annot from semiDown5719433503152520928 join aggView4841429388471910269 using(v36);
create or replace view aggView4552176883436876618 as select v33, v46, SUM(annot) as annot from aggJoin446640625703333965 group by v33,v46;
create or replace view aggJoin574878456797946335 as select v24, v46, annot from semiDown7390681696496437908 join aggView4552176883436876618 using(v33);
create or replace view aggView4686517025304005872 as select v24, v46, SUM(annot) as annot from aggJoin574878456797946335 group by v24,v46;
create or replace view aggJoin5877538006477732875 as select v1, v13, v14, v49, v46, annot from semiDown3762482288940492143 join aggView4686517025304005872 using(v24);
create or replace view aggView7014341156450591327 as select v1, SUM((v13 * (1 - v14)) * annot) as v51, v49, v46, SUM(annot) as annot from aggJoin5877538006477732875 group by v1,v49,v46;
create or replace view aggJoin6102471661905445122 as select v4, v51, v49, v46, annot from semiDown5769202155302941957 join aggView7014341156450591327 using(v1);
create or replace view aggView4552458138598244623 as select v4, SUM(v51) as v51, v49, v46, SUM(annot) as annot from aggJoin6102471661905445122 group by v4,v49,v46;
create or replace view aggJoin3637938991829627452 as select v42, v51, v49, v46 from aggView2974705458696817485 join aggView4552458138598244623 using(v4);
select v42,v46,v49,SUM(v51) as v51 from aggJoin3637938991829627452 group by v42, v46, v49;
