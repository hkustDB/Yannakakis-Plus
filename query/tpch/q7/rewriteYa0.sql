create or replace view n2Aux74 as select n_nationkey as v36, n_name as v46 from nation;
create or replace view n1Aux31 as select n_nationkey as v4, n_name as v42 from nation where n_name= 'FRANCE';
create or replace view semiUp4036193963502370539 as select s_suppkey as v1, s_nationkey as v4 from supplier AS supplier where (s_nationkey) in (select (v4) from n1Aux31);
create or replace view semiUp2590902780617209633 as select c_custkey as v33, c_nationkey as v36 from customer AS customer where (c_nationkey) in (select (v36) from n2Aux74);
create or replace view semiUp4904982917343836213 as select o_orderkey as v24, o_custkey as v33 from orders AS orders where (o_custkey) in (select (v33) from semiUp2590902780617209633);
create or replace view semiUp7104485876664316189 as select l_orderkey as v24, l_suppkey as v1, l_extendedprice as v13, l_discount as v14, EXTRACT(YEAR FROM l_shipdate) as v49 from lineitem AS lineitem where (l_orderkey) in (select (v24) from semiUp4904982917343836213) and l_shipdate>=DATE '1995-01-01' and l_shipdate<=DATE '1996-12-31';
create or replace view semiUp2245327583094301253 as select v1, v4 from semiUp4036193963502370539 where (v1) in (select (v1) from semiUp7104485876664316189);
create or replace view semiDown1811220097618465794 as select v4, v42 from n1Aux31 where (v4) in (select (v4) from semiUp2245327583094301253);
create or replace view semiDown5969447451573104933 as select v24, v1, v13, v14, v49 from semiUp7104485876664316189 where (v1) in (select (v1) from semiUp2245327583094301253);
create or replace view semiDown5808837451064735806 as select n_nationkey as v4, n_name as v42 from nation AS n1 where (n_nationkey, n_name) in (select (v4, v42) from semiDown1811220097618465794) and n_name= 'FRANCE';
create or replace view semiDown7834169403105149938 as select v24, v33 from semiUp4904982917343836213 where (v24) in (select (v24) from semiDown5969447451573104933);
create or replace view semiDown5283167292137650101 as select v33, v36 from semiUp2590902780617209633 where (v33) in (select (v33) from semiDown7834169403105149938);
create or replace view semiDown4101347748324776440 as select v36, v46 from n2Aux74 where (v36) in (select (v36) from semiDown5283167292137650101);
create or replace view semiDown3972919407018599855 as select n_nationkey as v36, n_name as v46 from nation AS n2 where (n_nationkey, n_name) in (select (v36, v46) from semiDown4101347748324776440);
create or replace view aggView5656644489725102165 as select v4, v42 from semiDown5808837451064735806;
create or replace view aggView1005723501251565017 as select v36, v46 from semiDown3972919407018599855;
create or replace view aggView420705724003015265 as select v4, v42, COUNT(*) as annot from aggView5656644489725102165 group by v4,v42;
create or replace view aggJoin7873782183926116464 as select v1, v42, annot from semiUp2245327583094301253 join aggView420705724003015265 using(v4);
create or replace view aggView2792955742725870302 as select v36, v46, COUNT(*) as annot from aggView1005723501251565017 group by v36,v46;
create or replace view aggJoin50084642444000544 as select v33, v46, annot from semiDown5283167292137650101 join aggView2792955742725870302 using(v36);
create or replace view aggView6804380881779001921 as select v33, v46, SUM(annot) as annot from aggJoin50084642444000544 group by v33,v46;
create or replace view aggJoin3912674677386576606 as select v24, v46, annot from semiDown7834169403105149938 join aggView6804380881779001921 using(v33);
create or replace view aggView6116383557451219225 as select v24, v46, SUM(annot) as annot from aggJoin3912674677386576606 group by v24,v46;
create or replace view aggJoin1726276969683533156 as select v1, v13, v14, v49, v46, annot from semiDown5969447451573104933 join aggView6116383557451219225 using(v24);
create or replace view aggView7500056149029351538 as select v1, SUM((v13 * (1 - v14)) * annot) as v51, v49, v46, SUM(annot) as annot from aggJoin1726276969683533156 group by v1,v49,v46;
create or replace view aggJoin4170368531446415790 as select v42, v51 * aggJoin7873782183926116464.annot as v51, v49, v46 from aggJoin7873782183926116464 join aggView7500056149029351538 using(v1);
select v42,v46,v49,SUM(v51) as v51 from aggJoin4170368531446415790 group by v42, v46, v49;
