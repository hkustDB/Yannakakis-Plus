create or replace view n2Aux66 as select n_nationkey as v36, n_name as v46 from nation where n_name= 'GERMANY';
create or replace view n1Aux39 as select n_nationkey as v4, n_name as v42 from nation where n_name= 'FRANCE';
create or replace view semiUp8414402844528577640 as select s_suppkey as v1, s_nationkey as v4 from supplier AS supplier where (s_nationkey) in (select v4 from n1Aux39);
create or replace view semiUp2372331563332882972 as select c_custkey as v33, c_nationkey as v36 from customer AS customer where (c_nationkey) in (select v36 from n2Aux66);
create or replace view semiUp8639273411490697306 as select l_orderkey as v24, l_suppkey as v1, l_extendedprice as v13, l_discount as v14, EXTRACT(YEAR FROM l_shipdate) as v49 from lineitem AS lineitem where (l_suppkey) in (select v1 from semiUp8414402844528577640) and l_shipdate>=DATE '1995-01-01' and l_shipdate<=DATE '1996-12-31';
create or replace view semiUp7150527609151814907 as select o_orderkey as v24, o_custkey as v33 from orders AS orders where (o_custkey) in (select v33 from semiUp2372331563332882972);
create or replace view semiUp1664652838824277175 as select v24, v1, v13, v14, v49 from semiUp8639273411490697306 where (v24) in (select v24 from semiUp7150527609151814907);
create or replace view semiDown6639060897341503730 as select v24, v33 from semiUp7150527609151814907 where (v24) in (select v24 from semiUp1664652838824277175);
create or replace view semiDown700721893039382367 as select v1, v4 from semiUp8414402844528577640 where (v1) in (select v1 from semiUp1664652838824277175);
create or replace view semiDown7034573172844439698 as select v33, v36 from semiUp2372331563332882972 where (v33) in (select v33 from semiDown6639060897341503730);
create or replace view semiDown4992206456067745167 as select v4, v42 from n1Aux39 where (v4) in (select v4 from semiDown700721893039382367);
create or replace view semiDown2348512637570497864 as select v36, v46 from n2Aux66 where (v36) in (select v36 from semiDown7034573172844439698);
create or replace view semiDown6362614626414461421 as select n_nationkey as v4, n_name as v42 from nation AS n1 where (n_name, n_nationkey) in (select v42, v4 from semiDown4992206456067745167) and n_name= 'FRANCE';
create or replace view semiDown2923602953282117030 as select n_nationkey as v36, n_name as v46 from nation AS n2 where (n_name, n_nationkey) in (select v46, v36 from semiDown2348512637570497864) and n_name= 'GERMANY';
create or replace view aggView468213553947826462 as select v42, v4 from semiDown6362614626414461421;
create or replace view aggView7566051664142147568 as select v46, v36 from semiDown2923602953282117030;
create or replace view aggView8423842208222981379 as select v4, v42, COUNT(*) as annot from aggView468213553947826462 group by v4,v42;
create or replace view aggJoin443420104293475194 as select v1, v42, annot from semiDown700721893039382367 join aggView8423842208222981379 using(v4);
create or replace view aggView1710479287666449779 as select v1, v42, SUM(annot) as annot from aggJoin443420104293475194 group by v1,v42;
create or replace view aggJoin5327654254625360098 as select v24, v13, v14, v49, v42, annot from semiUp1664652838824277175 join aggView1710479287666449779 using(v1);
create or replace view aggView3664350641702098812 as select v36, v46, COUNT(*) as annot from aggView7566051664142147568 group by v36,v46;
create or replace view aggJoin5053082338371594647 as select v33, v46, annot from semiDown7034573172844439698 join aggView3664350641702098812 using(v36);
create or replace view aggView1905371397515567909 as select v33, v46, SUM(annot) as annot from aggJoin5053082338371594647 group by v33,v46;
create or replace view aggJoin2680493313072338643 as select v24, v46, annot from semiDown6639060897341503730 join aggView1905371397515567909 using(v33);
create or replace view aggView3180017439530830311 as select v24, v46, SUM(annot) as annot from aggJoin2680493313072338643 group by v24,v46;
create or replace view aggJoin2166762761617652058 as select v13, v14, v49, v42, aggJoin5327654254625360098.annot * aggView3180017439530830311.annot as annot, v46 from aggJoin5327654254625360098 join aggView3180017439530830311 using(v24);
create or replace view res as select v42, v46, v49, SUM((v13 * (1 - v14))*annot) as v51 from aggJoin2166762761617652058 group by v42, v46, v49;
select sum(v42+v46+v49+v51) from res;
