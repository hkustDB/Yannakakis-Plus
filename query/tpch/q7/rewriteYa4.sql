create or replace view n1Aux39 as select n_nationkey as v4, n_name as v42 from nation where n_name= 'FRANCE';
create or replace view n2Aux66 as select n_nationkey as v36, n_name as v46 from nation where n_name= 'GERMANY';
create or replace view semiUp957106831587231153 as select c_custkey as v33, c_nationkey as v36 from customer AS customer where (c_nationkey) in (select v36 from n2Aux66);
create or replace view semiUp4320679475502351670 as select o_orderkey as v24, o_custkey as v33 from orders AS orders where (o_custkey) in (select v33 from semiUp957106831587231153);
create or replace view semiUp7193160093194253090 as select l_orderkey as v24, l_suppkey as v1, l_extendedprice as v13, l_discount as v14, EXTRACT(YEAR FROM l_shipdate) as v49 from lineitem AS lineitem where (l_orderkey) in (select v24 from semiUp4320679475502351670) and l_shipdate>=DATE '1995-01-01' and l_shipdate<=DATE '1996-12-31';
create or replace view semiUp698577747788267480 as select s_suppkey as v1, s_nationkey as v4 from supplier AS supplier where (s_suppkey) in (select v1 from semiUp7193160093194253090);
create or replace view semiUp5360511905700726181 as select v4, v42 from n1Aux39 where (v4) in (select v4 from semiUp698577747788267480);
create or replace view semiDown7859149367903357393 as select v1, v4 from semiUp698577747788267480 where (v4) in (select v4 from semiUp5360511905700726181);
create or replace view semiDown5344735522083445232 as select n_nationkey as v4, n_name as v42 from nation AS n1 where (n_name, n_nationkey) in (select v42, v4 from semiUp5360511905700726181) and n_name= 'FRANCE';
create or replace view semiDown6675490497914328311 as select v24, v1, v13, v14, v49 from semiUp7193160093194253090 where (v1) in (select v1 from semiDown7859149367903357393);
create or replace view semiDown8468088809433508170 as select v24, v33 from semiUp4320679475502351670 where (v24) in (select v24 from semiDown6675490497914328311);
create or replace view semiDown35474387788458368 as select v33, v36 from semiUp957106831587231153 where (v33) in (select v33 from semiDown8468088809433508170);
create or replace view semiDown820827536611805511 as select v36, v46 from n2Aux66 where (v36) in (select v36 from semiDown35474387788458368);
create or replace view semiDown7754432581617596503 as select n_nationkey as v36, n_name as v46 from nation AS n2 where (n_name, n_nationkey) in (select v46, v36 from semiDown820827536611805511) and n_name= 'GERMANY';
create or replace view aggView4341650453658067903 as select v46, v36 from semiDown7754432581617596503;
create or replace view aggView8688174654843889600 as select v42, v4 from semiDown5344735522083445232;
create or replace view aggView3215233813222969505 as select v36, v46, COUNT(*) as annot from aggView4341650453658067903 group by v36,v46;
create or replace view aggJoin5800908212471323335 as select v33, v46, annot from semiDown35474387788458368 join aggView3215233813222969505 using(v36);
create or replace view aggView2756004741911854868 as select v33, v46, SUM(annot) as annot from aggJoin5800908212471323335 group by v33,v46;
create or replace view aggJoin931964864628915881 as select v24, v46, annot from semiDown8468088809433508170 join aggView2756004741911854868 using(v33);
create or replace view aggView7153735802182850343 as select v24, v46, SUM(annot) as annot from aggJoin931964864628915881 group by v24,v46;
create or replace view aggJoin3320492938310100994 as select v1, v13, v14, v49, v46, annot from semiDown6675490497914328311 join aggView7153735802182850343 using(v24);
create or replace view aggView498517067704575731 as select v1, SUM((v13 * (1 - v14)) * annot) as v51, v49, v46, SUM(annot) as annot from aggJoin3320492938310100994 group by v1,v49,v46;
create or replace view aggJoin6826396337556151120 as select v4, v51, v49, v46, annot from semiDown7859149367903357393 join aggView498517067704575731 using(v1);
create or replace view aggView4485426946065028177 as select v4, SUM(v51) as v51, v49, v46, SUM(annot) as annot from aggJoin6826396337556151120 group by v4,v49,v46;
create or replace view aggJoin3717375617252842180 as select v42, v51, v49, v46 from aggView8688174654843889600 join aggView4485426946065028177 using(v4);
create or replace view res as select v42, v46, v49, SUM(v51) as v51 from aggJoin3717375617252842180 group by v42, v46, v49;
select sum(v42+v46+v49+v51) from res;
