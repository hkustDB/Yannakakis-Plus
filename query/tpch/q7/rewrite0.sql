create or replace view aggView2226210348611153519 as select n_nationkey as v37, n_name as v47 from nation as n2 where n_name= 'GERMANY';
create or replace view aggJoin7993118947925091418 as select c_custkey as v34, v47 from customer as customer, aggView2226210348611153519 where customer.c_nationkey=aggView2226210348611153519.v37;
create or replace view aggView5985993795318552294 as select v34, v47, COUNT(*) as annot from aggJoin7993118947925091418 group by v34,v47;
create or replace view aggJoin771667297957170016 as select o_orderkey as v25, v47, annot from orders as orders, aggView5985993795318552294 where orders.o_custkey=aggView5985993795318552294.v34;
create or replace view aggView5457312980113136377 as select n_nationkey as v4, n_name as v43 from nation as n1 where n_name= 'FRANCE';
create or replace view aggJoin798136733718612476 as select s_suppkey as v1, v43 from supplier as supplier, aggView5457312980113136377 where supplier.s_nationkey=aggView5457312980113136377.v4;
create or replace view aggView8326367328862975119 as select v25, v47, SUM(annot) as annot from aggJoin771667297957170016 group by v25,v47;
create or replace view aggJoin4118002652495137938 as select l_year as v9, l_suppkey as v1, l_extendedprice as v14, l_discount as v15, l_shipdate as v19, v47, annot from lineitemwithyear as lineitemwithyear, aggView8326367328862975119 where lineitemwithyear.l_orderkey=aggView8326367328862975119.v25 and l_shipdate>=DATE '1995-01-01' and l_shipdate<=DATE '1996-12-31';
create or replace view aggView4602607584268564047 as select v1, v43, COUNT(*) as annot from aggJoin798136733718612476 group by v1,v43;
create or replace view aggJoin4943565278447978868 as select v9, v14, v15, v47, aggJoin4118002652495137938.annot * aggView4602607584268564047.annot as annot, v43 from aggJoin4118002652495137938 join aggView4602607584268564047 using(v1);
select v43,v47,v9,SUM((v14 * (1 - v15))*annot) as v51 from aggJoin4943565278447978868 group by v43, v47, v9;
