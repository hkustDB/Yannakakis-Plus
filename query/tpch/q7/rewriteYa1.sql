create or replace view n1Aux39 as select n_nationkey as v4, n_name as v42 from nation where n_name= 'FRANCE';
create or replace view n2Aux66 as select n_nationkey as v36, n_name as v46 from nation where n_name= 'GERMANY';
create or replace view semiUp8704242796754056065 as select c_custkey as v33, c_nationkey as v36 from customer AS customer where (c_nationkey) in (select v36 from n2Aux66);
create or replace view semiUp3530856527226675781 as select o_orderkey as v24, o_custkey as v33 from orders AS orders where (o_custkey) in (select v33 from semiUp8704242796754056065);
create or replace view semiUp205996116415824423 as select l_orderkey as v24, l_suppkey as v1, l_extendedprice as v13, l_discount as v14, EXTRACT(YEAR FROM l_shipdate) as v49 from lineitem AS lineitem where (l_orderkey) in (select v24 from semiUp3530856527226675781) and l_shipdate>=DATE '1995-01-01' and l_shipdate<=DATE '1996-12-31';
create or replace view semiUp294127875407140899 as select s_suppkey as v1, s_nationkey as v4 from supplier AS supplier where (s_nationkey) in (select v4 from n1Aux39);
create or replace view semiUp6937769609039463487 as select v1, v4 from semiUp294127875407140899 where (v1) in (select v1 from semiUp205996116415824423);
create or replace view semiDown212482279335922218 as select v24, v1, v13, v14, v49 from semiUp205996116415824423 where (v1) in (select v1 from semiUp6937769609039463487);
create or replace view semiDown5612730719079245798 as select v4, v42 from n1Aux39 where (v4) in (select v4 from semiUp6937769609039463487);
create or replace view semiDown437921609099546013 as select v24, v33 from semiUp3530856527226675781 where (v24) in (select v24 from semiDown212482279335922218);
create or replace view semiDown6719036912272072503 as select n_nationkey as v4, n_name as v42 from nation AS n1 where (n_name, n_nationkey) in (select v42, v4 from semiDown5612730719079245798) and n_name= 'FRANCE';
create or replace view semiDown6781542347100055207 as select v33, v36 from semiUp8704242796754056065 where (v33) in (select v33 from semiDown437921609099546013);
create or replace view semiDown491362081008374066 as select v36, v46 from n2Aux66 where (v36) in (select v36 from semiDown6781542347100055207);
create or replace view semiDown4991608852923678477 as select n_nationkey as v36, n_name as v46 from nation AS n2 where (n_name, n_nationkey) in (select v46, v36 from semiDown491362081008374066) and n_name= 'GERMANY';
create or replace view aggView1785638096184918277 as select v42, v4 from semiDown6719036912272072503;
create or replace view aggView3694655647058326000 as select v46, v36 from semiDown4991608852923678477;
create or replace view aggView6967875889072689426 as select v4, v42, COUNT(*) as annot from aggView1785638096184918277 group by v4,v42;
create or replace view aggJoin2926342792750638110 as select v1, v42, annot from semiUp6937769609039463487 join aggView6967875889072689426 using(v4);
create or replace view aggView1125791628061525877 as select v36, v46, COUNT(*) as annot from aggView3694655647058326000 group by v36,v46;
create or replace view aggJoin6197191178628456143 as select v33, v46, annot from semiDown6781542347100055207 join aggView1125791628061525877 using(v36);
create or replace view aggView4534384828224969924 as select v33, v46, SUM(annot) as annot from aggJoin6197191178628456143 group by v33,v46;
create or replace view aggJoin4700707843770120919 as select v24, v46, annot from semiDown437921609099546013 join aggView4534384828224969924 using(v33);
create or replace view aggView5117132436955031298 as select v24, v46, SUM(annot) as annot from aggJoin4700707843770120919 group by v24,v46;
create or replace view aggJoin6177285279593169765 as select v1, v13, v14, v49, v46, annot from semiDown212482279335922218 join aggView5117132436955031298 using(v24);
create or replace view aggView4320954469728134186 as select v1, SUM((v13 * (1 - v14)) * annot) as v51, v49, v46, SUM(annot) as annot from aggJoin6177285279593169765 group by v1,v49,v46;
create or replace view aggJoin7114354094051754231 as select v42, v51 * aggJoin2926342792750638110.annot as v51, v49, v46 from aggJoin2926342792750638110 join aggView4320954469728134186 using(v1);
create or replace view res as select v42, v46, v49, SUM(v51) as v51 from aggJoin7114354094051754231 group by v42, v46, v49;
select sum(v42+v46+v49+v51) from res;
