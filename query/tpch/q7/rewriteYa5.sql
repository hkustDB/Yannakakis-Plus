create or replace view n2Aux66 as select n_nationkey as v36, n_name as v46 from nation where n_name= 'GERMANY';
create or replace view n1Aux39 as select n_nationkey as v4, n_name as v42 from nation where n_name= 'FRANCE';
create or replace view semiUp6295143475074571243 as select c_custkey as v33, c_nationkey as v36 from customer AS customer where (c_nationkey) in (select v36 from n2Aux66);
create or replace view semiUp6362103154890541395 as select s_suppkey as v1, s_nationkey as v4 from supplier AS supplier where (s_nationkey) in (select v4 from n1Aux39);
create or replace view semiUp2971638043048045331 as select l_orderkey as v24, l_suppkey as v1, l_extendedprice as v13, l_discount as v14, EXTRACT(YEAR FROM l_shipdate) as v49 from lineitem AS lineitem where (l_suppkey) in (select v1 from semiUp6362103154890541395) and l_shipdate>=DATE '1995-01-01' and l_shipdate<=DATE '1996-12-31';
create or replace view semiUp6834338089203706274 as select o_orderkey as v24, o_custkey as v33 from orders AS orders where (o_orderkey) in (select v24 from semiUp2971638043048045331);
create or replace view semiUp2956142219141817816 as select v33, v36 from semiUp6295143475074571243 where (v33) in (select v33 from semiUp6834338089203706274);
create or replace view semiDown844050018588311463 as select v36, v46 from n2Aux66 where (v36) in (select v36 from semiUp2956142219141817816);
create or replace view semiDown7370078529900272239 as select v24, v33 from semiUp6834338089203706274 where (v33) in (select v33 from semiUp2956142219141817816);
create or replace view semiDown4344454250828023340 as select n_nationkey as v36, n_name as v46 from nation AS n2 where (n_name, n_nationkey) in (select v46, v36 from semiDown844050018588311463) and n_name= 'GERMANY';
create or replace view semiDown1049220566712131972 as select v24, v1, v13, v14, v49 from semiUp2971638043048045331 where (v24) in (select v24 from semiDown7370078529900272239);
create or replace view semiDown3669537437221375439 as select v1, v4 from semiUp6362103154890541395 where (v1) in (select v1 from semiDown1049220566712131972);
create or replace view semiDown4523404580533388177 as select v4, v42 from n1Aux39 where (v4) in (select v4 from semiDown3669537437221375439);
create or replace view semiDown4478170594432292258 as select n_nationkey as v4, n_name as v42 from nation AS n1 where (n_name, n_nationkey) in (select v42, v4 from semiDown4523404580533388177) and n_name= 'FRANCE';
create or replace view aggView4900952255642257244 as select v46, v36 from semiDown4344454250828023340;
create or replace view aggView2691389419714898666 as select v42, v4 from semiDown4478170594432292258;
create or replace view aggView256360727650318444 as select v36, v46, COUNT(*) as annot from aggView4900952255642257244 group by v36,v46;
create or replace view aggJoin5889112626721405718 as select v33, v46, annot from semiUp2956142219141817816 join aggView256360727650318444 using(v36);
create or replace view aggView8860989338755408632 as select v4, v42, COUNT(*) as annot from aggView2691389419714898666 group by v4,v42;
create or replace view aggJoin6575616786735260711 as select v1, v42, annot from semiDown3669537437221375439 join aggView8860989338755408632 using(v4);
create or replace view aggView1043609267154559019 as select v1, v42, SUM(annot) as annot from aggJoin6575616786735260711 group by v1,v42;
create or replace view aggJoin8021257873804497479 as select v24, v13, v14, v49, v42, annot from semiDown1049220566712131972 join aggView1043609267154559019 using(v1);
create or replace view aggView4194688515122022319 as select v24, SUM((v13 * (1 - v14)) * annot) as v51, v49, v42, SUM(annot) as annot from aggJoin8021257873804497479 group by v24,v49,v42;
create or replace view aggJoin4019345448335863997 as select v33, v51, v49, v42, annot from semiDown7370078529900272239 join aggView4194688515122022319 using(v24);
create or replace view aggView7728717656909239267 as select v33, SUM(v51) as v51, v49, v42, SUM(annot) as annot from aggJoin4019345448335863997 group by v33,v49,v42;
create or replace view aggJoin4310718587820321719 as select v46, v51 * aggJoin5889112626721405718.annot as v51, v49, v42 from aggJoin5889112626721405718 join aggView7728717656909239267 using(v33);
create or replace view res as select v42, v46, v49, SUM(v51) as v51 from aggJoin4310718587820321719 group by v42, v46, v49;
select sum(v42+v46+v49+v51) from res;
