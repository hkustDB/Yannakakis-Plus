create or replace view n1Aux31 as select n_nationkey as v4, n_name as v42 from nation where n_name= 'FRANCE';
create or replace view n2Aux74 as select n_nationkey as v36, n_name as v46 from nation;
create or replace view semiUp8105784631952117433 as select s_suppkey as v1, s_nationkey as v4 from supplier AS supplier where (s_nationkey) in (select (v4) from n1Aux31);
create or replace view semiUp790597877719608379 as select l_orderkey as v24, l_suppkey as v1, l_extendedprice as v13, l_discount as v14, EXTRACT(YEAR FROM l_shipdate) as v49 from lineitem AS lineitem where (l_suppkey) in (select (v1) from semiUp8105784631952117433) and l_shipdate>=DATE '1995-01-01' and l_shipdate<=DATE '1996-12-31';
create or replace view semiUp5981244723013329634 as select c_custkey as v33, c_nationkey as v36 from customer AS customer where (c_nationkey) in (select (v36) from n2Aux74);
create or replace view semiUp4910008220660010101 as select o_orderkey as v24, o_custkey as v33 from orders AS orders where (o_custkey) in (select (v33) from semiUp5981244723013329634);
create or replace view semiUp3176432322574816894 as select v24, v1, v13, v14, v49 from semiUp790597877719608379 where (v24) in (select (v24) from semiUp4910008220660010101);
create or replace view semiDown757409243645038958 as select v24, v33 from semiUp4910008220660010101 where (v24) in (select (v24) from semiUp3176432322574816894);
create or replace view semiDown1414694811158217246 as select v1, v4 from semiUp8105784631952117433 where (v1) in (select (v1) from semiUp3176432322574816894);
create or replace view semiDown3647109371815752730 as select v33, v36 from semiUp5981244723013329634 where (v33) in (select (v33) from semiDown757409243645038958);
create or replace view semiDown1409911828203869606 as select v4, v42 from n1Aux31 where (v4) in (select (v4) from semiDown1414694811158217246);
create or replace view semiDown8884852945124303840 as select v36, v46 from n2Aux74 where (v36) in (select (v36) from semiDown3647109371815752730);
create or replace view semiDown6184140113171188258 as select n_nationkey as v4, n_name as v42 from nation AS n1 where (n_nationkey, n_name) in (select (v4, v42) from semiDown1409911828203869606) and n_name= 'FRANCE';
create or replace view semiDown1823229833845453887 as select n_nationkey as v36, n_name as v46 from nation AS n2 where (n_nationkey, n_name) in (select (v36, v46) from semiDown8884852945124303840);
create or replace view aggView264275499939758244 as select v36, v46 from semiDown1823229833845453887;
create or replace view aggView8390038737204741973 as select v4, v42 from semiDown6184140113171188258;
create or replace view aggView5778520088822719690 as select v4, v42, COUNT(*) as annot from aggView8390038737204741973 group by v4,v42;
create or replace view aggJoin5994510051275009825 as select v1, v42, annot from semiDown1414694811158217246 join aggView5778520088822719690 using(v4);
create or replace view aggView8761600519451989029 as select v36, v46, COUNT(*) as annot from aggView264275499939758244 group by v36,v46;
create or replace view aggJoin5987741785254620956 as select v33, v46, annot from semiDown3647109371815752730 join aggView8761600519451989029 using(v36);
create or replace view aggView8566806275475577916 as select v1, v42, SUM(annot) as annot from aggJoin5994510051275009825 group by v1,v42;
create or replace view aggJoin5965551637386481742 as select v24, v13, v14, v49, v42, annot from semiUp3176432322574816894 join aggView8566806275475577916 using(v1);
create or replace view aggView2826257249242563606 as select v33, v46, SUM(annot) as annot from aggJoin5987741785254620956 group by v33,v46;
create or replace view aggJoin7436962339817019339 as select v24, v46, annot from semiDown757409243645038958 join aggView2826257249242563606 using(v33);
create or replace view aggView5807906200615355518 as select v24, v46, SUM(annot) as annot from aggJoin7436962339817019339 group by v24,v46;
create or replace view aggJoin1752870300556980159 as select v13, v14, v49, v42, aggJoin5965551637386481742.annot * aggView5807906200615355518.annot as annot, v46 from aggJoin5965551637386481742 join aggView5807906200615355518 using(v24);
select v42,v46,v49,SUM((v13 * (1 - v14))*annot) as v51 from aggJoin1752870300556980159 group by v42, v46, v49;
