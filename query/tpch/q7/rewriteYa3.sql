create or replace view n2Aux66 as select n_nationkey as v36, n_name as v46 from nation where n_name= 'GERMANY';
create or replace view n1Aux39 as select n_nationkey as v4, n_name as v42 from nation where n_name= 'FRANCE';
create or replace view semiUp6881518904565086131 as select s_suppkey as v1, s_nationkey as v4 from supplier AS supplier where (s_nationkey) in (select v4 from n1Aux39);
create or replace view semiUp7305531410761385713 as select c_custkey as v33, c_nationkey as v36 from customer AS customer where (c_nationkey) in (select v36 from n2Aux66);
create or replace view semiUp2490365263523719331 as select o_orderkey as v24, o_custkey as v33 from orders AS orders where (o_custkey) in (select v33 from semiUp7305531410761385713);
create or replace view semiUp5380691586142645399 as select l_orderkey as v24, l_suppkey as v1, l_extendedprice as v13, l_discount as v14, EXTRACT(YEAR FROM l_shipdate) as v49 from lineitem AS lineitem where (l_suppkey) in (select v1 from semiUp6881518904565086131) and l_shipdate>=DATE '1995-01-01' and l_shipdate<=DATE '1996-12-31';
create or replace view semiUp9182279521955288408 as select v24, v33 from semiUp2490365263523719331 where (v24) in (select v24 from semiUp5380691586142645399);
create or replace view semiDown385450290683571148 as select v24, v1, v13, v14, v49 from semiUp5380691586142645399 where (v24) in (select v24 from semiUp9182279521955288408);
create or replace view semiDown3735406743571295148 as select v33, v36 from semiUp7305531410761385713 where (v33) in (select v33 from semiUp9182279521955288408);
create or replace view semiDown4119217570839108444 as select v1, v4 from semiUp6881518904565086131 where (v1) in (select v1 from semiDown385450290683571148);
create or replace view semiDown4519330387422840608 as select v36, v46 from n2Aux66 where (v36) in (select v36 from semiDown3735406743571295148);
create or replace view semiDown8703718292703895729 as select v4, v42 from n1Aux39 where (v4) in (select v4 from semiDown4119217570839108444);
create or replace view semiDown3576639529261454441 as select n_nationkey as v36, n_name as v46 from nation AS n2 where (n_name, n_nationkey) in (select v46, v36 from semiDown4519330387422840608) and n_name= 'GERMANY';
create or replace view semiDown7056361962842744912 as select n_nationkey as v4, n_name as v42 from nation AS n1 where (n_name, n_nationkey) in (select v42, v4 from semiDown8703718292703895729) and n_name= 'FRANCE';
create or replace view aggView8287132158694452229 as select v46, v36 from semiDown3576639529261454441;
create or replace view aggView1292045026255176238 as select v42, v4 from semiDown7056361962842744912;
create or replace view aggView2933979808812560692 as select v36, v46, COUNT(*) as annot from aggView8287132158694452229 group by v36,v46;
create or replace view aggJoin5691487360723795455 as select v33, v46, annot from semiDown3735406743571295148 join aggView2933979808812560692 using(v36);
create or replace view aggView4263344741472451447 as select v33, v46, SUM(annot) as annot from aggJoin5691487360723795455 group by v33,v46;
create or replace view aggJoin2768785856694027626 as select v24, v46, annot from semiUp9182279521955288408 join aggView4263344741472451447 using(v33);
create or replace view aggView2513207073958451633 as select v4, v42, COUNT(*) as annot from aggView1292045026255176238 group by v4,v42;
create or replace view aggJoin717670366133974081 as select v1, v42, annot from semiDown4119217570839108444 join aggView2513207073958451633 using(v4);
create or replace view aggView1324372625197265236 as select v1, v42, SUM(annot) as annot from aggJoin717670366133974081 group by v1,v42;
create or replace view aggJoin7138745595804317989 as select v24, v13, v14, v49, v42, annot from semiDown385450290683571148 join aggView1324372625197265236 using(v1);
create or replace view aggView3791456691208003863 as select v24, SUM((v13 * (1 - v14)) * annot) as v51, v49, v42, SUM(annot) as annot from aggJoin7138745595804317989 group by v24,v49,v42;
create or replace view aggJoin7909474926226490684 as select v46, v51 * aggJoin2768785856694027626.annot as v51, v49, v42 from aggJoin2768785856694027626 join aggView3791456691208003863 using(v24);
create or replace view res as select v42, v46, v49, SUM(v51) as v51 from aggJoin7909474926226490684 group by v42, v46, v49;
select sum(v42+v46+v49+v51) from res;
