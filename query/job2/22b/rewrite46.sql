create or replace view aggView7706418802700765322 as select id as v1, name as v49 from company_name as cn where country_code<> '[us]';
create or replace view aggJoin1276240750337825459 as select movie_id as v37, company_type_id as v8, note as v23, v49 from movie_companies as mc, aggView7706418802700765322 where mc.company_id=aggView7706418802700765322.v1 and note NOT LIKE '%(USA)%' and note LIKE '%(200%)%';
create or replace view aggView7137651495153534741 as select id as v12 from info_type as it2 where info= 'rating';
create or replace view aggJoin3830022505233911932 as select movie_id as v37, info as v32 from movie_info_idx as mi_idx, aggView7137651495153534741 where mi_idx.info_type_id=aggView7137651495153534741.v12 and info<'7.0';
create or replace view aggView471805542601937810 as select id as v17 from kind_type as kt where kind IN ('movie','episode');
create or replace view aggJoin6597639696750588197 as select id as v37, title as v38 from title as t, aggView471805542601937810 where t.kind_id=aggView471805542601937810.v17 and production_year>2009;
create or replace view aggView9219917542991205198 as select v37, MIN(v38) as v51 from aggJoin6597639696750588197 group by v37;
create or replace view aggJoin3768886984879961002 as select v37, v32, v51 from aggJoin3830022505233911932 join aggView9219917542991205198 using(v37);
create or replace view aggView55288170418005745 as select v37, MIN(v51) as v51, MIN(v32) as v50 from aggJoin3768886984879961002 group by v37;
create or replace view aggJoin5421003825581303794 as select movie_id as v37, info_type_id as v10, v51, v50 from movie_info as mi, aggView55288170418005745 where mi.movie_id=aggView55288170418005745.v37 and info IN ('Germany','German','USA','American');
create or replace view aggView4104331933635605944 as select id as v10 from info_type as it1 where info= 'countries';
create or replace view aggJoin7415808373060362944 as select v37, v51, v50 from aggJoin5421003825581303794 join aggView4104331933635605944 using(v10);
create or replace view aggView6333564276365332511 as select v37, MIN(v51) as v51, MIN(v50) as v50 from aggJoin7415808373060362944 group by v37;
create or replace view aggJoin3149829969027460565 as select movie_id as v37, keyword_id as v14, v51, v50 from movie_keyword as mk, aggView6333564276365332511 where mk.movie_id=aggView6333564276365332511.v37;
create or replace view aggView7688665945989889627 as select id as v14 from keyword as k where keyword IN ('murder','murder-in-title','blood','violence');
create or replace view aggJoin550718041731229079 as select v37, v51, v50 from aggJoin3149829969027460565 join aggView7688665945989889627 using(v14);
create or replace view aggView4675697700318435474 as select v37, MIN(v51) as v51, MIN(v50) as v50 from aggJoin550718041731229079 group by v37;
create or replace view aggJoin1571412995377359186 as select v8, v49 as v49, v51, v50 from aggJoin1276240750337825459 join aggView4675697700318435474 using(v37);
create or replace view aggView3981576145965048731 as select v8, MIN(v49) as v49, MIN(v51) as v51, MIN(v50) as v50 from aggJoin1571412995377359186 group by v8;
create or replace view aggJoin6504823663091322368 as select v49, v51, v50 from company_type as ct, aggView3981576145965048731 where ct.id=aggView3981576145965048731.v8;
create or replace view res as select MIN(v49) as v49, MIN(v50) as v50, MIN(v51) as v51 from aggJoin6504823663091322368;
select sum(v49+v50+v51) from res;