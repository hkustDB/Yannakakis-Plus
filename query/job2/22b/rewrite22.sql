create or replace view aggView6216789417049778470 as select id as v1, name as v49 from company_name as cn where country_code<> '[us]';
create or replace view aggJoin5287372323064154955 as select movie_id as v37, company_type_id as v8, note as v23, v49 from movie_companies as mc, aggView6216789417049778470 where mc.company_id=aggView6216789417049778470.v1 and note NOT LIKE '%(USA)%' and note LIKE '%(200%)%';
create or replace view aggView4321376255576141591 as select id as v8 from company_type as ct;
create or replace view aggJoin4600390400081961372 as select v37, v23, v49 from aggJoin5287372323064154955 join aggView4321376255576141591 using(v8);
create or replace view aggView6917198214505186703 as select id as v12 from info_type as it2 where info= 'rating';
create or replace view aggJoin810900277412350361 as select movie_id as v37, info as v32 from movie_info_idx as mi_idx, aggView6917198214505186703 where mi_idx.info_type_id=aggView6917198214505186703.v12 and info<'7.0';
create or replace view aggView6276097906654631696 as select v37, MIN(v32) as v50 from aggJoin810900277412350361 group by v37;
create or replace view aggJoin8585204058654403867 as select movie_id as v37, keyword_id as v14, v50 from movie_keyword as mk, aggView6276097906654631696 where mk.movie_id=aggView6276097906654631696.v37;
create or replace view aggView3126594563016473844 as select v37, MIN(v49) as v49 from aggJoin4600390400081961372 group by v37;
create or replace view aggJoin6449450029320507192 as select movie_id as v37, info_type_id as v10, v49 from movie_info as mi, aggView3126594563016473844 where mi.movie_id=aggView3126594563016473844.v37 and info IN ('Germany','German','USA','American');
create or replace view aggView46904590699377628 as select id as v14 from keyword as k where keyword IN ('murder','murder-in-title','blood','violence');
create or replace view aggJoin6780738410900166604 as select v37, v50 from aggJoin8585204058654403867 join aggView46904590699377628 using(v14);
create or replace view aggView2055576583960343991 as select v37, MIN(v50) as v50 from aggJoin6780738410900166604 group by v37;
create or replace view aggJoin6156838571717156867 as select id as v37, title as v38, kind_id as v17, v50 from title as t, aggView2055576583960343991 where t.id=aggView2055576583960343991.v37 and production_year>2009;
create or replace view aggView3392393925050897543 as select id as v10 from info_type as it1 where info= 'countries';
create or replace view aggJoin1098658631973011801 as select v37, v49 from aggJoin6449450029320507192 join aggView3392393925050897543 using(v10);
create or replace view aggView2953726220099646812 as select v37, MIN(v49) as v49 from aggJoin1098658631973011801 group by v37;
create or replace view aggJoin4775666146978868889 as select v38, v17, v50 as v50, v49 from aggJoin6156838571717156867 join aggView2953726220099646812 using(v37);
create or replace view aggView8305694648625923274 as select v17, MIN(v50) as v50, MIN(v49) as v49, MIN(v38) as v51 from aggJoin4775666146978868889 group by v17;
create or replace view aggJoin9148811122280410217 as select v50, v49, v51 from kind_type as kt, aggView8305694648625923274 where kt.id=aggView8305694648625923274.v17 and kind IN ('movie','episode');
create or replace view res as select MIN(v49) as v49, MIN(v50) as v50, MIN(v51) as v51 from aggJoin9148811122280410217;
select sum(v49+v50+v51) from res;