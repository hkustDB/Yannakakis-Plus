create or replace view aggView2010689095546928327 as select id as v1, name as v49 from company_name as cn where country_code<> '[us]';
create or replace view aggJoin4198542638535358730 as select movie_id as v37, company_type_id as v8, note as v23, v49 from movie_companies as mc, aggView2010689095546928327 where mc.company_id=aggView2010689095546928327.v1 and note NOT LIKE '%(USA)%' and note LIKE '%(200%)%';
create or replace view aggView4785191413453108945 as select id as v10 from info_type as it1 where info= 'countries';
create or replace view aggJoin4174053174164379000 as select movie_id as v37, info as v27 from movie_info as mi, aggView4785191413453108945 where mi.info_type_id=aggView4785191413453108945.v10 and info IN ('Germany','German','USA','American');
create or replace view aggView41097583398729298 as select id as v14 from keyword as k where keyword IN ('murder','murder-in-title','blood','violence');
create or replace view aggJoin9030169225792738722 as select movie_id as v37 from movie_keyword as mk, aggView41097583398729298 where mk.keyword_id=aggView41097583398729298.v14;
create or replace view aggView2427114832299106451 as select v37 from aggJoin4174053174164379000 group by v37;
create or replace view aggJoin8063636846743319508 as select v37, v8, v23, v49 as v49 from aggJoin4198542638535358730 join aggView2427114832299106451 using(v37);
create or replace view aggView7739291058682732003 as select id as v8 from company_type as ct;
create or replace view aggJoin6155245543046817396 as select v37, v23, v49 from aggJoin8063636846743319508 join aggView7739291058682732003 using(v8);
create or replace view aggView7713616986309495406 as select v37, MIN(v49) as v49 from aggJoin6155245543046817396 group by v37;
create or replace view aggJoin2293919094286426679 as select id as v37, title as v38, kind_id as v17, production_year as v41, v49 from title as t, aggView7713616986309495406 where t.id=aggView7713616986309495406.v37 and production_year>2009;
create or replace view aggView6368465782934333128 as select id as v12 from info_type as it2 where info= 'rating';
create or replace view aggJoin8913350257839696803 as select movie_id as v37, info as v32 from movie_info_idx as mi_idx, aggView6368465782934333128 where mi_idx.info_type_id=aggView6368465782934333128.v12 and info<'7.0';
create or replace view aggView3274377143760045716 as select v37, MIN(v32) as v50 from aggJoin8913350257839696803 group by v37;
create or replace view aggJoin4718855079657959538 as select v37, v50 from aggJoin9030169225792738722 join aggView3274377143760045716 using(v37);
create or replace view aggView6407625282000399272 as select id as v17 from kind_type as kt where kind IN ('movie','episode');
create or replace view aggJoin6304157562879113102 as select v37, v38, v41, v49 from aggJoin2293919094286426679 join aggView6407625282000399272 using(v17);
create or replace view aggView5655977805012020926 as select v37, MIN(v49) as v49, MIN(v38) as v51 from aggJoin6304157562879113102 group by v37;
create or replace view aggJoin4909110303239244521 as select v50 as v50, v49, v51 from aggJoin4718855079657959538 join aggView5655977805012020926 using(v37);
select MIN(v49) as v49,MIN(v50) as v50,MIN(v51) as v51 from aggJoin4909110303239244521;
