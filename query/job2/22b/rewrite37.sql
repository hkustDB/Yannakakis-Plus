create or replace view aggView1501332749982956241 as select id as v1, name as v49 from company_name as cn where country_code<> '[us]';
create or replace view aggJoin3523919290805704823 as select movie_id as v37, company_type_id as v8, note as v23, v49 from movie_companies as mc, aggView1501332749982956241 where mc.company_id=aggView1501332749982956241.v1 and note NOT LIKE '%(USA)%' and note LIKE '%(200%)%';
create or replace view aggView7775001828939637806 as select id as v8 from company_type as ct;
create or replace view aggJoin2989703185408441212 as select v37, v23, v49 from aggJoin3523919290805704823 join aggView7775001828939637806 using(v8);
create or replace view aggView3860157516221823537 as select id as v17 from kind_type as kt where kind IN ('movie','episode');
create or replace view aggJoin4448586893810539450 as select id as v37, title as v38 from title as t, aggView3860157516221823537 where t.kind_id=aggView3860157516221823537.v17 and production_year>2009;
create or replace view aggView4143128854411836203 as select v37, MIN(v49) as v49 from aggJoin2989703185408441212 group by v37;
create or replace view aggJoin2875406115942452674 as select v37, v38, v49 from aggJoin4448586893810539450 join aggView4143128854411836203 using(v37);
create or replace view aggView8093603958882462763 as select v37, MIN(v49) as v49, MIN(v38) as v51 from aggJoin2875406115942452674 group by v37;
create or replace view aggJoin2175950459786886097 as select movie_id as v37, info_type_id as v10, v49, v51 from movie_info as mi, aggView8093603958882462763 where mi.movie_id=aggView8093603958882462763.v37 and info IN ('Germany','German','USA','American');
create or replace view aggView6472176389089124886 as select id as v14 from keyword as k where keyword IN ('murder','murder-in-title','blood','violence');
create or replace view aggJoin6051575134335856821 as select movie_id as v37 from movie_keyword as mk, aggView6472176389089124886 where mk.keyword_id=aggView6472176389089124886.v14;
create or replace view aggView5326895362600286627 as select v37 from aggJoin6051575134335856821 group by v37;
create or replace view aggJoin871803164404061165 as select movie_id as v37, info_type_id as v12, info as v32 from movie_info_idx as mi_idx, aggView5326895362600286627 where mi_idx.movie_id=aggView5326895362600286627.v37 and info<'7.0';
create or replace view aggView9161206453080968231 as select id as v10 from info_type as it1 where info= 'countries';
create or replace view aggJoin2260657789682803109 as select v37, v49, v51 from aggJoin2175950459786886097 join aggView9161206453080968231 using(v10);
create or replace view aggView985238874203334341 as select v37, MIN(v49) as v49, MIN(v51) as v51 from aggJoin2260657789682803109 group by v37;
create or replace view aggJoin6705019042930543414 as select v12, v32, v49, v51 from aggJoin871803164404061165 join aggView985238874203334341 using(v37);
create or replace view aggView8234021212278169137 as select v12, MIN(v49) as v49, MIN(v51) as v51, MIN(v32) as v50 from aggJoin6705019042930543414 group by v12;
create or replace view aggJoin1361339182625415743 as select v49, v51, v50 from info_type as it2, aggView8234021212278169137 where it2.id=aggView8234021212278169137.v12 and info= 'rating';
create or replace view res as select MIN(v49) as v49, MIN(v50) as v50, MIN(v51) as v51 from aggJoin1361339182625415743;
select sum(v49+v50+v51) from res;