create or replace view aggView8219806124567672941 as select id as v1, name as v49 from company_name as cn where country_code<> '[us]';
create or replace view aggJoin7454717220625688570 as select movie_id as v37, company_type_id as v8, note as v23, v49 from movie_companies as mc, aggView8219806124567672941 where mc.company_id=aggView8219806124567672941.v1 and note NOT LIKE '%(USA)%' and note LIKE '%(200%)%';
create or replace view aggView9016317050947553641 as select id as v8 from company_type as ct;
create or replace view aggJoin2914603768266754732 as select v37, v23, v49 from aggJoin7454717220625688570 join aggView9016317050947553641 using(v8);
create or replace view aggView435022954244552814 as select id as v12 from info_type as it2 where info= 'rating';
create or replace view aggJoin5255358323005226533 as select movie_id as v37, info as v32 from movie_info_idx as mi_idx, aggView435022954244552814 where mi_idx.info_type_id=aggView435022954244552814.v12 and info<'7.0';
create or replace view aggView7788273642421264494 as select id as v17 from kind_type as kt where kind IN ('movie','episode');
create or replace view aggJoin5385882911158479005 as select id as v37, title as v38 from title as t, aggView7788273642421264494 where t.kind_id=aggView7788273642421264494.v17 and production_year>2009;
create or replace view aggView1556148869828488247 as select v37, MIN(v49) as v49 from aggJoin2914603768266754732 group by v37;
create or replace view aggJoin5877565561192252508 as select v37, v38, v49 from aggJoin5385882911158479005 join aggView1556148869828488247 using(v37);
create or replace view aggView1534845071752452401 as select v37, MIN(v49) as v49, MIN(v38) as v51 from aggJoin5877565561192252508 group by v37;
create or replace view aggJoin8561033259368229094 as select v37, v32, v49, v51 from aggJoin5255358323005226533 join aggView1534845071752452401 using(v37);
create or replace view aggView647271800773448630 as select v37, MIN(v49) as v49, MIN(v51) as v51, MIN(v32) as v50 from aggJoin8561033259368229094 group by v37;
create or replace view aggJoin8318257827274408133 as select movie_id as v37, info_type_id as v10, v49, v51, v50 from movie_info as mi, aggView647271800773448630 where mi.movie_id=aggView647271800773448630.v37 and info IN ('Germany','German','USA','American');
create or replace view aggView8990629850862831552 as select id as v10 from info_type as it1 where info= 'countries';
create or replace view aggJoin8420234798030382596 as select v37, v49, v51, v50 from aggJoin8318257827274408133 join aggView8990629850862831552 using(v10);
create or replace view aggView934154126977282002 as select v37, MIN(v49) as v49, MIN(v51) as v51, MIN(v50) as v50 from aggJoin8420234798030382596 group by v37;
create or replace view aggJoin3992391144479594906 as select keyword_id as v14, v49, v51, v50 from movie_keyword as mk, aggView934154126977282002 where mk.movie_id=aggView934154126977282002.v37;
create or replace view aggView7244352279183341028 as select id as v14 from keyword as k where keyword IN ('murder','murder-in-title','blood','violence');
create or replace view aggJoin6156454143174050696 as select v49, v51, v50 from aggJoin3992391144479594906 join aggView7244352279183341028 using(v14);
create or replace view res as select MIN(v49) as v49, MIN(v50) as v50, MIN(v51) as v51 from aggJoin6156454143174050696;
select sum(v49+v50+v51) from res;