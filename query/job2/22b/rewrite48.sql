create or replace view aggView820207468528781216 as select id as v1, name as v49 from company_name as cn where country_code<> '[us]';
create or replace view aggJoin1213966538167607606 as select movie_id as v37, company_type_id as v8, note as v23, v49 from movie_companies as mc, aggView820207468528781216 where mc.company_id=aggView820207468528781216.v1 and note NOT LIKE '%(USA)%' and note LIKE '%(200%)%';
create or replace view aggView4020813279687640926 as select id as v8 from company_type as ct;
create or replace view aggJoin1046849035702419936 as select v37, v23, v49 from aggJoin1213966538167607606 join aggView4020813279687640926 using(v8);
create or replace view aggView6691231587179860380 as select id as v12 from info_type as it2 where info= 'rating';
create or replace view aggJoin4743790978769038876 as select movie_id as v37, info as v32 from movie_info_idx as mi_idx, aggView6691231587179860380 where mi_idx.info_type_id=aggView6691231587179860380.v12 and info<'7.0';
create or replace view aggView1801097026141995758 as select v37, MIN(v32) as v50 from aggJoin4743790978769038876 group by v37;
create or replace view aggJoin7798175960577854599 as select id as v37, title as v38, kind_id as v17, v50 from title as t, aggView1801097026141995758 where t.id=aggView1801097026141995758.v37 and production_year>2009;
create or replace view aggView447784071054174450 as select v37, MIN(v49) as v49 from aggJoin1046849035702419936 group by v37;
create or replace view aggJoin7585015793797599270 as select movie_id as v37, info_type_id as v10, v49 from movie_info as mi, aggView447784071054174450 where mi.movie_id=aggView447784071054174450.v37 and info IN ('Germany','German','USA','American');
create or replace view aggView4878420935510966461 as select id as v10 from info_type as it1 where info= 'countries';
create or replace view aggJoin4820806962835350032 as select v37, v49 from aggJoin7585015793797599270 join aggView4878420935510966461 using(v10);
create or replace view aggView5879433784989260864 as select v37, MIN(v49) as v49 from aggJoin4820806962835350032 group by v37;
create or replace view aggJoin3471421834848642724 as select movie_id as v37, keyword_id as v14, v49 from movie_keyword as mk, aggView5879433784989260864 where mk.movie_id=aggView5879433784989260864.v37;
create or replace view aggView4406142368459676518 as select id as v14 from keyword as k where keyword IN ('murder','murder-in-title','blood','violence');
create or replace view aggJoin1354797883099634336 as select v37, v49 from aggJoin3471421834848642724 join aggView4406142368459676518 using(v14);
create or replace view aggView8547860555231156280 as select v37, MIN(v49) as v49 from aggJoin1354797883099634336 group by v37;
create or replace view aggJoin4902568388596227141 as select v38, v17, v50 as v50, v49 from aggJoin7798175960577854599 join aggView8547860555231156280 using(v37);
create or replace view aggView2864950999861062533 as select v17, MIN(v50) as v50, MIN(v49) as v49, MIN(v38) as v51 from aggJoin4902568388596227141 group by v17;
create or replace view aggJoin7365853560072293673 as select v50, v49, v51 from kind_type as kt, aggView2864950999861062533 where kt.id=aggView2864950999861062533.v17 and kind IN ('movie','episode');
create or replace view res as select MIN(v49) as v49, MIN(v50) as v50, MIN(v51) as v51 from aggJoin7365853560072293673;
select sum(v49+v50+v51) from res;