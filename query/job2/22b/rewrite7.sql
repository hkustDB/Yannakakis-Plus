create or replace view aggView6636049211765636322 as select name as v2, id as v1 from company_name as cn where country_code<> '[us]';
create or replace view aggView5277738898060702713 as select id as v12 from info_type as it2 where info= 'rating';
create or replace view aggJoin7630427514012844970 as select movie_id as v37, info as v32 from movie_info_idx as mi_idx, aggView5277738898060702713 where mi_idx.info_type_id=aggView5277738898060702713.v12 and info<'7.0';
create or replace view aggView2902454881614352606 as select v37, v32 from aggJoin7630427514012844970;
create or replace view aggView252882003672393109 as select id as v17 from kind_type as kt where kind IN ('movie','episode');
create or replace view aggJoin1273234675145609397 as select id as v37, title as v38, production_year as v41 from title as t, aggView252882003672393109 where t.kind_id=aggView252882003672393109.v17 and production_year>2009;
create or replace view aggView3887568193657442686 as select v37, v38 from aggJoin1273234675145609397;
create or replace view aggView6442464425140466153 as select v37, MIN(v32) as v50 from aggView2902454881614352606 group by v37;
create or replace view aggJoin24082153665260759 as select v37, v38, v50 from aggView3887568193657442686 join aggView6442464425140466153 using(v37);
create or replace view aggView8105672883115711748 as select v37, MIN(v50) as v50, MIN(v38) as v51 from aggJoin24082153665260759 group by v37;
create or replace view aggJoin9082417390651844460 as select movie_id as v37, company_id as v1, company_type_id as v8, note as v23, v50, v51 from movie_companies as mc, aggView8105672883115711748 where mc.movie_id=aggView8105672883115711748.v37 and note NOT LIKE '%(USA)%' and note LIKE '%(200%)%';
create or replace view aggView4271699988602283380 as select id as v10 from info_type as it1 where info= 'countries';
create or replace view aggJoin2119412631029189507 as select movie_id as v37, info as v27 from movie_info as mi, aggView4271699988602283380 where mi.info_type_id=aggView4271699988602283380.v10 and info IN ('Germany','German','USA','American');
create or replace view aggView3244906735619651938 as select id as v14 from keyword as k where keyword IN ('murder','murder-in-title','blood','violence');
create or replace view aggJoin1748740600759636569 as select movie_id as v37 from movie_keyword as mk, aggView3244906735619651938 where mk.keyword_id=aggView3244906735619651938.v14;
create or replace view aggView1658453242095466665 as select id as v8 from company_type as ct;
create or replace view aggJoin364616364263238666 as select v37, v1, v23, v50, v51 from aggJoin9082417390651844460 join aggView1658453242095466665 using(v8);
create or replace view aggView3586226214427646130 as select v37 from aggJoin1748740600759636569 group by v37;
create or replace view aggJoin8743548518141687816 as select v37, v27 from aggJoin2119412631029189507 join aggView3586226214427646130 using(v37);
create or replace view aggView6025526630032134697 as select v37 from aggJoin8743548518141687816 group by v37;
create or replace view aggJoin6709205785571246200 as select v1, v23, v50 as v50, v51 as v51 from aggJoin364616364263238666 join aggView6025526630032134697 using(v37);
create or replace view aggView6450270355666966222 as select v1, MIN(v50) as v50, MIN(v51) as v51 from aggJoin6709205785571246200 group by v1;
create or replace view aggJoin8074308475199251373 as select v2, v50, v51 from aggView6636049211765636322 join aggView6450270355666966222 using(v1);
select MIN(v2) as v49,MIN(v50) as v50,MIN(v51) as v51 from aggJoin8074308475199251373;
