create or replace view aggView7133293890270532935 as select id as v17 from kind_type as kt where kind IN ('movie','episode');
create or replace view aggJoin7511949303297589932 as select id as v37, title as v38 from title as t, aggView7133293890270532935 where t.kind_id=aggView7133293890270532935.v17 and production_year>2005;
create or replace view aggView9174061465459002674 as select id as v12 from info_type as it2 where info= 'rating';
create or replace view aggJoin3105156259227652415 as select movie_id as v37, info as v32 from movie_info_idx as mi_idx, aggView9174061465459002674 where mi_idx.info_type_id=aggView9174061465459002674.v12 and info<'8.5';
create or replace view aggView2549143733360151721 as select id as v8 from company_type as ct;
create or replace view aggJoin379399476146414177 as select movie_id as v37, company_id as v1 from movie_companies as mc, aggView2549143733360151721 where mc.company_type_id=aggView2549143733360151721.v8;
create or replace view aggView2376361646594883374 as select id as v14 from keyword as k where keyword IN ('murder','murder-in-title','blood','violence');
create or replace view aggJoin1586562962961664982 as select movie_id as v37 from movie_keyword as mk, aggView2376361646594883374 where mk.keyword_id=aggView2376361646594883374.v14;
create or replace view aggView3757634292283651192 as select id as v10 from info_type as it1 where info= 'countries';
create or replace view aggJoin3150173550094048349 as select movie_id as v37 from movie_info as mi, aggView3757634292283651192 where mi.info_type_id=aggView3757634292283651192.v10 and info IN ('Sweden','Norway','Germany','Denmark','Swedish','Danish','Norwegian','German','USA','American');
create or replace view aggView1021574780262705123 as select v37 from aggJoin3150173550094048349 group by v37;
create or replace view aggJoin5713328152030797520 as select v37, v38 from aggJoin7511949303297589932 join aggView1021574780262705123 using(v37);
create or replace view aggView6475686499096007161 as select v37, MIN(v38) as v51 from aggJoin5713328152030797520 group by v37;
create or replace view aggJoin9030897551178462038 as select v37, v51 from aggJoin1586562962961664982 join aggView6475686499096007161 using(v37);
create or replace view aggView8437982893962378531 as select v37, MIN(v51) as v51 from aggJoin9030897551178462038 group by v37;
create or replace view aggJoin4186149774678387862 as select v37, v32, v51 from aggJoin3105156259227652415 join aggView8437982893962378531 using(v37);
create or replace view aggView3911432409340563006 as select v37, MIN(v51) as v51, MIN(v32) as v50 from aggJoin4186149774678387862 group by v37;
create or replace view aggJoin7310979632795037768 as select v1, v51, v50 from aggJoin379399476146414177 join aggView3911432409340563006 using(v37);
create or replace view aggView4430757649961978839 as select v1, MIN(v51) as v51, MIN(v50) as v50 from aggJoin7310979632795037768 group by v1;
create or replace view aggJoin3885546321079555284 as select name as v2, v51, v50 from company_name as cn, aggView4430757649961978839 where cn.id=aggView4430757649961978839.v1 and country_code<> '[us]';
create or replace view res as select MIN(v2) as v49, MIN(v50) as v50, MIN(v51) as v51 from aggJoin3885546321079555284;
select sum(v49+v50+v51) from res;