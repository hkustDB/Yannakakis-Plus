create or replace view aggView8060671596271360031 as select id as v17 from kind_type as kt where kind IN ('movie','episode');
create or replace view aggJoin1145526390930820549 as select id as v37, title as v38 from title as t, aggView8060671596271360031 where t.kind_id=aggView8060671596271360031.v17 and production_year>2005;
create or replace view aggView3531703136888074840 as select id as v12 from info_type as it2 where info= 'rating';
create or replace view aggJoin3182893256454187756 as select movie_id as v37, info as v32 from movie_info_idx as mi_idx, aggView3531703136888074840 where mi_idx.info_type_id=aggView3531703136888074840.v12 and info<'8.5';
create or replace view aggView863931117712046397 as select v37, MIN(v32) as v50 from aggJoin3182893256454187756 group by v37;
create or replace view aggJoin440341087042407868 as select movie_id as v37, info_type_id as v10, v50 from movie_info as mi, aggView863931117712046397 where mi.movie_id=aggView863931117712046397.v37 and info IN ('Sweden','Norway','Germany','Denmark','Swedish','Danish','Norwegian','German','USA','American');
create or replace view aggView742807412259375847 as select id as v8 from company_type as ct;
create or replace view aggJoin4920044604660739340 as select movie_id as v37, company_id as v1 from movie_companies as mc, aggView742807412259375847 where mc.company_type_id=aggView742807412259375847.v8;
create or replace view aggView3271840978342486158 as select id as v14 from keyword as k where keyword IN ('murder','murder-in-title','blood','violence');
create or replace view aggJoin3059759982812849884 as select movie_id as v37 from movie_keyword as mk, aggView3271840978342486158 where mk.keyword_id=aggView3271840978342486158.v14;
create or replace view aggView5058256899708630329 as select id as v10 from info_type as it1 where info= 'countries';
create or replace view aggJoin4348870583660737134 as select v37, v50 from aggJoin440341087042407868 join aggView5058256899708630329 using(v10);
create or replace view aggView8346838544028267656 as select v37, MIN(v50) as v50 from aggJoin4348870583660737134 group by v37;
create or replace view aggJoin17804928938126730 as select v37, v50 from aggJoin3059759982812849884 join aggView8346838544028267656 using(v37);
create or replace view aggView4838293142092223342 as select v37, MIN(v50) as v50 from aggJoin17804928938126730 group by v37;
create or replace view aggJoin2406469427804439501 as select v37, v38, v50 from aggJoin1145526390930820549 join aggView4838293142092223342 using(v37);
create or replace view aggView421530080069935102 as select v37, MIN(v50) as v50, MIN(v38) as v51 from aggJoin2406469427804439501 group by v37;
create or replace view aggJoin1438183018586475660 as select v1, v50, v51 from aggJoin4920044604660739340 join aggView421530080069935102 using(v37);
create or replace view aggView6493154377555514475 as select v1, MIN(v50) as v50, MIN(v51) as v51 from aggJoin1438183018586475660 group by v1;
create or replace view aggJoin7286734481931093323 as select name as v2, v50, v51 from company_name as cn, aggView6493154377555514475 where cn.id=aggView6493154377555514475.v1 and country_code<> '[us]';
create or replace view res as select MIN(v2) as v49, MIN(v50) as v50, MIN(v51) as v51 from aggJoin7286734481931093323;
select sum(v49+v50+v51) from res;