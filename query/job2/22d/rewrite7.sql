create or replace view aggView696762105528193913 as select id as v1, name as v2 from company_name as cn where country_code<> '[us]';
create or replace view aggView2001526158943836437 as select id as v12 from info_type as it2 where info= 'rating';
create or replace view aggJoin6310722561542765389 as select movie_id as v37, info as v32 from movie_info_idx as mi_idx, aggView2001526158943836437 where mi_idx.info_type_id=aggView2001526158943836437.v12 and info<'8.5';
create or replace view aggView4098660103728287836 as select v37, v32 from aggJoin6310722561542765389;
create or replace view aggView3889334829612091823 as select id as v17 from kind_type as kt where kind IN ('movie','episode');
create or replace view aggJoin2303255267693823119 as select id as v37, title as v38, production_year as v41 from title as t, aggView3889334829612091823 where t.kind_id=aggView3889334829612091823.v17 and production_year>2005;
create or replace view aggView5189106567388717389 as select v38, v37 from aggJoin2303255267693823119;
create or replace view aggView7527857065528362265 as select v37, MIN(v38) as v51 from aggView5189106567388717389 group by v37;
create or replace view aggJoin5597401842843387225 as select v37, v32, v51 from aggView4098660103728287836 join aggView7527857065528362265 using(v37);
create or replace view aggView7454476095053892110 as select v37, MIN(v51) as v51, MIN(v32) as v50 from aggJoin5597401842843387225 group by v37;
create or replace view aggJoin4445147238268087229 as select movie_id as v37, company_id as v1, company_type_id as v8, v51, v50 from movie_companies as mc, aggView7454476095053892110 where mc.movie_id=aggView7454476095053892110.v37;
create or replace view aggView8791283168794837878 as select id as v8 from company_type as ct;
create or replace view aggJoin3779828219520073600 as select v37, v1, v51, v50 from aggJoin4445147238268087229 join aggView8791283168794837878 using(v8);
create or replace view aggView6534352221891391930 as select id as v10 from info_type as it1 where info= 'countries';
create or replace view aggJoin6154588745070494450 as select movie_id as v37, info as v27 from movie_info as mi, aggView6534352221891391930 where mi.info_type_id=aggView6534352221891391930.v10 and info IN ('Sweden','Norway','Germany','Denmark','Swedish','Danish','Norwegian','German','USA','American');
create or replace view aggView4934352728614562801 as select id as v14 from keyword as k where keyword IN ('murder','murder-in-title','blood','violence');
create or replace view aggJoin2600893278312852943 as select movie_id as v37 from movie_keyword as mk, aggView4934352728614562801 where mk.keyword_id=aggView4934352728614562801.v14;
create or replace view aggView67471742769744981 as select v37 from aggJoin2600893278312852943 group by v37;
create or replace view aggJoin2775395773547970509 as select v37, v27 from aggJoin6154588745070494450 join aggView67471742769744981 using(v37);
create or replace view aggView8554505848026888472 as select v37 from aggJoin2775395773547970509 group by v37;
create or replace view aggJoin1227884430478173968 as select v1, v51 as v51, v50 as v50 from aggJoin3779828219520073600 join aggView8554505848026888472 using(v37);
create or replace view aggView7494900846793547014 as select v1, MIN(v51) as v51, MIN(v50) as v50 from aggJoin1227884430478173968 group by v1;
create or replace view aggJoin1551373932925110690 as select v2, v51, v50 from aggView696762105528193913 join aggView7494900846793547014 using(v1);
select MIN(v2) as v49,MIN(v50) as v50,MIN(v51) as v51 from aggJoin1551373932925110690;
