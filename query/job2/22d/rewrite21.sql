create or replace view aggView8751449510635537506 as select id as v1, name as v49 from company_name as cn where country_code<> '[us]';
create or replace view aggJoin4098182633193672023 as select movie_id as v37, company_type_id as v8, v49 from movie_companies as mc, aggView8751449510635537506 where mc.company_id=aggView8751449510635537506.v1;
create or replace view aggView2482698074218785019 as select id as v17 from kind_type as kt where kind IN ('movie','episode');
create or replace view aggJoin5633102421097617815 as select id as v37, title as v38 from title as t, aggView2482698074218785019 where t.kind_id=aggView2482698074218785019.v17 and production_year>2005;
create or replace view aggView5274632540599105936 as select v37, MIN(v38) as v51 from aggJoin5633102421097617815 group by v37;
create or replace view aggJoin4363924727022024114 as select movie_id as v37, info_type_id as v10, v51 from movie_info as mi, aggView5274632540599105936 where mi.movie_id=aggView5274632540599105936.v37 and info IN ('Sweden','Norway','Germany','Denmark','Swedish','Danish','Norwegian','German','USA','American');
create or replace view aggView2457628374437449686 as select id as v12 from info_type as it2 where info= 'rating';
create or replace view aggJoin4670045907739334975 as select movie_id as v37, info as v32 from movie_info_idx as mi_idx, aggView2457628374437449686 where mi_idx.info_type_id=aggView2457628374437449686.v12 and info<'8.5';
create or replace view aggView8476963694688466019 as select id as v14 from keyword as k where keyword IN ('murder','murder-in-title','blood','violence');
create or replace view aggJoin5748693576587920294 as select movie_id as v37 from movie_keyword as mk, aggView8476963694688466019 where mk.keyword_id=aggView8476963694688466019.v14;
create or replace view aggView4923510441701808461 as select id as v10 from info_type as it1 where info= 'countries';
create or replace view aggJoin6105290472476914139 as select v37, v51 from aggJoin4363924727022024114 join aggView4923510441701808461 using(v10);
create or replace view aggView1593881327014356252 as select v37, MIN(v51) as v51 from aggJoin6105290472476914139 group by v37;
create or replace view aggJoin2757017695735766805 as select v37, v32, v51 from aggJoin4670045907739334975 join aggView1593881327014356252 using(v37);
create or replace view aggView2497446297191925922 as select v37, MIN(v51) as v51, MIN(v32) as v50 from aggJoin2757017695735766805 group by v37;
create or replace view aggJoin7973210763863723377 as select v37, v51, v50 from aggJoin5748693576587920294 join aggView2497446297191925922 using(v37);
create or replace view aggView1865060027184647658 as select v37, MIN(v51) as v51, MIN(v50) as v50 from aggJoin7973210763863723377 group by v37;
create or replace view aggJoin8002864650278680186 as select v8, v49 as v49, v51, v50 from aggJoin4098182633193672023 join aggView1865060027184647658 using(v37);
create or replace view aggView8446809871728905267 as select v8, MIN(v49) as v49, MIN(v51) as v51, MIN(v50) as v50 from aggJoin8002864650278680186 group by v8;
create or replace view aggJoin6930155451857606909 as select v49, v51, v50 from company_type as ct, aggView8446809871728905267 where ct.id=aggView8446809871728905267.v8;
create or replace view res as select MIN(v49) as v49, MIN(v50) as v50, MIN(v51) as v51 from aggJoin6930155451857606909;
select sum(v49+v50+v51) from res;