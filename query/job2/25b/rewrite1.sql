create or replace view aggView6468435483675273565 as select id as v28, name as v29 from name as n where gender= 'm';
create or replace view aggView757154432896473768 as select id as v8 from info_type as it1 where info= 'genres';
create or replace view aggJoin6076986851737077979 as select movie_id as v37, info as v18 from movie_info as mi, aggView757154432896473768 where mi.info_type_id=aggView757154432896473768.v8;
create or replace view aggView2512151296981040712 as select v37, v18 from aggJoin6076986851737077979;
create or replace view aggJoin325307801481251518 as select v37, v18 from aggView2512151296981040712 where v18= 'Horror';
create or replace view aggView8762431827453541670 as select id as v10 from info_type as it2 where info= 'votes';
create or replace view aggJoin1908172663849302639 as select movie_id as v37, info as v23 from movie_info_idx as mi_idx, aggView8762431827453541670 where mi_idx.info_type_id=aggView8762431827453541670.v10;
create or replace view aggView1136847642254280298 as select v23, v37 from aggJoin1908172663849302639;
create or replace view aggView2455699335817026673 as select id as v12 from keyword as k where keyword IN ('murder','blood','gore','death','female-nudity');
create or replace view aggJoin7006588246925468553 as select movie_id as v37 from movie_keyword as mk, aggView2455699335817026673 where mk.keyword_id=aggView2455699335817026673.v12;
create or replace view aggView3780136536176414479 as select v37 from aggJoin7006588246925468553 group by v37;
create or replace view aggJoin4670144630329701668 as select id as v37, title as v38, production_year as v41 from title as t, aggView3780136536176414479 where t.id=aggView3780136536176414479.v37 and production_year>2010 and title LIKE 'Vampire%';
create or replace view aggView5176026596637491195 as select v38, v37 from aggJoin4670144630329701668;
create or replace view aggView869247313109086464 as select v28, MIN(v29) as v51 from aggView6468435483675273565 group by v28;
create or replace view aggJoin8136660377821876381 as select movie_id as v37, note as v5, v51 from cast_info as ci, aggView869247313109086464 where ci.person_id=aggView869247313109086464.v28 and note IN ('(writer)','(head writer)','(written by)','(story)','(story editor)');
create or replace view aggView5057664427711060016 as select v37, MIN(v51) as v51 from aggJoin8136660377821876381 group by v37;
create or replace view aggJoin7795457729427415591 as select v38, v37, v51 from aggView5176026596637491195 join aggView5057664427711060016 using(v37);
create or replace view aggView1188658661176426392 as select v37, MIN(v51) as v51, MIN(v38) as v52 from aggJoin7795457729427415591 group by v37;
create or replace view aggJoin3923949641704824387 as select v37, v18, v51, v52 from aggJoin325307801481251518 join aggView1188658661176426392 using(v37);
create or replace view aggView6726836758766175684 as select v37, MIN(v51) as v51, MIN(v52) as v52, MIN(v18) as v49 from aggJoin3923949641704824387 group by v37;
create or replace view aggJoin4058820393395089547 as select v23, v51, v52, v49 from aggView1136847642254280298 join aggView6726836758766175684 using(v37);
select MIN(v49) as v49,MIN(v23) as v50,MIN(v51) as v51,MIN(v52) as v52 from aggJoin4058820393395089547;
