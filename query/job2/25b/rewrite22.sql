create or replace view aggView5715287638837084099 as select id as v37, title as v52 from title as t where production_year>2010 and title LIKE 'Vampire%';
create or replace view aggJoin6191367001742251440 as select movie_id as v37, info_type_id as v10, info as v23, v52 from movie_info_idx as mi_idx, aggView5715287638837084099 where mi_idx.movie_id=aggView5715287638837084099.v37;
create or replace view aggView1966208990466757541 as select id as v28, name as v51 from name as n where gender= 'm';
create or replace view aggJoin4855339713895686000 as select movie_id as v37, note as v5, v51 from cast_info as ci, aggView1966208990466757541 where ci.person_id=aggView1966208990466757541.v28 and note IN ('(writer)','(head writer)','(written by)','(story)','(story editor)');
create or replace view aggView2911241682996423794 as select id as v8 from info_type as it1 where info= 'genres';
create or replace view aggJoin797550615582504931 as select movie_id as v37, info as v18 from movie_info as mi, aggView2911241682996423794 where mi.info_type_id=aggView2911241682996423794.v8 and info= 'Horror';
create or replace view aggView8815017790120400250 as select id as v12 from keyword as k where keyword IN ('murder','blood','gore','death','female-nudity');
create or replace view aggJoin5477169033547398589 as select movie_id as v37 from movie_keyword as mk, aggView8815017790120400250 where mk.keyword_id=aggView8815017790120400250.v12;
create or replace view aggView2906672576532717689 as select v37 from aggJoin5477169033547398589 group by v37;
create or replace view aggJoin55210756476528616 as select v37, v18 from aggJoin797550615582504931 join aggView2906672576532717689 using(v37);
create or replace view aggView1187382840295012044 as select v37, MIN(v18) as v49 from aggJoin55210756476528616 group by v37;
create or replace view aggJoin5799393167970713957 as select v37, v5, v51 as v51, v49 from aggJoin4855339713895686000 join aggView1187382840295012044 using(v37);
create or replace view aggView6086324903288111891 as select v37, MIN(v51) as v51, MIN(v49) as v49 from aggJoin5799393167970713957 group by v37;
create or replace view aggJoin6717414917914664691 as select v10, v23, v52 as v52, v51, v49 from aggJoin6191367001742251440 join aggView6086324903288111891 using(v37);
create or replace view aggView790479501713944482 as select v10, MIN(v52) as v52, MIN(v51) as v51, MIN(v49) as v49, MIN(v23) as v50 from aggJoin6717414917914664691 group by v10;
create or replace view aggJoin3548411604738529494 as select info as v11, v52, v51, v49, v50 from info_type as it2, aggView790479501713944482 where it2.id=aggView790479501713944482.v10 and info= 'votes';
create or replace view res as select MIN(v49) as v49, MIN(v50) as v50, MIN(v51) as v51, MIN(v52) as v52 from aggJoin3548411604738529494;
select sum(v49+v50+v51+v52) from res;