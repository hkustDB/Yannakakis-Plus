create or replace view aggView3907196518771523257 as select id as v8 from info_type as it1 where info= 'genres';
create or replace view aggJoin7309841626136088835 as select movie_id as v37, info as v18 from movie_info as mi, aggView3907196518771523257 where mi.info_type_id=aggView3907196518771523257.v8 and info= 'Horror';
create or replace view aggView2202981329453633896 as select id as v12 from keyword as k where keyword IN ('murder','blood','gore','death','female-nudity');
create or replace view aggJoin3762698489982139588 as select movie_id as v37 from movie_keyword as mk, aggView2202981329453633896 where mk.keyword_id=aggView2202981329453633896.v12;
create or replace view aggView3970447677956689867 as select id as v10 from info_type as it2 where info= 'votes';
create or replace view aggJoin8967835873680285175 as select movie_id as v37, info as v23 from movie_info_idx as mi_idx, aggView3970447677956689867 where mi_idx.info_type_id=aggView3970447677956689867.v10;
create or replace view aggView2792806192490642297 as select v37, MIN(v23) as v50 from aggJoin8967835873680285175 group by v37;
create or replace view aggJoin2364258426884305357 as select v37, v18, v50 from aggJoin7309841626136088835 join aggView2792806192490642297 using(v37);
create or replace view aggView2387388741398247734 as select v37, MIN(v50) as v50, MIN(v18) as v49 from aggJoin2364258426884305357 group by v37;
create or replace view aggJoin7411266860053045948 as select id as v37, title as v38, production_year as v41, v50, v49 from title as t, aggView2387388741398247734 where t.id=aggView2387388741398247734.v37 and production_year>2010 and title LIKE 'Vampire%';
create or replace view aggView2343250137980647144 as select v37, MIN(v50) as v50, MIN(v49) as v49, MIN(v38) as v52 from aggJoin7411266860053045948 group by v37;
create or replace view aggJoin2516009655501066550 as select v37, v50, v49, v52 from aggJoin3762698489982139588 join aggView2343250137980647144 using(v37);
create or replace view aggView7153315655964914831 as select v37, MIN(v50) as v50, MIN(v49) as v49, MIN(v52) as v52 from aggJoin2516009655501066550 group by v37;
create or replace view aggJoin8257252725014716485 as select person_id as v28, note as v5, v50, v49, v52 from cast_info as ci, aggView7153315655964914831 where ci.movie_id=aggView7153315655964914831.v37 and note IN ('(writer)','(head writer)','(written by)','(story)','(story editor)');
create or replace view aggView8715621755302188370 as select v28, MIN(v50) as v50, MIN(v49) as v49, MIN(v52) as v52 from aggJoin8257252725014716485 group by v28;
create or replace view aggJoin7647651678088034691 as select name as v29, gender as v32, v50, v49, v52 from name as n, aggView8715621755302188370 where n.id=aggView8715621755302188370.v28 and gender= 'm';
create or replace view res as select MIN(v49) as v49, MIN(v50) as v50, MIN(v29) as v51, MIN(v52) as v52 from aggJoin7647651678088034691;
select sum(v49+v50+v51+v52) from res;