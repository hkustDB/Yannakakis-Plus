create or replace view aggView7682575049556362006 as select id as v37, title as v52 from title as t where production_year>2010 and title LIKE 'Vampire%';
create or replace view aggJoin3338573312404635487 as select movie_id as v37, info_type_id as v8, info as v18, v52 from movie_info as mi, aggView7682575049556362006 where mi.movie_id=aggView7682575049556362006.v37 and info= 'Horror';
create or replace view aggView6547897231970370263 as select id as v28, name as v51 from name as n where gender= 'm';
create or replace view aggJoin5168273189461268164 as select movie_id as v37, note as v5, v51 from cast_info as ci, aggView6547897231970370263 where ci.person_id=aggView6547897231970370263.v28 and note IN ('(writer)','(head writer)','(written by)','(story)','(story editor)');
create or replace view aggView6690577652847648234 as select id as v12 from keyword as k where keyword IN ('murder','blood','gore','death','female-nudity');
create or replace view aggJoin2782931106880323060 as select movie_id as v37 from movie_keyword as mk, aggView6690577652847648234 where mk.keyword_id=aggView6690577652847648234.v12;
create or replace view aggView5642108873231438669 as select id as v8 from info_type as it1 where info= 'genres';
create or replace view aggJoin5269986729461541387 as select v37, v18, v52 from aggJoin3338573312404635487 join aggView5642108873231438669 using(v8);
create or replace view aggView2153742510946180737 as select v37, MIN(v52) as v52, MIN(v18) as v49 from aggJoin5269986729461541387 group by v37;
create or replace view aggJoin1313380633719428757 as select movie_id as v37, info_type_id as v10, info as v23, v52, v49 from movie_info_idx as mi_idx, aggView2153742510946180737 where mi_idx.movie_id=aggView2153742510946180737.v37;
create or replace view aggView2646583783660350434 as select id as v10 from info_type as it2 where info= 'votes';
create or replace view aggJoin1402782609286684251 as select v37, v23, v52, v49 from aggJoin1313380633719428757 join aggView2646583783660350434 using(v10);
create or replace view aggView435071323344967787 as select v37, MIN(v52) as v52, MIN(v49) as v49, MIN(v23) as v50 from aggJoin1402782609286684251 group by v37;
create or replace view aggJoin5450208675413092896 as select v37, v5, v51 as v51, v52, v49, v50 from aggJoin5168273189461268164 join aggView435071323344967787 using(v37);
create or replace view aggView3224431864795311878 as select v37, MIN(v51) as v51, MIN(v52) as v52, MIN(v49) as v49, MIN(v50) as v50 from aggJoin5450208675413092896 group by v37;
create or replace view aggJoin3094007181006161827 as select v51, v52, v49, v50 from aggJoin2782931106880323060 join aggView3224431864795311878 using(v37);
select MIN(v49) as v49,MIN(v50) as v50,MIN(v51) as v51,MIN(v52) as v52 from aggJoin3094007181006161827;
