create or replace view aggView472807836179801954 as select id as v28, name as v51 from name as n where gender= 'm';
create or replace view aggJoin3168220823092586665 as select movie_id as v37, note as v5, v51 from cast_info as ci, aggView472807836179801954 where ci.person_id=aggView472807836179801954.v28 and note IN ('(writer)','(head writer)','(written by)','(story)','(story editor)');
create or replace view aggView4710712059159918544 as select id as v12 from keyword as k where keyword IN ('murder','blood','gore','death','female-nudity');
create or replace view aggJoin4372260820128080893 as select movie_id as v37 from movie_keyword as mk, aggView4710712059159918544 where mk.keyword_id=aggView4710712059159918544.v12;
create or replace view aggView6983920160616884014 as select id as v8 from info_type as it1 where info= 'genres';
create or replace view aggJoin6800700765274977760 as select movie_id as v37, info as v18 from movie_info as mi, aggView6983920160616884014 where mi.info_type_id=aggView6983920160616884014.v8 and info= 'Horror';
create or replace view aggView8869262218976907907 as select v37, MIN(v18) as v49 from aggJoin6800700765274977760 group by v37;
create or replace view aggJoin7716109118821184432 as select v37, v5, v51 as v51, v49 from aggJoin3168220823092586665 join aggView8869262218976907907 using(v37);
create or replace view aggView6392663963272091602 as select id as v10 from info_type as it2 where info= 'votes';
create or replace view aggJoin1988742112297210646 as select movie_id as v37, info as v23 from movie_info_idx as mi_idx, aggView6392663963272091602 where mi_idx.info_type_id=aggView6392663963272091602.v10;
create or replace view aggView7999542734623583124 as select v37, MIN(v23) as v50 from aggJoin1988742112297210646 group by v37;
create or replace view aggJoin738105978949100 as select id as v37, title as v38, production_year as v41, v50 from title as t, aggView7999542734623583124 where t.id=aggView7999542734623583124.v37 and production_year>2010 and title LIKE 'Vampire%';
create or replace view aggView763197162056556853 as select v37, MIN(v50) as v50, MIN(v38) as v52 from aggJoin738105978949100 group by v37;
create or replace view aggJoin8842329205656520798 as select v37, v5, v51 as v51, v49 as v49, v50, v52 from aggJoin7716109118821184432 join aggView763197162056556853 using(v37);
create or replace view aggView6112279193748482285 as select v37, MIN(v51) as v51, MIN(v49) as v49, MIN(v50) as v50, MIN(v52) as v52 from aggJoin8842329205656520798 group by v37;
create or replace view aggJoin5004151138387928821 as select v51, v49, v50, v52 from aggJoin4372260820128080893 join aggView6112279193748482285 using(v37);
select MIN(v49) as v49,MIN(v50) as v50,MIN(v51) as v51,MIN(v52) as v52 from aggJoin5004151138387928821;
