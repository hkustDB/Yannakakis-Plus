create or replace view aggView8341733921832906960 as select id as v49, title as v64 from title as t;
create or replace view aggJoin3150165159959060134 as select person_id as v40, movie_id as v49, note as v5, v64 from cast_info as ci, aggView8341733921832906960 where ci.movie_id=aggView8341733921832906960.v49 and note IN ('(writer)','(head writer)','(written by)','(story)','(story editor)');
create or replace view aggView7422998580127996005 as select id as v40, name as v63 from name as n where gender= 'm';
create or replace view aggJoin5009958023161668400 as select v49, v5, v64, v63 from aggJoin3150165159959060134 join aggView7422998580127996005 using(v40);
create or replace view aggView5185692291030157288 as select id as v19 from keyword as k where keyword IN ('murder','violence','blood','gore','death','female-nudity','hospital');
create or replace view aggJoin6443806981457557113 as select movie_id as v49 from movie_keyword as mk, aggView5185692291030157288 where mk.keyword_id=aggView5185692291030157288.v19;
create or replace view aggView1673682347230368137 as select v49 from aggJoin6443806981457557113 group by v49;
create or replace view aggJoin7577244184020669210 as select movie_id as v49, company_id as v8 from movie_companies as mc, aggView1673682347230368137 where mc.movie_id=aggView1673682347230368137.v49;
create or replace view aggView3237503517197003190 as select id as v8 from company_name as cn where name LIKE 'Lionsgate%';
create or replace view aggJoin1613354509580811896 as select v49 from aggJoin7577244184020669210 join aggView3237503517197003190 using(v8);
create or replace view aggView3089758865237260960 as select id as v15 from info_type as it1 where info= 'genres';
create or replace view aggJoin5288352400995349679 as select movie_id as v49, info as v30 from movie_info as mi, aggView3089758865237260960 where mi.info_type_id=aggView3089758865237260960.v15 and info IN ('Horror','Thriller');
create or replace view aggView932584499264607552 as select v49 from aggJoin1613354509580811896 group by v49;
create or replace view aggJoin5598547738871570819 as select v49, v30 from aggJoin5288352400995349679 join aggView932584499264607552 using(v49);
create or replace view aggView7457295725825866899 as select v49, MIN(v30) as v61 from aggJoin5598547738871570819 group by v49;
create or replace view aggJoin1824495579959540315 as select movie_id as v49, info_type_id as v17, info as v35, v61 from movie_info_idx as mi_idx, aggView7457295725825866899 where mi_idx.movie_id=aggView7457295725825866899.v49;
create or replace view aggView7489453099151798050 as select v49, MIN(v64) as v64, MIN(v63) as v63 from aggJoin5009958023161668400 group by v49;
create or replace view aggJoin4826429181714759801 as select v17, v35, v61 as v61, v64, v63 from aggJoin1824495579959540315 join aggView7489453099151798050 using(v49);
create or replace view aggView3355021544409422485 as select v17, MIN(v61) as v61, MIN(v64) as v64, MIN(v63) as v63, MIN(v35) as v62 from aggJoin4826429181714759801 group by v17;
create or replace view aggJoin1432692399956112418 as select info as v18, v61, v64, v63, v62 from info_type as it2, aggView3355021544409422485 where it2.id=aggView3355021544409422485.v17 and info= 'votes';
create or replace view res as select MIN(v61) as v61, MIN(v62) as v62, MIN(v63) as v63, MIN(v64) as v64 from aggJoin1432692399956112418;
select sum(v61+v62+v63+v64) from res;