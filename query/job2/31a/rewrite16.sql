create or replace view aggView5091846139743197048 as select id as v40, name as v63 from name as n where gender= 'm';
create or replace view aggJoin4998669647349934736 as select movie_id as v49, note as v5, v63 from cast_info as ci, aggView5091846139743197048 where ci.person_id=aggView5091846139743197048.v40 and note IN ('(writer)','(head writer)','(written by)','(story)','(story editor)');
create or replace view aggView4326272021412518857 as select id as v17 from info_type as it2 where info= 'votes';
create or replace view aggJoin6892538794942726432 as select movie_id as v49, info as v35 from movie_info_idx as mi_idx, aggView4326272021412518857 where mi_idx.info_type_id=aggView4326272021412518857.v17;
create or replace view aggView6356033603461905282 as select v49, MIN(v35) as v62 from aggJoin6892538794942726432 group by v49;
create or replace view aggJoin3279054110454221470 as select id as v49, title as v50, v62 from title as t, aggView6356033603461905282 where t.id=aggView6356033603461905282.v49;
create or replace view aggView5136848673411514700 as select v49, MIN(v62) as v62, MIN(v50) as v64 from aggJoin3279054110454221470 group by v49;
create or replace view aggJoin8230361136517046506 as select movie_id as v49, company_id as v8, v62, v64 from movie_companies as mc, aggView5136848673411514700 where mc.movie_id=aggView5136848673411514700.v49;
create or replace view aggView6450128524297934617 as select id as v15 from info_type as it1 where info= 'genres';
create or replace view aggJoin2830841291078545244 as select movie_id as v49, info as v30 from movie_info as mi, aggView6450128524297934617 where mi.info_type_id=aggView6450128524297934617.v15 and info IN ('Horror','Thriller');
create or replace view aggView5239876289906959626 as select v49, MIN(v30) as v61 from aggJoin2830841291078545244 group by v49;
create or replace view aggJoin9015115178850369889 as select v49, v5, v63 as v63, v61 from aggJoin4998669647349934736 join aggView5239876289906959626 using(v49);
create or replace view aggView2845787197509098164 as select id as v8 from company_name as cn where name LIKE 'Lionsgate%';
create or replace view aggJoin7368316960774785326 as select v49, v62, v64 from aggJoin8230361136517046506 join aggView2845787197509098164 using(v8);
create or replace view aggView5868846014746888399 as select id as v19 from keyword as k where keyword IN ('murder','violence','blood','gore','death','female-nudity','hospital');
create or replace view aggJoin2422579815532238193 as select movie_id as v49 from movie_keyword as mk, aggView5868846014746888399 where mk.keyword_id=aggView5868846014746888399.v19;
create or replace view aggView241497406969664373 as select v49, MIN(v63) as v63, MIN(v61) as v61 from aggJoin9015115178850369889 group by v49;
create or replace view aggJoin1382600286637256531 as select v49, v62 as v62, v64 as v64, v63, v61 from aggJoin7368316960774785326 join aggView241497406969664373 using(v49);
create or replace view aggView1177545607306094200 as select v49, MIN(v62) as v62, MIN(v64) as v64, MIN(v63) as v63, MIN(v61) as v61 from aggJoin1382600286637256531 group by v49;
create or replace view aggJoin2857826753899668442 as select v62, v64, v63, v61 from aggJoin2422579815532238193 join aggView1177545607306094200 using(v49);
select MIN(v61) as v61,MIN(v62) as v62,MIN(v63) as v63,MIN(v64) as v64 from aggJoin2857826753899668442;
