create or replace view aggView6265299973394233132 as select id as v9, name as v59 from char_name as chn where ((name LIKE '%man%') OR (name LIKE '%Man%'));
create or replace view aggJoin1118735402483582387 as select person_id as v38, movie_id as v47, v59 from cast_info as ci, aggView6265299973394233132 where ci.person_role_id=aggView6265299973394233132.v9;
create or replace view aggView8872765000946378930 as select id as v28 from kind_type as kt where kind= 'movie';
create or replace view aggJoin3629582260097808975 as select id as v47, title as v48 from title as t, aggView8872765000946378930 where t.kind_id=aggView8872765000946378930.v28 and production_year>2000;
create or replace view aggView2103970485284003640 as select id as v23 from info_type as it2 where info= 'rating';
create or replace view aggJoin456645232260074440 as select movie_id as v47, info as v33 from movie_info_idx as mi_idx, aggView2103970485284003640 where mi_idx.info_type_id=aggView2103970485284003640.v23;
create or replace view aggView8278044119509999602 as select id as v5 from comp_cast_type as cct1 where kind= 'cast';
create or replace view aggJoin3751942825592392275 as select movie_id as v47, status_id as v7 from complete_cast as cc, aggView8278044119509999602 where cc.subject_id=aggView8278044119509999602.v5;
create or replace view aggView5917110347562433142 as select id as v7 from comp_cast_type as cct2 where kind LIKE '%complete%';
create or replace view aggJoin2086928945486154596 as select v47 from aggJoin3751942825592392275 join aggView5917110347562433142 using(v7);
create or replace view aggView7586757575647561805 as select v47 from aggJoin2086928945486154596 group by v47;
create or replace view aggJoin9012622706244177389 as select movie_id as v47, keyword_id as v25 from movie_keyword as mk, aggView7586757575647561805 where mk.movie_id=aggView7586757575647561805.v47;
create or replace view aggView7047851965066154468 as select id as v25 from keyword as k where keyword IN ('superhero','marvel-comics','based-on-comic','tv-special','fight','violence','magnet','web','claw','laser');
create or replace view aggJoin600996444734780870 as select v47 from aggJoin9012622706244177389 join aggView7047851965066154468 using(v25);
create or replace view aggView5798243190339835247 as select v47 from aggJoin600996444734780870 group by v47;
create or replace view aggJoin4793595941737161298 as select v47, v48 from aggJoin3629582260097808975 join aggView5798243190339835247 using(v47);
create or replace view aggView345975184587088162 as select v47, MIN(v48) as v61 from aggJoin4793595941737161298 group by v47;
create or replace view aggJoin6578520292533162162 as select v47, v33, v61 from aggJoin456645232260074440 join aggView345975184587088162 using(v47);
create or replace view aggView3902825690345899040 as select v47, MIN(v61) as v61, MIN(v33) as v60 from aggJoin6578520292533162162 group by v47;
create or replace view aggJoin2657714287235513178 as select v38, v59 as v59, v61, v60 from aggJoin1118735402483582387 join aggView3902825690345899040 using(v47);
create or replace view aggView3452481776803236864 as select v38, MIN(v59) as v59, MIN(v61) as v61, MIN(v60) as v60 from aggJoin2657714287235513178 group by v38;
create or replace view aggJoin7684888997464990579 as select v59, v61, v60 from name as n, aggView3452481776803236864 where n.id=aggView3452481776803236864.v38;
create or replace view res as select MIN(v59) as v59, MIN(v60) as v60, MIN(v61) as v61 from aggJoin7684888997464990579;
select sum(v59+v60+v61) from res;