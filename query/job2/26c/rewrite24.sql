create or replace view aggView7648107244636110114 as select id as v28 from kind_type as kt where kind= 'movie';
create or replace view aggJoin8781600012594748417 as select id as v47, title as v48 from title as t, aggView7648107244636110114 where t.kind_id=aggView7648107244636110114.v28 and production_year>2000;
create or replace view aggView4158376190275213275 as select id as v38 from name as n;
create or replace view aggJoin2482526940570291294 as select movie_id as v47, person_role_id as v9 from cast_info as ci, aggView4158376190275213275 where ci.person_id=aggView4158376190275213275.v38;
create or replace view aggView2808641229525128695 as select id as v23 from info_type as it2 where info= 'rating';
create or replace view aggJoin739554987275721756 as select movie_id as v47, info as v33 from movie_info_idx as mi_idx, aggView2808641229525128695 where mi_idx.info_type_id=aggView2808641229525128695.v23;
create or replace view aggView8934525340687528435 as select id as v5 from comp_cast_type as cct1 where kind= 'cast';
create or replace view aggJoin6208967691990840833 as select movie_id as v47, status_id as v7 from complete_cast as cc, aggView8934525340687528435 where cc.subject_id=aggView8934525340687528435.v5;
create or replace view aggView5242734110979629727 as select id as v7 from comp_cast_type as cct2 where kind LIKE '%complete%';
create or replace view aggJoin4104698027320504662 as select v47 from aggJoin6208967691990840833 join aggView5242734110979629727 using(v7);
create or replace view aggView2217277388007117628 as select v47 from aggJoin4104698027320504662 group by v47;
create or replace view aggJoin2828805265933894072 as select movie_id as v47, keyword_id as v25 from movie_keyword as mk, aggView2217277388007117628 where mk.movie_id=aggView2217277388007117628.v47;
create or replace view aggView1877136066169249984 as select id as v25 from keyword as k where keyword IN ('superhero','marvel-comics','based-on-comic','tv-special','fight','violence','magnet','web','claw','laser');
create or replace view aggJoin7336316583222074138 as select v47 from aggJoin2828805265933894072 join aggView1877136066169249984 using(v25);
create or replace view aggView7172569359313492429 as select v47 from aggJoin7336316583222074138 group by v47;
create or replace view aggJoin7367299081107918151 as select v47, v48 from aggJoin8781600012594748417 join aggView7172569359313492429 using(v47);
create or replace view aggView4210641349589520378 as select v47, MIN(v48) as v61 from aggJoin7367299081107918151 group by v47;
create or replace view aggJoin7777655697765568860 as select v47, v33, v61 from aggJoin739554987275721756 join aggView4210641349589520378 using(v47);
create or replace view aggView2735724791878993021 as select v47, MIN(v61) as v61, MIN(v33) as v60 from aggJoin7777655697765568860 group by v47;
create or replace view aggJoin8772586932511806791 as select v9, v61, v60 from aggJoin2482526940570291294 join aggView2735724791878993021 using(v47);
create or replace view aggView9024793762652126462 as select v9, MIN(v61) as v61, MIN(v60) as v60 from aggJoin8772586932511806791 group by v9;
create or replace view aggJoin4977145729471918011 as select name as v10, v61, v60 from char_name as chn, aggView9024793762652126462 where chn.id=aggView9024793762652126462.v9 and ((name LIKE '%man%') OR (name LIKE '%Man%'));
create or replace view res as select MIN(v10) as v59, MIN(v60) as v60, MIN(v61) as v61 from aggJoin4977145729471918011;
select sum(v59+v60+v61) from res;