create or replace view aggView4154960640829509411 as select id as v9, name as v59 from char_name as chn where ((name LIKE '%man%') OR (name LIKE '%Man%'));
create or replace view aggJoin6627597361843957626 as select person_id as v38, movie_id as v47, v59 from cast_info as ci, aggView4154960640829509411 where ci.person_role_id=aggView4154960640829509411.v9;
create or replace view aggView8761606374370484326 as select id as v28 from kind_type as kt where kind= 'movie';
create or replace view aggJoin1764871731159950309 as select id as v47, title as v48 from title as t, aggView8761606374370484326 where t.kind_id=aggView8761606374370484326.v28 and production_year>2000;
create or replace view aggView6478306974575593463 as select id as v23 from info_type as it2 where info= 'rating';
create or replace view aggJoin9114030095608924056 as select movie_id as v47, info as v33 from movie_info_idx as mi_idx, aggView6478306974575593463 where mi_idx.info_type_id=aggView6478306974575593463.v23;
create or replace view aggView6001097602700930520 as select id as v5 from comp_cast_type as cct1 where kind= 'cast';
create or replace view aggJoin902643021863202828 as select movie_id as v47, status_id as v7 from complete_cast as cc, aggView6001097602700930520 where cc.subject_id=aggView6001097602700930520.v5;
create or replace view aggView6519081447493213844 as select id as v7 from comp_cast_type as cct2 where kind LIKE '%complete%';
create or replace view aggJoin1923235149338133076 as select v47 from aggJoin902643021863202828 join aggView6519081447493213844 using(v7);
create or replace view aggView6152229455551271037 as select v47 from aggJoin1923235149338133076 group by v47;
create or replace view aggJoin1362460930993930270 as select v47, v48 from aggJoin1764871731159950309 join aggView6152229455551271037 using(v47);
create or replace view aggView367925419774064145 as select v47, MIN(v48) as v61 from aggJoin1362460930993930270 group by v47;
create or replace view aggJoin4316812680459062642 as select movie_id as v47, keyword_id as v25, v61 from movie_keyword as mk, aggView367925419774064145 where mk.movie_id=aggView367925419774064145.v47;
create or replace view aggView3980278602243775088 as select id as v25 from keyword as k where keyword IN ('superhero','marvel-comics','based-on-comic','tv-special','fight','violence','magnet','web','claw','laser');
create or replace view aggJoin6550874142754668568 as select v47, v61 from aggJoin4316812680459062642 join aggView3980278602243775088 using(v25);
create or replace view aggView8799355723829517439 as select v47, MIN(v61) as v61 from aggJoin6550874142754668568 group by v47;
create or replace view aggJoin248780722479452221 as select v47, v33, v61 from aggJoin9114030095608924056 join aggView8799355723829517439 using(v47);
create or replace view aggView3442969946311065555 as select v47, MIN(v61) as v61, MIN(v33) as v60 from aggJoin248780722479452221 group by v47;
create or replace view aggJoin3190327979719497593 as select v38, v59 as v59, v61, v60 from aggJoin6627597361843957626 join aggView3442969946311065555 using(v47);
create or replace view aggView1109416955967093007 as select v38, MIN(v59) as v59, MIN(v61) as v61, MIN(v60) as v60 from aggJoin3190327979719497593 group by v38;
create or replace view aggJoin9162926106036923852 as select v59, v61, v60 from name as n, aggView1109416955967093007 where n.id=aggView1109416955967093007.v38;
create or replace view res as select MIN(v59) as v59, MIN(v60) as v60, MIN(v61) as v61 from aggJoin9162926106036923852;
select sum(v59+v60+v61) from res;