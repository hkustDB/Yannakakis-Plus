create or replace view aggView1051982300970402799 as select id as v28 from kind_type as kt where kind= 'movie';
create or replace view aggJoin7632174728306380894 as select id as v47, title as v48 from title as t, aggView1051982300970402799 where t.kind_id=aggView1051982300970402799.v28 and production_year>2000;
create or replace view aggView8750977123845944050 as select id as v38 from name as n;
create or replace view aggJoin3800399539029559586 as select movie_id as v47, person_role_id as v9 from cast_info as ci, aggView8750977123845944050 where ci.person_id=aggView8750977123845944050.v38;
create or replace view aggView160750127933364298 as select id as v23 from info_type as it2 where info= 'rating';
create or replace view aggJoin1954293955071407986 as select movie_id as v47, info as v33 from movie_info_idx as mi_idx, aggView160750127933364298 where mi_idx.info_type_id=aggView160750127933364298.v23;
create or replace view aggView3348760882017366343 as select id as v5 from comp_cast_type as cct1 where kind= 'cast';
create or replace view aggJoin6129154248918412281 as select movie_id as v47, status_id as v7 from complete_cast as cc, aggView3348760882017366343 where cc.subject_id=aggView3348760882017366343.v5;
create or replace view aggView2512777767804260157 as select id as v7 from comp_cast_type as cct2 where kind LIKE '%complete%';
create or replace view aggJoin5135195457863475320 as select v47 from aggJoin6129154248918412281 join aggView2512777767804260157 using(v7);
create or replace view aggView9084909651303109450 as select v47 from aggJoin5135195457863475320 group by v47;
create or replace view aggJoin8130646267624013146 as select v47, v48 from aggJoin7632174728306380894 join aggView9084909651303109450 using(v47);
create or replace view aggView5595868540422107082 as select v47, MIN(v48) as v61 from aggJoin8130646267624013146 group by v47;
create or replace view aggJoin6046763064082533891 as select v47, v33, v61 from aggJoin1954293955071407986 join aggView5595868540422107082 using(v47);
create or replace view aggView5105971211523398715 as select v47, MIN(v61) as v61, MIN(v33) as v60 from aggJoin6046763064082533891 group by v47;
create or replace view aggJoin2137385213922813348 as select movie_id as v47, keyword_id as v25, v61, v60 from movie_keyword as mk, aggView5105971211523398715 where mk.movie_id=aggView5105971211523398715.v47;
create or replace view aggView151815295014351990 as select id as v25 from keyword as k where keyword IN ('superhero','marvel-comics','based-on-comic','tv-special','fight','violence','magnet','web','claw','laser');
create or replace view aggJoin997131333946553706 as select v47, v61, v60 from aggJoin2137385213922813348 join aggView151815295014351990 using(v25);
create or replace view aggView5886594644422793822 as select v47, MIN(v61) as v61, MIN(v60) as v60 from aggJoin997131333946553706 group by v47;
create or replace view aggJoin2290030870625481316 as select v9, v61, v60 from aggJoin3800399539029559586 join aggView5886594644422793822 using(v47);
create or replace view aggView2832539268512749042 as select v9, MIN(v61) as v61, MIN(v60) as v60 from aggJoin2290030870625481316 group by v9;
create or replace view aggJoin3361501476537779694 as select name as v10, v61, v60 from char_name as chn, aggView2832539268512749042 where chn.id=aggView2832539268512749042.v9 and ((name LIKE '%man%') OR (name LIKE '%Man%'));
create or replace view res as select MIN(v10) as v59, MIN(v60) as v60, MIN(v61) as v61 from aggJoin3361501476537779694;
select sum(v59+v60+v61) from res;