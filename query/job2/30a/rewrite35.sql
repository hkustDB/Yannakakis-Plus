create or replace view aggView7100064336686714132 as select id as v45, title as v60 from title as t where production_year>2000;
create or replace view aggJoin4125015625405234194 as select person_id as v36, movie_id as v45, note as v13, v60 from cast_info as ci, aggView7100064336686714132 where ci.movie_id=aggView7100064336686714132.v45 and note IN ('(writer)','(head writer)','(written by)','(story)','(story editor)');
create or replace view aggView3447122896557171315 as select id as v36, name as v59 from name as n where gender= 'm';
create or replace view aggJoin6903338150988147714 as select v45, v13, v60, v59 from aggJoin4125015625405234194 join aggView3447122896557171315 using(v36);
create or replace view aggView8381088067052281032 as select id as v16 from info_type as it1 where info= 'genres';
create or replace view aggJoin2475382835890382558 as select movie_id as v45, info as v26 from movie_info as mi, aggView8381088067052281032 where mi.info_type_id=aggView8381088067052281032.v16 and info IN ('Horror','Thriller');
create or replace view aggView5443356514386108124 as select id as v20 from keyword as k where keyword IN ('murder','violence','blood','gore','death','female-nudity','hospital');
create or replace view aggJoin8433339109645605296 as select movie_id as v45 from movie_keyword as mk, aggView5443356514386108124 where mk.keyword_id=aggView5443356514386108124.v20;
create or replace view aggView410953288248614800 as select id as v7 from comp_cast_type as cct2 where kind= 'complete+verified';
create or replace view aggJoin6331196747290093174 as select movie_id as v45, subject_id as v5 from complete_cast as cc, aggView410953288248614800 where cc.status_id=aggView410953288248614800.v7;
create or replace view aggView8329300535684271876 as select id as v5 from comp_cast_type as cct1 where kind IN ('cast','crew');
create or replace view aggJoin6525974308642015293 as select v45 from aggJoin6331196747290093174 join aggView8329300535684271876 using(v5);
create or replace view aggView6580234736273658879 as select v45 from aggJoin6525974308642015293 group by v45;
create or replace view aggJoin4815072931264309355 as select v45, v26 from aggJoin2475382835890382558 join aggView6580234736273658879 using(v45);
create or replace view aggView1092677535060158304 as select v45, MIN(v26) as v57 from aggJoin4815072931264309355 group by v45;
create or replace view aggJoin6377472965185454266 as select movie_id as v45, info_type_id as v18, info as v31, v57 from movie_info_idx as mi_idx, aggView1092677535060158304 where mi_idx.movie_id=aggView1092677535060158304.v45;
create or replace view aggView2892102481245065762 as select v45, MIN(v60) as v60, MIN(v59) as v59 from aggJoin6903338150988147714 group by v45;
create or replace view aggJoin779060618125149925 as select v45, v60, v59 from aggJoin8433339109645605296 join aggView2892102481245065762 using(v45);
create or replace view aggView1255077760956234494 as select v45, MIN(v60) as v60, MIN(v59) as v59 from aggJoin779060618125149925 group by v45;
create or replace view aggJoin3836567698543061571 as select v18, v31, v57 as v57, v60, v59 from aggJoin6377472965185454266 join aggView1255077760956234494 using(v45);
create or replace view aggView5769950140445182430 as select v18, MIN(v57) as v57, MIN(v60) as v60, MIN(v59) as v59, MIN(v31) as v58 from aggJoin3836567698543061571 group by v18;
create or replace view aggJoin1195834292976697487 as select info as v19, v57, v60, v59, v58 from info_type as it2, aggView5769950140445182430 where it2.id=aggView5769950140445182430.v18 and info= 'votes';
create or replace view res as select MIN(v57) as v57, MIN(v58) as v58, MIN(v59) as v59, MIN(v60) as v60 from aggJoin1195834292976697487;
select sum(v57+v58+v59+v60) from res;