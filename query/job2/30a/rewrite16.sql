create or replace view aggView3935746511974523133 as select id as v9, name as v57 from company_name as cn where country_code<> '[us]';
create or replace view aggJoin7869173258341648785 as select movie_id as v45, company_type_id as v16, note as v31, v57 from movie_companies as mc, aggView3935746511974523133 where mc.company_id=aggView3935746511974523133.v9 and note NOT LIKE '%(USA)%' and note LIKE '%(200%)%';
create or replace view aggView5550812842480801018 as select id as v5 from comp_cast_type as cct1 where kind= 'cast';
create or replace view aggJoin4826673363923918786 as select movie_id as v45, status_id as v7 from complete_cast as cc, aggView5550812842480801018 where cc.subject_id=aggView5550812842480801018.v5;
create or replace view aggView7584155553150896468 as select id as v20 from info_type as it2 where info= 'rating';
create or replace view aggJoin2918628319142776637 as select movie_id as v45, info as v40 from movie_info_idx as mi_idx, aggView7584155553150896468 where mi_idx.info_type_id=aggView7584155553150896468.v20 and info<'8.5';
create or replace view aggView7595910119127683991 as select v45, MIN(v40) as v58 from aggJoin2918628319142776637 group by v45;
create or replace view aggJoin9120426072723101723 as select id as v45, title as v46, kind_id as v25, production_year as v49, v58 from title as t, aggView7595910119127683991 where t.id=aggView7595910119127683991.v45 and production_year>2005;
create or replace view aggView2048756140986518083 as select id as v16 from company_type as ct;
create or replace view aggJoin1218846185082849999 as select v45, v31, v57 from aggJoin7869173258341648785 join aggView2048756140986518083 using(v16);
create or replace view aggView4745245217624380071 as select v45, MIN(v57) as v57 from aggJoin1218846185082849999 group by v45;
create or replace view aggJoin4884456042840804885 as select v45, v7, v57 from aggJoin4826673363923918786 join aggView4745245217624380071 using(v45);
create or replace view aggView2786384189808807736 as select id as v25 from kind_type as kt where kind IN ('movie','episode');
create or replace view aggJoin8723441337145072659 as select v45, v46, v49, v58 from aggJoin9120426072723101723 join aggView2786384189808807736 using(v25);
create or replace view aggView4129986644729478083 as select v45, MIN(v58) as v58, MIN(v46) as v59 from aggJoin8723441337145072659 group by v45;
create or replace view aggJoin3507101103743697289 as select v45, v7, v57 as v57, v58, v59 from aggJoin4884456042840804885 join aggView4129986644729478083 using(v45);
create or replace view aggView550688971014303263 as select id as v18 from info_type as it1 where info= 'countries';
create or replace view aggJoin2427904522436203527 as select movie_id as v45, info as v35 from movie_info as mi, aggView550688971014303263 where mi.info_type_id=aggView550688971014303263.v18 and info IN ('Sweden','Norway','Germany','Denmark','Swedish','Danish','Norwegian','German','USA','American');
create or replace view aggView5193522818737625810 as select v45 from aggJoin2427904522436203527 group by v45;
create or replace view aggJoin5019246420220848747 as select movie_id as v45, keyword_id as v22 from movie_keyword as mk, aggView5193522818737625810 where mk.movie_id=aggView5193522818737625810.v45;
create or replace view aggView5979820254478643106 as select id as v22 from keyword as k where keyword IN ('murder','murder-in-title','blood','violence');
create or replace view aggJoin3977088764592214908 as select v45 from aggJoin5019246420220848747 join aggView5979820254478643106 using(v22);
create or replace view aggView4396840218447302211 as select id as v7 from comp_cast_type as cct2 where kind= 'complete';
create or replace view aggJoin5573509640824605766 as select v45, v57, v58, v59 from aggJoin3507101103743697289 join aggView4396840218447302211 using(v7);
create or replace view aggView7344108841431821048 as select v45, MIN(v57) as v57, MIN(v58) as v58, MIN(v59) as v59 from aggJoin5573509640824605766 group by v45;
create or replace view aggJoin6957933498302212344 as select v57, v58, v59 from aggJoin3977088764592214908 join aggView7344108841431821048 using(v45);
select MIN(v57) as v57,MIN(v58) as v58,MIN(v59) as v59 from aggJoin6957933498302212344;
