create or replace view aggView2855789679634622267 as select id as v9, name as v10 from company_name as cn where country_code<> '[us]';
create or replace view aggView4720038699696573718 as select id as v20 from info_type as it2 where info= 'rating';
create or replace view aggJoin3285125106508376813 as select movie_id as v45, info as v40 from movie_info_idx as mi_idx, aggView4720038699696573718 where mi_idx.info_type_id=aggView4720038699696573718.v20;
create or replace view aggView9218870975041369681 as select v45, v40 from aggJoin3285125106508376813;
create or replace view aggJoin8436371372738526429 as select v45, v40 from aggView9218870975041369681 where v40<'8.5';
create or replace view aggView2897542336994934754 as select id as v25 from kind_type as kt where kind IN ('movie','episode');
create or replace view aggJoin3973165721894269360 as select id as v45, title as v46, production_year as v49 from title as t, aggView2897542336994934754 where t.kind_id=aggView2897542336994934754.v25 and production_year>2005;
create or replace view aggView7021852812877539647 as select v45, v46 from aggJoin3973165721894269360;
create or replace view aggView5210426391615490292 as select v45, MIN(v46) as v59 from aggView7021852812877539647 group by v45;
create or replace view aggJoin7579261989458648040 as select v45, v40, v59 from aggJoin8436371372738526429 join aggView5210426391615490292 using(v45);
create or replace view aggView9049619277021579018 as select v45, MIN(v59) as v59, MIN(v40) as v58 from aggJoin7579261989458648040 group by v45;
create or replace view aggJoin4829314613741368032 as select movie_id as v45, company_id as v9, company_type_id as v16, note as v31, v59, v58 from movie_companies as mc, aggView9049619277021579018 where mc.movie_id=aggView9049619277021579018.v45 and note NOT LIKE '%(USA)%' and note LIKE '%(200%)%';
create or replace view aggView2623812215917611134 as select id as v5 from comp_cast_type as cct1 where kind= 'cast';
create or replace view aggJoin7052352165289632782 as select movie_id as v45, status_id as v7 from complete_cast as cc, aggView2623812215917611134 where cc.subject_id=aggView2623812215917611134.v5;
create or replace view aggView7241708429924948635 as select id as v16 from company_type as ct;
create or replace view aggJoin4045148670423308397 as select v45, v9, v31, v59, v58 from aggJoin4829314613741368032 join aggView7241708429924948635 using(v16);
create or replace view aggView562309757688224531 as select id as v18 from info_type as it1 where info= 'countries';
create or replace view aggJoin6255078347976362564 as select movie_id as v45, info as v35 from movie_info as mi, aggView562309757688224531 where mi.info_type_id=aggView562309757688224531.v18 and info IN ('Sweden','Norway','Germany','Denmark','Swedish','Danish','Norwegian','German','USA','American');
create or replace view aggView2636361898779325145 as select v45 from aggJoin6255078347976362564 group by v45;
create or replace view aggJoin4959251856025653267 as select v45, v7 from aggJoin7052352165289632782 join aggView2636361898779325145 using(v45);
create or replace view aggView4641348829042076984 as select id as v22 from keyword as k where keyword IN ('murder','murder-in-title','blood','violence');
create or replace view aggJoin5011372591801052834 as select movie_id as v45 from movie_keyword as mk, aggView4641348829042076984 where mk.keyword_id=aggView4641348829042076984.v22;
create or replace view aggView5736761784078596571 as select v45 from aggJoin5011372591801052834 group by v45;
create or replace view aggJoin3803053125698192407 as select v45, v9, v31, v59 as v59, v58 as v58 from aggJoin4045148670423308397 join aggView5736761784078596571 using(v45);
create or replace view aggView6370893042183284867 as select id as v7 from comp_cast_type as cct2 where kind= 'complete';
create or replace view aggJoin5043970866262604183 as select v45 from aggJoin4959251856025653267 join aggView6370893042183284867 using(v7);
create or replace view aggView8010466471462156865 as select v45 from aggJoin5043970866262604183 group by v45;
create or replace view aggJoin6960750080715425340 as select v9, v31, v59 as v59, v58 as v58 from aggJoin3803053125698192407 join aggView8010466471462156865 using(v45);
create or replace view aggView7246029896595547604 as select v9, MIN(v59) as v59, MIN(v58) as v58 from aggJoin6960750080715425340 group by v9;
create or replace view aggJoin4424193426853010047 as select v10, v59, v58 from aggView2855789679634622267 join aggView7246029896595547604 using(v9);
select MIN(v10) as v57,MIN(v58) as v58,MIN(v59) as v59 from aggJoin4424193426853010047;
