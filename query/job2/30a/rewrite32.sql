create or replace view aggView2334100000220351717 as select id as v36, name as v59 from name as n where gender= 'm';
create or replace view aggJoin8733189021878940668 as select movie_id as v45, note as v13, v59 from cast_info as ci, aggView2334100000220351717 where ci.person_id=aggView2334100000220351717.v36 and note IN ('(writer)','(head writer)','(written by)','(story)','(story editor)');
create or replace view aggView7945056576797780253 as select id as v16 from info_type as it1 where info= 'genres';
create or replace view aggJoin1803677773322111889 as select movie_id as v45, info as v26 from movie_info as mi, aggView7945056576797780253 where mi.info_type_id=aggView7945056576797780253.v16 and info IN ('Horror','Thriller');
create or replace view aggView5588917446822345222 as select id as v20 from keyword as k where keyword IN ('murder','violence','blood','gore','death','female-nudity','hospital');
create or replace view aggJoin4390196027941797708 as select movie_id as v45 from movie_keyword as mk, aggView5588917446822345222 where mk.keyword_id=aggView5588917446822345222.v20;
create or replace view aggView5335022300150802904 as select id as v7 from comp_cast_type as cct2 where kind= 'complete+verified';
create or replace view aggJoin7416964637466770047 as select movie_id as v45, subject_id as v5 from complete_cast as cc, aggView5335022300150802904 where cc.status_id=aggView5335022300150802904.v7;
create or replace view aggView3641148340607012968 as select v45 from aggJoin4390196027941797708 group by v45;
create or replace view aggJoin8757230462665448958 as select id as v45, title as v46 from title as t, aggView3641148340607012968 where t.id=aggView3641148340607012968.v45 and production_year>2000;
create or replace view aggView8785943127865820949 as select id as v5 from comp_cast_type as cct1 where kind IN ('cast','crew');
create or replace view aggJoin7702482950932050875 as select v45 from aggJoin7416964637466770047 join aggView8785943127865820949 using(v5);
create or replace view aggView3593728516756823295 as select v45 from aggJoin7702482950932050875 group by v45;
create or replace view aggJoin9142847826274172635 as select movie_id as v45, info_type_id as v18, info as v31 from movie_info_idx as mi_idx, aggView3593728516756823295 where mi_idx.movie_id=aggView3593728516756823295.v45;
create or replace view aggView1349299267539191806 as select id as v18 from info_type as it2 where info= 'votes';
create or replace view aggJoin7889137980931595844 as select v45, v31 from aggJoin9142847826274172635 join aggView1349299267539191806 using(v18);
create or replace view aggView737714341840674884 as select v45, MIN(v31) as v58 from aggJoin7889137980931595844 group by v45;
create or replace view aggJoin3102269820993494394 as select v45, v59 as v59, v58 from aggJoin8733189021878940668 join aggView737714341840674884 using(v45);
create or replace view aggView5765120919307766465 as select v45, MIN(v59) as v59, MIN(v58) as v58 from aggJoin3102269820993494394 group by v45;
create or replace view aggJoin1280204630587128725 as select v45, v26, v59, v58 from aggJoin1803677773322111889 join aggView5765120919307766465 using(v45);
create or replace view aggView1005612069820123601 as select v45, MIN(v59) as v59, MIN(v58) as v58, MIN(v26) as v57 from aggJoin1280204630587128725 group by v45;
create or replace view aggJoin2058815220719963354 as select v46, v59, v58, v57 from aggJoin8757230462665448958 join aggView1005612069820123601 using(v45);
create or replace view res as select MIN(v57) as v57, MIN(v58) as v58, MIN(v59) as v59, MIN(v46) as v60 from aggJoin2058815220719963354;
select sum(v57+v58+v59+v60) from res;