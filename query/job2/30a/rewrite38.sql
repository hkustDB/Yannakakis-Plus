create or replace view aggView1491788246106352515 as select id as v16 from info_type as it1 where info= 'genres';
create or replace view aggJoin8905916990339559395 as select movie_id as v45, info as v26 from movie_info as mi, aggView1491788246106352515 where mi.info_type_id=aggView1491788246106352515.v16 and info IN ('Horror','Thriller');
create or replace view aggView650982426140078290 as select v45, MIN(v26) as v57 from aggJoin8905916990339559395 group by v45;
create or replace view aggJoin5144126443468861206 as select id as v45, title as v46, v57 from title as t, aggView650982426140078290 where t.id=aggView650982426140078290.v45 and production_year>2000;
create or replace view aggView8486161975010434587 as select id as v20 from keyword as k where keyword IN ('murder','violence','blood','gore','death','female-nudity','hospital');
create or replace view aggJoin4172758013813742216 as select movie_id as v45 from movie_keyword as mk, aggView8486161975010434587 where mk.keyword_id=aggView8486161975010434587.v20;
create or replace view aggView7254380238996708961 as select id as v7 from comp_cast_type as cct2 where kind= 'complete+verified';
create or replace view aggJoin7143764448130388049 as select movie_id as v45, subject_id as v5 from complete_cast as cc, aggView7254380238996708961 where cc.status_id=aggView7254380238996708961.v7;
create or replace view aggView5346790377837864681 as select id as v5 from comp_cast_type as cct1 where kind IN ('cast','crew');
create or replace view aggJoin915081331368390494 as select v45 from aggJoin7143764448130388049 join aggView5346790377837864681 using(v5);
create or replace view aggView3807830079042339111 as select v45 from aggJoin915081331368390494 group by v45;
create or replace view aggJoin526002922526890002 as select v45, v46, v57 as v57 from aggJoin5144126443468861206 join aggView3807830079042339111 using(v45);
create or replace view aggView655466607911323498 as select v45, MIN(v57) as v57, MIN(v46) as v60 from aggJoin526002922526890002 group by v45;
create or replace view aggJoin3567940764383748044 as select person_id as v36, movie_id as v45, v57, v60 from cast_info as ci, aggView655466607911323498 where ci.movie_id=aggView655466607911323498.v45 and note IN ('(writer)','(head writer)','(written by)','(story)','(story editor)');
create or replace view aggView8589269965748248829 as select v45 from aggJoin4172758013813742216 group by v45;
create or replace view aggJoin4666651686493514334 as select movie_id as v45, info_type_id as v18, info as v31 from movie_info_idx as mi_idx, aggView8589269965748248829 where mi_idx.movie_id=aggView8589269965748248829.v45;
create or replace view aggView700973555342193501 as select id as v18 from info_type as it2 where info= 'votes';
create or replace view aggJoin3797201382502847465 as select v45, v31 from aggJoin4666651686493514334 join aggView700973555342193501 using(v18);
create or replace view aggView8436957017846343009 as select v45, MIN(v31) as v58 from aggJoin3797201382502847465 group by v45;
create or replace view aggJoin7712184865748687078 as select v36, v57 as v57, v60 as v60, v58 from aggJoin3567940764383748044 join aggView8436957017846343009 using(v45);
create or replace view aggView7519256295873778519 as select v36, MIN(v57) as v57, MIN(v60) as v60, MIN(v58) as v58 from aggJoin7712184865748687078 group by v36;
create or replace view aggJoin3375087473238656489 as select name as v37, v57, v60, v58 from name as n, aggView7519256295873778519 where n.id=aggView7519256295873778519.v36 and gender= 'm';
create or replace view res as select MIN(v57) as v57, MIN(v58) as v58, MIN(v37) as v59, MIN(v60) as v60 from aggJoin3375087473238656489;
select sum(v57+v58+v59+v60) from res;