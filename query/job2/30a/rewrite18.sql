create or replace view aggView2185343585985577483 as select id as v9, name as v57 from company_name as cn where country_code<> '[us]';
create or replace view aggJoin2352914447529830319 as select movie_id as v45, company_type_id as v16, note as v31, v57 from movie_companies as mc, aggView2185343585985577483 where mc.company_id=aggView2185343585985577483.v9 and note NOT LIKE '%(USA)%' and note LIKE '%(200%)%';
create or replace view aggView6554281253273357588 as select id as v5 from comp_cast_type as cct1 where kind= 'cast';
create or replace view aggJoin4990799107932203548 as select movie_id as v45, status_id as v7 from complete_cast as cc, aggView6554281253273357588 where cc.subject_id=aggView6554281253273357588.v5;
create or replace view aggView54732179061588917 as select id as v20 from info_type as it2 where info= 'rating';
create or replace view aggJoin5275135237111201870 as select movie_id as v45, info as v40 from movie_info_idx as mi_idx, aggView54732179061588917 where mi_idx.info_type_id=aggView54732179061588917.v20 and info<'8.5';
create or replace view aggView1859394006816162119 as select v45, MIN(v40) as v58 from aggJoin5275135237111201870 group by v45;
create or replace view aggJoin1943742691621224191 as select id as v45, title as v46, kind_id as v25, production_year as v49, v58 from title as t, aggView1859394006816162119 where t.id=aggView1859394006816162119.v45 and production_year>2005;
create or replace view aggView8619561387532576938 as select id as v16 from company_type as ct;
create or replace view aggJoin6378235571310871539 as select v45, v31, v57 from aggJoin2352914447529830319 join aggView8619561387532576938 using(v16);
create or replace view aggView646401909214436623 as select v45, MIN(v57) as v57 from aggJoin6378235571310871539 group by v45;
create or replace view aggJoin456538045569716283 as select v45, v46, v25, v49, v58 as v58, v57 from aggJoin1943742691621224191 join aggView646401909214436623 using(v45);
create or replace view aggView3880636022155228982 as select id as v25 from kind_type as kt where kind IN ('movie','episode');
create or replace view aggJoin4200837835336641711 as select v45, v46, v49, v58, v57 from aggJoin456538045569716283 join aggView3880636022155228982 using(v25);
create or replace view aggView8305389171962066661 as select id as v18 from info_type as it1 where info= 'countries';
create or replace view aggJoin8617638860722260413 as select movie_id as v45, info as v35 from movie_info as mi, aggView8305389171962066661 where mi.info_type_id=aggView8305389171962066661.v18 and info IN ('Sweden','Norway','Germany','Denmark','Swedish','Danish','Norwegian','German','USA','American');
create or replace view aggView3482173882730676148 as select id as v22 from keyword as k where keyword IN ('murder','murder-in-title','blood','violence');
create or replace view aggJoin5076751488263515293 as select movie_id as v45 from movie_keyword as mk, aggView3482173882730676148 where mk.keyword_id=aggView3482173882730676148.v22;
create or replace view aggView3089097417310415917 as select id as v7 from comp_cast_type as cct2 where kind= 'complete';
create or replace view aggJoin1619713545133959240 as select v45 from aggJoin4990799107932203548 join aggView3089097417310415917 using(v7);
create or replace view aggView4097877374201639107 as select v45 from aggJoin1619713545133959240 group by v45;
create or replace view aggJoin7192936561833700017 as select v45, v46, v49, v58 as v58, v57 as v57 from aggJoin4200837835336641711 join aggView4097877374201639107 using(v45);
create or replace view aggView2724785522412617906 as select v45 from aggJoin8617638860722260413 group by v45;
create or replace view aggJoin7369001220365526648 as select v45, v46, v49, v58 as v58, v57 as v57 from aggJoin7192936561833700017 join aggView2724785522412617906 using(v45);
create or replace view aggView8707021965790810133 as select v45, MIN(v58) as v58, MIN(v57) as v57, MIN(v46) as v59 from aggJoin7369001220365526648 group by v45;
create or replace view aggJoin6305665557461557886 as select v58, v57, v59 from aggJoin5076751488263515293 join aggView8707021965790810133 using(v45);
select MIN(v57) as v57,MIN(v58) as v58,MIN(v59) as v59 from aggJoin6305665557461557886;
