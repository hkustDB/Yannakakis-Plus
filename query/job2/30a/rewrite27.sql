create or replace view aggView6780339247010300417 as select id as v36, name as v59 from name as n where gender= 'm';
create or replace view aggJoin7215142214731475207 as select movie_id as v45, note as v13, v59 from cast_info as ci, aggView6780339247010300417 where ci.person_id=aggView6780339247010300417.v36 and note IN ('(writer)','(head writer)','(written by)','(story)','(story editor)');
create or replace view aggView2339327455988961434 as select id as v20 from keyword as k where keyword IN ('murder','violence','blood','gore','death','female-nudity','hospital');
create or replace view aggJoin2061878473501758692 as select movie_id as v45 from movie_keyword as mk, aggView2339327455988961434 where mk.keyword_id=aggView2339327455988961434.v20;
create or replace view aggView9400768334686046 as select id as v7 from comp_cast_type as cct2 where kind= 'complete+verified';
create or replace view aggJoin7175080373781038138 as select movie_id as v45, subject_id as v5 from complete_cast as cc, aggView9400768334686046 where cc.status_id=aggView9400768334686046.v7;
create or replace view aggView5652127094555092616 as select id as v5 from comp_cast_type as cct1 where kind IN ('cast','crew');
create or replace view aggJoin5608335244582397587 as select v45 from aggJoin7175080373781038138 join aggView5652127094555092616 using(v5);
create or replace view aggView7517752197595332943 as select v45 from aggJoin5608335244582397587 group by v45;
create or replace view aggJoin1707298928361679916 as select v45, v13, v59 as v59 from aggJoin7215142214731475207 join aggView7517752197595332943 using(v45);
create or replace view aggView3318011166542925427 as select v45, MIN(v59) as v59 from aggJoin1707298928361679916 group by v45;
create or replace view aggJoin2661594905627495773 as select movie_id as v45, info_type_id as v16, info as v26, v59 from movie_info as mi, aggView3318011166542925427 where mi.movie_id=aggView3318011166542925427.v45 and info IN ('Horror','Thriller');
create or replace view aggView5273631487141201061 as select v45 from aggJoin2061878473501758692 group by v45;
create or replace view aggJoin3517363473525132916 as select movie_id as v45, info_type_id as v18, info as v31 from movie_info_idx as mi_idx, aggView5273631487141201061 where mi_idx.movie_id=aggView5273631487141201061.v45;
create or replace view aggView582124600484185503 as select id as v18 from info_type as it2 where info= 'votes';
create or replace view aggJoin6778734215258045252 as select v45, v31 from aggJoin3517363473525132916 join aggView582124600484185503 using(v18);
create or replace view aggView171739246489980722 as select v45, MIN(v31) as v58 from aggJoin6778734215258045252 group by v45;
create or replace view aggJoin6759152449144861164 as select id as v45, title as v46, v58 from title as t, aggView171739246489980722 where t.id=aggView171739246489980722.v45 and production_year>2000;
create or replace view aggView5471361653461769568 as select v45, MIN(v58) as v58, MIN(v46) as v60 from aggJoin6759152449144861164 group by v45;
create or replace view aggJoin2942619438403589955 as select v16, v26, v59 as v59, v58, v60 from aggJoin2661594905627495773 join aggView5471361653461769568 using(v45);
create or replace view aggView2081156585998426006 as select v16, MIN(v59) as v59, MIN(v58) as v58, MIN(v60) as v60, MIN(v26) as v57 from aggJoin2942619438403589955 group by v16;
create or replace view aggJoin7951553379076600482 as select v59, v58, v60, v57 from info_type as it1, aggView2081156585998426006 where it1.id=aggView2081156585998426006.v16 and info= 'genres';
create or replace view res as select MIN(v57) as v57, MIN(v58) as v58, MIN(v59) as v59, MIN(v60) as v60 from aggJoin7951553379076600482;
select sum(v57+v58+v59+v60) from res;