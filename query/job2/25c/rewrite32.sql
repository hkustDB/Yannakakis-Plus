create or replace view aggView2804040830119740640 as select id as v28, name as v51 from name as n where gender= 'm';
create or replace view aggJoin9211065280143848298 as select movie_id as v37, note as v5, v51 from cast_info as ci, aggView2804040830119740640 where ci.person_id=aggView2804040830119740640.v28 and note IN ('(writer)','(head writer)','(written by)','(story)','(story editor)');
create or replace view aggView3191468837369474866 as select id as v10 from info_type as it2 where info= 'votes';
create or replace view aggJoin5761278851038950133 as select movie_id as v37, info as v23 from movie_info_idx as mi_idx, aggView3191468837369474866 where mi_idx.info_type_id=aggView3191468837369474866.v10;
create or replace view aggView4292828379270146649 as select id as v8 from info_type as it1 where info= 'genres';
create or replace view aggJoin1892152741766298147 as select movie_id as v37, info as v18 from movie_info as mi, aggView4292828379270146649 where mi.info_type_id=aggView4292828379270146649.v8 and info IN ('Horror','Action','Sci-Fi','Thriller','Crime','War');
create or replace view aggView8483377607238951562 as select v37, MIN(v51) as v51 from aggJoin9211065280143848298 group by v37;
create or replace view aggJoin2276404001952069952 as select v37, v23, v51 from aggJoin5761278851038950133 join aggView8483377607238951562 using(v37);
create or replace view aggView151386299129267780 as select v37, MIN(v51) as v51, MIN(v23) as v50 from aggJoin2276404001952069952 group by v37;
create or replace view aggJoin2820005198810392831 as select v37, v18, v51, v50 from aggJoin1892152741766298147 join aggView151386299129267780 using(v37);
create or replace view aggView8680403653898031259 as select v37, MIN(v51) as v51, MIN(v50) as v50, MIN(v18) as v49 from aggJoin2820005198810392831 group by v37;
create or replace view aggJoin4227381985705449629 as select id as v37, title as v38, v51, v50, v49 from title as t, aggView8680403653898031259 where t.id=aggView8680403653898031259.v37;
create or replace view aggView5973760722522381863 as select v37, MIN(v51) as v51, MIN(v50) as v50, MIN(v49) as v49, MIN(v38) as v52 from aggJoin4227381985705449629 group by v37;
create or replace view aggJoin3756551411466027872 as select keyword_id as v12, v51, v50, v49, v52 from movie_keyword as mk, aggView5973760722522381863 where mk.movie_id=aggView5973760722522381863.v37;
create or replace view aggView9170246072619546192 as select id as v12 from keyword as k where keyword IN ('murder','violence','blood','gore','death','female-nudity','hospital');
create or replace view aggJoin4403371615199426439 as select v51, v50, v49, v52 from aggJoin3756551411466027872 join aggView9170246072619546192 using(v12);
create or replace view res as select MIN(v49) as v49, MIN(v50) as v50, MIN(v51) as v51, MIN(v52) as v52 from aggJoin4403371615199426439;
select sum(v49+v50+v51+v52) from res;