create or replace view aggView1433306976368044225 as select id as v28, name as v51 from name as n where gender= 'm';
create or replace view aggJoin3355621549951101952 as select movie_id as v37, note as v5, v51 from cast_info as ci, aggView1433306976368044225 where ci.person_id=aggView1433306976368044225.v28 and note IN ('(writer)','(head writer)','(written by)','(story)','(story editor)');
create or replace view aggView7519248194672410879 as select id as v10 from info_type as it2 where info= 'votes';
create or replace view aggJoin6817863444522301913 as select movie_id as v37, info as v23 from movie_info_idx as mi_idx, aggView7519248194672410879 where mi_idx.info_type_id=aggView7519248194672410879.v10;
create or replace view aggView2341268653911550452 as select v37, MIN(v23) as v50 from aggJoin6817863444522301913 group by v37;
create or replace view aggJoin5267993859665761704 as select v37, v5, v51 as v51, v50 from aggJoin3355621549951101952 join aggView2341268653911550452 using(v37);
create or replace view aggView2499538261348196614 as select v37, MIN(v51) as v51, MIN(v50) as v50 from aggJoin5267993859665761704 group by v37;
create or replace view aggJoin6740456613397755035 as select id as v37, title as v38, v51, v50 from title as t, aggView2499538261348196614 where t.id=aggView2499538261348196614.v37;
create or replace view aggView250865924321284864 as select v37, MIN(v51) as v51, MIN(v50) as v50, MIN(v38) as v52 from aggJoin6740456613397755035 group by v37;
create or replace view aggJoin7437524927451660566 as select movie_id as v37, keyword_id as v12, v51, v50, v52 from movie_keyword as mk, aggView250865924321284864 where mk.movie_id=aggView250865924321284864.v37;
create or replace view aggView8336111870921746990 as select id as v12 from keyword as k where keyword IN ('murder','violence','blood','gore','death','female-nudity','hospital');
create or replace view aggJoin3330949879957179973 as select v37, v51, v50, v52 from aggJoin7437524927451660566 join aggView8336111870921746990 using(v12);
create or replace view aggView2104536455245521708 as select v37, MIN(v51) as v51, MIN(v50) as v50, MIN(v52) as v52 from aggJoin3330949879957179973 group by v37;
create or replace view aggJoin6530342784443587136 as select info_type_id as v8, info as v18, v51, v50, v52 from movie_info as mi, aggView2104536455245521708 where mi.movie_id=aggView2104536455245521708.v37 and info IN ('Horror','Action','Sci-Fi','Thriller','Crime','War');
create or replace view aggView4534013104699635037 as select id as v8 from info_type as it1 where info= 'genres';
create or replace view aggJoin7776432777390139616 as select v18, v51, v50, v52 from aggJoin6530342784443587136 join aggView4534013104699635037 using(v8);
create or replace view res as select MIN(v18) as v49, MIN(v50) as v50, MIN(v51) as v51, MIN(v52) as v52 from aggJoin7776432777390139616;
select sum(v49+v50+v51+v52) from res;