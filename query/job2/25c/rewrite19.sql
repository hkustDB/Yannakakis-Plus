create or replace view aggView3504567197250747227 as select id as v28, name as v51 from name as n where gender= 'm';
create or replace view aggJoin711650954806550813 as select movie_id as v37, note as v5, v51 from cast_info as ci, aggView3504567197250747227 where ci.person_id=aggView3504567197250747227.v28 and note IN ('(writer)','(head writer)','(written by)','(story)','(story editor)');
create or replace view aggView7041202087840091291 as select id as v10 from info_type as it2 where info= 'votes';
create or replace view aggJoin7380926084376411347 as select movie_id as v37, info as v23 from movie_info_idx as mi_idx, aggView7041202087840091291 where mi_idx.info_type_id=aggView7041202087840091291.v10;
create or replace view aggView9139750916147951198 as select v37, MIN(v51) as v51 from aggJoin711650954806550813 group by v37;
create or replace view aggJoin2515667421305686735 as select id as v37, title as v38, v51 from title as t, aggView9139750916147951198 where t.id=aggView9139750916147951198.v37;
create or replace view aggView8087999418055326304 as select v37, MIN(v51) as v51, MIN(v38) as v52 from aggJoin2515667421305686735 group by v37;
create or replace view aggJoin2716711642986376257 as select movie_id as v37, keyword_id as v12, v51, v52 from movie_keyword as mk, aggView8087999418055326304 where mk.movie_id=aggView8087999418055326304.v37;
create or replace view aggView3231134331231216549 as select id as v12 from keyword as k where keyword IN ('murder','violence','blood','gore','death','female-nudity','hospital');
create or replace view aggJoin5809263515488186873 as select v37, v51, v52 from aggJoin2716711642986376257 join aggView3231134331231216549 using(v12);
create or replace view aggView3972566538271767688 as select v37, MIN(v51) as v51, MIN(v52) as v52 from aggJoin5809263515488186873 group by v37;
create or replace view aggJoin7110624170328633583 as select v37, v23, v51, v52 from aggJoin7380926084376411347 join aggView3972566538271767688 using(v37);
create or replace view aggView4871698321989517280 as select v37, MIN(v51) as v51, MIN(v52) as v52, MIN(v23) as v50 from aggJoin7110624170328633583 group by v37;
create or replace view aggJoin6299609371357879676 as select info_type_id as v8, info as v18, v51, v52, v50 from movie_info as mi, aggView4871698321989517280 where mi.movie_id=aggView4871698321989517280.v37 and info IN ('Horror','Action','Sci-Fi','Thriller','Crime','War');
create or replace view aggView5369958705683713758 as select v8, MIN(v51) as v51, MIN(v52) as v52, MIN(v50) as v50, MIN(v18) as v49 from aggJoin6299609371357879676 group by v8;
create or replace view aggJoin8275313216338648001 as select info as v9, v51, v52, v50, v49 from info_type as it1, aggView5369958705683713758 where it1.id=aggView5369958705683713758.v8 and info= 'genres';
create or replace view res as select MIN(v49) as v49, MIN(v50) as v50, MIN(v51) as v51, MIN(v52) as v52 from aggJoin8275313216338648001;
select sum(v49+v50+v51+v52) from res;