create or replace view aggView7042827835613406223 as select id as v1, name as v2 from company_name as cn where country_code<> '[us]';
create or replace view aggView8046317549752854738 as select id as v12 from info_type as it2 where info= 'rating';
create or replace view aggJoin322763179867502184 as select movie_id as v37, info as v32 from movie_info_idx as mi_idx, aggView8046317549752854738 where mi_idx.info_type_id=aggView8046317549752854738.v12;
create or replace view aggView8210832438268392417 as select v37, v32 from aggJoin322763179867502184;
create or replace view aggJoin6592648728824811454 as select v37, v32 from aggView8210832438268392417 where v32<'7.0';
create or replace view aggView4023156673558572552 as select id as v17 from kind_type as kt where kind IN ('movie','episode');
create or replace view aggJoin1668032264990963123 as select id as v37, title as v38, production_year as v41 from title as t, aggView4023156673558572552 where t.kind_id=aggView4023156673558572552.v17 and production_year>2008;
create or replace view aggView6659510303647035885 as select v37, v38 from aggJoin1668032264990963123;
create or replace view aggView5985895575687733000 as select v37, MIN(v32) as v50 from aggJoin6592648728824811454 group by v37;
create or replace view aggJoin5556602505589211642 as select v37, v38, v50 from aggView6659510303647035885 join aggView5985895575687733000 using(v37);
create or replace view aggView8169246228472071475 as select v37, MIN(v50) as v50, MIN(v38) as v51 from aggJoin5556602505589211642 group by v37;
create or replace view aggJoin5295448817823492310 as select movie_id as v37, company_id as v1, company_type_id as v8, note as v23, v50, v51 from movie_companies as mc, aggView8169246228472071475 where mc.movie_id=aggView8169246228472071475.v37 and note NOT LIKE '%(USA)%' and note LIKE '%(200%)%';
create or replace view aggView2868602357697066497 as select id as v10 from info_type as it1 where info= 'countries';
create or replace view aggJoin7801267078248965508 as select movie_id as v37, info as v27 from movie_info as mi, aggView2868602357697066497 where mi.info_type_id=aggView2868602357697066497.v10 and info IN ('Germany','German','USA','American');
create or replace view aggView8985983981950196447 as select id as v14 from keyword as k where keyword IN ('murder','murder-in-title','blood','violence');
create or replace view aggJoin3735741558836925705 as select movie_id as v37 from movie_keyword as mk, aggView8985983981950196447 where mk.keyword_id=aggView8985983981950196447.v14;
create or replace view aggView4756653016192815758 as select v37 from aggJoin7801267078248965508 group by v37;
create or replace view aggJoin848119077307526579 as select v37 from aggJoin3735741558836925705 join aggView4756653016192815758 using(v37);
create or replace view aggView747985434839649624 as select id as v8 from company_type as ct;
create or replace view aggJoin8112827645013486016 as select v37, v1, v23, v50, v51 from aggJoin5295448817823492310 join aggView747985434839649624 using(v8);
create or replace view aggView7314906232900867150 as select v37 from aggJoin848119077307526579 group by v37;
create or replace view aggJoin7905369693641089704 as select v1, v23, v50 as v50, v51 as v51 from aggJoin8112827645013486016 join aggView7314906232900867150 using(v37);
create or replace view aggView1366252572983466217 as select v1, MIN(v50) as v50, MIN(v51) as v51 from aggJoin7905369693641089704 group by v1;
create or replace view aggJoin7778379914397924396 as select v2, v50, v51 from aggView7042827835613406223 join aggView1366252572983466217 using(v1);
select MIN(v2) as v49,MIN(v50) as v50,MIN(v51) as v51 from aggJoin7778379914397924396;
