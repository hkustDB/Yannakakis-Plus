create or replace view aggView5092404929512653926 as select id as v1, name as v49 from company_name as cn where country_code<> '[us]';
create or replace view aggJoin1013835514798920051 as select movie_id as v37, company_type_id as v8, note as v23, v49 from movie_companies as mc, aggView5092404929512653926 where mc.company_id=aggView5092404929512653926.v1 and note NOT LIKE '%(USA)%' and note LIKE '%(200%)%';
create or replace view aggView5130599788170127711 as select id as v10 from info_type as it1 where info= 'countries';
create or replace view aggJoin8126779941913815331 as select movie_id as v37, info as v27 from movie_info as mi, aggView5130599788170127711 where mi.info_type_id=aggView5130599788170127711.v10 and info IN ('Germany','German','USA','American');
create or replace view aggView6576868616005245140 as select id as v14 from keyword as k where keyword IN ('murder','murder-in-title','blood','violence');
create or replace view aggJoin3183491473869088001 as select movie_id as v37 from movie_keyword as mk, aggView6576868616005245140 where mk.keyword_id=aggView6576868616005245140.v14;
create or replace view aggView6487620866123553719 as select id as v8 from company_type as ct;
create or replace view aggJoin7376235972222431658 as select v37, v23, v49 from aggJoin1013835514798920051 join aggView6487620866123553719 using(v8);
create or replace view aggView4132779246345478942 as select id as v12 from info_type as it2 where info= 'rating';
create or replace view aggJoin4286321297308184199 as select movie_id as v37, info as v32 from movie_info_idx as mi_idx, aggView4132779246345478942 where mi_idx.info_type_id=aggView4132779246345478942.v12 and info<'7.0';
create or replace view aggView8849991345053187576 as select v37, MIN(v32) as v50 from aggJoin4286321297308184199 group by v37;
create or replace view aggJoin1385923594715771427 as select v37, v23, v49 as v49, v50 from aggJoin7376235972222431658 join aggView8849991345053187576 using(v37);
create or replace view aggView2821506362920272934 as select id as v17 from kind_type as kt where kind IN ('movie','episode');
create or replace view aggJoin2378693305854309529 as select id as v37, title as v38, production_year as v41 from title as t, aggView2821506362920272934 where t.kind_id=aggView2821506362920272934.v17 and production_year>2008;
create or replace view aggView7191084105575420676 as select v37, MIN(v38) as v51 from aggJoin2378693305854309529 group by v37;
create or replace view aggJoin3415165906341025509 as select v37, v23, v49 as v49, v50 as v50, v51 from aggJoin1385923594715771427 join aggView7191084105575420676 using(v37);
create or replace view aggView5495372686096188817 as select v37, MIN(v49) as v49, MIN(v50) as v50, MIN(v51) as v51 from aggJoin3415165906341025509 group by v37;
create or replace view aggJoin7427163900730110036 as select v37, v27, v49, v50, v51 from aggJoin8126779941913815331 join aggView5495372686096188817 using(v37);
create or replace view aggView5939038388439083751 as select v37, MIN(v49) as v49, MIN(v50) as v50, MIN(v51) as v51 from aggJoin7427163900730110036 group by v37;
create or replace view aggJoin1177402258814297453 as select v49, v50, v51 from aggJoin3183491473869088001 join aggView5939038388439083751 using(v37);
select MIN(v49) as v49,MIN(v50) as v50,MIN(v51) as v51 from aggJoin1177402258814297453;
