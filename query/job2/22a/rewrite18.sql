create or replace view aggView2314835587008858740 as select id as v1, name as v49 from company_name as cn where country_code<> '[us]';
create or replace view aggJoin7413687451617479961 as select movie_id as v37, company_type_id as v8, note as v23, v49 from movie_companies as mc, aggView2314835587008858740 where mc.company_id=aggView2314835587008858740.v1 and note NOT LIKE '%(USA)%' and note LIKE '%(200%)%';
create or replace view aggView8409200418020059625 as select id as v10 from info_type as it1 where info= 'countries';
create or replace view aggJoin6236209569377404623 as select movie_id as v37, info as v27 from movie_info as mi, aggView8409200418020059625 where mi.info_type_id=aggView8409200418020059625.v10 and info IN ('Germany','German','USA','American');
create or replace view aggView8333675159491136043 as select v37 from aggJoin6236209569377404623 group by v37;
create or replace view aggJoin5924363723183499959 as select v37, v8, v23, v49 as v49 from aggJoin7413687451617479961 join aggView8333675159491136043 using(v37);
create or replace view aggView9091452604525325437 as select id as v14 from keyword as k where keyword IN ('murder','murder-in-title','blood','violence');
create or replace view aggJoin9028326151348567389 as select movie_id as v37 from movie_keyword as mk, aggView9091452604525325437 where mk.keyword_id=aggView9091452604525325437.v14;
create or replace view aggView2800634243551525059 as select id as v8 from company_type as ct;
create or replace view aggJoin2929989788722098743 as select v37, v23, v49 from aggJoin5924363723183499959 join aggView2800634243551525059 using(v8);
create or replace view aggView3846827921113199919 as select id as v17 from kind_type as kt where kind IN ('movie','episode');
create or replace view aggJoin3153182564647605940 as select id as v37, title as v38, production_year as v41 from title as t, aggView3846827921113199919 where t.kind_id=aggView3846827921113199919.v17 and production_year>2008;
create or replace view aggView6916995612187833186 as select v37, MIN(v38) as v51 from aggJoin3153182564647605940 group by v37;
create or replace view aggJoin4886191500191194168 as select v37, v23, v49 as v49, v51 from aggJoin2929989788722098743 join aggView6916995612187833186 using(v37);
create or replace view aggView4585356916897355257 as select v37, MIN(v49) as v49, MIN(v51) as v51 from aggJoin4886191500191194168 group by v37;
create or replace view aggJoin6645811523505296740 as select v37, v49, v51 from aggJoin9028326151348567389 join aggView4585356916897355257 using(v37);
create or replace view aggView5529117080696465125 as select id as v12 from info_type as it2 where info= 'rating';
create or replace view aggJoin5712933404470440608 as select movie_id as v37, info as v32 from movie_info_idx as mi_idx, aggView5529117080696465125 where mi_idx.info_type_id=aggView5529117080696465125.v12 and info<'7.0';
create or replace view aggView4189234117654033877 as select v37, MIN(v32) as v50 from aggJoin5712933404470440608 group by v37;
create or replace view aggJoin4185694576856997215 as select v49 as v49, v51 as v51, v50 from aggJoin6645811523505296740 join aggView4189234117654033877 using(v37);
select MIN(v49) as v49,MIN(v50) as v50,MIN(v51) as v51 from aggJoin4185694576856997215;
