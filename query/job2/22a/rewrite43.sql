create or replace view aggView2284384179582126671 as select id as v1, name as v49 from company_name as cn where country_code<> '[us]';
create or replace view aggJoin82575178650609316 as select movie_id as v37, company_type_id as v8, note as v23, v49 from movie_companies as mc, aggView2284384179582126671 where mc.company_id=aggView2284384179582126671.v1 and note NOT LIKE '%(USA)%' and note LIKE '%(200%)%';
create or replace view aggView6186058708407400811 as select id as v14 from keyword as k where keyword IN ('murder','murder-in-title','blood','violence');
create or replace view aggJoin5297203669695745262 as select movie_id as v37 from movie_keyword as mk, aggView6186058708407400811 where mk.keyword_id=aggView6186058708407400811.v14;
create or replace view aggView8904452514732539603 as select id as v10 from info_type as it1 where info= 'countries';
create or replace view aggJoin5245197971024519336 as select movie_id as v37, info as v27 from movie_info as mi, aggView8904452514732539603 where mi.info_type_id=aggView8904452514732539603.v10 and info IN ('Germany','German','USA','American');
create or replace view aggView3919301852768660851 as select id as v12 from info_type as it2 where info= 'rating';
create or replace view aggJoin4681944480824530099 as select movie_id as v37, info as v32 from movie_info_idx as mi_idx, aggView3919301852768660851 where mi_idx.info_type_id=aggView3919301852768660851.v12 and info<'7.0';
create or replace view aggView8729258093248391044 as select v37 from aggJoin5245197971024519336 group by v37;
create or replace view aggJoin8078077828881823784 as select v37, v32 from aggJoin4681944480824530099 join aggView8729258093248391044 using(v37);
create or replace view aggView5985535711621275780 as select v37, MIN(v32) as v50 from aggJoin8078077828881823784 group by v37;
create or replace view aggJoin8516332125656408297 as select v37, v50 from aggJoin5297203669695745262 join aggView5985535711621275780 using(v37);
create or replace view aggView1203542805184192710 as select v37, MIN(v50) as v50 from aggJoin8516332125656408297 group by v37;
create or replace view aggJoin706970525907679450 as select id as v37, title as v38, kind_id as v17, v50 from title as t, aggView1203542805184192710 where t.id=aggView1203542805184192710.v37 and production_year>2008;
create or replace view aggView6806280709034435106 as select id as v8 from company_type as ct;
create or replace view aggJoin7710180401435336473 as select v37, v49 from aggJoin82575178650609316 join aggView6806280709034435106 using(v8);
create or replace view aggView62447742053193431 as select v37, MIN(v49) as v49 from aggJoin7710180401435336473 group by v37;
create or replace view aggJoin2934759758257841138 as select v38, v17, v50 as v50, v49 from aggJoin706970525907679450 join aggView62447742053193431 using(v37);
create or replace view aggView4963840910211551169 as select v17, MIN(v50) as v50, MIN(v49) as v49, MIN(v38) as v51 from aggJoin2934759758257841138 group by v17;
create or replace view aggJoin4041017495544210026 as select v50, v49, v51 from kind_type as kt, aggView4963840910211551169 where kt.id=aggView4963840910211551169.v17 and kind IN ('movie','episode');
create or replace view res as select MIN(v49) as v49, MIN(v50) as v50, MIN(v51) as v51 from aggJoin4041017495544210026;
select sum(v49+v50+v51) from res;