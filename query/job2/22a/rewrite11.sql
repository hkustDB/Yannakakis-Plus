create or replace view aggView8294444796605161980 as select id as v1, name as v49 from company_name as cn where country_code<> '[us]';
create or replace view aggJoin3144832778251982986 as select movie_id as v37, company_type_id as v8, note as v23, v49 from movie_companies as mc, aggView8294444796605161980 where mc.company_id=aggView8294444796605161980.v1 and note NOT LIKE '%(USA)%' and note LIKE '%(200%)%';
create or replace view aggView6953847661384989270 as select id as v14 from keyword as k where keyword IN ('murder','murder-in-title','blood','violence');
create or replace view aggJoin3933844220427680854 as select movie_id as v37 from movie_keyword as mk, aggView6953847661384989270 where mk.keyword_id=aggView6953847661384989270.v14;
create or replace view aggView8355168164323221307 as select id as v10 from info_type as it1 where info= 'countries';
create or replace view aggJoin9009708685553725181 as select movie_id as v37, info as v27 from movie_info as mi, aggView8355168164323221307 where mi.info_type_id=aggView8355168164323221307.v10 and info IN ('Germany','German','USA','American');
create or replace view aggView7579385526556986545 as select v37 from aggJoin3933844220427680854 group by v37;
create or replace view aggJoin3988311606164409781 as select movie_id as v37, info_type_id as v12, info as v32 from movie_info_idx as mi_idx, aggView7579385526556986545 where mi_idx.movie_id=aggView7579385526556986545.v37 and info<'7.0';
create or replace view aggView8673388996581097382 as select id as v17 from kind_type as kt where kind IN ('movie','episode');
create or replace view aggJoin5793847595479064932 as select id as v37, title as v38 from title as t, aggView8673388996581097382 where t.kind_id=aggView8673388996581097382.v17 and production_year>2008;
create or replace view aggView642700767988033601 as select id as v12 from info_type as it2 where info= 'rating';
create or replace view aggJoin1371988969971797520 as select v37, v32 from aggJoin3988311606164409781 join aggView642700767988033601 using(v12);
create or replace view aggView1366817766645896096 as select v37, MIN(v32) as v50 from aggJoin1371988969971797520 group by v37;
create or replace view aggJoin4100651674982076011 as select v37, v38, v50 from aggJoin5793847595479064932 join aggView1366817766645896096 using(v37);
create or replace view aggView438739892514442904 as select v37, MIN(v50) as v50, MIN(v38) as v51 from aggJoin4100651674982076011 group by v37;
create or replace view aggJoin3347882412690461397 as select v37, v50, v51 from aggJoin9009708685553725181 join aggView438739892514442904 using(v37);
create or replace view aggView5740947785726707166 as select v37, MIN(v50) as v50, MIN(v51) as v51 from aggJoin3347882412690461397 group by v37;
create or replace view aggJoin7426230563732889002 as select v8, v49 as v49, v50, v51 from aggJoin3144832778251982986 join aggView5740947785726707166 using(v37);
create or replace view aggView4553673688697523940 as select v8, MIN(v49) as v49, MIN(v50) as v50, MIN(v51) as v51 from aggJoin7426230563732889002 group by v8;
create or replace view aggJoin79477060244350768 as select v49, v50, v51 from company_type as ct, aggView4553673688697523940 where ct.id=aggView4553673688697523940.v8;
create or replace view res as select MIN(v49) as v49, MIN(v50) as v50, MIN(v51) as v51 from aggJoin79477060244350768;
select sum(v49+v50+v51) from res;