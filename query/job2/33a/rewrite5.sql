create or replace view aggView5288490410285484887 as select id as v8, name as v74 from company_name as cn2;
create or replace view aggJoin7536891373921877424 as select movie_id as v61, v74 from movie_companies as mc2, aggView5288490410285484887 where mc2.company_id=aggView5288490410285484887.v8;
create or replace view aggView6649127293697271881 as select id as v1, name as v73 from company_name as cn1 where country_code= '[us]';
create or replace view aggJoin5212692168812876721 as select movie_id as v49, v73 from movie_companies as mc1, aggView6649127293697271881 where mc1.company_id=aggView6649127293697271881.v1;
create or replace view aggView6232743581116356145 as select id as v19 from kind_type as kt1 where kind= 'tv series';
create or replace view aggJoin2376428195539084872 as select id as v49, title as v50 from title as t1, aggView6232743581116356145 where t1.kind_id=aggView6232743581116356145.v19;
create or replace view aggView7656203216783519781 as select v49, MIN(v50) as v77 from aggJoin2376428195539084872 group by v49;
create or replace view aggJoin2543492049099771341 as select movie_id as v49, info_type_id as v15, info as v38, v77 from movie_info_idx as mi_idx1, aggView7656203216783519781 where mi_idx1.movie_id=aggView7656203216783519781.v49;
create or replace view aggView7417365746453190830 as select id as v17 from info_type as it2 where info= 'rating';
create or replace view aggJoin2032030018258811762 as select movie_id as v61, info as v43 from movie_info_idx as mi_idx2, aggView7417365746453190830 where mi_idx2.info_type_id=aggView7417365746453190830.v17 and info<'3.0';
create or replace view aggView3093056454768145668 as select id as v23 from link_type as lt where link IN ('sequel','follows','followed by');
create or replace view aggJoin7362067447575930353 as select movie_id as v49, linked_movie_id as v61 from movie_link as ml, aggView3093056454768145668 where ml.link_type_id=aggView3093056454768145668.v23;
create or replace view aggView5698641781063577384 as select id as v15 from info_type as it1 where info= 'rating';
create or replace view aggJoin5102155085234096160 as select v49, v38, v77 from aggJoin2543492049099771341 join aggView5698641781063577384 using(v15);
create or replace view aggView4501816123190572882 as select v49, MIN(v77) as v77, MIN(v38) as v75 from aggJoin5102155085234096160 group by v49;
create or replace view aggJoin4450439872303335473 as select v49, v73 as v73, v77, v75 from aggJoin5212692168812876721 join aggView4501816123190572882 using(v49);
create or replace view aggView1893476164596813734 as select v49, MIN(v73) as v73, MIN(v77) as v77, MIN(v75) as v75 from aggJoin4450439872303335473 group by v49;
create or replace view aggJoin6859123638342145892 as select v61, v73, v77, v75 from aggJoin7362067447575930353 join aggView1893476164596813734 using(v49);
create or replace view aggView901192479456524405 as select v61, MIN(v73) as v73, MIN(v77) as v77, MIN(v75) as v75 from aggJoin6859123638342145892 group by v61;
create or replace view aggJoin2771432257976097875 as select v61, v43, v73, v77, v75 from aggJoin2032030018258811762 join aggView901192479456524405 using(v61);
create or replace view aggView3200623849893930208 as select v61, MIN(v73) as v73, MIN(v77) as v77, MIN(v75) as v75, MIN(v43) as v76 from aggJoin2771432257976097875 group by v61;
create or replace view aggJoin4962414232376158787 as select v61, v74 as v74, v73, v77, v75, v76 from aggJoin7536891373921877424 join aggView3200623849893930208 using(v61);
create or replace view aggView6856865106832669861 as select v61, MIN(v74) as v74, MIN(v73) as v73, MIN(v77) as v77, MIN(v75) as v75, MIN(v76) as v76 from aggJoin4962414232376158787 group by v61;
create or replace view aggJoin4196030880912960521 as select title as v62, kind_id as v21, v74, v73, v77, v75, v76 from title as t2, aggView6856865106832669861 where t2.id=aggView6856865106832669861.v61 and production_year<=2008 and production_year>=2005;
create or replace view aggView7870157512598152475 as select v21, MIN(v74) as v74, MIN(v73) as v73, MIN(v77) as v77, MIN(v75) as v75, MIN(v76) as v76, MIN(v62) as v78 from aggJoin4196030880912960521 group by v21;
create or replace view aggJoin8485804340298753023 as select v74, v73, v77, v75, v76, v78 from kind_type as kt2, aggView7870157512598152475 where kt2.id=aggView7870157512598152475.v21 and kind= 'tv series';
create or replace view res as select MIN(v73) as v73, MIN(v74) as v74, MIN(v75) as v75, MIN(v76) as v76, MIN(v77) as v77, MIN(v78) as v78 from aggJoin8485804340298753023;
select sum(v73+v74+v75+v76+v77+v78) from res;