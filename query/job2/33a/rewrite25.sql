create or replace view aggView5893866533292514980 as select id as v8, name as v74 from company_name as cn2;
create or replace view aggJoin7503149412281181228 as select movie_id as v61, v74 from movie_companies as mc2, aggView5893866533292514980 where mc2.company_id=aggView5893866533292514980.v8;
create or replace view aggView792138699366919062 as select id as v1, name as v73 from company_name as cn1 where country_code= '[us]';
create or replace view aggJoin3771142210577315572 as select movie_id as v49, v73 from movie_companies as mc1, aggView792138699366919062 where mc1.company_id=aggView792138699366919062.v1;
create or replace view aggView6702205474343664657 as select id as v17 from info_type as it2 where info= 'rating';
create or replace view aggJoin4677609254375440484 as select movie_id as v61, info as v43 from movie_info_idx as mi_idx2, aggView6702205474343664657 where mi_idx2.info_type_id=aggView6702205474343664657.v17 and info<'3.0';
create or replace view aggView339573166799342801 as select id as v23 from link_type as lt where link IN ('sequel','follows','followed by');
create or replace view aggJoin8263634296081341917 as select movie_id as v49, linked_movie_id as v61 from movie_link as ml, aggView339573166799342801 where ml.link_type_id=aggView339573166799342801.v23;
create or replace view aggView3465370792008066362 as select v61, MIN(v74) as v74 from aggJoin7503149412281181228 group by v61;
create or replace view aggJoin7874231733076003955 as select id as v61, title as v62, kind_id as v21, v74 from title as t2, aggView3465370792008066362 where t2.id=aggView3465370792008066362.v61 and production_year<=2008 and production_year>=2005;
create or replace view aggView895402605748310295 as select id as v15 from info_type as it1 where info= 'rating';
create or replace view aggJoin1137746195545686120 as select movie_id as v49, info as v38 from movie_info_idx as mi_idx1, aggView895402605748310295 where mi_idx1.info_type_id=aggView895402605748310295.v15;
create or replace view aggView7458496695575427780 as select v49, MIN(v73) as v73 from aggJoin3771142210577315572 group by v49;
create or replace view aggJoin1478147228230648994 as select v49, v38, v73 from aggJoin1137746195545686120 join aggView7458496695575427780 using(v49);
create or replace view aggView3337295681824375368 as select v49, MIN(v73) as v73, MIN(v38) as v75 from aggJoin1478147228230648994 group by v49;
create or replace view aggJoin7476932734136521208 as select id as v49, title as v50, kind_id as v19, v73, v75 from title as t1, aggView3337295681824375368 where t1.id=aggView3337295681824375368.v49;
create or replace view aggView6149597333392951837 as select id as v21 from kind_type as kt2 where kind= 'tv series';
create or replace view aggJoin8008808118133380043 as select v61, v62, v74 from aggJoin7874231733076003955 join aggView6149597333392951837 using(v21);
create or replace view aggView8731195547800698615 as select v61, MIN(v74) as v74, MIN(v62) as v78 from aggJoin8008808118133380043 group by v61;
create or replace view aggJoin8630730173501882198 as select v61, v43, v74, v78 from aggJoin4677609254375440484 join aggView8731195547800698615 using(v61);
create or replace view aggView706342562996968983 as select v61, MIN(v74) as v74, MIN(v78) as v78, MIN(v43) as v76 from aggJoin8630730173501882198 group by v61;
create or replace view aggJoin9185478881765529196 as select v49, v74, v78, v76 from aggJoin8263634296081341917 join aggView706342562996968983 using(v61);
create or replace view aggView3530606278549005484 as select v49, MIN(v74) as v74, MIN(v78) as v78, MIN(v76) as v76 from aggJoin9185478881765529196 group by v49;
create or replace view aggJoin854063194418216132 as select v50, v19, v73 as v73, v75 as v75, v74, v78, v76 from aggJoin7476932734136521208 join aggView3530606278549005484 using(v49);
create or replace view aggView8926900441677763642 as select v19, MIN(v73) as v73, MIN(v75) as v75, MIN(v74) as v74, MIN(v78) as v78, MIN(v76) as v76, MIN(v50) as v77 from aggJoin854063194418216132 group by v19;
create or replace view aggJoin2496515768431000925 as select v73, v75, v74, v78, v76, v77 from kind_type as kt1, aggView8926900441677763642 where kt1.id=aggView8926900441677763642.v19 and kind= 'tv series';
create or replace view res as select MIN(v73) as v73, MIN(v74) as v74, MIN(v75) as v75, MIN(v76) as v76, MIN(v77) as v77, MIN(v78) as v78 from aggJoin2496515768431000925;
select sum(v73+v74+v75+v76+v77+v78) from res;