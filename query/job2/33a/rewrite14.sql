create or replace view aggView322522533705097115 as select id as v1, name as v2 from company_name as cn1 where country_code= '[us]';
create or replace view aggView524177600750861358 as select id as v8, name as v9 from company_name as cn2;
create or replace view aggView4235887090395758247 as select id as v21 from kind_type as kt2 where kind= 'tv series';
create or replace view aggJoin2489398926667666327 as select id as v61, title as v62, production_year as v65 from title as t2, aggView4235887090395758247 where t2.kind_id=aggView4235887090395758247.v21 and production_year<=2008 and production_year>=2005;
create or replace view aggView99926165153632035 as select v62, v61 from aggJoin2489398926667666327;
create or replace view aggView2243172954276864046 as select id as v19 from kind_type as kt1 where kind= 'tv series';
create or replace view aggJoin7488176188652773271 as select id as v49, title as v50 from title as t1, aggView2243172954276864046 where t1.kind_id=aggView2243172954276864046.v19;
create or replace view aggView9078543956792640032 as select v49, v50 from aggJoin7488176188652773271;
create or replace view aggView4197812917970272153 as select id as v15 from info_type as it1 where info= 'rating';
create or replace view aggJoin3255773685097667149 as select movie_id as v49, info as v38 from movie_info_idx as mi_idx1, aggView4197812917970272153 where mi_idx1.info_type_id=aggView4197812917970272153.v15;
create or replace view aggView2446063662144192363 as select v38, v49 from aggJoin3255773685097667149;
create or replace view aggView6910503362423379046 as select id as v17 from info_type as it2 where info= 'rating';
create or replace view aggJoin486375944561469816 as select movie_id as v61, info as v43 from movie_info_idx as mi_idx2, aggView6910503362423379046 where mi_idx2.info_type_id=aggView6910503362423379046.v17;
create or replace view aggView3903607433142127271 as select v43, v61 from aggJoin486375944561469816;
create or replace view aggJoin3340097441045572195 as select v61, v43 from aggView3903607433142127271 where v43<'3.0';
create or replace view aggView5562283548302306055 as select v8, MIN(v9) as v74 from aggView524177600750861358 group by v8;
create or replace view aggJoin4504896815206767037 as select movie_id as v61, v74 from movie_companies as mc2, aggView5562283548302306055 where mc2.company_id=aggView5562283548302306055.v8;
create or replace view aggView3459081344577558948 as select v49, MIN(v50) as v77 from aggView9078543956792640032 group by v49;
create or replace view aggJoin6420403336696981423 as select v38, v49, v77 from aggView2446063662144192363 join aggView3459081344577558948 using(v49);
create or replace view aggView3418358998563858827 as select v61, MIN(v43) as v76 from aggJoin3340097441045572195 group by v61;
create or replace view aggJoin4508305030561141490 as select v62, v61, v76 from aggView99926165153632035 join aggView3418358998563858827 using(v61);
create or replace view aggView8136236937158363074 as select v61, MIN(v76) as v76, MIN(v62) as v78 from aggJoin4508305030561141490 group by v61;
create or replace view aggJoin2711881764549376034 as select movie_id as v49, linked_movie_id as v61, link_type_id as v23, v76, v78 from movie_link as ml, aggView8136236937158363074 where ml.linked_movie_id=aggView8136236937158363074.v61;
create or replace view aggView4248962126217761360 as select v49, MIN(v77) as v77, MIN(v38) as v75 from aggJoin6420403336696981423 group by v49;
create or replace view aggJoin6175911320177480543 as select v49, v61, v23, v76 as v76, v78 as v78, v77, v75 from aggJoin2711881764549376034 join aggView4248962126217761360 using(v49);
create or replace view aggView8904909238454677715 as select v61, MIN(v74) as v74 from aggJoin4504896815206767037 group by v61;
create or replace view aggJoin1567497629438081151 as select v49, v23, v76 as v76, v78 as v78, v77 as v77, v75 as v75, v74 from aggJoin6175911320177480543 join aggView8904909238454677715 using(v61);
create or replace view aggView906391341855524865 as select id as v23 from link_type as lt where link IN ('sequel','follows','followed by');
create or replace view aggJoin6127397520026083179 as select v49, v76, v78, v77, v75, v74 from aggJoin1567497629438081151 join aggView906391341855524865 using(v23);
create or replace view aggView8507446304234572878 as select v49, MIN(v76) as v76, MIN(v78) as v78, MIN(v77) as v77, MIN(v75) as v75, MIN(v74) as v74 from aggJoin6127397520026083179 group by v49;
create or replace view aggJoin3392504960973489988 as select company_id as v1, v76, v78, v77, v75, v74 from movie_companies as mc1, aggView8507446304234572878 where mc1.movie_id=aggView8507446304234572878.v49;
create or replace view aggView601018791515181451 as select v1, MIN(v76) as v76, MIN(v78) as v78, MIN(v77) as v77, MIN(v75) as v75, MIN(v74) as v74 from aggJoin3392504960973489988 group by v1;
create or replace view aggJoin6559767641441748216 as select v2, v76, v78, v77, v75, v74 from aggView322522533705097115 join aggView601018791515181451 using(v1);
select MIN(v2) as v73,MIN(v74) as v74,MIN(v75) as v75,MIN(v76) as v76,MIN(v77) as v77,MIN(v78) as v78 from aggJoin6559767641441748216;
