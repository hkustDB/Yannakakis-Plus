create or replace view aggView7425373742317131032 as select id as v1, name as v73 from company_name as cn1 where country_code<> '[us]';
create or replace view aggJoin2307487373590424345 as select movie_id as v49, v73 from movie_companies as mc1, aggView7425373742317131032 where mc1.company_id=aggView7425373742317131032.v1;
create or replace view aggView5918517515097915257 as select id as v8, name as v74 from company_name as cn2;
create or replace view aggJoin4111279613325112594 as select movie_id as v61, v74 from movie_companies as mc2, aggView5918517515097915257 where mc2.company_id=aggView5918517515097915257.v8;
create or replace view aggView6416056374658847229 as select id as v21 from kind_type as kt2 where kind IN ('tv series','episode');
create or replace view aggJoin3532938982238114394 as select id as v61, title as v62 from title as t2, aggView6416056374658847229 where t2.kind_id=aggView6416056374658847229.v21 and production_year>=2000 and production_year<=2010;
create or replace view aggView1712381525461401202 as select v49, MIN(v73) as v73 from aggJoin2307487373590424345 group by v49;
create or replace view aggJoin470597575585008832 as select id as v49, title as v50, kind_id as v19, v73 from title as t1, aggView1712381525461401202 where t1.id=aggView1712381525461401202.v49;
create or replace view aggView1339067146385055599 as select id as v15 from info_type as it1 where info= 'rating';
create or replace view aggJoin7150044288438293682 as select movie_id as v49, info as v38 from movie_info_idx as mi_idx1, aggView1339067146385055599 where mi_idx1.info_type_id=aggView1339067146385055599.v15;
create or replace view aggView3261718317509631635 as select v61, MIN(v74) as v74 from aggJoin4111279613325112594 group by v61;
create or replace view aggJoin5184418841044773902 as select movie_id as v61, info_type_id as v17, info as v43, v74 from movie_info_idx as mi_idx2, aggView3261718317509631635 where mi_idx2.movie_id=aggView3261718317509631635.v61 and info<'3.5';
create or replace view aggView1962219324481556516 as select id as v17 from info_type as it2 where info= 'rating';
create or replace view aggJoin3087770701274682030 as select v61, v43, v74 from aggJoin5184418841044773902 join aggView1962219324481556516 using(v17);
create or replace view aggView3950490543612954028 as select v61, MIN(v74) as v74, MIN(v43) as v76 from aggJoin3087770701274682030 group by v61;
create or replace view aggJoin7967705141242963612 as select v61, v62, v74, v76 from aggJoin3532938982238114394 join aggView3950490543612954028 using(v61);
create or replace view aggView8718958881492798111 as select v61, MIN(v74) as v74, MIN(v76) as v76, MIN(v62) as v78 from aggJoin7967705141242963612 group by v61;
create or replace view aggJoin4351609060193401776 as select movie_id as v49, link_type_id as v23, v74, v76, v78 from movie_link as ml, aggView8718958881492798111 where ml.linked_movie_id=aggView8718958881492798111.v61;
create or replace view aggView5484681491975518233 as select id as v23 from link_type as lt where link IN ('sequel','follows','followed by');
create or replace view aggJoin8095286993487013431 as select v49, v74, v76, v78 from aggJoin4351609060193401776 join aggView5484681491975518233 using(v23);
create or replace view aggView766760000652369838 as select v49, MIN(v74) as v74, MIN(v76) as v76, MIN(v78) as v78 from aggJoin8095286993487013431 group by v49;
create or replace view aggJoin4942136626716071307 as select v49, v38, v74, v76, v78 from aggJoin7150044288438293682 join aggView766760000652369838 using(v49);
create or replace view aggView3885311638691592461 as select v49, MIN(v74) as v74, MIN(v76) as v76, MIN(v78) as v78, MIN(v38) as v75 from aggJoin4942136626716071307 group by v49;
create or replace view aggJoin2504349946818703369 as select v50, v19, v73 as v73, v74, v76, v78, v75 from aggJoin470597575585008832 join aggView3885311638691592461 using(v49);
create or replace view aggView5180022051990201817 as select v19, MIN(v73) as v73, MIN(v74) as v74, MIN(v76) as v76, MIN(v78) as v78, MIN(v75) as v75, MIN(v50) as v77 from aggJoin2504349946818703369 group by v19;
create or replace view aggJoin6712725578430054637 as select v73, v74, v76, v78, v75, v77 from kind_type as kt1, aggView5180022051990201817 where kt1.id=aggView5180022051990201817.v19 and kind IN ('tv series','episode');
create or replace view res as select MIN(v73) as v73, MIN(v74) as v74, MIN(v75) as v75, MIN(v76) as v76, MIN(v77) as v77, MIN(v78) as v78 from aggJoin6712725578430054637;
select sum(v73+v74+v75+v76+v77+v78) from res;