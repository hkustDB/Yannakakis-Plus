create or replace view aggView695850086843632560 as select id as v1, name as v73 from company_name as cn1 where country_code<> '[us]';
create or replace view aggJoin8844834576799839496 as select movie_id as v49, v73 from movie_companies as mc1, aggView695850086843632560 where mc1.company_id=aggView695850086843632560.v1;
create or replace view aggView8583042866047002600 as select id as v8, name as v74 from company_name as cn2;
create or replace view aggJoin1031164761923710168 as select movie_id as v61, v74 from movie_companies as mc2, aggView8583042866047002600 where mc2.company_id=aggView8583042866047002600.v8;
create or replace view aggView6887928753628471479 as select id as v21 from kind_type as kt2 where kind IN ('tv series','episode');
create or replace view aggJoin2287725471672512156 as select id as v61, title as v62 from title as t2, aggView6887928753628471479 where t2.kind_id=aggView6887928753628471479.v21 and production_year>=2000 and production_year<=2010;
create or replace view aggView270807385494461642 as select id as v19 from kind_type as kt1 where kind IN ('tv series','episode');
create or replace view aggJoin8228804324431276390 as select id as v49, title as v50 from title as t1, aggView270807385494461642 where t1.kind_id=aggView270807385494461642.v19;
create or replace view aggView1858206329078187779 as select id as v17 from info_type as it2 where info= 'rating';
create or replace view aggJoin945461066340474504 as select movie_id as v61, info as v43 from movie_info_idx as mi_idx2, aggView1858206329078187779 where mi_idx2.info_type_id=aggView1858206329078187779.v17 and info<'3.5';
create or replace view aggView829651315864173546 as select v61, MIN(v43) as v76 from aggJoin945461066340474504 group by v61;
create or replace view aggJoin6883611994649998526 as select v61, v74 as v74, v76 from aggJoin1031164761923710168 join aggView829651315864173546 using(v61);
create or replace view aggView7213916504782880701 as select v61, MIN(v74) as v74, MIN(v76) as v76 from aggJoin6883611994649998526 group by v61;
create or replace view aggJoin3806060054536592557 as select v61, v62, v74, v76 from aggJoin2287725471672512156 join aggView7213916504782880701 using(v61);
create or replace view aggView8673849882509442106 as select v61, MIN(v74) as v74, MIN(v76) as v76, MIN(v62) as v78 from aggJoin3806060054536592557 group by v61;
create or replace view aggJoin8771007921716005022 as select movie_id as v49, link_type_id as v23, v74, v76, v78 from movie_link as ml, aggView8673849882509442106 where ml.linked_movie_id=aggView8673849882509442106.v61;
create or replace view aggView5900058312640798562 as select id as v23 from link_type as lt where link IN ('sequel','follows','followed by');
create or replace view aggJoin2020107551908056906 as select v49, v74, v76, v78 from aggJoin8771007921716005022 join aggView5900058312640798562 using(v23);
create or replace view aggView2994008709632546314 as select v49, MIN(v74) as v74, MIN(v76) as v76, MIN(v78) as v78 from aggJoin2020107551908056906 group by v49;
create or replace view aggJoin1961495736401195695 as select v49, v50, v74, v76, v78 from aggJoin8228804324431276390 join aggView2994008709632546314 using(v49);
create or replace view aggView600362055193152 as select v49, MIN(v74) as v74, MIN(v76) as v76, MIN(v78) as v78, MIN(v50) as v77 from aggJoin1961495736401195695 group by v49;
create or replace view aggJoin3307247012557178361 as select v49, v73 as v73, v74, v76, v78, v77 from aggJoin8844834576799839496 join aggView600362055193152 using(v49);
create or replace view aggView1780072095155086997 as select v49, MIN(v73) as v73, MIN(v74) as v74, MIN(v76) as v76, MIN(v78) as v78, MIN(v77) as v77 from aggJoin3307247012557178361 group by v49;
create or replace view aggJoin7366414846518318976 as select info_type_id as v15, info as v38, v73, v74, v76, v78, v77 from movie_info_idx as mi_idx1, aggView1780072095155086997 where mi_idx1.movie_id=aggView1780072095155086997.v49;
create or replace view aggView1343758181097933521 as select v15, MIN(v73) as v73, MIN(v74) as v74, MIN(v76) as v76, MIN(v78) as v78, MIN(v77) as v77, MIN(v38) as v75 from aggJoin7366414846518318976 group by v15;
create or replace view aggJoin5186749766690398143 as select v73, v74, v76, v78, v77, v75 from info_type as it1, aggView1343758181097933521 where it1.id=aggView1343758181097933521.v15 and info= 'rating';
create or replace view res as select MIN(v73) as v73, MIN(v74) as v74, MIN(v75) as v75, MIN(v76) as v76, MIN(v77) as v77, MIN(v78) as v78 from aggJoin5186749766690398143;
select sum(v73+v74+v75+v76+v77+v78) from res;