create or replace view aggView7819633836933459525 as select id as v1, name as v73 from company_name as cn1 where country_code<> '[us]';
create or replace view aggJoin1479327300429006990 as select movie_id as v49, v73 from movie_companies as mc1, aggView7819633836933459525 where mc1.company_id=aggView7819633836933459525.v1;
create or replace view aggView6665630178952756923 as select id as v8, name as v74 from company_name as cn2;
create or replace view aggJoin5805491877611164397 as select movie_id as v61, v74 from movie_companies as mc2, aggView6665630178952756923 where mc2.company_id=aggView6665630178952756923.v8;
create or replace view aggView8883083039077851743 as select id as v21 from kind_type as kt2 where kind IN ('tv series','episode');
create or replace view aggJoin7001399245741285504 as select id as v61, title as v62 from title as t2, aggView8883083039077851743 where t2.kind_id=aggView8883083039077851743.v21 and production_year>=2000 and production_year<=2010;
create or replace view aggView3263498658603387343 as select id as v19 from kind_type as kt1 where kind IN ('tv series','episode');
create or replace view aggJoin4987663458116809574 as select id as v49, title as v50 from title as t1, aggView3263498658603387343 where t1.kind_id=aggView3263498658603387343.v19;
create or replace view aggView2569807305183491816 as select v61, MIN(v74) as v74 from aggJoin5805491877611164397 group by v61;
create or replace view aggJoin4048811209924481703 as select v61, v62, v74 from aggJoin7001399245741285504 join aggView2569807305183491816 using(v61);
create or replace view aggView135385858448474322 as select v61, MIN(v74) as v74, MIN(v62) as v78 from aggJoin4048811209924481703 group by v61;
create or replace view aggJoin3018037589539847045 as select movie_id as v61, info_type_id as v17, info as v43, v74, v78 from movie_info_idx as mi_idx2, aggView135385858448474322 where mi_idx2.movie_id=aggView135385858448474322.v61 and info<'3.5';
create or replace view aggView2280632862241642124 as select id as v17 from info_type as it2 where info= 'rating';
create or replace view aggJoin4661958767649004763 as select v61, v43, v74, v78 from aggJoin3018037589539847045 join aggView2280632862241642124 using(v17);
create or replace view aggView8842906237277991203 as select v61, MIN(v74) as v74, MIN(v78) as v78, MIN(v43) as v76 from aggJoin4661958767649004763 group by v61;
create or replace view aggJoin3503615226909960896 as select movie_id as v49, link_type_id as v23, v74, v78, v76 from movie_link as ml, aggView8842906237277991203 where ml.linked_movie_id=aggView8842906237277991203.v61;
create or replace view aggView3890857490454358160 as select id as v23 from link_type as lt where link IN ('sequel','follows','followed by');
create or replace view aggJoin3564368102208804612 as select v49, v74, v78, v76 from aggJoin3503615226909960896 join aggView3890857490454358160 using(v23);
create or replace view aggView1698118518654102434 as select v49, MIN(v74) as v74, MIN(v78) as v78, MIN(v76) as v76 from aggJoin3564368102208804612 group by v49;
create or replace view aggJoin5647548134475408165 as select v49, v73 as v73, v74, v78, v76 from aggJoin1479327300429006990 join aggView1698118518654102434 using(v49);
create or replace view aggView6320884457122170909 as select v49, MIN(v73) as v73, MIN(v74) as v74, MIN(v78) as v78, MIN(v76) as v76 from aggJoin5647548134475408165 group by v49;
create or replace view aggJoin3304893557156963216 as select v49, v50, v73, v74, v78, v76 from aggJoin4987663458116809574 join aggView6320884457122170909 using(v49);
create or replace view aggView114906196202967627 as select v49, MIN(v73) as v73, MIN(v74) as v74, MIN(v78) as v78, MIN(v76) as v76, MIN(v50) as v77 from aggJoin3304893557156963216 group by v49;
create or replace view aggJoin5198450756019365251 as select info_type_id as v15, info as v38, v73, v74, v78, v76, v77 from movie_info_idx as mi_idx1, aggView114906196202967627 where mi_idx1.movie_id=aggView114906196202967627.v49;
create or replace view aggView4108380259420051723 as select v15, MIN(v73) as v73, MIN(v74) as v74, MIN(v78) as v78, MIN(v76) as v76, MIN(v77) as v77, MIN(v38) as v75 from aggJoin5198450756019365251 group by v15;
create or replace view aggJoin7636673992190834174 as select v73, v74, v78, v76, v77, v75 from info_type as it1, aggView4108380259420051723 where it1.id=aggView4108380259420051723.v15 and info= 'rating';
create or replace view res as select MIN(v73) as v73, MIN(v74) as v74, MIN(v75) as v75, MIN(v76) as v76, MIN(v77) as v77, MIN(v78) as v78 from aggJoin7636673992190834174;
select sum(v73+v74+v75+v76+v77+v78) from res;