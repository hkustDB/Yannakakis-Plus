create or replace view aggView3546323796617337995 as select id as v1, name as v73 from company_name as cn1 where country_code<> '[us]';
create or replace view aggJoin5268237708984470651 as select movie_id as v49, v73 from movie_companies as mc1, aggView3546323796617337995 where mc1.company_id=aggView3546323796617337995.v1;
create or replace view aggView2512271573250164469 as select id as v8, name as v74 from company_name as cn2;
create or replace view aggJoin6114973205919090699 as select movie_id as v61, v74 from movie_companies as mc2, aggView2512271573250164469 where mc2.company_id=aggView2512271573250164469.v8;
create or replace view aggView4843777520947883947 as select id as v21 from kind_type as kt2 where kind IN ('tv series','episode');
create or replace view aggJoin8528469692907678650 as select id as v61, title as v62 from title as t2, aggView4843777520947883947 where t2.kind_id=aggView4843777520947883947.v21 and production_year>=2000 and production_year<=2010;
create or replace view aggView7892281704977267376 as select v61, MIN(v62) as v78 from aggJoin8528469692907678650 group by v61;
create or replace view aggJoin2490689343063801307 as select v61, v74 as v74, v78 from aggJoin6114973205919090699 join aggView7892281704977267376 using(v61);
create or replace view aggView8107107912679313180 as select id as v19 from kind_type as kt1 where kind IN ('tv series','episode');
create or replace view aggJoin6299549968410488618 as select id as v49, title as v50 from title as t1, aggView8107107912679313180 where t1.kind_id=aggView8107107912679313180.v19;
create or replace view aggView7113777809674227517 as select v49, MIN(v50) as v77 from aggJoin6299549968410488618 group by v49;
create or replace view aggJoin7587520427346863472 as select v49, v73 as v73, v77 from aggJoin5268237708984470651 join aggView7113777809674227517 using(v49);
create or replace view aggView6320116411482919721 as select v61, MIN(v74) as v74, MIN(v78) as v78 from aggJoin2490689343063801307 group by v61;
create or replace view aggJoin834079370117342227 as select movie_id as v61, info_type_id as v17, info as v43, v74, v78 from movie_info_idx as mi_idx2, aggView6320116411482919721 where mi_idx2.movie_id=aggView6320116411482919721.v61 and info<'3.5';
create or replace view aggView9000430080370640948 as select v49, MIN(v73) as v73, MIN(v77) as v77 from aggJoin7587520427346863472 group by v49;
create or replace view aggJoin8407417290575581112 as select movie_id as v49, info_type_id as v15, info as v38, v73, v77 from movie_info_idx as mi_idx1, aggView9000430080370640948 where mi_idx1.movie_id=aggView9000430080370640948.v49;
create or replace view aggView2686540652118563621 as select id as v17 from info_type as it2 where info= 'rating';
create or replace view aggJoin215967246877639502 as select v61, v43, v74, v78 from aggJoin834079370117342227 join aggView2686540652118563621 using(v17);
create or replace view aggView237345738754582650 as select v61, MIN(v74) as v74, MIN(v78) as v78, MIN(v43) as v76 from aggJoin215967246877639502 group by v61;
create or replace view aggJoin744187655494009916 as select movie_id as v49, link_type_id as v23, v74, v78, v76 from movie_link as ml, aggView237345738754582650 where ml.linked_movie_id=aggView237345738754582650.v61;
create or replace view aggView158951412972881847 as select id as v23 from link_type as lt where link IN ('sequel','follows','followed by');
create or replace view aggJoin5529804482891584167 as select v49, v74, v78, v76 from aggJoin744187655494009916 join aggView158951412972881847 using(v23);
create or replace view aggView9180125748762665207 as select v49, MIN(v74) as v74, MIN(v78) as v78, MIN(v76) as v76 from aggJoin5529804482891584167 group by v49;
create or replace view aggJoin3093040549766454560 as select v15, v38, v73 as v73, v77 as v77, v74, v78, v76 from aggJoin8407417290575581112 join aggView9180125748762665207 using(v49);
create or replace view aggView4487576825557292322 as select v15, MIN(v73) as v73, MIN(v77) as v77, MIN(v74) as v74, MIN(v78) as v78, MIN(v76) as v76, MIN(v38) as v75 from aggJoin3093040549766454560 group by v15;
create or replace view aggJoin8974432633680126851 as select v73, v77, v74, v78, v76, v75 from info_type as it1, aggView4487576825557292322 where it1.id=aggView4487576825557292322.v15 and info= 'rating';
create or replace view res as select MIN(v73) as v73, MIN(v74) as v74, MIN(v75) as v75, MIN(v76) as v76, MIN(v77) as v77, MIN(v78) as v78 from aggJoin8974432633680126851;
select sum(v73+v74+v75+v76+v77+v78) from res;