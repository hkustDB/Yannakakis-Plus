create or replace view aggView7146278777005038545 as select id as v5 from comp_cast_type as cct1 where kind= 'cast';
create or replace view aggJoin7713906226008537237 as select movie_id as v45, status_id as v7 from complete_cast as cc, aggView7146278777005038545 where cc.subject_id=aggView7146278777005038545.v5;
create or replace view aggView76496760278081922 as select id as v20 from info_type as it2 where info= 'rating';
create or replace view aggJoin3251422425380770497 as select movie_id as v45, info as v40 from movie_info_idx as mi_idx, aggView76496760278081922 where mi_idx.info_type_id=aggView76496760278081922.v20 and info<'8.5';
create or replace view aggView2182559175297962997 as select id as v25 from kind_type as kt where kind IN ('movie','episode');
create or replace view aggJoin3997292811968278613 as select id as v45, title as v46 from title as t, aggView2182559175297962997 where t.kind_id=aggView2182559175297962997.v25 and production_year>2005;
create or replace view aggView1913808569013942079 as select id as v16 from company_type as ct;
create or replace view aggJoin4593363727699243040 as select movie_id as v45, company_id as v9 from movie_companies as mc, aggView1913808569013942079 where mc.company_type_id=aggView1913808569013942079.v16 and note NOT LIKE '%(USA)%' and note LIKE '%(200%)%';
create or replace view aggView3732449795023697694 as select id as v22 from keyword as k where keyword IN ('murder','murder-in-title','blood','violence');
create or replace view aggJoin492618426263597773 as select movie_id as v45 from movie_keyword as mk, aggView3732449795023697694 where mk.keyword_id=aggView3732449795023697694.v22;
create or replace view aggView6184145134084539568 as select id as v18 from info_type as it1 where info= 'countries';
create or replace view aggJoin5260420355631387623 as select movie_id as v45 from movie_info as mi, aggView6184145134084539568 where mi.info_type_id=aggView6184145134084539568.v18 and info IN ('Sweden','Norway','Germany','Denmark','Swedish','Danish','Norwegian','German','USA','American');
create or replace view aggView1361107921818534679 as select id as v7 from comp_cast_type as cct2 where kind= 'complete';
create or replace view aggJoin548307831467419267 as select v45 from aggJoin7713906226008537237 join aggView1361107921818534679 using(v7);
create or replace view aggView8961554155429546916 as select v45 from aggJoin548307831467419267 group by v45;
create or replace view aggJoin3480166068766652857 as select v45 from aggJoin492618426263597773 join aggView8961554155429546916 using(v45);
create or replace view aggView2678513402847078406 as select v45 from aggJoin3480166068766652857 group by v45;
create or replace view aggJoin1746775721676095454 as select v45, v46 from aggJoin3997292811968278613 join aggView2678513402847078406 using(v45);
create or replace view aggView5683049572425737787 as select v45, MIN(v46) as v59 from aggJoin1746775721676095454 group by v45;
create or replace view aggJoin5288728595032248925 as select v45, v59 from aggJoin5260420355631387623 join aggView5683049572425737787 using(v45);
create or replace view aggView2156750902176423129 as select v45, MIN(v59) as v59 from aggJoin5288728595032248925 group by v45;
create or replace view aggJoin2278048065558624736 as select v45, v40, v59 from aggJoin3251422425380770497 join aggView2156750902176423129 using(v45);
create or replace view aggView5936376296847724888 as select v45, MIN(v59) as v59, MIN(v40) as v58 from aggJoin2278048065558624736 group by v45;
create or replace view aggJoin5175616030885401616 as select v9, v59, v58 from aggJoin4593363727699243040 join aggView5936376296847724888 using(v45);
create or replace view aggView6802347098774597850 as select v9, MIN(v59) as v59, MIN(v58) as v58 from aggJoin5175616030885401616 group by v9;
create or replace view aggJoin6779100698873925867 as select name as v10, v59, v58 from company_name as cn, aggView6802347098774597850 where cn.id=aggView6802347098774597850.v9 and country_code<> '[us]';
create or replace view res as select MIN(v10) as v57, MIN(v58) as v58, MIN(v59) as v59 from aggJoin6779100698873925867;
select sum(v57+v58+v59) from res;