create or replace view aggView7168928332960120623 as select id as v5 from comp_cast_type as cct1 where kind= 'cast';
create or replace view aggJoin9101600024319205648 as select movie_id as v45, status_id as v7 from complete_cast as cc, aggView7168928332960120623 where cc.subject_id=aggView7168928332960120623.v5;
create or replace view aggView971147065272681004 as select id as v20 from info_type as it2 where info= 'rating';
create or replace view aggJoin4292650338270743303 as select movie_id as v45, info as v40 from movie_info_idx as mi_idx, aggView971147065272681004 where mi_idx.info_type_id=aggView971147065272681004.v20 and info<'8.5';
create or replace view aggView3162342983229351524 as select id as v25 from kind_type as kt where kind IN ('movie','episode');
create or replace view aggJoin5337280946699319016 as select id as v45, title as v46 from title as t, aggView3162342983229351524 where t.kind_id=aggView3162342983229351524.v25 and production_year>2005;
create or replace view aggView927133744555257539 as select id as v16 from company_type as ct;
create or replace view aggJoin8092003423689035147 as select movie_id as v45, company_id as v9 from movie_companies as mc, aggView927133744555257539 where mc.company_type_id=aggView927133744555257539.v16 and note NOT LIKE '%(USA)%' and note LIKE '%(200%)%';
create or replace view aggView5860999209293843365 as select id as v18 from info_type as it1 where info= 'countries';
create or replace view aggJoin444623040550462587 as select movie_id as v45 from movie_info as mi, aggView5860999209293843365 where mi.info_type_id=aggView5860999209293843365.v18 and info IN ('Sweden','Norway','Germany','Denmark','Swedish','Danish','Norwegian','German','USA','American');
create or replace view aggView7663542597524327456 as select id as v22 from keyword as k where keyword IN ('murder','murder-in-title','blood','violence');
create or replace view aggJoin3658735050105978595 as select movie_id as v45 from movie_keyword as mk, aggView7663542597524327456 where mk.keyword_id=aggView7663542597524327456.v22;
create or replace view aggView7672390767736821789 as select id as v7 from comp_cast_type as cct2 where kind= 'complete';
create or replace view aggJoin6066320723462886323 as select v45 from aggJoin9101600024319205648 join aggView7672390767736821789 using(v7);
create or replace view aggView6188483078927305144 as select v45 from aggJoin6066320723462886323 group by v45;
create or replace view aggJoin8156407330921349594 as select v45 from aggJoin444623040550462587 join aggView6188483078927305144 using(v45);
create or replace view aggView1137007206703177696 as select v45 from aggJoin8156407330921349594 group by v45;
create or replace view aggJoin5282918608451574646 as select v45 from aggJoin3658735050105978595 join aggView1137007206703177696 using(v45);
create or replace view aggView2112020133186398681 as select v45 from aggJoin5282918608451574646 group by v45;
create or replace view aggJoin961835457772054874 as select v45, v40 from aggJoin4292650338270743303 join aggView2112020133186398681 using(v45);
create or replace view aggView8604877301050368064 as select v45, MIN(v40) as v58 from aggJoin961835457772054874 group by v45;
create or replace view aggJoin7265134478609991451 as select v45, v46, v58 from aggJoin5337280946699319016 join aggView8604877301050368064 using(v45);
create or replace view aggView7016736072564412156 as select v45, MIN(v58) as v58, MIN(v46) as v59 from aggJoin7265134478609991451 group by v45;
create or replace view aggJoin6205354486559227935 as select v9, v58, v59 from aggJoin8092003423689035147 join aggView7016736072564412156 using(v45);
create or replace view aggView1010968999016473860 as select v9, MIN(v58) as v58, MIN(v59) as v59 from aggJoin6205354486559227935 group by v9;
create or replace view aggJoin3247252364178195490 as select name as v10, v58, v59 from company_name as cn, aggView1010968999016473860 where cn.id=aggView1010968999016473860.v9 and country_code<> '[us]';
create or replace view res as select MIN(v10) as v57, MIN(v58) as v58, MIN(v59) as v59 from aggJoin3247252364178195490;
select sum(v57+v58+v59) from res;