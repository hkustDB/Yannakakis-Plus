create or replace view aggView1241340270827265827 as select id as v5 from comp_cast_type as cct1 where kind= 'cast';
create or replace view aggJoin3283659345676391679 as select movie_id as v45, status_id as v7 from complete_cast as cc, aggView1241340270827265827 where cc.subject_id=aggView1241340270827265827.v5;
create or replace view aggView4931557920962651205 as select id as v20 from info_type as it2 where info= 'rating';
create or replace view aggJoin5550693691401158483 as select movie_id as v45, info as v40 from movie_info_idx as mi_idx, aggView4931557920962651205 where mi_idx.info_type_id=aggView4931557920962651205.v20 and info<'8.5';
create or replace view aggView6373460442295214134 as select id as v25 from kind_type as kt where kind IN ('movie','episode');
create or replace view aggJoin1998976637089555130 as select id as v45, title as v46 from title as t, aggView6373460442295214134 where t.kind_id=aggView6373460442295214134.v25 and production_year>2005;
create or replace view aggView3976287443425232929 as select id as v16 from company_type as ct;
create or replace view aggJoin4450337893976930931 as select movie_id as v45, company_id as v9 from movie_companies as mc, aggView3976287443425232929 where mc.company_type_id=aggView3976287443425232929.v16 and note NOT LIKE '%(USA)%' and note LIKE '%(200%)%';
create or replace view aggView8443474761372969190 as select id as v18 from info_type as it1 where info= 'countries';
create or replace view aggJoin369992050135325901 as select movie_id as v45 from movie_info as mi, aggView8443474761372969190 where mi.info_type_id=aggView8443474761372969190.v18 and info IN ('Sweden','Norway','Germany','Denmark','Swedish','Danish','Norwegian','German','USA','American');
create or replace view aggView5758285432420214712 as select id as v22 from keyword as k where keyword IN ('murder','murder-in-title','blood','violence');
create or replace view aggJoin2432240290658958979 as select movie_id as v45 from movie_keyword as mk, aggView5758285432420214712 where mk.keyword_id=aggView5758285432420214712.v22;
create or replace view aggView5555316892439194577 as select id as v7 from comp_cast_type as cct2 where kind= 'complete';
create or replace view aggJoin3392164667310037665 as select v45 from aggJoin3283659345676391679 join aggView5555316892439194577 using(v7);
create or replace view aggView203098761607358825 as select v45 from aggJoin3392164667310037665 group by v45;
create or replace view aggJoin4258461563149017748 as select v45 from aggJoin369992050135325901 join aggView203098761607358825 using(v45);
create or replace view aggView6122686479491712964 as select v45 from aggJoin4258461563149017748 group by v45;
create or replace view aggJoin5890199611577907273 as select v45, v40 from aggJoin5550693691401158483 join aggView6122686479491712964 using(v45);
create or replace view aggView2117620995477276139 as select v45, MIN(v40) as v58 from aggJoin5890199611577907273 group by v45;
create or replace view aggJoin9023460655872517908 as select v45, v58 from aggJoin2432240290658958979 join aggView2117620995477276139 using(v45);
create or replace view aggView1435169396680655309 as select v45, MIN(v58) as v58 from aggJoin9023460655872517908 group by v45;
create or replace view aggJoin1692898707033046240 as select v45, v46, v58 from aggJoin1998976637089555130 join aggView1435169396680655309 using(v45);
create or replace view aggView4374820652468329281 as select v45, MIN(v58) as v58, MIN(v46) as v59 from aggJoin1692898707033046240 group by v45;
create or replace view aggJoin7620605717546893123 as select v9, v58, v59 from aggJoin4450337893976930931 join aggView4374820652468329281 using(v45);
create or replace view aggView2570855475204447229 as select v9, MIN(v58) as v58, MIN(v59) as v59 from aggJoin7620605717546893123 group by v9;
create or replace view aggJoin1135579828760870187 as select name as v10, v58, v59 from company_name as cn, aggView2570855475204447229 where cn.id=aggView2570855475204447229.v9 and country_code<> '[us]';
create or replace view res as select MIN(v10) as v57, MIN(v58) as v58, MIN(v59) as v59 from aggJoin1135579828760870187;
select sum(v57+v58+v59) from res;