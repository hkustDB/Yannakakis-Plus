create or replace view aggView710500978288476489 as select id as v5 from comp_cast_type as cct1 where kind= 'cast';
create or replace view aggJoin1181140445452900575 as select movie_id as v45, status_id as v7 from complete_cast as cc, aggView710500978288476489 where cc.subject_id=aggView710500978288476489.v5;
create or replace view aggView3851050584960850346 as select id as v20 from info_type as it2 where info= 'rating';
create or replace view aggJoin1031131008750775998 as select movie_id as v45, info as v40 from movie_info_idx as mi_idx, aggView3851050584960850346 where mi_idx.info_type_id=aggView3851050584960850346.v20 and info<'8.5';
create or replace view aggView5670534649709416162 as select id as v25 from kind_type as kt where kind IN ('movie','episode');
create or replace view aggJoin4694889692913839129 as select id as v45, title as v46 from title as t, aggView5670534649709416162 where t.kind_id=aggView5670534649709416162.v25 and production_year>2005;
create or replace view aggView8116265514497817902 as select id as v16 from company_type as ct;
create or replace view aggJoin5431269978901537440 as select movie_id as v45, company_id as v9 from movie_companies as mc, aggView8116265514497817902 where mc.company_type_id=aggView8116265514497817902.v16 and note NOT LIKE '%(USA)%' and note LIKE '%(200%)%';
create or replace view aggView7708326984615931371 as select id as v18 from info_type as it1 where info= 'countries';
create or replace view aggJoin6755475238797823241 as select movie_id as v45 from movie_info as mi, aggView7708326984615931371 where mi.info_type_id=aggView7708326984615931371.v18 and info IN ('Sweden','Norway','Germany','Denmark','Swedish','Danish','Norwegian','German','USA','American');
create or replace view aggView3241895498625129682 as select id as v22 from keyword as k where keyword IN ('murder','murder-in-title','blood','violence');
create or replace view aggJoin2601744316306854714 as select movie_id as v45 from movie_keyword as mk, aggView3241895498625129682 where mk.keyword_id=aggView3241895498625129682.v22;
create or replace view aggView5854974047861249485 as select id as v7 from comp_cast_type as cct2 where kind= 'complete';
create or replace view aggJoin8682891576008417182 as select v45 from aggJoin1181140445452900575 join aggView5854974047861249485 using(v7);
create or replace view aggView8005324815518293143 as select v45 from aggJoin8682891576008417182 group by v45;
create or replace view aggJoin2181680050697582137 as select v45 from aggJoin6755475238797823241 join aggView8005324815518293143 using(v45);
create or replace view aggView6241339511848372744 as select v45 from aggJoin2181680050697582137 group by v45;
create or replace view aggJoin8946370563202790658 as select v45 from aggJoin2601744316306854714 join aggView6241339511848372744 using(v45);
create or replace view aggView2611056196075859957 as select v45 from aggJoin8946370563202790658 group by v45;
create or replace view aggJoin1131647539962508462 as select v45, v46 from aggJoin4694889692913839129 join aggView2611056196075859957 using(v45);
create or replace view aggView414712084407446070 as select v45, MIN(v46) as v59 from aggJoin1131647539962508462 group by v45;
create or replace view aggJoin8946661079107144898 as select v45, v40, v59 from aggJoin1031131008750775998 join aggView414712084407446070 using(v45);
create or replace view aggView3979688653280080407 as select v45, MIN(v59) as v59, MIN(v40) as v58 from aggJoin8946661079107144898 group by v45;
create or replace view aggJoin8331253463967363382 as select v9, v59, v58 from aggJoin5431269978901537440 join aggView3979688653280080407 using(v45);
create or replace view aggView8389508679982477009 as select v9, MIN(v59) as v59, MIN(v58) as v58 from aggJoin8331253463967363382 group by v9;
create or replace view aggJoin3290609411773780262 as select name as v10, v59, v58 from company_name as cn, aggView8389508679982477009 where cn.id=aggView8389508679982477009.v9 and country_code<> '[us]';
create or replace view res as select MIN(v10) as v57, MIN(v58) as v58, MIN(v59) as v59 from aggJoin3290609411773780262;
select sum(v57+v58+v59) from res;