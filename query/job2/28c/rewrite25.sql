create or replace view aggView6817257217917048248 as select id as v9, name as v57 from company_name as cn where country_code<> '[us]';
create or replace view aggJoin4281746616069633091 as select movie_id as v45, company_type_id as v16, note as v31, v57 from movie_companies as mc, aggView6817257217917048248 where mc.company_id=aggView6817257217917048248.v9 and note NOT LIKE '%(USA)%' and note LIKE '%(200%)%';
create or replace view aggView4906224308167471634 as select id as v5 from comp_cast_type as cct1 where kind= 'cast';
create or replace view aggJoin2651742566253716014 as select movie_id as v45, status_id as v7 from complete_cast as cc, aggView4906224308167471634 where cc.subject_id=aggView4906224308167471634.v5;
create or replace view aggView4491052681926059781 as select id as v20 from info_type as it2 where info= 'rating';
create or replace view aggJoin5421139340982689316 as select movie_id as v45, info as v40 from movie_info_idx as mi_idx, aggView4491052681926059781 where mi_idx.info_type_id=aggView4491052681926059781.v20 and info<'8.5';
create or replace view aggView4026028539644180367 as select id as v16 from company_type as ct;
create or replace view aggJoin7873703074035982270 as select v45, v57 from aggJoin4281746616069633091 join aggView4026028539644180367 using(v16);
create or replace view aggView5144290852258214146 as select v45, MIN(v57) as v57 from aggJoin7873703074035982270 group by v45;
create or replace view aggJoin653332381724396281 as select v45, v40, v57 from aggJoin5421139340982689316 join aggView5144290852258214146 using(v45);
create or replace view aggView1384551598092690829 as select v45, MIN(v57) as v57, MIN(v40) as v58 from aggJoin653332381724396281 group by v45;
create or replace view aggJoin2868122005559044197 as select movie_id as v45, info_type_id as v18, v57, v58 from movie_info as mi, aggView1384551598092690829 where mi.movie_id=aggView1384551598092690829.v45 and info IN ('Sweden','Norway','Germany','Denmark','Swedish','Danish','Norwegian','German','USA','American');
create or replace view aggView5873422993758462201 as select id as v18 from info_type as it1 where info= 'countries';
create or replace view aggJoin3846596846729319032 as select v45, v57, v58 from aggJoin2868122005559044197 join aggView5873422993758462201 using(v18);
create or replace view aggView2061894936537007796 as select id as v22 from keyword as k where keyword IN ('murder','murder-in-title','blood','violence');
create or replace view aggJoin664592284681445456 as select movie_id as v45 from movie_keyword as mk, aggView2061894936537007796 where mk.keyword_id=aggView2061894936537007796.v22;
create or replace view aggView1165766941830445307 as select id as v7 from comp_cast_type as cct2 where kind= 'complete';
create or replace view aggJoin1766236543189351247 as select v45 from aggJoin2651742566253716014 join aggView1165766941830445307 using(v7);
create or replace view aggView2124775003192628863 as select v45 from aggJoin1766236543189351247 group by v45;
create or replace view aggJoin1625261778793928093 as select v45 from aggJoin664592284681445456 join aggView2124775003192628863 using(v45);
create or replace view aggView4364099796044894206 as select v45 from aggJoin1625261778793928093 group by v45;
create or replace view aggJoin9019124059305207417 as select id as v45, title as v46, kind_id as v25 from title as t, aggView4364099796044894206 where t.id=aggView4364099796044894206.v45 and production_year>2005;
create or replace view aggView2365617745571946522 as select v45, MIN(v57) as v57, MIN(v58) as v58 from aggJoin3846596846729319032 group by v45;
create or replace view aggJoin2917443355017538234 as select v46, v25, v57, v58 from aggJoin9019124059305207417 join aggView2365617745571946522 using(v45);
create or replace view aggView1024594904966270509 as select v25, MIN(v57) as v57, MIN(v58) as v58, MIN(v46) as v59 from aggJoin2917443355017538234 group by v25;
create or replace view aggJoin2597624885728044466 as select v57, v58, v59 from kind_type as kt, aggView1024594904966270509 where kt.id=aggView1024594904966270509.v25 and kind IN ('movie','episode');
create or replace view res as select MIN(v57) as v57, MIN(v58) as v58, MIN(v59) as v59 from aggJoin2597624885728044466;
select sum(v57+v58+v59) from res;