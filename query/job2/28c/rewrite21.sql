create or replace view aggView5701967761200458678 as select id as v9, name as v57 from company_name as cn where country_code<> '[us]';
create or replace view aggJoin7363170353552294075 as select movie_id as v45, company_type_id as v16, note as v31, v57 from movie_companies as mc, aggView5701967761200458678 where mc.company_id=aggView5701967761200458678.v9 and note NOT LIKE '%(USA)%' and note LIKE '%(200%)%';
create or replace view aggView6619504349140294483 as select id as v5 from comp_cast_type as cct1 where kind= 'cast';
create or replace view aggJoin380340178937819045 as select movie_id as v45, status_id as v7 from complete_cast as cc, aggView6619504349140294483 where cc.subject_id=aggView6619504349140294483.v5;
create or replace view aggView7669524655580697851 as select id as v25 from kind_type as kt where kind IN ('movie','episode');
create or replace view aggJoin2650996061920942959 as select id as v45, title as v46 from title as t, aggView7669524655580697851 where t.kind_id=aggView7669524655580697851.v25 and production_year>2005;
create or replace view aggView3917200841824751404 as select id as v16 from company_type as ct;
create or replace view aggJoin7420020333102371287 as select v45, v57 from aggJoin7363170353552294075 join aggView3917200841824751404 using(v16);
create or replace view aggView1971357288150625466 as select v45, MIN(v57) as v57 from aggJoin7420020333102371287 group by v45;
create or replace view aggJoin3758892716948624877 as select v45, v46, v57 from aggJoin2650996061920942959 join aggView1971357288150625466 using(v45);
create or replace view aggView2624593250142223105 as select v45, MIN(v57) as v57, MIN(v46) as v59 from aggJoin3758892716948624877 group by v45;
create or replace view aggJoin2091085441906611035 as select movie_id as v45, info_type_id as v18, v57, v59 from movie_info as mi, aggView2624593250142223105 where mi.movie_id=aggView2624593250142223105.v45 and info IN ('Sweden','Norway','Germany','Denmark','Swedish','Danish','Norwegian','German','USA','American');
create or replace view aggView5165169452285187126 as select id as v18 from info_type as it1 where info= 'countries';
create or replace view aggJoin1884709274186492226 as select v45, v57, v59 from aggJoin2091085441906611035 join aggView5165169452285187126 using(v18);
create or replace view aggView3172770117051159116 as select v45, MIN(v57) as v57, MIN(v59) as v59 from aggJoin1884709274186492226 group by v45;
create or replace view aggJoin162448213350699500 as select movie_id as v45, info_type_id as v20, info as v40, v57, v59 from movie_info_idx as mi_idx, aggView3172770117051159116 where mi_idx.movie_id=aggView3172770117051159116.v45 and info<'8.5';
create or replace view aggView3405020899989312715 as select id as v22 from keyword as k where keyword IN ('murder','murder-in-title','blood','violence');
create or replace view aggJoin7167794823664831921 as select movie_id as v45 from movie_keyword as mk, aggView3405020899989312715 where mk.keyword_id=aggView3405020899989312715.v22;
create or replace view aggView533689837469457875 as select id as v7 from comp_cast_type as cct2 where kind= 'complete';
create or replace view aggJoin2325283305393974825 as select v45 from aggJoin380340178937819045 join aggView533689837469457875 using(v7);
create or replace view aggView9199443814920650443 as select v45 from aggJoin2325283305393974825 group by v45;
create or replace view aggJoin8126722822046688216 as select v45 from aggJoin7167794823664831921 join aggView9199443814920650443 using(v45);
create or replace view aggView3963801000400398614 as select v45 from aggJoin8126722822046688216 group by v45;
create or replace view aggJoin2340114169681133150 as select v20, v40, v57 as v57, v59 as v59 from aggJoin162448213350699500 join aggView3963801000400398614 using(v45);
create or replace view aggView6986316873032203736 as select v20, MIN(v57) as v57, MIN(v59) as v59, MIN(v40) as v58 from aggJoin2340114169681133150 group by v20;
create or replace view aggJoin5801219201545155577 as select v57, v59, v58 from info_type as it2, aggView6986316873032203736 where it2.id=aggView6986316873032203736.v20 and info= 'rating';
create or replace view res as select MIN(v57) as v57, MIN(v58) as v58, MIN(v59) as v59 from aggJoin5801219201545155577;
select sum(v57+v58+v59) from res;