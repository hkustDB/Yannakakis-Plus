create or replace view aggView8251836087701889241 as select id as v9, name as v57 from company_name as cn where country_code<> '[us]';
create or replace view aggJoin8846297874041473612 as select movie_id as v45, company_type_id as v16, note as v31, v57 from movie_companies as mc, aggView8251836087701889241 where mc.company_id=aggView8251836087701889241.v9 and note NOT LIKE '%(USA)%' and note LIKE '%(200%)%';
create or replace view aggView6239563933888774612 as select id as v5 from comp_cast_type as cct1 where kind= 'cast';
create or replace view aggJoin1742650520316648135 as select movie_id as v45, status_id as v7 from complete_cast as cc, aggView6239563933888774612 where cc.subject_id=aggView6239563933888774612.v5;
create or replace view aggView7711292003218370076 as select id as v20 from info_type as it2 where info= 'rating';
create or replace view aggJoin9083622183216980516 as select movie_id as v45, info as v40 from movie_info_idx as mi_idx, aggView7711292003218370076 where mi_idx.info_type_id=aggView7711292003218370076.v20 and info<'8.5';
create or replace view aggView409749209101149550 as select id as v25 from kind_type as kt where kind IN ('movie','episode');
create or replace view aggJoin6988160462218733930 as select id as v45, title as v46 from title as t, aggView409749209101149550 where t.kind_id=aggView409749209101149550.v25 and production_year>2005;
create or replace view aggView3280334352030041190 as select id as v16 from company_type as ct;
create or replace view aggJoin959024023669744597 as select v45, v57 from aggJoin8846297874041473612 join aggView3280334352030041190 using(v16);
create or replace view aggView5128682061750315207 as select v45, MIN(v57) as v57 from aggJoin959024023669744597 group by v45;
create or replace view aggJoin8041815013051582183 as select movie_id as v45, info_type_id as v18, v57 from movie_info as mi, aggView5128682061750315207 where mi.movie_id=aggView5128682061750315207.v45 and info IN ('Sweden','Norway','Germany','Denmark','Swedish','Danish','Norwegian','German','USA','American');
create or replace view aggView6412526651421858667 as select id as v22 from keyword as k where keyword IN ('murder','murder-in-title','blood','violence');
create or replace view aggJoin8694403575913337284 as select movie_id as v45 from movie_keyword as mk, aggView6412526651421858667 where mk.keyword_id=aggView6412526651421858667.v22;
create or replace view aggView7143547465812890200 as select id as v7 from comp_cast_type as cct2 where kind= 'complete';
create or replace view aggJoin4440131742943649472 as select v45 from aggJoin1742650520316648135 join aggView7143547465812890200 using(v7);
create or replace view aggView2850853010348731002 as select v45 from aggJoin4440131742943649472 group by v45;
create or replace view aggJoin6780240189994775351 as select v45 from aggJoin8694403575913337284 join aggView2850853010348731002 using(v45);
create or replace view aggView3535652641624235389 as select v45 from aggJoin6780240189994775351 group by v45;
create or replace view aggJoin7239315135535904815 as select v45, v40 from aggJoin9083622183216980516 join aggView3535652641624235389 using(v45);
create or replace view aggView5855838821255716980 as select v45, MIN(v40) as v58 from aggJoin7239315135535904815 group by v45;
create or replace view aggJoin4967614240901924055 as select v45, v46, v58 from aggJoin6988160462218733930 join aggView5855838821255716980 using(v45);
create or replace view aggView9018731847285543844 as select v45, MIN(v58) as v58, MIN(v46) as v59 from aggJoin4967614240901924055 group by v45;
create or replace view aggJoin5663023847030999212 as select v18, v57 as v57, v58, v59 from aggJoin8041815013051582183 join aggView9018731847285543844 using(v45);
create or replace view aggView3326327860516259705 as select v18, MIN(v57) as v57, MIN(v58) as v58, MIN(v59) as v59 from aggJoin5663023847030999212 group by v18;
create or replace view aggJoin5820910801593416404 as select v57, v58, v59 from info_type as it1, aggView3326327860516259705 where it1.id=aggView3326327860516259705.v18 and info= 'countries';
create or replace view res as select MIN(v57) as v57, MIN(v58) as v58, MIN(v59) as v59 from aggJoin5820910801593416404;
select sum(v57+v58+v59) from res;