create or replace view aggView3172764430448009239 as select id as v28, name as v51 from name as n where gender= 'm';
create or replace view aggJoin2001244135610405559 as select movie_id as v37, note as v5, v51 from cast_info as ci, aggView3172764430448009239 where ci.person_id=aggView3172764430448009239.v28 and note IN ('(writer)','(head writer)','(written by)','(story)','(story editor)');
create or replace view aggView6150896520964105328 as select id as v10 from info_type as it2 where info= 'votes';
create or replace view aggJoin2196887538271651351 as select movie_id as v37, info as v23 from movie_info_idx as mi_idx, aggView6150896520964105328 where mi_idx.info_type_id=aggView6150896520964105328.v10;
create or replace view aggView6805167824855425865 as select id as v8 from info_type as it1 where info= 'genres';
create or replace view aggJoin5381107418946071864 as select movie_id as v37, info as v18 from movie_info as mi, aggView6805167824855425865 where mi.info_type_id=aggView6805167824855425865.v8 and info= 'Horror';
create or replace view aggView4132753290025369038 as select v37, MIN(v18) as v49 from aggJoin5381107418946071864 group by v37;
create or replace view aggJoin3871748272662813203 as select movie_id as v37, keyword_id as v12, v49 from movie_keyword as mk, aggView4132753290025369038 where mk.movie_id=aggView4132753290025369038.v37;
create or replace view aggView8001527573524351008 as select id as v12 from keyword as k where keyword IN ('murder','blood','gore','death','female-nudity');
create or replace view aggJoin4027360266815104909 as select v37, v49 from aggJoin3871748272662813203 join aggView8001527573524351008 using(v12);
create or replace view aggView1115954155074662431 as select v37, MIN(v49) as v49 from aggJoin4027360266815104909 group by v37;
create or replace view aggJoin2186761449254211923 as select v37, v5, v51 as v51, v49 from aggJoin2001244135610405559 join aggView1115954155074662431 using(v37);
create or replace view aggView8964304088804776790 as select v37, MIN(v51) as v51, MIN(v49) as v49 from aggJoin2186761449254211923 group by v37;
create or replace view aggJoin4978675235608048495 as select id as v37, title as v38, v51, v49 from title as t, aggView8964304088804776790 where t.id=aggView8964304088804776790.v37;
create or replace view aggView1554149018584879301 as select v37, MIN(v51) as v51, MIN(v49) as v49, MIN(v38) as v52 from aggJoin4978675235608048495 group by v37;
create or replace view aggJoin5852347990267758603 as select v23, v51, v49, v52 from aggJoin2196887538271651351 join aggView1554149018584879301 using(v37);
create or replace view res as select MIN(v49) as v49, MIN(v23) as v50, MIN(v51) as v51, MIN(v52) as v52 from aggJoin5852347990267758603;
select sum(v49+v50+v51+v52) from res;