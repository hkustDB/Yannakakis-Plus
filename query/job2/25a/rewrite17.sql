create or replace view aggView1567743280360936771 as select id as v28, name as v51 from name as n where gender= 'm';
create or replace view aggJoin5944147532473672693 as select movie_id as v37, note as v5, v51 from cast_info as ci, aggView1567743280360936771 where ci.person_id=aggView1567743280360936771.v28 and note IN ('(writer)','(head writer)','(written by)','(story)','(story editor)');
create or replace view aggView5657882282405681830 as select id as v37, title as v52 from title as t;
create or replace view aggJoin2307560460260627145 as select v37, v5, v51, v52 from aggJoin5944147532473672693 join aggView5657882282405681830 using(v37);
create or replace view aggView1983009824606993536 as select id as v8 from info_type as it1 where info= 'genres';
create or replace view aggJoin5398922894348392598 as select movie_id as v37, info as v18 from movie_info as mi, aggView1983009824606993536 where mi.info_type_id=aggView1983009824606993536.v8 and info= 'Horror';
create or replace view aggView8304420797438426865 as select v37, MIN(v18) as v49 from aggJoin5398922894348392598 group by v37;
create or replace view aggJoin5137203149520320217 as select v37, v5, v51 as v51, v52 as v52, v49 from aggJoin2307560460260627145 join aggView8304420797438426865 using(v37);
create or replace view aggView5564988632920860568 as select v37, MIN(v51) as v51, MIN(v52) as v52, MIN(v49) as v49 from aggJoin5137203149520320217 group by v37;
create or replace view aggJoin3881619605684221957 as select movie_id as v37, keyword_id as v12, v51, v52, v49 from movie_keyword as mk, aggView5564988632920860568 where mk.movie_id=aggView5564988632920860568.v37;
create or replace view aggView4938439052969067000 as select id as v12 from keyword as k where keyword IN ('murder','blood','gore','death','female-nudity');
create or replace view aggJoin2841616063598534948 as select v37, v51, v52, v49 from aggJoin3881619605684221957 join aggView4938439052969067000 using(v12);
create or replace view aggView1500159073537250607 as select id as v10 from info_type as it2 where info= 'votes';
create or replace view aggJoin2302535685297363940 as select movie_id as v37, info as v23 from movie_info_idx as mi_idx, aggView1500159073537250607 where mi_idx.info_type_id=aggView1500159073537250607.v10;
create or replace view aggView1924708348876639238 as select v37, MIN(v23) as v50 from aggJoin2302535685297363940 group by v37;
create or replace view aggJoin8084062781967096751 as select v51 as v51, v52 as v52, v49 as v49, v50 from aggJoin2841616063598534948 join aggView1924708348876639238 using(v37);
select MIN(v49) as v49,MIN(v50) as v50,MIN(v51) as v51,MIN(v52) as v52 from aggJoin8084062781967096751;
