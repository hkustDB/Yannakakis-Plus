create or replace view aggView8032684241459303769 as select id as v28, name as v51 from name as n where gender= 'm';
create or replace view aggJoin471605488319405345 as select movie_id as v37, note as v5, v51 from cast_info as ci, aggView8032684241459303769 where ci.person_id=aggView8032684241459303769.v28 and note IN ('(writer)','(head writer)','(written by)','(story)','(story editor)');
create or replace view aggView6345139813923203628 as select id as v8 from info_type as it1 where info= 'genres';
create or replace view aggJoin5075579999615290614 as select movie_id as v37, info as v18 from movie_info as mi, aggView6345139813923203628 where mi.info_type_id=aggView6345139813923203628.v8 and info= 'Horror';
create or replace view aggView6915930281426714976 as select id as v12 from keyword as k where keyword IN ('murder','blood','gore','death','female-nudity');
create or replace view aggJoin3026819622516731986 as select movie_id as v37 from movie_keyword as mk, aggView6915930281426714976 where mk.keyword_id=aggView6915930281426714976.v12;
create or replace view aggView8653108046962204756 as select v37, MIN(v51) as v51 from aggJoin471605488319405345 group by v37;
create or replace view aggJoin2761467604631969890 as select v37, v18, v51 from aggJoin5075579999615290614 join aggView8653108046962204756 using(v37);
create or replace view aggView8981494946422044478 as select v37, MIN(v51) as v51, MIN(v18) as v49 from aggJoin2761467604631969890 group by v37;
create or replace view aggJoin8158652073276114129 as select movie_id as v37, info_type_id as v10, info as v23, v51, v49 from movie_info_idx as mi_idx, aggView8981494946422044478 where mi_idx.movie_id=aggView8981494946422044478.v37;
create or replace view aggView822521217299454045 as select id as v10 from info_type as it2 where info= 'votes';
create or replace view aggJoin926906113574346028 as select v37, v23, v51, v49 from aggJoin8158652073276114129 join aggView822521217299454045 using(v10);
create or replace view aggView5863143028967487879 as select v37, MIN(v51) as v51, MIN(v49) as v49, MIN(v23) as v50 from aggJoin926906113574346028 group by v37;
create or replace view aggJoin6303700927759545049 as select id as v37, title as v38, v51, v49, v50 from title as t, aggView5863143028967487879 where t.id=aggView5863143028967487879.v37;
create or replace view aggView3271170289136219824 as select v37, MIN(v51) as v51, MIN(v49) as v49, MIN(v50) as v50, MIN(v38) as v52 from aggJoin6303700927759545049 group by v37;
create or replace view aggJoin1650256752501089979 as select v51, v49, v50, v52 from aggJoin3026819622516731986 join aggView3271170289136219824 using(v37);
select MIN(v49) as v49,MIN(v50) as v50,MIN(v51) as v51,MIN(v52) as v52 from aggJoin1650256752501089979;
