create or replace view aggView8360635024362748288 as select id as v10 from info_type as it1 where info= 'countries';
create or replace view aggJoin779826048181920998 as select movie_id as v37, info as v27 from movie_info as mi, aggView8360635024362748288 where mi.info_type_id=aggView8360635024362748288.v10 and info IN ('Sweden','Norway','Germany','Denmark','Swedish','Danish','Norwegian','German','USA','American');
create or replace view aggView1061671648952466579 as select id as v14 from keyword as k where keyword IN ('murder','murder-in-title','blood','violence');
create or replace view aggJoin7631190237899267799 as select movie_id as v37 from movie_keyword as mk, aggView1061671648952466579 where mk.keyword_id=aggView1061671648952466579.v14;
create or replace view aggView8760329570912300345 as select id as v17 from kind_type as kt where kind IN ('movie','episode');
create or replace view aggJoin291621606018094348 as select id as v37, title as v38 from title as t, aggView8760329570912300345 where t.kind_id=aggView8760329570912300345.v17 and production_year>2005;
create or replace view aggView7626194167937447914 as select id as v12 from info_type as it2 where info= 'rating';
create or replace view aggJoin1813298588636959162 as select movie_id as v37, info as v32 from movie_info_idx as mi_idx, aggView7626194167937447914 where mi_idx.info_type_id=aggView7626194167937447914.v12 and info<'8.5';
create or replace view aggView7865905901794199416 as select v37, MIN(v32) as v50 from aggJoin1813298588636959162 group by v37;
create or replace view aggJoin7601313666071490071 as select v37, v50 from aggJoin779826048181920998 join aggView7865905901794199416 using(v37);
create or replace view aggView6736105608434587611 as select v37, MIN(v50) as v50 from aggJoin7601313666071490071 group by v37;
create or replace view aggJoin8649148964662282731 as select v37, v38, v50 from aggJoin291621606018094348 join aggView6736105608434587611 using(v37);
create or replace view aggView6169286348550791232 as select v37, MIN(v50) as v50, MIN(v38) as v51 from aggJoin8649148964662282731 group by v37;
create or replace view aggJoin6663202619757545171 as select v37, v50, v51 from aggJoin7631190237899267799 join aggView6169286348550791232 using(v37);
create or replace view aggView5822448815504967054 as select v37, MIN(v50) as v50, MIN(v51) as v51 from aggJoin6663202619757545171 group by v37;
create or replace view aggJoin6170173606275434265 as select company_id as v1, company_type_id as v8, v50, v51 from movie_companies as mc, aggView5822448815504967054 where mc.movie_id=aggView5822448815504967054.v37 and note NOT LIKE '%(USA)%' and note LIKE '%(200%)%';
create or replace view aggView6303930011357265534 as select id as v8 from company_type as ct;
create or replace view aggJoin1958807289782602615 as select v1, v50, v51 from aggJoin6170173606275434265 join aggView6303930011357265534 using(v8);
create or replace view aggView9043074458867485324 as select v1, MIN(v50) as v50, MIN(v51) as v51 from aggJoin1958807289782602615 group by v1;
create or replace view aggJoin1873496459094321421 as select name as v2, v50, v51 from company_name as cn, aggView9043074458867485324 where cn.id=aggView9043074458867485324.v1 and country_code<> '[us]';
create or replace view res as select MIN(v2) as v49, MIN(v50) as v50, MIN(v51) as v51 from aggJoin1873496459094321421;
select sum(v49+v50+v51) from res;