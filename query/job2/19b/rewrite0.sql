create or replace view aggView3820749225069684827 as select id as v53, title as v66 from title as t where production_year>=2007 and production_year<=2008 and title LIKE '%Kung%Fu%Panda%';
create or replace view aggJoin29838925067523768 as select movie_id as v53, company_id as v23, note as v36, v66 from movie_companies as mc, aggView3820749225069684827 where mc.movie_id=aggView3820749225069684827.v53 and ((note LIKE '%(USA)%') OR (note LIKE '%(worldwide)%')) and note LIKE '%(200%)%';
create or replace view aggView4833298027450716267 as select person_id as v42 from aka_name as an group by person_id;
create or replace view aggJoin1518785883464255711 as select id as v42, name as v43, gender as v46 from name as n, aggView4833298027450716267 where n.id=aggView4833298027450716267.v42 and gender= 'f' and name LIKE '%Angel%';
create or replace view aggView2779099182493618392 as select v42, MIN(v43) as v65 from aggJoin1518785883464255711 group by v42;
create or replace view aggJoin7874424726435448089 as select movie_id as v53, person_role_id as v9, note as v20, role_id as v51, v65 from cast_info as ci, aggView2779099182493618392 where ci.person_id=aggView2779099182493618392.v42 and note= '(voice)';
create or replace view aggView157497321629337161 as select id as v23 from company_name as cn where country_code= '[us]';
create or replace view aggJoin5359568549988980927 as select v53, v36, v66 from aggJoin29838925067523768 join aggView157497321629337161 using(v23);
create or replace view aggView4583313056102724646 as select id as v30 from info_type as it where info= 'release dates';
create or replace view aggJoin1178783582151372553 as select movie_id as v53, info as v40 from movie_info as mi, aggView4583313056102724646 where mi.info_type_id=aggView4583313056102724646.v30 and ((info LIKE 'Japan:%2007%') OR (info LIKE 'USA:%2008%'));
create or replace view aggView5603298530761670053 as select v53, MIN(v66) as v66 from aggJoin5359568549988980927 group by v53;
create or replace view aggJoin835749121931354515 as select v53, v40, v66 from aggJoin1178783582151372553 join aggView5603298530761670053 using(v53);
create or replace view aggView5417524394591941884 as select v53, MIN(v66) as v66 from aggJoin835749121931354515 group by v53;
create or replace view aggJoin8039912002381290282 as select v9, v20, v51, v65 as v65, v66 from aggJoin7874424726435448089 join aggView5417524394591941884 using(v53);
create or replace view aggView5016628007793220834 as select id as v9 from char_name as chn;
create or replace view aggJoin9177212718860658348 as select v20, v51, v65, v66 from aggJoin8039912002381290282 join aggView5016628007793220834 using(v9);
create or replace view aggView5667464026445018988 as select v51, MIN(v65) as v65, MIN(v66) as v66 from aggJoin9177212718860658348 group by v51;
create or replace view aggJoin91107405426918041 as select role as v52, v65, v66 from role_type as rt, aggView5667464026445018988 where rt.id=aggView5667464026445018988.v51 and role= 'actress';
create or replace view res as select MIN(v65) as v65, MIN(v66) as v66 from aggJoin91107405426918041;
select sum(v65+v66) from res;