create or replace view aggView7342487992534371711 as select id as v9, name as v57 from company_name as cn where country_code<> '[us]';
create or replace view aggJoin4895490642642532202 as select movie_id as v45, company_type_id as v16, note as v31, v57 from movie_companies as mc, aggView7342487992534371711 where mc.company_id=aggView7342487992534371711.v9 and note NOT LIKE '%(USA)%' and note LIKE '%(200%)%';
create or replace view aggView3090188355664876702 as select id as v20 from info_type as it2 where info= 'rating';
create or replace view aggJoin5752466852524973145 as select movie_id as v45, info as v40 from movie_info_idx as mi_idx, aggView3090188355664876702 where mi_idx.info_type_id=aggView3090188355664876702.v20 and info<'8.5';
create or replace view aggView197819587506340462 as select id as v25 from kind_type as kt where kind IN ('movie','episode');
create or replace view aggJoin7757027752312228073 as select id as v45, title as v46 from title as t, aggView197819587506340462 where t.kind_id=aggView197819587506340462.v25 and production_year>2000;
create or replace view aggView7872892177592986604 as select id as v16 from company_type as ct;
create or replace view aggJoin1430393916766438971 as select v45, v57 from aggJoin4895490642642532202 join aggView7872892177592986604 using(v16);
create or replace view aggView7090906615300163056 as select id as v5 from comp_cast_type as cct1 where kind= 'crew';
create or replace view aggJoin1606537937283475568 as select movie_id as v45, status_id as v7 from complete_cast as cc, aggView7090906615300163056 where cc.subject_id=aggView7090906615300163056.v5;
create or replace view aggView7652217839540417215 as select id as v18 from info_type as it1 where info= 'countries';
create or replace view aggJoin69113907682246424 as select movie_id as v45 from movie_info as mi, aggView7652217839540417215 where mi.info_type_id=aggView7652217839540417215.v18 and info IN ('Sweden','Norway','Germany','Denmark','Swedish','Danish','Norwegian','German','USA','American');
create or replace view aggView3005516819033892133 as select id as v22 from keyword as k where keyword IN ('murder','murder-in-title','blood','violence');
create or replace view aggJoin1466297099224335481 as select movie_id as v45 from movie_keyword as mk, aggView3005516819033892133 where mk.keyword_id=aggView3005516819033892133.v22;
create or replace view aggView1328991967618694226 as select v45, MIN(v57) as v57 from aggJoin1430393916766438971 group by v45;
create or replace view aggJoin5543273838704609120 as select v45, v57 from aggJoin69113907682246424 join aggView1328991967618694226 using(v45);
create or replace view aggView8427350752100136061 as select v45, MIN(v57) as v57 from aggJoin5543273838704609120 group by v45;
create or replace view aggJoin4947008906642598097 as select v45, v46, v57 from aggJoin7757027752312228073 join aggView8427350752100136061 using(v45);
create or replace view aggView4535998944816920079 as select v45, MIN(v57) as v57, MIN(v46) as v59 from aggJoin4947008906642598097 group by v45;
create or replace view aggJoin5790823649011573166 as select v45, v40, v57, v59 from aggJoin5752466852524973145 join aggView4535998944816920079 using(v45);
create or replace view aggView2193611509491937020 as select v45, MIN(v57) as v57, MIN(v59) as v59, MIN(v40) as v58 from aggJoin5790823649011573166 group by v45;
create or replace view aggJoin5100836998720234526 as select v45, v57, v59, v58 from aggJoin1466297099224335481 join aggView2193611509491937020 using(v45);
create or replace view aggView5145449982647144344 as select v45, MIN(v57) as v57, MIN(v59) as v59, MIN(v58) as v58 from aggJoin5100836998720234526 group by v45;
create or replace view aggJoin3376773503936663752 as select v7, v57, v59, v58 from aggJoin1606537937283475568 join aggView5145449982647144344 using(v45);
create or replace view aggView7580448386775046175 as select v7, MIN(v57) as v57, MIN(v59) as v59, MIN(v58) as v58 from aggJoin3376773503936663752 group by v7;
create or replace view aggJoin9063049312760191296 as select v57, v59, v58 from comp_cast_type as cct2, aggView7580448386775046175 where cct2.id=aggView7580448386775046175.v7 and kind<> 'complete+verified';
create or replace view res as select MIN(v57) as v57, MIN(v58) as v58, MIN(v59) as v59 from aggJoin9063049312760191296;
select sum(v57+v58+v59) from res;