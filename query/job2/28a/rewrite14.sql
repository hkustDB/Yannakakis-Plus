create or replace view aggView3838421984480747589 as select id as v9, name as v57 from company_name as cn where country_code<> '[us]';
create or replace view aggJoin4864831434332594500 as select movie_id as v45, company_type_id as v16, note as v31, v57 from movie_companies as mc, aggView3838421984480747589 where mc.company_id=aggView3838421984480747589.v9 and note NOT LIKE '%(USA)%' and note LIKE '%(200%)%';
create or replace view aggView1497558740132181314 as select id as v7 from comp_cast_type as cct2 where kind<> 'complete+verified';
create or replace view aggJoin4513092398007690685 as select movie_id as v45, subject_id as v5 from complete_cast as cc, aggView1497558740132181314 where cc.status_id=aggView1497558740132181314.v7;
create or replace view aggView7494148921022675274 as select id as v20 from info_type as it2 where info= 'rating';
create or replace view aggJoin9029730715020119323 as select movie_id as v45, info as v40 from movie_info_idx as mi_idx, aggView7494148921022675274 where mi_idx.info_type_id=aggView7494148921022675274.v20 and info<'8.5';
create or replace view aggView5679920553979874299 as select id as v25 from kind_type as kt where kind IN ('movie','episode');
create or replace view aggJoin9145836252967955479 as select id as v45, title as v46 from title as t, aggView5679920553979874299 where t.kind_id=aggView5679920553979874299.v25 and production_year>2000;
create or replace view aggView171963916681041455 as select id as v16 from company_type as ct;
create or replace view aggJoin4633371760305063984 as select v45, v57 from aggJoin4864831434332594500 join aggView171963916681041455 using(v16);
create or replace view aggView5330071301390831125 as select v45, MIN(v57) as v57 from aggJoin4633371760305063984 group by v45;
create or replace view aggJoin8322382790999549029 as select movie_id as v45, keyword_id as v22, v57 from movie_keyword as mk, aggView5330071301390831125 where mk.movie_id=aggView5330071301390831125.v45;
create or replace view aggView6498600577372203979 as select id as v22 from keyword as k where keyword IN ('murder','murder-in-title','blood','violence');
create or replace view aggJoin6601478276896786165 as select v45, v57 from aggJoin8322382790999549029 join aggView6498600577372203979 using(v22);
create or replace view aggView3386729345480890243 as select v45, MIN(v57) as v57 from aggJoin6601478276896786165 group by v45;
create or replace view aggJoin888568232294618759 as select v45, v46, v57 from aggJoin9145836252967955479 join aggView3386729345480890243 using(v45);
create or replace view aggView4912598865245218685 as select v45, MIN(v57) as v57, MIN(v46) as v59 from aggJoin888568232294618759 group by v45;
create or replace view aggJoin1102273633531271832 as select movie_id as v45, info_type_id as v18, v57, v59 from movie_info as mi, aggView4912598865245218685 where mi.movie_id=aggView4912598865245218685.v45 and info IN ('Sweden','Norway','Germany','Denmark','Swedish','Danish','Norwegian','German','USA','American');
create or replace view aggView6255436714132684228 as select id as v18 from info_type as it1 where info= 'countries';
create or replace view aggJoin6582068964352957033 as select v45, v57, v59 from aggJoin1102273633531271832 join aggView6255436714132684228 using(v18);
create or replace view aggView499457977329491336 as select v45, MIN(v57) as v57, MIN(v59) as v59 from aggJoin6582068964352957033 group by v45;
create or replace view aggJoin6186134879869062959 as select v45, v40, v57, v59 from aggJoin9029730715020119323 join aggView499457977329491336 using(v45);
create or replace view aggView6022878557242031842 as select v45, MIN(v57) as v57, MIN(v59) as v59, MIN(v40) as v58 from aggJoin6186134879869062959 group by v45;
create or replace view aggJoin6474005074824255654 as select v5, v57, v59, v58 from aggJoin4513092398007690685 join aggView6022878557242031842 using(v45);
create or replace view aggView349175131710327292 as select v5, MIN(v57) as v57, MIN(v59) as v59, MIN(v58) as v58 from aggJoin6474005074824255654 group by v5;
create or replace view aggJoin4817883321319914094 as select v57, v59, v58 from comp_cast_type as cct1, aggView349175131710327292 where cct1.id=aggView349175131710327292.v5 and kind= 'crew';
create or replace view res as select MIN(v57) as v57, MIN(v58) as v58, MIN(v59) as v59 from aggJoin4817883321319914094;
select sum(v57+v58+v59) from res;