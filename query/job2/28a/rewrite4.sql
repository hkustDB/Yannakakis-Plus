create or replace view aggView8227370999899526268 as select id as v9, name as v57 from company_name as cn where country_code<> '[us]';
create or replace view aggJoin3456992777670583125 as select movie_id as v45, company_type_id as v16, note as v31, v57 from movie_companies as mc, aggView8227370999899526268 where mc.company_id=aggView8227370999899526268.v9 and note NOT LIKE '%(USA)%' and note LIKE '%(200%)%';
create or replace view aggView6943978654176805667 as select id as v7 from comp_cast_type as cct2 where kind<> 'complete+verified';
create or replace view aggJoin7025460304398317545 as select movie_id as v45, subject_id as v5 from complete_cast as cc, aggView6943978654176805667 where cc.status_id=aggView6943978654176805667.v7;
create or replace view aggView8112244451791160019 as select id as v20 from info_type as it2 where info= 'rating';
create or replace view aggJoin4102305051106489378 as select movie_id as v45, info as v40 from movie_info_idx as mi_idx, aggView8112244451791160019 where mi_idx.info_type_id=aggView8112244451791160019.v20 and info<'8.5';
create or replace view aggView5644479870318721343 as select id as v25 from kind_type as kt where kind IN ('movie','episode');
create or replace view aggJoin3286252918877996951 as select id as v45, title as v46 from title as t, aggView5644479870318721343 where t.kind_id=aggView5644479870318721343.v25 and production_year>2000;
create or replace view aggView6370617223025069472 as select id as v16 from company_type as ct;
create or replace view aggJoin1503524227532842289 as select v45, v57 from aggJoin3456992777670583125 join aggView6370617223025069472 using(v16);
create or replace view aggView8760391409970062793 as select id as v18 from info_type as it1 where info= 'countries';
create or replace view aggJoin1751191004893225440 as select movie_id as v45 from movie_info as mi, aggView8760391409970062793 where mi.info_type_id=aggView8760391409970062793.v18 and info IN ('Sweden','Norway','Germany','Denmark','Swedish','Danish','Norwegian','German','USA','American');
create or replace view aggView6655338705603623844 as select id as v22 from keyword as k where keyword IN ('murder','murder-in-title','blood','violence');
create or replace view aggJoin1073604960280529521 as select movie_id as v45 from movie_keyword as mk, aggView6655338705603623844 where mk.keyword_id=aggView6655338705603623844.v22;
create or replace view aggView7319600268206475142 as select v45, MIN(v57) as v57 from aggJoin1503524227532842289 group by v45;
create or replace view aggJoin7665709942701011937 as select v45, v57 from aggJoin1751191004893225440 join aggView7319600268206475142 using(v45);
create or replace view aggView8136549865383433233 as select v45, MIN(v57) as v57 from aggJoin7665709942701011937 group by v45;
create or replace view aggJoin6692547144620083010 as select v45, v46, v57 from aggJoin3286252918877996951 join aggView8136549865383433233 using(v45);
create or replace view aggView1894414634323871191 as select v45, MIN(v57) as v57, MIN(v46) as v59 from aggJoin6692547144620083010 group by v45;
create or replace view aggJoin4609008351188388581 as select v45, v40, v57, v59 from aggJoin4102305051106489378 join aggView1894414634323871191 using(v45);
create or replace view aggView2288313772545623847 as select v45, MIN(v57) as v57, MIN(v59) as v59, MIN(v40) as v58 from aggJoin4609008351188388581 group by v45;
create or replace view aggJoin3984336229648062519 as select v45, v57, v59, v58 from aggJoin1073604960280529521 join aggView2288313772545623847 using(v45);
create or replace view aggView8270650403762251063 as select v45, MIN(v57) as v57, MIN(v59) as v59, MIN(v58) as v58 from aggJoin3984336229648062519 group by v45;
create or replace view aggJoin5982049544977307074 as select v5, v57, v59, v58 from aggJoin7025460304398317545 join aggView8270650403762251063 using(v45);
create or replace view aggView2289560958051927994 as select v5, MIN(v57) as v57, MIN(v59) as v59, MIN(v58) as v58 from aggJoin5982049544977307074 group by v5;
create or replace view aggJoin1630956146737617808 as select v57, v59, v58 from comp_cast_type as cct1, aggView2289560958051927994 where cct1.id=aggView2289560958051927994.v5 and kind= 'crew';
create or replace view res as select MIN(v57) as v57, MIN(v58) as v58, MIN(v59) as v59 from aggJoin1630956146737617808;
select sum(v57+v58+v59) from res;