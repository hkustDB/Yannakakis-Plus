create or replace view aggView1559547738045229798 as select id as v9, name as v57 from company_name as cn where country_code<> '[us]';
create or replace view aggJoin4783981512536091777 as select movie_id as v45, company_type_id as v16, note as v31, v57 from movie_companies as mc, aggView1559547738045229798 where mc.company_id=aggView1559547738045229798.v9 and note NOT LIKE '%(USA)%' and note LIKE '%(200%)%';
create or replace view aggView782242564804868333 as select id as v7 from comp_cast_type as cct2 where kind<> 'complete+verified';
create or replace view aggJoin3122206753478056934 as select movie_id as v45, subject_id as v5 from complete_cast as cc, aggView782242564804868333 where cc.status_id=aggView782242564804868333.v7;
create or replace view aggView5894805538436016524 as select id as v25 from kind_type as kt where kind IN ('movie','episode');
create or replace view aggJoin5714661856411603359 as select id as v45, title as v46 from title as t, aggView5894805538436016524 where t.kind_id=aggView5894805538436016524.v25 and production_year>2000;
create or replace view aggView5788339209004406872 as select id as v16 from company_type as ct;
create or replace view aggJoin3744696048998363989 as select v45, v57 from aggJoin4783981512536091777 join aggView5788339209004406872 using(v16);
create or replace view aggView5530147209648302219 as select id as v5 from comp_cast_type as cct1 where kind= 'crew';
create or replace view aggJoin2706616483578985196 as select v45 from aggJoin3122206753478056934 join aggView5530147209648302219 using(v5);
create or replace view aggView2938108944067758305 as select v45 from aggJoin2706616483578985196 group by v45;
create or replace view aggJoin7677398776862585992 as select movie_id as v45, info_type_id as v18 from movie_info as mi, aggView2938108944067758305 where mi.movie_id=aggView2938108944067758305.v45 and info IN ('Sweden','Norway','Germany','Denmark','Swedish','Danish','Norwegian','German','USA','American');
create or replace view aggView7740847155092781739 as select v45, MIN(v57) as v57 from aggJoin3744696048998363989 group by v45;
create or replace view aggJoin2359482181655622195 as select movie_id as v45, info_type_id as v20, info as v40, v57 from movie_info_idx as mi_idx, aggView7740847155092781739 where mi_idx.movie_id=aggView7740847155092781739.v45 and info<'8.5';
create or replace view aggView1956882907335196094 as select id as v18 from info_type as it1 where info= 'countries';
create or replace view aggJoin4485774771049984751 as select v45 from aggJoin7677398776862585992 join aggView1956882907335196094 using(v18);
create or replace view aggView614343855393391684 as select id as v22 from keyword as k where keyword IN ('murder','murder-in-title','blood','violence');
create or replace view aggJoin7751658049201266560 as select movie_id as v45 from movie_keyword as mk, aggView614343855393391684 where mk.keyword_id=aggView614343855393391684.v22;
create or replace view aggView3940783312209780927 as select v45 from aggJoin4485774771049984751 group by v45;
create or replace view aggJoin5839491733213351081 as select v45, v46 from aggJoin5714661856411603359 join aggView3940783312209780927 using(v45);
create or replace view aggView5864564831638083926 as select v45, MIN(v46) as v59 from aggJoin5839491733213351081 group by v45;
create or replace view aggJoin7778602869179995192 as select v45, v59 from aggJoin7751658049201266560 join aggView5864564831638083926 using(v45);
create or replace view aggView1934702676570823324 as select v45, MIN(v59) as v59 from aggJoin7778602869179995192 group by v45;
create or replace view aggJoin4420814942112888861 as select v20, v40, v57 as v57, v59 from aggJoin2359482181655622195 join aggView1934702676570823324 using(v45);
create or replace view aggView1584085753207776466 as select v20, MIN(v57) as v57, MIN(v59) as v59, MIN(v40) as v58 from aggJoin4420814942112888861 group by v20;
create or replace view aggJoin5310931779888437370 as select v57, v59, v58 from info_type as it2, aggView1584085753207776466 where it2.id=aggView1584085753207776466.v20 and info= 'rating';
create or replace view res as select MIN(v57) as v57, MIN(v58) as v58, MIN(v59) as v59 from aggJoin5310931779888437370;
select sum(v57+v58+v59) from res;