create or replace view aggView2834346061476094955 as select id as v9, name as v57 from company_name as cn where country_code<> '[us]';
create or replace view aggJoin8647184240052253617 as select movie_id as v45, company_type_id as v16, note as v31, v57 from movie_companies as mc, aggView2834346061476094955 where mc.company_id=aggView2834346061476094955.v9 and note NOT LIKE '%(USA)%' and note LIKE '%(200%)%';
create or replace view aggView8031992989590665914 as select id as v7 from comp_cast_type as cct2 where kind<> 'complete+verified';
create or replace view aggJoin6580304791592790637 as select movie_id as v45, subject_id as v5 from complete_cast as cc, aggView8031992989590665914 where cc.status_id=aggView8031992989590665914.v7;
create or replace view aggView6905932974076281498 as select id as v20 from info_type as it2 where info= 'rating';
create or replace view aggJoin230337985907688998 as select movie_id as v45, info as v40 from movie_info_idx as mi_idx, aggView6905932974076281498 where mi_idx.info_type_id=aggView6905932974076281498.v20 and info<'8.5';
create or replace view aggView215836336928518436 as select id as v25 from kind_type as kt where kind IN ('movie','episode');
create or replace view aggJoin1952867327008007847 as select id as v45, title as v46 from title as t, aggView215836336928518436 where t.kind_id=aggView215836336928518436.v25 and production_year>2000;
create or replace view aggView9195736531692630271 as select id as v16 from company_type as ct;
create or replace view aggJoin566040228337984261 as select v45, v57 from aggJoin8647184240052253617 join aggView9195736531692630271 using(v16);
create or replace view aggView1567229615635735461 as select id as v18 from info_type as it1 where info= 'countries';
create or replace view aggJoin6656948999463231710 as select movie_id as v45 from movie_info as mi, aggView1567229615635735461 where mi.info_type_id=aggView1567229615635735461.v18 and info IN ('Sweden','Norway','Germany','Denmark','Swedish','Danish','Norwegian','German','USA','American');
create or replace view aggView6982961185179288258 as select id as v22 from keyword as k where keyword IN ('murder','murder-in-title','blood','violence');
create or replace view aggJoin3836853837600827936 as select movie_id as v45 from movie_keyword as mk, aggView6982961185179288258 where mk.keyword_id=aggView6982961185179288258.v22;
create or replace view aggView4199604331544877529 as select v45, MIN(v57) as v57 from aggJoin566040228337984261 group by v45;
create or replace view aggJoin8489904550748526610 as select v45, v57 from aggJoin6656948999463231710 join aggView4199604331544877529 using(v45);
create or replace view aggView3104942624897266474 as select v45, MIN(v57) as v57 from aggJoin8489904550748526610 group by v45;
create or replace view aggJoin7779250482434983854 as select v45, v40, v57 from aggJoin230337985907688998 join aggView3104942624897266474 using(v45);
create or replace view aggView1177186214034950788 as select v45, MIN(v57) as v57, MIN(v40) as v58 from aggJoin7779250482434983854 group by v45;
create or replace view aggJoin3847410585081624329 as select v45, v46, v57, v58 from aggJoin1952867327008007847 join aggView1177186214034950788 using(v45);
create or replace view aggView6543637930436244783 as select v45, MIN(v57) as v57, MIN(v58) as v58, MIN(v46) as v59 from aggJoin3847410585081624329 group by v45;
create or replace view aggJoin3005388198071953107 as select v45, v57, v58, v59 from aggJoin3836853837600827936 join aggView6543637930436244783 using(v45);
create or replace view aggView2792934068373203991 as select v45, MIN(v57) as v57, MIN(v58) as v58, MIN(v59) as v59 from aggJoin3005388198071953107 group by v45;
create or replace view aggJoin3867694322589236065 as select v5, v57, v58, v59 from aggJoin6580304791592790637 join aggView2792934068373203991 using(v45);
create or replace view aggView5563149771435622786 as select v5, MIN(v57) as v57, MIN(v58) as v58, MIN(v59) as v59 from aggJoin3867694322589236065 group by v5;
create or replace view aggJoin4884841899196298979 as select v57, v58, v59 from comp_cast_type as cct1, aggView5563149771435622786 where cct1.id=aggView5563149771435622786.v5 and kind= 'crew';
create or replace view res as select MIN(v57) as v57, MIN(v58) as v58, MIN(v59) as v59 from aggJoin4884841899196298979;
select sum(v57+v58+v59) from res;