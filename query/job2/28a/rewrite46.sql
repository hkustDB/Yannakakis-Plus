create or replace view aggView1253002825665297211 as select id as v9, name as v57 from company_name as cn where country_code<> '[us]';
create or replace view aggJoin2654584091050553586 as select movie_id as v45, company_type_id as v16, note as v31, v57 from movie_companies as mc, aggView1253002825665297211 where mc.company_id=aggView1253002825665297211.v9 and note NOT LIKE '%(USA)%' and note LIKE '%(200%)%';
create or replace view aggView7585220995246312913 as select id as v7 from comp_cast_type as cct2 where kind<> 'complete+verified';
create or replace view aggJoin8999360411525929402 as select movie_id as v45, subject_id as v5 from complete_cast as cc, aggView7585220995246312913 where cc.status_id=aggView7585220995246312913.v7;
create or replace view aggView7176637502116378931 as select id as v20 from info_type as it2 where info= 'rating';
create or replace view aggJoin8007726016875211763 as select movie_id as v45, info as v40 from movie_info_idx as mi_idx, aggView7176637502116378931 where mi_idx.info_type_id=aggView7176637502116378931.v20 and info<'8.5';
create or replace view aggView4093829476088563664 as select id as v25 from kind_type as kt where kind IN ('movie','episode');
create or replace view aggJoin4295737877936585462 as select id as v45, title as v46 from title as t, aggView4093829476088563664 where t.kind_id=aggView4093829476088563664.v25 and production_year>2000;
create or replace view aggView1957381084233944990 as select id as v16 from company_type as ct;
create or replace view aggJoin1814241859952332103 as select v45, v57 from aggJoin2654584091050553586 join aggView1957381084233944990 using(v16);
create or replace view aggView7127595363452990193 as select id as v5 from comp_cast_type as cct1 where kind= 'crew';
create or replace view aggJoin3911890438979470668 as select v45 from aggJoin8999360411525929402 join aggView7127595363452990193 using(v5);
create or replace view aggView7340173151359328626 as select v45 from aggJoin3911890438979470668 group by v45;
create or replace view aggJoin6443678358748975673 as select v45, v46 from aggJoin4295737877936585462 join aggView7340173151359328626 using(v45);
create or replace view aggView952013542281930687 as select v45, MIN(v46) as v59 from aggJoin6443678358748975673 group by v45;
create or replace view aggJoin7902110845900823380 as select movie_id as v45, keyword_id as v22, v59 from movie_keyword as mk, aggView952013542281930687 where mk.movie_id=aggView952013542281930687.v45;
create or replace view aggView2395977910424525192 as select id as v18 from info_type as it1 where info= 'countries';
create or replace view aggJoin278457626827593997 as select movie_id as v45 from movie_info as mi, aggView2395977910424525192 where mi.info_type_id=aggView2395977910424525192.v18 and info IN ('Sweden','Norway','Germany','Denmark','Swedish','Danish','Norwegian','German','USA','American');
create or replace view aggView7892506905338832077 as select v45, MIN(v57) as v57 from aggJoin1814241859952332103 group by v45;
create or replace view aggJoin586650770598947428 as select v45, v57 from aggJoin278457626827593997 join aggView7892506905338832077 using(v45);
create or replace view aggView7543805224137651439 as select v45, MIN(v57) as v57 from aggJoin586650770598947428 group by v45;
create or replace view aggJoin2810266387221832833 as select v45, v40, v57 from aggJoin8007726016875211763 join aggView7543805224137651439 using(v45);
create or replace view aggView470406223241433206 as select v45, MIN(v57) as v57, MIN(v40) as v58 from aggJoin2810266387221832833 group by v45;
create or replace view aggJoin336841490939810434 as select v22, v59 as v59, v57, v58 from aggJoin7902110845900823380 join aggView470406223241433206 using(v45);
create or replace view aggView1148215301905500732 as select v22, MIN(v59) as v59, MIN(v57) as v57, MIN(v58) as v58 from aggJoin336841490939810434 group by v22;
create or replace view aggJoin7513466214778831138 as select v59, v57, v58 from keyword as k, aggView1148215301905500732 where k.id=aggView1148215301905500732.v22 and keyword IN ('murder','murder-in-title','blood','violence');
create or replace view res as select MIN(v57) as v57, MIN(v58) as v58, MIN(v59) as v59 from aggJoin7513466214778831138;
select sum(v57+v58+v59) from res;