create or replace view aggView2110460096925065265 as select id as v9, name as v57 from company_name as cn where country_code<> '[us]';
create or replace view aggJoin4255633495810634291 as select movie_id as v45, company_type_id as v16, note as v31, v57 from movie_companies as mc, aggView2110460096925065265 where mc.company_id=aggView2110460096925065265.v9 and note NOT LIKE '%(USA)%' and note LIKE '%(200%)%';
create or replace view aggView3507430022844608509 as select id as v7 from comp_cast_type as cct2 where kind<> 'complete+verified';
create or replace view aggJoin3760467265363189462 as select movie_id as v45, subject_id as v5 from complete_cast as cc, aggView3507430022844608509 where cc.status_id=aggView3507430022844608509.v7;
create or replace view aggView6901877563149988301 as select id as v20 from info_type as it2 where info= 'rating';
create or replace view aggJoin4918345903983135230 as select movie_id as v45, info as v40 from movie_info_idx as mi_idx, aggView6901877563149988301 where mi_idx.info_type_id=aggView6901877563149988301.v20 and info<'8.5';
create or replace view aggView6914948331391109848 as select id as v16 from company_type as ct;
create or replace view aggJoin7136973613306065864 as select v45, v57 from aggJoin4255633495810634291 join aggView6914948331391109848 using(v16);
create or replace view aggView1098473533336664819 as select v45, MIN(v57) as v57 from aggJoin7136973613306065864 group by v45;
create or replace view aggJoin5553301947168850765 as select id as v45, title as v46, kind_id as v25, v57 from title as t, aggView1098473533336664819 where t.id=aggView1098473533336664819.v45 and production_year>2000;
create or replace view aggView9023700158665619086 as select id as v5 from comp_cast_type as cct1 where kind= 'crew';
create or replace view aggJoin2783578274076357611 as select v45 from aggJoin3760467265363189462 join aggView9023700158665619086 using(v5);
create or replace view aggView5864047200298360021 as select id as v18 from info_type as it1 where info= 'countries';
create or replace view aggJoin8022374907127199973 as select movie_id as v45 from movie_info as mi, aggView5864047200298360021 where mi.info_type_id=aggView5864047200298360021.v18 and info IN ('Sweden','Norway','Germany','Denmark','Swedish','Danish','Norwegian','German','USA','American');
create or replace view aggView5255483747945922644 as select id as v22 from keyword as k where keyword IN ('murder','murder-in-title','blood','violence');
create or replace view aggJoin7630390076397496062 as select movie_id as v45 from movie_keyword as mk, aggView5255483747945922644 where mk.keyword_id=aggView5255483747945922644.v22;
create or replace view aggView6794566681176899432 as select v45 from aggJoin2783578274076357611 group by v45;
create or replace view aggJoin4403498476176223965 as select v45, v40 from aggJoin4918345903983135230 join aggView6794566681176899432 using(v45);
create or replace view aggView1109140010915853765 as select v45, MIN(v40) as v58 from aggJoin4403498476176223965 group by v45;
create or replace view aggJoin1532667591700867790 as select v45, v58 from aggJoin8022374907127199973 join aggView1109140010915853765 using(v45);
create or replace view aggView7871363796432719315 as select v45, MIN(v58) as v58 from aggJoin1532667591700867790 group by v45;
create or replace view aggJoin6729452629493897621 as select v45, v58 from aggJoin7630390076397496062 join aggView7871363796432719315 using(v45);
create or replace view aggView3165990312447376631 as select v45, MIN(v58) as v58 from aggJoin6729452629493897621 group by v45;
create or replace view aggJoin824659018932390706 as select v46, v25, v57 as v57, v58 from aggJoin5553301947168850765 join aggView3165990312447376631 using(v45);
create or replace view aggView5045474499075783886 as select v25, MIN(v57) as v57, MIN(v58) as v58, MIN(v46) as v59 from aggJoin824659018932390706 group by v25;
create or replace view aggJoin3265790982898465903 as select v57, v58, v59 from kind_type as kt, aggView5045474499075783886 where kt.id=aggView5045474499075783886.v25 and kind IN ('movie','episode');
create or replace view res as select MIN(v57) as v57, MIN(v58) as v58, MIN(v59) as v59 from aggJoin3265790982898465903;
select sum(v57+v58+v59) from res;