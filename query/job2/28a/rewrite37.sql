create or replace view aggView6330085556427305209 as select id as v9, name as v57 from company_name as cn where country_code<> '[us]';
create or replace view aggJoin5583130057463099249 as select movie_id as v45, company_type_id as v16, note as v31, v57 from movie_companies as mc, aggView6330085556427305209 where mc.company_id=aggView6330085556427305209.v9 and note NOT LIKE '%(USA)%' and note LIKE '%(200%)%';
create or replace view aggView1296592075162101337 as select id as v7 from comp_cast_type as cct2 where kind<> 'complete+verified';
create or replace view aggJoin3376925776263751170 as select movie_id as v45, subject_id as v5 from complete_cast as cc, aggView1296592075162101337 where cc.status_id=aggView1296592075162101337.v7;
create or replace view aggView2537593272328488497 as select id as v20 from info_type as it2 where info= 'rating';
create or replace view aggJoin2889283764711253975 as select movie_id as v45, info as v40 from movie_info_idx as mi_idx, aggView2537593272328488497 where mi_idx.info_type_id=aggView2537593272328488497.v20 and info<'8.5';
create or replace view aggView1546558272722127735 as select id as v16 from company_type as ct;
create or replace view aggJoin1108351928085941776 as select v45, v57 from aggJoin5583130057463099249 join aggView1546558272722127735 using(v16);
create or replace view aggView3740990322916950984 as select id as v5 from comp_cast_type as cct1 where kind= 'crew';
create or replace view aggJoin5278474041811629864 as select v45 from aggJoin3376925776263751170 join aggView3740990322916950984 using(v5);
create or replace view aggView1051075823740546810 as select id as v18 from info_type as it1 where info= 'countries';
create or replace view aggJoin2699334453751508371 as select movie_id as v45 from movie_info as mi, aggView1051075823740546810 where mi.info_type_id=aggView1051075823740546810.v18 and info IN ('Sweden','Norway','Germany','Denmark','Swedish','Danish','Norwegian','German','USA','American');
create or replace view aggView4824234879035909057 as select id as v22 from keyword as k where keyword IN ('murder','murder-in-title','blood','violence');
create or replace view aggJoin2615155028068104459 as select movie_id as v45 from movie_keyword as mk, aggView4824234879035909057 where mk.keyword_id=aggView4824234879035909057.v22;
create or replace view aggView8101332235034992974 as select v45 from aggJoin5278474041811629864 group by v45;
create or replace view aggJoin4378124506097598015 as select v45, v40 from aggJoin2889283764711253975 join aggView8101332235034992974 using(v45);
create or replace view aggView7786655788816039504 as select v45, MIN(v40) as v58 from aggJoin4378124506097598015 group by v45;
create or replace view aggJoin5774647106047748651 as select id as v45, title as v46, kind_id as v25, v58 from title as t, aggView7786655788816039504 where t.id=aggView7786655788816039504.v45 and production_year>2000;
create or replace view aggView8373660596161732946 as select v45, MIN(v57) as v57 from aggJoin1108351928085941776 group by v45;
create or replace view aggJoin5893816985582647025 as select v45, v57 from aggJoin2699334453751508371 join aggView8373660596161732946 using(v45);
create or replace view aggView3762745914232885601 as select v45, MIN(v57) as v57 from aggJoin5893816985582647025 group by v45;
create or replace view aggJoin5592038969798990443 as select v45, v57 from aggJoin2615155028068104459 join aggView3762745914232885601 using(v45);
create or replace view aggView5468679800615378599 as select v45, MIN(v57) as v57 from aggJoin5592038969798990443 group by v45;
create or replace view aggJoin5071102011154683010 as select v46, v25, v58 as v58, v57 from aggJoin5774647106047748651 join aggView5468679800615378599 using(v45);
create or replace view aggView6987059572906421192 as select v25, MIN(v58) as v58, MIN(v57) as v57, MIN(v46) as v59 from aggJoin5071102011154683010 group by v25;
create or replace view aggJoin7829675412068698295 as select v58, v57, v59 from kind_type as kt, aggView6987059572906421192 where kt.id=aggView6987059572906421192.v25 and kind IN ('movie','episode');
create or replace view res as select MIN(v57) as v57, MIN(v58) as v58, MIN(v59) as v59 from aggJoin7829675412068698295;
select sum(v57+v58+v59) from res;