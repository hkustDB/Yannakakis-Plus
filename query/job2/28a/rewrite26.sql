create or replace view aggView7021910870021987597 as select id as v9, name as v57 from company_name as cn where country_code<> '[us]';
create or replace view aggJoin2014466057778469299 as select movie_id as v45, company_type_id as v16, note as v31, v57 from movie_companies as mc, aggView7021910870021987597 where mc.company_id=aggView7021910870021987597.v9 and note NOT LIKE '%(USA)%' and note LIKE '%(200%)%';
create or replace view aggView710959550211635604 as select id as v7 from comp_cast_type as cct2 where kind<> 'complete+verified';
create or replace view aggJoin3162687659773474628 as select movie_id as v45, subject_id as v5 from complete_cast as cc, aggView710959550211635604 where cc.status_id=aggView710959550211635604.v7;
create or replace view aggView4209064622128369108 as select id as v20 from info_type as it2 where info= 'rating';
create or replace view aggJoin6352510592772290559 as select movie_id as v45, info as v40 from movie_info_idx as mi_idx, aggView4209064622128369108 where mi_idx.info_type_id=aggView4209064622128369108.v20 and info<'8.5';
create or replace view aggView6204237238164422997 as select id as v25 from kind_type as kt where kind IN ('movie','episode');
create or replace view aggJoin8417766043864471080 as select id as v45, title as v46 from title as t, aggView6204237238164422997 where t.kind_id=aggView6204237238164422997.v25 and production_year>2000;
create or replace view aggView4623248480812058894 as select id as v16 from company_type as ct;
create or replace view aggJoin6504610401952752237 as select v45, v57 from aggJoin2014466057778469299 join aggView4623248480812058894 using(v16);
create or replace view aggView8424296097982603349 as select v45, MIN(v57) as v57 from aggJoin6504610401952752237 group by v45;
create or replace view aggJoin3480796792290970505 as select v45, v46, v57 from aggJoin8417766043864471080 join aggView8424296097982603349 using(v45);
create or replace view aggView2431198685955069324 as select v45, MIN(v57) as v57, MIN(v46) as v59 from aggJoin3480796792290970505 group by v45;
create or replace view aggJoin419457882875841191 as select v45, v40, v57, v59 from aggJoin6352510592772290559 join aggView2431198685955069324 using(v45);
create or replace view aggView5395627998950607888 as select v45, MIN(v57) as v57, MIN(v59) as v59, MIN(v40) as v58 from aggJoin419457882875841191 group by v45;
create or replace view aggJoin2245345856513191958 as select movie_id as v45, keyword_id as v22, v57, v59, v58 from movie_keyword as mk, aggView5395627998950607888 where mk.movie_id=aggView5395627998950607888.v45;
create or replace view aggView2231291688822558666 as select id as v22 from keyword as k where keyword IN ('murder','murder-in-title','blood','violence');
create or replace view aggJoin2135148670447001511 as select v45, v57, v59, v58 from aggJoin2245345856513191958 join aggView2231291688822558666 using(v22);
create or replace view aggView7294224895629267507 as select v45, MIN(v57) as v57, MIN(v59) as v59, MIN(v58) as v58 from aggJoin2135148670447001511 group by v45;
create or replace view aggJoin6626672377068506438 as select movie_id as v45, info_type_id as v18, v57, v59, v58 from movie_info as mi, aggView7294224895629267507 where mi.movie_id=aggView7294224895629267507.v45 and info IN ('Sweden','Norway','Germany','Denmark','Swedish','Danish','Norwegian','German','USA','American');
create or replace view aggView4877628070745291634 as select id as v18 from info_type as it1 where info= 'countries';
create or replace view aggJoin181138258968386432 as select v45, v57, v59, v58 from aggJoin6626672377068506438 join aggView4877628070745291634 using(v18);
create or replace view aggView3619213463321856566 as select v45, MIN(v57) as v57, MIN(v59) as v59, MIN(v58) as v58 from aggJoin181138258968386432 group by v45;
create or replace view aggJoin8384719456603749177 as select v5, v57, v59, v58 from aggJoin3162687659773474628 join aggView3619213463321856566 using(v45);
create or replace view aggView7943694099444283076 as select v5, MIN(v57) as v57, MIN(v59) as v59, MIN(v58) as v58 from aggJoin8384719456603749177 group by v5;
create or replace view aggJoin2844187716256366270 as select v57, v59, v58 from comp_cast_type as cct1, aggView7943694099444283076 where cct1.id=aggView7943694099444283076.v5 and kind= 'crew';
create or replace view res as select MIN(v57) as v57, MIN(v58) as v58, MIN(v59) as v59 from aggJoin2844187716256366270;
select sum(v57+v58+v59) from res;