create or replace view aggView5685381749584125719 as select id as v9, name as v57 from company_name as cn where country_code<> '[us]';
create or replace view aggJoin2688288555236481605 as select movie_id as v45, company_type_id as v16, note as v31, v57 from movie_companies as mc, aggView5685381749584125719 where mc.company_id=aggView5685381749584125719.v9 and note NOT LIKE '%(USA)%' and note LIKE '%(200%)%';
create or replace view aggView8622018533148514372 as select id as v20 from info_type as it2 where info= 'rating';
create or replace view aggJoin223631062153873825 as select movie_id as v45, info as v40 from movie_info_idx as mi_idx, aggView8622018533148514372 where mi_idx.info_type_id=aggView8622018533148514372.v20 and info<'8.5';
create or replace view aggView8586942636261384750 as select id as v25 from kind_type as kt where kind IN ('movie','episode');
create or replace view aggJoin1450453913923864073 as select id as v45, title as v46 from title as t, aggView8586942636261384750 where t.kind_id=aggView8586942636261384750.v25 and production_year>2000;
create or replace view aggView6909209863207436123 as select id as v16 from company_type as ct;
create or replace view aggJoin9066724322302656489 as select v45, v57 from aggJoin2688288555236481605 join aggView6909209863207436123 using(v16);
create or replace view aggView7487389668372106574 as select id as v5 from comp_cast_type as cct1 where kind= 'crew';
create or replace view aggJoin2792885242415616150 as select movie_id as v45, status_id as v7 from complete_cast as cc, aggView7487389668372106574 where cc.subject_id=aggView7487389668372106574.v5;
create or replace view aggView1940326857731551474 as select v45, MIN(v57) as v57 from aggJoin9066724322302656489 group by v45;
create or replace view aggJoin8574089349295214056 as select v45, v40, v57 from aggJoin223631062153873825 join aggView1940326857731551474 using(v45);
create or replace view aggView2772345886245635420 as select v45, MIN(v57) as v57, MIN(v40) as v58 from aggJoin8574089349295214056 group by v45;
create or replace view aggJoin5582141927847939832 as select movie_id as v45, info_type_id as v18, v57, v58 from movie_info as mi, aggView2772345886245635420 where mi.movie_id=aggView2772345886245635420.v45 and info IN ('Sweden','Norway','Germany','Denmark','Swedish','Danish','Norwegian','German','USA','American');
create or replace view aggView118564803640185832 as select id as v18 from info_type as it1 where info= 'countries';
create or replace view aggJoin946447038041172113 as select v45, v57, v58 from aggJoin5582141927847939832 join aggView118564803640185832 using(v18);
create or replace view aggView9105447792329584452 as select id as v22 from keyword as k where keyword IN ('murder','murder-in-title','blood','violence');
create or replace view aggJoin3788124555878075716 as select movie_id as v45 from movie_keyword as mk, aggView9105447792329584452 where mk.keyword_id=aggView9105447792329584452.v22;
create or replace view aggView1753497128275771569 as select v45, MIN(v57) as v57, MIN(v58) as v58 from aggJoin946447038041172113 group by v45;
create or replace view aggJoin2466479550607140068 as select v45, v46, v57, v58 from aggJoin1450453913923864073 join aggView1753497128275771569 using(v45);
create or replace view aggView5997868212643753114 as select v45, MIN(v57) as v57, MIN(v58) as v58, MIN(v46) as v59 from aggJoin2466479550607140068 group by v45;
create or replace view aggJoin7969808716859782840 as select v45, v57, v58, v59 from aggJoin3788124555878075716 join aggView5997868212643753114 using(v45);
create or replace view aggView3268552481651967471 as select v45, MIN(v57) as v57, MIN(v58) as v58, MIN(v59) as v59 from aggJoin7969808716859782840 group by v45;
create or replace view aggJoin2926706150244156470 as select v7, v57, v58, v59 from aggJoin2792885242415616150 join aggView3268552481651967471 using(v45);
create or replace view aggView3568101489277091208 as select v7, MIN(v57) as v57, MIN(v58) as v58, MIN(v59) as v59 from aggJoin2926706150244156470 group by v7;
create or replace view aggJoin7725139078227126283 as select v57, v58, v59 from comp_cast_type as cct2, aggView3568101489277091208 where cct2.id=aggView3568101489277091208.v7 and kind<> 'complete+verified';
create or replace view res as select MIN(v57) as v57, MIN(v58) as v58, MIN(v59) as v59 from aggJoin7725139078227126283;
select sum(v57+v58+v59) from res;