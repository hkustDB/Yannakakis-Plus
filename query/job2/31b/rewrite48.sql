create or replace view aggView306029390681118899 as select id as v40, name as v63 from name as n where gender= 'm';
create or replace view aggJoin3852414846238614856 as select movie_id as v49, note as v5, v63 from cast_info as ci, aggView306029390681118899 where ci.person_id=aggView306029390681118899.v40 and note IN ('(writer)','(head writer)','(written by)','(story)','(story editor)');
create or replace view aggView8857339914361857908 as select id as v17 from info_type as it2 where info= 'votes';
create or replace view aggJoin3027997651753671847 as select movie_id as v49, info as v35 from movie_info_idx as mi_idx, aggView8857339914361857908 where mi_idx.info_type_id=aggView8857339914361857908.v17;
create or replace view aggView8835299648429490744 as select id as v8 from company_name as cn where name LIKE 'Lionsgate%';
create or replace view aggJoin7533068975052526538 as select movie_id as v49, note as v26 from movie_companies as mc, aggView8835299648429490744 where mc.company_id=aggView8835299648429490744.v8 and note LIKE '%(Blu-ray)%';
create or replace view aggView9218455784029997137 as select id as v19 from keyword as k where keyword IN ('murder','violence','blood','gore','death','female-nudity','hospital');
create or replace view aggJoin8447585772971034068 as select movie_id as v49 from movie_keyword as mk, aggView9218455784029997137 where mk.keyword_id=aggView9218455784029997137.v19;
create or replace view aggView4058018937119464656 as select v49 from aggJoin8447585772971034068 group by v49;
create or replace view aggJoin8644829073202598969 as select v49, v35 from aggJoin3027997651753671847 join aggView4058018937119464656 using(v49);
create or replace view aggView3528080571470924122 as select v49, MIN(v35) as v62 from aggJoin8644829073202598969 group by v49;
create or replace view aggJoin555248285687482377 as select id as v49, title as v50, production_year as v53, v62 from title as t, aggView3528080571470924122 where t.id=aggView3528080571470924122.v49 and production_year>2000 and ((title LIKE '%Freddy%') OR (title LIKE '%Jason%'));
create or replace view aggView2300373191542506078 as select v49 from aggJoin7533068975052526538 group by v49;
create or replace view aggJoin8284520927960617613 as select v49, v5, v63 as v63 from aggJoin3852414846238614856 join aggView2300373191542506078 using(v49);
create or replace view aggView5986034909361139612 as select v49, MIN(v63) as v63 from aggJoin8284520927960617613 group by v49;
create or replace view aggJoin8755729711064089174 as select v49, v50, v53, v62 as v62, v63 from aggJoin555248285687482377 join aggView5986034909361139612 using(v49);
create or replace view aggView4528380270497395234 as select v49, MIN(v62) as v62, MIN(v63) as v63, MIN(v50) as v64 from aggJoin8755729711064089174 group by v49;
create or replace view aggJoin4349803227891373811 as select info_type_id as v15, info as v30, v62, v63, v64 from movie_info as mi, aggView4528380270497395234 where mi.movie_id=aggView4528380270497395234.v49 and info IN ('Horror','Thriller');
create or replace view aggView1796051424916830431 as select v15, MIN(v62) as v62, MIN(v63) as v63, MIN(v64) as v64, MIN(v30) as v61 from aggJoin4349803227891373811 group by v15;
create or replace view aggJoin6108504463510662731 as select info as v16, v62, v63, v64, v61 from info_type as it1, aggView1796051424916830431 where it1.id=aggView1796051424916830431.v15 and info= 'genres';
create or replace view res as select MIN(v61) as v61, MIN(v62) as v62, MIN(v63) as v63, MIN(v64) as v64 from aggJoin6108504463510662731;
select sum(v61+v62+v63+v64) from res;