create or replace view aggView1501286259622617587 as select id as v15 from info_type as it1 where info= 'genres';
create or replace view aggJoin1143324678044673651 as select movie_id as v49, info as v30 from movie_info as mi, aggView1501286259622617587 where mi.info_type_id=aggView1501286259622617587.v15 and info IN ('Horror','Thriller');
create or replace view aggView264373424393169061 as select v49, MIN(v30) as v61 from aggJoin1143324678044673651 group by v49;
create or replace view aggJoin7637770440085308294 as select movie_id as v49, info_type_id as v17, info as v35, v61 from movie_info_idx as mi_idx, aggView264373424393169061 where mi_idx.movie_id=aggView264373424393169061.v49;
create or replace view aggView4275787616000089102 as select id as v17 from info_type as it2 where info= 'votes';
create or replace view aggJoin8451968152609959500 as select v49, v35, v61 from aggJoin7637770440085308294 join aggView4275787616000089102 using(v17);
create or replace view aggView7867532182024988669 as select v49, MIN(v61) as v61, MIN(v35) as v62 from aggJoin8451968152609959500 group by v49;
create or replace view aggJoin4105284385208977036 as select movie_id as v49, keyword_id as v19, v61, v62 from movie_keyword as mk, aggView7867532182024988669 where mk.movie_id=aggView7867532182024988669.v49;
create or replace view aggView8709731245046382459 as select id as v8 from company_name as cn where name LIKE 'Lionsgate%';
create or replace view aggJoin6788827703488894903 as select movie_id as v49, note as v26 from movie_companies as mc, aggView8709731245046382459 where mc.company_id=aggView8709731245046382459.v8 and note LIKE '%(Blu-ray)%';
create or replace view aggView7634299370040046378 as select v49 from aggJoin6788827703488894903 group by v49;
create or replace view aggJoin2328528808772843768 as select id as v49, title as v50, production_year as v53 from title as t, aggView7634299370040046378 where t.id=aggView7634299370040046378.v49 and production_year>2000 and ((title LIKE '%Freddy%') OR (title LIKE '%Jason%'));
create or replace view aggView9151738577830483092 as select v49, MIN(v50) as v64 from aggJoin2328528808772843768 group by v49;
create or replace view aggJoin6301790044826973477 as select person_id as v40, movie_id as v49, note as v5, v64 from cast_info as ci, aggView9151738577830483092 where ci.movie_id=aggView9151738577830483092.v49 and note IN ('(writer)','(head writer)','(written by)','(story)','(story editor)');
create or replace view aggView3946468106848760262 as select id as v19 from keyword as k where keyword IN ('murder','violence','blood','gore','death','female-nudity','hospital');
create or replace view aggJoin5739391681647014732 as select v49, v61, v62 from aggJoin4105284385208977036 join aggView3946468106848760262 using(v19);
create or replace view aggView8148840778838904670 as select v49, MIN(v61) as v61, MIN(v62) as v62 from aggJoin5739391681647014732 group by v49;
create or replace view aggJoin6914216648442618143 as select v40, v5, v64 as v64, v61, v62 from aggJoin6301790044826973477 join aggView8148840778838904670 using(v49);
create or replace view aggView662396057548059536 as select v40, MIN(v64) as v64, MIN(v61) as v61, MIN(v62) as v62 from aggJoin6914216648442618143 group by v40;
create or replace view aggJoin4643808153599374919 as select name as v41, gender as v44, v64, v61, v62 from name as n, aggView662396057548059536 where n.id=aggView662396057548059536.v40 and gender= 'm';
create or replace view res as select MIN(v61) as v61, MIN(v62) as v62, MIN(v41) as v63, MIN(v64) as v64 from aggJoin4643808153599374919;
select sum(v61+v62+v63+v64) from res;