create or replace view aggView7390755252264919441 as select id as v40, name as v63 from name as n where gender= 'm';
create or replace view aggJoin7844870346872342547 as select movie_id as v49, note as v5, v63 from cast_info as ci, aggView7390755252264919441 where ci.person_id=aggView7390755252264919441.v40 and note IN ('(writer)','(head writer)','(written by)','(story)','(story editor)');
create or replace view aggView4642272704501816881 as select id as v15 from info_type as it1 where info= 'genres';
create or replace view aggJoin4899775493637186648 as select movie_id as v49, info as v30 from movie_info as mi, aggView4642272704501816881 where mi.info_type_id=aggView4642272704501816881.v15 and info IN ('Horror','Thriller');
create or replace view aggView57248016288899705 as select v49, MIN(v30) as v61 from aggJoin4899775493637186648 group by v49;
create or replace view aggJoin5840742687844905427 as select movie_id as v49, keyword_id as v19, v61 from movie_keyword as mk, aggView57248016288899705 where mk.movie_id=aggView57248016288899705.v49;
create or replace view aggView2311346170665790806 as select id as v8 from company_name as cn where name LIKE 'Lionsgate%';
create or replace view aggJoin5401314207915249927 as select movie_id as v49, note as v26 from movie_companies as mc, aggView2311346170665790806 where mc.company_id=aggView2311346170665790806.v8 and note LIKE '%(Blu-ray)%';
create or replace view aggView7173525432493035689 as select id as v17 from info_type as it2 where info= 'votes';
create or replace view aggJoin2967192326069356613 as select movie_id as v49, info as v35 from movie_info_idx as mi_idx, aggView7173525432493035689 where mi_idx.info_type_id=aggView7173525432493035689.v17;
create or replace view aggView166992719026449969 as select id as v19 from keyword as k where keyword IN ('murder','violence','blood','gore','death','female-nudity','hospital');
create or replace view aggJoin3793044749406670671 as select v49, v61 from aggJoin5840742687844905427 join aggView166992719026449969 using(v19);
create or replace view aggView5992371098885972550 as select v49, MIN(v61) as v61 from aggJoin3793044749406670671 group by v49;
create or replace view aggJoin6117492600743166367 as select v49, v26, v61 from aggJoin5401314207915249927 join aggView5992371098885972550 using(v49);
create or replace view aggView7312831384850596177 as select v49, MIN(v61) as v61 from aggJoin6117492600743166367 group by v49;
create or replace view aggJoin4096841473636742625 as select v49, v5, v63 as v63, v61 from aggJoin7844870346872342547 join aggView7312831384850596177 using(v49);
create or replace view aggView6381219865098973015 as select v49, MIN(v63) as v63, MIN(v61) as v61 from aggJoin4096841473636742625 group by v49;
create or replace view aggJoin8761114639898524901 as select v49, v35, v63, v61 from aggJoin2967192326069356613 join aggView6381219865098973015 using(v49);
create or replace view aggView6751551933127451772 as select v49, MIN(v63) as v63, MIN(v61) as v61, MIN(v35) as v62 from aggJoin8761114639898524901 group by v49;
create or replace view aggJoin2857789867277104404 as select title as v50, production_year as v53, v63, v61, v62 from title as t, aggView6751551933127451772 where t.id=aggView6751551933127451772.v49 and production_year>2000 and ((title LIKE '%Freddy%') OR (title LIKE '%Jason%'));
create or replace view res as select MIN(v61) as v61, MIN(v62) as v62, MIN(v63) as v63, MIN(v50) as v64 from aggJoin2857789867277104404;
select sum(v61+v62+v63+v64) from res;