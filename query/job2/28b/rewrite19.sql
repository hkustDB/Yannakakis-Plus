create or replace view aggView2115082317610272695 as select id as v9, name as v10 from company_name as cn where country_code<> '[us]';
create or replace view aggView2063062213199041449 as select id as v20 from info_type as it2 where info= 'rating';
create or replace view aggJoin3233020605493822126 as select movie_id as v45, info as v40 from movie_info_idx as mi_idx, aggView2063062213199041449 where mi_idx.info_type_id=aggView2063062213199041449.v20;
create or replace view aggView4793173389929741525 as select v45, v40 from aggJoin3233020605493822126;
create or replace view aggJoin5515097993161036560 as select v45, v40 from aggView4793173389929741525 where v40>'6.5';
create or replace view aggView7562943005423459757 as select id as v25 from kind_type as kt where kind IN ('movie','episode');
create or replace view aggJoin4536863974168185500 as select id as v45, title as v46, production_year as v49 from title as t, aggView7562943005423459757 where t.kind_id=aggView7562943005423459757.v25 and production_year>2005;
create or replace view aggView2615773316010471800 as select v46, v45 from aggJoin4536863974168185500;
create or replace view aggView1592071351546915017 as select v9, MIN(v10) as v57 from aggView2115082317610272695 group by v9;
create or replace view aggJoin8875719539117898155 as select movie_id as v45, company_type_id as v16, note as v31, v57 from movie_companies as mc, aggView1592071351546915017 where mc.company_id=aggView1592071351546915017.v9 and note NOT LIKE '%(USA)%' and note LIKE '%(200%)%';
create or replace view aggView5361913255782042738 as select v45, MIN(v40) as v58 from aggJoin5515097993161036560 group by v45;
create or replace view aggJoin7937815950186142568 as select v45, v16, v31, v57 as v57, v58 from aggJoin8875719539117898155 join aggView5361913255782042738 using(v45);
create or replace view aggView6510002959301544 as select id as v5 from comp_cast_type as cct1 where kind= 'crew';
create or replace view aggJoin5490599269210885856 as select movie_id as v45, status_id as v7 from complete_cast as cc, aggView6510002959301544 where cc.subject_id=aggView6510002959301544.v5;
create or replace view aggView7035124913480408864 as select id as v16 from company_type as ct;
create or replace view aggJoin1678816810782212832 as select v45, v31, v57, v58 from aggJoin7937815950186142568 join aggView7035124913480408864 using(v16);
create or replace view aggView663491674878402623 as select id as v7 from comp_cast_type as cct2 where kind<> 'complete+verified';
create or replace view aggJoin5885086002091929396 as select v45 from aggJoin5490599269210885856 join aggView663491674878402623 using(v7);
create or replace view aggView35393268132634369 as select v45 from aggJoin5885086002091929396 group by v45;
create or replace view aggJoin4142598538234144747 as select v45, v31, v57 as v57, v58 as v58 from aggJoin1678816810782212832 join aggView35393268132634369 using(v45);
create or replace view aggView7286231864680969813 as select id as v18 from info_type as it1 where info= 'countries';
create or replace view aggJoin2684737895947624807 as select movie_id as v45, info as v35 from movie_info as mi, aggView7286231864680969813 where mi.info_type_id=aggView7286231864680969813.v18 and info IN ('Sweden','Germany','Swedish','German');
create or replace view aggView6880264302543811372 as select v45 from aggJoin2684737895947624807 group by v45;
create or replace view aggJoin2903081771307501120 as select v45, v31, v57 as v57, v58 as v58 from aggJoin4142598538234144747 join aggView6880264302543811372 using(v45);
create or replace view aggView9113147216935021407 as select id as v22 from keyword as k where keyword IN ('murder','murder-in-title','blood','violence');
create or replace view aggJoin160426729962431821 as select movie_id as v45 from movie_keyword as mk, aggView9113147216935021407 where mk.keyword_id=aggView9113147216935021407.v22;
create or replace view aggView955554771842012721 as select v45 from aggJoin160426729962431821 group by v45;
create or replace view aggJoin4757339739386258064 as select v45, v31, v57 as v57, v58 as v58 from aggJoin2903081771307501120 join aggView955554771842012721 using(v45);
create or replace view aggView2283151010293120680 as select v45, MIN(v57) as v57, MIN(v58) as v58 from aggJoin4757339739386258064 group by v45;
create or replace view aggJoin7878811216771240008 as select v46, v57, v58 from aggView2615773316010471800 join aggView2283151010293120680 using(v45);
select MIN(v57) as v57,MIN(v58) as v58,MIN(v46) as v59 from aggJoin7878811216771240008;
