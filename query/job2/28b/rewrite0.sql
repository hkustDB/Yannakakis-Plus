create or replace view aggView906364994472615000 as select id as v9, name as v10 from company_name as cn where country_code<> '[us]';
create or replace view aggView4633987861938079227 as select id as v20 from info_type as it2 where info= 'rating';
create or replace view aggJoin7323554737795015459 as select movie_id as v45, info as v40 from movie_info_idx as mi_idx, aggView4633987861938079227 where mi_idx.info_type_id=aggView4633987861938079227.v20;
create or replace view aggView6536598974800546300 as select id as v18 from info_type as it1 where info= 'countries';
create or replace view aggJoin257728601468487607 as select movie_id as v45, info as v35 from movie_info as mi, aggView6536598974800546300 where mi.info_type_id=aggView6536598974800546300.v18 and info IN ('Sweden','Germany','Swedish','German');
create or replace view aggView8570886260443666955 as select id as v25 from kind_type as kt where kind IN ('movie','episode');
create or replace view aggJoin3238939270340534258 as select id as v45, title as v46, production_year as v49 from title as t, aggView8570886260443666955 where t.kind_id=aggView8570886260443666955.v25 and production_year>2005;
create or replace view aggView2150613828057009555 as select v46, v45 from aggJoin3238939270340534258;
create or replace view aggView6929080465794295426 as select id as v5 from comp_cast_type as cct1 where kind= 'crew';
create or replace view aggJoin2823202414591217887 as select movie_id as v45, status_id as v7 from complete_cast as cc, aggView6929080465794295426 where cc.subject_id=aggView6929080465794295426.v5;
create or replace view aggView7116023488575138410 as select id as v7 from comp_cast_type as cct2 where kind<> 'complete+verified';
create or replace view aggJoin8773048175386943743 as select v45 from aggJoin2823202414591217887 join aggView7116023488575138410 using(v7);
create or replace view aggView8568276834873714581 as select id as v22 from keyword as k where keyword IN ('murder','murder-in-title','blood','violence');
create or replace view aggJoin4734577270248961759 as select movie_id as v45 from movie_keyword as mk, aggView8568276834873714581 where mk.keyword_id=aggView8568276834873714581.v22;
create or replace view aggView1028668452395810193 as select v45 from aggJoin4734577270248961759 group by v45;
create or replace view aggJoin2133398671027695471 as select v45, v35 from aggJoin257728601468487607 join aggView1028668452395810193 using(v45);
create or replace view aggView6609964217340045732 as select v45 from aggJoin2133398671027695471 group by v45;
create or replace view aggJoin2616318791739887660 as select v45 from aggJoin8773048175386943743 join aggView6609964217340045732 using(v45);
create or replace view aggView8340587742435900675 as select v45 from aggJoin2616318791739887660 group by v45;
create or replace view aggJoin3959466798985638079 as select v45, v40 from aggJoin7323554737795015459 join aggView8340587742435900675 using(v45);
create or replace view aggView7130225543274496899 as select v45, v40 from aggJoin3959466798985638079;
create or replace view aggJoin3156099506454970150 as select v45, v40 from aggView7130225543274496899 where v40>'6.5';
create or replace view aggView8711044209081094183 as select v45, MIN(v40) as v58 from aggJoin3156099506454970150 group by v45;
create or replace view aggJoin2697284698283356859 as select v46, v45, v58 from aggView2150613828057009555 join aggView8711044209081094183 using(v45);
create or replace view aggView7979314990491175535 as select v45, MIN(v58) as v58, MIN(v46) as v59 from aggJoin2697284698283356859 group by v45;
create or replace view aggJoin3721162100748141617 as select company_id as v9, company_type_id as v16, note as v31, v58, v59 from movie_companies as mc, aggView7979314990491175535 where mc.movie_id=aggView7979314990491175535.v45 and note NOT LIKE '%(USA)%' and note LIKE '%(200%)%';
create or replace view aggView642332249255419113 as select id as v16 from company_type as ct;
create or replace view aggJoin2257889653689558412 as select v9, v31, v58, v59 from aggJoin3721162100748141617 join aggView642332249255419113 using(v16);
create or replace view aggView4014244744966750846 as select v9, MIN(v58) as v58, MIN(v59) as v59 from aggJoin2257889653689558412 group by v9;
create or replace view aggJoin2021741571607243423 as select v10, v58, v59 from aggView906364994472615000 join aggView4014244744966750846 using(v9);
select MIN(v10) as v57,MIN(v58) as v58,MIN(v59) as v59 from aggJoin2021741571607243423;
