create or replace view aggView2345866827878762433 as select id as v9, name as v59 from char_name as chn where ((name LIKE '%man%') OR (name LIKE '%Man%'));
create or replace view aggJoin3075432839365381794 as select person_id as v38, movie_id as v47, v59 from cast_info as ci, aggView2345866827878762433 where ci.person_role_id=aggView2345866827878762433.v9;
create or replace view aggView6099588811128147560 as select id as v38, name as v61 from name as n;
create or replace view aggJoin7639876789419462627 as select v47, v59, v61 from aggJoin3075432839365381794 join aggView6099588811128147560 using(v38);
create or replace view aggView1607369939806649378 as select id as v28 from kind_type as kt where kind= 'movie';
create or replace view aggJoin4786574402286853236 as select id as v47, title as v48 from title as t, aggView1607369939806649378 where t.kind_id=aggView1607369939806649378.v28 and production_year>2000;
create or replace view aggView7542567674128754904 as select id as v23 from info_type as it2 where info= 'rating';
create or replace view aggJoin8534735422977259472 as select movie_id as v47, info as v33 from movie_info_idx as mi_idx, aggView7542567674128754904 where mi_idx.info_type_id=aggView7542567674128754904.v23 and info>'7.0';
create or replace view aggView76002755503908825 as select v47, MIN(v33) as v60 from aggJoin8534735422977259472 group by v47;
create or replace view aggJoin3168642102510458955 as select v47, v48, v60 from aggJoin4786574402286853236 join aggView76002755503908825 using(v47);
create or replace view aggView5305576452136111435 as select v47, MIN(v59) as v59, MIN(v61) as v61 from aggJoin7639876789419462627 group by v47;
create or replace view aggJoin5807242329279962951 as select v47, v48, v60 as v60, v59, v61 from aggJoin3168642102510458955 join aggView5305576452136111435 using(v47);
create or replace view aggView1506438560936862534 as select v47, MIN(v60) as v60, MIN(v59) as v59, MIN(v61) as v61, MIN(v48) as v62 from aggJoin5807242329279962951 group by v47;
create or replace view aggJoin8583495815988563857 as select movie_id as v47, subject_id as v5, status_id as v7, v60, v59, v61, v62 from complete_cast as cc, aggView1506438560936862534 where cc.movie_id=aggView1506438560936862534.v47;
create or replace view aggView781574273506191198 as select id as v7 from comp_cast_type as cct2 where kind LIKE '%complete%';
create or replace view aggJoin3559299444577809611 as select v47, v5, v60, v59, v61, v62 from aggJoin8583495815988563857 join aggView781574273506191198 using(v7);
create or replace view aggView7114760144814597950 as select id as v25 from keyword as k where keyword IN ('superhero','marvel-comics','based-on-comic','tv-special','fight','violence','magnet','web','claw','laser');
create or replace view aggJoin9152153737632171697 as select movie_id as v47 from movie_keyword as mk, aggView7114760144814597950 where mk.keyword_id=aggView7114760144814597950.v25;
create or replace view aggView2825065051933790254 as select v47 from aggJoin9152153737632171697 group by v47;
create or replace view aggJoin1753863131239757168 as select v5, v60 as v60, v59 as v59, v61 as v61, v62 as v62 from aggJoin3559299444577809611 join aggView2825065051933790254 using(v47);
create or replace view aggView4634455310001484297 as select v5, MIN(v60) as v60, MIN(v59) as v59, MIN(v61) as v61, MIN(v62) as v62 from aggJoin1753863131239757168 group by v5;
create or replace view aggJoin3695817244933860565 as select v60, v59, v61, v62 from comp_cast_type as cct1, aggView4634455310001484297 where cct1.id=aggView4634455310001484297.v5 and kind= 'cast';
create or replace view res as select MIN(v59) as v59, MIN(v60) as v60, MIN(v61) as v61, MIN(v62) as v62 from aggJoin3695817244933860565;
select sum(v59+v60+v61+v62) from res;