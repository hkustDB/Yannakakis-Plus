create or replace view aggView5007213420559346408 as select id as v9, name as v59 from char_name as chn where ((name LIKE '%man%') OR (name LIKE '%Man%'));
create or replace view aggJoin9125506460510847470 as select person_id as v38, movie_id as v47, v59 from cast_info as ci, aggView5007213420559346408 where ci.person_role_id=aggView5007213420559346408.v9;
create or replace view aggView6588039352553730395 as select id as v38, name as v61 from name as n;
create or replace view aggJoin1977354226736911317 as select v47, v59, v61 from aggJoin9125506460510847470 join aggView6588039352553730395 using(v38);
create or replace view aggView962240034924583764 as select id as v28 from kind_type as kt where kind= 'movie';
create or replace view aggJoin7290883844553398074 as select id as v47, title as v48 from title as t, aggView962240034924583764 where t.kind_id=aggView962240034924583764.v28 and production_year>2000;
create or replace view aggView8068631910184303767 as select id as v23 from info_type as it2 where info= 'rating';
create or replace view aggJoin2491338332875296888 as select movie_id as v47, info as v33 from movie_info_idx as mi_idx, aggView8068631910184303767 where mi_idx.info_type_id=aggView8068631910184303767.v23 and info>'7.0';
create or replace view aggView3473870074248206120 as select id as v5 from comp_cast_type as cct1 where kind= 'cast';
create or replace view aggJoin1532361410172759018 as select movie_id as v47, status_id as v7 from complete_cast as cc, aggView3473870074248206120 where cc.subject_id=aggView3473870074248206120.v5;
create or replace view aggView5898738205144634347 as select v47, MIN(v59) as v59, MIN(v61) as v61 from aggJoin1977354226736911317 group by v47;
create or replace view aggJoin1728529634720059806 as select v47, v48, v59, v61 from aggJoin7290883844553398074 join aggView5898738205144634347 using(v47);
create or replace view aggView387142166988027381 as select v47, MIN(v59) as v59, MIN(v61) as v61, MIN(v48) as v62 from aggJoin1728529634720059806 group by v47;
create or replace view aggJoin5328625526803047596 as select v47, v33, v59, v61, v62 from aggJoin2491338332875296888 join aggView387142166988027381 using(v47);
create or replace view aggView643309174835166655 as select v47, MIN(v59) as v59, MIN(v61) as v61, MIN(v62) as v62, MIN(v33) as v60 from aggJoin5328625526803047596 group by v47;
create or replace view aggJoin3714587726469217827 as select movie_id as v47, keyword_id as v25, v59, v61, v62, v60 from movie_keyword as mk, aggView643309174835166655 where mk.movie_id=aggView643309174835166655.v47;
create or replace view aggView1285602697927690917 as select id as v7 from comp_cast_type as cct2 where kind LIKE '%complete%';
create or replace view aggJoin156862750824505804 as select v47 from aggJoin1532361410172759018 join aggView1285602697927690917 using(v7);
create or replace view aggView8071135360632880466 as select v47 from aggJoin156862750824505804 group by v47;
create or replace view aggJoin2734371106625010933 as select v25, v59 as v59, v61 as v61, v62 as v62, v60 as v60 from aggJoin3714587726469217827 join aggView8071135360632880466 using(v47);
create or replace view aggView6554466002078316092 as select v25, MIN(v59) as v59, MIN(v61) as v61, MIN(v62) as v62, MIN(v60) as v60 from aggJoin2734371106625010933 group by v25;
create or replace view aggJoin2812355141105827420 as select v59, v61, v62, v60 from keyword as k, aggView6554466002078316092 where k.id=aggView6554466002078316092.v25 and keyword IN ('superhero','marvel-comics','based-on-comic','tv-special','fight','violence','magnet','web','claw','laser');
create or replace view res as select MIN(v59) as v59, MIN(v60) as v60, MIN(v61) as v61, MIN(v62) as v62 from aggJoin2812355141105827420;
select sum(v59+v60+v61+v62) from res;