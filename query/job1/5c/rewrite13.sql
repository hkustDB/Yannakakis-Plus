create or replace view aggView681056269237294361 as select id as v15, title as v27 from title as t where production_year>1990;
create or replace view aggJoin4432235199520060898 as select movie_id as v15, company_type_id as v1, note as v9, v27 from movie_companies as mc, aggView681056269237294361 where mc.movie_id=aggView681056269237294361.v15 and note LIKE '%(USA)%' and note NOT LIKE '%(TV)%';
create or replace view aggView5561094663922135946 as select id as v3 from info_type as it;
create or replace view aggJoin7969876027812725792 as select movie_id as v15, info as v13 from movie_info as mi, aggView5561094663922135946 where mi.info_type_id=aggView5561094663922135946.v3 and info IN ('Sweden','Norway','Germany','Denmark','Swedish','Denish','Norwegian','German','USA','American');
create or replace view aggView8629124575507544722 as select v15 from aggJoin7969876027812725792 group by v15;
create or replace view aggJoin3822844271395043516 as select v1, v9, v27 as v27 from aggJoin4432235199520060898 join aggView8629124575507544722 using(v15);
create or replace view aggView5066203225099046502 as select id as v1 from company_type as ct where kind= 'production companies';
create or replace view aggJoin8937701853993967811 as select v9, v27 from aggJoin3822844271395043516 join aggView5066203225099046502 using(v1);
create or replace view res as select MIN(v27) as v27 from aggJoin8937701853993967811;
select sum(v27) from res;