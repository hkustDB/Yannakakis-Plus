create or replace view aggView371037407214804361 as select id as v5 from comp_cast_type as cct1 where kind= 'cast';
create or replace view aggJoin8141549871868296406 as select movie_id as v40, status_id as v7 from complete_cast as cc, aggView371037407214804361 where cc.subject_id=aggView371037407214804361.v5;
create or replace view aggView4263731035649979459 as select id as v31 from name as n where name LIKE '%Downey%Robert%';
create or replace view aggJoin3865197277497706836 as select movie_id as v40, person_role_id as v9 from cast_info as ci, aggView4263731035649979459 where ci.person_id=aggView4263731035649979459.v31;
create or replace view aggView4500066648040432053 as select id as v7 from comp_cast_type as cct2 where kind LIKE '%complete%';
create or replace view aggJoin419311667749116567 as select v40 from aggJoin8141549871868296406 join aggView4500066648040432053 using(v7);
create or replace view aggView5448545814290539579 as select v40 from aggJoin419311667749116567 group by v40;
create or replace view aggJoin8080310245033681100 as select v40, v9 from aggJoin3865197277497706836 join aggView5448545814290539579 using(v40);
create or replace view aggView6794211057799336609 as select id as v26 from kind_type as kt where kind= 'movie';
create or replace view aggJoin4910922633189885500 as select id as v40, title as v41, production_year as v44 from title as t, aggView6794211057799336609 where t.kind_id=aggView6794211057799336609.v26 and production_year>2000;
create or replace view aggView5536905205542241172 as select id as v9 from char_name as chn where ((name LIKE '%Tony%Stark%') OR (name LIKE '%Iron%Man%')) and name NOT LIKE '%Sherlock%';
create or replace view aggJoin2077183845006404058 as select v40 from aggJoin8080310245033681100 join aggView5536905205542241172 using(v9);
create or replace view aggView3546668032760811282 as select v40 from aggJoin2077183845006404058 group by v40;
create or replace view aggJoin8695030664843891188 as select v40, v41, v44 from aggJoin4910922633189885500 join aggView3546668032760811282 using(v40);
create or replace view aggView6352011517789851509 as select id as v23 from keyword as k where keyword IN ('superhero','sequel','second-part','marvel-comics','based-on-comic','tv-special','fight','violence');
create or replace view aggJoin8953762141300835624 as select movie_id as v40 from movie_keyword as mk, aggView6352011517789851509 where mk.keyword_id=aggView6352011517789851509.v23;
create or replace view aggView2761574076494386187 as select v40 from aggJoin8953762141300835624 group by v40;
create or replace view aggJoin2858121538277755172 as select v41, v44 from aggJoin8695030664843891188 join aggView2761574076494386187 using(v40);
create or replace view aggView5854340783317553756 as select v41 from aggJoin2858121538277755172 group by v41;
select min(v41) as v52 from aggView5854340783317553756;
