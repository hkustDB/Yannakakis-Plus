create or replace view aggView6150936565436446519 as select id as v5 from comp_cast_type as cct1 where kind= 'cast';
create or replace view aggJoin8811050589147247251 as select movie_id as v40, status_id as v7 from complete_cast as cc, aggView6150936565436446519 where cc.subject_id=aggView6150936565436446519.v5;
create or replace view aggView2587349073560443173 as select id as v31 from name as n where name LIKE '%Downey%Robert%';
create or replace view aggJoin464611818528872094 as select movie_id as v40, person_role_id as v9 from cast_info as ci, aggView2587349073560443173 where ci.person_id=aggView2587349073560443173.v31;
create or replace view aggView167820994111860018 as select id as v23 from keyword as k where keyword IN ('superhero','sequel','second-part','marvel-comics','based-on-comic','tv-special','fight','violence');
create or replace view aggJoin4749005405908863950 as select movie_id as v40 from movie_keyword as mk, aggView167820994111860018 where mk.keyword_id=aggView167820994111860018.v23;
create or replace view aggView6443188127114319351 as select id as v7 from comp_cast_type as cct2 where kind LIKE '%complete%';
create or replace view aggJoin4266263764600072967 as select v40 from aggJoin8811050589147247251 join aggView6443188127114319351 using(v7);
create or replace view aggView4564250228262526426 as select id as v9 from char_name as chn where ((name LIKE '%Tony%Stark%') OR (name LIKE '%Iron%Man%')) and name NOT LIKE '%Sherlock%';
create or replace view aggJoin6607151178992828963 as select v40 from aggJoin464611818528872094 join aggView4564250228262526426 using(v9);
create or replace view aggView4671321165835564967 as select v40 from aggJoin6607151178992828963 group by v40;
create or replace view aggJoin5753703718534024110 as select v40 from aggJoin4749005405908863950 join aggView4671321165835564967 using(v40);
create or replace view aggView993192171380124881 as select v40 from aggJoin5753703718534024110 group by v40;
create or replace view aggJoin2571830856868253780 as select id as v40, title as v41, kind_id as v26 from title as t, aggView993192171380124881 where t.id=aggView993192171380124881.v40 and production_year>2000;
create or replace view aggView6199165920976848505 as select id as v26 from kind_type as kt where kind= 'movie';
create or replace view aggJoin7442686713955214556 as select v40, v41 from aggJoin2571830856868253780 join aggView6199165920976848505 using(v26);
create or replace view aggView8558645865317329208 as select v40, MIN(v41) as v52 from aggJoin7442686713955214556 group by v40;
create or replace view aggJoin1721215525658326827 as select v52 from aggJoin4266263764600072967 join aggView8558645865317329208 using(v40);
create or replace view res as select MIN(v52) as v52 from aggJoin1721215525658326827;
select sum(v52) from res;