create or replace view aggView9205339995677891829 as select id as v5 from comp_cast_type as cct1 where kind= 'cast';
create or replace view aggJoin9083597699255566172 as select movie_id as v40, status_id as v7 from complete_cast as cc, aggView9205339995677891829 where cc.subject_id=aggView9205339995677891829.v5;
create or replace view aggView6779857055945633408 as select id as v23 from keyword as k where keyword IN ('superhero','sequel','second-part','marvel-comics','based-on-comic','tv-special','fight','violence');
create or replace view aggJoin5054857906950724802 as select movie_id as v40 from movie_keyword as mk, aggView6779857055945633408 where mk.keyword_id=aggView6779857055945633408.v23;
create or replace view aggView3292532826210660113 as select id as v31 from name as n where name LIKE '%Downey%Robert%';
create or replace view aggJoin8471868979468999395 as select movie_id as v40, person_role_id as v9 from cast_info as ci, aggView3292532826210660113 where ci.person_id=aggView3292532826210660113.v31;
create or replace view aggView4466172572346828427 as select id as v7 from comp_cast_type as cct2 where kind LIKE '%complete%';
create or replace view aggJoin3954569978607980878 as select v40 from aggJoin9083597699255566172 join aggView4466172572346828427 using(v7);
create or replace view aggView2961684700872584929 as select v40 from aggJoin3954569978607980878 group by v40;
create or replace view aggJoin1112084560602912972 as select id as v40, title as v41, kind_id as v26 from title as t, aggView2961684700872584929 where t.id=aggView2961684700872584929.v40 and production_year>2000;
create or replace view aggView1004959624939566788 as select id as v26 from kind_type as kt where kind= 'movie';
create or replace view aggJoin4298895934752661147 as select v40, v41 from aggJoin1112084560602912972 join aggView1004959624939566788 using(v26);
create or replace view aggView1685717497679392007 as select v40, MIN(v41) as v52 from aggJoin4298895934752661147 group by v40;
create or replace view aggJoin2400955319224938398 as select v40, v52 from aggJoin5054857906950724802 join aggView1685717497679392007 using(v40);
create or replace view aggView2573745559693777891 as select v40, MIN(v52) as v52 from aggJoin2400955319224938398 group by v40;
create or replace view aggJoin5338510519431966428 as select v9, v52 from aggJoin8471868979468999395 join aggView2573745559693777891 using(v40);
create or replace view aggView5106719660617222202 as select v9, MIN(v52) as v52 from aggJoin5338510519431966428 group by v9;
create or replace view aggJoin4454135749479536874 as select v52 from char_name as chn, aggView5106719660617222202 where chn.id=aggView5106719660617222202.v9 and ((name LIKE '%Tony%Stark%') OR (name LIKE '%Iron%Man%')) and name NOT LIKE '%Sherlock%';
select MIN(v52) as v52 from aggJoin4454135749479536874;
