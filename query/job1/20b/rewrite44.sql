create or replace view aggView483395025410307621 as select id as v5 from comp_cast_type as cct1 where kind= 'cast';
create or replace view aggJoin6336446067458259540 as select movie_id as v40, status_id as v7 from complete_cast as cc, aggView483395025410307621 where cc.subject_id=aggView483395025410307621.v5;
create or replace view aggView7672646829365309075 as select id as v31 from name as n where name LIKE '%Downey%Robert%';
create or replace view aggJoin554093291989488624 as select movie_id as v40, person_role_id as v9 from cast_info as ci, aggView7672646829365309075 where ci.person_id=aggView7672646829365309075.v31;
create or replace view aggView8932087034140521116 as select id as v23 from keyword as k where keyword IN ('superhero','sequel','second-part','marvel-comics','based-on-comic','tv-special','fight','violence');
create or replace view aggJoin4046760000664485478 as select movie_id as v40 from movie_keyword as mk, aggView8932087034140521116 where mk.keyword_id=aggView8932087034140521116.v23;
create or replace view aggView8954355069234631781 as select v40 from aggJoin4046760000664485478 group by v40;
create or replace view aggJoin2448705431294409295 as select v40, v9 from aggJoin554093291989488624 join aggView8954355069234631781 using(v40);
create or replace view aggView4218235642113700773 as select id as v7 from comp_cast_type as cct2 where kind LIKE '%complete%';
create or replace view aggJoin3406035128535128988 as select v40 from aggJoin6336446067458259540 join aggView4218235642113700773 using(v7);
create or replace view aggView8638146449369660183 as select id as v9 from char_name as chn where ((name LIKE '%Tony%Stark%') OR (name LIKE '%Iron%Man%')) and name NOT LIKE '%Sherlock%';
create or replace view aggJoin2800506603868241545 as select v40 from aggJoin2448705431294409295 join aggView8638146449369660183 using(v9);
create or replace view aggView7950378730195695502 as select v40 from aggJoin2800506603868241545 group by v40;
create or replace view aggJoin426884012675373415 as select v40 from aggJoin3406035128535128988 join aggView7950378730195695502 using(v40);
create or replace view aggView1018161074534242339 as select v40 from aggJoin426884012675373415 group by v40;
create or replace view aggJoin977173382587243597 as select title as v41, kind_id as v26 from title as t, aggView1018161074534242339 where t.id=aggView1018161074534242339.v40 and production_year>2000;
create or replace view aggView4259025737149128001 as select id as v26 from kind_type as kt where kind= 'movie';
create or replace view aggJoin5471821981259275270 as select v41 from aggJoin977173382587243597 join aggView4259025737149128001 using(v26);
create or replace view res as select MIN(v41) as v52 from aggJoin5471821981259275270;
select sum(v52) from res;