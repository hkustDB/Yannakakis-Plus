create or replace view aggView5460802433669597355 as select id as v31 from name as n where name LIKE '%Downey%Robert%';
create or replace view aggJoin7256385311281763909 as select movie_id as v40, person_role_id as v9 from cast_info as ci, aggView5460802433669597355 where ci.person_id=aggView5460802433669597355.v31;
create or replace view aggView4312181817160437072 as select id as v5 from comp_cast_type as cct1 where kind= 'cast';
create or replace view aggJoin3027832990123715478 as select movie_id as v40, status_id as v7 from complete_cast as cc, aggView4312181817160437072 where cc.subject_id=aggView4312181817160437072.v5;
create or replace view aggView3653477674010234711 as select id as v7 from comp_cast_type as cct2 where kind LIKE '%complete%';
create or replace view aggJoin7728208600237193854 as select v40 from aggJoin3027832990123715478 join aggView3653477674010234711 using(v7);
create or replace view aggView6841331377860946080 as select id as v23 from keyword as k where keyword IN ('superhero','sequel','second-part','marvel-comics','based-on-comic','tv-special','fight','violence');
create or replace view aggJoin3869929744674652635 as select movie_id as v40 from movie_keyword as mk, aggView6841331377860946080 where mk.keyword_id=aggView6841331377860946080.v23;
create or replace view aggView2244624669678427926 as select id as v26 from kind_type as kt where kind= 'movie';
create or replace view aggJoin7878316269513770497 as select id as v40, title as v41 from title as t, aggView2244624669678427926 where t.kind_id=aggView2244624669678427926.v26 and production_year>2000;
create or replace view aggView2524514006527106522 as select v40, MIN(v41) as v52 from aggJoin7878316269513770497 group by v40;
create or replace view aggJoin2768603596555687400 as select v40, v52 from aggJoin7728208600237193854 join aggView2524514006527106522 using(v40);
create or replace view aggView6834165107678461549 as select v40, MIN(v52) as v52 from aggJoin2768603596555687400 group by v40;
create or replace view aggJoin1736527370414058393 as select v40, v9, v52 from aggJoin7256385311281763909 join aggView6834165107678461549 using(v40);
create or replace view aggView1857206756244801144 as select v40 from aggJoin3869929744674652635 group by v40;
create or replace view aggJoin2374683034104351093 as select v9, v52 as v52 from aggJoin1736527370414058393 join aggView1857206756244801144 using(v40);
create or replace view aggView4179449055365674093 as select v9, MIN(v52) as v52 from aggJoin2374683034104351093 group by v9;
create or replace view aggJoin7533360002196932447 as select v52 from char_name as chn, aggView4179449055365674093 where chn.id=aggView4179449055365674093.v9 and ((name LIKE '%Tony%Stark%') OR (name LIKE '%Iron%Man%')) and name NOT LIKE '%Sherlock%';
create or replace view res as select MIN(v52) as v52 from aggJoin7533360002196932447;
select sum(v52) from res;