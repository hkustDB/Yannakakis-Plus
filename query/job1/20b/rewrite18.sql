create or replace view aggView2176979059012717795 as select id as v23 from keyword as k where keyword IN ('superhero','sequel','second-part','marvel-comics','based-on-comic','tv-special','fight','violence');
create or replace view aggJoin8222440526985491384 as select movie_id as v40 from movie_keyword as mk, aggView2176979059012717795 where mk.keyword_id=aggView2176979059012717795.v23;
create or replace view aggView5950664709094655014 as select id as v5 from comp_cast_type as cct1 where kind= 'cast';
create or replace view aggJoin7765223428344589624 as select movie_id as v40, status_id as v7 from complete_cast as cc, aggView5950664709094655014 where cc.subject_id=aggView5950664709094655014.v5;
create or replace view aggView8406914398301053803 as select id as v7 from comp_cast_type as cct2 where kind LIKE '%complete%';
create or replace view aggJoin1186201595421138073 as select v40 from aggJoin7765223428344589624 join aggView8406914398301053803 using(v7);
create or replace view aggView2712880849446015275 as select v40 from aggJoin1186201595421138073 group by v40;
create or replace view aggJoin9199224692654714224 as select person_id as v31, movie_id as v40, person_role_id as v9 from cast_info as ci, aggView2712880849446015275 where ci.movie_id=aggView2712880849446015275.v40;
create or replace view aggView6872294620014810159 as select v40 from aggJoin8222440526985491384 group by v40;
create or replace view aggJoin5816013798910511068 as select id as v40, title as v41, kind_id as v26 from title as t, aggView6872294620014810159 where t.id=aggView6872294620014810159.v40 and production_year>2000;
create or replace view aggView7795439817122752204 as select id as v9 from char_name as chn where ((name LIKE '%Tony%Stark%') OR (name LIKE '%Iron%Man%')) and name NOT LIKE '%Sherlock%';
create or replace view aggJoin1212980082692576730 as select v31, v40 from aggJoin9199224692654714224 join aggView7795439817122752204 using(v9);
create or replace view aggView2480355655280317218 as select id as v26 from kind_type as kt where kind= 'movie';
create or replace view aggJoin5099541363462127177 as select v40, v41 from aggJoin5816013798910511068 join aggView2480355655280317218 using(v26);
create or replace view aggView8549956819361024781 as select v40, MIN(v41) as v52 from aggJoin5099541363462127177 group by v40;
create or replace view aggJoin5057572124788855337 as select v31, v52 from aggJoin1212980082692576730 join aggView8549956819361024781 using(v40);
create or replace view aggView4846757975810072301 as select v31, MIN(v52) as v52 from aggJoin5057572124788855337 group by v31;
create or replace view aggJoin206496716704664634 as select v52 from name as n, aggView4846757975810072301 where n.id=aggView4846757975810072301.v31 and name LIKE '%Downey%Robert%';
create or replace view res as select MIN(v52) as v52 from aggJoin206496716704664634;
select sum(v52) from res;