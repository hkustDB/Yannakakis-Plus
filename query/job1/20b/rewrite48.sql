create or replace view aggView2866966341280173201 as select id as v23 from keyword as k where keyword IN ('superhero','sequel','second-part','marvel-comics','based-on-comic','tv-special','fight','violence');
create or replace view aggJoin8536141709978189171 as select movie_id as v40 from movie_keyword as mk, aggView2866966341280173201 where mk.keyword_id=aggView2866966341280173201.v23;
create or replace view aggView816641548737179224 as select id as v7 from comp_cast_type as cct2 where kind LIKE '%complete%';
create or replace view aggJoin5909995963135999027 as select movie_id as v40, subject_id as v5 from complete_cast as cc, aggView816641548737179224 where cc.status_id=aggView816641548737179224.v7;
create or replace view aggView4213213561500180010 as select id as v31 from name as n where name LIKE '%Downey%Robert%';
create or replace view aggJoin2457415363913432432 as select movie_id as v40, person_role_id as v9 from cast_info as ci, aggView4213213561500180010 where ci.person_id=aggView4213213561500180010.v31;
create or replace view aggView155460802684679117 as select id as v9 from char_name as chn where ((name LIKE '%Tony%Stark%') OR (name LIKE '%Iron%Man%')) and name NOT LIKE '%Sherlock%';
create or replace view aggJoin6049038493551526204 as select v40 from aggJoin2457415363913432432 join aggView155460802684679117 using(v9);
create or replace view aggView7572752156704237009 as select v40 from aggJoin6049038493551526204 group by v40;
create or replace view aggJoin6540074050388301128 as select v40, v5 from aggJoin5909995963135999027 join aggView7572752156704237009 using(v40);
create or replace view aggView2256120407839840669 as select id as v26 from kind_type as kt where kind= 'movie';
create or replace view aggJoin728422155184579000 as select id as v40, title as v41 from title as t, aggView2256120407839840669 where t.kind_id=aggView2256120407839840669.v26 and production_year>2000;
create or replace view aggView5835179481879260111 as select v40, MIN(v41) as v52 from aggJoin728422155184579000 group by v40;
create or replace view aggJoin8830298697836248732 as select v40, v52 from aggJoin8536141709978189171 join aggView5835179481879260111 using(v40);
create or replace view aggView438833040502740555 as select v40, MIN(v52) as v52 from aggJoin8830298697836248732 group by v40;
create or replace view aggJoin6777890305662407317 as select v5, v52 from aggJoin6540074050388301128 join aggView438833040502740555 using(v40);
create or replace view aggView8761702760815916628 as select v5, MIN(v52) as v52 from aggJoin6777890305662407317 group by v5;
create or replace view aggJoin932197293710132716 as select v52 from comp_cast_type as cct1, aggView8761702760815916628 where cct1.id=aggView8761702760815916628.v5 and kind= 'cast';
create or replace view res as select MIN(v52) as v52 from aggJoin932197293710132716;
select sum(v52) from res;