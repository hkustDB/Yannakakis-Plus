create or replace view aggView3648693102045847365 as select id as v23 from keyword as k where keyword IN ('superhero','sequel','second-part','marvel-comics','based-on-comic','tv-special','fight','violence');
create or replace view aggJoin945246020717498782 as select movie_id as v40 from movie_keyword as mk, aggView3648693102045847365 where mk.keyword_id=aggView3648693102045847365.v23;
create or replace view aggView6611980567265141897 as select id as v5 from comp_cast_type as cct1 where kind= 'cast';
create or replace view aggJoin2966353262760088028 as select movie_id as v40, status_id as v7 from complete_cast as cc, aggView6611980567265141897 where cc.subject_id=aggView6611980567265141897.v5;
create or replace view aggView3659095812976933112 as select id as v7 from comp_cast_type as cct2 where kind LIKE '%complete%';
create or replace view aggJoin3297836141184508761 as select v40 from aggJoin2966353262760088028 join aggView3659095812976933112 using(v7);
create or replace view aggView3444467395279116114 as select id as v31 from name as n where name LIKE '%Downey%Robert%';
create or replace view aggJoin1180609849118346920 as select movie_id as v40, person_role_id as v9 from cast_info as ci, aggView3444467395279116114 where ci.person_id=aggView3444467395279116114.v31;
create or replace view aggView5461013540794670571 as select id as v9 from char_name as chn where ((name LIKE '%Tony%Stark%') OR (name LIKE '%Iron%Man%')) and name NOT LIKE '%Sherlock%';
create or replace view aggJoin2905096148319623918 as select v40 from aggJoin1180609849118346920 join aggView5461013540794670571 using(v9);
create or replace view aggView8832925171547119300 as select v40 from aggJoin2905096148319623918 group by v40;
create or replace view aggJoin6532547025286486801 as select v40 from aggJoin945246020717498782 join aggView8832925171547119300 using(v40);
create or replace view aggView1998037368855764108 as select v40 from aggJoin6532547025286486801 group by v40;
create or replace view aggJoin7000050555840372542 as select v40 from aggJoin3297836141184508761 join aggView1998037368855764108 using(v40);
create or replace view aggView7131798387499455746 as select v40 from aggJoin7000050555840372542 group by v40;
create or replace view aggJoin1065141111506130874 as select title as v41, kind_id as v26 from title as t, aggView7131798387499455746 where t.id=aggView7131798387499455746.v40 and production_year>2000;
create or replace view aggView3880684668827178762 as select v26, MIN(v41) as v52 from aggJoin1065141111506130874 group by v26;
create or replace view aggJoin7276944290777170738 as select v52 from kind_type as kt, aggView3880684668827178762 where kt.id=aggView3880684668827178762.v26 and kind= 'movie';
create or replace view res as select MIN(v52) as v52 from aggJoin7276944290777170738;
select sum(v52) from res;