create or replace view aggView3170707219408723313 as select id as v23 from keyword as k where keyword IN ('superhero','sequel','second-part','marvel-comics','based-on-comic','tv-special','fight','violence');
create or replace view aggJoin8373513647227616771 as select movie_id as v40 from movie_keyword as mk, aggView3170707219408723313 where mk.keyword_id=aggView3170707219408723313.v23;
create or replace view aggView8932732283976173595 as select id as v31 from name as n where name LIKE '%Downey%Robert%';
create or replace view aggJoin4150835624943758630 as select movie_id as v40, person_role_id as v9 from cast_info as ci, aggView8932732283976173595 where ci.person_id=aggView8932732283976173595.v31;
create or replace view aggView563803258078579655 as select id as v7 from comp_cast_type as cct2 where kind LIKE '%complete%';
create or replace view aggJoin2726078537430943397 as select movie_id as v40, subject_id as v5 from complete_cast as cc, aggView563803258078579655 where cc.status_id=aggView563803258078579655.v7;
create or replace view aggView3925497713776483795 as select id as v9 from char_name as chn where ((name LIKE '%Tony%Stark%') OR (name LIKE '%Iron%Man%')) and name NOT LIKE '%Sherlock%';
create or replace view aggJoin6919620759847205970 as select v40 from aggJoin4150835624943758630 join aggView3925497713776483795 using(v9);
create or replace view aggView300758140047070416 as select id as v26 from kind_type as kt where kind= 'movie';
create or replace view aggJoin8855976076392113588 as select id as v40, title as v41 from title as t, aggView300758140047070416 where t.kind_id=aggView300758140047070416.v26 and production_year>2000;
create or replace view aggView320615457775186347 as select v40, MIN(v41) as v52 from aggJoin8855976076392113588 group by v40;
create or replace view aggJoin1457262836768980786 as select v40, v52 from aggJoin8373513647227616771 join aggView320615457775186347 using(v40);
create or replace view aggView3603256662580671637 as select v40, MIN(v52) as v52 from aggJoin1457262836768980786 group by v40;
create or replace view aggJoin1595479993048943350 as select v40, v52 from aggJoin6919620759847205970 join aggView3603256662580671637 using(v40);
create or replace view aggView68961393406134395 as select v40, MIN(v52) as v52 from aggJoin1595479993048943350 group by v40;
create or replace view aggJoin6857162818223828878 as select v5, v52 from aggJoin2726078537430943397 join aggView68961393406134395 using(v40);
create or replace view aggView492290402942173966 as select v5, MIN(v52) as v52 from aggJoin6857162818223828878 group by v5;
create or replace view aggJoin4399083610574043035 as select v52 from comp_cast_type as cct1, aggView492290402942173966 where cct1.id=aggView492290402942173966.v5 and kind= 'cast';
select MIN(v52) as v52 from aggJoin4399083610574043035;
