create or replace view aggView2786680209465115734 as select id as v5 from comp_cast_type as cct1 where kind= 'cast';
create or replace view aggJoin7559728399451322526 as select movie_id as v40, status_id as v7 from complete_cast as cc, aggView2786680209465115734 where cc.subject_id=aggView2786680209465115734.v5;
create or replace view aggView560431729474637972 as select id as v7 from comp_cast_type as cct2 where kind LIKE '%complete%';
create or replace view aggJoin6884147339347325702 as select v40 from aggJoin7559728399451322526 join aggView560431729474637972 using(v7);
create or replace view aggView3135199216330600967 as select id as v23 from keyword as k where keyword IN ('superhero','sequel','second-part','marvel-comics','based-on-comic','tv-special','fight','violence');
create or replace view aggJoin732451310064929832 as select movie_id as v40 from movie_keyword as mk, aggView3135199216330600967 where mk.keyword_id=aggView3135199216330600967.v23;
create or replace view aggView3528770909947901045 as select id as v9 from char_name as chn where ((name LIKE '%Tony%Stark%') OR (name LIKE '%Iron%Man%')) and name NOT LIKE '%Sherlock%';
create or replace view aggJoin5395172853953164898 as select person_id as v31, movie_id as v40 from cast_info as ci, aggView3528770909947901045 where ci.person_role_id=aggView3528770909947901045.v9;
create or replace view aggView1242094498558102646 as select v40 from aggJoin732451310064929832 group by v40;
create or replace view aggJoin4861630560166562110 as select v40 from aggJoin6884147339347325702 join aggView1242094498558102646 using(v40);
create or replace view aggView2476067610873060338 as select v40 from aggJoin4861630560166562110 group by v40;
create or replace view aggJoin934988074187549774 as select v31, v40 from aggJoin5395172853953164898 join aggView2476067610873060338 using(v40);
create or replace view aggView7067498608704100181 as select id as v26 from kind_type as kt where kind= 'movie';
create or replace view aggJoin4943963720961823445 as select id as v40, title as v41 from title as t, aggView7067498608704100181 where t.kind_id=aggView7067498608704100181.v26 and production_year>2000;
create or replace view aggView1042467199018157985 as select v40, MIN(v41) as v52 from aggJoin4943963720961823445 group by v40;
create or replace view aggJoin2303742190546629274 as select v31, v52 from aggJoin934988074187549774 join aggView1042467199018157985 using(v40);
create or replace view aggView8626369635112762559 as select v31, MIN(v52) as v52 from aggJoin2303742190546629274 group by v31;
create or replace view aggJoin5458463132650491467 as select v52 from name as n, aggView8626369635112762559 where n.id=aggView8626369635112762559.v31 and name LIKE '%Downey%Robert%';
create or replace view res as select MIN(v52) as v52 from aggJoin5458463132650491467;
select sum(v52) from res;