create or replace view aggView7339418116452596710 as select id as v5 from comp_cast_type as cct1 where kind= 'cast';
create or replace view aggJoin253109940197292552 as select movie_id as v40, status_id as v7 from complete_cast as cc, aggView7339418116452596710 where cc.subject_id=aggView7339418116452596710.v5;
create or replace view aggView1198288116922169885 as select id as v23 from keyword as k where keyword IN ('superhero','sequel','second-part','marvel-comics','based-on-comic','tv-special','fight','violence');
create or replace view aggJoin6670301319914856488 as select movie_id as v40 from movie_keyword as mk, aggView1198288116922169885 where mk.keyword_id=aggView1198288116922169885.v23;
create or replace view aggView6407137952299520462 as select id as v7 from comp_cast_type as cct2 where kind LIKE '%complete%';
create or replace view aggJoin8232581556231237352 as select v40 from aggJoin253109940197292552 join aggView6407137952299520462 using(v7);
create or replace view aggView2576699833819154385 as select id as v9 from char_name as chn where ((name LIKE '%Tony%Stark%') OR (name LIKE '%Iron%Man%')) and name NOT LIKE '%Sherlock%';
create or replace view aggJoin6456792913363717605 as select person_id as v31, movie_id as v40 from cast_info as ci, aggView2576699833819154385 where ci.person_role_id=aggView2576699833819154385.v9;
create or replace view aggView2567097302930239615 as select v40 from aggJoin6670301319914856488 group by v40;
create or replace view aggJoin3110005889782165682 as select v31, v40 from aggJoin6456792913363717605 join aggView2567097302930239615 using(v40);
create or replace view aggView6276164287659717400 as select id as v26 from kind_type as kt where kind= 'movie';
create or replace view aggJoin557196055360265038 as select id as v40, title as v41 from title as t, aggView6276164287659717400 where t.kind_id=aggView6276164287659717400.v26 and production_year>2000;
create or replace view aggView3038032048410683235 as select v40, MIN(v41) as v52 from aggJoin557196055360265038 group by v40;
create or replace view aggJoin8206729082654149936 as select v40, v52 from aggJoin8232581556231237352 join aggView3038032048410683235 using(v40);
create or replace view aggView3805143457186396603 as select v40, MIN(v52) as v52 from aggJoin8206729082654149936 group by v40;
create or replace view aggJoin7530654378487914398 as select v31, v52 from aggJoin3110005889782165682 join aggView3805143457186396603 using(v40);
create or replace view aggView7542658606410650428 as select v31, MIN(v52) as v52 from aggJoin7530654378487914398 group by v31;
create or replace view aggJoin5416909905549079714 as select v52 from name as n, aggView7542658606410650428 where n.id=aggView7542658606410650428.v31 and name LIKE '%Downey%Robert%';
select MIN(v52) as v52 from aggJoin5416909905549079714;
