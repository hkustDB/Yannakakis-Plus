create or replace view aggView5862558990342124458 as select id as v31 from name as n where name LIKE '%Downey%Robert%';
create or replace view aggJoin1695549805796724878 as select movie_id as v40, person_role_id as v9 from cast_info as ci, aggView5862558990342124458 where ci.person_id=aggView5862558990342124458.v31;
create or replace view aggView8190592083934986299 as select id as v5 from comp_cast_type as cct1 where kind= 'cast';
create or replace view aggJoin5903425966163616554 as select movie_id as v40, status_id as v7 from complete_cast as cc, aggView8190592083934986299 where cc.subject_id=aggView8190592083934986299.v5;
create or replace view aggView8039718110345340458 as select id as v7 from comp_cast_type as cct2 where kind LIKE '%complete%';
create or replace view aggJoin1608740449113718415 as select v40 from aggJoin5903425966163616554 join aggView8039718110345340458 using(v7);
create or replace view aggView4993295369953164492 as select id as v23 from keyword as k where keyword IN ('superhero','sequel','second-part','marvel-comics','based-on-comic','tv-special','fight','violence');
create or replace view aggJoin397528297432910081 as select movie_id as v40 from movie_keyword as mk, aggView4993295369953164492 where mk.keyword_id=aggView4993295369953164492.v23;
create or replace view aggView9204222807556913616 as select id as v9 from char_name as chn where ((name LIKE '%Tony%Stark%') OR (name LIKE '%Iron%Man%')) and name NOT LIKE '%Sherlock%';
create or replace view aggJoin6202021526311702547 as select v40 from aggJoin1695549805796724878 join aggView9204222807556913616 using(v9);
create or replace view aggView326785797523229826 as select v40 from aggJoin6202021526311702547 group by v40;
create or replace view aggJoin2375818820467245396 as select id as v40, title as v41, kind_id as v26 from title as t, aggView326785797523229826 where t.id=aggView326785797523229826.v40 and production_year>2000;
create or replace view aggView8502178671298794659 as select v40 from aggJoin1608740449113718415 group by v40;
create or replace view aggJoin3435310007234257877 as select v40 from aggJoin397528297432910081 join aggView8502178671298794659 using(v40);
create or replace view aggView1024151676269029874 as select id as v26 from kind_type as kt where kind= 'movie';
create or replace view aggJoin2677832746117141894 as select v40, v41 from aggJoin2375818820467245396 join aggView1024151676269029874 using(v26);
create or replace view aggView409422002172682610 as select v40, MIN(v41) as v52 from aggJoin2677832746117141894 group by v40;
create or replace view aggJoin8765429870569845774 as select v52 from aggJoin3435310007234257877 join aggView409422002172682610 using(v40);
create or replace view res as select MIN(v52) as v52 from aggJoin8765429870569845774;
select sum(v52) from res;