create or replace view aggView6634741661774656731 as select id as v5 from comp_cast_type as cct1 where kind= 'cast';
create or replace view aggJoin5397271218692138323 as select movie_id as v40, status_id as v7 from complete_cast as cc, aggView6634741661774656731 where cc.subject_id=aggView6634741661774656731.v5;
create or replace view aggView8907285334443799000 as select id as v31 from name as n where name LIKE '%Downey%Robert%';
create or replace view aggJoin4659185691089838954 as select movie_id as v40, person_role_id as v9 from cast_info as ci, aggView8907285334443799000 where ci.person_id=aggView8907285334443799000.v31;
create or replace view aggView4996797084530304851 as select id as v7 from comp_cast_type as cct2 where kind LIKE '%complete%';
create or replace view aggJoin3388339551246200161 as select v40 from aggJoin5397271218692138323 join aggView4996797084530304851 using(v7);
create or replace view aggView8673683050478153355 as select v40 from aggJoin3388339551246200161 group by v40;
create or replace view aggJoin7121092140253079365 as select v40, v9 from aggJoin4659185691089838954 join aggView8673683050478153355 using(v40);
create or replace view aggView2989890839427582750 as select id as v26 from kind_type as kt where kind= 'movie';
create or replace view aggJoin3308915987307414974 as select id as v40, title as v41, production_year as v44 from title as t, aggView2989890839427582750 where t.kind_id=aggView2989890839427582750.v26 and production_year>2000;
create or replace view aggView8827770116796924892 as select id as v9 from char_name as chn where ((name LIKE '%Tony%Stark%') OR (name LIKE '%Iron%Man%')) and name NOT LIKE '%Sherlock%';
create or replace view aggJoin7618497680470263834 as select v40 from aggJoin7121092140253079365 join aggView8827770116796924892 using(v9);
create or replace view aggView1521957158531344730 as select id as v23 from keyword as k where keyword IN ('superhero','sequel','second-part','marvel-comics','based-on-comic','tv-special','fight','violence');
create or replace view aggJoin8203313787834557879 as select movie_id as v40 from movie_keyword as mk, aggView1521957158531344730 where mk.keyword_id=aggView1521957158531344730.v23;
create or replace view aggView5862700360476801531 as select v40 from aggJoin8203313787834557879 group by v40;
create or replace view aggJoin5529575660575097206 as select v40, v41, v44 from aggJoin3308915987307414974 join aggView5862700360476801531 using(v40);
create or replace view aggView4227236051241885902 as select v40, MIN(v41) as v52 from aggJoin5529575660575097206 group by v40;
create or replace view aggJoin6264922462560662153 as select v52 from aggJoin7618497680470263834 join aggView4227236051241885902 using(v40);
select MIN(v52) as v52 from aggJoin6264922462560662153;
