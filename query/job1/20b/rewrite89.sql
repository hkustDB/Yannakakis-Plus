create or replace view aggView2628311750658168222 as select id as v31 from name as n where name LIKE '%Downey%Robert%';
create or replace view aggJoin5680154318160968267 as select movie_id as v40, person_role_id as v9 from cast_info as ci, aggView2628311750658168222 where ci.person_id=aggView2628311750658168222.v31;
create or replace view aggView7932905126742573771 as select id as v23 from keyword as k where keyword IN ('superhero','sequel','second-part','marvel-comics','based-on-comic','tv-special','fight','violence');
create or replace view aggJoin8492837468101970412 as select movie_id as v40 from movie_keyword as mk, aggView7932905126742573771 where mk.keyword_id=aggView7932905126742573771.v23;
create or replace view aggView3401681378562356349 as select v40 from aggJoin8492837468101970412 group by v40;
create or replace view aggJoin6010072383774743381 as select id as v40, title as v41, kind_id as v26 from title as t, aggView3401681378562356349 where t.id=aggView3401681378562356349.v40 and production_year>2000;
create or replace view aggView8481083746739565521 as select id as v7 from comp_cast_type as cct2 where kind LIKE '%complete%';
create or replace view aggJoin3664409934296684300 as select movie_id as v40, subject_id as v5 from complete_cast as cc, aggView8481083746739565521 where cc.status_id=aggView8481083746739565521.v7;
create or replace view aggView5888552540668975389 as select id as v9 from char_name as chn where ((name LIKE '%Tony%Stark%') OR (name LIKE '%Iron%Man%')) and name NOT LIKE '%Sherlock%';
create or replace view aggJoin1228039746833994364 as select v40 from aggJoin5680154318160968267 join aggView5888552540668975389 using(v9);
create or replace view aggView7449966269600814280 as select v40 from aggJoin1228039746833994364 group by v40;
create or replace view aggJoin984946276166405888 as select v40, v5 from aggJoin3664409934296684300 join aggView7449966269600814280 using(v40);
create or replace view aggView5799899899528406150 as select id as v26 from kind_type as kt where kind= 'movie';
create or replace view aggJoin1605809950118808475 as select v40, v41 from aggJoin6010072383774743381 join aggView5799899899528406150 using(v26);
create or replace view aggView2305663679857652235 as select v40, MIN(v41) as v52 from aggJoin1605809950118808475 group by v40;
create or replace view aggJoin1223319369619291369 as select v5, v52 from aggJoin984946276166405888 join aggView2305663679857652235 using(v40);
create or replace view aggView7864399515875658739 as select v5, MIN(v52) as v52 from aggJoin1223319369619291369 group by v5;
create or replace view aggJoin8364340106172730308 as select v52 from comp_cast_type as cct1, aggView7864399515875658739 where cct1.id=aggView7864399515875658739.v5 and kind= 'cast';
create or replace view res as select MIN(v52) as v52 from aggJoin8364340106172730308;
select sum(v52) from res;