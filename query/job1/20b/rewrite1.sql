create or replace view aggView6409697232543347752 as select id as v23 from keyword as k where keyword IN ('superhero','sequel','second-part','marvel-comics','based-on-comic','tv-special','fight','violence');
create or replace view aggJoin4793624009687091301 as select movie_id as v40 from movie_keyword as mk, aggView6409697232543347752 where mk.keyword_id=aggView6409697232543347752.v23;
create or replace view aggView944170463959109318 as select id as v7 from comp_cast_type as cct2 where kind LIKE '%complete%';
create or replace view aggJoin2599555637839652562 as select movie_id as v40, subject_id as v5 from complete_cast as cc, aggView944170463959109318 where cc.status_id=aggView944170463959109318.v7;
create or replace view aggView360002886522894379 as select id as v31 from name as n where name LIKE '%Downey%Robert%';
create or replace view aggJoin2508725833610593034 as select movie_id as v40, person_role_id as v9 from cast_info as ci, aggView360002886522894379 where ci.person_id=aggView360002886522894379.v31;
create or replace view aggView3315422860257958763 as select id as v9 from char_name as chn where ((name LIKE '%Tony%Stark%') OR (name LIKE '%Iron%Man%')) and name NOT LIKE '%Sherlock%';
create or replace view aggJoin8545646029479880806 as select v40 from aggJoin2508725833610593034 join aggView3315422860257958763 using(v9);
create or replace view aggView1736690066377128797 as select v40 from aggJoin8545646029479880806 group by v40;
create or replace view aggJoin2713022815553728094 as select id as v40, title as v41, kind_id as v26 from title as t, aggView1736690066377128797 where t.id=aggView1736690066377128797.v40 and production_year>2000;
create or replace view aggView4419342730293321122 as select id as v26 from kind_type as kt where kind= 'movie';
create or replace view aggJoin7060038155239664739 as select v40, v41 from aggJoin2713022815553728094 join aggView4419342730293321122 using(v26);
create or replace view aggView4758528680417626841 as select v40, MIN(v41) as v52 from aggJoin7060038155239664739 group by v40;
create or replace view aggJoin648455777962076784 as select v40, v52 from aggJoin4793624009687091301 join aggView4758528680417626841 using(v40);
create or replace view aggView2906082538243255185 as select v40, MIN(v52) as v52 from aggJoin648455777962076784 group by v40;
create or replace view aggJoin8951855342130846000 as select v5, v52 from aggJoin2599555637839652562 join aggView2906082538243255185 using(v40);
create or replace view aggView3115159497516766558 as select v5, MIN(v52) as v52 from aggJoin8951855342130846000 group by v5;
create or replace view aggJoin3337585920763838309 as select v52 from comp_cast_type as cct1, aggView3115159497516766558 where cct1.id=aggView3115159497516766558.v5 and kind= 'cast';
create or replace view res as select MIN(v52) as v52 from aggJoin3337585920763838309;
select sum(v52) from res;