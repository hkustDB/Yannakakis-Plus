create or replace view aggView7819798921741463016 as select id as v23 from keyword as k where keyword IN ('superhero','sequel','second-part','marvel-comics','based-on-comic','tv-special','fight','violence');
create or replace view aggJoin8568927021010810039 as select movie_id as v40 from movie_keyword as mk, aggView7819798921741463016 where mk.keyword_id=aggView7819798921741463016.v23;
create or replace view aggView1053520247272827868 as select id as v31 from name as n where name LIKE '%Downey%Robert%';
create or replace view aggJoin7613419902847194482 as select movie_id as v40, person_role_id as v9 from cast_info as ci, aggView1053520247272827868 where ci.person_id=aggView1053520247272827868.v31;
create or replace view aggView2253202855342156069 as select id as v7 from comp_cast_type as cct2 where kind LIKE '%complete%';
create or replace view aggJoin434834827113396083 as select movie_id as v40, subject_id as v5 from complete_cast as cc, aggView2253202855342156069 where cc.status_id=aggView2253202855342156069.v7;
create or replace view aggView7095736166448823138 as select id as v9 from char_name as chn where ((name LIKE '%Tony%Stark%') OR (name LIKE '%Iron%Man%')) and name NOT LIKE '%Sherlock%';
create or replace view aggJoin801390316760082195 as select v40 from aggJoin7613419902847194482 join aggView7095736166448823138 using(v9);
create or replace view aggView6132914204702303077 as select v40 from aggJoin801390316760082195 group by v40;
create or replace view aggJoin6891278756843660125 as select v40, v5 from aggJoin434834827113396083 join aggView6132914204702303077 using(v40);
create or replace view aggView7221718681021589195 as select id as v26 from kind_type as kt where kind= 'movie';
create or replace view aggJoin5447695965338218709 as select id as v40, title as v41 from title as t, aggView7221718681021589195 where t.kind_id=aggView7221718681021589195.v26 and production_year>2000;
create or replace view aggView4844830613126766072 as select v40, MIN(v41) as v52 from aggJoin5447695965338218709 group by v40;
create or replace view aggJoin3675952033411326272 as select v40, v52 from aggJoin8568927021010810039 join aggView4844830613126766072 using(v40);
create or replace view aggView7427277078951571136 as select v40, MIN(v52) as v52 from aggJoin3675952033411326272 group by v40;
create or replace view aggJoin2939777984527477281 as select v5, v52 from aggJoin6891278756843660125 join aggView7427277078951571136 using(v40);
create or replace view aggView1054375988348339156 as select v5, MIN(v52) as v52 from aggJoin2939777984527477281 group by v5;
create or replace view aggJoin1886586549011049704 as select v52 from comp_cast_type as cct1, aggView1054375988348339156 where cct1.id=aggView1054375988348339156.v5 and kind= 'cast';
select MIN(v52) as v52 from aggJoin1886586549011049704;
