create or replace view aggView5509599751879726987 as select id as v5 from comp_cast_type as cct1 where kind= 'cast';
create or replace view aggJoin5826406646645518251 as select movie_id as v40, status_id as v7 from complete_cast as cc, aggView5509599751879726987 where cc.subject_id=aggView5509599751879726987.v5;
create or replace view aggView6215202940070582740 as select id as v31 from name as n where name LIKE '%Downey%Robert%';
create or replace view aggJoin6186533426405462924 as select movie_id as v40, person_role_id as v9 from cast_info as ci, aggView6215202940070582740 where ci.person_id=aggView6215202940070582740.v31;
create or replace view aggView6627605338930297196 as select id as v7 from comp_cast_type as cct2 where kind LIKE '%complete%';
create or replace view aggJoin2433977783486012808 as select v40 from aggJoin5826406646645518251 join aggView6627605338930297196 using(v7);
create or replace view aggView6806000315862009462 as select id as v26 from kind_type as kt where kind= 'movie';
create or replace view aggJoin4831488259937454778 as select id as v40, title as v41, production_year as v44 from title as t, aggView6806000315862009462 where t.kind_id=aggView6806000315862009462.v26 and production_year>2000;
create or replace view aggView2991919297371732466 as select v40, MIN(v41) as v52 from aggJoin4831488259937454778 group by v40;
create or replace view aggJoin1146216427888293285 as select movie_id as v40, keyword_id as v23, v52 from movie_keyword as mk, aggView2991919297371732466 where mk.movie_id=aggView2991919297371732466.v40;
create or replace view aggView8551703654593427600 as select id as v9 from char_name as chn where ((name LIKE '%Tony%Stark%') OR (name LIKE '%Iron%Man%')) and name NOT LIKE '%Sherlock%';
create or replace view aggJoin6679618921962441896 as select v40 from aggJoin6186533426405462924 join aggView8551703654593427600 using(v9);
create or replace view aggView4262190966945954099 as select id as v23 from keyword as k where keyword IN ('superhero','sequel','second-part','marvel-comics','based-on-comic','tv-special','fight','violence');
create or replace view aggJoin3743157111667856786 as select v40, v52 from aggJoin1146216427888293285 join aggView4262190966945954099 using(v23);
create or replace view aggView1283479408952741073 as select v40, MIN(v52) as v52 from aggJoin3743157111667856786 group by v40,v52;
create or replace view aggJoin2474358412128029580 as select v40, v52 from aggJoin2433977783486012808 join aggView1283479408952741073 using(v40);
create or replace view aggView7557108075269637147 as select v40, MIN(v52) as v52 from aggJoin2474358412128029580 group by v40,v52;
create or replace view aggJoin5586013598943802278 as select v52 from aggJoin6679618921962441896 join aggView7557108075269637147 using(v40);
select MIN(v52) as v52 from aggJoin5586013598943802278;
