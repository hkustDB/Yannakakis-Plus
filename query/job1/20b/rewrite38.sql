create or replace view aggView1842940588479954024 as select id as v31 from name as n where name LIKE '%Downey%Robert%';
create or replace view aggJoin4653557591534449875 as select movie_id as v40, person_role_id as v9 from cast_info as ci, aggView1842940588479954024 where ci.person_id=aggView1842940588479954024.v31;
create or replace view aggView5737150145447245104 as select id as v5 from comp_cast_type as cct1 where kind= 'cast';
create or replace view aggJoin8245720924816027828 as select movie_id as v40, status_id as v7 from complete_cast as cc, aggView5737150145447245104 where cc.subject_id=aggView5737150145447245104.v5;
create or replace view aggView2923725461193721835 as select id as v7 from comp_cast_type as cct2 where kind LIKE '%complete%';
create or replace view aggJoin4346950843670198495 as select v40 from aggJoin8245720924816027828 join aggView2923725461193721835 using(v7);
create or replace view aggView1744942122109878755 as select id as v23 from keyword as k where keyword IN ('superhero','sequel','second-part','marvel-comics','based-on-comic','tv-special','fight','violence');
create or replace view aggJoin5515582439341921327 as select movie_id as v40 from movie_keyword as mk, aggView1744942122109878755 where mk.keyword_id=aggView1744942122109878755.v23;
create or replace view aggView984091329721582707 as select id as v9 from char_name as chn where ((name LIKE '%Tony%Stark%') OR (name LIKE '%Iron%Man%')) and name NOT LIKE '%Sherlock%';
create or replace view aggJoin7362318893232382779 as select v40 from aggJoin4653557591534449875 join aggView984091329721582707 using(v9);
create or replace view aggView8834764901553569344 as select v40 from aggJoin4346950843670198495 group by v40;
create or replace view aggJoin2730308228547930591 as select v40 from aggJoin5515582439341921327 join aggView8834764901553569344 using(v40);
create or replace view aggView1979724753222493428 as select id as v26 from kind_type as kt where kind= 'movie';
create or replace view aggJoin2825362102701550316 as select id as v40, title as v41 from title as t, aggView1979724753222493428 where t.kind_id=aggView1979724753222493428.v26 and production_year>2000;
create or replace view aggView8801812559925301367 as select v40, MIN(v41) as v52 from aggJoin2825362102701550316 group by v40;
create or replace view aggJoin5623226097704867720 as select v40, v52 from aggJoin2730308228547930591 join aggView8801812559925301367 using(v40);
create or replace view aggView4047332421951752791 as select v40, MIN(v52) as v52 from aggJoin5623226097704867720 group by v40;
create or replace view aggJoin4997933406799836922 as select v52 from aggJoin7362318893232382779 join aggView4047332421951752791 using(v40);
create or replace view res as select MIN(v52) as v52 from aggJoin4997933406799836922;
select sum(v52) from res;