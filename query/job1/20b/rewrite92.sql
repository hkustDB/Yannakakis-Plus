create or replace view aggView4800866333142339222 as select id as v5 from comp_cast_type as cct1 where kind= 'cast';
create or replace view aggJoin8236222782774196894 as select movie_id as v40, status_id as v7 from complete_cast as cc, aggView4800866333142339222 where cc.subject_id=aggView4800866333142339222.v5;
create or replace view aggView4967999115697143311 as select id as v7 from comp_cast_type as cct2 where kind LIKE '%complete%';
create or replace view aggJoin6750467974791454339 as select v40 from aggJoin8236222782774196894 join aggView4967999115697143311 using(v7);
create or replace view aggView246087030616738942 as select v40 from aggJoin6750467974791454339 group by v40;
create or replace view aggJoin3520345344635277713 as select id as v40, title as v41, kind_id as v26 from title as t, aggView246087030616738942 where t.id=aggView246087030616738942.v40 and production_year>2000;
create or replace view aggView1223369709784565235 as select id as v23 from keyword as k where keyword IN ('superhero','sequel','second-part','marvel-comics','based-on-comic','tv-special','fight','violence');
create or replace view aggJoin635847289004944492 as select movie_id as v40 from movie_keyword as mk, aggView1223369709784565235 where mk.keyword_id=aggView1223369709784565235.v23;
create or replace view aggView6705076406070554387 as select id as v9 from char_name as chn where ((name LIKE '%Tony%Stark%') OR (name LIKE '%Iron%Man%')) and name NOT LIKE '%Sherlock%';
create or replace view aggJoin1974601504534479204 as select person_id as v31, movie_id as v40 from cast_info as ci, aggView6705076406070554387 where ci.person_role_id=aggView6705076406070554387.v9;
create or replace view aggView1022674338648851110 as select id as v26 from kind_type as kt where kind= 'movie';
create or replace view aggJoin28609100137683097 as select v40, v41 from aggJoin3520345344635277713 join aggView1022674338648851110 using(v26);
create or replace view aggView5610550754721537905 as select v40, MIN(v41) as v52 from aggJoin28609100137683097 group by v40;
create or replace view aggJoin496595061690469113 as select v31, v40, v52 from aggJoin1974601504534479204 join aggView5610550754721537905 using(v40);
create or replace view aggView8050586126224407031 as select v40 from aggJoin635847289004944492 group by v40;
create or replace view aggJoin7623951659055686477 as select v31, v52 as v52 from aggJoin496595061690469113 join aggView8050586126224407031 using(v40);
create or replace view aggView4918972750498146982 as select v31, MIN(v52) as v52 from aggJoin7623951659055686477 group by v31;
create or replace view aggJoin6388115944569507067 as select v52 from name as n, aggView4918972750498146982 where n.id=aggView4918972750498146982.v31 and name LIKE '%Downey%Robert%';
create or replace view res as select MIN(v52) as v52 from aggJoin6388115944569507067;
select sum(v52) from res;