create or replace view aggView8078634304832054541 as select id as v31 from name as n where name LIKE '%Downey%Robert%';
create or replace view aggJoin4947621460958361049 as select movie_id as v40, person_role_id as v9 from cast_info as ci, aggView8078634304832054541 where ci.person_id=aggView8078634304832054541.v31;
create or replace view aggView6945248693902695273 as select id as v5 from comp_cast_type as cct1 where kind= 'cast';
create or replace view aggJoin4822036243731809091 as select movie_id as v40, status_id as v7 from complete_cast as cc, aggView6945248693902695273 where cc.subject_id=aggView6945248693902695273.v5;
create or replace view aggView616084141080560489 as select id as v7 from comp_cast_type as cct2 where kind LIKE '%complete%';
create or replace view aggJoin6740487424386400249 as select v40 from aggJoin4822036243731809091 join aggView616084141080560489 using(v7);
create or replace view aggView3136490051936878623 as select v40 from aggJoin6740487424386400249 group by v40;
create or replace view aggJoin8582457760523825218 as select id as v40, title as v41, kind_id as v26 from title as t, aggView3136490051936878623 where t.id=aggView3136490051936878623.v40 and production_year>2000;
create or replace view aggView3069067047016968534 as select id as v23 from keyword as k where keyword IN ('superhero','sequel','second-part','marvel-comics','based-on-comic','tv-special','fight','violence');
create or replace view aggJoin8397110883695011949 as select movie_id as v40 from movie_keyword as mk, aggView3069067047016968534 where mk.keyword_id=aggView3069067047016968534.v23;
create or replace view aggView7088218162366113561 as select v40 from aggJoin8397110883695011949 group by v40;
create or replace view aggJoin1202098981201062606 as select v40, v41, v26 from aggJoin8582457760523825218 join aggView7088218162366113561 using(v40);
create or replace view aggView77916306086551741 as select id as v9 from char_name as chn where ((name LIKE '%Tony%Stark%') OR (name LIKE '%Iron%Man%')) and name NOT LIKE '%Sherlock%';
create or replace view aggJoin4072510858537764797 as select v40 from aggJoin4947621460958361049 join aggView77916306086551741 using(v9);
create or replace view aggView6609568431471494955 as select v40 from aggJoin4072510858537764797 group by v40;
create or replace view aggJoin3553832188563286477 as select v41, v26 from aggJoin1202098981201062606 join aggView6609568431471494955 using(v40);
create or replace view aggView6556010911622555383 as select id as v26 from kind_type as kt where kind= 'movie';
create or replace view aggJoin7951650040642717661 as select v41 from aggJoin3553832188563286477 join aggView6556010911622555383 using(v26);
create or replace view res as select MIN(v41) as v52 from aggJoin7951650040642717661;
select sum(v52) from res;