create or replace view aggView5330748408420378214 as select id as v5 from comp_cast_type as cct1 where kind= 'cast';
create or replace view aggJoin3615536814609685689 as select movie_id as v40, status_id as v7 from complete_cast as cc, aggView5330748408420378214 where cc.subject_id=aggView5330748408420378214.v5;
create or replace view aggView4718816437730378080 as select id as v7 from comp_cast_type as cct2 where kind LIKE '%complete%';
create or replace view aggJoin7633987612140831664 as select v40 from aggJoin3615536814609685689 join aggView4718816437730378080 using(v7);
create or replace view aggView4486174458011147084 as select id as v23 from keyword as k where keyword IN ('superhero','sequel','second-part','marvel-comics','based-on-comic','tv-special','fight','violence');
create or replace view aggJoin117822880330195219 as select movie_id as v40 from movie_keyword as mk, aggView4486174458011147084 where mk.keyword_id=aggView4486174458011147084.v23;
create or replace view aggView5935704761049924729 as select id as v9 from char_name as chn where ((name LIKE '%Tony%Stark%') OR (name LIKE '%Iron%Man%')) and name NOT LIKE '%Sherlock%';
create or replace view aggJoin4628650924174635704 as select person_id as v31, movie_id as v40 from cast_info as ci, aggView5935704761049924729 where ci.person_role_id=aggView5935704761049924729.v9;
create or replace view aggView1553360991093638051 as select id as v26 from kind_type as kt where kind= 'movie';
create or replace view aggJoin2965015581233721294 as select id as v40, title as v41 from title as t, aggView1553360991093638051 where t.kind_id=aggView1553360991093638051.v26 and production_year>2000;
create or replace view aggView681063122594383333 as select v40, MIN(v41) as v52 from aggJoin2965015581233721294 group by v40;
create or replace view aggJoin221788819593705047 as select v40, v52 from aggJoin7633987612140831664 join aggView681063122594383333 using(v40);
create or replace view aggView3244940401212617394 as select v40, MIN(v52) as v52 from aggJoin221788819593705047 group by v40;
create or replace view aggJoin8609757928961266692 as select v40, v52 from aggJoin117822880330195219 join aggView3244940401212617394 using(v40);
create or replace view aggView8136225359519209824 as select v40, MIN(v52) as v52 from aggJoin8609757928961266692 group by v40;
create or replace view aggJoin1373047071393106716 as select v31, v52 from aggJoin4628650924174635704 join aggView8136225359519209824 using(v40);
create or replace view aggView6014935771563213358 as select v31, MIN(v52) as v52 from aggJoin1373047071393106716 group by v31;
create or replace view aggJoin1992216313271665774 as select v52 from name as n, aggView6014935771563213358 where n.id=aggView6014935771563213358.v31 and name LIKE '%Downey%Robert%';
create or replace view res as select MIN(v52) as v52 from aggJoin1992216313271665774;
select sum(v52) from res;