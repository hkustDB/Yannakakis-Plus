create or replace view aggView1857360760494706102 as select id as v5 from comp_cast_type as cct1 where kind= 'cast';
create or replace view aggJoin2315996280873082893 as select movie_id as v40, status_id as v7 from complete_cast as cc, aggView1857360760494706102 where cc.subject_id=aggView1857360760494706102.v5;
create or replace view aggView3307113752777440617 as select id as v31 from name as n where name LIKE '%Downey%Robert%';
create or replace view aggJoin755196397776449058 as select movie_id as v40, person_role_id as v9 from cast_info as ci, aggView3307113752777440617 where ci.person_id=aggView3307113752777440617.v31;
create or replace view aggView4698766599305388734 as select id as v7 from comp_cast_type as cct2 where kind LIKE '%complete%';
create or replace view aggJoin3402220842079966966 as select v40 from aggJoin2315996280873082893 join aggView4698766599305388734 using(v7);
create or replace view aggView5816313752816958870 as select id as v9 from char_name as chn where ((name LIKE '%Tony%Stark%') OR (name LIKE '%Iron%Man%')) and name NOT LIKE '%Sherlock%';
create or replace view aggJoin9025970527375852718 as select v40 from aggJoin755196397776449058 join aggView5816313752816958870 using(v9);
create or replace view aggView3959551736116610869 as select id as v26 from kind_type as kt where kind= 'movie';
create or replace view aggJoin5208360155718843692 as select id as v40, title as v41 from title as t, aggView3959551736116610869 where t.kind_id=aggView3959551736116610869.v26 and production_year>2000;
create or replace view aggView8246256654365434417 as select v40, MIN(v41) as v52 from aggJoin5208360155718843692 group by v40;
create or replace view aggJoin6752637909661421320 as select v40, v52 from aggJoin3402220842079966966 join aggView8246256654365434417 using(v40);
create or replace view aggView4659134309444078358 as select v40, MIN(v52) as v52 from aggJoin6752637909661421320 group by v40;
create or replace view aggJoin713759623794201185 as select v40, v52 from aggJoin9025970527375852718 join aggView4659134309444078358 using(v40);
create or replace view aggView6066051364928067234 as select v40, MIN(v52) as v52 from aggJoin713759623794201185 group by v40;
create or replace view aggJoin2442815523791465147 as select keyword_id as v23, v52 from movie_keyword as mk, aggView6066051364928067234 where mk.movie_id=aggView6066051364928067234.v40;
create or replace view aggView4296135293763145693 as select v23, MIN(v52) as v52 from aggJoin2442815523791465147 group by v23;
create or replace view aggJoin1443214870575310295 as select v52 from keyword as k, aggView4296135293763145693 where k.id=aggView4296135293763145693.v23 and keyword IN ('superhero','sequel','second-part','marvel-comics','based-on-comic','tv-special','fight','violence');
select MIN(v52) as v52 from aggJoin1443214870575310295;
