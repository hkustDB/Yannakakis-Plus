create or replace view aggView6286211179296244046 as select id as v5 from comp_cast_type as cct1 where kind= 'cast';
create or replace view aggJoin1969269131899567815 as select movie_id as v40, status_id as v7 from complete_cast as cc, aggView6286211179296244046 where cc.subject_id=aggView6286211179296244046.v5;
create or replace view aggView1616975891782127305 as select id as v7 from comp_cast_type as cct2 where kind LIKE '%complete%';
create or replace view aggJoin496114595962863992 as select v40 from aggJoin1969269131899567815 join aggView1616975891782127305 using(v7);
create or replace view aggView6182680868491676709 as select v40 from aggJoin496114595962863992 group by v40;
create or replace view aggJoin8139178976505108292 as select id as v40, title as v41, kind_id as v26 from title as t, aggView6182680868491676709 where t.id=aggView6182680868491676709.v40 and production_year>2000;
create or replace view aggView5867382857448936985 as select id as v23 from keyword as k where keyword IN ('superhero','sequel','second-part','marvel-comics','based-on-comic','tv-special','fight','violence');
create or replace view aggJoin4211369205459492639 as select movie_id as v40 from movie_keyword as mk, aggView5867382857448936985 where mk.keyword_id=aggView5867382857448936985.v23;
create or replace view aggView8060764439100373063 as select id as v9 from char_name as chn where ((name LIKE '%Tony%Stark%') OR (name LIKE '%Iron%Man%')) and name NOT LIKE '%Sherlock%';
create or replace view aggJoin3823449235530247495 as select person_id as v31, movie_id as v40 from cast_info as ci, aggView8060764439100373063 where ci.person_role_id=aggView8060764439100373063.v9;
create or replace view aggView8000437926002031227 as select id as v26 from kind_type as kt where kind= 'movie';
create or replace view aggJoin6362661852925946333 as select v40, v41 from aggJoin8139178976505108292 join aggView8000437926002031227 using(v26);
create or replace view aggView687735837779997349 as select v40, MIN(v41) as v52 from aggJoin6362661852925946333 group by v40;
create or replace view aggJoin3706120914865310423 as select v40, v52 from aggJoin4211369205459492639 join aggView687735837779997349 using(v40);
create or replace view aggView2370812063624028989 as select v40, MIN(v52) as v52 from aggJoin3706120914865310423 group by v40;
create or replace view aggJoin4211638807490265008 as select v31, v52 from aggJoin3823449235530247495 join aggView2370812063624028989 using(v40);
create or replace view aggView5584131835096222195 as select v31, MIN(v52) as v52 from aggJoin4211638807490265008 group by v31;
create or replace view aggJoin299764726463340810 as select v52 from name as n, aggView5584131835096222195 where n.id=aggView5584131835096222195.v31 and name LIKE '%Downey%Robert%';
create or replace view res as select MIN(v52) as v52 from aggJoin299764726463340810;
select sum(v52) from res;