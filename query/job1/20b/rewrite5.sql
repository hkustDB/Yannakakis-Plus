create or replace view aggView2947889024713359121 as select id as v23 from keyword as k where keyword IN ('superhero','sequel','second-part','marvel-comics','based-on-comic','tv-special','fight','violence');
create or replace view aggJoin1235735613996052999 as select movie_id as v40 from movie_keyword as mk, aggView2947889024713359121 where mk.keyword_id=aggView2947889024713359121.v23;
create or replace view aggView6955447919045108599 as select id as v5 from comp_cast_type as cct1 where kind= 'cast';
create or replace view aggJoin6956004745477666167 as select movie_id as v40, status_id as v7 from complete_cast as cc, aggView6955447919045108599 where cc.subject_id=aggView6955447919045108599.v5;
create or replace view aggView2092477882879889196 as select id as v7 from comp_cast_type as cct2 where kind LIKE '%complete%';
create or replace view aggJoin4100907456498354834 as select v40 from aggJoin6956004745477666167 join aggView2092477882879889196 using(v7);
create or replace view aggView7258686645607004441 as select id as v9 from char_name as chn where ((name LIKE '%Tony%Stark%') OR (name LIKE '%Iron%Man%')) and name NOT LIKE '%Sherlock%';
create or replace view aggJoin4926678688850115190 as select person_id as v31, movie_id as v40 from cast_info as ci, aggView7258686645607004441 where ci.person_role_id=aggView7258686645607004441.v9;
create or replace view aggView931419172981835779 as select id as v26 from kind_type as kt where kind= 'movie';
create or replace view aggJoin6462003898066843 as select id as v40, title as v41 from title as t, aggView931419172981835779 where t.kind_id=aggView931419172981835779.v26 and production_year>2000;
create or replace view aggView9075232805332615973 as select v40 from aggJoin4100907456498354834 group by v40;
create or replace view aggJoin4268978919965049470 as select v40 from aggJoin1235735613996052999 join aggView9075232805332615973 using(v40);
create or replace view aggView2352851166314132303 as select v40 from aggJoin4268978919965049470 group by v40;
create or replace view aggJoin3687137986192486178 as select v40, v41 from aggJoin6462003898066843 join aggView2352851166314132303 using(v40);
create or replace view aggView5185195172315804246 as select v40, MIN(v41) as v52 from aggJoin3687137986192486178 group by v40;
create or replace view aggJoin1579267127083007220 as select v31, v52 from aggJoin4926678688850115190 join aggView5185195172315804246 using(v40);
create or replace view aggView6276220188512310288 as select v31, MIN(v52) as v52 from aggJoin1579267127083007220 group by v31;
create or replace view aggJoin435364488234474845 as select v52 from name as n, aggView6276220188512310288 where n.id=aggView6276220188512310288.v31 and name LIKE '%Downey%Robert%';
create or replace view res as select MIN(v52) as v52 from aggJoin435364488234474845;
select sum(v52) from res;