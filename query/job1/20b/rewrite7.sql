create or replace view aggView3331315035584258031 as select id as v31 from name as n where name LIKE '%Downey%Robert%';
create or replace view aggJoin3207690329824272739 as select movie_id as v40, person_role_id as v9 from cast_info as ci, aggView3331315035584258031 where ci.person_id=aggView3331315035584258031.v31;
create or replace view aggView8523494213501879114 as select id as v7 from comp_cast_type as cct2 where kind LIKE '%complete%';
create or replace view aggJoin2323669339450142683 as select movie_id as v40, subject_id as v5 from complete_cast as cc, aggView8523494213501879114 where cc.status_id=aggView8523494213501879114.v7;
create or replace view aggView9012887588761787004 as select id as v23 from keyword as k where keyword IN ('superhero','sequel','second-part','marvel-comics','based-on-comic','tv-special','fight','violence');
create or replace view aggJoin4746053172142796101 as select movie_id as v40 from movie_keyword as mk, aggView9012887588761787004 where mk.keyword_id=aggView9012887588761787004.v23;
create or replace view aggView7204346423482936339 as select id as v9 from char_name as chn where ((name LIKE '%Tony%Stark%') OR (name LIKE '%Iron%Man%')) and name NOT LIKE '%Sherlock%';
create or replace view aggJoin5525514421795164762 as select v40 from aggJoin3207690329824272739 join aggView7204346423482936339 using(v9);
create or replace view aggView6147366922323908560 as select v40 from aggJoin5525514421795164762 group by v40;
create or replace view aggJoin5240768533992916013 as select id as v40, title as v41, kind_id as v26 from title as t, aggView6147366922323908560 where t.id=aggView6147366922323908560.v40 and production_year>2000;
create or replace view aggView6479475739328212457 as select id as v26 from kind_type as kt where kind= 'movie';
create or replace view aggJoin6142734465659085909 as select v40, v41 from aggJoin5240768533992916013 join aggView6479475739328212457 using(v26);
create or replace view aggView2587536456511170040 as select v40, MIN(v41) as v52 from aggJoin6142734465659085909 group by v40;
create or replace view aggJoin4618848102878457960 as select v40, v52 from aggJoin4746053172142796101 join aggView2587536456511170040 using(v40);
create or replace view aggView8275183864872041621 as select v40, MIN(v52) as v52 from aggJoin4618848102878457960 group by v40;
create or replace view aggJoin357937684568072847 as select v5, v52 from aggJoin2323669339450142683 join aggView8275183864872041621 using(v40);
create or replace view aggView8415938127807948960 as select v5, MIN(v52) as v52 from aggJoin357937684568072847 group by v5;
create or replace view aggJoin7985995733093701077 as select v52 from comp_cast_type as cct1, aggView8415938127807948960 where cct1.id=aggView8415938127807948960.v5 and kind= 'cast';
create or replace view res as select MIN(v52) as v52 from aggJoin7985995733093701077;
select sum(v52) from res;