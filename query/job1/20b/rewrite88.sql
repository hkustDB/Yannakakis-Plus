create or replace view aggView2262710679260941464 as select id as v31 from name as n where name LIKE '%Downey%Robert%';
create or replace view aggJoin1518868400569870219 as select movie_id as v40, person_role_id as v9 from cast_info as ci, aggView2262710679260941464 where ci.person_id=aggView2262710679260941464.v31;
create or replace view aggView5651026574538521130 as select id as v23 from keyword as k where keyword IN ('superhero','sequel','second-part','marvel-comics','based-on-comic','tv-special','fight','violence');
create or replace view aggJoin1076941907149802085 as select movie_id as v40 from movie_keyword as mk, aggView5651026574538521130 where mk.keyword_id=aggView5651026574538521130.v23;
create or replace view aggView8923018914611472315 as select id as v7 from comp_cast_type as cct2 where kind LIKE '%complete%';
create or replace view aggJoin7153786987087157551 as select movie_id as v40, subject_id as v5 from complete_cast as cc, aggView8923018914611472315 where cc.status_id=aggView8923018914611472315.v7;
create or replace view aggView4115992887467649033 as select id as v9 from char_name as chn where ((name LIKE '%Tony%Stark%') OR (name LIKE '%Iron%Man%')) and name NOT LIKE '%Sherlock%';
create or replace view aggJoin971636275174648489 as select v40 from aggJoin1518868400569870219 join aggView4115992887467649033 using(v9);
create or replace view aggView5999548207047237795 as select id as v26 from kind_type as kt where kind= 'movie';
create or replace view aggJoin1993555949034986190 as select id as v40, title as v41 from title as t, aggView5999548207047237795 where t.kind_id=aggView5999548207047237795.v26 and production_year>2000;
create or replace view aggView5766963733235841606 as select v40, MIN(v41) as v52 from aggJoin1993555949034986190 group by v40;
create or replace view aggJoin7664767053824668456 as select v40, v52 from aggJoin971636275174648489 join aggView5766963733235841606 using(v40);
create or replace view aggView6348744186989532792 as select v40, MIN(v52) as v52 from aggJoin7664767053824668456 group by v40;
create or replace view aggJoin5011502137158536100 as select v40, v52 from aggJoin1076941907149802085 join aggView6348744186989532792 using(v40);
create or replace view aggView8414128936244879861 as select v40, MIN(v52) as v52 from aggJoin5011502137158536100 group by v40;
create or replace view aggJoin4945151345558138733 as select v5, v52 from aggJoin7153786987087157551 join aggView8414128936244879861 using(v40);
create or replace view aggView8306935546978760523 as select v5, MIN(v52) as v52 from aggJoin4945151345558138733 group by v5;
create or replace view aggJoin8394671086061452041 as select v52 from comp_cast_type as cct1, aggView8306935546978760523 where cct1.id=aggView8306935546978760523.v5 and kind= 'cast';
create or replace view res as select MIN(v52) as v52 from aggJoin8394671086061452041;
select sum(v52) from res;