create or replace view aggView46351616929953365 as select id as v31 from name as n where name LIKE '%Downey%Robert%';
create or replace view aggJoin561065209694130368 as select movie_id as v40, person_role_id as v9 from cast_info as ci, aggView46351616929953365 where ci.person_id=aggView46351616929953365.v31;
create or replace view aggView6156147198514909885 as select id as v7 from comp_cast_type as cct2 where kind LIKE '%complete%';
create or replace view aggJoin6897441231868744715 as select movie_id as v40, subject_id as v5 from complete_cast as cc, aggView6156147198514909885 where cc.status_id=aggView6156147198514909885.v7;
create or replace view aggView4950854449554061834 as select id as v23 from keyword as k where keyword IN ('superhero','sequel','second-part','marvel-comics','based-on-comic','tv-special','fight','violence');
create or replace view aggJoin8508468834142292207 as select movie_id as v40 from movie_keyword as mk, aggView4950854449554061834 where mk.keyword_id=aggView4950854449554061834.v23;
create or replace view aggView5308068503127658922 as select id as v9 from char_name as chn where ((name LIKE '%Tony%Stark%') OR (name LIKE '%Iron%Man%')) and name NOT LIKE '%Sherlock%';
create or replace view aggJoin2892615089145777067 as select v40 from aggJoin561065209694130368 join aggView5308068503127658922 using(v9);
create or replace view aggView8237011433664211292 as select v40 from aggJoin2892615089145777067 group by v40;
create or replace view aggJoin7197100334034249897 as select id as v40, title as v41, kind_id as v26 from title as t, aggView8237011433664211292 where t.id=aggView8237011433664211292.v40 and production_year>2000;
create or replace view aggView7525256696778308043 as select v40 from aggJoin8508468834142292207 group by v40;
create or replace view aggJoin8526638387902864922 as select v40, v5 from aggJoin6897441231868744715 join aggView7525256696778308043 using(v40);
create or replace view aggView4673761831438123184 as select id as v26 from kind_type as kt where kind= 'movie';
create or replace view aggJoin883195219647918010 as select v40, v41 from aggJoin7197100334034249897 join aggView4673761831438123184 using(v26);
create or replace view aggView6601692599336874330 as select v40, MIN(v41) as v52 from aggJoin883195219647918010 group by v40;
create or replace view aggJoin5800995186613250048 as select v5, v52 from aggJoin8526638387902864922 join aggView6601692599336874330 using(v40);
create or replace view aggView5341175802711177239 as select v5, MIN(v52) as v52 from aggJoin5800995186613250048 group by v5;
create or replace view aggJoin7209158894954224047 as select v52 from comp_cast_type as cct1, aggView5341175802711177239 where cct1.id=aggView5341175802711177239.v5 and kind= 'cast';
create or replace view res as select MIN(v52) as v52 from aggJoin7209158894954224047;
select sum(v52) from res;