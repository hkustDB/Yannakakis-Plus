create or replace view aggView7179675295806083360 as select id as v31 from name as n where name LIKE '%Downey%Robert%';
create or replace view aggJoin1564005913128575801 as select movie_id as v40, person_role_id as v9 from cast_info as ci, aggView7179675295806083360 where ci.person_id=aggView7179675295806083360.v31;
create or replace view aggView6118157908513130353 as select id as v5 from comp_cast_type as cct1 where kind= 'cast';
create or replace view aggJoin4303041967990497629 as select movie_id as v40, status_id as v7 from complete_cast as cc, aggView6118157908513130353 where cc.subject_id=aggView6118157908513130353.v5;
create or replace view aggView4443217035474246147 as select id as v7 from comp_cast_type as cct2 where kind LIKE '%complete%';
create or replace view aggJoin2354586580607241005 as select v40 from aggJoin4303041967990497629 join aggView4443217035474246147 using(v7);
create or replace view aggView994304130392158697 as select id as v9 from char_name as chn where ((name LIKE '%Tony%Stark%') OR (name LIKE '%Iron%Man%')) and name NOT LIKE '%Sherlock%';
create or replace view aggJoin2709388375087281676 as select v40 from aggJoin1564005913128575801 join aggView994304130392158697 using(v9);
create or replace view aggView6301594080089528955 as select v40 from aggJoin2709388375087281676 group by v40;
create or replace view aggJoin3573701123389400388 as select v40 from aggJoin2354586580607241005 join aggView6301594080089528955 using(v40);
create or replace view aggView5761106483387787802 as select v40 from aggJoin3573701123389400388 group by v40;
create or replace view aggJoin4601852732015322129 as select movie_id as v40, keyword_id as v23 from movie_keyword as mk, aggView5761106483387787802 where mk.movie_id=aggView5761106483387787802.v40;
create or replace view aggView5333094948164936556 as select id as v26 from kind_type as kt where kind= 'movie';
create or replace view aggJoin1435557674246185942 as select id as v40, title as v41 from title as t, aggView5333094948164936556 where t.kind_id=aggView5333094948164936556.v26 and production_year>2000;
create or replace view aggView6300012442819958548 as select v40, MIN(v41) as v52 from aggJoin1435557674246185942 group by v40;
create or replace view aggJoin383089305868992097 as select v23, v52 from aggJoin4601852732015322129 join aggView6300012442819958548 using(v40);
create or replace view aggView149107809389420696 as select v23, MIN(v52) as v52 from aggJoin383089305868992097 group by v23;
create or replace view aggJoin8777115223402718595 as select v52 from keyword as k, aggView149107809389420696 where k.id=aggView149107809389420696.v23 and keyword IN ('superhero','sequel','second-part','marvel-comics','based-on-comic','tv-special','fight','violence');
create or replace view res as select MIN(v52) as v52 from aggJoin8777115223402718595;
select sum(v52) from res;