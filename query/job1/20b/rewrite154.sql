create or replace view aggView1147230826780819759 as select id as v31 from name as n where name LIKE '%Downey%Robert%';
create or replace view aggJoin1298245972870243218 as select movie_id as v40, person_role_id as v9 from cast_info as ci, aggView1147230826780819759 where ci.person_id=aggView1147230826780819759.v31;
create or replace view aggView7610651782281559053 as select id as v5 from comp_cast_type as cct1 where kind= 'cast';
create or replace view aggJoin1966533141317623833 as select movie_id as v40, status_id as v7 from complete_cast as cc, aggView7610651782281559053 where cc.subject_id=aggView7610651782281559053.v5;
create or replace view aggView471162268334073767 as select id as v7 from comp_cast_type as cct2 where kind LIKE '%complete%';
create or replace view aggJoin3758280554638674844 as select v40 from aggJoin1966533141317623833 join aggView471162268334073767 using(v7);
create or replace view aggView6470493993377287219 as select id as v9 from char_name as chn where ((name LIKE '%Tony%Stark%') OR (name LIKE '%Iron%Man%')) and name NOT LIKE '%Sherlock%';
create or replace view aggJoin5361685914906313687 as select v40 from aggJoin1298245972870243218 join aggView6470493993377287219 using(v9);
create or replace view aggView7778830839999710790 as select v40 from aggJoin5361685914906313687 group by v40;
create or replace view aggJoin6613355383433471892 as select v40 from aggJoin3758280554638674844 join aggView7778830839999710790 using(v40);
create or replace view aggView1281555674547318479 as select id as v26 from kind_type as kt where kind= 'movie';
create or replace view aggJoin1240563580700805163 as select id as v40, title as v41 from title as t, aggView1281555674547318479 where t.kind_id=aggView1281555674547318479.v26 and production_year>2000;
create or replace view aggView2193918471136964540 as select v40, MIN(v41) as v52 from aggJoin1240563580700805163 group by v40;
create or replace view aggJoin334436064657993908 as select v40, v52 from aggJoin6613355383433471892 join aggView2193918471136964540 using(v40);
create or replace view aggView992859534452022086 as select v40, MIN(v52) as v52 from aggJoin334436064657993908 group by v40;
create or replace view aggJoin7985839568701630285 as select keyword_id as v23, v52 from movie_keyword as mk, aggView992859534452022086 where mk.movie_id=aggView992859534452022086.v40;
create or replace view aggView7983323971378168593 as select v23, MIN(v52) as v52 from aggJoin7985839568701630285 group by v23;
create or replace view aggJoin6611665937123056831 as select v52 from keyword as k, aggView7983323971378168593 where k.id=aggView7983323971378168593.v23 and keyword IN ('superhero','sequel','second-part','marvel-comics','based-on-comic','tv-special','fight','violence');
create or replace view res as select MIN(v52) as v52 from aggJoin6611665937123056831;
select sum(v52) from res;