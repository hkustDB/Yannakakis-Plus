create or replace view aggView3507812625149333273 as select id as v23 from keyword as k where keyword IN ('superhero','sequel','second-part','marvel-comics','based-on-comic','tv-special','fight','violence');
create or replace view aggJoin2711129939419137409 as select movie_id as v40 from movie_keyword as mk, aggView3507812625149333273 where mk.keyword_id=aggView3507812625149333273.v23;
create or replace view aggView7406978159239019413 as select v40 from aggJoin2711129939419137409 group by v40;
create or replace view aggJoin5154732898694977343 as select id as v40, title as v41, kind_id as v26 from title as t, aggView7406978159239019413 where t.id=aggView7406978159239019413.v40 and production_year>2000;
create or replace view aggView311320216798636187 as select id as v7 from comp_cast_type as cct2 where kind LIKE '%complete%';
create or replace view aggJoin6569618330647433162 as select movie_id as v40, subject_id as v5 from complete_cast as cc, aggView311320216798636187 where cc.status_id=aggView311320216798636187.v7;
create or replace view aggView1118377461871789512 as select id as v31 from name as n where name LIKE '%Downey%Robert%';
create or replace view aggJoin308929875196084845 as select movie_id as v40, person_role_id as v9 from cast_info as ci, aggView1118377461871789512 where ci.person_id=aggView1118377461871789512.v31;
create or replace view aggView3078630670349563167 as select id as v9 from char_name as chn where ((name LIKE '%Tony%Stark%') OR (name LIKE '%Iron%Man%')) and name NOT LIKE '%Sherlock%';
create or replace view aggJoin4933004188745182055 as select v40 from aggJoin308929875196084845 join aggView3078630670349563167 using(v9);
create or replace view aggView9077728074519079725 as select v40 from aggJoin4933004188745182055 group by v40;
create or replace view aggJoin5579542057896895580 as select v40, v41, v26 from aggJoin5154732898694977343 join aggView9077728074519079725 using(v40);
create or replace view aggView7068343328339371628 as select id as v26 from kind_type as kt where kind= 'movie';
create or replace view aggJoin2271929197195948239 as select v40, v41 from aggJoin5579542057896895580 join aggView7068343328339371628 using(v26);
create or replace view aggView6216382612200910976 as select v40, MIN(v41) as v52 from aggJoin2271929197195948239 group by v40;
create or replace view aggJoin84288819845537744 as select v5, v52 from aggJoin6569618330647433162 join aggView6216382612200910976 using(v40);
create or replace view aggView4247988705631874300 as select v5, MIN(v52) as v52 from aggJoin84288819845537744 group by v5;
create or replace view aggJoin418949532126331944 as select v52 from comp_cast_type as cct1, aggView4247988705631874300 where cct1.id=aggView4247988705631874300.v5 and kind= 'cast';
create or replace view res as select MIN(v52) as v52 from aggJoin418949532126331944;
select sum(v52) from res;