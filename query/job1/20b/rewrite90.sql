create or replace view aggView6710301032721567903 as select id as v31 from name as n where name LIKE '%Downey%Robert%';
create or replace view aggJoin1168196960530510338 as select movie_id as v40, person_role_id as v9 from cast_info as ci, aggView6710301032721567903 where ci.person_id=aggView6710301032721567903.v31;
create or replace view aggView4977342012929939668 as select id as v5 from comp_cast_type as cct1 where kind= 'cast';
create or replace view aggJoin7336044273852322736 as select movie_id as v40, status_id as v7 from complete_cast as cc, aggView4977342012929939668 where cc.subject_id=aggView4977342012929939668.v5;
create or replace view aggView5770963820115184578 as select id as v7 from comp_cast_type as cct2 where kind LIKE '%complete%';
create or replace view aggJoin7939776261177165081 as select v40 from aggJoin7336044273852322736 join aggView5770963820115184578 using(v7);
create or replace view aggView5604850239296115047 as select id as v23 from keyword as k where keyword IN ('superhero','sequel','second-part','marvel-comics','based-on-comic','tv-special','fight','violence');
create or replace view aggJoin1208964412529141676 as select movie_id as v40 from movie_keyword as mk, aggView5604850239296115047 where mk.keyword_id=aggView5604850239296115047.v23;
create or replace view aggView6308716280395977675 as select id as v9 from char_name as chn where ((name LIKE '%Tony%Stark%') OR (name LIKE '%Iron%Man%')) and name NOT LIKE '%Sherlock%';
create or replace view aggJoin7615263743085437388 as select v40 from aggJoin1168196960530510338 join aggView6308716280395977675 using(v9);
create or replace view aggView6235644259403068368 as select v40 from aggJoin7615263743085437388 group by v40;
create or replace view aggJoin8263864994347905162 as select id as v40, title as v41, kind_id as v26 from title as t, aggView6235644259403068368 where t.id=aggView6235644259403068368.v40 and production_year>2000;
create or replace view aggView8812165845023017888 as select v40 from aggJoin7939776261177165081 group by v40;
create or replace view aggJoin641343125479468298 as select v40 from aggJoin1208964412529141676 join aggView8812165845023017888 using(v40);
create or replace view aggView22160333744424263 as select v40 from aggJoin641343125479468298 group by v40;
create or replace view aggJoin8585768476017978219 as select v41, v26 from aggJoin8263864994347905162 join aggView22160333744424263 using(v40);
create or replace view aggView9169737425706603750 as select id as v26 from kind_type as kt where kind= 'movie';
create or replace view aggJoin1997555150103137145 as select v41 from aggJoin8585768476017978219 join aggView9169737425706603750 using(v26);
create or replace view res as select MIN(v41) as v52 from aggJoin1997555150103137145;
select sum(v52) from res;