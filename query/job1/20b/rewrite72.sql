create or replace view aggView5554781368904631411 as select id as v5 from comp_cast_type as cct1 where kind= 'cast';
create or replace view aggJoin364589001822665587 as select movie_id as v40, status_id as v7 from complete_cast as cc, aggView5554781368904631411 where cc.subject_id=aggView5554781368904631411.v5;
create or replace view aggView5348324756642429203 as select id as v23 from keyword as k where keyword IN ('superhero','sequel','second-part','marvel-comics','based-on-comic','tv-special','fight','violence');
create or replace view aggJoin4128721204944732353 as select movie_id as v40 from movie_keyword as mk, aggView5348324756642429203 where mk.keyword_id=aggView5348324756642429203.v23;
create or replace view aggView9187349181639184299 as select id as v31 from name as n where name LIKE '%Downey%Robert%';
create or replace view aggJoin2611640962933891496 as select movie_id as v40, person_role_id as v9 from cast_info as ci, aggView9187349181639184299 where ci.person_id=aggView9187349181639184299.v31;
create or replace view aggView2849795149906697058 as select id as v7 from comp_cast_type as cct2 where kind LIKE '%complete%';
create or replace view aggJoin4384512587856973968 as select v40 from aggJoin364589001822665587 join aggView2849795149906697058 using(v7);
create or replace view aggView9196141376322903207 as select v40 from aggJoin4384512587856973968 group by v40;
create or replace view aggJoin1041918228493998488 as select id as v40, title as v41, kind_id as v26 from title as t, aggView9196141376322903207 where t.id=aggView9196141376322903207.v40 and production_year>2000;
create or replace view aggView5440896562507277642 as select v40 from aggJoin4128721204944732353 group by v40;
create or replace view aggJoin5070358327210832314 as select v40, v41, v26 from aggJoin1041918228493998488 join aggView5440896562507277642 using(v40);
create or replace view aggView2274071477728231790 as select id as v26 from kind_type as kt where kind= 'movie';
create or replace view aggJoin3394094269899398 as select v40, v41 from aggJoin5070358327210832314 join aggView2274071477728231790 using(v26);
create or replace view aggView5154569665277377010 as select v40, MIN(v41) as v52 from aggJoin3394094269899398 group by v40;
create or replace view aggJoin2381372175068426782 as select v9, v52 from aggJoin2611640962933891496 join aggView5154569665277377010 using(v40);
create or replace view aggView1624790202883509389 as select v9, MIN(v52) as v52 from aggJoin2381372175068426782 group by v9;
create or replace view aggJoin1451598867384462559 as select v52 from char_name as chn, aggView1624790202883509389 where chn.id=aggView1624790202883509389.v9 and ((name LIKE '%Tony%Stark%') OR (name LIKE '%Iron%Man%')) and name NOT LIKE '%Sherlock%';
select MIN(v52) as v52 from aggJoin1451598867384462559;
