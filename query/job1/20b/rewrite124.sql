create or replace view aggView5530343155652342480 as select id as v31 from name as n where name LIKE '%Downey%Robert%';
create or replace view aggJoin8549211250871247472 as select movie_id as v40, person_role_id as v9 from cast_info as ci, aggView5530343155652342480 where ci.person_id=aggView5530343155652342480.v31;
create or replace view aggView2997387639270059981 as select id as v5 from comp_cast_type as cct1 where kind= 'cast';
create or replace view aggJoin3046591094467255142 as select movie_id as v40, status_id as v7 from complete_cast as cc, aggView2997387639270059981 where cc.subject_id=aggView2997387639270059981.v5;
create or replace view aggView8214511510269629105 as select id as v7 from comp_cast_type as cct2 where kind LIKE '%complete%';
create or replace view aggJoin5329786710014657570 as select v40 from aggJoin3046591094467255142 join aggView8214511510269629105 using(v7);
create or replace view aggView2448043983578314086 as select id as v23 from keyword as k where keyword IN ('superhero','sequel','second-part','marvel-comics','based-on-comic','tv-special','fight','violence');
create or replace view aggJoin3656615841659792676 as select movie_id as v40 from movie_keyword as mk, aggView2448043983578314086 where mk.keyword_id=aggView2448043983578314086.v23;
create or replace view aggView6059984373047427898 as select id as v9 from char_name as chn where ((name LIKE '%Tony%Stark%') OR (name LIKE '%Iron%Man%')) and name NOT LIKE '%Sherlock%';
create or replace view aggJoin2541290318260610691 as select v40 from aggJoin8549211250871247472 join aggView6059984373047427898 using(v9);
create or replace view aggView817173292169869952 as select v40 from aggJoin5329786710014657570 group by v40;
create or replace view aggJoin6142095888131489475 as select v40 from aggJoin3656615841659792676 join aggView817173292169869952 using(v40);
create or replace view aggView1904678865229288306 as select v40 from aggJoin6142095888131489475 group by v40;
create or replace view aggJoin385614229356572787 as select v40 from aggJoin2541290318260610691 join aggView1904678865229288306 using(v40);
create or replace view aggView4158522995711436017 as select v40 from aggJoin385614229356572787 group by v40;
create or replace view aggJoin3273405481944455668 as select title as v41, kind_id as v26 from title as t, aggView4158522995711436017 where t.id=aggView4158522995711436017.v40 and production_year>2000;
create or replace view aggView3318678170180731941 as select v26, MIN(v41) as v52 from aggJoin3273405481944455668 group by v26;
create or replace view aggJoin2252370353739866402 as select v52 from kind_type as kt, aggView3318678170180731941 where kt.id=aggView3318678170180731941.v26 and kind= 'movie';
create or replace view res as select MIN(v52) as v52 from aggJoin2252370353739866402;
select sum(v52) from res;