create or replace view aggView8749750224398719805 as select id as v23 from keyword as k where keyword IN ('superhero','sequel','second-part','marvel-comics','based-on-comic','tv-special','fight','violence');
create or replace view aggJoin649453418192441358 as select movie_id as v40 from movie_keyword as mk, aggView8749750224398719805 where mk.keyword_id=aggView8749750224398719805.v23;
create or replace view aggView707269944648499009 as select id as v5 from comp_cast_type as cct1 where kind= 'cast';
create or replace view aggJoin4383857323004342237 as select movie_id as v40, status_id as v7 from complete_cast as cc, aggView707269944648499009 where cc.subject_id=aggView707269944648499009.v5;
create or replace view aggView8153995284080809691 as select id as v7 from comp_cast_type as cct2 where kind LIKE '%complete%';
create or replace view aggJoin2635227771507330072 as select v40 from aggJoin4383857323004342237 join aggView8153995284080809691 using(v7);
create or replace view aggView1852168735720150528 as select v40 from aggJoin2635227771507330072 group by v40;
create or replace view aggJoin2440993483206590086 as select person_id as v31, movie_id as v40, person_role_id as v9 from cast_info as ci, aggView1852168735720150528 where ci.movie_id=aggView1852168735720150528.v40;
create or replace view aggView1735777063306051147 as select v40 from aggJoin649453418192441358 group by v40;
create or replace view aggJoin3584120533200773538 as select id as v40, title as v41, kind_id as v26 from title as t, aggView1735777063306051147 where t.id=aggView1735777063306051147.v40 and production_year>2000;
create or replace view aggView7713245211408611032 as select id as v31 from name as n where name LIKE '%Downey%Robert%';
create or replace view aggJoin6687420423964942552 as select v40, v9 from aggJoin2440993483206590086 join aggView7713245211408611032 using(v31);
create or replace view aggView844140205315903848 as select id as v9 from char_name as chn where ((name LIKE '%Tony%Stark%') OR (name LIKE '%Iron%Man%')) and name NOT LIKE '%Sherlock%';
create or replace view aggJoin31178158131152955 as select v40 from aggJoin6687420423964942552 join aggView844140205315903848 using(v9);
create or replace view aggView3881697263723664287 as select v40 from aggJoin31178158131152955 group by v40;
create or replace view aggJoin4573010328253494733 as select v41, v26 from aggJoin3584120533200773538 join aggView3881697263723664287 using(v40);
create or replace view aggView6279610522551430302 as select id as v26 from kind_type as kt where kind= 'movie';
create or replace view aggJoin8031505128708675973 as select v41 from aggJoin4573010328253494733 join aggView6279610522551430302 using(v26);
create or replace view res as select MIN(v41) as v52 from aggJoin8031505128708675973;
select sum(v52) from res;