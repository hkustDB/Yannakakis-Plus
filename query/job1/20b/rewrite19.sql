create or replace view aggView135663891610243221 as select id as v5 from comp_cast_type as cct1 where kind= 'cast';
create or replace view aggJoin2144431378116183419 as select movie_id as v40, status_id as v7 from complete_cast as cc, aggView135663891610243221 where cc.subject_id=aggView135663891610243221.v5;
create or replace view aggView6699588511529023291 as select id as v31 from name as n where name LIKE '%Downey%Robert%';
create or replace view aggJoin7127346202353819426 as select movie_id as v40, person_role_id as v9 from cast_info as ci, aggView6699588511529023291 where ci.person_id=aggView6699588511529023291.v31;
create or replace view aggView2339150038422734403 as select id as v7 from comp_cast_type as cct2 where kind LIKE '%complete%';
create or replace view aggJoin8420853237287623670 as select v40 from aggJoin2144431378116183419 join aggView2339150038422734403 using(v7);
create or replace view aggView387142106363467170 as select id as v26 from kind_type as kt where kind= 'movie';
create or replace view aggJoin7754642953272742194 as select id as v40, title as v41, production_year as v44 from title as t, aggView387142106363467170 where t.kind_id=aggView387142106363467170.v26 and production_year>2000;
create or replace view aggView5575823198571901001 as select v40, MIN(v41) as v52 from aggJoin7754642953272742194 group by v40;
create or replace view aggJoin6970667470174962898 as select movie_id as v40, keyword_id as v23, v52 from movie_keyword as mk, aggView5575823198571901001 where mk.movie_id=aggView5575823198571901001.v40;
create or replace view aggView5663527458554273653 as select v40 from aggJoin8420853237287623670 group by v40;
create or replace view aggJoin3127316269255174053 as select v40, v23, v52 as v52 from aggJoin6970667470174962898 join aggView5663527458554273653 using(v40);
create or replace view aggView6708890098426551952 as select id as v9 from char_name as chn where ((name LIKE '%Tony%Stark%') OR (name LIKE '%Iron%Man%')) and name NOT LIKE '%Sherlock%';
create or replace view aggJoin8421640789584038014 as select v40 from aggJoin7127346202353819426 join aggView6708890098426551952 using(v9);
create or replace view aggView7298589519634788832 as select id as v23 from keyword as k where keyword IN ('superhero','sequel','second-part','marvel-comics','based-on-comic','tv-special','fight','violence');
create or replace view aggJoin4657035497136739130 as select v40, v52 from aggJoin3127316269255174053 join aggView7298589519634788832 using(v23);
create or replace view aggView7663473253384378502 as select v40, MIN(v52) as v52 from aggJoin4657035497136739130 group by v40,v52;
create or replace view aggJoin1488142498789615866 as select v52 from aggJoin8421640789584038014 join aggView7663473253384378502 using(v40);
select MIN(v52) as v52 from aggJoin1488142498789615866;
