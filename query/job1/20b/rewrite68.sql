create or replace view aggView1018509915391546619 as select id as v5 from comp_cast_type as cct1 where kind= 'cast';
create or replace view aggJoin4782698443565230645 as select movie_id as v40, status_id as v7 from complete_cast as cc, aggView1018509915391546619 where cc.subject_id=aggView1018509915391546619.v5;
create or replace view aggView4418239485644006714 as select id as v31 from name as n where name LIKE '%Downey%Robert%';
create or replace view aggJoin6994164464992838434 as select movie_id as v40, person_role_id as v9 from cast_info as ci, aggView4418239485644006714 where ci.person_id=aggView4418239485644006714.v31;
create or replace view aggView4914502615487427419 as select id as v7 from comp_cast_type as cct2 where kind LIKE '%complete%';
create or replace view aggJoin9205261467800943866 as select v40 from aggJoin4782698443565230645 join aggView4914502615487427419 using(v7);
create or replace view aggView3300630819718958180 as select v40 from aggJoin9205261467800943866 group by v40;
create or replace view aggJoin6603147628781012888 as select id as v40, title as v41, kind_id as v26 from title as t, aggView3300630819718958180 where t.id=aggView3300630819718958180.v40 and production_year>2000;
create or replace view aggView3246029399805720564 as select id as v9 from char_name as chn where ((name LIKE '%Tony%Stark%') OR (name LIKE '%Iron%Man%')) and name NOT LIKE '%Sherlock%';
create or replace view aggJoin7752542504673646512 as select v40 from aggJoin6994164464992838434 join aggView3246029399805720564 using(v9);
create or replace view aggView8615229657416274065 as select v40 from aggJoin7752542504673646512 group by v40;
create or replace view aggJoin5842291560102769417 as select v40, v41, v26 from aggJoin6603147628781012888 join aggView8615229657416274065 using(v40);
create or replace view aggView6476159340649540175 as select id as v26 from kind_type as kt where kind= 'movie';
create or replace view aggJoin4275115897753699477 as select v40, v41 from aggJoin5842291560102769417 join aggView6476159340649540175 using(v26);
create or replace view aggView4600955139264947422 as select v40, MIN(v41) as v52 from aggJoin4275115897753699477 group by v40;
create or replace view aggJoin2925359992702658806 as select keyword_id as v23, v52 from movie_keyword as mk, aggView4600955139264947422 where mk.movie_id=aggView4600955139264947422.v40;
create or replace view aggView8088657175717186421 as select v23, MIN(v52) as v52 from aggJoin2925359992702658806 group by v23;
create or replace view aggJoin8965679685962577112 as select v52 from keyword as k, aggView8088657175717186421 where k.id=aggView8088657175717186421.v23 and keyword IN ('superhero','sequel','second-part','marvel-comics','based-on-comic','tv-special','fight','violence');
select MIN(v52) as v52 from aggJoin8965679685962577112;
