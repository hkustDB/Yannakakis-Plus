create or replace view aggView8361857223879528118 as select id as v5 from comp_cast_type as cct1 where kind= 'cast';
create or replace view aggJoin8820526800610279849 as select movie_id as v40, status_id as v7 from complete_cast as cc, aggView8361857223879528118 where cc.subject_id=aggView8361857223879528118.v5;
create or replace view aggView356670235672273090 as select id as v23 from keyword as k where keyword IN ('superhero','sequel','second-part','marvel-comics','based-on-comic','tv-special','fight','violence');
create or replace view aggJoin3389745277809017953 as select movie_id as v40 from movie_keyword as mk, aggView356670235672273090 where mk.keyword_id=aggView356670235672273090.v23;
create or replace view aggView3221055548017309423 as select id as v31 from name as n where name LIKE '%Downey%Robert%';
create or replace view aggJoin2600477265552273904 as select movie_id as v40, person_role_id as v9 from cast_info as ci, aggView3221055548017309423 where ci.person_id=aggView3221055548017309423.v31;
create or replace view aggView1455889420024728572 as select id as v7 from comp_cast_type as cct2 where kind LIKE '%complete%';
create or replace view aggJoin6373851799303141855 as select v40 from aggJoin8820526800610279849 join aggView1455889420024728572 using(v7);
create or replace view aggView6992748210680344469 as select id as v9 from char_name as chn where ((name LIKE '%Tony%Stark%') OR (name LIKE '%Iron%Man%')) and name NOT LIKE '%Sherlock%';
create or replace view aggJoin1487192495334212741 as select v40 from aggJoin2600477265552273904 join aggView6992748210680344469 using(v9);
create or replace view aggView6664279985320032865 as select v40 from aggJoin6373851799303141855 group by v40;
create or replace view aggJoin9102907741432050052 as select v40 from aggJoin3389745277809017953 join aggView6664279985320032865 using(v40);
create or replace view aggView2379947697758934834 as select v40 from aggJoin9102907741432050052 group by v40;
create or replace view aggJoin5719516891451032011 as select v40 from aggJoin1487192495334212741 join aggView2379947697758934834 using(v40);
create or replace view aggView2792241336925431 as select id as v26 from kind_type as kt where kind= 'movie';
create or replace view aggJoin4293492701324785469 as select id as v40, title as v41 from title as t, aggView2792241336925431 where t.kind_id=aggView2792241336925431.v26 and production_year>2000;
create or replace view aggView4127195011982723257 as select v40, MIN(v41) as v52 from aggJoin4293492701324785469 group by v40;
create or replace view aggJoin216597809989837773 as select v52 from aggJoin5719516891451032011 join aggView4127195011982723257 using(v40);
select MIN(v52) as v52 from aggJoin216597809989837773;
