create or replace view aggView3665003042141576947 as select id as v5 from comp_cast_type as cct1 where kind= 'cast';
create or replace view aggJoin3529832678241078700 as select movie_id as v40, status_id as v7 from complete_cast as cc, aggView3665003042141576947 where cc.subject_id=aggView3665003042141576947.v5;
create or replace view aggView5418025576370600447 as select id as v23 from keyword as k where keyword IN ('superhero','sequel','second-part','marvel-comics','based-on-comic','tv-special','fight','violence');
create or replace view aggJoin4404687044362001922 as select movie_id as v40 from movie_keyword as mk, aggView5418025576370600447 where mk.keyword_id=aggView5418025576370600447.v23;
create or replace view aggView8794563315940236254 as select id as v31 from name as n where name LIKE '%Downey%Robert%';
create or replace view aggJoin794744306898990713 as select movie_id as v40, person_role_id as v9 from cast_info as ci, aggView8794563315940236254 where ci.person_id=aggView8794563315940236254.v31;
create or replace view aggView1070329957393535945 as select id as v7 from comp_cast_type as cct2 where kind LIKE '%complete%';
create or replace view aggJoin2485365653772878234 as select v40 from aggJoin3529832678241078700 join aggView1070329957393535945 using(v7);
create or replace view aggView667504741541550342 as select id as v9 from char_name as chn where ((name LIKE '%Tony%Stark%') OR (name LIKE '%Iron%Man%')) and name NOT LIKE '%Sherlock%';
create or replace view aggJoin8838395951733129515 as select v40 from aggJoin794744306898990713 join aggView667504741541550342 using(v9);
create or replace view aggView5670641738271182827 as select v40 from aggJoin4404687044362001922 group by v40;
create or replace view aggJoin8296315795013846334 as select v40 from aggJoin2485365653772878234 join aggView5670641738271182827 using(v40);
create or replace view aggView3847314169040110805 as select v40 from aggJoin8296315795013846334 group by v40;
create or replace view aggJoin6338029280096930532 as select id as v40, title as v41, kind_id as v26 from title as t, aggView3847314169040110805 where t.id=aggView3847314169040110805.v40 and production_year>2000;
create or replace view aggView6349792984801992273 as select id as v26 from kind_type as kt where kind= 'movie';
create or replace view aggJoin7291177092678141184 as select v40, v41 from aggJoin6338029280096930532 join aggView6349792984801992273 using(v26);
create or replace view aggView4160523606053550641 as select v40, MIN(v41) as v52 from aggJoin7291177092678141184 group by v40;
create or replace view aggJoin1730802912113010715 as select v52 from aggJoin8838395951733129515 join aggView4160523606053550641 using(v40);
select MIN(v52) as v52 from aggJoin1730802912113010715;
