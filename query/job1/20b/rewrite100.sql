create or replace view aggView8978152934425421715 as select id as v5 from comp_cast_type as cct1 where kind= 'cast';
create or replace view aggJoin4063457455012689656 as select movie_id as v40, status_id as v7 from complete_cast as cc, aggView8978152934425421715 where cc.subject_id=aggView8978152934425421715.v5;
create or replace view aggView9118524877667227375 as select id as v23 from keyword as k where keyword IN ('superhero','sequel','second-part','marvel-comics','based-on-comic','tv-special','fight','violence');
create or replace view aggJoin185225557218208152 as select movie_id as v40 from movie_keyword as mk, aggView9118524877667227375 where mk.keyword_id=aggView9118524877667227375.v23;
create or replace view aggView8202054828517812040 as select id as v7 from comp_cast_type as cct2 where kind LIKE '%complete%';
create or replace view aggJoin2850120783245398027 as select v40 from aggJoin4063457455012689656 join aggView8202054828517812040 using(v7);
create or replace view aggView2552692756815367117 as select id as v9 from char_name as chn where ((name LIKE '%Tony%Stark%') OR (name LIKE '%Iron%Man%')) and name NOT LIKE '%Sherlock%';
create or replace view aggJoin7827076040500906540 as select person_id as v31, movie_id as v40 from cast_info as ci, aggView2552692756815367117 where ci.person_role_id=aggView2552692756815367117.v9;
create or replace view aggView5035953692330491474 as select v40 from aggJoin2850120783245398027 group by v40;
create or replace view aggJoin9013749025971382565 as select v40 from aggJoin185225557218208152 join aggView5035953692330491474 using(v40);
create or replace view aggView47196900013350678 as select v40 from aggJoin9013749025971382565 group by v40;
create or replace view aggJoin1772140677323893849 as select v31, v40 from aggJoin7827076040500906540 join aggView47196900013350678 using(v40);
create or replace view aggView6093310068876805134 as select id as v26 from kind_type as kt where kind= 'movie';
create or replace view aggJoin2137401682207914910 as select id as v40, title as v41 from title as t, aggView6093310068876805134 where t.kind_id=aggView6093310068876805134.v26 and production_year>2000;
create or replace view aggView6139160298199088099 as select v40, MIN(v41) as v52 from aggJoin2137401682207914910 group by v40;
create or replace view aggJoin7601404059496485667 as select v31, v52 from aggJoin1772140677323893849 join aggView6139160298199088099 using(v40);
create or replace view aggView2474087680498916126 as select v31, MIN(v52) as v52 from aggJoin7601404059496485667 group by v31;
create or replace view aggJoin3121527349244078027 as select v52 from name as n, aggView2474087680498916126 where n.id=aggView2474087680498916126.v31 and name LIKE '%Downey%Robert%';
select MIN(v52) as v52 from aggJoin3121527349244078027;
