create or replace view aggView2901271603505566670 as select id as v31 from name as n where name LIKE '%Downey%Robert%';
create or replace view aggJoin3296299612300383169 as select movie_id as v40, person_role_id as v9 from cast_info as ci, aggView2901271603505566670 where ci.person_id=aggView2901271603505566670.v31;
create or replace view aggView1549799894374004049 as select id as v5 from comp_cast_type as cct1 where kind= 'cast';
create or replace view aggJoin8497701025961407190 as select movie_id as v40, status_id as v7 from complete_cast as cc, aggView1549799894374004049 where cc.subject_id=aggView1549799894374004049.v5;
create or replace view aggView5524270933943063375 as select id as v7 from comp_cast_type as cct2 where kind LIKE '%complete%';
create or replace view aggJoin521572810875817982 as select v40 from aggJoin8497701025961407190 join aggView5524270933943063375 using(v7);
create or replace view aggView3135292080753730301 as select v40 from aggJoin521572810875817982 group by v40;
create or replace view aggJoin3761212449669169436 as select id as v40, title as v41, kind_id as v26 from title as t, aggView3135292080753730301 where t.id=aggView3135292080753730301.v40 and production_year>2000;
create or replace view aggView2851308143441814229 as select id as v23 from keyword as k where keyword IN ('superhero','sequel','second-part','marvel-comics','based-on-comic','tv-special','fight','violence');
create or replace view aggJoin2513383155601692447 as select movie_id as v40 from movie_keyword as mk, aggView2851308143441814229 where mk.keyword_id=aggView2851308143441814229.v23;
create or replace view aggView5529579979467006629 as select v40 from aggJoin2513383155601692447 group by v40;
create or replace view aggJoin463184896222700795 as select v40, v41, v26 from aggJoin3761212449669169436 join aggView5529579979467006629 using(v40);
create or replace view aggView1946040412055801977 as select id as v9 from char_name as chn where ((name LIKE '%Tony%Stark%') OR (name LIKE '%Iron%Man%')) and name NOT LIKE '%Sherlock%';
create or replace view aggJoin5903648435022316254 as select v40 from aggJoin3296299612300383169 join aggView1946040412055801977 using(v9);
create or replace view aggView4370836707737706935 as select v40 from aggJoin5903648435022316254 group by v40;
create or replace view aggJoin2317058842663108243 as select v41, v26 from aggJoin463184896222700795 join aggView4370836707737706935 using(v40);
create or replace view aggView8899811121821633526 as select v26, MIN(v41) as v52 from aggJoin2317058842663108243 group by v26;
create or replace view aggJoin7286458261520438666 as select v52 from kind_type as kt, aggView8899811121821633526 where kt.id=aggView8899811121821633526.v26 and kind= 'movie';
create or replace view res as select MIN(v52) as v52 from aggJoin7286458261520438666;
select sum(v52) from res;