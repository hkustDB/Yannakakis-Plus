create or replace view aggView3508661699828248493 as select id as v31 from name as n where name LIKE '%Downey%Robert%';
create or replace view aggJoin8992129876261402473 as select movie_id as v40, person_role_id as v9 from cast_info as ci, aggView3508661699828248493 where ci.person_id=aggView3508661699828248493.v31;
create or replace view aggView6769900431080074383 as select id as v5 from comp_cast_type as cct1 where kind= 'cast';
create or replace view aggJoin8889618889561293772 as select movie_id as v40, status_id as v7 from complete_cast as cc, aggView6769900431080074383 where cc.subject_id=aggView6769900431080074383.v5;
create or replace view aggView148579505819863651 as select id as v7 from comp_cast_type as cct2 where kind LIKE '%complete%';
create or replace view aggJoin612456551873961483 as select v40 from aggJoin8889618889561293772 join aggView148579505819863651 using(v7);
create or replace view aggView5408956990713045353 as select id as v23 from keyword as k where keyword IN ('superhero','sequel','second-part','marvel-comics','based-on-comic','tv-special','fight','violence');
create or replace view aggJoin6565800390568901949 as select movie_id as v40 from movie_keyword as mk, aggView5408956990713045353 where mk.keyword_id=aggView5408956990713045353.v23;
create or replace view aggView470491993402744711 as select id as v9 from char_name as chn where ((name LIKE '%Tony%Stark%') OR (name LIKE '%Iron%Man%')) and name NOT LIKE '%Sherlock%';
create or replace view aggJoin3573137548847834299 as select v40 from aggJoin8992129876261402473 join aggView470491993402744711 using(v9);
create or replace view aggView502846575120817828 as select v40 from aggJoin3573137548847834299 group by v40;
create or replace view aggJoin7639128045643902500 as select v40 from aggJoin612456551873961483 join aggView502846575120817828 using(v40);
create or replace view aggView2404171566640388647 as select id as v26 from kind_type as kt where kind= 'movie';
create or replace view aggJoin2166569487372195069 as select id as v40, title as v41 from title as t, aggView2404171566640388647 where t.kind_id=aggView2404171566640388647.v26 and production_year>2000;
create or replace view aggView8066427269961470312 as select v40, MIN(v41) as v52 from aggJoin2166569487372195069 group by v40;
create or replace view aggJoin6689051116926511724 as select v40, v52 from aggJoin6565800390568901949 join aggView8066427269961470312 using(v40);
create or replace view aggView298804332917365115 as select v40, MIN(v52) as v52 from aggJoin6689051116926511724 group by v40;
create or replace view aggJoin5078974653908286832 as select v52 from aggJoin7639128045643902500 join aggView298804332917365115 using(v40);
create or replace view res as select MIN(v52) as v52 from aggJoin5078974653908286832;
select sum(v52) from res;