create or replace view aggView3299295482881266978 as select id as v5 from comp_cast_type as cct1 where kind= 'cast';
create or replace view aggJoin387791368133138798 as select movie_id as v40, status_id as v7 from complete_cast as cc, aggView3299295482881266978 where cc.subject_id=aggView3299295482881266978.v5;
create or replace view aggView8828445730780554481 as select id as v23 from keyword as k where keyword IN ('superhero','sequel','second-part','marvel-comics','based-on-comic','tv-special','fight','violence');
create or replace view aggJoin4165471999170398002 as select movie_id as v40 from movie_keyword as mk, aggView8828445730780554481 where mk.keyword_id=aggView8828445730780554481.v23;
create or replace view aggView5491501945057068416 as select id as v31 from name as n where name LIKE '%Downey%Robert%';
create or replace view aggJoin1496870637259795634 as select movie_id as v40, person_role_id as v9 from cast_info as ci, aggView5491501945057068416 where ci.person_id=aggView5491501945057068416.v31;
create or replace view aggView5236178200419477866 as select id as v7 from comp_cast_type as cct2 where kind LIKE '%complete%';
create or replace view aggJoin3608373707793894773 as select v40 from aggJoin387791368133138798 join aggView5236178200419477866 using(v7);
create or replace view aggView7605469399228136434 as select id as v9 from char_name as chn where ((name LIKE '%Tony%Stark%') OR (name LIKE '%Iron%Man%')) and name NOT LIKE '%Sherlock%';
create or replace view aggJoin8743219267422831198 as select v40 from aggJoin1496870637259795634 join aggView7605469399228136434 using(v9);
create or replace view aggView8201631599739788981 as select v40 from aggJoin8743219267422831198 group by v40;
create or replace view aggJoin6619162204273244015 as select id as v40, title as v41, kind_id as v26 from title as t, aggView8201631599739788981 where t.id=aggView8201631599739788981.v40 and production_year>2000;
create or replace view aggView3094741782845646684 as select id as v26 from kind_type as kt where kind= 'movie';
create or replace view aggJoin2767713495549354527 as select v40, v41 from aggJoin6619162204273244015 join aggView3094741782845646684 using(v26);
create or replace view aggView6439251736315790436 as select v40, MIN(v41) as v52 from aggJoin2767713495549354527 group by v40;
create or replace view aggJoin3696401488552532552 as select v40, v52 from aggJoin4165471999170398002 join aggView6439251736315790436 using(v40);
create or replace view aggView6051037228361744059 as select v40, MIN(v52) as v52 from aggJoin3696401488552532552 group by v40;
create or replace view aggJoin375909822578781274 as select v52 from aggJoin3608373707793894773 join aggView6051037228361744059 using(v40);
select MIN(v52) as v52 from aggJoin375909822578781274;
