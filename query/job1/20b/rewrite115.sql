create or replace view aggView1062845645425241883 as select id as v5 from comp_cast_type as cct1 where kind= 'cast';
create or replace view aggJoin389904393363466330 as select movie_id as v40, status_id as v7 from complete_cast as cc, aggView1062845645425241883 where cc.subject_id=aggView1062845645425241883.v5;
create or replace view aggView5002040397982511531 as select id as v31 from name as n where name LIKE '%Downey%Robert%';
create or replace view aggJoin7335302271212058122 as select movie_id as v40, person_role_id as v9 from cast_info as ci, aggView5002040397982511531 where ci.person_id=aggView5002040397982511531.v31;
create or replace view aggView764685176132846739 as select id as v23 from keyword as k where keyword IN ('superhero','sequel','second-part','marvel-comics','based-on-comic','tv-special','fight','violence');
create or replace view aggJoin3416549461234887966 as select movie_id as v40 from movie_keyword as mk, aggView764685176132846739 where mk.keyword_id=aggView764685176132846739.v23;
create or replace view aggView8641142248562382424 as select id as v7 from comp_cast_type as cct2 where kind LIKE '%complete%';
create or replace view aggJoin10134650009519891 as select v40 from aggJoin389904393363466330 join aggView8641142248562382424 using(v7);
create or replace view aggView4376114412784830376 as select v40 from aggJoin10134650009519891 group by v40;
create or replace view aggJoin6177408895883613951 as select v40, v9 from aggJoin7335302271212058122 join aggView4376114412784830376 using(v40);
create or replace view aggView8348829881559597175 as select v40 from aggJoin3416549461234887966 group by v40;
create or replace view aggJoin6089515245112255332 as select id as v40, title as v41, kind_id as v26 from title as t, aggView8348829881559597175 where t.id=aggView8348829881559597175.v40 and production_year>2000;
create or replace view aggView3875752895674064545 as select id as v26 from kind_type as kt where kind= 'movie';
create or replace view aggJoin134716215000050238 as select v40, v41 from aggJoin6089515245112255332 join aggView3875752895674064545 using(v26);
create or replace view aggView2289751881573986151 as select v40, MIN(v41) as v52 from aggJoin134716215000050238 group by v40;
create or replace view aggJoin4491797493682302087 as select v9, v52 from aggJoin6177408895883613951 join aggView2289751881573986151 using(v40);
create or replace view aggView1875815532335778255 as select v9, MIN(v52) as v52 from aggJoin4491797493682302087 group by v9;
create or replace view aggJoin5148493574776393918 as select v52 from char_name as chn, aggView1875815532335778255 where chn.id=aggView1875815532335778255.v9 and ((name LIKE '%Tony%Stark%') OR (name LIKE '%Iron%Man%')) and name NOT LIKE '%Sherlock%';
create or replace view res as select MIN(v52) as v52 from aggJoin5148493574776393918;
select sum(v52) from res;