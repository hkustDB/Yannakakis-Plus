create or replace view aggView7367877006215994545 as select id as v31 from name as n where name LIKE '%Downey%Robert%';
create or replace view aggJoin4968173372422538070 as select movie_id as v40, person_role_id as v9 from cast_info as ci, aggView7367877006215994545 where ci.person_id=aggView7367877006215994545.v31;
create or replace view aggView8351016919751648197 as select id as v5 from comp_cast_type as cct1 where kind= 'cast';
create or replace view aggJoin1468088811533143601 as select movie_id as v40, status_id as v7 from complete_cast as cc, aggView8351016919751648197 where cc.subject_id=aggView8351016919751648197.v5;
create or replace view aggView5197642742329113999 as select id as v7 from comp_cast_type as cct2 where kind LIKE '%complete%';
create or replace view aggJoin449396702566257339 as select v40 from aggJoin1468088811533143601 join aggView5197642742329113999 using(v7);
create or replace view aggView84033083161887258 as select id as v23 from keyword as k where keyword IN ('superhero','sequel','second-part','marvel-comics','based-on-comic','tv-special','fight','violence');
create or replace view aggJoin5225752104371448358 as select movie_id as v40 from movie_keyword as mk, aggView84033083161887258 where mk.keyword_id=aggView84033083161887258.v23;
create or replace view aggView8098207770908819469 as select v40 from aggJoin5225752104371448358 group by v40;
create or replace view aggJoin701627575609677249 as select id as v40, title as v41, kind_id as v26 from title as t, aggView8098207770908819469 where t.id=aggView8098207770908819469.v40 and production_year>2000;
create or replace view aggView818023912986165743 as select id as v9 from char_name as chn where ((name LIKE '%Tony%Stark%') OR (name LIKE '%Iron%Man%')) and name NOT LIKE '%Sherlock%';
create or replace view aggJoin4093729770517758898 as select v40 from aggJoin4968173372422538070 join aggView818023912986165743 using(v9);
create or replace view aggView6408112470457934383 as select v40 from aggJoin4093729770517758898 group by v40;
create or replace view aggJoin313776578264412557 as select v40, v41, v26 from aggJoin701627575609677249 join aggView6408112470457934383 using(v40);
create or replace view aggView4238146529246039227 as select id as v26 from kind_type as kt where kind= 'movie';
create or replace view aggJoin2171211023504294243 as select v40, v41 from aggJoin313776578264412557 join aggView4238146529246039227 using(v26);
create or replace view aggView3338021531089872172 as select v40, MIN(v41) as v52 from aggJoin2171211023504294243 group by v40;
create or replace view aggJoin3038637761570291472 as select v52 from aggJoin449396702566257339 join aggView3338021531089872172 using(v40);
create or replace view res as select MIN(v52) as v52 from aggJoin3038637761570291472;
select sum(v52) from res;