create or replace view aggView2321519599790374602 as select id as v31 from name as n where name LIKE '%Downey%Robert%';
create or replace view aggJoin4424376926380517397 as select movie_id as v40, person_role_id as v9 from cast_info as ci, aggView2321519599790374602 where ci.person_id=aggView2321519599790374602.v31;
create or replace view aggView3068859769371991082 as select id as v5 from comp_cast_type as cct1 where kind= 'cast';
create or replace view aggJoin2253024517613574454 as select movie_id as v40, status_id as v7 from complete_cast as cc, aggView3068859769371991082 where cc.subject_id=aggView3068859769371991082.v5;
create or replace view aggView4980494193998270892 as select id as v7 from comp_cast_type as cct2 where kind LIKE '%complete%';
create or replace view aggJoin3256954226758385376 as select v40 from aggJoin2253024517613574454 join aggView4980494193998270892 using(v7);
create or replace view aggView4575199902022924440 as select v40 from aggJoin3256954226758385376 group by v40;
create or replace view aggJoin3044193029723405070 as select id as v40, title as v41, kind_id as v26 from title as t, aggView4575199902022924440 where t.id=aggView4575199902022924440.v40 and production_year>2000;
create or replace view aggView2451230414689134889 as select id as v9 from char_name as chn where ((name LIKE '%Tony%Stark%') OR (name LIKE '%Iron%Man%')) and name NOT LIKE '%Sherlock%';
create or replace view aggJoin4975765900308765470 as select v40 from aggJoin4424376926380517397 join aggView2451230414689134889 using(v9);
create or replace view aggView8899385652981525328 as select v40 from aggJoin4975765900308765470 group by v40;
create or replace view aggJoin6413955053485859085 as select v40, v41, v26 from aggJoin3044193029723405070 join aggView8899385652981525328 using(v40);
create or replace view aggView1308579710495539601 as select id as v26 from kind_type as kt where kind= 'movie';
create or replace view aggJoin4529729364552238459 as select v40, v41 from aggJoin6413955053485859085 join aggView1308579710495539601 using(v26);
create or replace view aggView2370852204412838549 as select v40, MIN(v41) as v52 from aggJoin4529729364552238459 group by v40;
create or replace view aggJoin3932779106908294071 as select keyword_id as v23, v52 from movie_keyword as mk, aggView2370852204412838549 where mk.movie_id=aggView2370852204412838549.v40;
create or replace view aggView254369375944397674 as select v23, MIN(v52) as v52 from aggJoin3932779106908294071 group by v23;
create or replace view aggJoin8058273878072692750 as select v52 from keyword as k, aggView254369375944397674 where k.id=aggView254369375944397674.v23 and keyword IN ('superhero','sequel','second-part','marvel-comics','based-on-comic','tv-special','fight','violence');
create or replace view res as select MIN(v52) as v52 from aggJoin8058273878072692750;
select sum(v52) from res;