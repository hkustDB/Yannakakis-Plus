create or replace view aggView8136594121052622062 as select id as v23 from keyword as k where keyword IN ('superhero','sequel','second-part','marvel-comics','based-on-comic','tv-special','fight','violence');
create or replace view aggJoin223441664613253122 as select movie_id as v40 from movie_keyword as mk, aggView8136594121052622062 where mk.keyword_id=aggView8136594121052622062.v23;
create or replace view aggView8786221482155383736 as select id as v5 from comp_cast_type as cct1 where kind= 'cast';
create or replace view aggJoin8203434528932415482 as select movie_id as v40, status_id as v7 from complete_cast as cc, aggView8786221482155383736 where cc.subject_id=aggView8786221482155383736.v5;
create or replace view aggView3356553228546628905 as select id as v7 from comp_cast_type as cct2 where kind LIKE '%complete%';
create or replace view aggJoin1331898238961555150 as select v40 from aggJoin8203434528932415482 join aggView3356553228546628905 using(v7);
create or replace view aggView6103855253819816158 as select v40 from aggJoin1331898238961555150 group by v40;
create or replace view aggJoin4616125368679043247 as select person_id as v31, movie_id as v40, person_role_id as v9 from cast_info as ci, aggView6103855253819816158 where ci.movie_id=aggView6103855253819816158.v40;
create or replace view aggView5805770985945466310 as select id as v31 from name as n where name LIKE '%Downey%Robert%';
create or replace view aggJoin8298896609162324751 as select v40, v9 from aggJoin4616125368679043247 join aggView5805770985945466310 using(v31);
create or replace view aggView4430847732339418339 as select id as v26 from kind_type as kt where kind= 'movie';
create or replace view aggJoin410675796571248094 as select id as v40, title as v41 from title as t, aggView4430847732339418339 where t.kind_id=aggView4430847732339418339.v26 and production_year>2000;
create or replace view aggView8919289479714395006 as select v40, MIN(v41) as v52 from aggJoin410675796571248094 group by v40;
create or replace view aggJoin3267057082301672825 as select v40, v52 from aggJoin223441664613253122 join aggView8919289479714395006 using(v40);
create or replace view aggView420779371498832481 as select v40, MIN(v52) as v52 from aggJoin3267057082301672825 group by v40;
create or replace view aggJoin5253919459167786505 as select v9, v52 from aggJoin8298896609162324751 join aggView420779371498832481 using(v40);
create or replace view aggView8846523511434830018 as select v9, MIN(v52) as v52 from aggJoin5253919459167786505 group by v9;
create or replace view aggJoin5326309897990855276 as select v52 from char_name as chn, aggView8846523511434830018 where chn.id=aggView8846523511434830018.v9 and ((name LIKE '%Tony%Stark%') OR (name LIKE '%Iron%Man%')) and name NOT LIKE '%Sherlock%';
create or replace view res as select MIN(v52) as v52 from aggJoin5326309897990855276;
select sum(v52) from res;