create or replace view aggView8730290645438415741 as select id as v5 from comp_cast_type as cct1 where kind= 'cast';
create or replace view aggJoin6780964049215188728 as select movie_id as v40, status_id as v7 from complete_cast as cc, aggView8730290645438415741 where cc.subject_id=aggView8730290645438415741.v5;
create or replace view aggView6344998010466776659 as select id as v7 from comp_cast_type as cct2 where kind LIKE '%complete%';
create or replace view aggJoin625887426913194324 as select v40 from aggJoin6780964049215188728 join aggView6344998010466776659 using(v7);
create or replace view aggView1334678914821227971 as select v40 from aggJoin625887426913194324 group by v40;
create or replace view aggJoin6323868901695820798 as select person_id as v31, movie_id as v40, person_role_id as v9 from cast_info as ci, aggView1334678914821227971 where ci.movie_id=aggView1334678914821227971.v40;
create or replace view aggView6897150848109869632 as select id as v23 from keyword as k where keyword IN ('superhero','sequel','second-part','marvel-comics','based-on-comic','tv-special','fight','violence');
create or replace view aggJoin6028338052536071456 as select movie_id as v40 from movie_keyword as mk, aggView6897150848109869632 where mk.keyword_id=aggView6897150848109869632.v23;
create or replace view aggView6096829458590066303 as select v40 from aggJoin6028338052536071456 group by v40;
create or replace view aggJoin4550231908677153398 as select id as v40, title as v41, kind_id as v26 from title as t, aggView6096829458590066303 where t.id=aggView6096829458590066303.v40 and production_year>2000;
create or replace view aggView7835424991951253314 as select id as v9 from char_name as chn where ((name LIKE '%Tony%Stark%') OR (name LIKE '%Iron%Man%')) and name NOT LIKE '%Sherlock%';
create or replace view aggJoin3018829655787335637 as select v31, v40 from aggJoin6323868901695820798 join aggView7835424991951253314 using(v9);
create or replace view aggView95438505271558021 as select id as v26 from kind_type as kt where kind= 'movie';
create or replace view aggJoin1727452325184800188 as select v40, v41 from aggJoin4550231908677153398 join aggView95438505271558021 using(v26);
create or replace view aggView5709335284838934638 as select v40, MIN(v41) as v52 from aggJoin1727452325184800188 group by v40;
create or replace view aggJoin4290485077044573829 as select v31, v52 from aggJoin3018829655787335637 join aggView5709335284838934638 using(v40);
create or replace view aggView3529392300039593190 as select v31, MIN(v52) as v52 from aggJoin4290485077044573829 group by v31;
create or replace view aggJoin5704219281295318692 as select v52 from name as n, aggView3529392300039593190 where n.id=aggView3529392300039593190.v31 and name LIKE '%Downey%Robert%';
create or replace view res as select MIN(v52) as v52 from aggJoin5704219281295318692;
select sum(v52) from res;