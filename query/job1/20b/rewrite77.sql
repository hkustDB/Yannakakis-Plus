create or replace view aggView3325389344911321271 as select id as v31 from name as n where name LIKE '%Downey%Robert%';
create or replace view aggJoin7025535341404353941 as select movie_id as v40, person_role_id as v9 from cast_info as ci, aggView3325389344911321271 where ci.person_id=aggView3325389344911321271.v31;
create or replace view aggView7578006562131129545 as select id as v5 from comp_cast_type as cct1 where kind= 'cast';
create or replace view aggJoin1031995335957246752 as select movie_id as v40, status_id as v7 from complete_cast as cc, aggView7578006562131129545 where cc.subject_id=aggView7578006562131129545.v5;
create or replace view aggView8968157429425156961 as select id as v7 from comp_cast_type as cct2 where kind LIKE '%complete%';
create or replace view aggJoin1749688428311521773 as select v40 from aggJoin1031995335957246752 join aggView8968157429425156961 using(v7);
create or replace view aggView8613586526607273849 as select id as v23 from keyword as k where keyword IN ('superhero','sequel','second-part','marvel-comics','based-on-comic','tv-special','fight','violence');
create or replace view aggJoin4184273063270168237 as select movie_id as v40 from movie_keyword as mk, aggView8613586526607273849 where mk.keyword_id=aggView8613586526607273849.v23;
create or replace view aggView7827465012459518239 as select v40 from aggJoin4184273063270168237 group by v40;
create or replace view aggJoin3838796533605031102 as select v40 from aggJoin1749688428311521773 join aggView7827465012459518239 using(v40);
create or replace view aggView3907161077417214277 as select v40 from aggJoin3838796533605031102 group by v40;
create or replace view aggJoin3561450088048864010 as select v40, v9 from aggJoin7025535341404353941 join aggView3907161077417214277 using(v40);
create or replace view aggView6250700878884169624 as select id as v26 from kind_type as kt where kind= 'movie';
create or replace view aggJoin4415569360326278183 as select id as v40, title as v41 from title as t, aggView6250700878884169624 where t.kind_id=aggView6250700878884169624.v26 and production_year>2000;
create or replace view aggView2514124288843989639 as select v40, MIN(v41) as v52 from aggJoin4415569360326278183 group by v40;
create or replace view aggJoin630013219571204195 as select v9, v52 from aggJoin3561450088048864010 join aggView2514124288843989639 using(v40);
create or replace view aggView2354485845889038079 as select v9, MIN(v52) as v52 from aggJoin630013219571204195 group by v9;
create or replace view aggJoin1458203035218688868 as select v52 from char_name as chn, aggView2354485845889038079 where chn.id=aggView2354485845889038079.v9 and ((name LIKE '%Tony%Stark%') OR (name LIKE '%Iron%Man%')) and name NOT LIKE '%Sherlock%';
create or replace view res as select MIN(v52) as v52 from aggJoin1458203035218688868;
select sum(v52) from res;