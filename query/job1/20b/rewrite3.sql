create or replace view aggView8966127163766500730 as select id as v5 from comp_cast_type as cct1 where kind= 'cast';
create or replace view aggJoin2347422980229875390 as select movie_id as v40, status_id as v7 from complete_cast as cc, aggView8966127163766500730 where cc.subject_id=aggView8966127163766500730.v5;
create or replace view aggView2094690296068885736 as select id as v23 from keyword as k where keyword IN ('superhero','sequel','second-part','marvel-comics','based-on-comic','tv-special','fight','violence');
create or replace view aggJoin3744077961601760961 as select movie_id as v40 from movie_keyword as mk, aggView2094690296068885736 where mk.keyword_id=aggView2094690296068885736.v23;
create or replace view aggView7756389056604170140 as select id as v31 from name as n where name LIKE '%Downey%Robert%';
create or replace view aggJoin4878195312463695679 as select movie_id as v40, person_role_id as v9 from cast_info as ci, aggView7756389056604170140 where ci.person_id=aggView7756389056604170140.v31;
create or replace view aggView4315062176509147935 as select id as v9 from char_name as chn where ((name LIKE '%Tony%Stark%') OR (name LIKE '%Iron%Man%')) and name NOT LIKE '%Sherlock%';
create or replace view aggJoin2356599116491869410 as select v40 from aggJoin4878195312463695679 join aggView4315062176509147935 using(v9);
create or replace view aggView1930277376243261351 as select v40 from aggJoin2356599116491869410 group by v40;
create or replace view aggJoin2262030662938467206 as select v40 from aggJoin3744077961601760961 join aggView1930277376243261351 using(v40);
create or replace view aggView3615781485992007137 as select v40 from aggJoin2262030662938467206 group by v40;
create or replace view aggJoin3771763683630693347 as select id as v40, title as v41, kind_id as v26 from title as t, aggView3615781485992007137 where t.id=aggView3615781485992007137.v40 and production_year>2000;
create or replace view aggView1132948958186504344 as select id as v26 from kind_type as kt where kind= 'movie';
create or replace view aggJoin4852715757386995821 as select v40, v41 from aggJoin3771763683630693347 join aggView1132948958186504344 using(v26);
create or replace view aggView3229637057621336662 as select v40, MIN(v41) as v52 from aggJoin4852715757386995821 group by v40;
create or replace view aggJoin3747929603338612555 as select v7, v52 from aggJoin2347422980229875390 join aggView3229637057621336662 using(v40);
create or replace view aggView1646971154603568837 as select v7, MIN(v52) as v52 from aggJoin3747929603338612555 group by v7;
create or replace view aggJoin7081586737887214796 as select v52 from comp_cast_type as cct2, aggView1646971154603568837 where cct2.id=aggView1646971154603568837.v7 and kind LIKE '%complete%';
select MIN(v52) as v52 from aggJoin7081586737887214796;
