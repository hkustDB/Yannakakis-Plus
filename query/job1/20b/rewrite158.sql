create or replace view aggView628989150217068106 as select id as v5 from comp_cast_type as cct1 where kind= 'cast';
create or replace view aggJoin9099138531995539278 as select movie_id as v40, status_id as v7 from complete_cast as cc, aggView628989150217068106 where cc.subject_id=aggView628989150217068106.v5;
create or replace view aggView3569411047331883783 as select id as v31 from name as n where name LIKE '%Downey%Robert%';
create or replace view aggJoin8035392543420291672 as select movie_id as v40, person_role_id as v9 from cast_info as ci, aggView3569411047331883783 where ci.person_id=aggView3569411047331883783.v31;
create or replace view aggView7666785861417387560 as select id as v23 from keyword as k where keyword IN ('superhero','sequel','second-part','marvel-comics','based-on-comic','tv-special','fight','violence');
create or replace view aggJoin4235814687298332017 as select movie_id as v40 from movie_keyword as mk, aggView7666785861417387560 where mk.keyword_id=aggView7666785861417387560.v23;
create or replace view aggView513959980395794459 as select v40 from aggJoin4235814687298332017 group by v40;
create or replace view aggJoin2909854906746892591 as select v40, v9 from aggJoin8035392543420291672 join aggView513959980395794459 using(v40);
create or replace view aggView1510110566257162489 as select id as v7 from comp_cast_type as cct2 where kind LIKE '%complete%';
create or replace view aggJoin291462916100486710 as select v40 from aggJoin9099138531995539278 join aggView1510110566257162489 using(v7);
create or replace view aggView270869508016447610 as select v40 from aggJoin291462916100486710 group by v40;
create or replace view aggJoin8654154353665154047 as select v40, v9 from aggJoin2909854906746892591 join aggView270869508016447610 using(v40);
create or replace view aggView2823744369533219035 as select id as v9 from char_name as chn where ((name LIKE '%Tony%Stark%') OR (name LIKE '%Iron%Man%')) and name NOT LIKE '%Sherlock%';
create or replace view aggJoin3419393746384278506 as select v40 from aggJoin8654154353665154047 join aggView2823744369533219035 using(v9);
create or replace view aggView6593552502667892294 as select id as v26 from kind_type as kt where kind= 'movie';
create or replace view aggJoin6491599420836777516 as select id as v40, title as v41 from title as t, aggView6593552502667892294 where t.kind_id=aggView6593552502667892294.v26 and production_year>2000;
create or replace view aggView8772465016948343444 as select v40, MIN(v41) as v52 from aggJoin6491599420836777516 group by v40;
create or replace view aggJoin1141398419461353421 as select v52 from aggJoin3419393746384278506 join aggView8772465016948343444 using(v40);
create or replace view res as select MIN(v52) as v52 from aggJoin1141398419461353421;
select sum(v52) from res;