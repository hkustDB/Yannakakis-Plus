create or replace view aggView493654965063916768 as select id as v31 from name as n where name LIKE '%Downey%Robert%';
create or replace view aggJoin3905421128883394248 as select movie_id as v40, person_role_id as v9 from cast_info as ci, aggView493654965063916768 where ci.person_id=aggView493654965063916768.v31;
create or replace view aggView9022569910863058434 as select id as v23 from keyword as k where keyword IN ('superhero','sequel','second-part','marvel-comics','based-on-comic','tv-special','fight','violence');
create or replace view aggJoin4829610630296783159 as select movie_id as v40 from movie_keyword as mk, aggView9022569910863058434 where mk.keyword_id=aggView9022569910863058434.v23;
create or replace view aggView5427310296700821061 as select v40 from aggJoin4829610630296783159 group by v40;
create or replace view aggJoin1351304505292553221 as select v40, v9 from aggJoin3905421128883394248 join aggView5427310296700821061 using(v40);
create or replace view aggView3897468766133979497 as select id as v7 from comp_cast_type as cct2 where kind LIKE '%complete%';
create or replace view aggJoin5249057384074393483 as select movie_id as v40, subject_id as v5 from complete_cast as cc, aggView3897468766133979497 where cc.status_id=aggView3897468766133979497.v7;
create or replace view aggView5533323766566208426 as select id as v9 from char_name as chn where ((name LIKE '%Tony%Stark%') OR (name LIKE '%Iron%Man%')) and name NOT LIKE '%Sherlock%';
create or replace view aggJoin5349004346499964913 as select v40 from aggJoin1351304505292553221 join aggView5533323766566208426 using(v9);
create or replace view aggView6879673515413003447 as select id as v26 from kind_type as kt where kind= 'movie';
create or replace view aggJoin7179925754513636533 as select id as v40, title as v41 from title as t, aggView6879673515413003447 where t.kind_id=aggView6879673515413003447.v26 and production_year>2000;
create or replace view aggView3280482067949015833 as select v40, MIN(v41) as v52 from aggJoin7179925754513636533 group by v40;
create or replace view aggJoin8286630446732605515 as select v40, v52 from aggJoin5349004346499964913 join aggView3280482067949015833 using(v40);
create or replace view aggView6680680444668209218 as select v40, MIN(v52) as v52 from aggJoin8286630446732605515 group by v40;
create or replace view aggJoin7989496131419183188 as select v5, v52 from aggJoin5249057384074393483 join aggView6680680444668209218 using(v40);
create or replace view aggView7115954726562670177 as select v5, MIN(v52) as v52 from aggJoin7989496131419183188 group by v5;
create or replace view aggJoin4925269765078435917 as select v52 from comp_cast_type as cct1, aggView7115954726562670177 where cct1.id=aggView7115954726562670177.v5 and kind= 'cast';
create or replace view res as select MIN(v52) as v52 from aggJoin4925269765078435917;
select sum(v52) from res;