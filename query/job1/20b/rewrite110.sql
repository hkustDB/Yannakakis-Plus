create or replace view aggView5439303981983721330 as select id as v5 from comp_cast_type as cct1 where kind= 'cast';
create or replace view aggJoin2329336692310792126 as select movie_id as v40, status_id as v7 from complete_cast as cc, aggView5439303981983721330 where cc.subject_id=aggView5439303981983721330.v5;
create or replace view aggView3370682375616386559 as select id as v31 from name as n where name LIKE '%Downey%Robert%';
create or replace view aggJoin254083747153443556 as select movie_id as v40, person_role_id as v9 from cast_info as ci, aggView3370682375616386559 where ci.person_id=aggView3370682375616386559.v31;
create or replace view aggView2474076490586926228 as select id as v23 from keyword as k where keyword IN ('superhero','sequel','second-part','marvel-comics','based-on-comic','tv-special','fight','violence');
create or replace view aggJoin8983634375889876192 as select movie_id as v40 from movie_keyword as mk, aggView2474076490586926228 where mk.keyword_id=aggView2474076490586926228.v23;
create or replace view aggView9077646987415839854 as select id as v7 from comp_cast_type as cct2 where kind LIKE '%complete%';
create or replace view aggJoin3095813446674064239 as select v40 from aggJoin2329336692310792126 join aggView9077646987415839854 using(v7);
create or replace view aggView4330682948386808953 as select v40 from aggJoin3095813446674064239 group by v40;
create or replace view aggJoin4921568989045442563 as select v40 from aggJoin8983634375889876192 join aggView4330682948386808953 using(v40);
create or replace view aggView3738243037073911559 as select id as v26 from kind_type as kt where kind= 'movie';
create or replace view aggJoin1350545368735623863 as select id as v40, title as v41 from title as t, aggView3738243037073911559 where t.kind_id=aggView3738243037073911559.v26 and production_year>2000;
create or replace view aggView3011213878057634025 as select v40, MIN(v41) as v52 from aggJoin1350545368735623863 group by v40;
create or replace view aggJoin8009751143311312879 as select v40, v52 from aggJoin4921568989045442563 join aggView3011213878057634025 using(v40);
create or replace view aggView6856085890742170403 as select v40, MIN(v52) as v52 from aggJoin8009751143311312879 group by v40;
create or replace view aggJoin9085452230133162949 as select v9, v52 from aggJoin254083747153443556 join aggView6856085890742170403 using(v40);
create or replace view aggView245566279886172576 as select v9, MIN(v52) as v52 from aggJoin9085452230133162949 group by v9;
create or replace view aggJoin7084309134308325024 as select v52 from char_name as chn, aggView245566279886172576 where chn.id=aggView245566279886172576.v9 and ((name LIKE '%Tony%Stark%') OR (name LIKE '%Iron%Man%')) and name NOT LIKE '%Sherlock%';
create or replace view res as select MIN(v52) as v52 from aggJoin7084309134308325024;
select sum(v52) from res;