create or replace view aggView9194705353657819067 as select id as v5 from comp_cast_type as cct1 where kind= 'cast';
create or replace view aggJoin1803707551608338511 as select movie_id as v40, status_id as v7 from complete_cast as cc, aggView9194705353657819067 where cc.subject_id=aggView9194705353657819067.v5;
create or replace view aggView2711029724190475465 as select id as v31 from name as n where name LIKE '%Downey%Robert%';
create or replace view aggJoin1431404471432773179 as select movie_id as v40, person_role_id as v9 from cast_info as ci, aggView2711029724190475465 where ci.person_id=aggView2711029724190475465.v31;
create or replace view aggView791992791189553042 as select id as v23 from keyword as k where keyword IN ('superhero','sequel','second-part','marvel-comics','based-on-comic','tv-special','fight','violence');
create or replace view aggJoin3647761540207451825 as select movie_id as v40 from movie_keyword as mk, aggView791992791189553042 where mk.keyword_id=aggView791992791189553042.v23;
create or replace view aggView8535145691834183688 as select v40 from aggJoin3647761540207451825 group by v40;
create or replace view aggJoin5972118361558915692 as select v40, v7 from aggJoin1803707551608338511 join aggView8535145691834183688 using(v40);
create or replace view aggView2435242687304939120 as select id as v7 from comp_cast_type as cct2 where kind LIKE '%complete%';
create or replace view aggJoin2460787780243357279 as select v40 from aggJoin5972118361558915692 join aggView2435242687304939120 using(v7);
create or replace view aggView506764267822676223 as select id as v9 from char_name as chn where ((name LIKE '%Tony%Stark%') OR (name LIKE '%Iron%Man%')) and name NOT LIKE '%Sherlock%';
create or replace view aggJoin1835404898582223658 as select v40 from aggJoin1431404471432773179 join aggView506764267822676223 using(v9);
create or replace view aggView6453441913759644959 as select id as v26 from kind_type as kt where kind= 'movie';
create or replace view aggJoin4599378815843599985 as select id as v40, title as v41 from title as t, aggView6453441913759644959 where t.kind_id=aggView6453441913759644959.v26 and production_year>2000;
create or replace view aggView2445493358557170445 as select v40, MIN(v41) as v52 from aggJoin4599378815843599985 group by v40;
create or replace view aggJoin7450167705721934854 as select v40, v52 from aggJoin2460787780243357279 join aggView2445493358557170445 using(v40);
create or replace view aggView1500217194865979560 as select v40, MIN(v52) as v52 from aggJoin7450167705721934854 group by v40;
create or replace view aggJoin8077965882355565206 as select v52 from aggJoin1835404898582223658 join aggView1500217194865979560 using(v40);
create or replace view res as select MIN(v52) as v52 from aggJoin8077965882355565206;
select sum(v52) from res;