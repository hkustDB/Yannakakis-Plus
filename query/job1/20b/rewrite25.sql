create or replace view aggView6568733403173186309 as select id as v5 from comp_cast_type as cct1 where kind= 'cast';
create or replace view aggJoin7947035591065745138 as select movie_id as v40, status_id as v7 from complete_cast as cc, aggView6568733403173186309 where cc.subject_id=aggView6568733403173186309.v5;
create or replace view aggView1187988398679268472 as select id as v31 from name as n where name LIKE '%Downey%Robert%';
create or replace view aggJoin2422584084001662386 as select movie_id as v40, person_role_id as v9 from cast_info as ci, aggView1187988398679268472 where ci.person_id=aggView1187988398679268472.v31;
create or replace view aggView1726186469882471394 as select id as v7 from comp_cast_type as cct2 where kind LIKE '%complete%';
create or replace view aggJoin3092661588749666124 as select v40 from aggJoin7947035591065745138 join aggView1726186469882471394 using(v7);
create or replace view aggView6139643711414273530 as select id as v26 from kind_type as kt where kind= 'movie';
create or replace view aggJoin1491979817351945794 as select id as v40, title as v41, production_year as v44 from title as t, aggView6139643711414273530 where t.kind_id=aggView6139643711414273530.v26 and production_year>2000;
create or replace view aggView3242779920246772623 as select v40, MIN(v41) as v52 from aggJoin1491979817351945794 group by v40;
create or replace view aggJoin8657373893729452835 as select v40, v9, v52 from aggJoin2422584084001662386 join aggView3242779920246772623 using(v40);
create or replace view aggView3986263664332341396 as select v40 from aggJoin3092661588749666124 group by v40;
create or replace view aggJoin4357156217410958032 as select movie_id as v40, keyword_id as v23 from movie_keyword as mk, aggView3986263664332341396 where mk.movie_id=aggView3986263664332341396.v40;
create or replace view aggView5252873547765801117 as select id as v9 from char_name as chn where ((name LIKE '%Tony%Stark%') OR (name LIKE '%Iron%Man%')) and name NOT LIKE '%Sherlock%';
create or replace view aggJoin1792085587815023214 as select v40, v52 from aggJoin8657373893729452835 join aggView5252873547765801117 using(v9);
create or replace view aggView731813469583506656 as select id as v23 from keyword as k where keyword IN ('superhero','sequel','second-part','marvel-comics','based-on-comic','tv-special','fight','violence');
create or replace view aggJoin6956575355266491872 as select v40 from aggJoin4357156217410958032 join aggView731813469583506656 using(v23);
create or replace view aggView2891733330360529396 as select v40 from aggJoin6956575355266491872 group by v40;
create or replace view aggJoin5375951815005419792 as select v52 as v52 from aggJoin1792085587815023214 join aggView2891733330360529396 using(v40);
select MIN(v52) as v52 from aggJoin5375951815005419792;
