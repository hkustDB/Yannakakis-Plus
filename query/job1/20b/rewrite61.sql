create or replace view aggView1654508615333297352 as select id as v5 from comp_cast_type as cct1 where kind= 'cast';
create or replace view aggJoin5418362096394982927 as select movie_id as v40, status_id as v7 from complete_cast as cc, aggView1654508615333297352 where cc.subject_id=aggView1654508615333297352.v5;
create or replace view aggView6112965984681964796 as select id as v23 from keyword as k where keyword IN ('superhero','sequel','second-part','marvel-comics','based-on-comic','tv-special','fight','violence');
create or replace view aggJoin2424385949161924597 as select movie_id as v40 from movie_keyword as mk, aggView6112965984681964796 where mk.keyword_id=aggView6112965984681964796.v23;
create or replace view aggView4187336094598736096 as select v40 from aggJoin2424385949161924597 group by v40;
create or replace view aggJoin2158368328386529026 as select v40, v7 from aggJoin5418362096394982927 join aggView4187336094598736096 using(v40);
create or replace view aggView5613428862256381825 as select id as v7 from comp_cast_type as cct2 where kind LIKE '%complete%';
create or replace view aggJoin8643383898436846327 as select v40 from aggJoin2158368328386529026 join aggView5613428862256381825 using(v7);
create or replace view aggView6871214191151048761 as select v40 from aggJoin8643383898436846327 group by v40;
create or replace view aggJoin344434437406740562 as select person_id as v31, movie_id as v40, person_role_id as v9 from cast_info as ci, aggView6871214191151048761 where ci.movie_id=aggView6871214191151048761.v40;
create or replace view aggView2345129313703009306 as select id as v9 from char_name as chn where ((name LIKE '%Tony%Stark%') OR (name LIKE '%Iron%Man%')) and name NOT LIKE '%Sherlock%';
create or replace view aggJoin5321001087340397608 as select v31, v40 from aggJoin344434437406740562 join aggView2345129313703009306 using(v9);
create or replace view aggView8630569162046181394 as select id as v26 from kind_type as kt where kind= 'movie';
create or replace view aggJoin5563861916574293715 as select id as v40, title as v41 from title as t, aggView8630569162046181394 where t.kind_id=aggView8630569162046181394.v26 and production_year>2000;
create or replace view aggView890774255056819167 as select v40, MIN(v41) as v52 from aggJoin5563861916574293715 group by v40;
create or replace view aggJoin8857773617910065601 as select v31, v52 from aggJoin5321001087340397608 join aggView890774255056819167 using(v40);
create or replace view aggView1121843143397800877 as select v31, MIN(v52) as v52 from aggJoin8857773617910065601 group by v31;
create or replace view aggJoin7775814575254277514 as select v52 from name as n, aggView1121843143397800877 where n.id=aggView1121843143397800877.v31 and name LIKE '%Downey%Robert%';
create or replace view res as select MIN(v52) as v52 from aggJoin7775814575254277514;
select sum(v52) from res;