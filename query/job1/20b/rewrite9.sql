create or replace view aggView2622344657419736974 as select id as v31 from name as n where name LIKE '%Downey%Robert%';
create or replace view aggJoin4355534784482443467 as select movie_id as v40, person_role_id as v9 from cast_info as ci, aggView2622344657419736974 where ci.person_id=aggView2622344657419736974.v31;
create or replace view aggView9008946821337920067 as select id as v5 from comp_cast_type as cct1 where kind= 'cast';
create or replace view aggJoin4732868299927941694 as select movie_id as v40, status_id as v7 from complete_cast as cc, aggView9008946821337920067 where cc.subject_id=aggView9008946821337920067.v5;
create or replace view aggView7688284697801966908 as select id as v7 from comp_cast_type as cct2 where kind LIKE '%complete%';
create or replace view aggJoin7210844940268568000 as select v40 from aggJoin4732868299927941694 join aggView7688284697801966908 using(v7);
create or replace view aggView3855987581235487752 as select id as v23 from keyword as k where keyword IN ('superhero','sequel','second-part','marvel-comics','based-on-comic','tv-special','fight','violence');
create or replace view aggJoin4437042920461158483 as select movie_id as v40 from movie_keyword as mk, aggView3855987581235487752 where mk.keyword_id=aggView3855987581235487752.v23;
create or replace view aggView4086437945492023414 as select id as v9 from char_name as chn where ((name LIKE '%Tony%Stark%') OR (name LIKE '%Iron%Man%')) and name NOT LIKE '%Sherlock%';
create or replace view aggJoin6715791443434793318 as select v40 from aggJoin4355534784482443467 join aggView4086437945492023414 using(v9);
create or replace view aggView2001996456040368282 as select v40 from aggJoin6715791443434793318 group by v40;
create or replace view aggJoin7614574818457076211 as select id as v40, title as v41, kind_id as v26 from title as t, aggView2001996456040368282 where t.id=aggView2001996456040368282.v40 and production_year>2000;
create or replace view aggView3698955338086095780 as select v40 from aggJoin7210844940268568000 group by v40;
create or replace view aggJoin6696361022024894964 as select v40 from aggJoin4437042920461158483 join aggView3698955338086095780 using(v40);
create or replace view aggView1791772318467251002 as select v40 from aggJoin6696361022024894964 group by v40;
create or replace view aggJoin8476843016622846390 as select v41, v26 from aggJoin7614574818457076211 join aggView1791772318467251002 using(v40);
create or replace view aggView157047711637753595 as select v26, MIN(v41) as v52 from aggJoin8476843016622846390 group by v26;
create or replace view aggJoin6912522281944065951 as select v52 from kind_type as kt, aggView157047711637753595 where kt.id=aggView157047711637753595.v26 and kind= 'movie';
create or replace view res as select MIN(v52) as v52 from aggJoin6912522281944065951;
select sum(v52) from res;