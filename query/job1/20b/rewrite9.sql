create or replace view aggView8456421778667214031 as select id as v5 from comp_cast_type as cct1 where kind= 'cast';
create or replace view aggJoin450020363982792552 as select movie_id as v40, status_id as v7 from complete_cast as cc, aggView8456421778667214031 where cc.subject_id=aggView8456421778667214031.v5;
create or replace view aggView7326689035176882019 as select id as v31 from name as n where name LIKE '%Downey%Robert%';
create or replace view aggJoin4580602137840910324 as select movie_id as v40, person_role_id as v9 from cast_info as ci, aggView7326689035176882019 where ci.person_id=aggView7326689035176882019.v31;
create or replace view aggView8708337637280479141 as select id as v7 from comp_cast_type as cct2 where kind LIKE '%complete%';
create or replace view aggJoin2109389431394346364 as select v40 from aggJoin450020363982792552 join aggView8708337637280479141 using(v7);
create or replace view aggView1678855917275853856 as select v40 from aggJoin2109389431394346364 group by v40;
create or replace view aggJoin232749388131689416 as select id as v40, title as v41, kind_id as v26, production_year as v44 from title as t, aggView1678855917275853856 where t.id=aggView1678855917275853856.v40 and production_year>2000;
create or replace view aggView1798461913212446144 as select id as v26 from kind_type as kt where kind= 'movie';
create or replace view aggJoin652459145894680289 as select v40, v41, v44 from aggJoin232749388131689416 join aggView1798461913212446144 using(v26);
create or replace view aggView7750626819558487289 as select id as v9 from char_name as chn where ((name LIKE '%Tony%Stark%') OR (name LIKE '%Iron%Man%')) and name NOT LIKE '%Sherlock%';
create or replace view aggJoin5445532231107355864 as select v40 from aggJoin4580602137840910324 join aggView7750626819558487289 using(v9);
create or replace view aggView7459639541617778267 as select id as v23 from keyword as k where keyword IN ('superhero','sequel','second-part','marvel-comics','based-on-comic','tv-special','fight','violence');
create or replace view aggJoin4078686535651651442 as select movie_id as v40 from movie_keyword as mk, aggView7459639541617778267 where mk.keyword_id=aggView7459639541617778267.v23;
create or replace view aggView8480261512841539102 as select v40 from aggJoin4078686535651651442 group by v40;
create or replace view aggJoin7344939028495161568 as select v40 from aggJoin5445532231107355864 join aggView8480261512841539102 using(v40);
create or replace view aggView2238103548468921503 as select v40 from aggJoin7344939028495161568 group by v40;
create or replace view aggJoin3036068801950410307 as select v41, v44 from aggJoin652459145894680289 join aggView2238103548468921503 using(v40);
create or replace view aggView8891893065540738737 as select v41 from aggJoin3036068801950410307 group by v41;
select min(v41) as v52 from aggView8891893065540738737;
