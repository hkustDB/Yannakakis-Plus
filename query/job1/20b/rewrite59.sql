create or replace view aggView1946064610114881493 as select id as v31 from name as n where name LIKE '%Downey%Robert%';
create or replace view aggJoin53498127090596513 as select movie_id as v40, person_role_id as v9 from cast_info as ci, aggView1946064610114881493 where ci.person_id=aggView1946064610114881493.v31;
create or replace view aggView6592695327866014904 as select id as v7 from comp_cast_type as cct2 where kind LIKE '%complete%';
create or replace view aggJoin7719998923522011268 as select movie_id as v40, subject_id as v5 from complete_cast as cc, aggView6592695327866014904 where cc.status_id=aggView6592695327866014904.v7;
create or replace view aggView6627826011442238397 as select id as v23 from keyword as k where keyword IN ('superhero','sequel','second-part','marvel-comics','based-on-comic','tv-special','fight','violence');
create or replace view aggJoin8856836547195279207 as select movie_id as v40 from movie_keyword as mk, aggView6627826011442238397 where mk.keyword_id=aggView6627826011442238397.v23;
create or replace view aggView5186066020900684534 as select id as v9 from char_name as chn where ((name LIKE '%Tony%Stark%') OR (name LIKE '%Iron%Man%')) and name NOT LIKE '%Sherlock%';
create or replace view aggJoin2740486225791242628 as select v40 from aggJoin53498127090596513 join aggView5186066020900684534 using(v9);
create or replace view aggView3573150867179630491 as select id as v26 from kind_type as kt where kind= 'movie';
create or replace view aggJoin7516068072888306624 as select id as v40, title as v41 from title as t, aggView3573150867179630491 where t.kind_id=aggView3573150867179630491.v26 and production_year>2000;
create or replace view aggView2587863811223342122 as select v40 from aggJoin8856836547195279207 group by v40;
create or replace view aggJoin3323208441018381587 as select v40 from aggJoin2740486225791242628 join aggView2587863811223342122 using(v40);
create or replace view aggView1222244645199750144 as select v40 from aggJoin3323208441018381587 group by v40;
create or replace view aggJoin9036874933777873735 as select v40, v41 from aggJoin7516068072888306624 join aggView1222244645199750144 using(v40);
create or replace view aggView8190523309273141851 as select v40, MIN(v41) as v52 from aggJoin9036874933777873735 group by v40;
create or replace view aggJoin5360595689519179484 as select v5, v52 from aggJoin7719998923522011268 join aggView8190523309273141851 using(v40);
create or replace view aggView5635957558357181340 as select v5, MIN(v52) as v52 from aggJoin5360595689519179484 group by v5;
create or replace view aggJoin5525101890498441202 as select v52 from comp_cast_type as cct1, aggView5635957558357181340 where cct1.id=aggView5635957558357181340.v5 and kind= 'cast';
create or replace view res as select MIN(v52) as v52 from aggJoin5525101890498441202;
select sum(v52) from res;