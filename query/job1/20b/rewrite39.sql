create or replace view aggView7345982163086042275 as select id as v31 from name as n where name LIKE '%Downey%Robert%';
create or replace view aggJoin5665555299305016230 as select movie_id as v40, person_role_id as v9 from cast_info as ci, aggView7345982163086042275 where ci.person_id=aggView7345982163086042275.v31;
create or replace view aggView801793456041751674 as select id as v7 from comp_cast_type as cct2 where kind LIKE '%complete%';
create or replace view aggJoin6536432075923017671 as select movie_id as v40, subject_id as v5 from complete_cast as cc, aggView801793456041751674 where cc.status_id=aggView801793456041751674.v7;
create or replace view aggView2502814225056414549 as select id as v23 from keyword as k where keyword IN ('superhero','sequel','second-part','marvel-comics','based-on-comic','tv-special','fight','violence');
create or replace view aggJoin7499025892386200660 as select movie_id as v40 from movie_keyword as mk, aggView2502814225056414549 where mk.keyword_id=aggView2502814225056414549.v23;
create or replace view aggView7115188520828783727 as select v40 from aggJoin7499025892386200660 group by v40;
create or replace view aggJoin7225755243868122028 as select id as v40, title as v41, kind_id as v26 from title as t, aggView7115188520828783727 where t.id=aggView7115188520828783727.v40 and production_year>2000;
create or replace view aggView1676906898706866099 as select id as v9 from char_name as chn where ((name LIKE '%Tony%Stark%') OR (name LIKE '%Iron%Man%')) and name NOT LIKE '%Sherlock%';
create or replace view aggJoin2740667331839517752 as select v40 from aggJoin5665555299305016230 join aggView1676906898706866099 using(v9);
create or replace view aggView5368298948303637041 as select id as v26 from kind_type as kt where kind= 'movie';
create or replace view aggJoin4404927609678769777 as select v40, v41 from aggJoin7225755243868122028 join aggView5368298948303637041 using(v26);
create or replace view aggView5431247711313998509 as select v40, MIN(v41) as v52 from aggJoin4404927609678769777 group by v40;
create or replace view aggJoin3895513183591610159 as select v40, v52 from aggJoin2740667331839517752 join aggView5431247711313998509 using(v40);
create or replace view aggView2563984897690713305 as select v40, MIN(v52) as v52 from aggJoin3895513183591610159 group by v40;
create or replace view aggJoin8453510420795003558 as select v5, v52 from aggJoin6536432075923017671 join aggView2563984897690713305 using(v40);
create or replace view aggView1343166444814174792 as select v5, MIN(v52) as v52 from aggJoin8453510420795003558 group by v5;
create or replace view aggJoin4511289827107024348 as select v52 from comp_cast_type as cct1, aggView1343166444814174792 where cct1.id=aggView1343166444814174792.v5 and kind= 'cast';
create or replace view res as select MIN(v52) as v52 from aggJoin4511289827107024348;
select sum(v52) from res;