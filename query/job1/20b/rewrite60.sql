create or replace view aggView4550757307320292631 as select id as v31 from name as n where name LIKE '%Downey%Robert%';
create or replace view aggJoin2150123854278770101 as select movie_id as v40, person_role_id as v9 from cast_info as ci, aggView4550757307320292631 where ci.person_id=aggView4550757307320292631.v31;
create or replace view aggView7321317858074157715 as select id as v23 from keyword as k where keyword IN ('superhero','sequel','second-part','marvel-comics','based-on-comic','tv-special','fight','violence');
create or replace view aggJoin5489653264130704354 as select movie_id as v40 from movie_keyword as mk, aggView7321317858074157715 where mk.keyword_id=aggView7321317858074157715.v23;
create or replace view aggView5926423504239920704 as select v40 from aggJoin5489653264130704354 group by v40;
create or replace view aggJoin237741237792222454 as select id as v40, title as v41, kind_id as v26 from title as t, aggView5926423504239920704 where t.id=aggView5926423504239920704.v40 and production_year>2000;
create or replace view aggView7007049505785656250 as select id as v7 from comp_cast_type as cct2 where kind LIKE '%complete%';
create or replace view aggJoin6219187217944712689 as select movie_id as v40, subject_id as v5 from complete_cast as cc, aggView7007049505785656250 where cc.status_id=aggView7007049505785656250.v7;
create or replace view aggView340655478359406122 as select id as v9 from char_name as chn where ((name LIKE '%Tony%Stark%') OR (name LIKE '%Iron%Man%')) and name NOT LIKE '%Sherlock%';
create or replace view aggJoin6983506675176985045 as select v40 from aggJoin2150123854278770101 join aggView340655478359406122 using(v9);
create or replace view aggView549516953154841218 as select id as v26 from kind_type as kt where kind= 'movie';
create or replace view aggJoin5559780682330663229 as select v40, v41 from aggJoin237741237792222454 join aggView549516953154841218 using(v26);
create or replace view aggView321626475356701899 as select v40, MIN(v41) as v52 from aggJoin5559780682330663229 group by v40;
create or replace view aggJoin8933642300899001303 as select v40, v52 from aggJoin6983506675176985045 join aggView321626475356701899 using(v40);
create or replace view aggView5470667408939715379 as select v40, MIN(v52) as v52 from aggJoin8933642300899001303 group by v40;
create or replace view aggJoin8609333191269806023 as select v5, v52 from aggJoin6219187217944712689 join aggView5470667408939715379 using(v40);
create or replace view aggView206003763685822712 as select v5, MIN(v52) as v52 from aggJoin8609333191269806023 group by v5;
create or replace view aggJoin3785477662359658052 as select v52 from comp_cast_type as cct1, aggView206003763685822712 where cct1.id=aggView206003763685822712.v5 and kind= 'cast';
create or replace view res as select MIN(v52) as v52 from aggJoin3785477662359658052;
select sum(v52) from res;