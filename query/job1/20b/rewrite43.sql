create or replace view aggView7718687788902605961 as select id as v23 from keyword as k where keyword IN ('superhero','sequel','second-part','marvel-comics','based-on-comic','tv-special','fight','violence');
create or replace view aggJoin7228514358109391288 as select movie_id as v40 from movie_keyword as mk, aggView7718687788902605961 where mk.keyword_id=aggView7718687788902605961.v23;
create or replace view aggView7440090792009000435 as select id as v5 from comp_cast_type as cct1 where kind= 'cast';
create or replace view aggJoin4749862413522038967 as select movie_id as v40, status_id as v7 from complete_cast as cc, aggView7440090792009000435 where cc.subject_id=aggView7440090792009000435.v5;
create or replace view aggView6398735183004416137 as select id as v7 from comp_cast_type as cct2 where kind LIKE '%complete%';
create or replace view aggJoin859709500717782988 as select v40 from aggJoin4749862413522038967 join aggView6398735183004416137 using(v7);
create or replace view aggView5064251771692021100 as select id as v9 from char_name as chn where ((name LIKE '%Tony%Stark%') OR (name LIKE '%Iron%Man%')) and name NOT LIKE '%Sherlock%';
create or replace view aggJoin1574239733714601059 as select person_id as v31, movie_id as v40 from cast_info as ci, aggView5064251771692021100 where ci.person_role_id=aggView5064251771692021100.v9;
create or replace view aggView7866604615406769162 as select id as v26 from kind_type as kt where kind= 'movie';
create or replace view aggJoin7744011887628979156 as select id as v40, title as v41 from title as t, aggView7866604615406769162 where t.kind_id=aggView7866604615406769162.v26 and production_year>2000;
create or replace view aggView2333393963695190611 as select v40, MIN(v41) as v52 from aggJoin7744011887628979156 group by v40;
create or replace view aggJoin535080908989053546 as select v31, v40, v52 from aggJoin1574239733714601059 join aggView2333393963695190611 using(v40);
create or replace view aggView8961777998936172331 as select v40 from aggJoin7228514358109391288 group by v40;
create or replace view aggJoin5666209443374997790 as select v40 from aggJoin859709500717782988 join aggView8961777998936172331 using(v40);
create or replace view aggView1068994427232179343 as select v40 from aggJoin5666209443374997790 group by v40;
create or replace view aggJoin5101644391982010739 as select v31, v52 as v52 from aggJoin535080908989053546 join aggView1068994427232179343 using(v40);
create or replace view aggView416984479924246800 as select v31, MIN(v52) as v52 from aggJoin5101644391982010739 group by v31;
create or replace view aggJoin76486323332382965 as select v52 from name as n, aggView416984479924246800 where n.id=aggView416984479924246800.v31 and name LIKE '%Downey%Robert%';
create or replace view res as select MIN(v52) as v52 from aggJoin76486323332382965;
select sum(v52) from res;