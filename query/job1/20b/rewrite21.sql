create or replace view aggView4333082871259900251 as select id as v5 from comp_cast_type as cct1 where kind= 'cast';
create or replace view aggJoin2856955119177133947 as select movie_id as v40, status_id as v7 from complete_cast as cc, aggView4333082871259900251 where cc.subject_id=aggView4333082871259900251.v5;
create or replace view aggView8178718735084348700 as select id as v31 from name as n where name LIKE '%Downey%Robert%';
create or replace view aggJoin5688749976118984310 as select movie_id as v40, person_role_id as v9 from cast_info as ci, aggView8178718735084348700 where ci.person_id=aggView8178718735084348700.v31;
create or replace view aggView1451160623990313313 as select id as v23 from keyword as k where keyword IN ('superhero','sequel','second-part','marvel-comics','based-on-comic','tv-special','fight','violence');
create or replace view aggJoin3626337264896629931 as select movie_id as v40 from movie_keyword as mk, aggView1451160623990313313 where mk.keyword_id=aggView1451160623990313313.v23;
create or replace view aggView2301104554757685586 as select v40 from aggJoin3626337264896629931 group by v40;
create or replace view aggJoin6984017066634591904 as select v40, v9 from aggJoin5688749976118984310 join aggView2301104554757685586 using(v40);
create or replace view aggView7160043424369782563 as select id as v7 from comp_cast_type as cct2 where kind LIKE '%complete%';
create or replace view aggJoin6794888141202382449 as select v40 from aggJoin2856955119177133947 join aggView7160043424369782563 using(v7);
create or replace view aggView7227895979972239199 as select id as v9 from char_name as chn where ((name LIKE '%Tony%Stark%') OR (name LIKE '%Iron%Man%')) and name NOT LIKE '%Sherlock%';
create or replace view aggJoin6629253968889107058 as select v40 from aggJoin6984017066634591904 join aggView7227895979972239199 using(v9);
create or replace view aggView2311943814611977297 as select v40 from aggJoin6629253968889107058 group by v40;
create or replace view aggJoin4854823330716705804 as select id as v40, title as v41, kind_id as v26 from title as t, aggView2311943814611977297 where t.id=aggView2311943814611977297.v40 and production_year>2000;
create or replace view aggView2708777007067529863 as select id as v26 from kind_type as kt where kind= 'movie';
create or replace view aggJoin7702916980826879988 as select v40, v41 from aggJoin4854823330716705804 join aggView2708777007067529863 using(v26);
create or replace view aggView1660780429631249490 as select v40, MIN(v41) as v52 from aggJoin7702916980826879988 group by v40;
create or replace view aggJoin2826857091472300052 as select v52 from aggJoin6794888141202382449 join aggView1660780429631249490 using(v40);
create or replace view res as select MIN(v52) as v52 from aggJoin2826857091472300052;
select sum(v52) from res;