create or replace view aggView2695458806677338670 as select id as v31 from name as n where name LIKE '%Downey%Robert%';
create or replace view aggJoin7918299037175773854 as select movie_id as v40, person_role_id as v9 from cast_info as ci, aggView2695458806677338670 where ci.person_id=aggView2695458806677338670.v31;
create or replace view aggView4840521535094309898 as select id as v5 from comp_cast_type as cct1 where kind= 'cast';
create or replace view aggJoin6628275475927873849 as select movie_id as v40, status_id as v7 from complete_cast as cc, aggView4840521535094309898 where cc.subject_id=aggView4840521535094309898.v5;
create or replace view aggView1592854273429199466 as select id as v7 from comp_cast_type as cct2 where kind LIKE '%complete%';
create or replace view aggJoin4558329071956872440 as select v40 from aggJoin6628275475927873849 join aggView1592854273429199466 using(v7);
create or replace view aggView3085206476375919114 as select v40 from aggJoin4558329071956872440 group by v40;
create or replace view aggJoin4560514793967324325 as select v40, v9 from aggJoin7918299037175773854 join aggView3085206476375919114 using(v40);
create or replace view aggView5784372785575034550 as select id as v23 from keyword as k where keyword IN ('superhero','sequel','second-part','marvel-comics','based-on-comic','tv-special','fight','violence');
create or replace view aggJoin9130909071951465260 as select movie_id as v40 from movie_keyword as mk, aggView5784372785575034550 where mk.keyword_id=aggView5784372785575034550.v23;
create or replace view aggView2989075894254560177 as select id as v9 from char_name as chn where ((name LIKE '%Tony%Stark%') OR (name LIKE '%Iron%Man%')) and name NOT LIKE '%Sherlock%';
create or replace view aggJoin5436729703907749833 as select v40 from aggJoin4560514793967324325 join aggView2989075894254560177 using(v9);
create or replace view aggView1225578942042687623 as select id as v26 from kind_type as kt where kind= 'movie';
create or replace view aggJoin6021793971505078018 as select id as v40, title as v41 from title as t, aggView1225578942042687623 where t.kind_id=aggView1225578942042687623.v26 and production_year>2000;
create or replace view aggView4694814120844560883 as select v40, MIN(v41) as v52 from aggJoin6021793971505078018 group by v40;
create or replace view aggJoin8109893729483371033 as select v40, v52 from aggJoin9130909071951465260 join aggView4694814120844560883 using(v40);
create or replace view aggView4023471847725489620 as select v40 from aggJoin5436729703907749833 group by v40;
create or replace view aggJoin8580997533442317976 as select v52 as v52 from aggJoin8109893729483371033 join aggView4023471847725489620 using(v40);
create or replace view res as select MIN(v52) as v52 from aggJoin8580997533442317976;
select sum(v52) from res;