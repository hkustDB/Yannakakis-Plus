create or replace view aggView3130934932144203076 as select id as v26, name as v47 from name as n;
create or replace view aggJoin4326230018681745305 as select movie_id as v3, v47 from cast_info as ci, aggView3130934932144203076 where ci.person_id=aggView3130934932144203076.v26;
create or replace view aggView2158435174606218393 as select id as v3 from title as t;
create or replace view aggJoin7535996915483563372 as select movie_id as v3, keyword_id as v25 from movie_keyword as mk, aggView2158435174606218393 where mk.movie_id=aggView2158435174606218393.v3;
create or replace view aggView2012405076637781942 as select id as v25 from keyword as k where keyword= 'character-name-in-title';
create or replace view aggJoin4878040679999471311 as select v3 from aggJoin7535996915483563372 join aggView2012405076637781942 using(v25);
create or replace view aggView2213983611295172657 as select v3 from aggJoin4878040679999471311 group by v3;
create or replace view aggJoin1294069785901135857 as select v3, v47 as v47 from aggJoin4326230018681745305 join aggView2213983611295172657 using(v3);
create or replace view aggView608019226118374218 as select v3, MIN(v47) as v47 from aggJoin1294069785901135857 group by v3;
create or replace view aggJoin5020624659499998900 as select company_id as v20, v47 from movie_companies as mc, aggView608019226118374218 where mc.movie_id=aggView608019226118374218.v3;
create or replace view aggView4271201412433151157 as select v20, MIN(v47) as v47 from aggJoin5020624659499998900 group by v20;
create or replace view aggJoin163295903435402182 as select country_code as v10, v47 from company_name as cn, aggView4271201412433151157 where cn.id=aggView4271201412433151157.v20 and country_code= '[us]';
create or replace view res as select MIN(v47) as v47 from aggJoin163295903435402182;
select sum(v47) from res;