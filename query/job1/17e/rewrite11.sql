create or replace view aggView9076676081809520595 as select id as v26, name as v47 from name as n;
create or replace view aggJoin6026176557170384035 as select movie_id as v3, v47 from cast_info as ci, aggView9076676081809520595 where ci.person_id=aggView9076676081809520595.v26;
create or replace view aggView3340450331930694220 as select id as v25 from keyword as k where keyword= 'character-name-in-title';
create or replace view aggJoin5681234745724606668 as select movie_id as v3 from movie_keyword as mk, aggView3340450331930694220 where mk.keyword_id=aggView3340450331930694220.v25;
create or replace view aggView755210811997546108 as select v3, MIN(v47) as v47 from aggJoin6026176557170384035 group by v3;
create or replace view aggJoin3685412080630130709 as select id as v3, v47 from title as t, aggView755210811997546108 where t.id=aggView755210811997546108.v3;
create or replace view aggView3590930293687522416 as select v3, MIN(v47) as v47 from aggJoin3685412080630130709 group by v3;
create or replace view aggJoin4918788960079376230 as select v3, v47 from aggJoin5681234745724606668 join aggView3590930293687522416 using(v3);
create or replace view aggView6471279449347758368 as select v3, MIN(v47) as v47 from aggJoin4918788960079376230 group by v3;
create or replace view aggJoin1009935170759392179 as select company_id as v20, v47 from movie_companies as mc, aggView6471279449347758368 where mc.movie_id=aggView6471279449347758368.v3;
create or replace view aggView314628434449448973 as select v20, MIN(v47) as v47 from aggJoin1009935170759392179 group by v20;
create or replace view aggJoin621013582905324616 as select country_code as v10, v47 from company_name as cn, aggView314628434449448973 where cn.id=aggView314628434449448973.v20 and country_code= '[us]';
create or replace view res as select MIN(v47) as v47 from aggJoin621013582905324616;
select sum(v47) from res;