create or replace view aggView2558785221485149621 as select id as v20 from company_name as cn where country_code= '[us]';
create or replace view aggJoin6704392103612153972 as select movie_id as v3 from movie_companies as mc, aggView2558785221485149621 where mc.company_id=aggView2558785221485149621.v20;
create or replace view aggView259373839504615833 as select v3 from aggJoin6704392103612153972 group by v3;
create or replace view aggJoin2506624147316711864 as select id as v3 from title as t, aggView259373839504615833 where t.id=aggView259373839504615833.v3;
create or replace view aggView2557236692674969162 as select id as v25 from keyword as k where keyword= 'character-name-in-title';
create or replace view aggJoin4875090340216654106 as select movie_id as v3 from movie_keyword as mk, aggView2557236692674969162 where mk.keyword_id=aggView2557236692674969162.v25;
create or replace view aggView6661284305102332992 as select v3 from aggJoin4875090340216654106 group by v3;
create or replace view aggJoin2967222829768559239 as select v3 from aggJoin2506624147316711864 join aggView6661284305102332992 using(v3);
create or replace view aggView9118621948123348529 as select v3 from aggJoin2967222829768559239 group by v3;
create or replace view aggJoin1759180324470097440 as select person_id as v26 from cast_info as ci, aggView9118621948123348529 where ci.movie_id=aggView9118621948123348529.v3;
create or replace view aggView5140068641412186059 as select v26 from aggJoin1759180324470097440 group by v26;
create or replace view aggJoin2986497421479812255 as select name as v27 from name as n, aggView5140068641412186059 where n.id=aggView5140068641412186059.v26;
create or replace view res as select MIN(v27) as v47 from aggJoin2986497421479812255;
select sum(v47) from res;