create or replace view aggView4230555316142022079 as select id as v26, name as v47 from name as n;
create or replace view aggJoin2436745402164691277 as select movie_id as v3, v47 from cast_info as ci, aggView4230555316142022079 where ci.person_id=aggView4230555316142022079.v26;
create or replace view aggView8533576980060256240 as select id as v25 from keyword as k where keyword= 'character-name-in-title';
create or replace view aggJoin9007764281501495694 as select movie_id as v3 from movie_keyword as mk, aggView8533576980060256240 where mk.keyword_id=aggView8533576980060256240.v25;
create or replace view aggView137927764877803933 as select v3 from aggJoin9007764281501495694 group by v3;
create or replace view aggJoin2116056345524386191 as select movie_id as v3, company_id as v20 from movie_companies as mc, aggView137927764877803933 where mc.movie_id=aggView137927764877803933.v3;
create or replace view aggView4777759069491464862 as select id as v3 from title as t;
create or replace view aggJoin3415366049430229267 as select v3, v47 from aggJoin2436745402164691277 join aggView4777759069491464862 using(v3);
create or replace view aggView7218989213568904171 as select v3, MIN(v47) as v47 from aggJoin3415366049430229267 group by v3;
create or replace view aggJoin5586001612036013118 as select v20, v47 from aggJoin2116056345524386191 join aggView7218989213568904171 using(v3);
create or replace view aggView6901918905606715214 as select v20, MIN(v47) as v47 from aggJoin5586001612036013118 group by v20;
create or replace view aggJoin4504088765177067171 as select country_code as v10, v47 from company_name as cn, aggView6901918905606715214 where cn.id=aggView6901918905606715214.v20 and country_code= '[us]';
create or replace view res as select MIN(v47) as v47 from aggJoin4504088765177067171;
select sum(v47) from res;