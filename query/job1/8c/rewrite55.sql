create or replace view aggView460151355750898973 as select person_id as v2, MIN(name) as v51 from aka_name as a1 group by person_id;
create or replace view aggJoin25786415579003231 as select person_id as v2, movie_id as v11, role_id as v15, v51 from cast_info as ci, aggView460151355750898973 where ci.person_id=aggView460151355750898973.v2;
create or replace view aggView470170977783614722 as select id as v15 from role_type as rt where role= 'writer';
create or replace view aggJoin4968527108042027414 as select v2, v11, v51 from aggJoin25786415579003231 join aggView470170977783614722 using(v15);
create or replace view aggView3524184802537422029 as select id as v2 from name as n1;
create or replace view aggJoin3601131045659439884 as select v11, v51 from aggJoin4968527108042027414 join aggView3524184802537422029 using(v2);
create or replace view aggView2443493001300745057 as select id as v25 from company_name as cn where country_code= '[us]';
create or replace view aggJoin2526196072371272401 as select movie_id as v11 from movie_companies as mc, aggView2443493001300745057 where mc.company_id=aggView2443493001300745057.v25;
create or replace view aggView3776922757434635629 as select v11 from aggJoin2526196072371272401 group by v11;
create or replace view aggJoin9060867476040429289 as select id as v11, title as v40 from title as t, aggView3776922757434635629 where t.id=aggView3776922757434635629.v11;
create or replace view aggView3700616684399751095 as select v11, MIN(v40) as v52 from aggJoin9060867476040429289 group by v11;
create or replace view aggJoin2685936382452555275 as select v51 as v51, v52 from aggJoin3601131045659439884 join aggView3700616684399751095 using(v11);
select MIN(v51) as v51,MIN(v52) as v52 from aggJoin2685936382452555275;
