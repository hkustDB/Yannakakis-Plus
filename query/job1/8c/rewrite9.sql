create or replace view aggView1729153741290764022 as select id as v15 from role_type as rt where role= 'writer';
create or replace view aggJoin3245109038104351515 as select person_id as v2, movie_id as v11 from cast_info as ci, aggView1729153741290764022 where ci.role_id=aggView1729153741290764022.v15;
create or replace view aggView5829322393084081714 as select id as v25 from company_name as cn where country_code= '[us]';
create or replace view aggJoin5979158686494024156 as select movie_id as v11 from movie_companies as mc, aggView5829322393084081714 where mc.company_id=aggView5829322393084081714.v25;
create or replace view aggView2172437341525115754 as select v11 from aggJoin5979158686494024156 group by v11;
create or replace view aggJoin5983386347359128807 as select id as v11, title as v40 from title as t, aggView2172437341525115754 where t.id=aggView2172437341525115754.v11;
create or replace view aggView1141961557281478419 as select v11, MIN(v40) as v52 from aggJoin5983386347359128807 group by v11;
create or replace view aggJoin8523476417205727414 as select v2, v52 from aggJoin3245109038104351515 join aggView1141961557281478419 using(v11);
create or replace view aggView3762875199086380131 as select v2, MIN(v52) as v52 from aggJoin8523476417205727414 group by v2;
create or replace view aggJoin8923058314121381900 as select person_id as v2, name as v3, v52 from aka_name as a1, aggView3762875199086380131 where a1.person_id=aggView3762875199086380131.v2;
create or replace view aggView9192487938482495394 as select v2, MIN(v52) as v52, MIN(v3) as v51 from aggJoin8923058314121381900 group by v2;
create or replace view aggJoin1941751542852485340 as select v52, v51 from name as n1, aggView9192487938482495394 where n1.id=aggView9192487938482495394.v2;
create or replace view res as select MIN(v51) as v51, MIN(v52) as v52 from aggJoin1941751542852485340;
select sum(v51+v52) from res;