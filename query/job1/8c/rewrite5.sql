create or replace view aggView4921883447030323522 as select name as v3, person_id as v2 from aka_name as an;
create or replace view aggView1562787801927998454 as select id as v25 from company_name as cn where country_code= '[us]';
create or replace view aggJoin7274462878851480386 as select movie_id as v11 from movie_companies as mc, aggView1562787801927998454 where mc.company_id=aggView1562787801927998454.v25;
create or replace view aggView5034302206700921848 as select v11 from aggJoin7274462878851480386 group by v11;
create or replace view aggJoin5156150775640776384 as select id as v11, title as v40 from title as t, aggView5034302206700921848 where t.id=aggView5034302206700921848.v11;
create or replace view aggView3205439903218053190 as select v40, v11 from aggJoin5156150775640776384;
create or replace view aggView6125868601370448326 as select v11, MIN(v40) as v52 from aggView3205439903218053190 group by v11;
create or replace view aggJoin1474850650191694029 as select person_id as v2, role_id as v15, v52 from cast_info as ci, aggView6125868601370448326 where ci.movie_id=aggView6125868601370448326.v11;
create or replace view aggView3677734067528284560 as select id as v15 from role_type as rt where role= 'writer';
create or replace view aggJoin8381570073445119199 as select v2, v52 from aggJoin1474850650191694029 join aggView3677734067528284560 using(v15);
create or replace view aggView1400298743666735050 as select id as v2 from name as n1;
create or replace view aggJoin5230238954054686539 as select v2, v52 from aggJoin8381570073445119199 join aggView1400298743666735050 using(v2);
create or replace view aggView1415940711835268551 as select v2, MIN(v52) as v52 from aggJoin5230238954054686539 group by v2;
create or replace view aggJoin4070906123877351056 as select v3, v52 from aggView4921883447030323522 join aggView1415940711835268551 using(v2);
select MIN(v3) as v51,MIN(v52) as v52 from aggJoin4070906123877351056;
