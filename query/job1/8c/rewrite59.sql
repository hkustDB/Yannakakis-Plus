create or replace view aggView7491181068089243220 as select person_id as v2, MIN(name) as v51 from aka_name as a1 group by person_id;
create or replace view aggJoin4218613560329067269 as select person_id as v2, movie_id as v11, role_id as v15, v51 from cast_info as ci, aggView7491181068089243220 where ci.person_id=aggView7491181068089243220.v2;
create or replace view aggView7375206771944731375 as select id as v11, title as v52 from title as t;
create or replace view aggJoin6791277888429166380 as select v2, v11, v15, v51 from aggJoin4218613560329067269 join aggView7375206771944731375 using(v11);
create or replace view aggView8538519049492660881 as select id as v2 from name as n1;
create or replace view aggJoin7124780973719318152 as select v11, v15, v51 from aggJoin6791277888429166380 join aggView8538519049492660881 using(v2);
create or replace view aggView1001231832182048861 as select id as v25 from company_name as cn where country_code= '[us]';
create or replace view aggJoin4210542275417895481 as select movie_id as v11 from movie_companies as mc, aggView1001231832182048861 where mc.company_id=aggView1001231832182048861.v25;
create or replace view aggView9154423836828759174 as select v11 from aggJoin4210542275417895481 group by v11;
create or replace view aggJoin2375076634356028991 as select v15, v51 as v51 from aggJoin7124780973719318152 join aggView9154423836828759174 using(v11);
create or replace view aggView7598400764632649120 as select v15, MIN(v51) as v51 from aggJoin2375076634356028991 group by v15;
create or replace view aggJoin718691680811402096 as select role as v38, v51 from role_type as rt, aggView7598400764632649120 where rt.id=aggView7598400764632649120.v15 and role= 'writer';
create or replace view res as select MIN(v51) as v51, MIN(v52) as v52 from aggJoin718691680811402096;
select sum(v51+v52) from res;