create or replace view aggView9037833780352787255 as select person_id as v2, MIN(name) as v51 from aka_name as a1 group by person_id;
create or replace view aggJoin5270146329006448680 as select id as v2, v51 from name as n1, aggView9037833780352787255 where n1.id=aggView9037833780352787255.v2;
create or replace view aggView815794523384419772 as select id as v11, title as v52 from title as t;
create or replace view aggJoin7049086025076279198 as select person_id as v2, movie_id as v11, role_id as v15, v52 from cast_info as ci, aggView815794523384419772 where ci.movie_id=aggView815794523384419772.v11;
create or replace view aggView6536339857105296828 as select id as v15 from role_type as rt where role= 'writer';
create or replace view aggJoin1486529127821666345 as select v2, v11, v52 from aggJoin7049086025076279198 join aggView6536339857105296828 using(v15);
create or replace view aggView2637795631907265296 as select v2, MIN(v51) as v51 from aggJoin5270146329006448680 group by v2;
create or replace view aggJoin659286131605742021 as select v11, v52 as v52, v51 from aggJoin1486529127821666345 join aggView2637795631907265296 using(v2);
create or replace view aggView942105242293858647 as select v11, MIN(v52) as v52, MIN(v51) as v51 from aggJoin659286131605742021 group by v11;
create or replace view aggJoin800803907555990889 as select company_id as v25, v52, v51 from movie_companies as mc, aggView942105242293858647 where mc.movie_id=aggView942105242293858647.v11;
create or replace view aggView4630378085042425253 as select v25, MIN(v52) as v52, MIN(v51) as v51 from aggJoin800803907555990889 group by v25;
create or replace view aggJoin8771653286873831577 as select country_code as v18, v52, v51 from company_name as cn, aggView4630378085042425253 where cn.id=aggView4630378085042425253.v25 and country_code= '[us]';
create or replace view res as select MIN(v51) as v51, MIN(v52) as v52 from aggJoin8771653286873831577;
select sum(v51+v52) from res;