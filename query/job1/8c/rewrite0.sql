create or replace view aggView6774071028038050118 as select id as v2 from name as n1;
create or replace view aggJoin620482944604596463 as select person_id as v2, name as v3 from aka_name as a1, aggView6774071028038050118 where a1.person_id=aggView6774071028038050118.v2;
create or replace view aggView4222350321546695603 as select v2, MIN(v3) as v51 from aggJoin620482944604596463 group by v2;
create or replace view aggJoin2575961290447104687 as select movie_id as v11, role_id as v15, v51 from cast_info as ci, aggView4222350321546695603 where ci.person_id=aggView4222350321546695603.v2;
create or replace view aggView3373718106685196555 as select id as v15 from role_type as rt where role= 'writer';
create or replace view aggJoin1614758113934109470 as select v11, v51 from aggJoin2575961290447104687 join aggView3373718106685196555 using(v15);
create or replace view aggView2736288714314277319 as select v11, MIN(v51) as v51 from aggJoin1614758113934109470 group by v11;
create or replace view aggJoin2635728827351565813 as select id as v11, title as v40, v51 from title as t, aggView2736288714314277319 where t.id=aggView2736288714314277319.v11;
create or replace view aggView5474005043968978500 as select v11, MIN(v51) as v51, MIN(v40) as v52 from aggJoin2635728827351565813 group by v11;
create or replace view aggJoin3371369239856395007 as select company_id as v25, v51, v52 from movie_companies as mc, aggView5474005043968978500 where mc.movie_id=aggView5474005043968978500.v11;
create or replace view aggView6665340810547932388 as select v25, MIN(v51) as v51, MIN(v52) as v52 from aggJoin3371369239856395007 group by v25;
create or replace view aggJoin461791745433288912 as select country_code as v18, v51, v52 from company_name as cn, aggView6665340810547932388 where cn.id=aggView6665340810547932388.v25 and country_code= '[us]';
create or replace view res as select MIN(v51) as v51, MIN(v52) as v52 from aggJoin461791745433288912;
select sum(v51+v52) from res;