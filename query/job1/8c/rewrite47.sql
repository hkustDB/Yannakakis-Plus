create or replace view aggView1504810154079943538 as select person_id as v2, MIN(name) as v51 from aka_name as a1 group by person_id;
create or replace view aggJoin5617505360991942278 as select person_id as v2, movie_id as v11, role_id as v15, v51 from cast_info as ci, aggView1504810154079943538 where ci.person_id=aggView1504810154079943538.v2;
create or replace view aggView1520555009628353832 as select id as v15 from role_type as rt where role= 'writer';
create or replace view aggJoin6804530628331392935 as select v2, v11, v51 from aggJoin5617505360991942278 join aggView1520555009628353832 using(v15);
create or replace view aggView7671306636500913172 as select id as v2 from name as n1;
create or replace view aggJoin1643476698803374325 as select v11, v51 from aggJoin6804530628331392935 join aggView7671306636500913172 using(v2);
create or replace view aggView1901263894492807248 as select v11, MIN(v51) as v51 from aggJoin1643476698803374325 group by v11;
create or replace view aggJoin623203113044269166 as select id as v11, title as v40, v51 from title as t, aggView1901263894492807248 where t.id=aggView1901263894492807248.v11;
create or replace view aggView5560631826886544813 as select v11, MIN(v51) as v51, MIN(v40) as v52 from aggJoin623203113044269166 group by v11;
create or replace view aggJoin4085304829882968401 as select company_id as v25, v51, v52 from movie_companies as mc, aggView5560631826886544813 where mc.movie_id=aggView5560631826886544813.v11;
create or replace view aggView7703129362333688743 as select v25, MIN(v51) as v51, MIN(v52) as v52 from aggJoin4085304829882968401 group by v25;
create or replace view aggJoin1383851693569053301 as select country_code as v18, v51, v52 from company_name as cn, aggView7703129362333688743 where cn.id=aggView7703129362333688743.v25 and country_code= '[us]';
select MIN(v51) as v51,MIN(v52) as v52 from aggJoin1383851693569053301;
