create or replace view aggView9157753171234967369 as select person_id as v2, MIN(name) as v51 from aka_name as a1 group by person_id;
create or replace view aggJoin607243508164404075 as select id as v2, v51 from name as n1, aggView9157753171234967369 where n1.id=aggView9157753171234967369.v2;
create or replace view aggView2888622167404488710 as select id as v11, title as v52 from title as t;
create or replace view aggJoin7323099781135721724 as select person_id as v2, movie_id as v11, role_id as v15, v52 from cast_info as ci, aggView2888622167404488710 where ci.movie_id=aggView2888622167404488710.v11;
create or replace view aggView7088441037047529551 as select id as v25 from company_name as cn where country_code= '[us]';
create or replace view aggJoin3197295145630299187 as select movie_id as v11 from movie_companies as mc, aggView7088441037047529551 where mc.company_id=aggView7088441037047529551.v25;
create or replace view aggView6951087289469879535 as select v11 from aggJoin3197295145630299187 group by v11;
create or replace view aggJoin1533434533858501162 as select v2, v15, v52 as v52 from aggJoin7323099781135721724 join aggView6951087289469879535 using(v11);
create or replace view aggView3826501568466870218 as select v2, MIN(v51) as v51 from aggJoin607243508164404075 group by v2;
create or replace view aggJoin3379830759134584495 as select v15, v52 as v52, v51 from aggJoin1533434533858501162 join aggView3826501568466870218 using(v2);
create or replace view aggView2713515041801290809 as select v15, MIN(v52) as v52, MIN(v51) as v51 from aggJoin3379830759134584495 group by v15;
create or replace view aggJoin7510596809918709472 as select role as v38, v52, v51 from role_type as rt, aggView2713515041801290809 where rt.id=aggView2713515041801290809.v15 and role= 'writer';
create or replace view res as select MIN(v51) as v51, MIN(v52) as v52 from aggJoin7510596809918709472;
select sum(v51+v52) from res;