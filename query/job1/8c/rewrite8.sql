create or replace view aggView7268519602492954737 as select person_id as v2, MIN(name) as v51 from aka_name as a1 group by person_id;
create or replace view aggJoin1721551114608167392 as select id as v2, v51 from name as n1, aggView7268519602492954737 where n1.id=aggView7268519602492954737.v2;
create or replace view aggView1907112222197435546 as select id as v15 from role_type as rt where role= 'writer';
create or replace view aggJoin4288960417054814343 as select person_id as v2, movie_id as v11 from cast_info as ci, aggView1907112222197435546 where ci.role_id=aggView1907112222197435546.v15;
create or replace view aggView8439304644796367573 as select id as v25 from company_name as cn where country_code= '[us]';
create or replace view aggJoin1276221019860164476 as select movie_id as v11 from movie_companies as mc, aggView8439304644796367573 where mc.company_id=aggView8439304644796367573.v25;
create or replace view aggView3189708597026507931 as select v11 from aggJoin1276221019860164476 group by v11;
create or replace view aggJoin4528259760227844526 as select id as v11, title as v40 from title as t, aggView3189708597026507931 where t.id=aggView3189708597026507931.v11;
create or replace view aggView9099203036531190734 as select v11, MIN(v40) as v52 from aggJoin4528259760227844526 group by v11;
create or replace view aggJoin3031645299189772664 as select v2, v52 from aggJoin4288960417054814343 join aggView9099203036531190734 using(v11);
create or replace view aggView7204078724843130308 as select v2, MIN(v51) as v51 from aggJoin1721551114608167392 group by v2,v51;
create or replace view aggJoin6055823813383959983 as select v52 as v52, v51 from aggJoin3031645299189772664 join aggView7204078724843130308 using(v2);
select MIN(v51) as v51,MIN(v52) as v52 from aggJoin6055823813383959983;
