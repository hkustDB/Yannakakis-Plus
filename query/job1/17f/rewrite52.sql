create or replace view aggView5372113086479950515 as select id as v26, name as v47 from name as n where name LIKE '%B%';
create or replace view aggJoin3540797600739006559 as select movie_id as v3, v47 from cast_info as ci, aggView5372113086479950515 where ci.person_id=aggView5372113086479950515.v26;
create or replace view aggView222346583186313549 as select id as v20 from company_name as cn;
create or replace view aggJoin7273864871712613689 as select movie_id as v3 from movie_companies as mc, aggView222346583186313549 where mc.company_id=aggView222346583186313549.v20;
create or replace view aggView8243637792909734338 as select id as v25 from keyword as k where keyword= 'character-name-in-title';
create or replace view aggJoin7377847803407098907 as select movie_id as v3 from movie_keyword as mk, aggView8243637792909734338 where mk.keyword_id=aggView8243637792909734338.v25;
create or replace view aggView8006186967787243057 as select v3 from aggJoin7377847803407098907 group by v3;
create or replace view aggJoin1571725133494226956 as select v3 from aggJoin7273864871712613689 join aggView8006186967787243057 using(v3);
create or replace view aggView8071039793596162365 as select v3, MIN(v47) as v47 from aggJoin3540797600739006559 group by v3;
create or replace view aggJoin1936936782445804259 as select id as v3, v47 from title as t, aggView8071039793596162365 where t.id=aggView8071039793596162365.v3;
create or replace view aggView33604813122238317 as select v3 from aggJoin1571725133494226956 group by v3;
create or replace view aggJoin4876493606213457044 as select v47 as v47 from aggJoin1936936782445804259 join aggView33604813122238317 using(v3);
create or replace view res as select MIN(v47) as v47 from aggJoin4876493606213457044;
select sum(v47) from res;