create or replace view aggView1292663859527720652 as select id as v26, name as v47 from name as n where name LIKE '%B%';
create or replace view aggJoin707912720532163152 as select movie_id as v3, v47 from cast_info as ci, aggView1292663859527720652 where ci.person_id=aggView1292663859527720652.v26;
create or replace view aggView7384150497304399222 as select id as v25 from keyword as k where keyword= 'character-name-in-title';
create or replace view aggJoin246102889736128649 as select movie_id as v3 from movie_keyword as mk, aggView7384150497304399222 where mk.keyword_id=aggView7384150497304399222.v25;
create or replace view aggView6521821645854292028 as select v3, MIN(v47) as v47 from aggJoin707912720532163152 group by v3;
create or replace view aggJoin646584126066426219 as select v3, v47 from aggJoin246102889736128649 join aggView6521821645854292028 using(v3);
create or replace view aggView7729694476258879210 as select v3, MIN(v47) as v47 from aggJoin646584126066426219 group by v3;
create or replace view aggJoin2587745979193612580 as select movie_id as v3, company_id as v20, v47 from movie_companies as mc, aggView7729694476258879210 where mc.movie_id=aggView7729694476258879210.v3;
create or replace view aggView307273314099114522 as select id as v3 from title as t;
create or replace view aggJoin3178302773908924471 as select v20, v47 from aggJoin2587745979193612580 join aggView307273314099114522 using(v3);
create or replace view aggView7275152386060795521 as select v20, MIN(v47) as v47 from aggJoin3178302773908924471 group by v20;
create or replace view aggJoin5979415129041716613 as select v47 from company_name as cn, aggView7275152386060795521 where cn.id=aggView7275152386060795521.v20;
create or replace view res as select MIN(v47) as v47 from aggJoin5979415129041716613;
select sum(v47) from res;