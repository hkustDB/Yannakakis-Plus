create or replace view aggView4332525045840939477 as select id as v26, name as v47 from name as n where name LIKE '%B%';
create or replace view aggJoin3689557265588856262 as select movie_id as v3, v47 from cast_info as ci, aggView4332525045840939477 where ci.person_id=aggView4332525045840939477.v26;
create or replace view aggView5264431381056144447 as select id as v20 from company_name as cn;
create or replace view aggJoin5342457485059529336 as select movie_id as v3 from movie_companies as mc, aggView5264431381056144447 where mc.company_id=aggView5264431381056144447.v20;
create or replace view aggView4133394354039631429 as select id as v25 from keyword as k where keyword= 'character-name-in-title';
create or replace view aggJoin5822142451178926391 as select movie_id as v3 from movie_keyword as mk, aggView4133394354039631429 where mk.keyword_id=aggView4133394354039631429.v25;
create or replace view aggView4682292003668229927 as select v3 from aggJoin5822142451178926391 group by v3;
create or replace view aggJoin602535879076496337 as select v3, v47 as v47 from aggJoin3689557265588856262 join aggView4682292003668229927 using(v3);
create or replace view aggView1270253126901863636 as select v3, MIN(v47) as v47 from aggJoin602535879076496337 group by v3;
create or replace view aggJoin3903632654362121610 as select v3, v47 from aggJoin5342457485059529336 join aggView1270253126901863636 using(v3);
create or replace view aggView5007967045768364820 as select v3, MIN(v47) as v47 from aggJoin3903632654362121610 group by v3;
create or replace view aggJoin8191474289698418934 as select v47 from title as t, aggView5007967045768364820 where t.id=aggView5007967045768364820.v3;
create or replace view res as select MIN(v47) as v47 from aggJoin8191474289698418934;
select sum(v47) from res;