create or replace view aggView7405826015120779443 as select id as v26, name as v47 from name as n where name LIKE '%B%';
create or replace view aggJoin9036501529403468188 as select movie_id as v3, v47 from cast_info as ci, aggView7405826015120779443 where ci.person_id=aggView7405826015120779443.v26;
create or replace view aggView6418636711999885548 as select v3, MIN(v47) as v47 from aggJoin9036501529403468188 group by v3;
create or replace view aggJoin7096749090035943647 as select id as v3, v47 from title as t, aggView6418636711999885548 where t.id=aggView6418636711999885548.v3;
create or replace view aggView5768618645062820213 as select id as v25 from keyword as k where keyword= 'character-name-in-title';
create or replace view aggJoin8691653608167625498 as select movie_id as v3 from movie_keyword as mk, aggView5768618645062820213 where mk.keyword_id=aggView5768618645062820213.v25;
create or replace view aggView5601239146147070832 as select v3, MIN(v47) as v47 from aggJoin7096749090035943647 group by v3;
create or replace view aggJoin5637683146185279887 as select v3, v47 from aggJoin8691653608167625498 join aggView5601239146147070832 using(v3);
create or replace view aggView1572588130734976097 as select v3, MIN(v47) as v47 from aggJoin5637683146185279887 group by v3;
create or replace view aggJoin4066647647366205906 as select company_id as v20, v47 from movie_companies as mc, aggView1572588130734976097 where mc.movie_id=aggView1572588130734976097.v3;
create or replace view aggView3833970113364216462 as select v20, MIN(v47) as v47 from aggJoin4066647647366205906 group by v20;
create or replace view aggJoin6732901372328991521 as select v47 from company_name as cn, aggView3833970113364216462 where cn.id=aggView3833970113364216462.v20;
create or replace view res as select MIN(v47) as v47 from aggJoin6732901372328991521;
select sum(v47) from res;