create or replace view aggView8298893190508471104 as select id as v26, name as v47 from name as n where name LIKE '%B%';
create or replace view aggJoin8234463401537542125 as select movie_id as v3, v47 from cast_info as ci, aggView8298893190508471104 where ci.person_id=aggView8298893190508471104.v26;
create or replace view aggView665916448928726582 as select v3, MIN(v47) as v47 from aggJoin8234463401537542125 group by v3;
create or replace view aggJoin5718779166237371067 as select id as v3, v47 from title as t, aggView665916448928726582 where t.id=aggView665916448928726582.v3;
create or replace view aggView8812146720344284304 as select v3, MIN(v47) as v47 from aggJoin5718779166237371067 group by v3;
create or replace view aggJoin8555580593935505270 as select movie_id as v3, keyword_id as v25, v47 from movie_keyword as mk, aggView8812146720344284304 where mk.movie_id=aggView8812146720344284304.v3;
create or replace view aggView4452844978015707377 as select id as v25 from keyword as k where keyword= 'character-name-in-title';
create or replace view aggJoin783823641648567741 as select v3, v47 from aggJoin8555580593935505270 join aggView4452844978015707377 using(v25);
create or replace view aggView4538720519095677986 as select v3, MIN(v47) as v47 from aggJoin783823641648567741 group by v3;
create or replace view aggJoin5604774638374169043 as select company_id as v20, v47 from movie_companies as mc, aggView4538720519095677986 where mc.movie_id=aggView4538720519095677986.v3;
create or replace view aggView4565624290835303306 as select v20, MIN(v47) as v47 from aggJoin5604774638374169043 group by v20;
create or replace view aggJoin2962685095659318847 as select v47 from company_name as cn, aggView4565624290835303306 where cn.id=aggView4565624290835303306.v20;
create or replace view res as select MIN(v47) as v47 from aggJoin2962685095659318847;
select sum(v47) from res;