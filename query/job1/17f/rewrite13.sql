create or replace view aggView1846376257079416082 as select id as v26, name as v47 from name as n where name LIKE '%B%';
create or replace view aggJoin4479137394692746199 as select movie_id as v3, v47 from cast_info as ci, aggView1846376257079416082 where ci.person_id=aggView1846376257079416082.v26;
create or replace view aggView1959022761004963936 as select id as v20 from company_name as cn;
create or replace view aggJoin5882047507111342683 as select movie_id as v3 from movie_companies as mc, aggView1959022761004963936 where mc.company_id=aggView1959022761004963936.v20;
create or replace view aggView4207438303289591459 as select id as v25 from keyword as k where keyword= 'character-name-in-title';
create or replace view aggJoin6649209708957162977 as select movie_id as v3 from movie_keyword as mk, aggView4207438303289591459 where mk.keyword_id=aggView4207438303289591459.v25;
create or replace view aggView8949154072955799936 as select v3 from aggJoin6649209708957162977 group by v3;
create or replace view aggJoin4553815526569777432 as select v3 from aggJoin5882047507111342683 join aggView8949154072955799936 using(v3);
create or replace view aggView6177866471474908773 as select v3 from aggJoin4553815526569777432 group by v3;
create or replace view aggJoin3996142188940412815 as select v3, v47 as v47 from aggJoin4479137394692746199 join aggView6177866471474908773 using(v3);
create or replace view aggView5777869291236076047 as select v3, MIN(v47) as v47 from aggJoin3996142188940412815 group by v3;
create or replace view aggJoin3453269009614208333 as select v47 from title as t, aggView5777869291236076047 where t.id=aggView5777869291236076047.v3;
create or replace view res as select MIN(v47) as v47 from aggJoin3453269009614208333;
select sum(v47) from res;