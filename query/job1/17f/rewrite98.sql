create or replace view aggView2712665252639870908 as select id as v20 from company_name as cn;
create or replace view aggJoin5737101316377528489 as select movie_id as v3 from movie_companies as mc, aggView2712665252639870908 where mc.company_id=aggView2712665252639870908.v20;
create or replace view aggView5302862784774694642 as select v3 from aggJoin5737101316377528489 group by v3;
create or replace view aggJoin7452724005631152536 as select movie_id as v3, keyword_id as v25 from movie_keyword as mk, aggView5302862784774694642 where mk.movie_id=aggView5302862784774694642.v3;
create or replace view aggView6204884513547167153 as select id as v3 from title as t;
create or replace view aggJoin6136891125493990624 as select v3, v25 from aggJoin7452724005631152536 join aggView6204884513547167153 using(v3);
create or replace view aggView9222939897163756548 as select id as v25 from keyword as k where keyword= 'character-name-in-title';
create or replace view aggJoin1679245898537998113 as select v3 from aggJoin6136891125493990624 join aggView9222939897163756548 using(v25);
create or replace view aggView3454102306809265610 as select v3 from aggJoin1679245898537998113 group by v3;
create or replace view aggJoin4284682921063221636 as select person_id as v26 from cast_info as ci, aggView3454102306809265610 where ci.movie_id=aggView3454102306809265610.v3;
create or replace view aggView948196562490633078 as select v26 from aggJoin4284682921063221636 group by v26;
create or replace view aggJoin6117128274849784322 as select name as v27 from name as n, aggView948196562490633078 where n.id=aggView948196562490633078.v26 and name LIKE '%B%';
create or replace view res as select MIN(v27) as v47 from aggJoin6117128274849784322;
select sum(v47) from res;