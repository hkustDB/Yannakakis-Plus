create or replace view aggView4563603448818441075 as select id as v20 from company_name as cn;
create or replace view aggJoin1953556865829091560 as select movie_id as v3 from movie_companies as mc, aggView4563603448818441075 where mc.company_id=aggView4563603448818441075.v20;
create or replace view aggView5335281815154300489 as select id as v25 from keyword as k where keyword= 'character-name-in-title';
create or replace view aggJoin2231526174360611239 as select movie_id as v3 from movie_keyword as mk, aggView5335281815154300489 where mk.keyword_id=aggView5335281815154300489.v25;
create or replace view aggView7113866593543656103 as select v3 from aggJoin2231526174360611239 group by v3;
create or replace view aggJoin717273888695350740 as select id as v3 from title as t, aggView7113866593543656103 where t.id=aggView7113866593543656103.v3;
create or replace view aggView6588244996649311824 as select v3 from aggJoin1953556865829091560 group by v3;
create or replace view aggJoin1852616026454151469 as select v3 from aggJoin717273888695350740 join aggView6588244996649311824 using(v3);
create or replace view aggView1133536068360072854 as select v3 from aggJoin1852616026454151469 group by v3;
create or replace view aggJoin3743998298067169185 as select person_id as v26 from cast_info as ci, aggView1133536068360072854 where ci.movie_id=aggView1133536068360072854.v3;
create or replace view aggView1835438958145775175 as select v26 from aggJoin3743998298067169185 group by v26;
create or replace view aggJoin6264489627926717376 as select name as v27 from name as n, aggView1835438958145775175 where n.id=aggView1835438958145775175.v26 and name LIKE '%B%';
create or replace view res as select MIN(v27) as v47 from aggJoin6264489627926717376;
select sum(v47) from res;