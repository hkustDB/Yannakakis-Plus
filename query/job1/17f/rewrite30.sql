create or replace view aggView7064950118553187117 as select id as v26, name as v47 from name as n where name LIKE '%B%';
create or replace view aggJoin7818620284192986112 as select movie_id as v3, v47 from cast_info as ci, aggView7064950118553187117 where ci.person_id=aggView7064950118553187117.v26;
create or replace view aggView2642897308068198982 as select v3, MIN(v47) as v47 from aggJoin7818620284192986112 group by v3;
create or replace view aggJoin4888262901698789473 as select movie_id as v3, company_id as v20, v47 from movie_companies as mc, aggView2642897308068198982 where mc.movie_id=aggView2642897308068198982.v3;
create or replace view aggView485615400142485191 as select id as v25 from keyword as k where keyword= 'character-name-in-title';
create or replace view aggJoin2946911748039010006 as select movie_id as v3 from movie_keyword as mk, aggView485615400142485191 where mk.keyword_id=aggView485615400142485191.v25;
create or replace view aggView1160570402192993937 as select v3 from aggJoin2946911748039010006 group by v3;
create or replace view aggJoin1535715535258431639 as select id as v3 from title as t, aggView1160570402192993937 where t.id=aggView1160570402192993937.v3;
create or replace view aggView9191774299626035459 as select v3 from aggJoin1535715535258431639 group by v3;
create or replace view aggJoin2635459571751063083 as select v20, v47 as v47 from aggJoin4888262901698789473 join aggView9191774299626035459 using(v3);
create or replace view aggView1470009135789278796 as select v20, MIN(v47) as v47 from aggJoin2635459571751063083 group by v20;
create or replace view aggJoin2881947113660999951 as select v47 from company_name as cn, aggView1470009135789278796 where cn.id=aggView1470009135789278796.v20;
create or replace view res as select MIN(v47) as v47 from aggJoin2881947113660999951;
select sum(v47) from res;