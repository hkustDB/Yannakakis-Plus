create or replace view aggView9183167027313106198 as select id as v26, name as v47 from name as n where name LIKE '%B%';
create or replace view aggJoin7075696818303630592 as select movie_id as v3, v47 from cast_info as ci, aggView9183167027313106198 where ci.person_id=aggView9183167027313106198.v26;
create or replace view aggView2262572289344920694 as select id as v25 from keyword as k where keyword= 'character-name-in-title';
create or replace view aggJoin6157366012485112301 as select movie_id as v3 from movie_keyword as mk, aggView2262572289344920694 where mk.keyword_id=aggView2262572289344920694.v25;
create or replace view aggView1094472203237149258 as select v3 from aggJoin6157366012485112301 group by v3;
create or replace view aggJoin1459430802380553074 as select v3, v47 as v47 from aggJoin7075696818303630592 join aggView1094472203237149258 using(v3);
create or replace view aggView4950946221493875614 as select v3, MIN(v47) as v47 from aggJoin1459430802380553074 group by v3;
create or replace view aggJoin2429490458782712613 as select id as v3, v47 from title as t, aggView4950946221493875614 where t.id=aggView4950946221493875614.v3;
create or replace view aggView4691418386415199127 as select v3, MIN(v47) as v47 from aggJoin2429490458782712613 group by v3;
create or replace view aggJoin245557140184009049 as select company_id as v20, v47 from movie_companies as mc, aggView4691418386415199127 where mc.movie_id=aggView4691418386415199127.v3;
create or replace view aggView2683355563724648121 as select v20, MIN(v47) as v47 from aggJoin245557140184009049 group by v20;
create or replace view aggJoin5672899601701860033 as select v47 from company_name as cn, aggView2683355563724648121 where cn.id=aggView2683355563724648121.v20;
create or replace view res as select MIN(v47) as v47 from aggJoin5672899601701860033;
select sum(v47) from res;