create or replace view aggView6377825487894719035 as select id as v20 from company_name as cn;
create or replace view aggJoin3544936823045995633 as select movie_id as v3 from movie_companies as mc, aggView6377825487894719035 where mc.company_id=aggView6377825487894719035.v20;
create or replace view aggView2095088574627851670 as select id as v25 from keyword as k where keyword= 'character-name-in-title';
create or replace view aggJoin1848862570916093403 as select movie_id as v3 from movie_keyword as mk, aggView2095088574627851670 where mk.keyword_id=aggView2095088574627851670.v25;
create or replace view aggView210846786748630060 as select v3 from aggJoin1848862570916093403 group by v3;
create or replace view aggJoin1459947480757887287 as select person_id as v26, movie_id as v3 from cast_info as ci, aggView210846786748630060 where ci.movie_id=aggView210846786748630060.v3;
create or replace view aggView3757457489509256567 as select id as v3 from title as t;
create or replace view aggJoin2112361231589686921 as select v3 from aggJoin3544936823045995633 join aggView3757457489509256567 using(v3);
create or replace view aggView7137731635796392238 as select v3 from aggJoin2112361231589686921 group by v3;
create or replace view aggJoin7221843332175512608 as select v26 from aggJoin1459947480757887287 join aggView7137731635796392238 using(v3);
create or replace view aggView161937481553498279 as select v26 from aggJoin7221843332175512608 group by v26;
create or replace view aggJoin6989774832107136482 as select name as v27 from name as n, aggView161937481553498279 where n.id=aggView161937481553498279.v26 and name LIKE '%B%';
create or replace view res as select MIN(v27) as v47 from aggJoin6989774832107136482;
select sum(v47) from res;