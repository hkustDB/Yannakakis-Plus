create or replace view aggView316543300645689860 as select id as v26, name as v47 from name as n where name LIKE '%B%';
create or replace view aggJoin702834581523095113 as select movie_id as v3, v47 from cast_info as ci, aggView316543300645689860 where ci.person_id=aggView316543300645689860.v26;
create or replace view aggView7812206255933393591 as select v3, MIN(v47) as v47 from aggJoin702834581523095113 group by v3;
create or replace view aggJoin3695401401121337230 as select movie_id as v3, company_id as v20, v47 from movie_companies as mc, aggView7812206255933393591 where mc.movie_id=aggView7812206255933393591.v3;
create or replace view aggView5829375718447541417 as select id as v25 from keyword as k where keyword= 'character-name-in-title';
create or replace view aggJoin4318315893148096586 as select movie_id as v3 from movie_keyword as mk, aggView5829375718447541417 where mk.keyword_id=aggView5829375718447541417.v25;
create or replace view aggView6948756548076916296 as select id as v3 from title as t;
create or replace view aggJoin5327795855195096503 as select v3 from aggJoin4318315893148096586 join aggView6948756548076916296 using(v3);
create or replace view aggView6458345607831690670 as select v3 from aggJoin5327795855195096503 group by v3;
create or replace view aggJoin4324800599403644288 as select v20, v47 as v47 from aggJoin3695401401121337230 join aggView6458345607831690670 using(v3);
create or replace view aggView177661635556589349 as select v20, MIN(v47) as v47 from aggJoin4324800599403644288 group by v20;
create or replace view aggJoin5997052699551247778 as select v47 from company_name as cn, aggView177661635556589349 where cn.id=aggView177661635556589349.v20;
create or replace view res as select MIN(v47) as v47 from aggJoin5997052699551247778;
select sum(v47) from res;