create or replace view aggView257486287160658631 as select id as v26, name as v47 from name as n where name LIKE '%B%';
create or replace view aggJoin1136888265899665333 as select movie_id as v3, v47 from cast_info as ci, aggView257486287160658631 where ci.person_id=aggView257486287160658631.v26;
create or replace view aggView1504038316742236725 as select v3, MIN(v47) as v47 from aggJoin1136888265899665333 group by v3;
create or replace view aggJoin3805418846043282398 as select movie_id as v3, keyword_id as v25, v47 from movie_keyword as mk, aggView1504038316742236725 where mk.movie_id=aggView1504038316742236725.v3;
create or replace view aggView7819102729740392224 as select id as v20 from company_name as cn;
create or replace view aggJoin7135965910214375462 as select movie_id as v3 from movie_companies as mc, aggView7819102729740392224 where mc.company_id=aggView7819102729740392224.v20;
create or replace view aggView1738478544204137664 as select v3 from aggJoin7135965910214375462 group by v3;
create or replace view aggJoin7413734891764682185 as select id as v3 from title as t, aggView1738478544204137664 where t.id=aggView1738478544204137664.v3;
create or replace view aggView7899300728334482339 as select v3 from aggJoin7413734891764682185 group by v3;
create or replace view aggJoin6313473726378122489 as select v25, v47 as v47 from aggJoin3805418846043282398 join aggView7899300728334482339 using(v3);
create or replace view aggView6356054764451764721 as select v25, MIN(v47) as v47 from aggJoin6313473726378122489 group by v25;
create or replace view aggJoin2926256089235391343 as select keyword as v16, v47 from keyword as k, aggView6356054764451764721 where k.id=aggView6356054764451764721.v25 and keyword= 'character-name-in-title';
create or replace view res as select MIN(v47) as v47 from aggJoin2926256089235391343;
select sum(v47) from res;