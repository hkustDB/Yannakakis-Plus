create or replace view aggView3966040766136313829 as select id as v26, name as v47 from name as n where name LIKE '%B%';
create or replace view aggJoin3139351161662676463 as select movie_id as v3, v47 from cast_info as ci, aggView3966040766136313829 where ci.person_id=aggView3966040766136313829.v26;
create or replace view aggView4390913159724960275 as select v3, MIN(v47) as v47 from aggJoin3139351161662676463 group by v3;
create or replace view aggJoin2487096081267807000 as select id as v3, v47 from title as t, aggView4390913159724960275 where t.id=aggView4390913159724960275.v3;
create or replace view aggView3500669617178923134 as select id as v25 from keyword as k where keyword= 'character-name-in-title';
create or replace view aggJoin9014188774352270622 as select movie_id as v3 from movie_keyword as mk, aggView3500669617178923134 where mk.keyword_id=aggView3500669617178923134.v25;
create or replace view aggView1665824880396382074 as select v3 from aggJoin9014188774352270622 group by v3;
create or replace view aggJoin8651248923287060577 as select movie_id as v3, company_id as v20 from movie_companies as mc, aggView1665824880396382074 where mc.movie_id=aggView1665824880396382074.v3;
create or replace view aggView6484925927562917159 as select v3, MIN(v47) as v47 from aggJoin2487096081267807000 group by v3;
create or replace view aggJoin3857820408982003237 as select v20, v47 from aggJoin8651248923287060577 join aggView6484925927562917159 using(v3);
create or replace view aggView4747306409653214070 as select v20, MIN(v47) as v47 from aggJoin3857820408982003237 group by v20;
create or replace view aggJoin1420760281559922987 as select v47 from company_name as cn, aggView4747306409653214070 where cn.id=aggView4747306409653214070.v20;
create or replace view res as select MIN(v47) as v47 from aggJoin1420760281559922987;
select sum(v47) from res;