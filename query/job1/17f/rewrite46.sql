create or replace view aggView1667436345199719046 as select id as v26, name as v47 from name as n where name LIKE '%B%';
create or replace view aggJoin2144802298701828914 as select movie_id as v3, v47 from cast_info as ci, aggView1667436345199719046 where ci.person_id=aggView1667436345199719046.v26;
create or replace view aggView3932662641243231917 as select id as v20 from company_name as cn;
create or replace view aggJoin6504592872717991122 as select movie_id as v3 from movie_companies as mc, aggView3932662641243231917 where mc.company_id=aggView3932662641243231917.v20;
create or replace view aggView5642533385819792553 as select v3, MIN(v47) as v47 from aggJoin2144802298701828914 group by v3;
create or replace view aggJoin8908526796194906081 as select v3, v47 from aggJoin6504592872717991122 join aggView5642533385819792553 using(v3);
create or replace view aggView6134075423589585817 as select v3, MIN(v47) as v47 from aggJoin8908526796194906081 group by v3;
create or replace view aggJoin7636770594400860100 as select movie_id as v3, keyword_id as v25, v47 from movie_keyword as mk, aggView6134075423589585817 where mk.movie_id=aggView6134075423589585817.v3;
create or replace view aggView150946837806402709 as select id as v25 from keyword as k where keyword= 'character-name-in-title';
create or replace view aggJoin2524857186130617820 as select v3, v47 from aggJoin7636770594400860100 join aggView150946837806402709 using(v25);
create or replace view aggView2768654632872387903 as select v3, MIN(v47) as v47 from aggJoin2524857186130617820 group by v3;
create or replace view aggJoin2620496282027229823 as select v47 from title as t, aggView2768654632872387903 where t.id=aggView2768654632872387903.v3;
create or replace view res as select MIN(v47) as v47 from aggJoin2620496282027229823;
select sum(v47) from res;