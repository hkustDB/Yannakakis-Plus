create or replace view aggView1555909553730297192 as select id as v26, name as v47 from name as n where name LIKE '%B%';
create or replace view aggJoin6724215464249588380 as select movie_id as v3, v47 from cast_info as ci, aggView1555909553730297192 where ci.person_id=aggView1555909553730297192.v26;
create or replace view aggView7887898167425819839 as select id as v20 from company_name as cn;
create or replace view aggJoin1487781759774991695 as select movie_id as v3 from movie_companies as mc, aggView7887898167425819839 where mc.company_id=aggView7887898167425819839.v20;
create or replace view aggView6286193837594852971 as select v3 from aggJoin1487781759774991695 group by v3;
create or replace view aggJoin7949872215089365746 as select v3, v47 as v47 from aggJoin6724215464249588380 join aggView6286193837594852971 using(v3);
create or replace view aggView2243304899767658499 as select v3, MIN(v47) as v47 from aggJoin7949872215089365746 group by v3;
create or replace view aggJoin6456315329014236525 as select id as v3, v47 from title as t, aggView2243304899767658499 where t.id=aggView2243304899767658499.v3;
create or replace view aggView1198615139040425626 as select id as v25 from keyword as k where keyword= 'character-name-in-title';
create or replace view aggJoin1679681423394672567 as select movie_id as v3 from movie_keyword as mk, aggView1198615139040425626 where mk.keyword_id=aggView1198615139040425626.v25;
create or replace view aggView1420280500315216640 as select v3 from aggJoin1679681423394672567 group by v3;
create or replace view aggJoin1977717541764298975 as select v47 as v47 from aggJoin6456315329014236525 join aggView1420280500315216640 using(v3);
create or replace view res as select MIN(v47) as v47 from aggJoin1977717541764298975;
select sum(v47) from res;