create or replace view aggView2804175724700292030 as select id as v26, name as v47 from name as n where name LIKE '%B%';
create or replace view aggJoin5371283068725709249 as select movie_id as v3, v47 from cast_info as ci, aggView2804175724700292030 where ci.person_id=aggView2804175724700292030.v26;
create or replace view aggView1400104203258759636 as select v3, MIN(v47) as v47 from aggJoin5371283068725709249 group by v3;
create or replace view aggJoin861602870678439040 as select movie_id as v3, company_id as v20, v47 from movie_companies as mc, aggView1400104203258759636 where mc.movie_id=aggView1400104203258759636.v3;
create or replace view aggView785572721671026442 as select id as v20 from company_name as cn;
create or replace view aggJoin5368300074261450537 as select v3, v47 from aggJoin861602870678439040 join aggView785572721671026442 using(v20);
create or replace view aggView6999440979819694918 as select id as v25 from keyword as k where keyword= 'character-name-in-title';
create or replace view aggJoin7222954934550762124 as select movie_id as v3 from movie_keyword as mk, aggView6999440979819694918 where mk.keyword_id=aggView6999440979819694918.v25;
create or replace view aggView9074046388396439145 as select v3 from aggJoin7222954934550762124 group by v3;
create or replace view aggJoin7884770443991117337 as select v3, v47 as v47 from aggJoin5368300074261450537 join aggView9074046388396439145 using(v3);
create or replace view aggView6035355469874407749 as select id as v3 from title as t;
create or replace view aggJoin6734192572825481569 as select v47 from aggJoin7884770443991117337 join aggView6035355469874407749 using(v3);
create or replace view res as select MIN(v47) as v47 from aggJoin6734192572825481569;
select sum(v47) from res;