create or replace view aggView6077154776735831819 as select id as v31, name as v52 from name as n;
create or replace view aggJoin5647921811749281956 as select movie_id as v40, person_role_id as v9, v52 from cast_info as ci, aggView6077154776735831819 where ci.person_id=aggView6077154776735831819.v31;
create or replace view aggView6722183451533003140 as select id as v23 from keyword as k where keyword IN ('superhero','marvel-comics','based-on-comic','tv-special','fight','violence','magnet','web','claw','laser');
create or replace view aggJoin155266512215451896 as select movie_id as v40 from movie_keyword as mk, aggView6722183451533003140 where mk.keyword_id=aggView6722183451533003140.v23;
create or replace view aggView4523189683192180356 as select v40 from aggJoin155266512215451896 group by v40;
create or replace view aggJoin4585344526268790576 as select movie_id as v40, subject_id as v5, status_id as v7 from complete_cast as cc, aggView4523189683192180356 where cc.movie_id=aggView4523189683192180356.v40;
create or replace view aggView7808169018202021156 as select id as v7 from comp_cast_type as cct2 where kind LIKE '%complete%';
create or replace view aggJoin7680543226444732199 as select v40, v5 from aggJoin4585344526268790576 join aggView7808169018202021156 using(v7);
create or replace view aggView3587368694190679361 as select id as v9 from char_name as chn where ((name LIKE '%man%') OR (name LIKE '%Man%'));
create or replace view aggJoin7579819085183248893 as select v40, v52 from aggJoin5647921811749281956 join aggView3587368694190679361 using(v9);
create or replace view aggView2660546386275008141 as select v40, MIN(v52) as v52 from aggJoin7579819085183248893 group by v40;
create or replace view aggJoin1192225293680407495 as select id as v40, title as v41, kind_id as v26, v52 from title as t, aggView2660546386275008141 where t.id=aggView2660546386275008141.v40 and production_year>2000;
create or replace view aggView3116708716932963010 as select id as v26 from kind_type as kt where kind= 'movie';
create or replace view aggJoin3312827998454701347 as select v40, v41, v52 from aggJoin1192225293680407495 join aggView3116708716932963010 using(v26);
create or replace view aggView1138906883101492293 as select v40, MIN(v52) as v52, MIN(v41) as v53 from aggJoin3312827998454701347 group by v40;
create or replace view aggJoin8426900946950453290 as select v5, v52, v53 from aggJoin7680543226444732199 join aggView1138906883101492293 using(v40);
create or replace view aggView1839264310299840437 as select v5, MIN(v52) as v52, MIN(v53) as v53 from aggJoin8426900946950453290 group by v5;
create or replace view aggJoin1744890875665233410 as select v52, v53 from comp_cast_type as cct1, aggView1839264310299840437 where cct1.id=aggView1839264310299840437.v5 and kind= 'cast';
create or replace view res as select MIN(v52) as v52, MIN(v53) as v53 from aggJoin1744890875665233410;
select sum(v52+v53) from res;