create or replace view aggView4466284935074625657 as select id as v9 from char_name as chn where ((name LIKE '%Tony%Stark%') OR (name LIKE '%Iron%Man%')) and name NOT LIKE '%Sherlock%';
create or replace view aggJoin282904501939069277 as select person_id as v31, movie_id as v40 from cast_info as ci, aggView4466284935074625657 where ci.person_role_id=aggView4466284935074625657.v9;
create or replace view aggView3306547852950559590 as select id as v26 from kind_type as kt where kind= 'movie';
create or replace view aggJoin8381517883811060305 as select id as v40, title as v41 from title as t, aggView3306547852950559590 where t.kind_id=aggView3306547852950559590.v26 and production_year>1950;
create or replace view aggView992454628635843470 as select id as v31 from name as n;
create or replace view aggJoin6801146728380900631 as select v40 from aggJoin282904501939069277 join aggView992454628635843470 using(v31);
create or replace view aggView13769523924415703 as select v40 from aggJoin6801146728380900631 group by v40;
create or replace view aggJoin3728591800071996153 as select movie_id as v40, keyword_id as v23 from movie_keyword as mk, aggView13769523924415703 where mk.movie_id=aggView13769523924415703.v40;
create or replace view aggView804924820173789787 as select id as v7 from comp_cast_type as cct2 where kind LIKE '%complete%';
create or replace view aggJoin1843993499439478629 as select movie_id as v40, subject_id as v5 from complete_cast as cc, aggView804924820173789787 where cc.status_id=aggView804924820173789787.v7;
create or replace view aggView3197351960311157390 as select id as v5 from comp_cast_type as cct1 where kind= 'cast';
create or replace view aggJoin380384680180219836 as select v40 from aggJoin1843993499439478629 join aggView3197351960311157390 using(v5);
create or replace view aggView5377953427813463867 as select v40 from aggJoin380384680180219836 group by v40;
create or replace view aggJoin8632437579454374393 as select v40, v41 from aggJoin8381517883811060305 join aggView5377953427813463867 using(v40);
create or replace view aggView1086112259554633486 as select v40, MIN(v41) as v52 from aggJoin8632437579454374393 group by v40;
create or replace view aggJoin7513952792923577426 as select v23, v52 from aggJoin3728591800071996153 join aggView1086112259554633486 using(v40);
create or replace view aggView2502095898947230669 as select id as v23 from keyword as k where keyword IN ('superhero','sequel','second-part','marvel-comics','based-on-comic','tv-special','fight','violence');
create or replace view aggJoin336206092839405704 as select v52 from aggJoin7513952792923577426 join aggView2502095898947230669 using(v23);
create or replace view res as select MIN(v52) as v52 from aggJoin336206092839405704;
select sum(v52) from res;