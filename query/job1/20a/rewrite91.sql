create or replace view aggView2025639339718391942 as select id as v9 from char_name as chn where ((name LIKE '%Tony%Stark%') OR (name LIKE '%Iron%Man%')) and name NOT LIKE '%Sherlock%';
create or replace view aggJoin8918783593642639107 as select person_id as v31, movie_id as v40 from cast_info as ci, aggView2025639339718391942 where ci.person_role_id=aggView2025639339718391942.v9;
create or replace view aggView7683639852297026183 as select id as v26 from kind_type as kt where kind= 'movie';
create or replace view aggJoin5561217688383297117 as select id as v40, title as v41 from title as t, aggView7683639852297026183 where t.kind_id=aggView7683639852297026183.v26 and production_year>1950;
create or replace view aggView1907378127277668380 as select id as v31 from name as n;
create or replace view aggJoin307237449120938019 as select v40 from aggJoin8918783593642639107 join aggView1907378127277668380 using(v31);
create or replace view aggView7317631641325320747 as select v40 from aggJoin307237449120938019 group by v40;
create or replace view aggJoin5759427452102128670 as select movie_id as v40, subject_id as v5, status_id as v7 from complete_cast as cc, aggView7317631641325320747 where cc.movie_id=aggView7317631641325320747.v40;
create or replace view aggView7619500039383540678 as select id as v7 from comp_cast_type as cct2 where kind LIKE '%complete%';
create or replace view aggJoin3229132825547164904 as select v40, v5 from aggJoin5759427452102128670 join aggView7619500039383540678 using(v7);
create or replace view aggView1025283511561636249 as select id as v5 from comp_cast_type as cct1 where kind= 'cast';
create or replace view aggJoin4992094803230411338 as select v40 from aggJoin3229132825547164904 join aggView1025283511561636249 using(v5);
create or replace view aggView444931166553213865 as select v40 from aggJoin4992094803230411338 group by v40;
create or replace view aggJoin2933472363582948675 as select v40, v41 from aggJoin5561217688383297117 join aggView444931166553213865 using(v40);
create or replace view aggView6286732797066237413 as select v40, MIN(v41) as v52 from aggJoin2933472363582948675 group by v40;
create or replace view aggJoin4019183239499718744 as select keyword_id as v23, v52 from movie_keyword as mk, aggView6286732797066237413 where mk.movie_id=aggView6286732797066237413.v40;
create or replace view aggView2537652316081772850 as select id as v23 from keyword as k where keyword IN ('superhero','sequel','second-part','marvel-comics','based-on-comic','tv-special','fight','violence');
create or replace view aggJoin4003013225561701955 as select v52 from aggJoin4019183239499718744 join aggView2537652316081772850 using(v23);
create or replace view res as select MIN(v52) as v52 from aggJoin4003013225561701955;
select sum(v52) from res;