create or replace view aggView8170734635217692586 as select id as v5 from comp_cast_type as cct1 where kind= 'cast';
create or replace view aggJoin5366086249450267001 as select movie_id as v40, status_id as v7 from complete_cast as cc, aggView8170734635217692586 where cc.subject_id=aggView8170734635217692586.v5;
create or replace view aggView1646495707494570174 as select id as v31 from name as n;
create or replace view aggJoin1623975464213580320 as select movie_id as v40, person_role_id as v9 from cast_info as ci, aggView1646495707494570174 where ci.person_id=aggView1646495707494570174.v31;
create or replace view aggView7664001950649445683 as select id as v7 from comp_cast_type as cct2 where kind LIKE '%complete%';
create or replace view aggJoin5025157650789705197 as select v40 from aggJoin5366086249450267001 join aggView7664001950649445683 using(v7);
create or replace view aggView6108801958222029637 as select v40 from aggJoin5025157650789705197 group by v40;
create or replace view aggJoin422988371100318879 as select id as v40, title as v41, kind_id as v26 from title as t, aggView6108801958222029637 where t.id=aggView6108801958222029637.v40 and production_year>1950;
create or replace view aggView2026988436760943101 as select id as v26 from kind_type as kt where kind= 'movie';
create or replace view aggJoin454068646231036336 as select v40, v41 from aggJoin422988371100318879 join aggView2026988436760943101 using(v26);
create or replace view aggView6753656940757468044 as select id as v9 from char_name as chn where ((name LIKE '%Tony%Stark%') OR (name LIKE '%Iron%Man%')) and name NOT LIKE '%Sherlock%';
create or replace view aggJoin4279193418436051169 as select v40 from aggJoin1623975464213580320 join aggView6753656940757468044 using(v9);
create or replace view aggView4409271135286961402 as select v40 from aggJoin4279193418436051169 group by v40;
create or replace view aggJoin9094041755283601561 as select v40, v41 from aggJoin454068646231036336 join aggView4409271135286961402 using(v40);
create or replace view aggView4982699961068342221 as select v40, MIN(v41) as v52 from aggJoin9094041755283601561 group by v40;
create or replace view aggJoin7259315729889292944 as select keyword_id as v23, v52 from movie_keyword as mk, aggView4982699961068342221 where mk.movie_id=aggView4982699961068342221.v40;
create or replace view aggView2062592237693493403 as select v23, MIN(v52) as v52 from aggJoin7259315729889292944 group by v23;
create or replace view aggJoin3268698678546721432 as select v52 from keyword as k, aggView2062592237693493403 where k.id=aggView2062592237693493403.v23 and keyword IN ('superhero','sequel','second-part','marvel-comics','based-on-comic','tv-special','fight','violence');
select MIN(v52) as v52 from aggJoin3268698678546721432;
