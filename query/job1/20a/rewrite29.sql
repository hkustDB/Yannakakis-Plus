create or replace view aggView3165213731655310430 as select id as v5 from comp_cast_type as cct1 where kind= 'cast';
create or replace view aggJoin7010566398803604446 as select movie_id as v40, status_id as v7 from complete_cast as cc, aggView3165213731655310430 where cc.subject_id=aggView3165213731655310430.v5;
create or replace view aggView7712149187042006553 as select id as v31 from name as n;
create or replace view aggJoin4131875030491073702 as select movie_id as v40, person_role_id as v9 from cast_info as ci, aggView7712149187042006553 where ci.person_id=aggView7712149187042006553.v31;
create or replace view aggView1670869609253484930 as select id as v7 from comp_cast_type as cct2 where kind LIKE '%complete%';
create or replace view aggJoin4977344650759880146 as select v40 from aggJoin7010566398803604446 join aggView1670869609253484930 using(v7);
create or replace view aggView1240138335116563825 as select v40 from aggJoin4977344650759880146 group by v40;
create or replace view aggJoin2169631374659727147 as select id as v40, title as v41, kind_id as v26 from title as t, aggView1240138335116563825 where t.id=aggView1240138335116563825.v40 and production_year>1950;
create or replace view aggView4730537540450749113 as select id as v26 from kind_type as kt where kind= 'movie';
create or replace view aggJoin2260162583067581815 as select v40, v41 from aggJoin2169631374659727147 join aggView4730537540450749113 using(v26);
create or replace view aggView7442714417965977999 as select id as v9 from char_name as chn where ((name LIKE '%Tony%Stark%') OR (name LIKE '%Iron%Man%')) and name NOT LIKE '%Sherlock%';
create or replace view aggJoin7157835489246011229 as select v40 from aggJoin4131875030491073702 join aggView7442714417965977999 using(v9);
create or replace view aggView3479151779723311116 as select v40 from aggJoin7157835489246011229 group by v40;
create or replace view aggJoin2220160307345115591 as select movie_id as v40, keyword_id as v23 from movie_keyword as mk, aggView3479151779723311116 where mk.movie_id=aggView3479151779723311116.v40;
create or replace view aggView211559965282892319 as select id as v23 from keyword as k where keyword IN ('superhero','sequel','second-part','marvel-comics','based-on-comic','tv-special','fight','violence');
create or replace view aggJoin4078460717149462696 as select v40 from aggJoin2220160307345115591 join aggView211559965282892319 using(v23);
create or replace view aggView1793059694478237556 as select v40 from aggJoin4078460717149462696 group by v40;
create or replace view aggJoin7856023831342272033 as select v41 from aggJoin2260162583067581815 join aggView1793059694478237556 using(v40);
select MIN(v41) as v52 from aggJoin7856023831342272033;
