create or replace view aggView5991044830361141822 as select id as v9 from char_name as chn where ((name LIKE '%Tony%Stark%') OR (name LIKE '%Iron%Man%')) and name NOT LIKE '%Sherlock%';
create or replace view aggJoin418681337244350290 as select person_id as v31, movie_id as v40 from cast_info as ci, aggView5991044830361141822 where ci.person_role_id=aggView5991044830361141822.v9;
create or replace view aggView3665938712300796716 as select id as v26 from kind_type as kt where kind= 'movie';
create or replace view aggJoin5610532741109339477 as select id as v40, title as v41 from title as t, aggView3665938712300796716 where t.kind_id=aggView3665938712300796716.v26 and production_year>1950;
create or replace view aggView3940620926831476637 as select id as v31 from name as n;
create or replace view aggJoin5144944274585990087 as select v40 from aggJoin418681337244350290 join aggView3940620926831476637 using(v31);
create or replace view aggView7651693582735734241 as select v40 from aggJoin5144944274585990087 group by v40;
create or replace view aggJoin8345853107696941150 as select movie_id as v40, keyword_id as v23 from movie_keyword as mk, aggView7651693582735734241 where mk.movie_id=aggView7651693582735734241.v40;
create or replace view aggView2533170927513897679 as select id as v5 from comp_cast_type as cct1 where kind= 'cast';
create or replace view aggJoin3167070805353161050 as select movie_id as v40, status_id as v7 from complete_cast as cc, aggView2533170927513897679 where cc.subject_id=aggView2533170927513897679.v5;
create or replace view aggView3358329095018748523 as select id as v23 from keyword as k where keyword IN ('superhero','sequel','second-part','marvel-comics','based-on-comic','tv-special','fight','violence');
create or replace view aggJoin1172299422422620021 as select v40 from aggJoin8345853107696941150 join aggView3358329095018748523 using(v23);
create or replace view aggView3739094059720048352 as select v40 from aggJoin1172299422422620021 group by v40;
create or replace view aggJoin4425740724283855477 as select v40, v41 from aggJoin5610532741109339477 join aggView3739094059720048352 using(v40);
create or replace view aggView5757690853589880507 as select v40, MIN(v41) as v52 from aggJoin4425740724283855477 group by v40;
create or replace view aggJoin133591356308908771 as select v7, v52 from aggJoin3167070805353161050 join aggView5757690853589880507 using(v40);
create or replace view aggView9158971026473575998 as select v7, MIN(v52) as v52 from aggJoin133591356308908771 group by v7;
create or replace view aggJoin2377535655502970690 as select v52 from comp_cast_type as cct2, aggView9158971026473575998 where cct2.id=aggView9158971026473575998.v7 and kind LIKE '%complete%';
create or replace view res as select MIN(v52) as v52 from aggJoin2377535655502970690;
select sum(v52) from res;