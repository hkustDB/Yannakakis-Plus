create or replace view aggView1959112716164833946 as select id as v5 from comp_cast_type as cct1 where kind= 'cast';
create or replace view aggJoin412972372728309381 as select movie_id as v40, status_id as v7 from complete_cast as cc, aggView1959112716164833946 where cc.subject_id=aggView1959112716164833946.v5;
create or replace view aggView84631208162053592 as select id as v31 from name as n;
create or replace view aggJoin7953448535824169552 as select movie_id as v40, person_role_id as v9 from cast_info as ci, aggView84631208162053592 where ci.person_id=aggView84631208162053592.v31;
create or replace view aggView4878727982571455985 as select id as v7 from comp_cast_type as cct2 where kind LIKE '%complete%';
create or replace view aggJoin3586182530531716670 as select v40 from aggJoin412972372728309381 join aggView4878727982571455985 using(v7);
create or replace view aggView5275306515942068901 as select id as v26 from kind_type as kt where kind= 'movie';
create or replace view aggJoin7874062855268324759 as select id as v40, title as v41 from title as t, aggView5275306515942068901 where t.kind_id=aggView5275306515942068901.v26 and production_year>1950;
create or replace view aggView5854883392451352130 as select v40, MIN(v41) as v52 from aggJoin7874062855268324759 group by v40;
create or replace view aggJoin5562325928283812399 as select movie_id as v40, keyword_id as v23, v52 from movie_keyword as mk, aggView5854883392451352130 where mk.movie_id=aggView5854883392451352130.v40;
create or replace view aggView3870730092924181085 as select id as v23 from keyword as k where keyword IN ('superhero','sequel','second-part','marvel-comics','based-on-comic','tv-special','fight','violence');
create or replace view aggJoin3911463954413908988 as select v40, v52 from aggJoin5562325928283812399 join aggView3870730092924181085 using(v23);
create or replace view aggView9196068157053364164 as select v40, MIN(v52) as v52 from aggJoin3911463954413908988 group by v40;
create or replace view aggJoin4283025866556436547 as select v40, v52 from aggJoin3586182530531716670 join aggView9196068157053364164 using(v40);
create or replace view aggView969901963195211313 as select v40, MIN(v52) as v52 from aggJoin4283025866556436547 group by v40;
create or replace view aggJoin8505723812871982983 as select v9, v52 from aggJoin7953448535824169552 join aggView969901963195211313 using(v40);
create or replace view aggView1857944677228054481 as select v9, MIN(v52) as v52 from aggJoin8505723812871982983 group by v9;
create or replace view aggJoin4999482764832109529 as select v52 from char_name as chn, aggView1857944677228054481 where chn.id=aggView1857944677228054481.v9 and ((name LIKE '%Tony%Stark%') OR (name LIKE '%Iron%Man%')) and name NOT LIKE '%Sherlock%';
select MIN(v52) as v52 from aggJoin4999482764832109529;
