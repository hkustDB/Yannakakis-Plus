create or replace view aggView6506441905337842238 as select id as v31 from name as n;
create or replace view aggJoin7652722290483566019 as select movie_id as v40, person_role_id as v9 from cast_info as ci, aggView6506441905337842238 where ci.person_id=aggView6506441905337842238.v31;
create or replace view aggView5506083845214848990 as select id as v7 from comp_cast_type as cct2 where kind LIKE '%complete%';
create or replace view aggJoin3380457737481783867 as select movie_id as v40, subject_id as v5 from complete_cast as cc, aggView5506083845214848990 where cc.status_id=aggView5506083845214848990.v7;
create or replace view aggView5637726403346488667 as select id as v26 from kind_type as kt where kind= 'movie';
create or replace view aggJoin8651178945146911039 as select id as v40, title as v41 from title as t, aggView5637726403346488667 where t.kind_id=aggView5637726403346488667.v26 and production_year>1950;
create or replace view aggView3129194943841260727 as select id as v9 from char_name as chn where ((name LIKE '%Tony%Stark%') OR (name LIKE '%Iron%Man%')) and name NOT LIKE '%Sherlock%';
create or replace view aggJoin3308422782986514252 as select v40 from aggJoin7652722290483566019 join aggView3129194943841260727 using(v9);
create or replace view aggView2497337151140666252 as select v40 from aggJoin3308422782986514252 group by v40;
create or replace view aggJoin4794173829673309814 as select v40, v5 from aggJoin3380457737481783867 join aggView2497337151140666252 using(v40);
create or replace view aggView6070420112560923452 as select id as v5 from comp_cast_type as cct1 where kind= 'cast';
create or replace view aggJoin931396163643926810 as select v40 from aggJoin4794173829673309814 join aggView6070420112560923452 using(v5);
create or replace view aggView3799155129515708569 as select v40 from aggJoin931396163643926810 group by v40;
create or replace view aggJoin1935601184779929089 as select v40, v41 from aggJoin8651178945146911039 join aggView3799155129515708569 using(v40);
create or replace view aggView5543770945724304072 as select v40, MIN(v41) as v52 from aggJoin1935601184779929089 group by v40;
create or replace view aggJoin6784557076617902597 as select keyword_id as v23, v52 from movie_keyword as mk, aggView5543770945724304072 where mk.movie_id=aggView5543770945724304072.v40;
create or replace view aggView1984619185190344120 as select v23, MIN(v52) as v52 from aggJoin6784557076617902597 group by v23;
create or replace view aggJoin2824769654918844314 as select v52 from keyword as k, aggView1984619185190344120 where k.id=aggView1984619185190344120.v23 and keyword IN ('superhero','sequel','second-part','marvel-comics','based-on-comic','tv-special','fight','violence');
create or replace view res as select MIN(v52) as v52 from aggJoin2824769654918844314;
select sum(v52) from res;