create or replace view aggView4980848134498748989 as select id as v5 from comp_cast_type as cct1 where kind= 'cast';
create or replace view aggJoin5440274306304625211 as select movie_id as v40, status_id as v7 from complete_cast as cc, aggView4980848134498748989 where cc.subject_id=aggView4980848134498748989.v5;
create or replace view aggView1283503643307223527 as select id as v31 from name as n;
create or replace view aggJoin219008299727270913 as select movie_id as v40, person_role_id as v9 from cast_info as ci, aggView1283503643307223527 where ci.person_id=aggView1283503643307223527.v31;
create or replace view aggView9055143008405197020 as select id as v7 from comp_cast_type as cct2 where kind LIKE '%complete%';
create or replace view aggJoin946334537997750375 as select v40 from aggJoin5440274306304625211 join aggView9055143008405197020 using(v7);
create or replace view aggView4339184989070541766 as select id as v26 from kind_type as kt where kind= 'movie';
create or replace view aggJoin6965918560889957650 as select id as v40, title as v41 from title as t, aggView4339184989070541766 where t.kind_id=aggView4339184989070541766.v26 and production_year>1950;
create or replace view aggView3382477826197699546 as select v40, MIN(v41) as v52 from aggJoin6965918560889957650 group by v40;
create or replace view aggJoin5795937268285364287 as select movie_id as v40, keyword_id as v23, v52 from movie_keyword as mk, aggView3382477826197699546 where mk.movie_id=aggView3382477826197699546.v40;
create or replace view aggView6497066616789355507 as select id as v9 from char_name as chn where ((name LIKE '%Tony%Stark%') OR (name LIKE '%Iron%Man%')) and name NOT LIKE '%Sherlock%';
create or replace view aggJoin5295471655167590662 as select v40 from aggJoin219008299727270913 join aggView6497066616789355507 using(v9);
create or replace view aggView4025817886723786668 as select v40 from aggJoin5295471655167590662 group by v40;
create or replace view aggJoin6155667744788302009 as select v40 from aggJoin946334537997750375 join aggView4025817886723786668 using(v40);
create or replace view aggView7073948187124411303 as select id as v23 from keyword as k where keyword IN ('superhero','sequel','second-part','marvel-comics','based-on-comic','tv-special','fight','violence');
create or replace view aggJoin5609614614705753950 as select v40, v52 from aggJoin5795937268285364287 join aggView7073948187124411303 using(v23);
create or replace view aggView7919482373370094872 as select v40, MIN(v52) as v52 from aggJoin5609614614705753950 group by v40;
create or replace view aggJoin5929554291204070619 as select v52 from aggJoin6155667744788302009 join aggView7919482373370094872 using(v40);
select MIN(v52) as v52 from aggJoin5929554291204070619;
