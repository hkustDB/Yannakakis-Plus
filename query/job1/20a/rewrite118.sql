create or replace view aggView8709277743220816627 as select id as v26 from kind_type as kt where kind= 'movie';
create or replace view aggJoin7268892097759461569 as select id as v40, title as v41 from title as t, aggView8709277743220816627 where t.kind_id=aggView8709277743220816627.v26 and production_year>1950;
create or replace view aggView4629821889619944274 as select v40, MIN(v41) as v52 from aggJoin7268892097759461569 group by v40;
create or replace view aggJoin1125349865912288332 as select person_id as v31, movie_id as v40, person_role_id as v9, v52 from cast_info as ci, aggView4629821889619944274 where ci.movie_id=aggView4629821889619944274.v40;
create or replace view aggView4809281209986009109 as select id as v9 from char_name as chn where ((name LIKE '%Tony%Stark%') OR (name LIKE '%Iron%Man%')) and name NOT LIKE '%Sherlock%';
create or replace view aggJoin2292119385204226786 as select v31, v40, v52 from aggJoin1125349865912288332 join aggView4809281209986009109 using(v9);
create or replace view aggView9146450366290497416 as select id as v31 from name as n;
create or replace view aggJoin9194195367208490852 as select v40, v52 from aggJoin2292119385204226786 join aggView9146450366290497416 using(v31);
create or replace view aggView2149097379877051819 as select v40, MIN(v52) as v52 from aggJoin9194195367208490852 group by v40;
create or replace view aggJoin5045793339603488067 as select movie_id as v40, keyword_id as v23, v52 from movie_keyword as mk, aggView2149097379877051819 where mk.movie_id=aggView2149097379877051819.v40;
create or replace view aggView4939838959568799496 as select id as v7 from comp_cast_type as cct2 where kind LIKE '%complete%';
create or replace view aggJoin5864290050691801249 as select movie_id as v40, subject_id as v5 from complete_cast as cc, aggView4939838959568799496 where cc.status_id=aggView4939838959568799496.v7;
create or replace view aggView2046896924565217392 as select id as v5 from comp_cast_type as cct1 where kind= 'cast';
create or replace view aggJoin7774437372151027086 as select v40 from aggJoin5864290050691801249 join aggView2046896924565217392 using(v5);
create or replace view aggView5285310072848376413 as select v40 from aggJoin7774437372151027086 group by v40;
create or replace view aggJoin5960251703382622962 as select v23, v52 as v52 from aggJoin5045793339603488067 join aggView5285310072848376413 using(v40);
create or replace view aggView2256807987813227409 as select id as v23 from keyword as k where keyword IN ('superhero','sequel','second-part','marvel-comics','based-on-comic','tv-special','fight','violence');
create or replace view aggJoin8511347016168803925 as select v52 from aggJoin5960251703382622962 join aggView2256807987813227409 using(v23);
create or replace view res as select MIN(v52) as v52 from aggJoin8511347016168803925;
select sum(v52) from res;