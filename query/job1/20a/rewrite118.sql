create or replace view aggView1082192699674598650 as select id as v5 from comp_cast_type as cct1 where kind= 'cast';
create or replace view aggJoin5795896788741540548 as select movie_id as v40, status_id as v7 from complete_cast as cc, aggView1082192699674598650 where cc.subject_id=aggView1082192699674598650.v5;
create or replace view aggView3902209548084220938 as select id as v31 from name as n;
create or replace view aggJoin1205483245064360804 as select movie_id as v40, person_role_id as v9 from cast_info as ci, aggView3902209548084220938 where ci.person_id=aggView3902209548084220938.v31;
create or replace view aggView4577035194526650775 as select id as v7 from comp_cast_type as cct2 where kind LIKE '%complete%';
create or replace view aggJoin3909180009669874328 as select v40 from aggJoin5795896788741540548 join aggView4577035194526650775 using(v7);
create or replace view aggView1679789652434543929 as select id as v26 from kind_type as kt where kind= 'movie';
create or replace view aggJoin3311213887410584754 as select id as v40, title as v41 from title as t, aggView1679789652434543929 where t.kind_id=aggView1679789652434543929.v26 and production_year>1950;
create or replace view aggView3495267933569813660 as select v40, MIN(v41) as v52 from aggJoin3311213887410584754 group by v40;
create or replace view aggJoin1844599515894214990 as select movie_id as v40, keyword_id as v23, v52 from movie_keyword as mk, aggView3495267933569813660 where mk.movie_id=aggView3495267933569813660.v40;
create or replace view aggView7016654074144432982 as select v40 from aggJoin3909180009669874328 group by v40;
create or replace view aggJoin4581779666972605635 as select v40, v23, v52 as v52 from aggJoin1844599515894214990 join aggView7016654074144432982 using(v40);
create or replace view aggView6583894266922986866 as select id as v9 from char_name as chn where ((name LIKE '%Tony%Stark%') OR (name LIKE '%Iron%Man%')) and name NOT LIKE '%Sherlock%';
create or replace view aggJoin8141219430536692090 as select v40 from aggJoin1205483245064360804 join aggView6583894266922986866 using(v9);
create or replace view aggView2769736576233290972 as select id as v23 from keyword as k where keyword IN ('superhero','sequel','second-part','marvel-comics','based-on-comic','tv-special','fight','violence');
create or replace view aggJoin3981344095486676905 as select v40, v52 from aggJoin4581779666972605635 join aggView2769736576233290972 using(v23);
create or replace view aggView8660572475685525630 as select v40, MIN(v52) as v52 from aggJoin3981344095486676905 group by v40;
create or replace view aggJoin3859658790240544968 as select v52 from aggJoin8141219430536692090 join aggView8660572475685525630 using(v40);
select MIN(v52) as v52 from aggJoin3859658790240544968;
