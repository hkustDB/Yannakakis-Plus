create or replace view aggView5567885880613338413 as select id as v5 from comp_cast_type as cct1 where kind= 'cast';
create or replace view aggJoin3954325341708327594 as select movie_id as v40, status_id as v7 from complete_cast as cc, aggView5567885880613338413 where cc.subject_id=aggView5567885880613338413.v5;
create or replace view aggView6442449593871654068 as select id as v31 from name as n;
create or replace view aggJoin7648066622907792383 as select movie_id as v40, person_role_id as v9 from cast_info as ci, aggView6442449593871654068 where ci.person_id=aggView6442449593871654068.v31;
create or replace view aggView4042055648687261371 as select id as v7 from comp_cast_type as cct2 where kind LIKE '%complete%';
create or replace view aggJoin4792353115473716887 as select v40 from aggJoin3954325341708327594 join aggView4042055648687261371 using(v7);
create or replace view aggView3266184658402427383 as select id as v26 from kind_type as kt where kind= 'movie';
create or replace view aggJoin3364299234769632284 as select id as v40, title as v41 from title as t, aggView3266184658402427383 where t.kind_id=aggView3266184658402427383.v26 and production_year>1950;
create or replace view aggView4642882539186751249 as select v40, MIN(v41) as v52 from aggJoin3364299234769632284 group by v40;
create or replace view aggJoin1597571820221773928 as select movie_id as v40, keyword_id as v23, v52 from movie_keyword as mk, aggView4642882539186751249 where mk.movie_id=aggView4642882539186751249.v40;
create or replace view aggView4491357870220018756 as select v40 from aggJoin4792353115473716887 group by v40;
create or replace view aggJoin3573204774338313325 as select v40, v23, v52 as v52 from aggJoin1597571820221773928 join aggView4491357870220018756 using(v40);
create or replace view aggView3363561991333895730 as select id as v9 from char_name as chn where ((name LIKE '%Tony%Stark%') OR (name LIKE '%Iron%Man%')) and name NOT LIKE '%Sherlock%';
create or replace view aggJoin2411993925451147098 as select v40 from aggJoin7648066622907792383 join aggView3363561991333895730 using(v9);
create or replace view aggView8936907329922691568 as select v40 from aggJoin2411993925451147098 group by v40;
create or replace view aggJoin6797494337563070453 as select v23, v52 as v52 from aggJoin3573204774338313325 join aggView8936907329922691568 using(v40);
create or replace view aggView4470384043280152040 as select id as v23 from keyword as k where keyword IN ('superhero','sequel','second-part','marvel-comics','based-on-comic','tv-special','fight','violence');
create or replace view aggJoin7785921228586672078 as select v52 from aggJoin6797494337563070453 join aggView4470384043280152040 using(v23);
select MIN(v52) as v52 from aggJoin7785921228586672078;
