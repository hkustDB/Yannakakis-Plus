create or replace view aggView1543048177042237445 as select id as v9 from char_name as chn where ((name LIKE '%Tony%Stark%') OR (name LIKE '%Iron%Man%')) and name NOT LIKE '%Sherlock%';
create or replace view aggJoin6348427804158443802 as select person_id as v31, movie_id as v40 from cast_info as ci, aggView1543048177042237445 where ci.person_role_id=aggView1543048177042237445.v9;
create or replace view aggView2834403911928772384 as select id as v26 from kind_type as kt where kind= 'movie';
create or replace view aggJoin5816208632017383612 as select id as v40, title as v41 from title as t, aggView2834403911928772384 where t.kind_id=aggView2834403911928772384.v26 and production_year>1950;
create or replace view aggView612025810024927099 as select v40, MIN(v41) as v52 from aggJoin5816208632017383612 group by v40;
create or replace view aggJoin2933554469033729630 as select movie_id as v40, subject_id as v5, status_id as v7, v52 from complete_cast as cc, aggView612025810024927099 where cc.movie_id=aggView612025810024927099.v40;
create or replace view aggView4257399771976167056 as select id as v31 from name as n;
create or replace view aggJoin8460033781678902969 as select v40 from aggJoin6348427804158443802 join aggView4257399771976167056 using(v31);
create or replace view aggView8836457225596869768 as select v40 from aggJoin8460033781678902969 group by v40;
create or replace view aggJoin2282369532621049180 as select v40, v5, v7, v52 as v52 from aggJoin2933554469033729630 join aggView8836457225596869768 using(v40);
create or replace view aggView1644085223222058048 as select id as v5 from comp_cast_type as cct1 where kind= 'cast';
create or replace view aggJoin1318730774250550463 as select v40, v7, v52 from aggJoin2282369532621049180 join aggView1644085223222058048 using(v5);
create or replace view aggView5326735547379892659 as select id as v23 from keyword as k where keyword IN ('superhero','sequel','second-part','marvel-comics','based-on-comic','tv-special','fight','violence');
create or replace view aggJoin3530717086525041580 as select movie_id as v40 from movie_keyword as mk, aggView5326735547379892659 where mk.keyword_id=aggView5326735547379892659.v23;
create or replace view aggView1329965913409027816 as select v40 from aggJoin3530717086525041580 group by v40;
create or replace view aggJoin3024810604444043013 as select v7, v52 as v52 from aggJoin1318730774250550463 join aggView1329965913409027816 using(v40);
create or replace view aggView8689343198380472846 as select v7, MIN(v52) as v52 from aggJoin3024810604444043013 group by v7;
create or replace view aggJoin4546700804876219496 as select v52 from comp_cast_type as cct2, aggView8689343198380472846 where cct2.id=aggView8689343198380472846.v7 and kind LIKE '%complete%';
create or replace view res as select MIN(v52) as v52 from aggJoin4546700804876219496;
select sum(v52) from res;