create or replace view aggView1781402123024456998 as select id as v9 from char_name as chn where ((name LIKE '%Tony%Stark%') OR (name LIKE '%Iron%Man%')) and name NOT LIKE '%Sherlock%';
create or replace view aggJoin7876631105316830613 as select person_id as v31, movie_id as v40 from cast_info as ci, aggView1781402123024456998 where ci.person_role_id=aggView1781402123024456998.v9;
create or replace view aggView4284915120935999086 as select id as v26 from kind_type as kt where kind= 'movie';
create or replace view aggJoin328335871873506717 as select id as v40, title as v41 from title as t, aggView4284915120935999086 where t.kind_id=aggView4284915120935999086.v26 and production_year>1950;
create or replace view aggView3830609713036800314 as select id as v31 from name as n;
create or replace view aggJoin3863968699624613669 as select v40 from aggJoin7876631105316830613 join aggView3830609713036800314 using(v31);
create or replace view aggView8381893451503756753 as select v40 from aggJoin3863968699624613669 group by v40;
create or replace view aggJoin3881058510889113827 as select movie_id as v40, subject_id as v5, status_id as v7 from complete_cast as cc, aggView8381893451503756753 where cc.movie_id=aggView8381893451503756753.v40;
create or replace view aggView2449654513151460028 as select id as v7 from comp_cast_type as cct2 where kind LIKE '%complete%';
create or replace view aggJoin1498352811078589449 as select v40, v5 from aggJoin3881058510889113827 join aggView2449654513151460028 using(v7);
create or replace view aggView2399575615346094789 as select id as v5 from comp_cast_type as cct1 where kind= 'cast';
create or replace view aggJoin2632631579865988848 as select v40 from aggJoin1498352811078589449 join aggView2399575615346094789 using(v5);
create or replace view aggView476659133637088928 as select v40 from aggJoin2632631579865988848 group by v40;
create or replace view aggJoin8827468634530492868 as select movie_id as v40, keyword_id as v23 from movie_keyword as mk, aggView476659133637088928 where mk.movie_id=aggView476659133637088928.v40;
create or replace view aggView7630076822871779779 as select id as v23 from keyword as k where keyword IN ('superhero','sequel','second-part','marvel-comics','based-on-comic','tv-special','fight','violence');
create or replace view aggJoin4442965460464562886 as select v40 from aggJoin8827468634530492868 join aggView7630076822871779779 using(v23);
create or replace view aggView2724356001626298627 as select v40 from aggJoin4442965460464562886 group by v40;
create or replace view aggJoin4813897673869378609 as select v41 from aggJoin328335871873506717 join aggView2724356001626298627 using(v40);
create or replace view res as select MIN(v41) as v52 from aggJoin4813897673869378609;
select sum(v52) from res;