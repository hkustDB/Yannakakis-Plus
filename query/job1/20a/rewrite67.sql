create or replace view aggView3941933937173518044 as select id as v26 from kind_type as kt where kind= 'movie';
create or replace view aggJoin4627471533709214234 as select id as v40, title as v41 from title as t, aggView3941933937173518044 where t.kind_id=aggView3941933937173518044.v26 and production_year>1950;
create or replace view aggView4552728599168873968 as select v40, MIN(v41) as v52 from aggJoin4627471533709214234 group by v40;
create or replace view aggJoin8224952225573641055 as select person_id as v31, movie_id as v40, person_role_id as v9, v52 from cast_info as ci, aggView4552728599168873968 where ci.movie_id=aggView4552728599168873968.v40;
create or replace view aggView2041136298134834932 as select id as v9 from char_name as chn where ((name LIKE '%Tony%Stark%') OR (name LIKE '%Iron%Man%')) and name NOT LIKE '%Sherlock%';
create or replace view aggJoin4442616427947939269 as select v31, v40, v52 from aggJoin8224952225573641055 join aggView2041136298134834932 using(v9);
create or replace view aggView6054500951054626485 as select id as v31 from name as n;
create or replace view aggJoin4229435363789113559 as select v40, v52 from aggJoin4442616427947939269 join aggView6054500951054626485 using(v31);
create or replace view aggView1626845849301031577 as select v40, MIN(v52) as v52 from aggJoin4229435363789113559 group by v40;
create or replace view aggJoin7498244317974208282 as select movie_id as v40, keyword_id as v23, v52 from movie_keyword as mk, aggView1626845849301031577 where mk.movie_id=aggView1626845849301031577.v40;
create or replace view aggView861727656641159223 as select id as v5 from comp_cast_type as cct1 where kind= 'cast';
create or replace view aggJoin1155432512424594264 as select movie_id as v40, status_id as v7 from complete_cast as cc, aggView861727656641159223 where cc.subject_id=aggView861727656641159223.v5;
create or replace view aggView1664669430487801536 as select id as v23 from keyword as k where keyword IN ('superhero','sequel','second-part','marvel-comics','based-on-comic','tv-special','fight','violence');
create or replace view aggJoin1388248485063404808 as select v40, v52 from aggJoin7498244317974208282 join aggView1664669430487801536 using(v23);
create or replace view aggView1252481799065114004 as select v40, MIN(v52) as v52 from aggJoin1388248485063404808 group by v40;
create or replace view aggJoin3416115056178184373 as select v7, v52 from aggJoin1155432512424594264 join aggView1252481799065114004 using(v40);
create or replace view aggView7767751135950689435 as select v7, MIN(v52) as v52 from aggJoin3416115056178184373 group by v7;
create or replace view aggJoin6118512302346124709 as select v52 from comp_cast_type as cct2, aggView7767751135950689435 where cct2.id=aggView7767751135950689435.v7 and kind LIKE '%complete%';
create or replace view res as select MIN(v52) as v52 from aggJoin6118512302346124709;
select sum(v52) from res;