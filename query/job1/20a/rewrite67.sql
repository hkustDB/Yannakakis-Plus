create or replace view aggView52247296376266910 as select id as v23 from keyword as k where keyword IN ('superhero','sequel','second-part','marvel-comics','based-on-comic','tv-special','fight','violence');
create or replace view aggJoin2850468123968069388 as select movie_id as v40 from movie_keyword as mk, aggView52247296376266910 where mk.keyword_id=aggView52247296376266910.v23;
create or replace view aggView7335239237813778764 as select id as v7 from comp_cast_type as cct2 where kind LIKE '%complete%';
create or replace view aggJoin5628650078230381971 as select movie_id as v40, subject_id as v5 from complete_cast as cc, aggView7335239237813778764 where cc.status_id=aggView7335239237813778764.v7;
create or replace view aggView6112053412357234916 as select id as v31 from name as n;
create or replace view aggJoin3652822092208661173 as select movie_id as v40, person_role_id as v9 from cast_info as ci, aggView6112053412357234916 where ci.person_id=aggView6112053412357234916.v31;
create or replace view aggView5796227239803514371 as select id as v9 from char_name as chn where ((name LIKE '%Tony%Stark%') OR (name LIKE '%Iron%Man%')) and name NOT LIKE '%Sherlock%';
create or replace view aggJoin8396937356538515460 as select v40 from aggJoin3652822092208661173 join aggView5796227239803514371 using(v9);
create or replace view aggView1450898535815647134 as select v40 from aggJoin8396937356538515460 group by v40;
create or replace view aggJoin2439983733400398816 as select id as v40, title as v41, kind_id as v26 from title as t, aggView1450898535815647134 where t.id=aggView1450898535815647134.v40 and production_year>1950;
create or replace view aggView7493473877284309034 as select v40 from aggJoin2850468123968069388 group by v40;
create or replace view aggJoin9082548117388025808 as select v40, v5 from aggJoin5628650078230381971 join aggView7493473877284309034 using(v40);
create or replace view aggView6220629463996300719 as select id as v26 from kind_type as kt where kind= 'movie';
create or replace view aggJoin7288998171096989300 as select v40, v41 from aggJoin2439983733400398816 join aggView6220629463996300719 using(v26);
create or replace view aggView7501607389443155941 as select v40, MIN(v41) as v52 from aggJoin7288998171096989300 group by v40;
create or replace view aggJoin4679031577760875673 as select v5, v52 from aggJoin9082548117388025808 join aggView7501607389443155941 using(v40);
create or replace view aggView5060557569494451515 as select v5, MIN(v52) as v52 from aggJoin4679031577760875673 group by v5;
create or replace view aggJoin202886594453809563 as select v52 from comp_cast_type as cct1, aggView5060557569494451515 where cct1.id=aggView5060557569494451515.v5 and kind= 'cast';
create or replace view res as select MIN(v52) as v52 from aggJoin202886594453809563;
select sum(v52) from res;