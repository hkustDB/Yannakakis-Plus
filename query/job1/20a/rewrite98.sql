create or replace view aggView5466999568856525891 as select id as v5 from comp_cast_type as cct1 where kind= 'cast';
create or replace view aggJoin9203031570142997543 as select movie_id as v40, status_id as v7 from complete_cast as cc, aggView5466999568856525891 where cc.subject_id=aggView5466999568856525891.v5;
create or replace view aggView2727505717206727713 as select id as v31 from name as n;
create or replace view aggJoin7107278886754221751 as select movie_id as v40, person_role_id as v9 from cast_info as ci, aggView2727505717206727713 where ci.person_id=aggView2727505717206727713.v31;
create or replace view aggView3713879207660880716 as select id as v7 from comp_cast_type as cct2 where kind LIKE '%complete%';
create or replace view aggJoin5888111384640175142 as select v40 from aggJoin9203031570142997543 join aggView3713879207660880716 using(v7);
create or replace view aggView4375820039839655297 as select id as v26 from kind_type as kt where kind= 'movie';
create or replace view aggJoin1241636939336015208 as select id as v40, title as v41 from title as t, aggView4375820039839655297 where t.kind_id=aggView4375820039839655297.v26 and production_year>1950;
create or replace view aggView4898919023551944994 as select v40, MIN(v41) as v52 from aggJoin1241636939336015208 group by v40;
create or replace view aggJoin8351436945849737587 as select v40, v9, v52 from aggJoin7107278886754221751 join aggView4898919023551944994 using(v40);
create or replace view aggView4214552765396016171 as select v40 from aggJoin5888111384640175142 group by v40;
create or replace view aggJoin5962317373998005234 as select movie_id as v40, keyword_id as v23 from movie_keyword as mk, aggView4214552765396016171 where mk.movie_id=aggView4214552765396016171.v40;
create or replace view aggView8255001422070079921 as select id as v9 from char_name as chn where ((name LIKE '%Tony%Stark%') OR (name LIKE '%Iron%Man%')) and name NOT LIKE '%Sherlock%';
create or replace view aggJoin8341822991034972635 as select v40, v52 from aggJoin8351436945849737587 join aggView8255001422070079921 using(v9);
create or replace view aggView205656163493680377 as select v40, MIN(v52) as v52 from aggJoin8341822991034972635 group by v40;
create or replace view aggJoin4461762409878580394 as select v23, v52 from aggJoin5962317373998005234 join aggView205656163493680377 using(v40);
create or replace view aggView7291537431213831157 as select v23, MIN(v52) as v52 from aggJoin4461762409878580394 group by v23;
create or replace view aggJoin3068094968189937245 as select v52 from keyword as k, aggView7291537431213831157 where k.id=aggView7291537431213831157.v23 and keyword IN ('superhero','sequel','second-part','marvel-comics','based-on-comic','tv-special','fight','violence');
select MIN(v52) as v52 from aggJoin3068094968189937245;
