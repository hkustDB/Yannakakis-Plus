create or replace view aggView7434806137342453283 as select id as v5 from comp_cast_type as cct1 where kind= 'cast';
create or replace view aggJoin2722736305480870554 as select movie_id as v40, status_id as v7 from complete_cast as cc, aggView7434806137342453283 where cc.subject_id=aggView7434806137342453283.v5;
create or replace view aggView2373090210818229579 as select id as v31 from name as n;
create or replace view aggJoin1774923364924250761 as select movie_id as v40, person_role_id as v9 from cast_info as ci, aggView2373090210818229579 where ci.person_id=aggView2373090210818229579.v31;
create or replace view aggView4519687502833686035 as select id as v7 from comp_cast_type as cct2 where kind LIKE '%complete%';
create or replace view aggJoin1879683566936436538 as select v40 from aggJoin2722736305480870554 join aggView4519687502833686035 using(v7);
create or replace view aggView6102824741314802651 as select id as v26 from kind_type as kt where kind= 'movie';
create or replace view aggJoin7654463443379349521 as select id as v40, title as v41 from title as t, aggView6102824741314802651 where t.kind_id=aggView6102824741314802651.v26 and production_year>1950;
create or replace view aggView33727008641687937 as select id as v9 from char_name as chn where ((name LIKE '%Tony%Stark%') OR (name LIKE '%Iron%Man%')) and name NOT LIKE '%Sherlock%';
create or replace view aggJoin5259037207795710378 as select v40 from aggJoin1774923364924250761 join aggView33727008641687937 using(v9);
create or replace view aggView6699956677150335251 as select v40 from aggJoin5259037207795710378 group by v40;
create or replace view aggJoin3917756621211895435 as select v40, v41 from aggJoin7654463443379349521 join aggView6699956677150335251 using(v40);
create or replace view aggView1072347700197090045 as select v40, MIN(v41) as v52 from aggJoin3917756621211895435 group by v40;
create or replace view aggJoin5187353833221833609 as select movie_id as v40, keyword_id as v23, v52 from movie_keyword as mk, aggView1072347700197090045 where mk.movie_id=aggView1072347700197090045.v40;
create or replace view aggView7472495262809581683 as select id as v23 from keyword as k where keyword IN ('superhero','sequel','second-part','marvel-comics','based-on-comic','tv-special','fight','violence');
create or replace view aggJoin3936101565121939550 as select v40, v52 from aggJoin5187353833221833609 join aggView7472495262809581683 using(v23);
create or replace view aggView705954903045041289 as select v40, MIN(v52) as v52 from aggJoin3936101565121939550 group by v40;
create or replace view aggJoin6845686370272782795 as select v52 from aggJoin1879683566936436538 join aggView705954903045041289 using(v40);
select MIN(v52) as v52 from aggJoin6845686370272782795;
