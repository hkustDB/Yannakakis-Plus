create or replace view aggView1039105216924970487 as select id as v9 from char_name as chn where ((name LIKE '%Tony%Stark%') OR (name LIKE '%Iron%Man%')) and name NOT LIKE '%Sherlock%';
create or replace view aggJoin5891281215003481868 as select person_id as v31, movie_id as v40 from cast_info as ci, aggView1039105216924970487 where ci.person_role_id=aggView1039105216924970487.v9;
create or replace view aggView8191359819122458098 as select id as v26 from kind_type as kt where kind= 'movie';
create or replace view aggJoin113916459208968976 as select id as v40, title as v41 from title as t, aggView8191359819122458098 where t.kind_id=aggView8191359819122458098.v26 and production_year>1950;
create or replace view aggView3060623711330562581 as select v40, MIN(v41) as v52 from aggJoin113916459208968976 group by v40;
create or replace view aggJoin8993006496063914108 as select movie_id as v40, keyword_id as v23, v52 from movie_keyword as mk, aggView3060623711330562581 where mk.movie_id=aggView3060623711330562581.v40;
create or replace view aggView2786349623690044957 as select id as v31 from name as n;
create or replace view aggJoin9055872872395784012 as select v40 from aggJoin5891281215003481868 join aggView2786349623690044957 using(v31);
create or replace view aggView5764386557655340043 as select v40 from aggJoin9055872872395784012 group by v40;
create or replace view aggJoin154622077486648716 as select v40, v23, v52 as v52 from aggJoin8993006496063914108 join aggView5764386557655340043 using(v40);
create or replace view aggView8827093662059692035 as select id as v7 from comp_cast_type as cct2 where kind LIKE '%complete%';
create or replace view aggJoin7913656950820170251 as select movie_id as v40, subject_id as v5 from complete_cast as cc, aggView8827093662059692035 where cc.status_id=aggView8827093662059692035.v7;
create or replace view aggView9106164017050375084 as select id as v23 from keyword as k where keyword IN ('superhero','sequel','second-part','marvel-comics','based-on-comic','tv-special','fight','violence');
create or replace view aggJoin2495471383149005308 as select v40, v52 from aggJoin154622077486648716 join aggView9106164017050375084 using(v23);
create or replace view aggView3120913372065991053 as select v40, MIN(v52) as v52 from aggJoin2495471383149005308 group by v40;
create or replace view aggJoin3064658905626574739 as select v5, v52 from aggJoin7913656950820170251 join aggView3120913372065991053 using(v40);
create or replace view aggView1957289865219239894 as select v5, MIN(v52) as v52 from aggJoin3064658905626574739 group by v5;
create or replace view aggJoin3049206445803448287 as select v52 from comp_cast_type as cct1, aggView1957289865219239894 where cct1.id=aggView1957289865219239894.v5 and kind= 'cast';
create or replace view res as select MIN(v52) as v52 from aggJoin3049206445803448287;
select sum(v52) from res;