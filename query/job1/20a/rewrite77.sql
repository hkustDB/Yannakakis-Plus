create or replace view aggView8454763135691719499 as select id as v5 from comp_cast_type as cct1 where kind= 'cast';
create or replace view aggJoin8720273957964005756 as select movie_id as v40, status_id as v7 from complete_cast as cc, aggView8454763135691719499 where cc.subject_id=aggView8454763135691719499.v5;
create or replace view aggView9161879618821989606 as select id as v31 from name as n;
create or replace view aggJoin107758965398631294 as select movie_id as v40, person_role_id as v9 from cast_info as ci, aggView9161879618821989606 where ci.person_id=aggView9161879618821989606.v31;
create or replace view aggView2806572102646772218 as select id as v7 from comp_cast_type as cct2 where kind LIKE '%complete%';
create or replace view aggJoin551071353608791645 as select v40 from aggJoin8720273957964005756 join aggView2806572102646772218 using(v7);
create or replace view aggView8620582578537808620 as select id as v26 from kind_type as kt where kind= 'movie';
create or replace view aggJoin8898163738720795795 as select id as v40, title as v41 from title as t, aggView8620582578537808620 where t.kind_id=aggView8620582578537808620.v26 and production_year>1950;
create or replace view aggView3822345487212169529 as select v40, MIN(v41) as v52 from aggJoin8898163738720795795 group by v40;
create or replace view aggJoin3306892167818715369 as select movie_id as v40, keyword_id as v23, v52 from movie_keyword as mk, aggView3822345487212169529 where mk.movie_id=aggView3822345487212169529.v40;
create or replace view aggView6883418236654279064 as select id as v9 from char_name as chn where ((name LIKE '%Tony%Stark%') OR (name LIKE '%Iron%Man%')) and name NOT LIKE '%Sherlock%';
create or replace view aggJoin94869137623223990 as select v40 from aggJoin107758965398631294 join aggView6883418236654279064 using(v9);
create or replace view aggView4987312694671877382 as select v40 from aggJoin94869137623223990 group by v40;
create or replace view aggJoin1030795044554945842 as select v40 from aggJoin551071353608791645 join aggView4987312694671877382 using(v40);
create or replace view aggView8022011845447304608 as select v40 from aggJoin1030795044554945842 group by v40;
create or replace view aggJoin3475159414430787179 as select v23, v52 as v52 from aggJoin3306892167818715369 join aggView8022011845447304608 using(v40);
create or replace view aggView3107979689965543823 as select v23, MIN(v52) as v52 from aggJoin3475159414430787179 group by v23;
create or replace view aggJoin950054523283378410 as select v52 from keyword as k, aggView3107979689965543823 where k.id=aggView3107979689965543823.v23 and keyword IN ('superhero','sequel','second-part','marvel-comics','based-on-comic','tv-special','fight','violence');
select MIN(v52) as v52 from aggJoin950054523283378410;
