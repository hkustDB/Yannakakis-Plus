create or replace view aggView593878341609024115 as select id as v9 from char_name as chn where ((name LIKE '%Tony%Stark%') OR (name LIKE '%Iron%Man%')) and name NOT LIKE '%Sherlock%';
create or replace view aggJoin5229000890483516516 as select person_id as v31, movie_id as v40 from cast_info as ci, aggView593878341609024115 where ci.person_role_id=aggView593878341609024115.v9;
create or replace view aggView4832777545559108796 as select id as v26 from kind_type as kt where kind= 'movie';
create or replace view aggJoin7332628536569134830 as select id as v40, title as v41 from title as t, aggView4832777545559108796 where t.kind_id=aggView4832777545559108796.v26 and production_year>1950;
create or replace view aggView3615029975930786912 as select id as v31 from name as n;
create or replace view aggJoin5410508587108531839 as select v40 from aggJoin5229000890483516516 join aggView3615029975930786912 using(v31);
create or replace view aggView1821957340879626049 as select v40 from aggJoin5410508587108531839 group by v40;
create or replace view aggJoin1243943990720146952 as select movie_id as v40, subject_id as v5, status_id as v7 from complete_cast as cc, aggView1821957340879626049 where cc.movie_id=aggView1821957340879626049.v40;
create or replace view aggView4852940712557969036 as select id as v7 from comp_cast_type as cct2 where kind LIKE '%complete%';
create or replace view aggJoin6210806487506378814 as select v40, v5 from aggJoin1243943990720146952 join aggView4852940712557969036 using(v7);
create or replace view aggView2736698111014405985 as select id as v5 from comp_cast_type as cct1 where kind= 'cast';
create or replace view aggJoin5524834618947968719 as select v40 from aggJoin6210806487506378814 join aggView2736698111014405985 using(v5);
create or replace view aggView5874131552898334546 as select v40 from aggJoin5524834618947968719 group by v40;
create or replace view aggJoin7448835351251626806 as select v40, v41 from aggJoin7332628536569134830 join aggView5874131552898334546 using(v40);
create or replace view aggView2712165522522315372 as select v40, MIN(v41) as v52 from aggJoin7448835351251626806 group by v40;
create or replace view aggJoin1580831253552616530 as select keyword_id as v23, v52 from movie_keyword as mk, aggView2712165522522315372 where mk.movie_id=aggView2712165522522315372.v40;
create or replace view aggView6995960088964999228 as select v23, MIN(v52) as v52 from aggJoin1580831253552616530 group by v23;
create or replace view aggJoin8113046981406638829 as select v52 from keyword as k, aggView6995960088964999228 where k.id=aggView6995960088964999228.v23 and keyword IN ('superhero','sequel','second-part','marvel-comics','based-on-comic','tv-special','fight','violence');
create or replace view res as select MIN(v52) as v52 from aggJoin8113046981406638829;
select sum(v52) from res;