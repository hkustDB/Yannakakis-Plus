create or replace view aggView506690628468978293 as select id as v26 from kind_type as kt where kind= 'movie';
create or replace view aggJoin8112637782592124631 as select id as v40, title as v41 from title as t, aggView506690628468978293 where t.kind_id=aggView506690628468978293.v26 and production_year>1950;
create or replace view aggView6718764634300052127 as select v40, MIN(v41) as v52 from aggJoin8112637782592124631 group by v40;
create or replace view aggJoin8693164925500342192 as select movie_id as v40, keyword_id as v23, v52 from movie_keyword as mk, aggView6718764634300052127 where mk.movie_id=aggView6718764634300052127.v40;
create or replace view aggView4510205625478801080 as select id as v31 from name as n;
create or replace view aggJoin2872041921442795135 as select movie_id as v40, person_role_id as v9 from cast_info as ci, aggView4510205625478801080 where ci.person_id=aggView4510205625478801080.v31;
create or replace view aggView1327558673049543358 as select id as v7 from comp_cast_type as cct2 where kind LIKE '%complete%';
create or replace view aggJoin3441886111695418596 as select movie_id as v40, subject_id as v5 from complete_cast as cc, aggView1327558673049543358 where cc.status_id=aggView1327558673049543358.v7;
create or replace view aggView4747335513230616890 as select id as v5 from comp_cast_type as cct1 where kind= 'cast';
create or replace view aggJoin8255491936078523223 as select v40 from aggJoin3441886111695418596 join aggView4747335513230616890 using(v5);
create or replace view aggView2722522342701369527 as select id as v23 from keyword as k where keyword IN ('superhero','sequel','second-part','marvel-comics','based-on-comic','tv-special','fight','violence');
create or replace view aggJoin8160636887625413797 as select v40, v52 from aggJoin8693164925500342192 join aggView2722522342701369527 using(v23);
create or replace view aggView2035173218306032775 as select v40, MIN(v52) as v52 from aggJoin8160636887625413797 group by v40;
create or replace view aggJoin520532972848021742 as select v40, v52 from aggJoin8255491936078523223 join aggView2035173218306032775 using(v40);
create or replace view aggView4659338180340910416 as select v40, MIN(v52) as v52 from aggJoin520532972848021742 group by v40;
create or replace view aggJoin7403792715665309591 as select v9, v52 from aggJoin2872041921442795135 join aggView4659338180340910416 using(v40);
create or replace view aggView8861927521869505818 as select v9, MIN(v52) as v52 from aggJoin7403792715665309591 group by v9;
create or replace view aggJoin5621100718698751126 as select v52 from char_name as chn, aggView8861927521869505818 where chn.id=aggView8861927521869505818.v9 and ((name LIKE '%Tony%Stark%') OR (name LIKE '%Iron%Man%')) and name NOT LIKE '%Sherlock%';
create or replace view res as select MIN(v52) as v52 from aggJoin5621100718698751126;
select sum(v52) from res;