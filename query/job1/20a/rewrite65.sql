create or replace view aggView152458164338259385 as select id as v23 from keyword as k where keyword IN ('superhero','sequel','second-part','marvel-comics','based-on-comic','tv-special','fight','violence');
create or replace view aggJoin8003997513265208381 as select movie_id as v40 from movie_keyword as mk, aggView152458164338259385 where mk.keyword_id=aggView152458164338259385.v23;
create or replace view aggView8733898016181859723 as select id as v5 from comp_cast_type as cct1 where kind= 'cast';
create or replace view aggJoin8271305727971348294 as select movie_id as v40, status_id as v7 from complete_cast as cc, aggView8733898016181859723 where cc.subject_id=aggView8733898016181859723.v5;
create or replace view aggView8713286912446223732 as select id as v7 from comp_cast_type as cct2 where kind LIKE '%complete%';
create or replace view aggJoin902972238017213820 as select v40 from aggJoin8271305727971348294 join aggView8713286912446223732 using(v7);
create or replace view aggView4051045630930853938 as select id as v31 from name as n;
create or replace view aggJoin8910769491347069827 as select movie_id as v40, person_role_id as v9 from cast_info as ci, aggView4051045630930853938 where ci.person_id=aggView4051045630930853938.v31;
create or replace view aggView2037283203616222000 as select id as v9 from char_name as chn where ((name LIKE '%Tony%Stark%') OR (name LIKE '%Iron%Man%')) and name NOT LIKE '%Sherlock%';
create or replace view aggJoin3445716291214866583 as select v40 from aggJoin8910769491347069827 join aggView2037283203616222000 using(v9);
create or replace view aggView6749594854518686604 as select v40 from aggJoin3445716291214866583 group by v40;
create or replace view aggJoin2030820277422952467 as select id as v40, title as v41, kind_id as v26 from title as t, aggView6749594854518686604 where t.id=aggView6749594854518686604.v40 and production_year>1950;
create or replace view aggView5730201467310771913 as select id as v26 from kind_type as kt where kind= 'movie';
create or replace view aggJoin2639294242412377830 as select v40, v41 from aggJoin2030820277422952467 join aggView5730201467310771913 using(v26);
create or replace view aggView2138966239576694653 as select v40, MIN(v41) as v52 from aggJoin2639294242412377830 group by v40;
create or replace view aggJoin4346250399810540950 as select v40, v52 from aggJoin8003997513265208381 join aggView2138966239576694653 using(v40);
create or replace view aggView4710182523661957345 as select v40, MIN(v52) as v52 from aggJoin4346250399810540950 group by v40;
create or replace view aggJoin8491577321484508178 as select v52 from aggJoin902972238017213820 join aggView4710182523661957345 using(v40);
create or replace view res as select MIN(v52) as v52 from aggJoin8491577321484508178;
select sum(v52) from res;