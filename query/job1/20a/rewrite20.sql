create or replace view aggView8304947298287304941 as select id as v9 from char_name as chn where ((name LIKE '%Tony%Stark%') OR (name LIKE '%Iron%Man%')) and name NOT LIKE '%Sherlock%';
create or replace view aggJoin6425585739100078146 as select person_id as v31, movie_id as v40 from cast_info as ci, aggView8304947298287304941 where ci.person_role_id=aggView8304947298287304941.v9;
create or replace view aggView851947151399688470 as select id as v31 from name as n;
create or replace view aggJoin930773576299346905 as select v40 from aggJoin6425585739100078146 join aggView851947151399688470 using(v31);
create or replace view aggView7732075299923920240 as select id as v7 from comp_cast_type as cct2 where kind LIKE '%complete%';
create or replace view aggJoin642199401135009753 as select movie_id as v40, subject_id as v5 from complete_cast as cc, aggView7732075299923920240 where cc.status_id=aggView7732075299923920240.v7;
create or replace view aggView3092376122938026280 as select id as v5 from comp_cast_type as cct1 where kind= 'cast';
create or replace view aggJoin9152564155806188600 as select v40 from aggJoin642199401135009753 join aggView3092376122938026280 using(v5);
create or replace view aggView6591944971022805732 as select v40 from aggJoin9152564155806188600 group by v40;
create or replace view aggJoin7734236966057243377 as select id as v40, title as v41, kind_id as v26 from title as t, aggView6591944971022805732 where t.id=aggView6591944971022805732.v40 and production_year>1950;
create or replace view aggView2060565902900989605 as select id as v23 from keyword as k where keyword IN ('superhero','sequel','second-part','marvel-comics','based-on-comic','tv-special','fight','violence');
create or replace view aggJoin7414041768853107871 as select movie_id as v40 from movie_keyword as mk, aggView2060565902900989605 where mk.keyword_id=aggView2060565902900989605.v23;
create or replace view aggView6494781980272104506 as select v40 from aggJoin7414041768853107871 group by v40;
create or replace view aggJoin9220024135910334861 as select v40 from aggJoin930773576299346905 join aggView6494781980272104506 using(v40);
create or replace view aggView6473987657318606447 as select v40 from aggJoin9220024135910334861 group by v40;
create or replace view aggJoin3700212942961805257 as select v41, v26 from aggJoin7734236966057243377 join aggView6473987657318606447 using(v40);
create or replace view aggView379519999057458023 as select v26, MIN(v41) as v52 from aggJoin3700212942961805257 group by v26;
create or replace view aggJoin285406251825299288 as select v52 from kind_type as kt, aggView379519999057458023 where kt.id=aggView379519999057458023.v26 and kind= 'movie';
create or replace view res as select MIN(v52) as v52 from aggJoin285406251825299288;
select sum(v52) from res;