create or replace view aggView6870401665911600380 as select id as v26 from kind_type as kt where kind= 'movie';
create or replace view aggJoin4728742944418842416 as select id as v40, title as v41 from title as t, aggView6870401665911600380 where t.kind_id=aggView6870401665911600380.v26 and production_year>1950;
create or replace view aggView6427476608191564786 as select v40, MIN(v41) as v52 from aggJoin4728742944418842416 group by v40;
create or replace view aggJoin8289223474046890579 as select person_id as v31, movie_id as v40, person_role_id as v9, v52 from cast_info as ci, aggView6427476608191564786 where ci.movie_id=aggView6427476608191564786.v40;
create or replace view aggView837641600053350405 as select id as v9 from char_name as chn where ((name LIKE '%Tony%Stark%') OR (name LIKE '%Iron%Man%')) and name NOT LIKE '%Sherlock%';
create or replace view aggJoin7024653459225200941 as select v31, v40, v52 from aggJoin8289223474046890579 join aggView837641600053350405 using(v9);
create or replace view aggView416739018014540020 as select id as v31 from name as n;
create or replace view aggJoin8451953740092969538 as select v40, v52 from aggJoin7024653459225200941 join aggView416739018014540020 using(v31);
create or replace view aggView3963313219985082514 as select v40, MIN(v52) as v52 from aggJoin8451953740092969538 group by v40;
create or replace view aggJoin8116822312567602724 as select movie_id as v40, subject_id as v5, status_id as v7, v52 from complete_cast as cc, aggView3963313219985082514 where cc.movie_id=aggView3963313219985082514.v40;
create or replace view aggView2742109085219856126 as select id as v5 from comp_cast_type as cct1 where kind= 'cast';
create or replace view aggJoin5774165932860309541 as select v40, v7, v52 from aggJoin8116822312567602724 join aggView2742109085219856126 using(v5);
create or replace view aggView5446061563874854449 as select id as v23 from keyword as k where keyword IN ('superhero','sequel','second-part','marvel-comics','based-on-comic','tv-special','fight','violence');
create or replace view aggJoin5094249838615072706 as select movie_id as v40 from movie_keyword as mk, aggView5446061563874854449 where mk.keyword_id=aggView5446061563874854449.v23;
create or replace view aggView6921029998963766289 as select v40 from aggJoin5094249838615072706 group by v40;
create or replace view aggJoin2591421186970501526 as select v7, v52 as v52 from aggJoin5774165932860309541 join aggView6921029998963766289 using(v40);
create or replace view aggView7217712048097126418 as select v7, MIN(v52) as v52 from aggJoin2591421186970501526 group by v7;
create or replace view aggJoin8607818839267871735 as select v52 from comp_cast_type as cct2, aggView7217712048097126418 where cct2.id=aggView7217712048097126418.v7 and kind LIKE '%complete%';
create or replace view res as select MIN(v52) as v52 from aggJoin8607818839267871735;
select sum(v52) from res;