create or replace view aggView3357776939413519069 as select id as v31 from name as n;
create or replace view aggJoin2772994331063788458 as select movie_id as v40, person_role_id as v9 from cast_info as ci, aggView3357776939413519069 where ci.person_id=aggView3357776939413519069.v31;
create or replace view aggView6253837182625849225 as select id as v7 from comp_cast_type as cct2 where kind LIKE '%complete%';
create or replace view aggJoin721375300981504293 as select movie_id as v40, subject_id as v5 from complete_cast as cc, aggView6253837182625849225 where cc.status_id=aggView6253837182625849225.v7;
create or replace view aggView6700683810641608529 as select id as v23 from keyword as k where keyword IN ('superhero','sequel','second-part','marvel-comics','based-on-comic','tv-special','fight','violence');
create or replace view aggJoin1761564125986093934 as select movie_id as v40 from movie_keyword as mk, aggView6700683810641608529 where mk.keyword_id=aggView6700683810641608529.v23;
create or replace view aggView6212949111035770182 as select id as v9 from char_name as chn where ((name LIKE '%Tony%Stark%') OR (name LIKE '%Iron%Man%')) and name NOT LIKE '%Sherlock%';
create or replace view aggJoin4166855394141664409 as select v40 from aggJoin2772994331063788458 join aggView6212949111035770182 using(v9);
create or replace view aggView3409502357000248605 as select id as v5 from comp_cast_type as cct1 where kind= 'cast';
create or replace view aggJoin2398225132772033571 as select v40 from aggJoin721375300981504293 join aggView3409502357000248605 using(v5);
create or replace view aggView5596005827447456639 as select v40 from aggJoin2398225132772033571 group by v40;
create or replace view aggJoin7754868850283411419 as select id as v40, title as v41, kind_id as v26 from title as t, aggView5596005827447456639 where t.id=aggView5596005827447456639.v40 and production_year>1950;
create or replace view aggView3657876167513777814 as select v40 from aggJoin4166855394141664409 group by v40;
create or replace view aggJoin7885751132815533103 as select v40 from aggJoin1761564125986093934 join aggView3657876167513777814 using(v40);
create or replace view aggView5504645867836853483 as select v40 from aggJoin7885751132815533103 group by v40;
create or replace view aggJoin2243925628066770987 as select v41, v26 from aggJoin7754868850283411419 join aggView5504645867836853483 using(v40);
create or replace view aggView3812618727815266761 as select v26, MIN(v41) as v52 from aggJoin2243925628066770987 group by v26;
create or replace view aggJoin1402094185061710392 as select v52 from kind_type as kt, aggView3812618727815266761 where kt.id=aggView3812618727815266761.v26 and kind= 'movie';
create or replace view res as select MIN(v52) as v52 from aggJoin1402094185061710392;
select sum(v52) from res;