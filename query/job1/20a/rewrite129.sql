create or replace view aggView2977282147773946788 as select id as v23 from keyword as k where keyword IN ('superhero','sequel','second-part','marvel-comics','based-on-comic','tv-special','fight','violence');
create or replace view aggJoin6461065498763825657 as select movie_id as v40 from movie_keyword as mk, aggView2977282147773946788 where mk.keyword_id=aggView2977282147773946788.v23;
create or replace view aggView5607021322261413582 as select id as v5 from comp_cast_type as cct1 where kind= 'cast';
create or replace view aggJoin242884100353074799 as select movie_id as v40, status_id as v7 from complete_cast as cc, aggView5607021322261413582 where cc.subject_id=aggView5607021322261413582.v5;
create or replace view aggView2205240666923601993 as select id as v7 from comp_cast_type as cct2 where kind LIKE '%complete%';
create or replace view aggJoin2554274593774066544 as select v40 from aggJoin242884100353074799 join aggView2205240666923601993 using(v7);
create or replace view aggView570941241900262253 as select v40 from aggJoin2554274593774066544 group by v40;
create or replace view aggJoin5222823245211354144 as select person_id as v31, movie_id as v40, person_role_id as v9 from cast_info as ci, aggView570941241900262253 where ci.movie_id=aggView570941241900262253.v40;
create or replace view aggView2327118674336166334 as select id as v31 from name as n;
create or replace view aggJoin7450243895103819153 as select v40, v9 from aggJoin5222823245211354144 join aggView2327118674336166334 using(v31);
create or replace view aggView271842295028645239 as select id as v9 from char_name as chn where ((name LIKE '%Tony%Stark%') OR (name LIKE '%Iron%Man%')) and name NOT LIKE '%Sherlock%';
create or replace view aggJoin234848629907003959 as select v40 from aggJoin7450243895103819153 join aggView271842295028645239 using(v9);
create or replace view aggView2252528630641500650 as select v40 from aggJoin6461065498763825657 group by v40;
create or replace view aggJoin6588953622743187861 as select v40 from aggJoin234848629907003959 join aggView2252528630641500650 using(v40);
create or replace view aggView4937710712575239559 as select v40 from aggJoin6588953622743187861 group by v40;
create or replace view aggJoin6821832773106418048 as select title as v41, kind_id as v26 from title as t, aggView4937710712575239559 where t.id=aggView4937710712575239559.v40 and production_year>1950;
create or replace view aggView3760522138756555843 as select id as v26 from kind_type as kt where kind= 'movie';
create or replace view aggJoin3219745350186504120 as select v41 from aggJoin6821832773106418048 join aggView3760522138756555843 using(v26);
create or replace view res as select MIN(v41) as v52 from aggJoin3219745350186504120;
select sum(v52) from res;