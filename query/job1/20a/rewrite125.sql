create or replace view aggView3701514972286904701 as select id as v26 from kind_type as kt where kind= 'movie';
create or replace view aggJoin7769341409009783564 as select id as v40, title as v41 from title as t, aggView3701514972286904701 where t.kind_id=aggView3701514972286904701.v26 and production_year>1950;
create or replace view aggView1675131434732036003 as select v40, MIN(v41) as v52 from aggJoin7769341409009783564 group by v40;
create or replace view aggJoin2235479781594058390 as select movie_id as v40, subject_id as v5, status_id as v7, v52 from complete_cast as cc, aggView1675131434732036003 where cc.movie_id=aggView1675131434732036003.v40;
create or replace view aggView3412371373614548393 as select id as v31 from name as n;
create or replace view aggJoin2257554531635311453 as select movie_id as v40, person_role_id as v9 from cast_info as ci, aggView3412371373614548393 where ci.person_id=aggView3412371373614548393.v31;
create or replace view aggView7970620805888847434 as select id as v7 from comp_cast_type as cct2 where kind LIKE '%complete%';
create or replace view aggJoin5408962388247247577 as select v40, v5, v52 from aggJoin2235479781594058390 join aggView7970620805888847434 using(v7);
create or replace view aggView5587530637201845622 as select id as v5 from comp_cast_type as cct1 where kind= 'cast';
create or replace view aggJoin8890882236181759185 as select v40, v52 from aggJoin5408962388247247577 join aggView5587530637201845622 using(v5);
create or replace view aggView245348363464812328 as select v40, MIN(v52) as v52 from aggJoin8890882236181759185 group by v40;
create or replace view aggJoin5480052862049338042 as select movie_id as v40, keyword_id as v23, v52 from movie_keyword as mk, aggView245348363464812328 where mk.movie_id=aggView245348363464812328.v40;
create or replace view aggView2374538070347712839 as select id as v23 from keyword as k where keyword IN ('superhero','sequel','second-part','marvel-comics','based-on-comic','tv-special','fight','violence');
create or replace view aggJoin8620449133080338945 as select v40, v52 from aggJoin5480052862049338042 join aggView2374538070347712839 using(v23);
create or replace view aggView335708599279304793 as select v40, MIN(v52) as v52 from aggJoin8620449133080338945 group by v40;
create or replace view aggJoin828345476074581705 as select v9, v52 from aggJoin2257554531635311453 join aggView335708599279304793 using(v40);
create or replace view aggView2183053062013133056 as select v9, MIN(v52) as v52 from aggJoin828345476074581705 group by v9;
create or replace view aggJoin8158218662631315346 as select v52 from char_name as chn, aggView2183053062013133056 where chn.id=aggView2183053062013133056.v9 and ((name LIKE '%Tony%Stark%') OR (name LIKE '%Iron%Man%')) and name NOT LIKE '%Sherlock%';
create or replace view res as select MIN(v52) as v52 from aggJoin8158218662631315346;
select sum(v52) from res;