create or replace view aggView6946342668601025360 as select id as v9 from char_name as chn where ((name LIKE '%Tony%Stark%') OR (name LIKE '%Iron%Man%')) and name NOT LIKE '%Sherlock%';
create or replace view aggJoin2546500796469066981 as select person_id as v31, movie_id as v40 from cast_info as ci, aggView6946342668601025360 where ci.person_role_id=aggView6946342668601025360.v9;
create or replace view aggView6513198401199876153 as select id as v26 from kind_type as kt where kind= 'movie';
create or replace view aggJoin41562152994332627 as select id as v40, title as v41 from title as t, aggView6513198401199876153 where t.kind_id=aggView6513198401199876153.v26 and production_year>1950;
create or replace view aggView4271623867267934087 as select v40, MIN(v41) as v52 from aggJoin41562152994332627 group by v40;
create or replace view aggJoin8891982137645596442 as select movie_id as v40, keyword_id as v23, v52 from movie_keyword as mk, aggView4271623867267934087 where mk.movie_id=aggView4271623867267934087.v40;
create or replace view aggView8153227604309267100 as select id as v31 from name as n;
create or replace view aggJoin60592379475878152 as select v40 from aggJoin2546500796469066981 join aggView8153227604309267100 using(v31);
create or replace view aggView7871662851870726104 as select v40 from aggJoin60592379475878152 group by v40;
create or replace view aggJoin588811287325193405 as select movie_id as v40, subject_id as v5, status_id as v7 from complete_cast as cc, aggView7871662851870726104 where cc.movie_id=aggView7871662851870726104.v40;
create or replace view aggView6726433427928269067 as select id as v7 from comp_cast_type as cct2 where kind LIKE '%complete%';
create or replace view aggJoin5937730025670385589 as select v40, v5 from aggJoin588811287325193405 join aggView6726433427928269067 using(v7);
create or replace view aggView6298461759281362128 as select id as v5 from comp_cast_type as cct1 where kind= 'cast';
create or replace view aggJoin924044624272563038 as select v40 from aggJoin5937730025670385589 join aggView6298461759281362128 using(v5);
create or replace view aggView340943779597199695 as select id as v23 from keyword as k where keyword IN ('superhero','sequel','second-part','marvel-comics','based-on-comic','tv-special','fight','violence');
create or replace view aggJoin8228483100508059664 as select v40, v52 from aggJoin8891982137645596442 join aggView340943779597199695 using(v23);
create or replace view aggView4808821741588559748 as select v40, MIN(v52) as v52 from aggJoin8228483100508059664 group by v40;
create or replace view aggJoin4003306804327927861 as select v52 from aggJoin924044624272563038 join aggView4808821741588559748 using(v40);
create or replace view res as select MIN(v52) as v52 from aggJoin4003306804327927861;
select sum(v52) from res;