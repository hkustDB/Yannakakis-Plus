create or replace view aggView248232575240315482 as select id as v9 from char_name as chn where ((name LIKE '%Tony%Stark%') OR (name LIKE '%Iron%Man%')) and name NOT LIKE '%Sherlock%';
create or replace view aggJoin3027769550193791542 as select person_id as v31, movie_id as v40 from cast_info as ci, aggView248232575240315482 where ci.person_role_id=aggView248232575240315482.v9;
create or replace view aggView7004489664231135208 as select id as v26 from kind_type as kt where kind= 'movie';
create or replace view aggJoin2545859284197759769 as select id as v40, title as v41 from title as t, aggView7004489664231135208 where t.kind_id=aggView7004489664231135208.v26 and production_year>1950;
create or replace view aggView202768475399447929 as select id as v31 from name as n;
create or replace view aggJoin1892707669630902174 as select v40 from aggJoin3027769550193791542 join aggView202768475399447929 using(v31);
create or replace view aggView2582397871340988680 as select id as v7 from comp_cast_type as cct2 where kind LIKE '%complete%';
create or replace view aggJoin4214497837533691687 as select movie_id as v40, subject_id as v5 from complete_cast as cc, aggView2582397871340988680 where cc.status_id=aggView2582397871340988680.v7;
create or replace view aggView1435211999766589928 as select id as v5 from comp_cast_type as cct1 where kind= 'cast';
create or replace view aggJoin3391707523911788583 as select v40 from aggJoin4214497837533691687 join aggView1435211999766589928 using(v5);
create or replace view aggView994049816317381240 as select id as v23 from keyword as k where keyword IN ('superhero','sequel','second-part','marvel-comics','based-on-comic','tv-special','fight','violence');
create or replace view aggJoin1402135946329814959 as select movie_id as v40 from movie_keyword as mk, aggView994049816317381240 where mk.keyword_id=aggView994049816317381240.v23;
create or replace view aggView7626975268945426661 as select v40 from aggJoin1402135946329814959 group by v40;
create or replace view aggJoin4969143161068816230 as select v40 from aggJoin1892707669630902174 join aggView7626975268945426661 using(v40);
create or replace view aggView2982676194222999559 as select v40 from aggJoin4969143161068816230 group by v40;
create or replace view aggJoin3553544948596394328 as select v40, v41 from aggJoin2545859284197759769 join aggView2982676194222999559 using(v40);
create or replace view aggView4560651242254569178 as select v40, MIN(v41) as v52 from aggJoin3553544948596394328 group by v40;
create or replace view aggJoin3878398929790729008 as select v52 from aggJoin3391707523911788583 join aggView4560651242254569178 using(v40);
create or replace view res as select MIN(v52) as v52 from aggJoin3878398929790729008;
select sum(v52) from res;