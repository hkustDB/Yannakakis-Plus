create or replace view aggView5958958951959607246 as select id as v26 from kind_type as kt where kind= 'movie';
create or replace view aggJoin5883797911113128270 as select id as v40, title as v41 from title as t, aggView5958958951959607246 where t.kind_id=aggView5958958951959607246.v26 and production_year>1950;
create or replace view aggView1536322230975748654 as select id as v9 from char_name as chn where ((name LIKE '%Tony%Stark%') OR (name LIKE '%Iron%Man%')) and name NOT LIKE '%Sherlock%';
create or replace view aggJoin3292116092117022045 as select person_id as v31, movie_id as v40 from cast_info as ci, aggView1536322230975748654 where ci.person_role_id=aggView1536322230975748654.v9;
create or replace view aggView1161223109711419364 as select id as v31 from name as n;
create or replace view aggJoin4385558241740882155 as select v40 from aggJoin3292116092117022045 join aggView1161223109711419364 using(v31);
create or replace view aggView3054209314279874890 as select id as v7 from comp_cast_type as cct2 where kind LIKE '%complete%';
create or replace view aggJoin7518788625885556956 as select movie_id as v40, subject_id as v5 from complete_cast as cc, aggView3054209314279874890 where cc.status_id=aggView3054209314279874890.v7;
create or replace view aggView1728066123049778811 as select id as v5 from comp_cast_type as cct1 where kind= 'cast';
create or replace view aggJoin3341037217745500080 as select v40 from aggJoin7518788625885556956 join aggView1728066123049778811 using(v5);
create or replace view aggView1780489663924068425 as select v40 from aggJoin3341037217745500080 group by v40;
create or replace view aggJoin1716080862691923313 as select v40, v41 from aggJoin5883797911113128270 join aggView1780489663924068425 using(v40);
create or replace view aggView4758771983817486250 as select v40, MIN(v41) as v52 from aggJoin1716080862691923313 group by v40;
create or replace view aggJoin2300319505455969519 as select v40, v52 from aggJoin4385558241740882155 join aggView4758771983817486250 using(v40);
create or replace view aggView3439677213807472737 as select v40, MIN(v52) as v52 from aggJoin2300319505455969519 group by v40;
create or replace view aggJoin2645461336248468755 as select keyword_id as v23, v52 from movie_keyword as mk, aggView3439677213807472737 where mk.movie_id=aggView3439677213807472737.v40;
create or replace view aggView8614751095246594412 as select v23, MIN(v52) as v52 from aggJoin2645461336248468755 group by v23;
create or replace view aggJoin7136320341776898569 as select v52 from keyword as k, aggView8614751095246594412 where k.id=aggView8614751095246594412.v23 and keyword IN ('superhero','sequel','second-part','marvel-comics','based-on-comic','tv-special','fight','violence');
create or replace view res as select MIN(v52) as v52 from aggJoin7136320341776898569;
select sum(v52) from res;