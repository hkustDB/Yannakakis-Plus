create or replace view aggView701127048867585343 as select id as v31 from name as n;
create or replace view aggJoin1745380926644678914 as select movie_id as v40, person_role_id as v9 from cast_info as ci, aggView701127048867585343 where ci.person_id=aggView701127048867585343.v31;
create or replace view aggView1739049547781408273 as select id as v7 from comp_cast_type as cct2 where kind LIKE '%complete%';
create or replace view aggJoin5836004067659830258 as select movie_id as v40, subject_id as v5 from complete_cast as cc, aggView1739049547781408273 where cc.status_id=aggView1739049547781408273.v7;
create or replace view aggView2673998631997832993 as select id as v23 from keyword as k where keyword IN ('superhero','sequel','second-part','marvel-comics','based-on-comic','tv-special','fight','violence');
create or replace view aggJoin2048360852523213314 as select movie_id as v40 from movie_keyword as mk, aggView2673998631997832993 where mk.keyword_id=aggView2673998631997832993.v23;
create or replace view aggView2628238523243892868 as select id as v26 from kind_type as kt where kind= 'movie';
create or replace view aggJoin8036114820415578014 as select id as v40, title as v41 from title as t, aggView2628238523243892868 where t.kind_id=aggView2628238523243892868.v26 and production_year>1950;
create or replace view aggView1102159348409564805 as select v40, MIN(v41) as v52 from aggJoin8036114820415578014 group by v40;
create or replace view aggJoin8319393096311078542 as select v40, v52 from aggJoin2048360852523213314 join aggView1102159348409564805 using(v40);
create or replace view aggView3747764072788636582 as select v40, MIN(v52) as v52 from aggJoin8319393096311078542 group by v40;
create or replace view aggJoin5844593632907756225 as select v40, v5, v52 from aggJoin5836004067659830258 join aggView3747764072788636582 using(v40);
create or replace view aggView1410960985690248237 as select id as v9 from char_name as chn where ((name LIKE '%Tony%Stark%') OR (name LIKE '%Iron%Man%')) and name NOT LIKE '%Sherlock%';
create or replace view aggJoin720560116970860003 as select v40 from aggJoin1745380926644678914 join aggView1410960985690248237 using(v9);
create or replace view aggView3845374950329357138 as select id as v5 from comp_cast_type as cct1 where kind= 'cast';
create or replace view aggJoin1464801720265199537 as select v40, v52 from aggJoin5844593632907756225 join aggView3845374950329357138 using(v5);
create or replace view aggView4429975857262043540 as select v40, MIN(v52) as v52 from aggJoin1464801720265199537 group by v40;
create or replace view aggJoin7157040248940847480 as select v52 from aggJoin720560116970860003 join aggView4429975857262043540 using(v40);
create or replace view res as select MIN(v52) as v52 from aggJoin7157040248940847480;
select sum(v52) from res;