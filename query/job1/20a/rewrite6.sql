create or replace view aggView6869124023343664451 as select id as v23 from keyword as k where keyword IN ('superhero','sequel','second-part','marvel-comics','based-on-comic','tv-special','fight','violence');
create or replace view aggJoin4363696433663287041 as select movie_id as v40 from movie_keyword as mk, aggView6869124023343664451 where mk.keyword_id=aggView6869124023343664451.v23;
create or replace view aggView8069394812941056367 as select id as v7 from comp_cast_type as cct2 where kind LIKE '%complete%';
create or replace view aggJoin7733170481796705942 as select movie_id as v40, subject_id as v5 from complete_cast as cc, aggView8069394812941056367 where cc.status_id=aggView8069394812941056367.v7;
create or replace view aggView3970258659695586925 as select id as v31 from name as n;
create or replace view aggJoin2153272049664323392 as select movie_id as v40, person_role_id as v9 from cast_info as ci, aggView3970258659695586925 where ci.person_id=aggView3970258659695586925.v31;
create or replace view aggView8509090189194799770 as select id as v9 from char_name as chn where ((name LIKE '%Tony%Stark%') OR (name LIKE '%Iron%Man%')) and name NOT LIKE '%Sherlock%';
create or replace view aggJoin7734925520011187793 as select v40 from aggJoin2153272049664323392 join aggView8509090189194799770 using(v9);
create or replace view aggView8704590850128001450 as select v40 from aggJoin7734925520011187793 group by v40;
create or replace view aggJoin8516186624474132897 as select id as v40, title as v41, kind_id as v26 from title as t, aggView8704590850128001450 where t.id=aggView8704590850128001450.v40 and production_year>1950;
create or replace view aggView2423930256847631074 as select id as v26 from kind_type as kt where kind= 'movie';
create or replace view aggJoin2184694446843058886 as select v40, v41 from aggJoin8516186624474132897 join aggView2423930256847631074 using(v26);
create or replace view aggView5236549491445176045 as select v40, MIN(v41) as v52 from aggJoin2184694446843058886 group by v40;
create or replace view aggJoin2027052923634903250 as select v40, v52 from aggJoin4363696433663287041 join aggView5236549491445176045 using(v40);
create or replace view aggView3105986911054296499 as select v40, MIN(v52) as v52 from aggJoin2027052923634903250 group by v40;
create or replace view aggJoin8547444427572518781 as select v5, v52 from aggJoin7733170481796705942 join aggView3105986911054296499 using(v40);
create or replace view aggView6597952099530035962 as select v5, MIN(v52) as v52 from aggJoin8547444427572518781 group by v5;
create or replace view aggJoin8917077580019417692 as select v52 from comp_cast_type as cct1, aggView6597952099530035962 where cct1.id=aggView6597952099530035962.v5 and kind= 'cast';
create or replace view res as select MIN(v52) as v52 from aggJoin8917077580019417692;
select sum(v52) from res;