create or replace view aggView6740140886003060351 as select id as v5 from comp_cast_type as cct1 where kind= 'cast';
create or replace view aggJoin2454632881820116396 as select movie_id as v40, status_id as v7 from complete_cast as cc, aggView6740140886003060351 where cc.subject_id=aggView6740140886003060351.v5;
create or replace view aggView4115538229235514041 as select id as v7 from comp_cast_type as cct2 where kind LIKE '%complete%';
create or replace view aggJoin8126330026231358194 as select v40 from aggJoin2454632881820116396 join aggView4115538229235514041 using(v7);
create or replace view aggView8758229895155519830 as select id as v31 from name as n;
create or replace view aggJoin5422061246192496177 as select movie_id as v40, person_role_id as v9 from cast_info as ci, aggView8758229895155519830 where ci.person_id=aggView8758229895155519830.v31;
create or replace view aggView1904818140271045827 as select id as v9 from char_name as chn where ((name LIKE '%Tony%Stark%') OR (name LIKE '%Iron%Man%')) and name NOT LIKE '%Sherlock%';
create or replace view aggJoin7887624672593578312 as select v40 from aggJoin5422061246192496177 join aggView1904818140271045827 using(v9);
create or replace view aggView341484958329595825 as select v40 from aggJoin7887624672593578312 group by v40;
create or replace view aggJoin3642842214426025435 as select id as v40, title as v41, kind_id as v26 from title as t, aggView341484958329595825 where t.id=aggView341484958329595825.v40 and production_year>1950;
create or replace view aggView5323144797215222077 as select id as v26 from kind_type as kt where kind= 'movie';
create or replace view aggJoin4458861210521927128 as select v40, v41 from aggJoin3642842214426025435 join aggView5323144797215222077 using(v26);
create or replace view aggView620672529926239401 as select v40, MIN(v41) as v52 from aggJoin4458861210521927128 group by v40;
create or replace view aggJoin2969510724136135899 as select v40, v52 from aggJoin8126330026231358194 join aggView620672529926239401 using(v40);
create or replace view aggView8187229522377813836 as select v40, MIN(v52) as v52 from aggJoin2969510724136135899 group by v40;
create or replace view aggJoin9069409658742431688 as select keyword_id as v23, v52 from movie_keyword as mk, aggView8187229522377813836 where mk.movie_id=aggView8187229522377813836.v40;
create or replace view aggView4963112526214510406 as select v23, MIN(v52) as v52 from aggJoin9069409658742431688 group by v23;
create or replace view aggJoin7870267596891382619 as select v52 from keyword as k, aggView4963112526214510406 where k.id=aggView4963112526214510406.v23 and keyword IN ('superhero','sequel','second-part','marvel-comics','based-on-comic','tv-special','fight','violence');
create or replace view res as select MIN(v52) as v52 from aggJoin7870267596891382619;
select sum(v52) from res;