create or replace view aggView195113564377279975 as select id as v31 from name as n;
create or replace view aggJoin3630040517426342478 as select movie_id as v40, person_role_id as v9 from cast_info as ci, aggView195113564377279975 where ci.person_id=aggView195113564377279975.v31;
create or replace view aggView6125003624585258368 as select id as v7 from comp_cast_type as cct2 where kind LIKE '%complete%';
create or replace view aggJoin8607568764376454949 as select movie_id as v40, subject_id as v5 from complete_cast as cc, aggView6125003624585258368 where cc.status_id=aggView6125003624585258368.v7;
create or replace view aggView5558001721616260242 as select id as v23 from keyword as k where keyword IN ('superhero','sequel','second-part','marvel-comics','based-on-comic','tv-special','fight','violence');
create or replace view aggJoin1808199621021959592 as select movie_id as v40 from movie_keyword as mk, aggView5558001721616260242 where mk.keyword_id=aggView5558001721616260242.v23;
create or replace view aggView1059279996507082381 as select id as v26 from kind_type as kt where kind= 'movie';
create or replace view aggJoin6934039545621335465 as select id as v40, title as v41 from title as t, aggView1059279996507082381 where t.kind_id=aggView1059279996507082381.v26 and production_year>1950;
create or replace view aggView7569988930923694588 as select v40 from aggJoin1808199621021959592 group by v40;
create or replace view aggJoin9219818955110759563 as select v40, v41 from aggJoin6934039545621335465 join aggView7569988930923694588 using(v40);
create or replace view aggView7702162173835177306 as select v40, MIN(v41) as v52 from aggJoin9219818955110759563 group by v40;
create or replace view aggJoin1239339480241053681 as select v40, v5, v52 from aggJoin8607568764376454949 join aggView7702162173835177306 using(v40);
create or replace view aggView8512044979900746840 as select id as v5 from comp_cast_type as cct1 where kind= 'cast';
create or replace view aggJoin6336426803422785474 as select v40, v52 from aggJoin1239339480241053681 join aggView8512044979900746840 using(v5);
create or replace view aggView6753183700703163931 as select v40, MIN(v52) as v52 from aggJoin6336426803422785474 group by v40;
create or replace view aggJoin7001522219078750428 as select v9, v52 from aggJoin3630040517426342478 join aggView6753183700703163931 using(v40);
create or replace view aggView2218709440637472615 as select v9, MIN(v52) as v52 from aggJoin7001522219078750428 group by v9;
create or replace view aggJoin3687637621349644431 as select v52 from char_name as chn, aggView2218709440637472615 where chn.id=aggView2218709440637472615.v9 and ((name LIKE '%Tony%Stark%') OR (name LIKE '%Iron%Man%')) and name NOT LIKE '%Sherlock%';
create or replace view res as select MIN(v52) as v52 from aggJoin3687637621349644431;
select sum(v52) from res;