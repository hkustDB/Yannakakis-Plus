create or replace view aggView2669376234403931802 as select id as v5 from comp_cast_type as cct1 where kind= 'cast';
create or replace view aggJoin773623959082831426 as select movie_id as v40, status_id as v7 from complete_cast as cc, aggView2669376234403931802 where cc.subject_id=aggView2669376234403931802.v5;
create or replace view aggView2533150640136275344 as select id as v31 from name as n;
create or replace view aggJoin6894392037393700647 as select movie_id as v40, person_role_id as v9 from cast_info as ci, aggView2533150640136275344 where ci.person_id=aggView2533150640136275344.v31;
create or replace view aggView5530652340402813791 as select id as v7 from comp_cast_type as cct2 where kind LIKE '%complete%';
create or replace view aggJoin1710055591119441220 as select v40 from aggJoin773623959082831426 join aggView5530652340402813791 using(v7);
create or replace view aggView5136200042663015805 as select v40 from aggJoin1710055591119441220 group by v40;
create or replace view aggJoin8015571954213342338 as select id as v40, title as v41, kind_id as v26 from title as t, aggView5136200042663015805 where t.id=aggView5136200042663015805.v40 and production_year>1950;
create or replace view aggView4102000089724640167 as select id as v26 from kind_type as kt where kind= 'movie';
create or replace view aggJoin2858140330403525751 as select v40, v41 from aggJoin8015571954213342338 join aggView4102000089724640167 using(v26);
create or replace view aggView7150937220977015406 as select id as v23 from keyword as k where keyword IN ('superhero','sequel','second-part','marvel-comics','based-on-comic','tv-special','fight','violence');
create or replace view aggJoin2243150411140792417 as select movie_id as v40 from movie_keyword as mk, aggView7150937220977015406 where mk.keyword_id=aggView7150937220977015406.v23;
create or replace view aggView1165730349026169490 as select v40 from aggJoin2243150411140792417 group by v40;
create or replace view aggJoin3367573426222535825 as select v40, v41 from aggJoin2858140330403525751 join aggView1165730349026169490 using(v40);
create or replace view aggView592404414896175511 as select v40, MIN(v41) as v52 from aggJoin3367573426222535825 group by v40;
create or replace view aggJoin7519995343350032416 as select v9, v52 from aggJoin6894392037393700647 join aggView592404414896175511 using(v40);
create or replace view aggView581247676896842466 as select v9, MIN(v52) as v52 from aggJoin7519995343350032416 group by v9;
create or replace view aggJoin3087248951242288925 as select v52 from char_name as chn, aggView581247676896842466 where chn.id=aggView581247676896842466.v9 and ((name LIKE '%Tony%Stark%') OR (name LIKE '%Iron%Man%')) and name NOT LIKE '%Sherlock%';
select MIN(v52) as v52 from aggJoin3087248951242288925;
