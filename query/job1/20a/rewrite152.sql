create or replace view aggView5029198156777384145 as select id as v26 from kind_type as kt where kind= 'movie';
create or replace view aggJoin4847542611908142082 as select id as v40, title as v41 from title as t, aggView5029198156777384145 where t.kind_id=aggView5029198156777384145.v26 and production_year>1950;
create or replace view aggView1091132682697083803 as select v40, MIN(v41) as v52 from aggJoin4847542611908142082 group by v40;
create or replace view aggJoin7897666893604081176 as select movie_id as v40, subject_id as v5, status_id as v7, v52 from complete_cast as cc, aggView1091132682697083803 where cc.movie_id=aggView1091132682697083803.v40;
create or replace view aggView2918687745972274265 as select id as v31 from name as n;
create or replace view aggJoin8034271252507986203 as select movie_id as v40, person_role_id as v9 from cast_info as ci, aggView2918687745972274265 where ci.person_id=aggView2918687745972274265.v31;
create or replace view aggView1808641732429587803 as select id as v7 from comp_cast_type as cct2 where kind LIKE '%complete%';
create or replace view aggJoin1094735465250922403 as select v40, v5, v52 from aggJoin7897666893604081176 join aggView1808641732429587803 using(v7);
create or replace view aggView6041237212175924989 as select id as v5 from comp_cast_type as cct1 where kind= 'cast';
create or replace view aggJoin1343557654902595647 as select v40, v52 from aggJoin1094735465250922403 join aggView6041237212175924989 using(v5);
create or replace view aggView7684627316832047112 as select id as v23 from keyword as k where keyword IN ('superhero','sequel','second-part','marvel-comics','based-on-comic','tv-special','fight','violence');
create or replace view aggJoin5560086059403268977 as select movie_id as v40 from movie_keyword as mk, aggView7684627316832047112 where mk.keyword_id=aggView7684627316832047112.v23;
create or replace view aggView8779771774006279960 as select v40 from aggJoin5560086059403268977 group by v40;
create or replace view aggJoin7252533701023652130 as select v40, v52 as v52 from aggJoin1343557654902595647 join aggView8779771774006279960 using(v40);
create or replace view aggView6901546157646664770 as select v40, MIN(v52) as v52 from aggJoin7252533701023652130 group by v40;
create or replace view aggJoin1746077635894374437 as select v9, v52 from aggJoin8034271252507986203 join aggView6901546157646664770 using(v40);
create or replace view aggView4243060988224024127 as select v9, MIN(v52) as v52 from aggJoin1746077635894374437 group by v9;
create or replace view aggJoin3347922308082947808 as select v52 from char_name as chn, aggView4243060988224024127 where chn.id=aggView4243060988224024127.v9 and ((name LIKE '%Tony%Stark%') OR (name LIKE '%Iron%Man%')) and name NOT LIKE '%Sherlock%';
create or replace view res as select MIN(v52) as v52 from aggJoin3347922308082947808;
select sum(v52) from res;