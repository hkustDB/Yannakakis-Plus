create or replace view aggView2607213189372252240 as select id as v9 from char_name as chn where ((name LIKE '%Tony%Stark%') OR (name LIKE '%Iron%Man%')) and name NOT LIKE '%Sherlock%';
create or replace view aggJoin4586104417349266100 as select person_id as v31, movie_id as v40 from cast_info as ci, aggView2607213189372252240 where ci.person_role_id=aggView2607213189372252240.v9;
create or replace view aggView4454936402920453657 as select id as v26 from kind_type as kt where kind= 'movie';
create or replace view aggJoin970743873940638937 as select id as v40, title as v41 from title as t, aggView4454936402920453657 where t.kind_id=aggView4454936402920453657.v26 and production_year>1950;
create or replace view aggView4032587964129500620 as select v40, MIN(v41) as v52 from aggJoin970743873940638937 group by v40;
create or replace view aggJoin6621198694414115191 as select movie_id as v40, keyword_id as v23, v52 from movie_keyword as mk, aggView4032587964129500620 where mk.movie_id=aggView4032587964129500620.v40;
create or replace view aggView3587375804508661030 as select id as v31 from name as n;
create or replace view aggJoin7295362765352816199 as select v40 from aggJoin4586104417349266100 join aggView3587375804508661030 using(v31);
create or replace view aggView3195741322701972455 as select v40 from aggJoin7295362765352816199 group by v40;
create or replace view aggJoin1418314737254144092 as select v40, v23, v52 as v52 from aggJoin6621198694414115191 join aggView3195741322701972455 using(v40);
create or replace view aggView6014323926353027956 as select id as v5 from comp_cast_type as cct1 where kind= 'cast';
create or replace view aggJoin6046557896378009316 as select movie_id as v40, status_id as v7 from complete_cast as cc, aggView6014323926353027956 where cc.subject_id=aggView6014323926353027956.v5;
create or replace view aggView5802243008332996524 as select id as v23 from keyword as k where keyword IN ('superhero','sequel','second-part','marvel-comics','based-on-comic','tv-special','fight','violence');
create or replace view aggJoin2204307725895434495 as select v40, v52 from aggJoin1418314737254144092 join aggView5802243008332996524 using(v23);
create or replace view aggView2111984657842535123 as select v40, MIN(v52) as v52 from aggJoin2204307725895434495 group by v40;
create or replace view aggJoin6191368972515163750 as select v7, v52 from aggJoin6046557896378009316 join aggView2111984657842535123 using(v40);
create or replace view aggView4269585055337873966 as select v7, MIN(v52) as v52 from aggJoin6191368972515163750 group by v7;
create or replace view aggJoin5273600661405476197 as select v52 from comp_cast_type as cct2, aggView4269585055337873966 where cct2.id=aggView4269585055337873966.v7 and kind LIKE '%complete%';
create or replace view res as select MIN(v52) as v52 from aggJoin5273600661405476197;
select sum(v52) from res;