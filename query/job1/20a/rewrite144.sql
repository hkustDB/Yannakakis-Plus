create or replace view aggView6798201915038242053 as select id as v26 from kind_type as kt where kind= 'movie';
create or replace view aggJoin8313977269334210149 as select id as v40, title as v41 from title as t, aggView6798201915038242053 where t.kind_id=aggView6798201915038242053.v26 and production_year>1950;
create or replace view aggView2192841803160005368 as select v40, MIN(v41) as v52 from aggJoin8313977269334210149 group by v40;
create or replace view aggJoin147900500776111022 as select person_id as v31, movie_id as v40, person_role_id as v9, v52 from cast_info as ci, aggView2192841803160005368 where ci.movie_id=aggView2192841803160005368.v40;
create or replace view aggView7500413487248922142 as select id as v9 from char_name as chn where ((name LIKE '%Tony%Stark%') OR (name LIKE '%Iron%Man%')) and name NOT LIKE '%Sherlock%';
create or replace view aggJoin7992731411618832777 as select v31, v40, v52 from aggJoin147900500776111022 join aggView7500413487248922142 using(v9);
create or replace view aggView5417994105190525897 as select id as v31 from name as n;
create or replace view aggJoin6261275185207292813 as select v40, v52 from aggJoin7992731411618832777 join aggView5417994105190525897 using(v31);
create or replace view aggView9058542571804661268 as select id as v7 from comp_cast_type as cct2 where kind LIKE '%complete%';
create or replace view aggJoin3718990392677451172 as select movie_id as v40, subject_id as v5 from complete_cast as cc, aggView9058542571804661268 where cc.status_id=aggView9058542571804661268.v7;
create or replace view aggView8217339202776960670 as select id as v5 from comp_cast_type as cct1 where kind= 'cast';
create or replace view aggJoin4548504864461759993 as select v40 from aggJoin3718990392677451172 join aggView8217339202776960670 using(v5);
create or replace view aggView7914278196093029748 as select id as v23 from keyword as k where keyword IN ('superhero','sequel','second-part','marvel-comics','based-on-comic','tv-special','fight','violence');
create or replace view aggJoin3261487473953870025 as select movie_id as v40 from movie_keyword as mk, aggView7914278196093029748 where mk.keyword_id=aggView7914278196093029748.v23;
create or replace view aggView5487562121646041715 as select v40 from aggJoin3261487473953870025 group by v40;
create or replace view aggJoin2081582370045015923 as select v40 from aggJoin4548504864461759993 join aggView5487562121646041715 using(v40);
create or replace view aggView2101834687029000966 as select v40 from aggJoin2081582370045015923 group by v40;
create or replace view aggJoin1529627801081928807 as select v52 as v52 from aggJoin6261275185207292813 join aggView2101834687029000966 using(v40);
create or replace view res as select MIN(v52) as v52 from aggJoin1529627801081928807;
select sum(v52) from res;