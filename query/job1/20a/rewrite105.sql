create or replace view aggView6307971608499871130 as select id as v23 from keyword as k where keyword IN ('superhero','sequel','second-part','marvel-comics','based-on-comic','tv-special','fight','violence');
create or replace view aggJoin9206603874253584757 as select movie_id as v40 from movie_keyword as mk, aggView6307971608499871130 where mk.keyword_id=aggView6307971608499871130.v23;
create or replace view aggView5616991701869607269 as select id as v5 from comp_cast_type as cct1 where kind= 'cast';
create or replace view aggJoin6359030612353623090 as select movie_id as v40, status_id as v7 from complete_cast as cc, aggView5616991701869607269 where cc.subject_id=aggView5616991701869607269.v5;
create or replace view aggView5760439663670638670 as select id as v31 from name as n;
create or replace view aggJoin7819934633254213612 as select movie_id as v40, person_role_id as v9 from cast_info as ci, aggView5760439663670638670 where ci.person_id=aggView5760439663670638670.v31;
create or replace view aggView7734519954899892078 as select id as v9 from char_name as chn where ((name LIKE '%Tony%Stark%') OR (name LIKE '%Iron%Man%')) and name NOT LIKE '%Sherlock%';
create or replace view aggJoin102590889190698257 as select v40 from aggJoin7819934633254213612 join aggView7734519954899892078 using(v9);
create or replace view aggView6635213008033932015 as select v40 from aggJoin102590889190698257 group by v40;
create or replace view aggJoin4071147742157892391 as select v40, v7 from aggJoin6359030612353623090 join aggView6635213008033932015 using(v40);
create or replace view aggView6747616489823929643 as select id as v26 from kind_type as kt where kind= 'movie';
create or replace view aggJoin1773301782906440179 as select id as v40, title as v41 from title as t, aggView6747616489823929643 where t.kind_id=aggView6747616489823929643.v26 and production_year>1950;
create or replace view aggView8390783002122356771 as select v40, MIN(v41) as v52 from aggJoin1773301782906440179 group by v40;
create or replace view aggJoin939956977675406678 as select v40, v52 from aggJoin9206603874253584757 join aggView8390783002122356771 using(v40);
create or replace view aggView6632566058569365594 as select v40, MIN(v52) as v52 from aggJoin939956977675406678 group by v40;
create or replace view aggJoin8996599504676004050 as select v7, v52 from aggJoin4071147742157892391 join aggView6632566058569365594 using(v40);
create or replace view aggView3448809034570938944 as select v7, MIN(v52) as v52 from aggJoin8996599504676004050 group by v7;
create or replace view aggJoin7378948589612886931 as select v52 from comp_cast_type as cct2, aggView3448809034570938944 where cct2.id=aggView3448809034570938944.v7 and kind LIKE '%complete%';
create or replace view res as select MIN(v52) as v52 from aggJoin7378948589612886931;
select sum(v52) from res;