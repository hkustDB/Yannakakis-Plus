create or replace view aggView7795949404629451031 as select id as v26 from kind_type as kt where kind= 'movie';
create or replace view aggJoin7100937534345915340 as select id as v40, title as v41 from title as t, aggView7795949404629451031 where t.kind_id=aggView7795949404629451031.v26 and production_year>1950;
create or replace view aggView1234811485044832609 as select v40, MIN(v41) as v52 from aggJoin7100937534345915340 group by v40;
create or replace view aggJoin5563527484124009716 as select person_id as v31, movie_id as v40, person_role_id as v9, v52 from cast_info as ci, aggView1234811485044832609 where ci.movie_id=aggView1234811485044832609.v40;
create or replace view aggView9118431826014422534 as select id as v9 from char_name as chn where ((name LIKE '%Tony%Stark%') OR (name LIKE '%Iron%Man%')) and name NOT LIKE '%Sherlock%';
create or replace view aggJoin4105288466404568299 as select v31, v40, v52 from aggJoin5563527484124009716 join aggView9118431826014422534 using(v9);
create or replace view aggView616039780023155877 as select id as v31 from name as n;
create or replace view aggJoin6406618165397339222 as select v40, v52 from aggJoin4105288466404568299 join aggView616039780023155877 using(v31);
create or replace view aggView7301415111812704877 as select id as v7 from comp_cast_type as cct2 where kind LIKE '%complete%';
create or replace view aggJoin7537316485949019989 as select movie_id as v40, subject_id as v5 from complete_cast as cc, aggView7301415111812704877 where cc.status_id=aggView7301415111812704877.v7;
create or replace view aggView4417385415911659031 as select id as v5 from comp_cast_type as cct1 where kind= 'cast';
create or replace view aggJoin677667204578820367 as select v40 from aggJoin7537316485949019989 join aggView4417385415911659031 using(v5);
create or replace view aggView8148229948844893553 as select v40 from aggJoin677667204578820367 group by v40;
create or replace view aggJoin4961873833664709058 as select v40, v52 as v52 from aggJoin6406618165397339222 join aggView8148229948844893553 using(v40);
create or replace view aggView7111665846457585700 as select v40, MIN(v52) as v52 from aggJoin4961873833664709058 group by v40;
create or replace view aggJoin1691993160300494807 as select keyword_id as v23, v52 from movie_keyword as mk, aggView7111665846457585700 where mk.movie_id=aggView7111665846457585700.v40;
create or replace view aggView8573455601981821062 as select id as v23 from keyword as k where keyword IN ('superhero','sequel','second-part','marvel-comics','based-on-comic','tv-special','fight','violence');
create or replace view aggJoin4233659478695742494 as select v52 from aggJoin1691993160300494807 join aggView8573455601981821062 using(v23);
create or replace view res as select MIN(v52) as v52 from aggJoin4233659478695742494;
select sum(v52) from res;