create or replace view aggView508599069462620257 as select id as v9 from char_name as chn where ((name LIKE '%Tony%Stark%') OR (name LIKE '%Iron%Man%')) and name NOT LIKE '%Sherlock%';
create or replace view aggJoin6198748357330147940 as select person_id as v31, movie_id as v40 from cast_info as ci, aggView508599069462620257 where ci.person_role_id=aggView508599069462620257.v9;
create or replace view aggView5709068181044907057 as select id as v26 from kind_type as kt where kind= 'movie';
create or replace view aggJoin412858036453812165 as select id as v40, title as v41 from title as t, aggView5709068181044907057 where t.kind_id=aggView5709068181044907057.v26 and production_year>1950;
create or replace view aggView4191083467219237157 as select v40, MIN(v41) as v52 from aggJoin412858036453812165 group by v40;
create or replace view aggJoin1951389035940499925 as select movie_id as v40, keyword_id as v23, v52 from movie_keyword as mk, aggView4191083467219237157 where mk.movie_id=aggView4191083467219237157.v40;
create or replace view aggView8598693639083987837 as select id as v31 from name as n;
create or replace view aggJoin3515693565768214018 as select v40 from aggJoin6198748357330147940 join aggView8598693639083987837 using(v31);
create or replace view aggView4971029331646852755 as select v40 from aggJoin3515693565768214018 group by v40;
create or replace view aggJoin3287400478519764904 as select v40, v23, v52 as v52 from aggJoin1951389035940499925 join aggView4971029331646852755 using(v40);
create or replace view aggView1068545639711830455 as select id as v7 from comp_cast_type as cct2 where kind LIKE '%complete%';
create or replace view aggJoin1094918853172094134 as select movie_id as v40, subject_id as v5 from complete_cast as cc, aggView1068545639711830455 where cc.status_id=aggView1068545639711830455.v7;
create or replace view aggView3072624705394167689 as select id as v5 from comp_cast_type as cct1 where kind= 'cast';
create or replace view aggJoin2535333660115882112 as select v40 from aggJoin1094918853172094134 join aggView3072624705394167689 using(v5);
create or replace view aggView857200856134027507 as select v40 from aggJoin2535333660115882112 group by v40;
create or replace view aggJoin2980459556576070258 as select v23, v52 as v52 from aggJoin3287400478519764904 join aggView857200856134027507 using(v40);
create or replace view aggView3879089715270554419 as select id as v23 from keyword as k where keyword IN ('superhero','sequel','second-part','marvel-comics','based-on-comic','tv-special','fight','violence');
create or replace view aggJoin2925492237457047084 as select v52 from aggJoin2980459556576070258 join aggView3879089715270554419 using(v23);
create or replace view res as select MIN(v52) as v52 from aggJoin2925492237457047084;
select sum(v52) from res;