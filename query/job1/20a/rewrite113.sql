create or replace view aggView8767641145709692997 as select id as v9 from char_name as chn where ((name LIKE '%Tony%Stark%') OR (name LIKE '%Iron%Man%')) and name NOT LIKE '%Sherlock%';
create or replace view aggJoin615257789631189387 as select person_id as v31, movie_id as v40 from cast_info as ci, aggView8767641145709692997 where ci.person_role_id=aggView8767641145709692997.v9;
create or replace view aggView2433601065695772542 as select id as v26 from kind_type as kt where kind= 'movie';
create or replace view aggJoin2900603103734191151 as select id as v40, title as v41 from title as t, aggView2433601065695772542 where t.kind_id=aggView2433601065695772542.v26 and production_year>1950;
create or replace view aggView725690865627164320 as select v40, MIN(v41) as v52 from aggJoin2900603103734191151 group by v40;
create or replace view aggJoin6637881320210374213 as select movie_id as v40, subject_id as v5, status_id as v7, v52 from complete_cast as cc, aggView725690865627164320 where cc.movie_id=aggView725690865627164320.v40;
create or replace view aggView2299465557600669600 as select id as v31 from name as n;
create or replace view aggJoin3773449825826253062 as select v40 from aggJoin615257789631189387 join aggView2299465557600669600 using(v31);
create or replace view aggView4684122070310254875 as select v40 from aggJoin3773449825826253062 group by v40;
create or replace view aggJoin2402480451490307915 as select movie_id as v40, keyword_id as v23 from movie_keyword as mk, aggView4684122070310254875 where mk.movie_id=aggView4684122070310254875.v40;
create or replace view aggView614763693349420712 as select id as v5 from comp_cast_type as cct1 where kind= 'cast';
create or replace view aggJoin4116181746303488279 as select v40, v7, v52 from aggJoin6637881320210374213 join aggView614763693349420712 using(v5);
create or replace view aggView3023515544413338846 as select id as v23 from keyword as k where keyword IN ('superhero','sequel','second-part','marvel-comics','based-on-comic','tv-special','fight','violence');
create or replace view aggJoin9146092045820472019 as select v40 from aggJoin2402480451490307915 join aggView3023515544413338846 using(v23);
create or replace view aggView4807456548876440057 as select v40 from aggJoin9146092045820472019 group by v40;
create or replace view aggJoin847004538380564212 as select v7, v52 as v52 from aggJoin4116181746303488279 join aggView4807456548876440057 using(v40);
create or replace view aggView2629072455771689603 as select v7, MIN(v52) as v52 from aggJoin847004538380564212 group by v7;
create or replace view aggJoin5383255295834427435 as select v52 from comp_cast_type as cct2, aggView2629072455771689603 where cct2.id=aggView2629072455771689603.v7 and kind LIKE '%complete%';
create or replace view res as select MIN(v52) as v52 from aggJoin5383255295834427435;
select sum(v52) from res;