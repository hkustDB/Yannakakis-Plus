create or replace view aggView4881971970786351382 as select id as v26 from kind_type as kt where kind= 'movie';
create or replace view aggJoin1470382120073029741 as select id as v40, title as v41 from title as t, aggView4881971970786351382 where t.kind_id=aggView4881971970786351382.v26 and production_year>1950;
create or replace view aggView3935732578284193767 as select id as v9 from char_name as chn where ((name LIKE '%Tony%Stark%') OR (name LIKE '%Iron%Man%')) and name NOT LIKE '%Sherlock%';
create or replace view aggJoin937351287269767904 as select person_id as v31, movie_id as v40 from cast_info as ci, aggView3935732578284193767 where ci.person_role_id=aggView3935732578284193767.v9;
create or replace view aggView7672716204495567574 as select id as v31 from name as n;
create or replace view aggJoin5110511668557557380 as select v40 from aggJoin937351287269767904 join aggView7672716204495567574 using(v31);
create or replace view aggView3553168429562557151 as select id as v7 from comp_cast_type as cct2 where kind LIKE '%complete%';
create or replace view aggJoin5634627404888742759 as select movie_id as v40, subject_id as v5 from complete_cast as cc, aggView3553168429562557151 where cc.status_id=aggView3553168429562557151.v7;
create or replace view aggView7494125189996869078 as select id as v5 from comp_cast_type as cct1 where kind= 'cast';
create or replace view aggJoin8800235322772186305 as select v40 from aggJoin5634627404888742759 join aggView7494125189996869078 using(v5);
create or replace view aggView1730862086283528107 as select v40 from aggJoin8800235322772186305 group by v40;
create or replace view aggJoin1844939517737984408 as select v40, v41 from aggJoin1470382120073029741 join aggView1730862086283528107 using(v40);
create or replace view aggView7308116646104277967 as select v40, MIN(v41) as v52 from aggJoin1844939517737984408 group by v40;
create or replace view aggJoin3150010571233441596 as select movie_id as v40, keyword_id as v23, v52 from movie_keyword as mk, aggView7308116646104277967 where mk.movie_id=aggView7308116646104277967.v40;
create or replace view aggView4000845984759524385 as select id as v23 from keyword as k where keyword IN ('superhero','sequel','second-part','marvel-comics','based-on-comic','tv-special','fight','violence');
create or replace view aggJoin7479660809512370175 as select v40, v52 from aggJoin3150010571233441596 join aggView4000845984759524385 using(v23);
create or replace view aggView8262731669588686108 as select v40, MIN(v52) as v52 from aggJoin7479660809512370175 group by v40;
create or replace view aggJoin1099488983273540094 as select v52 from aggJoin5110511668557557380 join aggView8262731669588686108 using(v40);
create or replace view res as select MIN(v52) as v52 from aggJoin1099488983273540094;
select sum(v52) from res;