create or replace view aggView8032575534016252266 as select id as v9 from char_name as chn where ((name LIKE '%Tony%Stark%') OR (name LIKE '%Iron%Man%')) and name NOT LIKE '%Sherlock%';
create or replace view aggJoin8840608496147428197 as select person_id as v31, movie_id as v40 from cast_info as ci, aggView8032575534016252266 where ci.person_role_id=aggView8032575534016252266.v9;
create or replace view aggView2532950944319194547 as select id as v26 from kind_type as kt where kind= 'movie';
create or replace view aggJoin1844606331125371671 as select id as v40, title as v41 from title as t, aggView2532950944319194547 where t.kind_id=aggView2532950944319194547.v26 and production_year>1950;
create or replace view aggView2091215850501301092 as select id as v31 from name as n;
create or replace view aggJoin9111426001737491147 as select v40 from aggJoin8840608496147428197 join aggView2091215850501301092 using(v31);
create or replace view aggView837146309986494244 as select id as v7 from comp_cast_type as cct2 where kind LIKE '%complete%';
create or replace view aggJoin2011782547310163726 as select movie_id as v40, subject_id as v5 from complete_cast as cc, aggView837146309986494244 where cc.status_id=aggView837146309986494244.v7;
create or replace view aggView7099761108805392269 as select id as v5 from comp_cast_type as cct1 where kind= 'cast';
create or replace view aggJoin3438725174191173687 as select v40 from aggJoin2011782547310163726 join aggView7099761108805392269 using(v5);
create or replace view aggView5301558983460458538 as select v40 from aggJoin3438725174191173687 group by v40;
create or replace view aggJoin2258661528869648425 as select v40 from aggJoin9111426001737491147 join aggView5301558983460458538 using(v40);
create or replace view aggView9160038713203096411 as select v40 from aggJoin2258661528869648425 group by v40;
create or replace view aggJoin7500935666462304777 as select v40, v41 from aggJoin1844606331125371671 join aggView9160038713203096411 using(v40);
create or replace view aggView7834813033673977035 as select v40, MIN(v41) as v52 from aggJoin7500935666462304777 group by v40;
create or replace view aggJoin3966822195079998488 as select keyword_id as v23, v52 from movie_keyword as mk, aggView7834813033673977035 where mk.movie_id=aggView7834813033673977035.v40;
create or replace view aggView2947411431979204535 as select id as v23 from keyword as k where keyword IN ('superhero','sequel','second-part','marvel-comics','based-on-comic','tv-special','fight','violence');
create or replace view aggJoin895531571955184967 as select v52 from aggJoin3966822195079998488 join aggView2947411431979204535 using(v23);
create or replace view res as select MIN(v52) as v52 from aggJoin895531571955184967;
select sum(v52) from res;