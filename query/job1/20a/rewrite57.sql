create or replace view aggView853926252801240324 as select id as v9 from char_name as chn where ((name LIKE '%Tony%Stark%') OR (name LIKE '%Iron%Man%')) and name NOT LIKE '%Sherlock%';
create or replace view aggJoin530032941661500132 as select person_id as v31, movie_id as v40 from cast_info as ci, aggView853926252801240324 where ci.person_role_id=aggView853926252801240324.v9;
create or replace view aggView34018732517379388 as select id as v31 from name as n;
create or replace view aggJoin3006475180018226840 as select v40 from aggJoin530032941661500132 join aggView34018732517379388 using(v31);
create or replace view aggView1369760061642334218 as select id as v7 from comp_cast_type as cct2 where kind LIKE '%complete%';
create or replace view aggJoin579498947854479068 as select movie_id as v40, subject_id as v5 from complete_cast as cc, aggView1369760061642334218 where cc.status_id=aggView1369760061642334218.v7;
create or replace view aggView313875445738193532 as select id as v5 from comp_cast_type as cct1 where kind= 'cast';
create or replace view aggJoin4982209581899728801 as select v40 from aggJoin579498947854479068 join aggView313875445738193532 using(v5);
create or replace view aggView7177653528755468680 as select v40 from aggJoin4982209581899728801 group by v40;
create or replace view aggJoin823328906045138893 as select v40 from aggJoin3006475180018226840 join aggView7177653528755468680 using(v40);
create or replace view aggView4906073246990998156 as select v40 from aggJoin823328906045138893 group by v40;
create or replace view aggJoin2524549410781515213 as select movie_id as v40, keyword_id as v23 from movie_keyword as mk, aggView4906073246990998156 where mk.movie_id=aggView4906073246990998156.v40;
create or replace view aggView7590967298709434457 as select id as v23 from keyword as k where keyword IN ('superhero','sequel','second-part','marvel-comics','based-on-comic','tv-special','fight','violence');
create or replace view aggJoin5333153303750729902 as select v40 from aggJoin2524549410781515213 join aggView7590967298709434457 using(v23);
create or replace view aggView8391554675640923113 as select v40 from aggJoin5333153303750729902 group by v40;
create or replace view aggJoin9165946013028615800 as select title as v41, kind_id as v26 from title as t, aggView8391554675640923113 where t.id=aggView8391554675640923113.v40 and production_year>1950;
create or replace view aggView8452682927607706010 as select v26, MIN(v41) as v52 from aggJoin9165946013028615800 group by v26;
create or replace view aggJoin9200663942420603460 as select v52 from kind_type as kt, aggView8452682927607706010 where kt.id=aggView8452682927607706010.v26 and kind= 'movie';
create or replace view res as select MIN(v52) as v52 from aggJoin9200663942420603460;
select sum(v52) from res;