create or replace view aggView8009414193232595389 as select id as v5 from comp_cast_type as cct1 where kind= 'cast';
create or replace view aggJoin961916259932018833 as select movie_id as v40, status_id as v7 from complete_cast as cc, aggView8009414193232595389 where cc.subject_id=aggView8009414193232595389.v5;
create or replace view aggView8045865602875484794 as select id as v31 from name as n;
create or replace view aggJoin1482875317090924702 as select movie_id as v40, person_role_id as v9 from cast_info as ci, aggView8045865602875484794 where ci.person_id=aggView8045865602875484794.v31;
create or replace view aggView8297455259228796397 as select id as v7 from comp_cast_type as cct2 where kind LIKE '%complete%';
create or replace view aggJoin2211134080241368908 as select v40 from aggJoin961916259932018833 join aggView8297455259228796397 using(v7);
create or replace view aggView6178841091160332538 as select id as v26 from kind_type as kt where kind= 'movie';
create or replace view aggJoin4539192932376714949 as select id as v40, title as v41 from title as t, aggView6178841091160332538 where t.kind_id=aggView6178841091160332538.v26 and production_year>1950;
create or replace view aggView8154425593061839002 as select id as v23 from keyword as k where keyword IN ('superhero','sequel','second-part','marvel-comics','based-on-comic','tv-special','fight','violence');
create or replace view aggJoin4042971792787841857 as select movie_id as v40 from movie_keyword as mk, aggView8154425593061839002 where mk.keyword_id=aggView8154425593061839002.v23;
create or replace view aggView1366673709110635578 as select v40 from aggJoin4042971792787841857 group by v40;
create or replace view aggJoin2990445594154373464 as select v40 from aggJoin2211134080241368908 join aggView1366673709110635578 using(v40);
create or replace view aggView8626595562578371641 as select v40 from aggJoin2990445594154373464 group by v40;
create or replace view aggJoin2927177872640976247 as select v40, v41 from aggJoin4539192932376714949 join aggView8626595562578371641 using(v40);
create or replace view aggView7588736143165867537 as select v40, MIN(v41) as v52 from aggJoin2927177872640976247 group by v40;
create or replace view aggJoin8092178103201770347 as select v9, v52 from aggJoin1482875317090924702 join aggView7588736143165867537 using(v40);
create or replace view aggView2258015275405597681 as select v9, MIN(v52) as v52 from aggJoin8092178103201770347 group by v9;
create or replace view aggJoin6961710510202143186 as select v52 from char_name as chn, aggView2258015275405597681 where chn.id=aggView2258015275405597681.v9 and ((name LIKE '%Tony%Stark%') OR (name LIKE '%Iron%Man%')) and name NOT LIKE '%Sherlock%';
select MIN(v52) as v52 from aggJoin6961710510202143186;
