create or replace view aggView6232330105178403617 as select id as v26 from kind_type as kt where kind= 'movie';
create or replace view aggJoin7244694355406640437 as select id as v40, title as v41 from title as t, aggView6232330105178403617 where t.kind_id=aggView6232330105178403617.v26 and production_year>1950;
create or replace view aggView6850167063081226607 as select v40, MIN(v41) as v52 from aggJoin7244694355406640437 group by v40;
create or replace view aggJoin5530876346003466826 as select person_id as v31, movie_id as v40, person_role_id as v9, v52 from cast_info as ci, aggView6850167063081226607 where ci.movie_id=aggView6850167063081226607.v40;
create or replace view aggView1509238970089734366 as select id as v31 from name as n;
create or replace view aggJoin4546576275860604899 as select v40, v9, v52 from aggJoin5530876346003466826 join aggView1509238970089734366 using(v31);
create or replace view aggView6985477046582628528 as select id as v7 from comp_cast_type as cct2 where kind LIKE '%complete%';
create or replace view aggJoin9152027349359535846 as select movie_id as v40, subject_id as v5 from complete_cast as cc, aggView6985477046582628528 where cc.status_id=aggView6985477046582628528.v7;
create or replace view aggView4803937501265802675 as select id as v5 from comp_cast_type as cct1 where kind= 'cast';
create or replace view aggJoin5699404649404538622 as select v40 from aggJoin9152027349359535846 join aggView4803937501265802675 using(v5);
create or replace view aggView7843684350560723848 as select v40 from aggJoin5699404649404538622 group by v40;
create or replace view aggJoin7927358633931983555 as select v40, v9, v52 as v52 from aggJoin4546576275860604899 join aggView7843684350560723848 using(v40);
create or replace view aggView5654226959600826096 as select id as v23 from keyword as k where keyword IN ('superhero','sequel','second-part','marvel-comics','based-on-comic','tv-special','fight','violence');
create or replace view aggJoin4199407998284327768 as select movie_id as v40 from movie_keyword as mk, aggView5654226959600826096 where mk.keyword_id=aggView5654226959600826096.v23;
create or replace view aggView5599262106920511174 as select v40 from aggJoin4199407998284327768 group by v40;
create or replace view aggJoin6730115273208052975 as select v9, v52 as v52 from aggJoin7927358633931983555 join aggView5599262106920511174 using(v40);
create or replace view aggView2708362347458644870 as select v9, MIN(v52) as v52 from aggJoin6730115273208052975 group by v9;
create or replace view aggJoin2142114357825829932 as select v52 from char_name as chn, aggView2708362347458644870 where chn.id=aggView2708362347458644870.v9 and ((name LIKE '%Tony%Stark%') OR (name LIKE '%Iron%Man%')) and name NOT LIKE '%Sherlock%';
create or replace view res as select MIN(v52) as v52 from aggJoin2142114357825829932;
select sum(v52) from res;