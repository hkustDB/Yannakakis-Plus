create or replace view aggView4722743378387129983 as select id as v5 from comp_cast_type as cct1 where kind= 'cast';
create or replace view aggJoin236503071955303603 as select movie_id as v40, status_id as v7 from complete_cast as cc, aggView4722743378387129983 where cc.subject_id=aggView4722743378387129983.v5;
create or replace view aggView5510501933985037636 as select id as v31 from name as n;
create or replace view aggJoin1216096547063063078 as select movie_id as v40, person_role_id as v9 from cast_info as ci, aggView5510501933985037636 where ci.person_id=aggView5510501933985037636.v31;
create or replace view aggView3819367466817026476 as select id as v7 from comp_cast_type as cct2 where kind LIKE '%complete%';
create or replace view aggJoin4890261425118734082 as select v40 from aggJoin236503071955303603 join aggView3819367466817026476 using(v7);
create or replace view aggView5255588415341948446 as select id as v26 from kind_type as kt where kind= 'movie';
create or replace view aggJoin1143684018857995125 as select id as v40, title as v41 from title as t, aggView5255588415341948446 where t.kind_id=aggView5255588415341948446.v26 and production_year>1950;
create or replace view aggView870373382752468143 as select v40, MIN(v41) as v52 from aggJoin1143684018857995125 group by v40;
create or replace view aggJoin6356115590475181359 as select v40, v52 from aggJoin4890261425118734082 join aggView870373382752468143 using(v40);
create or replace view aggView3213334155859244287 as select id as v9 from char_name as chn where ((name LIKE '%Tony%Stark%') OR (name LIKE '%Iron%Man%')) and name NOT LIKE '%Sherlock%';
create or replace view aggJoin8826947396849150752 as select v40 from aggJoin1216096547063063078 join aggView3213334155859244287 using(v9);
create or replace view aggView4370924771967302014 as select id as v23 from keyword as k where keyword IN ('superhero','sequel','second-part','marvel-comics','based-on-comic','tv-special','fight','violence');
create or replace view aggJoin7437654527041317212 as select movie_id as v40 from movie_keyword as mk, aggView4370924771967302014 where mk.keyword_id=aggView4370924771967302014.v23;
create or replace view aggView2579449019477600593 as select v40 from aggJoin7437654527041317212 group by v40;
create or replace view aggJoin1503141152093579667 as select v40, v52 as v52 from aggJoin6356115590475181359 join aggView2579449019477600593 using(v40);
create or replace view aggView4321563548398522101 as select v40, MIN(v52) as v52 from aggJoin1503141152093579667 group by v40;
create or replace view aggJoin3093485686021753102 as select v52 from aggJoin8826947396849150752 join aggView4321563548398522101 using(v40);
select MIN(v52) as v52 from aggJoin3093485686021753102;
