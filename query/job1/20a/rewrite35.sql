create or replace view aggView8503854874561624748 as select id as v9 from char_name as chn where ((name LIKE '%Tony%Stark%') OR (name LIKE '%Iron%Man%')) and name NOT LIKE '%Sherlock%';
create or replace view aggJoin3319366267053230998 as select person_id as v31, movie_id as v40 from cast_info as ci, aggView8503854874561624748 where ci.person_role_id=aggView8503854874561624748.v9;
create or replace view aggView2692761403069257069 as select id as v31 from name as n;
create or replace view aggJoin2697749194750340520 as select v40 from aggJoin3319366267053230998 join aggView2692761403069257069 using(v31);
create or replace view aggView4936919699240725107 as select v40 from aggJoin2697749194750340520 group by v40;
create or replace view aggJoin8312379200647884615 as select movie_id as v40, subject_id as v5, status_id as v7 from complete_cast as cc, aggView4936919699240725107 where cc.movie_id=aggView4936919699240725107.v40;
create or replace view aggView4130581191794080791 as select id as v7 from comp_cast_type as cct2 where kind LIKE '%complete%';
create or replace view aggJoin7219184725528132930 as select v40, v5 from aggJoin8312379200647884615 join aggView4130581191794080791 using(v7);
create or replace view aggView7398381042738939559 as select id as v5 from comp_cast_type as cct1 where kind= 'cast';
create or replace view aggJoin4516943519515707920 as select v40 from aggJoin7219184725528132930 join aggView7398381042738939559 using(v5);
create or replace view aggView977499913510332693 as select v40 from aggJoin4516943519515707920 group by v40;
create or replace view aggJoin8636381037235136286 as select movie_id as v40, keyword_id as v23 from movie_keyword as mk, aggView977499913510332693 where mk.movie_id=aggView977499913510332693.v40;
create or replace view aggView1892716132449468735 as select id as v23 from keyword as k where keyword IN ('superhero','sequel','second-part','marvel-comics','based-on-comic','tv-special','fight','violence');
create or replace view aggJoin539826337074132918 as select v40 from aggJoin8636381037235136286 join aggView1892716132449468735 using(v23);
create or replace view aggView4469551640232216523 as select v40 from aggJoin539826337074132918 group by v40;
create or replace view aggJoin424136747307964019 as select title as v41, kind_id as v26 from title as t, aggView4469551640232216523 where t.id=aggView4469551640232216523.v40 and production_year>1950;
create or replace view aggView571894164427418665 as select v26, MIN(v41) as v52 from aggJoin424136747307964019 group by v26;
create or replace view aggJoin150028798328103183 as select v52 from kind_type as kt, aggView571894164427418665 where kt.id=aggView571894164427418665.v26 and kind= 'movie';
create or replace view res as select MIN(v52) as v52 from aggJoin150028798328103183;
select sum(v52) from res;