create or replace view aggView4984759999528595731 as select id as v23 from keyword as k where keyword IN ('superhero','sequel','second-part','marvel-comics','based-on-comic','tv-special','fight','violence');
create or replace view aggJoin84938931320152763 as select movie_id as v40 from movie_keyword as mk, aggView4984759999528595731 where mk.keyword_id=aggView4984759999528595731.v23;
create or replace view aggView2627420011463561144 as select id as v5 from comp_cast_type as cct1 where kind= 'cast';
create or replace view aggJoin759136322428004645 as select movie_id as v40, status_id as v7 from complete_cast as cc, aggView2627420011463561144 where cc.subject_id=aggView2627420011463561144.v5;
create or replace view aggView4975234971379156376 as select v40 from aggJoin84938931320152763 group by v40;
create or replace view aggJoin5173729979824204498 as select id as v40, title as v41, kind_id as v26 from title as t, aggView4975234971379156376 where t.id=aggView4975234971379156376.v40 and production_year>1950;
create or replace view aggView5609835227545235258 as select id as v7 from comp_cast_type as cct2 where kind LIKE '%complete%';
create or replace view aggJoin5865537256131518986 as select v40 from aggJoin759136322428004645 join aggView5609835227545235258 using(v7);
create or replace view aggView1463941429511029235 as select v40 from aggJoin5865537256131518986 group by v40;
create or replace view aggJoin2037312789633002133 as select person_id as v31, movie_id as v40, person_role_id as v9 from cast_info as ci, aggView1463941429511029235 where ci.movie_id=aggView1463941429511029235.v40;
create or replace view aggView2934888924357895450 as select id as v31 from name as n;
create or replace view aggJoin897793714504155885 as select v40, v9 from aggJoin2037312789633002133 join aggView2934888924357895450 using(v31);
create or replace view aggView733438496682432242 as select id as v26 from kind_type as kt where kind= 'movie';
create or replace view aggJoin6457741203704909082 as select v40, v41 from aggJoin5173729979824204498 join aggView733438496682432242 using(v26);
create or replace view aggView6309016386459810117 as select v40, MIN(v41) as v52 from aggJoin6457741203704909082 group by v40;
create or replace view aggJoin749276793685447920 as select v9, v52 from aggJoin897793714504155885 join aggView6309016386459810117 using(v40);
create or replace view aggView201647058244760046 as select v9, MIN(v52) as v52 from aggJoin749276793685447920 group by v9;
create or replace view aggJoin5201653599453527683 as select v52 from char_name as chn, aggView201647058244760046 where chn.id=aggView201647058244760046.v9 and ((name LIKE '%Tony%Stark%') OR (name LIKE '%Iron%Man%')) and name NOT LIKE '%Sherlock%';
create or replace view res as select MIN(v52) as v52 from aggJoin5201653599453527683;
select sum(v52) from res;