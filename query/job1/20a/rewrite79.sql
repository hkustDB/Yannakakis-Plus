create or replace view aggView7387936509712231400 as select id as v5 from comp_cast_type as cct1 where kind= 'cast';
create or replace view aggJoin2600414713274538795 as select movie_id as v40, status_id as v7 from complete_cast as cc, aggView7387936509712231400 where cc.subject_id=aggView7387936509712231400.v5;
create or replace view aggView2910667395287538084 as select id as v31 from name as n;
create or replace view aggJoin2395799920275385063 as select movie_id as v40, person_role_id as v9 from cast_info as ci, aggView2910667395287538084 where ci.person_id=aggView2910667395287538084.v31;
create or replace view aggView6913262279592554497 as select id as v7 from comp_cast_type as cct2 where kind LIKE '%complete%';
create or replace view aggJoin6486662780249500234 as select v40 from aggJoin2600414713274538795 join aggView6913262279592554497 using(v7);
create or replace view aggView2182249568357282145 as select id as v26 from kind_type as kt where kind= 'movie';
create or replace view aggJoin2133371794154541235 as select id as v40, title as v41 from title as t, aggView2182249568357282145 where t.kind_id=aggView2182249568357282145.v26 and production_year>1950;
create or replace view aggView7744617238784075643 as select id as v9 from char_name as chn where ((name LIKE '%Tony%Stark%') OR (name LIKE '%Iron%Man%')) and name NOT LIKE '%Sherlock%';
create or replace view aggJoin5117097655953449890 as select v40 from aggJoin2395799920275385063 join aggView7744617238784075643 using(v9);
create or replace view aggView7737864794547811105 as select v40 from aggJoin5117097655953449890 group by v40;
create or replace view aggJoin937965773782022610 as select movie_id as v40, keyword_id as v23 from movie_keyword as mk, aggView7737864794547811105 where mk.movie_id=aggView7737864794547811105.v40;
create or replace view aggView6235144100594584360 as select id as v23 from keyword as k where keyword IN ('superhero','sequel','second-part','marvel-comics','based-on-comic','tv-special','fight','violence');
create or replace view aggJoin6105737703804094484 as select v40 from aggJoin937965773782022610 join aggView6235144100594584360 using(v23);
create or replace view aggView5208212321802175437 as select v40 from aggJoin6105737703804094484 group by v40;
create or replace view aggJoin7787359089570431559 as select v40 from aggJoin6486662780249500234 join aggView5208212321802175437 using(v40);
create or replace view aggView3497574861928136569 as select v40 from aggJoin7787359089570431559 group by v40;
create or replace view aggJoin3386230576131683073 as select v41 from aggJoin2133371794154541235 join aggView3497574861928136569 using(v40);
select MIN(v41) as v52 from aggJoin3386230576131683073;
