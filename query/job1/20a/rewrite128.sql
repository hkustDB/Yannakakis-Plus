create or replace view aggView4343097924582005559 as select id as v9 from char_name as chn where ((name LIKE '%Tony%Stark%') OR (name LIKE '%Iron%Man%')) and name NOT LIKE '%Sherlock%';
create or replace view aggJoin4090212547052440383 as select person_id as v31, movie_id as v40 from cast_info as ci, aggView4343097924582005559 where ci.person_role_id=aggView4343097924582005559.v9;
create or replace view aggView8937194176249812283 as select id as v26 from kind_type as kt where kind= 'movie';
create or replace view aggJoin1141869950123878590 as select id as v40, title as v41 from title as t, aggView8937194176249812283 where t.kind_id=aggView8937194176249812283.v26 and production_year>1950;
create or replace view aggView1668792766839729390 as select id as v31 from name as n;
create or replace view aggJoin3285678242644647880 as select v40 from aggJoin4090212547052440383 join aggView1668792766839729390 using(v31);
create or replace view aggView2154245715682540507 as select id as v7 from comp_cast_type as cct2 where kind LIKE '%complete%';
create or replace view aggJoin306719425761873209 as select movie_id as v40, subject_id as v5 from complete_cast as cc, aggView2154245715682540507 where cc.status_id=aggView2154245715682540507.v7;
create or replace view aggView4356333245739379452 as select id as v5 from comp_cast_type as cct1 where kind= 'cast';
create or replace view aggJoin1420129835811203437 as select v40 from aggJoin306719425761873209 join aggView4356333245739379452 using(v5);
create or replace view aggView2191397991440674820 as select v40 from aggJoin1420129835811203437 group by v40;
create or replace view aggJoin5019708455069384950 as select v40 from aggJoin3285678242644647880 join aggView2191397991440674820 using(v40);
create or replace view aggView6756128713393638909 as select id as v23 from keyword as k where keyword IN ('superhero','sequel','second-part','marvel-comics','based-on-comic','tv-special','fight','violence');
create or replace view aggJoin3809617590357730059 as select movie_id as v40 from movie_keyword as mk, aggView6756128713393638909 where mk.keyword_id=aggView6756128713393638909.v23;
create or replace view aggView603586242792202129 as select v40 from aggJoin3809617590357730059 group by v40;
create or replace view aggJoin4428812970172186818 as select v40 from aggJoin5019708455069384950 join aggView603586242792202129 using(v40);
create or replace view aggView1130033573099435861 as select v40 from aggJoin4428812970172186818 group by v40;
create or replace view aggJoin6746855300173811698 as select v41 from aggJoin1141869950123878590 join aggView1130033573099435861 using(v40);
create or replace view res as select MIN(v41) as v52 from aggJoin6746855300173811698;
select sum(v52) from res;