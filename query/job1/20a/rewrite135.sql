create or replace view aggView5727983900371891105 as select id as v9 from char_name as chn where ((name LIKE '%Tony%Stark%') OR (name LIKE '%Iron%Man%')) and name NOT LIKE '%Sherlock%';
create or replace view aggJoin6851224763034913391 as select person_id as v31, movie_id as v40 from cast_info as ci, aggView5727983900371891105 where ci.person_role_id=aggView5727983900371891105.v9;
create or replace view aggView775264421020473014 as select id as v26 from kind_type as kt where kind= 'movie';
create or replace view aggJoin339078190037045409 as select id as v40, title as v41 from title as t, aggView775264421020473014 where t.kind_id=aggView775264421020473014.v26 and production_year>1950;
create or replace view aggView2516375907041786818 as select id as v31 from name as n;
create or replace view aggJoin6601705168859293308 as select v40 from aggJoin6851224763034913391 join aggView2516375907041786818 using(v31);
create or replace view aggView6217035699476331746 as select v40 from aggJoin6601705168859293308 group by v40;
create or replace view aggJoin253288113669673482 as select v40, v41 from aggJoin339078190037045409 join aggView6217035699476331746 using(v40);
create or replace view aggView8920809614418363479 as select id as v7 from comp_cast_type as cct2 where kind LIKE '%complete%';
create or replace view aggJoin4576703336348335040 as select movie_id as v40, subject_id as v5 from complete_cast as cc, aggView8920809614418363479 where cc.status_id=aggView8920809614418363479.v7;
create or replace view aggView6684307966879366751 as select id as v5 from comp_cast_type as cct1 where kind= 'cast';
create or replace view aggJoin6011541948549072894 as select v40 from aggJoin4576703336348335040 join aggView6684307966879366751 using(v5);
create or replace view aggView7474805358074031112 as select v40 from aggJoin6011541948549072894 group by v40;
create or replace view aggJoin8802632126845199950 as select v40, v41 from aggJoin253288113669673482 join aggView7474805358074031112 using(v40);
create or replace view aggView268404456775301326 as select id as v23 from keyword as k where keyword IN ('superhero','sequel','second-part','marvel-comics','based-on-comic','tv-special','fight','violence');
create or replace view aggJoin1746450396646562141 as select movie_id as v40 from movie_keyword as mk, aggView268404456775301326 where mk.keyword_id=aggView268404456775301326.v23;
create or replace view aggView4033286044809449450 as select v40 from aggJoin1746450396646562141 group by v40;
create or replace view aggJoin7839984204818052558 as select v41 from aggJoin8802632126845199950 join aggView4033286044809449450 using(v40);
create or replace view res as select MIN(v41) as v52 from aggJoin7839984204818052558;
select sum(v52) from res;