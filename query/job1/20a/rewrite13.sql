create or replace view aggView7239595413074031716 as select id as v31 from name as n;
create or replace view aggJoin5009131065749416108 as select movie_id as v40, person_role_id as v9 from cast_info as ci, aggView7239595413074031716 where ci.person_id=aggView7239595413074031716.v31;
create or replace view aggView3642806065420397789 as select id as v5 from comp_cast_type as cct1 where kind= 'cast';
create or replace view aggJoin8172833836061635475 as select movie_id as v40, status_id as v7 from complete_cast as cc, aggView3642806065420397789 where cc.subject_id=aggView3642806065420397789.v5;
create or replace view aggView8322515641268034430 as select id as v7 from comp_cast_type as cct2 where kind LIKE '%complete%';
create or replace view aggJoin7355588126624585250 as select v40 from aggJoin8172833836061635475 join aggView8322515641268034430 using(v7);
create or replace view aggView5938809212845170824 as select id as v23 from keyword as k where keyword IN ('superhero','sequel','second-part','marvel-comics','based-on-comic','tv-special','fight','violence');
create or replace view aggJoin4848334844560418820 as select movie_id as v40 from movie_keyword as mk, aggView5938809212845170824 where mk.keyword_id=aggView5938809212845170824.v23;
create or replace view aggView474422040585605136 as select v40 from aggJoin4848334844560418820 group by v40;
create or replace view aggJoin3145196046557991144 as select v40 from aggJoin7355588126624585250 join aggView474422040585605136 using(v40);
create or replace view aggView8251477584828259094 as select v40 from aggJoin3145196046557991144 group by v40;
create or replace view aggJoin5057108588155227289 as select id as v40, title as v41, kind_id as v26, production_year as v44 from title as t, aggView8251477584828259094 where t.id=aggView8251477584828259094.v40 and production_year>1950;
create or replace view aggView7704688017452211961 as select id as v9 from char_name as chn where ((name LIKE '%Tony%Stark%') OR (name LIKE '%Iron%Man%')) and name NOT LIKE '%Sherlock%';
create or replace view aggJoin2089088966401007569 as select v40 from aggJoin5009131065749416108 join aggView7704688017452211961 using(v9);
create or replace view aggView3999696429893592088 as select id as v26 from kind_type as kt where kind= 'movie';
create or replace view aggJoin6193656994245603824 as select v40, v41, v44 from aggJoin5057108588155227289 join aggView3999696429893592088 using(v26);
create or replace view aggView3373804202277640424 as select v40, MIN(v41) as v52 from aggJoin6193656994245603824 group by v40;
create or replace view aggJoin7811358329963151347 as select v52 from aggJoin2089088966401007569 join aggView3373804202277640424 using(v40);
select MIN(v52) as v52 from aggJoin7811358329963151347;
