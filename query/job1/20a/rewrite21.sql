create or replace view aggView7697578172315179551 as select id as v9 from char_name as chn where ((name LIKE '%Tony%Stark%') OR (name LIKE '%Iron%Man%')) and name NOT LIKE '%Sherlock%';
create or replace view aggJoin240317933997600458 as select person_id as v31, movie_id as v40 from cast_info as ci, aggView7697578172315179551 where ci.person_role_id=aggView7697578172315179551.v9;
create or replace view aggView5626699119669130475 as select id as v26 from kind_type as kt where kind= 'movie';
create or replace view aggJoin3203724690224397588 as select id as v40, title as v41 from title as t, aggView5626699119669130475 where t.kind_id=aggView5626699119669130475.v26 and production_year>1950;
create or replace view aggView931356340426401611 as select id as v31 from name as n;
create or replace view aggJoin428327223068108498 as select v40 from aggJoin240317933997600458 join aggView931356340426401611 using(v31);
create or replace view aggView8373087723458407681 as select v40 from aggJoin428327223068108498 group by v40;
create or replace view aggJoin6546469411553519388 as select movie_id as v40, keyword_id as v23 from movie_keyword as mk, aggView8373087723458407681 where mk.movie_id=aggView8373087723458407681.v40;
create or replace view aggView1576224424514655073 as select id as v7 from comp_cast_type as cct2 where kind LIKE '%complete%';
create or replace view aggJoin3642090900259407938 as select movie_id as v40, subject_id as v5 from complete_cast as cc, aggView1576224424514655073 where cc.status_id=aggView1576224424514655073.v7;
create or replace view aggView776056349310533125 as select id as v5 from comp_cast_type as cct1 where kind= 'cast';
create or replace view aggJoin815257785320778463 as select v40 from aggJoin3642090900259407938 join aggView776056349310533125 using(v5);
create or replace view aggView4293951950712470730 as select v40 from aggJoin815257785320778463 group by v40;
create or replace view aggJoin2011160751712494950 as select v40, v41 from aggJoin3203724690224397588 join aggView4293951950712470730 using(v40);
create or replace view aggView4610174435322104491 as select id as v23 from keyword as k where keyword IN ('superhero','sequel','second-part','marvel-comics','based-on-comic','tv-special','fight','violence');
create or replace view aggJoin4371884783673618469 as select v40 from aggJoin6546469411553519388 join aggView4610174435322104491 using(v23);
create or replace view aggView822720131704146688 as select v40 from aggJoin4371884783673618469 group by v40;
create or replace view aggJoin7277970448652666329 as select v41 from aggJoin2011160751712494950 join aggView822720131704146688 using(v40);
create or replace view res as select MIN(v41) as v52 from aggJoin7277970448652666329;
select sum(v52) from res;