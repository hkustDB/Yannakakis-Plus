create or replace view aggView1721207522895146864 as select id as v5 from comp_cast_type as cct1 where kind= 'cast';
create or replace view aggJoin5707860556051365338 as select movie_id as v40, status_id as v7 from complete_cast as cc, aggView1721207522895146864 where cc.subject_id=aggView1721207522895146864.v5;
create or replace view aggView8532851067110371256 as select id as v31 from name as n;
create or replace view aggJoin367239658027907270 as select movie_id as v40, person_role_id as v9 from cast_info as ci, aggView8532851067110371256 where ci.person_id=aggView8532851067110371256.v31;
create or replace view aggView3002912669105553452 as select id as v7 from comp_cast_type as cct2 where kind LIKE '%complete%';
create or replace view aggJoin7917976497086762314 as select v40 from aggJoin5707860556051365338 join aggView3002912669105553452 using(v7);
create or replace view aggView8866931810891462079 as select id as v26 from kind_type as kt where kind= 'movie';
create or replace view aggJoin592890925001161794 as select id as v40, title as v41 from title as t, aggView8866931810891462079 where t.kind_id=aggView8866931810891462079.v26 and production_year>1950;
create or replace view aggView5435993288227639597 as select id as v23 from keyword as k where keyword IN ('superhero','sequel','second-part','marvel-comics','based-on-comic','tv-special','fight','violence');
create or replace view aggJoin6387101528004763629 as select movie_id as v40 from movie_keyword as mk, aggView5435993288227639597 where mk.keyword_id=aggView5435993288227639597.v23;
create or replace view aggView6967259335617328819 as select v40 from aggJoin6387101528004763629 group by v40;
create or replace view aggJoin1502764382361817167 as select v40, v41 from aggJoin592890925001161794 join aggView6967259335617328819 using(v40);
create or replace view aggView6720819761807631114 as select v40, MIN(v41) as v52 from aggJoin1502764382361817167 group by v40;
create or replace view aggJoin4492237202514741436 as select v40, v52 from aggJoin7917976497086762314 join aggView6720819761807631114 using(v40);
create or replace view aggView3446191065992247271 as select v40, MIN(v52) as v52 from aggJoin4492237202514741436 group by v40;
create or replace view aggJoin4937537686545716315 as select v9, v52 from aggJoin367239658027907270 join aggView3446191065992247271 using(v40);
create or replace view aggView7406895012556351762 as select v9, MIN(v52) as v52 from aggJoin4937537686545716315 group by v9;
create or replace view aggJoin2228381392003609835 as select v52 from char_name as chn, aggView7406895012556351762 where chn.id=aggView7406895012556351762.v9 and ((name LIKE '%Tony%Stark%') OR (name LIKE '%Iron%Man%')) and name NOT LIKE '%Sherlock%';
select MIN(v52) as v52 from aggJoin2228381392003609835;
