create or replace view aggView1788449528789213244 as select id as v9 from char_name as chn where ((name LIKE '%Tony%Stark%') OR (name LIKE '%Iron%Man%')) and name NOT LIKE '%Sherlock%';
create or replace view aggJoin1048968288948784268 as select person_id as v31, movie_id as v40 from cast_info as ci, aggView1788449528789213244 where ci.person_role_id=aggView1788449528789213244.v9;
create or replace view aggView1230293443144251523 as select id as v26 from kind_type as kt where kind= 'movie';
create or replace view aggJoin4567105233063914022 as select id as v40, title as v41 from title as t, aggView1230293443144251523 where t.kind_id=aggView1230293443144251523.v26 and production_year>1950;
create or replace view aggView7578814746735240480 as select v40, MIN(v41) as v52 from aggJoin4567105233063914022 group by v40;
create or replace view aggJoin612896744197729409 as select movie_id as v40, subject_id as v5, status_id as v7, v52 from complete_cast as cc, aggView7578814746735240480 where cc.movie_id=aggView7578814746735240480.v40;
create or replace view aggView1977088968409544576 as select id as v31 from name as n;
create or replace view aggJoin1106659092196704784 as select v40 from aggJoin1048968288948784268 join aggView1977088968409544576 using(v31);
create or replace view aggView7562066967005429707 as select v40 from aggJoin1106659092196704784 group by v40;
create or replace view aggJoin2709665142187239120 as select movie_id as v40, keyword_id as v23 from movie_keyword as mk, aggView7562066967005429707 where mk.movie_id=aggView7562066967005429707.v40;
create or replace view aggView712275631905460687 as select id as v7 from comp_cast_type as cct2 where kind LIKE '%complete%';
create or replace view aggJoin7774247797994955966 as select v40, v5, v52 from aggJoin612896744197729409 join aggView712275631905460687 using(v7);
create or replace view aggView2124272430424280327 as select id as v5 from comp_cast_type as cct1 where kind= 'cast';
create or replace view aggJoin5330407030156348902 as select v40, v52 from aggJoin7774247797994955966 join aggView2124272430424280327 using(v5);
create or replace view aggView6890749065854255397 as select v40, MIN(v52) as v52 from aggJoin5330407030156348902 group by v40;
create or replace view aggJoin254376870539686592 as select v23, v52 from aggJoin2709665142187239120 join aggView6890749065854255397 using(v40);
create or replace view aggView4412977781597092928 as select v23, MIN(v52) as v52 from aggJoin254376870539686592 group by v23;
create or replace view aggJoin1470054098944722896 as select v52 from keyword as k, aggView4412977781597092928 where k.id=aggView4412977781597092928.v23 and keyword IN ('superhero','sequel','second-part','marvel-comics','based-on-comic','tv-special','fight','violence');
create or replace view res as select MIN(v52) as v52 from aggJoin1470054098944722896;
select sum(v52) from res;