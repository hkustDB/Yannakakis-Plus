create or replace view aggView1765543065305840490 as select id as v9 from char_name as chn where ((name LIKE '%Tony%Stark%') OR (name LIKE '%Iron%Man%')) and name NOT LIKE '%Sherlock%';
create or replace view aggJoin4142718461646799455 as select person_id as v31, movie_id as v40 from cast_info as ci, aggView1765543065305840490 where ci.person_role_id=aggView1765543065305840490.v9;
create or replace view aggView5629984540375895667 as select id as v26 from kind_type as kt where kind= 'movie';
create or replace view aggJoin8150608624618324592 as select id as v40, title as v41 from title as t, aggView5629984540375895667 where t.kind_id=aggView5629984540375895667.v26 and production_year>1950;
create or replace view aggView6486438870657078720 as select v40, MIN(v41) as v52 from aggJoin8150608624618324592 group by v40;
create or replace view aggJoin8976689894877258801 as select movie_id as v40, keyword_id as v23, v52 from movie_keyword as mk, aggView6486438870657078720 where mk.movie_id=aggView6486438870657078720.v40;
create or replace view aggView6935263593578833520 as select id as v31 from name as n;
create or replace view aggJoin9145328651640681269 as select v40 from aggJoin4142718461646799455 join aggView6935263593578833520 using(v31);
create or replace view aggView2651595086049446941 as select id as v7 from comp_cast_type as cct2 where kind LIKE '%complete%';
create or replace view aggJoin375230688065631386 as select movie_id as v40, subject_id as v5 from complete_cast as cc, aggView2651595086049446941 where cc.status_id=aggView2651595086049446941.v7;
create or replace view aggView4129216658415092309 as select id as v5 from comp_cast_type as cct1 where kind= 'cast';
create or replace view aggJoin7701847967341681330 as select v40 from aggJoin375230688065631386 join aggView4129216658415092309 using(v5);
create or replace view aggView5188199347381309322 as select v40 from aggJoin7701847967341681330 group by v40;
create or replace view aggJoin2881477251162752164 as select v40 from aggJoin9145328651640681269 join aggView5188199347381309322 using(v40);
create or replace view aggView5291887337937199197 as select v40 from aggJoin2881477251162752164 group by v40;
create or replace view aggJoin4751874432077351331 as select v23, v52 as v52 from aggJoin8976689894877258801 join aggView5291887337937199197 using(v40);
create or replace view aggView2190804733123927494 as select v23, MIN(v52) as v52 from aggJoin4751874432077351331 group by v23;
create or replace view aggJoin6426252607691006227 as select v52 from keyword as k, aggView2190804733123927494 where k.id=aggView2190804733123927494.v23 and keyword IN ('superhero','sequel','second-part','marvel-comics','based-on-comic','tv-special','fight','violence');
create or replace view res as select MIN(v52) as v52 from aggJoin6426252607691006227;
select sum(v52) from res;