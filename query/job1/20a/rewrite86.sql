create or replace view aggView2409819016387962137 as select id as v5 from comp_cast_type as cct1 where kind= 'cast';
create or replace view aggJoin987774458196258133 as select movie_id as v40, status_id as v7 from complete_cast as cc, aggView2409819016387962137 where cc.subject_id=aggView2409819016387962137.v5;
create or replace view aggView1663230961250818065 as select id as v31 from name as n;
create or replace view aggJoin1767449625460965619 as select movie_id as v40, person_role_id as v9 from cast_info as ci, aggView1663230961250818065 where ci.person_id=aggView1663230961250818065.v31;
create or replace view aggView6443662349602267008 as select id as v7 from comp_cast_type as cct2 where kind LIKE '%complete%';
create or replace view aggJoin7852866177966037676 as select v40 from aggJoin987774458196258133 join aggView6443662349602267008 using(v7);
create or replace view aggView5457858958241635909 as select id as v26 from kind_type as kt where kind= 'movie';
create or replace view aggJoin3961387564867259033 as select id as v40, title as v41 from title as t, aggView5457858958241635909 where t.kind_id=aggView5457858958241635909.v26 and production_year>1950;
create or replace view aggView5935964935749797708 as select v40, MIN(v41) as v52 from aggJoin3961387564867259033 group by v40;
create or replace view aggJoin3870444267377150287 as select v40, v52 from aggJoin7852866177966037676 join aggView5935964935749797708 using(v40);
create or replace view aggView4533644153374270521 as select v40, MIN(v52) as v52 from aggJoin3870444267377150287 group by v40;
create or replace view aggJoin3215708472285875800 as select v40, v9, v52 from aggJoin1767449625460965619 join aggView4533644153374270521 using(v40);
create or replace view aggView58269952738880949 as select id as v9 from char_name as chn where ((name LIKE '%Tony%Stark%') OR (name LIKE '%Iron%Man%')) and name NOT LIKE '%Sherlock%';
create or replace view aggJoin6759206135810488657 as select v40, v52 from aggJoin3215708472285875800 join aggView58269952738880949 using(v9);
create or replace view aggView6696002157246722382 as select v40, MIN(v52) as v52 from aggJoin6759206135810488657 group by v40;
create or replace view aggJoin2829106101961374435 as select keyword_id as v23, v52 from movie_keyword as mk, aggView6696002157246722382 where mk.movie_id=aggView6696002157246722382.v40;
create or replace view aggView1632444904453393605 as select v23, MIN(v52) as v52 from aggJoin2829106101961374435 group by v23;
create or replace view aggJoin1042948101667382015 as select v52 from keyword as k, aggView1632444904453393605 where k.id=aggView1632444904453393605.v23 and keyword IN ('superhero','sequel','second-part','marvel-comics','based-on-comic','tv-special','fight','violence');
select MIN(v52) as v52 from aggJoin1042948101667382015;
