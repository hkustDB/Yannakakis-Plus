create or replace view aggView2918806643026033736 as select id as v26 from kind_type as kt where kind= 'movie';
create or replace view aggJoin164742604153317028 as select id as v40, title as v41 from title as t, aggView2918806643026033736 where t.kind_id=aggView2918806643026033736.v26 and production_year>1950;
create or replace view aggView4340240801632352315 as select id as v31 from name as n;
create or replace view aggJoin7610668574960171234 as select movie_id as v40, person_role_id as v9 from cast_info as ci, aggView4340240801632352315 where ci.person_id=aggView4340240801632352315.v31;
create or replace view aggView609054299600605592 as select id as v7 from comp_cast_type as cct2 where kind LIKE '%complete%';
create or replace view aggJoin2676327497194674854 as select movie_id as v40, subject_id as v5 from complete_cast as cc, aggView609054299600605592 where cc.status_id=aggView609054299600605592.v7;
create or replace view aggView4761889762577674477 as select id as v5 from comp_cast_type as cct1 where kind= 'cast';
create or replace view aggJoin5564041950400812510 as select v40 from aggJoin2676327497194674854 join aggView4761889762577674477 using(v5);
create or replace view aggView2039853004098223936 as select v40 from aggJoin5564041950400812510 group by v40;
create or replace view aggJoin5802869380197899421 as select movie_id as v40, keyword_id as v23 from movie_keyword as mk, aggView2039853004098223936 where mk.movie_id=aggView2039853004098223936.v40;
create or replace view aggView54136122520058708 as select id as v23 from keyword as k where keyword IN ('superhero','sequel','second-part','marvel-comics','based-on-comic','tv-special','fight','violence');
create or replace view aggJoin6199151901807747237 as select v40 from aggJoin5802869380197899421 join aggView54136122520058708 using(v23);
create or replace view aggView2997413041873817699 as select v40 from aggJoin6199151901807747237 group by v40;
create or replace view aggJoin4820937933724539624 as select v40, v41 from aggJoin164742604153317028 join aggView2997413041873817699 using(v40);
create or replace view aggView40734475226276988 as select v40, MIN(v41) as v52 from aggJoin4820937933724539624 group by v40;
create or replace view aggJoin5055696498324190361 as select v9, v52 from aggJoin7610668574960171234 join aggView40734475226276988 using(v40);
create or replace view aggView1002656034736463151 as select v9, MIN(v52) as v52 from aggJoin5055696498324190361 group by v9;
create or replace view aggJoin3736824519027213889 as select v52 from char_name as chn, aggView1002656034736463151 where chn.id=aggView1002656034736463151.v9 and ((name LIKE '%Tony%Stark%') OR (name LIKE '%Iron%Man%')) and name NOT LIKE '%Sherlock%';
create or replace view res as select MIN(v52) as v52 from aggJoin3736824519027213889;
select sum(v52) from res;