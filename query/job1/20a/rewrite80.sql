create or replace view aggView5929178266102766579 as select id as v9 from char_name as chn where ((name LIKE '%Tony%Stark%') OR (name LIKE '%Iron%Man%')) and name NOT LIKE '%Sherlock%';
create or replace view aggJoin1267085452372481041 as select person_id as v31, movie_id as v40 from cast_info as ci, aggView5929178266102766579 where ci.person_role_id=aggView5929178266102766579.v9;
create or replace view aggView3036290059430364296 as select id as v31 from name as n;
create or replace view aggJoin2192520366216141864 as select v40 from aggJoin1267085452372481041 join aggView3036290059430364296 using(v31);
create or replace view aggView7552553511458807498 as select v40 from aggJoin2192520366216141864 group by v40;
create or replace view aggJoin610729404011940923 as select id as v40, title as v41, kind_id as v26 from title as t, aggView7552553511458807498 where t.id=aggView7552553511458807498.v40 and production_year>1950;
create or replace view aggView8872762098752883647 as select id as v7 from comp_cast_type as cct2 where kind LIKE '%complete%';
create or replace view aggJoin5296627271789508311 as select movie_id as v40, subject_id as v5 from complete_cast as cc, aggView8872762098752883647 where cc.status_id=aggView8872762098752883647.v7;
create or replace view aggView6568881090150240547 as select id as v5 from comp_cast_type as cct1 where kind= 'cast';
create or replace view aggJoin379951693512771207 as select v40 from aggJoin5296627271789508311 join aggView6568881090150240547 using(v5);
create or replace view aggView6470426303769075812 as select v40 from aggJoin379951693512771207 group by v40;
create or replace view aggJoin6594254133902169298 as select v40, v41, v26 from aggJoin610729404011940923 join aggView6470426303769075812 using(v40);
create or replace view aggView6333532175512775575 as select id as v23 from keyword as k where keyword IN ('superhero','sequel','second-part','marvel-comics','based-on-comic','tv-special','fight','violence');
create or replace view aggJoin3671043805180534291 as select movie_id as v40 from movie_keyword as mk, aggView6333532175512775575 where mk.keyword_id=aggView6333532175512775575.v23;
create or replace view aggView8679601639770421501 as select v40 from aggJoin3671043805180534291 group by v40;
create or replace view aggJoin1968987036609595784 as select v41, v26 from aggJoin6594254133902169298 join aggView8679601639770421501 using(v40);
create or replace view aggView3499279258305476579 as select v26, MIN(v41) as v52 from aggJoin1968987036609595784 group by v26;
create or replace view aggJoin2360866666707325638 as select v52 from kind_type as kt, aggView3499279258305476579 where kt.id=aggView3499279258305476579.v26 and kind= 'movie';
create or replace view res as select MIN(v52) as v52 from aggJoin2360866666707325638;
select sum(v52) from res;