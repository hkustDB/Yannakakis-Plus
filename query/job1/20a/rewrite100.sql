create or replace view aggView3872702973083918939 as select id as v9 from char_name as chn where ((name LIKE '%Tony%Stark%') OR (name LIKE '%Iron%Man%')) and name NOT LIKE '%Sherlock%';
create or replace view aggJoin7654023651048233085 as select person_id as v31, movie_id as v40 from cast_info as ci, aggView3872702973083918939 where ci.person_role_id=aggView3872702973083918939.v9;
create or replace view aggView2253031034295869539 as select id as v26 from kind_type as kt where kind= 'movie';
create or replace view aggJoin559817375337392282 as select id as v40, title as v41 from title as t, aggView2253031034295869539 where t.kind_id=aggView2253031034295869539.v26 and production_year>1950;
create or replace view aggView6193248830811765356 as select id as v31 from name as n;
create or replace view aggJoin3882938732036902318 as select v40 from aggJoin7654023651048233085 join aggView6193248830811765356 using(v31);
create or replace view aggView1775972512686725887 as select id as v7 from comp_cast_type as cct2 where kind LIKE '%complete%';
create or replace view aggJoin999713477791920070 as select movie_id as v40, subject_id as v5 from complete_cast as cc, aggView1775972512686725887 where cc.status_id=aggView1775972512686725887.v7;
create or replace view aggView4200070455014128784 as select id as v5 from comp_cast_type as cct1 where kind= 'cast';
create or replace view aggJoin4978854499634348332 as select v40 from aggJoin999713477791920070 join aggView4200070455014128784 using(v5);
create or replace view aggView3654656837557223507 as select v40 from aggJoin4978854499634348332 group by v40;
create or replace view aggJoin6297482312944896632 as select v40, v41 from aggJoin559817375337392282 join aggView3654656837557223507 using(v40);
create or replace view aggView5093149982238411647 as select id as v23 from keyword as k where keyword IN ('superhero','sequel','second-part','marvel-comics','based-on-comic','tv-special','fight','violence');
create or replace view aggJoin7695580039204064625 as select movie_id as v40 from movie_keyword as mk, aggView5093149982238411647 where mk.keyword_id=aggView5093149982238411647.v23;
create or replace view aggView2225113973584690939 as select v40 from aggJoin7695580039204064625 group by v40;
create or replace view aggJoin5254236165564475751 as select v40 from aggJoin3882938732036902318 join aggView2225113973584690939 using(v40);
create or replace view aggView863744163374665698 as select v40 from aggJoin5254236165564475751 group by v40;
create or replace view aggJoin5210135338519696880 as select v41 from aggJoin6297482312944896632 join aggView863744163374665698 using(v40);
create or replace view res as select MIN(v41) as v52 from aggJoin5210135338519696880;
select sum(v52) from res;