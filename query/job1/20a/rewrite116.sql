create or replace view aggView5024073909342490483 as select id as v5 from comp_cast_type as cct1 where kind= 'cast';
create or replace view aggJoin670198921266276451 as select movie_id as v40, status_id as v7 from complete_cast as cc, aggView5024073909342490483 where cc.subject_id=aggView5024073909342490483.v5;
create or replace view aggView290589332248656053 as select id as v7 from comp_cast_type as cct2 where kind LIKE '%complete%';
create or replace view aggJoin5533158066303913051 as select v40 from aggJoin670198921266276451 join aggView290589332248656053 using(v7);
create or replace view aggView4369079491162474748 as select id as v31 from name as n;
create or replace view aggJoin4478796717044468280 as select movie_id as v40, person_role_id as v9 from cast_info as ci, aggView4369079491162474748 where ci.person_id=aggView4369079491162474748.v31;
create or replace view aggView7473304310707045937 as select id as v9 from char_name as chn where ((name LIKE '%Tony%Stark%') OR (name LIKE '%Iron%Man%')) and name NOT LIKE '%Sherlock%';
create or replace view aggJoin9073253010075114168 as select v40 from aggJoin4478796717044468280 join aggView7473304310707045937 using(v9);
create or replace view aggView7695965017444738890 as select v40 from aggJoin9073253010075114168 group by v40;
create or replace view aggJoin6002568325445347016 as select movie_id as v40, keyword_id as v23 from movie_keyword as mk, aggView7695965017444738890 where mk.movie_id=aggView7695965017444738890.v40;
create or replace view aggView5161039951712833158 as select id as v26 from kind_type as kt where kind= 'movie';
create or replace view aggJoin7756491370941878643 as select id as v40, title as v41 from title as t, aggView5161039951712833158 where t.kind_id=aggView5161039951712833158.v26 and production_year>1950;
create or replace view aggView4045140921013431802 as select v40, MIN(v41) as v52 from aggJoin7756491370941878643 group by v40;
create or replace view aggJoin4787503332542797165 as select v40, v52 from aggJoin5533158066303913051 join aggView4045140921013431802 using(v40);
create or replace view aggView65717421221251446 as select v40, MIN(v52) as v52 from aggJoin4787503332542797165 group by v40;
create or replace view aggJoin5797683433775094818 as select v23, v52 from aggJoin6002568325445347016 join aggView65717421221251446 using(v40);
create or replace view aggView213793122632599443 as select v23, MIN(v52) as v52 from aggJoin5797683433775094818 group by v23;
create or replace view aggJoin1729851219091897931 as select v52 from keyword as k, aggView213793122632599443 where k.id=aggView213793122632599443.v23 and keyword IN ('superhero','sequel','second-part','marvel-comics','based-on-comic','tv-special','fight','violence');
create or replace view res as select MIN(v52) as v52 from aggJoin1729851219091897931;
select sum(v52) from res;