create or replace view aggView6958340640372139049 as select id as v12, title as v31 from title as t;
create or replace view aggJoin5034556462946304555 as select movie_id as v12, keyword_id as v18, v31 from movie_keyword as mk, aggView6958340640372139049 where mk.movie_id=aggView6958340640372139049.v12;
create or replace view aggView5021068334569778406 as select id as v18 from keyword as k where keyword= 'character-name-in-title';
create or replace view aggJoin7191538832611737161 as select v12, v31 from aggJoin5034556462946304555 join aggView5021068334569778406 using(v18);
create or replace view aggView1158060092007876131 as select v12, MIN(v31) as v31 from aggJoin7191538832611737161 group by v12;
create or replace view aggJoin8714586397323870365 as select company_id as v1, v31 from movie_companies as mc, aggView1158060092007876131 where mc.movie_id=aggView1158060092007876131.v12;
create or replace view aggView1983552107124662440 as select v1, MIN(v31) as v31 from aggJoin8714586397323870365 group by v1;
create or replace view aggJoin451051635992145010 as select country_code as v3, v31 from company_name as cn, aggView1983552107124662440 where cn.id=aggView1983552107124662440.v1 and country_code= '[us]';
create or replace view res as select MIN(v31) as v31 from aggJoin451051635992145010;
select sum(v31) from res;