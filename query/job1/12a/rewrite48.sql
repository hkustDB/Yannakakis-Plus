create or replace view aggView8163861111526356857 as select id as v1, name as v41 from company_name as cn where country_code= '[us]';
create or replace view aggJoin7487704886971728998 as select movie_id as v29, company_type_id as v8, v41 from movie_companies as mc, aggView8163861111526356857 where mc.company_id=aggView8163861111526356857.v1;
create or replace view aggView226136653042840153 as select id as v8 from company_type as ct where kind= 'production companies';
create or replace view aggJoin7183405335545201654 as select v29, v41 from aggJoin7487704886971728998 join aggView226136653042840153 using(v8);
create or replace view aggView5327827545995360417 as select id as v26 from info_type as it2 where info= 'rating';
create or replace view aggJoin8118666599543423910 as select movie_id as v29, info as v27 from movie_info_idx as mi_idx, aggView5327827545995360417 where mi_idx.info_type_id=aggView5327827545995360417.v26 and info>'8.0';
create or replace view aggView8656561102395201077 as select v29, MIN(v27) as v42 from aggJoin8118666599543423910 group by v29;
create or replace view aggJoin593312736307244864 as select movie_id as v29, info_type_id as v21, v42 from movie_info as mi, aggView8656561102395201077 where mi.movie_id=aggView8656561102395201077.v29 and info IN ('Drama','Horror');
create or replace view aggView4754176521421447611 as select id as v21 from info_type as it1 where info= 'genres';
create or replace view aggJoin3006200088082942364 as select v29, v42 from aggJoin593312736307244864 join aggView4754176521421447611 using(v21);
create or replace view aggView596302395497803411 as select v29, MIN(v41) as v41 from aggJoin7183405335545201654 group by v29;
create or replace view aggJoin5147549445414509329 as select id as v29, title as v30, v41 from title as t, aggView596302395497803411 where t.id=aggView596302395497803411.v29 and production_year<=2008 and production_year>=2005;
create or replace view aggView7513049969469669248 as select v29, MIN(v41) as v41, MIN(v30) as v43 from aggJoin5147549445414509329 group by v29;
create or replace view aggJoin311455061928439960 as select v42 as v42, v41, v43 from aggJoin3006200088082942364 join aggView7513049969469669248 using(v29);
select MIN(v41) as v41,MIN(v42) as v42,MIN(v43) as v43 from aggJoin311455061928439960;
