create or replace view aggView2439819607234430608 as select id as v1, name as v41 from company_name as cn where country_code= '[us]';
create or replace view aggJoin5184340463113968891 as select movie_id as v29, company_type_id as v8, v41 from movie_companies as mc, aggView2439819607234430608 where mc.company_id=aggView2439819607234430608.v1;
create or replace view aggView2657200102501148927 as select id as v26 from info_type as it2 where info= 'rating';
create or replace view aggJoin6607845273517526229 as select movie_id as v29, info as v27 from movie_info_idx as mi_idx, aggView2657200102501148927 where mi_idx.info_type_id=aggView2657200102501148927.v26 and info>'8.0';
create or replace view aggView5985172519843819680 as select v29, MIN(v27) as v42 from aggJoin6607845273517526229 group by v29;
create or replace view aggJoin1431148216898700431 as select id as v29, title as v30, v42 from title as t, aggView5985172519843819680 where t.id=aggView5985172519843819680.v29 and production_year<=2008 and production_year>=2005;
create or replace view aggView3022058520345151000 as select v29, MIN(v42) as v42, MIN(v30) as v43 from aggJoin1431148216898700431 group by v29;
create or replace view aggJoin6647950414590956112 as select movie_id as v29, info_type_id as v21, v42, v43 from movie_info as mi, aggView3022058520345151000 where mi.movie_id=aggView3022058520345151000.v29 and info IN ('Drama','Horror');
create or replace view aggView4695171412899659220 as select id as v21 from info_type as it1 where info= 'genres';
create or replace view aggJoin948165210158720417 as select v29, v42, v43 from aggJoin6647950414590956112 join aggView4695171412899659220 using(v21);
create or replace view aggView277749934393049570 as select id as v8 from company_type as ct where kind= 'production companies';
create or replace view aggJoin6726912727787874060 as select v29, v41 from aggJoin5184340463113968891 join aggView277749934393049570 using(v8);
create or replace view aggView773654919502029598 as select v29, MIN(v41) as v41 from aggJoin6726912727787874060 group by v29;
create or replace view aggJoin544843968721322571 as select v42 as v42, v43 as v43, v41 from aggJoin948165210158720417 join aggView773654919502029598 using(v29);
create or replace view res as select MIN(v41) as v41, MIN(v42) as v42, MIN(v43) as v43 from aggJoin544843968721322571;
select sum(v41+v42+v43) from res;