create or replace view aggView1884956924354296555 as select title as v30, id as v29 from title as t where production_year<=2008 and production_year>=2005;
create or replace view aggView8248172079799144121 as select id as v1, name as v2 from company_name as cn where country_code= '[us]';
create or replace view aggView7017327425610011098 as select id as v26 from info_type as it2 where info= 'rating';
create or replace view aggJoin4545943860859712634 as select movie_id as v29, info as v27 from movie_info_idx as mi_idx, aggView7017327425610011098 where mi_idx.info_type_id=aggView7017327425610011098.v26;
create or replace view aggView7105201788174433106 as select id as v21 from info_type as it1 where info= 'genres';
create or replace view aggJoin5398044806732747204 as select movie_id as v29, info as v22 from movie_info as mi, aggView7105201788174433106 where mi.info_type_id=aggView7105201788174433106.v21 and info IN ('Drama','Horror');
create or replace view aggView4654368215689653958 as select v29 from aggJoin5398044806732747204 group by v29;
create or replace view aggJoin4867715192677352073 as select v29, v27 from aggJoin4545943860859712634 join aggView4654368215689653958 using(v29);
create or replace view aggView5426997711130398652 as select v27, v29 from aggJoin4867715192677352073;
create or replace view aggJoin2966716244427038955 as select v29, v27 from aggView5426997711130398652 where v27>'8.0';
create or replace view aggView4728106807007761741 as select v1, MIN(v2) as v41 from aggView8248172079799144121 group by v1;
create or replace view aggJoin3220803636175128049 as select movie_id as v29, company_type_id as v8, v41 from movie_companies as mc, aggView4728106807007761741 where mc.company_id=aggView4728106807007761741.v1;
create or replace view aggView1921715870935754199 as select v29, MIN(v30) as v43 from aggView1884956924354296555 group by v29;
create or replace view aggJoin5752922875347387182 as select v29, v8, v41 as v41, v43 from aggJoin3220803636175128049 join aggView1921715870935754199 using(v29);
create or replace view aggView9218309164075225801 as select id as v8 from company_type as ct where kind= 'production companies';
create or replace view aggJoin6240881153109290506 as select v29, v41, v43 from aggJoin5752922875347387182 join aggView9218309164075225801 using(v8);
create or replace view aggView5429719964243859711 as select v29, MIN(v41) as v41, MIN(v43) as v43 from aggJoin6240881153109290506 group by v29;
create or replace view aggJoin7561560486547138525 as select v27, v41, v43 from aggJoin2966716244427038955 join aggView5429719964243859711 using(v29);
select MIN(v41) as v41,MIN(v27) as v42,MIN(v43) as v43 from aggJoin7561560486547138525;
