create or replace view aggView2157911884458574451 as select id as v1, name as v41 from company_name as cn where country_code= '[us]';
create or replace view aggJoin4814030233813909609 as select movie_id as v29, company_type_id as v8, v41 from movie_companies as mc, aggView2157911884458574451 where mc.company_id=aggView2157911884458574451.v1;
create or replace view aggView2763294276249230513 as select id as v26 from info_type as it2 where info= 'rating';
create or replace view aggJoin8472448988015351964 as select movie_id as v29, info as v27 from movie_info_idx as mi_idx, aggView2763294276249230513 where mi_idx.info_type_id=aggView2763294276249230513.v26 and info>'8.0';
create or replace view aggView6031146033936371077 as select v29, MIN(v27) as v42 from aggJoin8472448988015351964 group by v29;
create or replace view aggJoin9215241661194832513 as select id as v29, title as v30, v42 from title as t, aggView6031146033936371077 where t.id=aggView6031146033936371077.v29 and production_year<=2008 and production_year>=2005;
create or replace view aggView263821258812537851 as select id as v21 from info_type as it1 where info= 'genres';
create or replace view aggJoin9188173709759163438 as select movie_id as v29 from movie_info as mi, aggView263821258812537851 where mi.info_type_id=aggView263821258812537851.v21 and info IN ('Drama','Horror');
create or replace view aggView5334739479746175843 as select id as v8 from company_type as ct where kind= 'production companies';
create or replace view aggJoin4589368613162005165 as select v29, v41 from aggJoin4814030233813909609 join aggView5334739479746175843 using(v8);
create or replace view aggView5167139714050200128 as select v29, MIN(v41) as v41 from aggJoin4589368613162005165 group by v29;
create or replace view aggJoin9194271243707844095 as select v29, v41 from aggJoin9188173709759163438 join aggView5167139714050200128 using(v29);
create or replace view aggView3438336595483399625 as select v29, MIN(v41) as v41 from aggJoin9194271243707844095 group by v29;
create or replace view aggJoin9103618863394291757 as select v30, v42 as v42, v41 from aggJoin9215241661194832513 join aggView3438336595483399625 using(v29);
create or replace view res as select MIN(v41) as v41, MIN(v42) as v42, MIN(v30) as v43 from aggJoin9103618863394291757;
select sum(v41+v42+v43) from res;