create or replace view aggView415451062492133947 as select id as v1, name as v41 from company_name as cn where country_code= '[us]';
create or replace view aggJoin220629936050158517 as select movie_id as v29, company_type_id as v8, v41 from movie_companies as mc, aggView415451062492133947 where mc.company_id=aggView415451062492133947.v1;
create or replace view aggView76343928733986301 as select id as v26 from info_type as it2 where info= 'rating';
create or replace view aggJoin7846214028666051986 as select movie_id as v29, info as v27 from movie_info_idx as mi_idx, aggView76343928733986301 where mi_idx.info_type_id=aggView76343928733986301.v26 and info>'8.0';
create or replace view aggView895183711170798741 as select v29, MIN(v27) as v42 from aggJoin7846214028666051986 group by v29;
create or replace view aggJoin4950361929944573338 as select id as v29, title as v30, v42 from title as t, aggView895183711170798741 where t.id=aggView895183711170798741.v29 and production_year<=2008 and production_year>=2005;
create or replace view aggView7171991612360083616 as select id as v21 from info_type as it1 where info= 'genres';
create or replace view aggJoin3467924363150862999 as select movie_id as v29 from movie_info as mi, aggView7171991612360083616 where mi.info_type_id=aggView7171991612360083616.v21 and info IN ('Drama','Horror');
create or replace view aggView6654817103199754903 as select id as v8 from company_type as ct where kind= 'production companies';
create or replace view aggJoin1509710452261369739 as select v29, v41 from aggJoin220629936050158517 join aggView6654817103199754903 using(v8);
create or replace view aggView2462372845104961515 as select v29, MIN(v41) as v41 from aggJoin1509710452261369739 group by v29;
create or replace view aggJoin5000741791560300262 as select v29, v30, v42 as v42, v41 from aggJoin4950361929944573338 join aggView2462372845104961515 using(v29);
create or replace view aggView8229762372401988100 as select v29, MIN(v42) as v42, MIN(v41) as v41, MIN(v30) as v43 from aggJoin5000741791560300262 group by v29;
create or replace view aggJoin2317331460529243134 as select v42, v41, v43 from aggJoin3467924363150862999 join aggView8229762372401988100 using(v29);
create or replace view res as select MIN(v41) as v41, MIN(v42) as v42, MIN(v43) as v43 from aggJoin2317331460529243134;
select sum(v41+v42+v43) from res;