create or replace view aggView1806170035481006541 as select id as v1, name as v41 from company_name as cn where country_code= '[us]';
create or replace view aggJoin5197345177718012498 as select movie_id as v29, company_type_id as v8, v41 from movie_companies as mc, aggView1806170035481006541 where mc.company_id=aggView1806170035481006541.v1;
create or replace view aggView1801151831994259378 as select id as v8 from company_type as ct where kind= 'production companies';
create or replace view aggJoin2197560119605458642 as select v29, v41 from aggJoin5197345177718012498 join aggView1801151831994259378 using(v8);
create or replace view aggView2409844304881889513 as select id as v26 from info_type as it2 where info= 'rating';
create or replace view aggJoin8134478085547220574 as select movie_id as v29, info as v27 from movie_info_idx as mi_idx, aggView2409844304881889513 where mi_idx.info_type_id=aggView2409844304881889513.v26 and info>'8.0';
create or replace view aggView2355412901970336010 as select id as v21 from info_type as it1 where info= 'genres';
create or replace view aggJoin3574205930751309841 as select movie_id as v29 from movie_info as mi, aggView2355412901970336010 where mi.info_type_id=aggView2355412901970336010.v21 and info IN ('Drama','Horror');
create or replace view aggView1759645800428626441 as select v29 from aggJoin3574205930751309841 group by v29;
create or replace view aggJoin9193545217981660972 as select v29, v41 as v41 from aggJoin2197560119605458642 join aggView1759645800428626441 using(v29);
create or replace view aggView4349957971916313535 as select v29, MIN(v41) as v41 from aggJoin9193545217981660972 group by v29;
create or replace view aggJoin7709001030751779833 as select v29, v27, v41 from aggJoin8134478085547220574 join aggView4349957971916313535 using(v29);
create or replace view aggView2438766835537495279 as select v29, MIN(v41) as v41, MIN(v27) as v42 from aggJoin7709001030751779833 group by v29;
create or replace view aggJoin9016315970972892372 as select title as v30, v41, v42 from title as t, aggView2438766835537495279 where t.id=aggView2438766835537495279.v29 and production_year<=2008 and production_year>=2005;
select MIN(v41) as v41,MIN(v42) as v42,MIN(v30) as v43 from aggJoin9016315970972892372;
