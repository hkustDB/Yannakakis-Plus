create or replace view aggView328616873112680526 as select id as v1, name as v41 from company_name as cn where country_code= '[us]';
create or replace view aggJoin4120571786222197461 as select movie_id as v29, company_type_id as v8, v41 from movie_companies as mc, aggView328616873112680526 where mc.company_id=aggView328616873112680526.v1;
create or replace view aggView2151363893203154132 as select id as v26 from info_type as it2 where info= 'rating';
create or replace view aggJoin5329711279521249060 as select movie_id as v29, info as v27 from movie_info_idx as mi_idx, aggView2151363893203154132 where mi_idx.info_type_id=aggView2151363893203154132.v26 and info>'8.0';
create or replace view aggView5940672428735490477 as select v29, MIN(v27) as v42 from aggJoin5329711279521249060 group by v29;
create or replace view aggJoin7218531166031820530 as select id as v29, title as v30, v42 from title as t, aggView5940672428735490477 where t.id=aggView5940672428735490477.v29 and production_year<=2008 and production_year>=2005;
create or replace view aggView849897168898073703 as select v29, MIN(v42) as v42, MIN(v30) as v43 from aggJoin7218531166031820530 group by v29;
create or replace view aggJoin3288004072659282024 as select movie_id as v29, info_type_id as v21, v42, v43 from movie_info as mi, aggView849897168898073703 where mi.movie_id=aggView849897168898073703.v29 and info IN ('Drama','Horror');
create or replace view aggView1217082881246252795 as select id as v21 from info_type as it1 where info= 'genres';
create or replace view aggJoin7931698329061104248 as select v29, v42, v43 from aggJoin3288004072659282024 join aggView1217082881246252795 using(v21);
create or replace view aggView1226461527207901263 as select v29, MIN(v42) as v42, MIN(v43) as v43 from aggJoin7931698329061104248 group by v29;
create or replace view aggJoin4900276422769617937 as select v8, v41 as v41, v42, v43 from aggJoin4120571786222197461 join aggView1226461527207901263 using(v29);
create or replace view aggView2691232512203212325 as select v8, MIN(v41) as v41, MIN(v42) as v42, MIN(v43) as v43 from aggJoin4900276422769617937 group by v8;
create or replace view aggJoin3680556078073304576 as select v41, v42, v43 from company_type as ct, aggView2691232512203212325 where ct.id=aggView2691232512203212325.v8 and kind= 'production companies';
select MIN(v41) as v41,MIN(v42) as v42,MIN(v43) as v43 from aggJoin3680556078073304576;
