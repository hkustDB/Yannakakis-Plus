create or replace view aggView8536983703284191053 as select id as v1, name as v2 from company_name as cn where country_code= '[us]';
create or replace view aggView2526258075054390600 as select id as v26 from info_type as it2 where info= 'rating';
create or replace view aggJoin8186229590061390849 as select movie_id as v29, info as v27 from movie_info_idx as mi_idx, aggView2526258075054390600 where mi_idx.info_type_id=aggView2526258075054390600.v26 and info>'8.0';
create or replace view aggView2131813651051009014 as select v27, v29 from aggJoin8186229590061390849;
create or replace view aggView133127007403900856 as select id as v21 from info_type as it1 where info= 'genres';
create or replace view aggJoin7834394962575169245 as select movie_id as v29, info as v22 from movie_info as mi, aggView133127007403900856 where mi.info_type_id=aggView133127007403900856.v21 and info IN ('Drama','Horror');
create or replace view aggView5201541905723366525 as select v29 from aggJoin7834394962575169245 group by v29;
create or replace view aggJoin5551977796672734933 as select id as v29, title as v30, production_year as v33 from title as t, aggView5201541905723366525 where t.id=aggView5201541905723366525.v29 and production_year<=2008 and production_year>=2005;
create or replace view aggView893598655156899471 as select v30, v29 from aggJoin5551977796672734933;
create or replace view aggView4369297525911655467 as select v29, MIN(v27) as v42 from aggView2131813651051009014 group by v29;
create or replace view aggJoin7330636803403375724 as select v30, v29, v42 from aggView893598655156899471 join aggView4369297525911655467 using(v29);
create or replace view aggView7661824500407569624 as select v29, MIN(v42) as v42, MIN(v30) as v43 from aggJoin7330636803403375724 group by v29;
create or replace view aggJoin9184485913040957095 as select company_id as v1, company_type_id as v8, v42, v43 from movie_companies as mc, aggView7661824500407569624 where mc.movie_id=aggView7661824500407569624.v29;
create or replace view aggView5645165425486637967 as select id as v8 from company_type as ct where kind= 'production companies';
create or replace view aggJoin6962134784135801158 as select v1, v42, v43 from aggJoin9184485913040957095 join aggView5645165425486637967 using(v8);
create or replace view aggView6569428302711076535 as select v1, MIN(v42) as v42, MIN(v43) as v43 from aggJoin6962134784135801158 group by v1;
create or replace view aggJoin764658816037093594 as select v2, v42, v43 from aggView8536983703284191053 join aggView6569428302711076535 using(v1);
select MIN(v2) as v41,MIN(v42) as v42,MIN(v43) as v43 from aggJoin764658816037093594;
