create or replace view aggView896445565026972444 as select id as v17, name as v39 from company_name as cn where country_code<> '[pl]' and ((name LIKE '%Film%') OR (name LIKE '%Warner%'));
create or replace view aggJoin381861126069919341 as select movie_id as v24, company_type_id as v18, v39 from movie_companies as mc, aggView896445565026972444 where mc.company_id=aggView896445565026972444.v17;
create or replace view aggView2041908599006113087 as select id as v22 from keyword as k where keyword= 'sequel';
create or replace view aggJoin6763293710741628704 as select movie_id as v24 from movie_keyword as mk, aggView2041908599006113087 where mk.keyword_id=aggView2041908599006113087.v22;
create or replace view aggView7038826155110008550 as select v24 from aggJoin6763293710741628704 group by v24;
create or replace view aggJoin2689900922857151625 as select id as v24, title as v28, production_year as v31 from title as t, aggView7038826155110008550 where t.id=aggView7038826155110008550.v24 and title LIKE '%Money%' and production_year= 1998;
create or replace view aggView8870074490164832614 as select id as v18 from company_type as ct where kind= 'production companies';
create or replace view aggJoin9167385150400181604 as select v24, v39 from aggJoin381861126069919341 join aggView8870074490164832614 using(v18);
create or replace view aggView9205197657193254447 as select v24, MIN(v39) as v39 from aggJoin9167385150400181604 group by v24;
create or replace view aggJoin5803754149602114989 as select v24, v28, v31, v39 from aggJoin2689900922857151625 join aggView9205197657193254447 using(v24);
create or replace view aggView3688270558236376699 as select v24, MIN(v39) as v39, MIN(v28) as v41 from aggJoin5803754149602114989 group by v24;
create or replace view aggJoin3150302824101412227 as select link_type_id as v13, v39, v41 from movie_link as ml, aggView3688270558236376699 where ml.movie_id=aggView3688270558236376699.v24;
create or replace view aggView7907961735874835934 as select v13, MIN(v39) as v39, MIN(v41) as v41 from aggJoin3150302824101412227 group by v13;
create or replace view aggJoin6720349410728924961 as select link as v14, v39, v41 from link_type as lt, aggView7907961735874835934 where lt.id=aggView7907961735874835934.v13 and link LIKE '%follows%';
create or replace view res as select MIN(v39) as v39, MIN(v14) as v40, MIN(v41) as v41 from aggJoin6720349410728924961;
select sum(v39+v40+v41) from res;