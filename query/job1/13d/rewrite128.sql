create or replace view aggView3092418244858552862 as select id as v1, name as v43 from company_name as cn where country_code= '[us]';
create or replace view aggJoin3589661941158307356 as select movie_id as v22, company_type_id as v8, v43 from movie_companies as mc, aggView3092418244858552862 where mc.company_id=aggView3092418244858552862.v1;
create or replace view aggView1701684761505867916 as select id as v8 from company_type as ct where kind= 'production companies';
create or replace view aggJoin3721072806691673481 as select v22, v43 from aggJoin3589661941158307356 join aggView1701684761505867916 using(v8);
create or replace view aggView4292726538440851495 as select id as v14 from kind_type as kt where kind= 'movie';
create or replace view aggJoin6160518557170732664 as select id as v22, title as v32 from title as t, aggView4292726538440851495 where t.kind_id=aggView4292726538440851495.v14;
create or replace view aggView840439460316189344 as select v22, MIN(v32) as v45 from aggJoin6160518557170732664 group by v22;
create or replace view aggJoin2611584040692272854 as select movie_id as v22, info_type_id as v10, info as v29, v45 from movie_info_idx as miidx, aggView840439460316189344 where miidx.movie_id=aggView840439460316189344.v22;
create or replace view aggView4347181740544519845 as select id as v12 from info_type as it2 where info= 'release dates';
create or replace view aggJoin7122310322315990589 as select movie_id as v22 from movie_info as mi, aggView4347181740544519845 where mi.info_type_id=aggView4347181740544519845.v12;
create or replace view aggView4882110497441104150 as select v22 from aggJoin7122310322315990589 group by v22;
create or replace view aggJoin2082626409413673600 as select v22, v10, v29, v45 as v45 from aggJoin2611584040692272854 join aggView4882110497441104150 using(v22);
create or replace view aggView1357824657163357874 as select id as v10 from info_type as it where info= 'rating';
create or replace view aggJoin3380206334026059784 as select v22, v29, v45 from aggJoin2082626409413673600 join aggView1357824657163357874 using(v10);
create or replace view aggView6002452356706394208 as select v22, MIN(v43) as v43 from aggJoin3721072806691673481 group by v22;
create or replace view aggJoin3371172441654921815 as select v29, v45 as v45, v43 from aggJoin3380206334026059784 join aggView6002452356706394208 using(v22);
create or replace view res as select MIN(v43) as v43, MIN(v29) as v44, MIN(v45) as v45 from aggJoin3371172441654921815;
select sum(v43+v44+v45) from res;