create or replace view aggView1496666539977211607 as select id as v1, name as v43 from company_name as cn where country_code= '[us]';
create or replace view aggJoin7635294892539227861 as select movie_id as v22, company_type_id as v8, v43 from movie_companies as mc, aggView1496666539977211607 where mc.company_id=aggView1496666539977211607.v1;
create or replace view aggView3065411772681293476 as select id as v8 from company_type as ct where kind= 'production companies';
create or replace view aggJoin509539692448014932 as select v22, v43 from aggJoin7635294892539227861 join aggView3065411772681293476 using(v8);
create or replace view aggView2969356787347360104 as select id as v14 from kind_type as kt where kind= 'movie';
create or replace view aggJoin2846951912573744306 as select id as v22, title as v32 from title as t, aggView2969356787347360104 where t.kind_id=aggView2969356787347360104.v14;
create or replace view aggView4711502493030290223 as select v22, MIN(v32) as v45 from aggJoin2846951912573744306 group by v22;
create or replace view aggJoin4941465561638867465 as select v22, v43 as v43, v45 from aggJoin509539692448014932 join aggView4711502493030290223 using(v22);
create or replace view aggView1336378347171928939 as select id as v10 from info_type as it where info= 'rating';
create or replace view aggJoin1819228107216015532 as select movie_id as v22, info as v29 from movie_info_idx as miidx, aggView1336378347171928939 where miidx.info_type_id=aggView1336378347171928939.v10;
create or replace view aggView3579768439263732506 as select v22, MIN(v29) as v44 from aggJoin1819228107216015532 group by v22;
create or replace view aggJoin6770938059752152501 as select movie_id as v22, info_type_id as v12, v44 from movie_info as mi, aggView3579768439263732506 where mi.movie_id=aggView3579768439263732506.v22;
create or replace view aggView674894991896203937 as select id as v12 from info_type as it2 where info= 'release dates';
create or replace view aggJoin393343814672198505 as select v22, v44 from aggJoin6770938059752152501 join aggView674894991896203937 using(v12);
create or replace view aggView2338595498397885366 as select v22, MIN(v43) as v43, MIN(v45) as v45 from aggJoin4941465561638867465 group by v22;
create or replace view aggJoin3339850875012746032 as select v44 as v44, v43, v45 from aggJoin393343814672198505 join aggView2338595498397885366 using(v22);
select MIN(v43) as v43,MIN(v44) as v44,MIN(v45) as v45 from aggJoin3339850875012746032;
