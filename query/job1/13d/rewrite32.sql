create or replace view aggView3163364494801892698 as select id as v1, name as v43 from company_name as cn where country_code= '[us]';
create or replace view aggJoin2356790918207245913 as select movie_id as v22, company_type_id as v8, v43 from movie_companies as mc, aggView3163364494801892698 where mc.company_id=aggView3163364494801892698.v1;
create or replace view aggView9087503457797171980 as select id as v8 from company_type as ct where kind= 'production companies';
create or replace view aggJoin5629625564757124815 as select v22, v43 from aggJoin2356790918207245913 join aggView9087503457797171980 using(v8);
create or replace view aggView6052234954108692461 as select id as v14 from kind_type as kt where kind= 'movie';
create or replace view aggJoin1245984341697461888 as select id as v22, title as v32 from title as t, aggView6052234954108692461 where t.kind_id=aggView6052234954108692461.v14;
create or replace view aggView835889294815343096 as select v22, MIN(v43) as v43 from aggJoin5629625564757124815 group by v22;
create or replace view aggJoin9036344267802437119 as select v22, v32, v43 from aggJoin1245984341697461888 join aggView835889294815343096 using(v22);
create or replace view aggView1879534574861463923 as select v22, MIN(v43) as v43, MIN(v32) as v45 from aggJoin9036344267802437119 group by v22;
create or replace view aggJoin1396574680010373316 as select movie_id as v22, info_type_id as v10, info as v29, v43, v45 from movie_info_idx as miidx, aggView1879534574861463923 where miidx.movie_id=aggView1879534574861463923.v22;
create or replace view aggView5814885103446220967 as select id as v12 from info_type as it2 where info= 'release dates';
create or replace view aggJoin1352658661311341907 as select movie_id as v22 from movie_info as mi, aggView5814885103446220967 where mi.info_type_id=aggView5814885103446220967.v12;
create or replace view aggView1119537141574529546 as select v22 from aggJoin1352658661311341907 group by v22;
create or replace view aggJoin7120059776094758291 as select v10, v29, v43 as v43, v45 as v45 from aggJoin1396574680010373316 join aggView1119537141574529546 using(v22);
create or replace view aggView7014659416472487879 as select v10, MIN(v43) as v43, MIN(v45) as v45, MIN(v29) as v44 from aggJoin7120059776094758291 group by v10;
create or replace view aggJoin624179982773563862 as select info as v11, v43, v45, v44 from info_type as it, aggView7014659416472487879 where it.id=aggView7014659416472487879.v10 and info= 'rating';
create or replace view res as select MIN(v43) as v43, MIN(v44) as v44, MIN(v45) as v45 from aggJoin624179982773563862;
select sum(v43+v44+v45) from res;