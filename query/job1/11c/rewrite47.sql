create or replace view aggView2977571372516410720 as select id as v17, name as v39 from company_name as cn where country_code<> '[pl]' and ((name LIKE '20th Century Fox%') OR (name LIKE 'Twentieth Century Fox%'));
create or replace view aggJoin6682370331215554004 as select movie_id as v24, company_type_id as v18, note as v19, v39 from movie_companies as mc, aggView2977571372516410720 where mc.company_id=aggView2977571372516410720.v17;
create or replace view aggView6141939497601305643 as select id as v22 from keyword as k where keyword IN ('sequel','revenge','based-on-novel');
create or replace view aggJoin4288368574872609760 as select movie_id as v24 from movie_keyword as mk, aggView6141939497601305643 where mk.keyword_id=aggView6141939497601305643.v22;
create or replace view aggView7560829284082551237 as select v24 from aggJoin4288368574872609760 group by v24;
create or replace view aggJoin5963673455880825754 as select movie_id as v24, link_type_id as v13 from movie_link as ml, aggView7560829284082551237 where ml.movie_id=aggView7560829284082551237.v24;
create or replace view aggView7159791406767700186 as select id as v18 from company_type as ct where kind<> 'production companies';
create or replace view aggJoin700601311530001497 as select v24, v19, v39 from aggJoin6682370331215554004 join aggView7159791406767700186 using(v18);
create or replace view aggView1473193988938964345 as select v24, MIN(v39) as v39, MIN(v19) as v40 from aggJoin700601311530001497 group by v24;
create or replace view aggJoin8057409648719097723 as select id as v24, title as v28, v39, v40 from title as t, aggView1473193988938964345 where t.id=aggView1473193988938964345.v24 and production_year>1950;
create or replace view aggView3100304329783276660 as select v24, MIN(v39) as v39, MIN(v40) as v40, MIN(v28) as v41 from aggJoin8057409648719097723 group by v24;
create or replace view aggJoin6153657478378737732 as select v13, v39, v40, v41 from aggJoin5963673455880825754 join aggView3100304329783276660 using(v24);
create or replace view aggView665201272809746933 as select id as v13 from link_type as lt;
create or replace view aggJoin4816390101057360796 as select v39, v40, v41 from aggJoin6153657478378737732 join aggView665201272809746933 using(v13);
select MIN(v39) as v39,MIN(v40) as v40,MIN(v41) as v41 from aggJoin4816390101057360796;
