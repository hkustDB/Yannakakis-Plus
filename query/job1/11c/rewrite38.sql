create or replace view aggView4736927882526752691 as select id as v22 from keyword as k where keyword IN ('sequel','revenge','based-on-novel');
create or replace view aggJoin2828305722719138315 as select movie_id as v24 from movie_keyword as mk, aggView4736927882526752691 where mk.keyword_id=aggView4736927882526752691.v22;
create or replace view aggView55448009244911441 as select v24 from aggJoin2828305722719138315 group by v24;
create or replace view aggJoin9086061834797241321 as select id as v24, title as v28 from title as t, aggView55448009244911441 where t.id=aggView55448009244911441.v24 and production_year>1950;
create or replace view aggView4665645812203084089 as select v24, MIN(v28) as v41 from aggJoin9086061834797241321 group by v24;
create or replace view aggJoin8610163290808166586 as select movie_id as v24, link_type_id as v13, v41 from movie_link as ml, aggView4665645812203084089 where ml.movie_id=aggView4665645812203084089.v24;
create or replace view aggView6578864242089607560 as select id as v13 from link_type as lt;
create or replace view aggJoin973564958010069353 as select v24, v41 from aggJoin8610163290808166586 join aggView6578864242089607560 using(v13);
create or replace view aggView4344513617527259149 as select v24, MIN(v41) as v41 from aggJoin973564958010069353 group by v24;
create or replace view aggJoin2845966502796379904 as select company_id as v17, company_type_id as v18, note as v19, v41 from movie_companies as mc, aggView4344513617527259149 where mc.movie_id=aggView4344513617527259149.v24;
create or replace view aggView2798325433055519823 as select id as v18 from company_type as ct where kind<> 'production companies';
create or replace view aggJoin1246177666134424595 as select v17, v19, v41 from aggJoin2845966502796379904 join aggView2798325433055519823 using(v18);
create or replace view aggView5773380824818077995 as select v17, MIN(v41) as v41, MIN(v19) as v40 from aggJoin1246177666134424595 group by v17;
create or replace view aggJoin3867447766376874020 as select name as v2, v41, v40 from company_name as cn, aggView5773380824818077995 where cn.id=aggView5773380824818077995.v17 and country_code<> '[pl]' and ((name LIKE '20th Century Fox%') OR (name LIKE 'Twentieth Century Fox%'));
create or replace view res as select MIN(v2) as v39, MIN(v40) as v40, MIN(v41) as v41 from aggJoin3867447766376874020;
select sum(v39+v40+v41) from res;