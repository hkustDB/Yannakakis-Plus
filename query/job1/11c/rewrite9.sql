create or replace view aggView1245343613168297062 as select id as v24, title as v41 from title as t where production_year>1950;
create or replace view aggJoin6325322523386257394 as select movie_id as v24, link_type_id as v13, v41 from movie_link as ml, aggView1245343613168297062 where ml.movie_id=aggView1245343613168297062.v24;
create or replace view aggView6003372467225294367 as select id as v17, name as v39 from company_name as cn where country_code<> '[pl]' and ((name LIKE '20th Century Fox%') OR (name LIKE 'Twentieth Century Fox%'));
create or replace view aggJoin3550799304460803398 as select movie_id as v24, company_type_id as v18, note as v19, v39 from movie_companies as mc, aggView6003372467225294367 where mc.company_id=aggView6003372467225294367.v17;
create or replace view aggView5120407989035648871 as select id as v18 from company_type as ct where kind<> 'production companies';
create or replace view aggJoin1757772528039749320 as select v24, v19, v39 from aggJoin3550799304460803398 join aggView5120407989035648871 using(v18);
create or replace view aggView4387839912620743028 as select v24, MIN(v39) as v39, MIN(v19) as v40 from aggJoin1757772528039749320 group by v24;
create or replace view aggJoin1042045833028440094 as select movie_id as v24, keyword_id as v22, v39, v40 from movie_keyword as mk, aggView4387839912620743028 where mk.movie_id=aggView4387839912620743028.v24;
create or replace view aggView8929010307050228568 as select id as v22 from keyword as k where keyword IN ('sequel','revenge','based-on-novel');
create or replace view aggJoin1897411739467604530 as select v24, v39, v40 from aggJoin1042045833028440094 join aggView8929010307050228568 using(v22);
create or replace view aggView6110454913776153325 as select v24, MIN(v39) as v39, MIN(v40) as v40 from aggJoin1897411739467604530 group by v24;
create or replace view aggJoin1321612637049608809 as select v13, v41 as v41, v39, v40 from aggJoin6325322523386257394 join aggView6110454913776153325 using(v24);
create or replace view aggView6970647279848605957 as select v13, MIN(v41) as v41, MIN(v39) as v39, MIN(v40) as v40 from aggJoin1321612637049608809 group by v13;
create or replace view aggJoin7285548772758945738 as select v41, v39, v40 from link_type as lt, aggView6970647279848605957 where lt.id=aggView6970647279848605957.v13;
create or replace view res as select MIN(v39) as v39, MIN(v40) as v40, MIN(v41) as v41 from aggJoin7285548772758945738;
select sum(v39+v40+v41) from res;