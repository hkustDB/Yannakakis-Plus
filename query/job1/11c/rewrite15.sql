create or replace view aggView4915284595749415551 as select id as v22 from keyword as k where keyword IN ('sequel','revenge','based-on-novel');
create or replace view aggJoin6177173605852377153 as select movie_id as v24 from movie_keyword as mk, aggView4915284595749415551 where mk.keyword_id=aggView4915284595749415551.v22;
create or replace view aggView7046019106028807055 as select v24 from aggJoin6177173605852377153 group by v24;
create or replace view aggJoin28409506717936542 as select movie_id as v24, link_type_id as v13 from movie_link as ml, aggView7046019106028807055 where ml.movie_id=aggView7046019106028807055.v24;
create or replace view aggView3855992270843139111 as select id as v13 from link_type as lt;
create or replace view aggJoin8523440451710524274 as select v24 from aggJoin28409506717936542 join aggView3855992270843139111 using(v13);
create or replace view aggView9212074377566109755 as select v24 from aggJoin8523440451710524274 group by v24;
create or replace view aggJoin6614429173726759609 as select id as v24, title as v28 from title as t, aggView9212074377566109755 where t.id=aggView9212074377566109755.v24 and production_year>1950;
create or replace view aggView289226143069752211 as select v24, MIN(v28) as v41 from aggJoin6614429173726759609 group by v24;
create or replace view aggJoin6347926908366606870 as select company_id as v17, company_type_id as v18, note as v19, v41 from movie_companies as mc, aggView289226143069752211 where mc.movie_id=aggView289226143069752211.v24;
create or replace view aggView6808554687020536973 as select id as v18 from company_type as ct where kind<> 'production companies';
create or replace view aggJoin998187749881775177 as select v17, v19, v41 from aggJoin6347926908366606870 join aggView6808554687020536973 using(v18);
create or replace view aggView8914681786648736290 as select v17, MIN(v41) as v41, MIN(v19) as v40 from aggJoin998187749881775177 group by v17;
create or replace view aggJoin2269253248416017473 as select name as v2, v41, v40 from company_name as cn, aggView8914681786648736290 where cn.id=aggView8914681786648736290.v17 and country_code<> '[pl]' and ((name LIKE '20th Century Fox%') OR (name LIKE 'Twentieth Century Fox%'));
select MIN(v2) as v39,MIN(v40) as v40,MIN(v41) as v41 from aggJoin2269253248416017473;
