create or replace view aggView4851796824145181724 as select id as v17, name as v39 from company_name as cn where country_code<> '[pl]' and ((name LIKE '20th Century Fox%') OR (name LIKE 'Twentieth Century Fox%'));
create or replace view aggJoin3767421008837427187 as select movie_id as v24, company_type_id as v18, note as v19, v39 from movie_companies as mc, aggView4851796824145181724 where mc.company_id=aggView4851796824145181724.v17;
create or replace view aggView7836834305382235915 as select id as v24, title as v41 from title as t where production_year>1950;
create or replace view aggJoin8161341118077123999 as select movie_id as v24, link_type_id as v13, v41 from movie_link as ml, aggView7836834305382235915 where ml.movie_id=aggView7836834305382235915.v24;
create or replace view aggView2209253631126008555 as select id as v22 from keyword as k where keyword IN ('sequel','revenge','based-on-novel');
create or replace view aggJoin5648254033732414582 as select movie_id as v24 from movie_keyword as mk, aggView2209253631126008555 where mk.keyword_id=aggView2209253631126008555.v22;
create or replace view aggView863830347085709081 as select v24 from aggJoin5648254033732414582 group by v24;
create or replace view aggJoin1761412073429359684 as select v24, v13, v41 as v41 from aggJoin8161341118077123999 join aggView863830347085709081 using(v24);
create or replace view aggView1100344057730472613 as select id as v13 from link_type as lt;
create or replace view aggJoin8068205923239609173 as select v24, v41 from aggJoin1761412073429359684 join aggView1100344057730472613 using(v13);
create or replace view aggView8565702800541663787 as select v24, MIN(v41) as v41 from aggJoin8068205923239609173 group by v24;
create or replace view aggJoin1678114067293034967 as select v18, v19, v39 as v39, v41 from aggJoin3767421008837427187 join aggView8565702800541663787 using(v24);
create or replace view aggView5304744566291283475 as select v18, MIN(v39) as v39, MIN(v41) as v41, MIN(v19) as v40 from aggJoin1678114067293034967 group by v18;
create or replace view aggJoin1769794545385680355 as select v39, v41, v40 from company_type as ct, aggView5304744566291283475 where ct.id=aggView5304744566291283475.v18 and kind<> 'production companies';
select MIN(v39) as v39,MIN(v40) as v40,MIN(v41) as v41 from aggJoin1769794545385680355;
