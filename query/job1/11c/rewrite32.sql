create or replace view aggView9104967565617154744 as select id as v17, name as v39 from company_name as cn where country_code<> '[pl]' and ((name LIKE '20th Century Fox%') OR (name LIKE 'Twentieth Century Fox%'));
create or replace view aggJoin8963657754734206652 as select movie_id as v24, company_type_id as v18, note as v19, v39 from movie_companies as mc, aggView9104967565617154744 where mc.company_id=aggView9104967565617154744.v17;
create or replace view aggView7569043433905924874 as select id as v13 from link_type as lt;
create or replace view aggJoin2215596090207085247 as select movie_id as v24 from movie_link as ml, aggView7569043433905924874 where ml.link_type_id=aggView7569043433905924874.v13;
create or replace view aggView2611379904842017149 as select v24 from aggJoin2215596090207085247 group by v24;
create or replace view aggJoin1488557277272636710 as select id as v24, title as v28 from title as t, aggView2611379904842017149 where t.id=aggView2611379904842017149.v24 and production_year>1950;
create or replace view aggView8690536416794226271 as select v24, MIN(v28) as v41 from aggJoin1488557277272636710 group by v24;
create or replace view aggJoin7950797132151013811 as select movie_id as v24, keyword_id as v22, v41 from movie_keyword as mk, aggView8690536416794226271 where mk.movie_id=aggView8690536416794226271.v24;
create or replace view aggView620165112749050457 as select id as v22 from keyword as k where keyword IN ('sequel','revenge','based-on-novel');
create or replace view aggJoin4181262886915882528 as select v24, v41 from aggJoin7950797132151013811 join aggView620165112749050457 using(v22);
create or replace view aggView6455025788310235219 as select v24, MIN(v41) as v41 from aggJoin4181262886915882528 group by v24;
create or replace view aggJoin4763915549698694651 as select v18, v19, v39 as v39, v41 from aggJoin8963657754734206652 join aggView6455025788310235219 using(v24);
create or replace view aggView3814465604986932668 as select v18, MIN(v39) as v39, MIN(v41) as v41, MIN(v19) as v40 from aggJoin4763915549698694651 group by v18;
create or replace view aggJoin8154141238430844380 as select v39, v41, v40 from company_type as ct, aggView3814465604986932668 where ct.id=aggView3814465604986932668.v18 and kind<> 'production companies';
create or replace view res as select MIN(v39) as v39, MIN(v40) as v40, MIN(v41) as v41 from aggJoin8154141238430844380;
select sum(v39+v40+v41) from res;