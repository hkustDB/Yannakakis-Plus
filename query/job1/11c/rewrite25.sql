create or replace view aggView442151412949258127 as select id as v17, name as v39 from company_name as cn where country_code<> '[pl]' and ((name LIKE '20th Century Fox%') OR (name LIKE 'Twentieth Century Fox%'));
create or replace view aggJoin7657083821695798 as select movie_id as v24, company_type_id as v18, note as v19, v39 from movie_companies as mc, aggView442151412949258127 where mc.company_id=aggView442151412949258127.v17;
create or replace view aggView4433566216198302557 as select id as v22 from keyword as k where keyword IN ('sequel','revenge','based-on-novel');
create or replace view aggJoin2104823422962828352 as select movie_id as v24 from movie_keyword as mk, aggView4433566216198302557 where mk.keyword_id=aggView4433566216198302557.v22;
create or replace view aggView8585600406357488439 as select v24 from aggJoin2104823422962828352 group by v24;
create or replace view aggJoin8198257421117651201 as select movie_id as v24, link_type_id as v13 from movie_link as ml, aggView8585600406357488439 where ml.movie_id=aggView8585600406357488439.v24;
create or replace view aggView4871293772342804910 as select id as v13 from link_type as lt;
create or replace view aggJoin1456396787534203057 as select v24 from aggJoin8198257421117651201 join aggView4871293772342804910 using(v13);
create or replace view aggView8376745323965258698 as select v24 from aggJoin1456396787534203057 group by v24;
create or replace view aggJoin5317963364018995231 as select id as v24, title as v28 from title as t, aggView8376745323965258698 where t.id=aggView8376745323965258698.v24 and production_year>1950;
create or replace view aggView5443370469115086359 as select id as v18 from company_type as ct where kind<> 'production companies';
create or replace view aggJoin321155759444089765 as select v24, v19, v39 from aggJoin7657083821695798 join aggView5443370469115086359 using(v18);
create or replace view aggView8735903288063496706 as select v24, MIN(v39) as v39, MIN(v19) as v40 from aggJoin321155759444089765 group by v24;
create or replace view aggJoin7688334956632327185 as select v28, v39, v40 from aggJoin5317963364018995231 join aggView8735903288063496706 using(v24);
select MIN(v39) as v39,MIN(v40) as v40,MIN(v28) as v41 from aggJoin7688334956632327185;
