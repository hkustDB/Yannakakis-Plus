create or replace view aggView4307418352681620094 as select id as v22 from keyword as k where keyword IN ('sequel','revenge','based-on-novel');
create or replace view aggJoin762709344081778648 as select movie_id as v24 from movie_keyword as mk, aggView4307418352681620094 where mk.keyword_id=aggView4307418352681620094.v22;
create or replace view aggView5929792856942480950 as select id as v13 from link_type as lt;
create or replace view aggJoin1597856191611740856 as select movie_id as v24 from movie_link as ml, aggView5929792856942480950 where ml.link_type_id=aggView5929792856942480950.v13;
create or replace view aggView1926547922741508444 as select v24 from aggJoin1597856191611740856 group by v24;
create or replace view aggJoin531030703260874857 as select v24 from aggJoin762709344081778648 join aggView1926547922741508444 using(v24);
create or replace view aggView9066279635702166205 as select v24 from aggJoin531030703260874857 group by v24;
create or replace view aggJoin3575304736994830540 as select id as v24, title as v28 from title as t, aggView9066279635702166205 where t.id=aggView9066279635702166205.v24 and production_year>1950;
create or replace view aggView1627172105793535979 as select v24, MIN(v28) as v41 from aggJoin3575304736994830540 group by v24;
create or replace view aggJoin3456497534906737634 as select company_id as v17, company_type_id as v18, note as v19, v41 from movie_companies as mc, aggView1627172105793535979 where mc.movie_id=aggView1627172105793535979.v24;
create or replace view aggView9162053354841421635 as select id as v18 from company_type as ct where kind<> 'production companies';
create or replace view aggJoin8975021542632849741 as select v17, v19, v41 from aggJoin3456497534906737634 join aggView9162053354841421635 using(v18);
create or replace view aggView263663442315666382 as select v17, MIN(v41) as v41, MIN(v19) as v40 from aggJoin8975021542632849741 group by v17;
create or replace view aggJoin3395072064959247094 as select name as v2, v41, v40 from company_name as cn, aggView263663442315666382 where cn.id=aggView263663442315666382.v17 and country_code<> '[pl]' and ((name LIKE '20th Century Fox%') OR (name LIKE 'Twentieth Century Fox%'));
create or replace view res as select MIN(v2) as v39, MIN(v40) as v40, MIN(v41) as v41 from aggJoin3395072064959247094;
select sum(v39+v40+v41) from res;