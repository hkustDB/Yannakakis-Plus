create or replace view aggView5249109577747491085 as select id as v1, name as v41 from company_name as cn where country_code= '[us]';
create or replace view aggJoin1835953123619072502 as select movie_id as v29, company_type_id as v8, v41 from movie_companies as mc, aggView5249109577747491085 where mc.company_id=aggView5249109577747491085.v1;
create or replace view aggView7781870408912373988 as select id as v29, title as v43 from title as t where production_year>=2000 and production_year<=2010;
create or replace view aggJoin7621936712970236311 as select movie_id as v29, info_type_id as v21, info as v22, v43 from movie_info as mi, aggView7781870408912373988 where mi.movie_id=aggView7781870408912373988.v29 and info IN ('Drama','Horror','Western','Family');
create or replace view aggView3564109713386255297 as select id as v21 from info_type as it1 where info= 'genres';
create or replace view aggJoin6758049034997203720 as select v29, v22, v43 from aggJoin7621936712970236311 join aggView3564109713386255297 using(v21);
create or replace view aggView7201703264838808585 as select id as v8 from company_type as ct where kind= 'production companies';
create or replace view aggJoin3040713916805803289 as select v29, v41 from aggJoin1835953123619072502 join aggView7201703264838808585 using(v8);
create or replace view aggView4465916211286562603 as select id as v26 from info_type as it2 where info= 'rating';
create or replace view aggJoin6049632802323104989 as select movie_id as v29, info as v27 from movie_info_idx as mi_idx, aggView4465916211286562603 where mi_idx.info_type_id=aggView4465916211286562603.v26 and info>'7.0';
create or replace view aggView888860360972804146 as select v29, MIN(v27) as v42 from aggJoin6049632802323104989 group by v29;
create or replace view aggJoin341096436276753290 as select v29, v43 as v43, v42 from aggJoin6758049034997203720 join aggView888860360972804146 using(v29);
create or replace view aggView7225187579491736512 as select v29, MIN(v41) as v41 from aggJoin3040713916805803289 group by v29;
create or replace view aggJoin5415530051674981874 as select v43 as v43, v42 as v42, v41 from aggJoin341096436276753290 join aggView7225187579491736512 using(v29);
select MIN(v41) as v41,MIN(v42) as v42,MIN(v43) as v43 from aggJoin5415530051674981874;
