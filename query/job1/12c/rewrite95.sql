create or replace view aggView5767926879593388561 as select id as v29, title as v43 from title as t where production_year>=2000 and production_year<=2010;
create or replace view aggJoin4039930264664521147 as select movie_id as v29, company_id as v1, company_type_id as v8, v43 from movie_companies as mc, aggView5767926879593388561 where mc.movie_id=aggView5767926879593388561.v29;
create or replace view aggView5987804860955349222 as select id as v1, name as v41 from company_name as cn where country_code= '[us]';
create or replace view aggJoin337271061015027472 as select v29, v8, v43 from aggJoin4039930264664521147 join aggView5987804860955349222 using(v1);
create or replace view aggView8527769215984291390 as select id as v8 from company_type as ct where kind= 'production companies';
create or replace view aggJoin5629203064421646421 as select v29, v43 from aggJoin337271061015027472 join aggView8527769215984291390 using(v8);
create or replace view aggView77096043529246343 as select id as v26 from info_type as it2 where info= 'rating';
create or replace view aggJoin5970843506925273593 as select movie_id as v29, info as v27 from movie_info_idx as mi_idx, aggView77096043529246343 where mi_idx.info_type_id=aggView77096043529246343.v26 and info>'7.0';
create or replace view aggView4237015047376031174 as select v29, MIN(v27) as v42 from aggJoin5970843506925273593 group by v29;
create or replace view aggJoin5895864876408070370 as select movie_id as v29, info_type_id as v21, v42 from movie_info as mi, aggView4237015047376031174 where mi.movie_id=aggView4237015047376031174.v29 and info IN ('Drama','Horror','Western','Family');
create or replace view aggView9133977311909803363 as select v29, MIN(v43) as v43 from aggJoin5629203064421646421 group by v29;
create or replace view aggJoin3566968522138029290 as select v21, v42 as v42, v43 from aggJoin5895864876408070370 join aggView9133977311909803363 using(v29);
create or replace view aggView1151802152893446509 as select v21, MIN(v42) as v42, MIN(v43) as v43 from aggJoin3566968522138029290 group by v21;
create or replace view aggJoin6424383639472597115 as select v42, v43 from info_type as it1, aggView1151802152893446509 where it1.id=aggView1151802152893446509.v21 and info= 'genres';
select MIN(v41) as v41,MIN(v42) as v42,MIN(v43) as v43 from aggJoin6424383639472597115;
