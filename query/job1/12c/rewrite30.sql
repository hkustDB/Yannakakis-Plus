create or replace view aggView911878170131678451 as select id as v1, name as v41 from company_name as cn where country_code= '[us]';
create or replace view aggJoin2940766693838410081 as select movie_id as v29, company_type_id as v8, v41 from movie_companies as mc, aggView911878170131678451 where mc.company_id=aggView911878170131678451.v1;
create or replace view aggView6094480488167526102 as select id as v21 from info_type as it1 where info= 'genres';
create or replace view aggJoin7611688007932289286 as select movie_id as v29, info as v22 from movie_info as mi, aggView6094480488167526102 where mi.info_type_id=aggView6094480488167526102.v21 and info IN ('Drama','Horror','Western','Family');
create or replace view aggView6079561991193048847 as select v29 from aggJoin7611688007932289286 group by v29;
create or replace view aggJoin4958830894715626133 as select id as v29, title as v30 from title as t, aggView6079561991193048847 where t.id=aggView6079561991193048847.v29 and production_year>=2000 and production_year<=2010;
create or replace view aggView769836471489587415 as select id as v8 from company_type as ct where kind= 'production companies';
create or replace view aggJoin3994537112764316543 as select v29, v41 from aggJoin2940766693838410081 join aggView769836471489587415 using(v8);
create or replace view aggView6589850330429041995 as select v29, MIN(v41) as v41 from aggJoin3994537112764316543 group by v29;
create or replace view aggJoin4121290476807188028 as select v29, v30, v41 from aggJoin4958830894715626133 join aggView6589850330429041995 using(v29);
create or replace view aggView5958393294221228442 as select v29, MIN(v41) as v41, MIN(v30) as v43 from aggJoin4121290476807188028 group by v29;
create or replace view aggJoin9047719524496647662 as select info_type_id as v26, info as v27, v41, v43 from movie_info_idx as mi_idx, aggView5958393294221228442 where mi_idx.movie_id=aggView5958393294221228442.v29 and info>'7.0';
create or replace view aggView3017075491581915934 as select id as v26 from info_type as it2 where info= 'rating';
create or replace view aggJoin8799541824599854982 as select v27, v41, v43 from aggJoin9047719524496647662 join aggView3017075491581915934 using(v26);
select MIN(v41) as v41,MIN(v27) as v42,MIN(v43) as v43 from aggJoin8799541824599854982;
