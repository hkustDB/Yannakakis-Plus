create or replace view aggView1964860558369712333 as select id as v21 from info_type as it1 where info= 'genres';
create or replace view aggJoin4129120392898928810 as select movie_id as v29, info as v22 from movie_info as mi, aggView1964860558369712333 where mi.info_type_id=aggView1964860558369712333.v21 and info IN ('Drama','Horror','Western','Family');
create or replace view aggView4732074505769511538 as select v29 from aggJoin4129120392898928810 group by v29;
create or replace view aggJoin8909615558191639234 as select id as v29, title as v30 from title as t, aggView4732074505769511538 where t.id=aggView4732074505769511538.v29 and production_year>=2000 and production_year<=2010;
create or replace view aggView1908674750665195856 as select id as v26 from info_type as it2 where info= 'rating';
create or replace view aggJoin6897490146276804476 as select movie_id as v29, info as v27 from movie_info_idx as mi_idx, aggView1908674750665195856 where mi_idx.info_type_id=aggView1908674750665195856.v26 and info>'7.0';
create or replace view aggView7608874089103114391 as select v29, MIN(v27) as v42 from aggJoin6897490146276804476 group by v29;
create or replace view aggJoin1927846345873102233 as select v29, v30, v42 from aggJoin8909615558191639234 join aggView7608874089103114391 using(v29);
create or replace view aggView6610373791733250395 as select v29, MIN(v42) as v42, MIN(v30) as v43 from aggJoin1927846345873102233 group by v29;
create or replace view aggJoin7560866117121494488 as select company_id as v1, company_type_id as v8, v42, v43 from movie_companies as mc, aggView6610373791733250395 where mc.movie_id=aggView6610373791733250395.v29;
create or replace view aggView6130980984781755869 as select id as v8 from company_type as ct where kind= 'production companies';
create or replace view aggJoin4414380893001180091 as select v1, v42, v43 from aggJoin7560866117121494488 join aggView6130980984781755869 using(v8);
create or replace view aggView252007734084848406 as select v1, MIN(v42) as v42, MIN(v43) as v43 from aggJoin4414380893001180091 group by v1;
create or replace view aggJoin321966972996183678 as select name as v2, v42, v43 from company_name as cn, aggView252007734084848406 where cn.id=aggView252007734084848406.v1 and country_code= '[us]';
create or replace view res as select MIN(v2) as v41, MIN(v42) as v42, MIN(v43) as v43 from aggJoin321966972996183678;
select sum(v41+v42+v43) from res;