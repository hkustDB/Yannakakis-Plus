create or replace view aggView7183085608037231544 as select id as v1, name as v41 from company_name as cn where country_code= '[us]';
create or replace view aggJoin1995284004285624898 as select movie_id as v29, company_type_id as v8, v41 from movie_companies as mc, aggView7183085608037231544 where mc.company_id=aggView7183085608037231544.v1;
create or replace view aggView3198823835818678273 as select id as v21 from info_type as it1 where info= 'genres';
create or replace view aggJoin5903199167767510119 as select movie_id as v29, info as v22 from movie_info as mi, aggView3198823835818678273 where mi.info_type_id=aggView3198823835818678273.v21 and info IN ('Drama','Horror','Western','Family');
create or replace view aggView5500042634527738391 as select id as v26 from info_type as it2 where info= 'rating';
create or replace view aggJoin7205429603493619307 as select movie_id as v29, info as v27 from movie_info_idx as mi_idx, aggView5500042634527738391 where mi_idx.info_type_id=aggView5500042634527738391.v26 and info>'7.0';
create or replace view aggView8815050299125818038 as select v29, MIN(v27) as v42 from aggJoin7205429603493619307 group by v29;
create or replace view aggJoin693277375512109245 as select id as v29, title as v30, v42 from title as t, aggView8815050299125818038 where t.id=aggView8815050299125818038.v29 and production_year>=2000 and production_year<=2010;
create or replace view aggView3922771551674934381 as select v29, MIN(v42) as v42, MIN(v30) as v43 from aggJoin693277375512109245 group by v29;
create or replace view aggJoin4069578927073847309 as select v29, v8, v41 as v41, v42, v43 from aggJoin1995284004285624898 join aggView3922771551674934381 using(v29);
create or replace view aggView8535727174237202461 as select v29 from aggJoin5903199167767510119 group by v29;
create or replace view aggJoin83946021983874516 as select v8, v41 as v41, v42 as v42, v43 as v43 from aggJoin4069578927073847309 join aggView8535727174237202461 using(v29);
create or replace view aggView6131978705210471727 as select v8, MIN(v41) as v41, MIN(v42) as v42, MIN(v43) as v43 from aggJoin83946021983874516 group by v8;
create or replace view aggJoin1824884867431521772 as select v41, v42, v43 from company_type as ct, aggView6131978705210471727 where ct.id=aggView6131978705210471727.v8 and kind= 'production companies';
select MIN(v41) as v41,MIN(v42) as v42,MIN(v43) as v43 from aggJoin1824884867431521772;
