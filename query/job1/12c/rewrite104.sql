create or replace view aggView8802064281400822432 as select id as v1, name as v41 from company_name as cn where country_code= '[us]';
create or replace view aggJoin8745968425394346457 as select movie_id as v29, company_type_id as v8, v41 from movie_companies as mc, aggView8802064281400822432 where mc.company_id=aggView8802064281400822432.v1;
create or replace view aggView3740909107466048595 as select id as v29, title as v43 from title as t where production_year>=2000 and production_year<=2010;
create or replace view aggJoin5760234668184240048 as select movie_id as v29, info_type_id as v21, info as v22, v43 from movie_info as mi, aggView3740909107466048595 where mi.movie_id=aggView3740909107466048595.v29 and info IN ('Drama','Horror','Western','Family');
create or replace view aggView4749728482150512020 as select id as v8 from company_type as ct where kind= 'production companies';
create or replace view aggJoin4354511219290726977 as select v29, v41 from aggJoin8745968425394346457 join aggView4749728482150512020 using(v8);
create or replace view aggView7207682556831590154 as select id as v26 from info_type as it2 where info= 'rating';
create or replace view aggJoin7340166363829592835 as select movie_id as v29, info as v27 from movie_info_idx as mi_idx, aggView7207682556831590154 where mi_idx.info_type_id=aggView7207682556831590154.v26 and info>'7.0';
create or replace view aggView7682713200094901215 as select v29, MIN(v27) as v42 from aggJoin7340166363829592835 group by v29;
create or replace view aggJoin871665827698137232 as select v29, v41 as v41, v42 from aggJoin4354511219290726977 join aggView7682713200094901215 using(v29);
create or replace view aggView1683788989642665058 as select v29, MIN(v41) as v41, MIN(v42) as v42 from aggJoin871665827698137232 group by v29;
create or replace view aggJoin5030077890595646880 as select v21, v43 as v43, v41, v42 from aggJoin5760234668184240048 join aggView1683788989642665058 using(v29);
create or replace view aggView6019655802012548184 as select v21, MIN(v43) as v43, MIN(v41) as v41, MIN(v42) as v42 from aggJoin5030077890595646880 group by v21;
create or replace view aggJoin6741815886706975684 as select v43, v41, v42 from info_type as it1, aggView6019655802012548184 where it1.id=aggView6019655802012548184.v21 and info= 'genres';
select MIN(v41) as v41,MIN(v42) as v42,MIN(v43) as v43 from aggJoin6741815886706975684;
