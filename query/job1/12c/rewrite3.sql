create or replace view aggView4970231705415327559 as select id as v1, name as v2 from company_name as cn where country_code= '[us]';
create or replace view aggView2807822222545565590 as select id as v29, title as v30 from title as t where production_year>=2000 and production_year<=2010;
create or replace view aggView5517829656810448368 as select id as v21 from info_type as it1 where info= 'genres';
create or replace view aggJoin3542781098582898687 as select movie_id as v29, info as v22 from movie_info as mi, aggView5517829656810448368 where mi.info_type_id=aggView5517829656810448368.v21 and info IN ('Drama','Horror','Western','Family');
create or replace view aggView6992115107944016837 as select id as v26 from info_type as it2 where info= 'rating';
create or replace view aggJoin6517981681116197409 as select movie_id as v29, info as v27 from movie_info_idx as mi_idx, aggView6992115107944016837 where mi_idx.info_type_id=aggView6992115107944016837.v26 and info>'7.0';
create or replace view aggView3680074016103076598 as select v29 from aggJoin3542781098582898687 group by v29;
create or replace view aggJoin935028068847604259 as select v29, v27 from aggJoin6517981681116197409 join aggView3680074016103076598 using(v29);
create or replace view aggView2538890598306770178 as select v29, v27 from aggJoin935028068847604259;
create or replace view aggView6148389632274910735 as select v1, MIN(v2) as v41 from aggView4970231705415327559 group by v1;
create or replace view aggJoin2586089296592213182 as select movie_id as v29, company_type_id as v8, v41 from movie_companies as mc, aggView6148389632274910735 where mc.company_id=aggView6148389632274910735.v1;
create or replace view aggView5983745368292452014 as select id as v8 from company_type as ct where kind= 'production companies';
create or replace view aggJoin4527306024484274939 as select v29, v41 from aggJoin2586089296592213182 join aggView5983745368292452014 using(v8);
create or replace view aggView8358758626119187275 as select v29, MIN(v41) as v41 from aggJoin4527306024484274939 group by v29;
create or replace view aggJoin7191651575011886727 as select v29, v30, v41 from aggView2807822222545565590 join aggView8358758626119187275 using(v29);
create or replace view aggView6055486785777989854 as select v29, MIN(v41) as v41, MIN(v30) as v43 from aggJoin7191651575011886727 group by v29;
create or replace view aggJoin5350069049594561116 as select v27, v41, v43 from aggView2538890598306770178 join aggView6055486785777989854 using(v29);
select MIN(v41) as v41,MIN(v27) as v42,MIN(v43) as v43 from aggJoin5350069049594561116;
