create or replace view aggView591960457427189687 as select id as v1, name as v41 from company_name as cn where country_code= '[us]';
create or replace view aggJoin8742369114265618756 as select movie_id as v29, company_type_id as v8, v41 from movie_companies as mc, aggView591960457427189687 where mc.company_id=aggView591960457427189687.v1;
create or replace view aggView3698358196009656914 as select id as v29, title as v43 from title as t where production_year>=2000 and production_year<=2010;
create or replace view aggJoin4017087912524671619 as select movie_id as v29, info_type_id as v26, info as v27, v43 from movie_info_idx as mi_idx, aggView3698358196009656914 where mi_idx.movie_id=aggView3698358196009656914.v29 and info>'7.0';
create or replace view aggView2530661445918473778 as select id as v21 from info_type as it1 where info= 'genres';
create or replace view aggJoin8932463683506630701 as select movie_id as v29, info as v22 from movie_info as mi, aggView2530661445918473778 where mi.info_type_id=aggView2530661445918473778.v21 and info IN ('Drama','Horror','Western','Family');
create or replace view aggView2945466332537686564 as select v29 from aggJoin8932463683506630701 group by v29;
create or replace view aggJoin798752406444221145 as select v29, v26, v27, v43 as v43 from aggJoin4017087912524671619 join aggView2945466332537686564 using(v29);
create or replace view aggView9136246523194794821 as select id as v26 from info_type as it2 where info= 'rating';
create or replace view aggJoin8814993658577081382 as select v29, v27, v43 from aggJoin798752406444221145 join aggView9136246523194794821 using(v26);
create or replace view aggView5069140063381657607 as select v29, MIN(v43) as v43, MIN(v27) as v42 from aggJoin8814993658577081382 group by v29;
create or replace view aggJoin5552745351091928772 as select v8, v41 as v41, v43, v42 from aggJoin8742369114265618756 join aggView5069140063381657607 using(v29);
create or replace view aggView8613973428919866670 as select id as v8 from company_type as ct where kind= 'production companies';
create or replace view aggJoin3360360202152638406 as select v41, v43, v42 from aggJoin5552745351091928772 join aggView8613973428919866670 using(v8);
select MIN(v41) as v41,MIN(v42) as v42,MIN(v43) as v43 from aggJoin3360360202152638406;
