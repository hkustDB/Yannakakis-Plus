create or replace view aggView2514679917256762802 as select id as v1, name as v41 from company_name as cn where country_code= '[us]';
create or replace view aggJoin5043152102266242260 as select movie_id as v29, company_type_id as v8, v41 from movie_companies as mc, aggView2514679917256762802 where mc.company_id=aggView2514679917256762802.v1;
create or replace view aggView2588326891845830539 as select id as v29, title as v43 from title as t where production_year>=2000 and production_year<=2010;
create or replace view aggJoin617177261067019492 as select movie_id as v29, info_type_id as v21, info as v22, v43 from movie_info as mi, aggView2588326891845830539 where mi.movie_id=aggView2588326891845830539.v29 and info IN ('Drama','Horror','Western','Family');
create or replace view aggView4130282358621733433 as select id as v21 from info_type as it1 where info= 'genres';
create or replace view aggJoin5994632194052502187 as select v29, v22, v43 from aggJoin617177261067019492 join aggView4130282358621733433 using(v21);
create or replace view aggView5244874087232846520 as select v29, MIN(v43) as v43 from aggJoin5994632194052502187 group by v29;
create or replace view aggJoin6544199389940861286 as select movie_id as v29, info_type_id as v26, info as v27, v43 from movie_info_idx as mi_idx, aggView5244874087232846520 where mi_idx.movie_id=aggView5244874087232846520.v29 and info>'7.0';
create or replace view aggView6392331166163973725 as select id as v8 from company_type as ct where kind= 'production companies';
create or replace view aggJoin3858983367655322052 as select v29, v41 from aggJoin5043152102266242260 join aggView6392331166163973725 using(v8);
create or replace view aggView4263141052996946830 as select v29, MIN(v41) as v41 from aggJoin3858983367655322052 group by v29;
create or replace view aggJoin2918907310352994214 as select v26, v27, v43 as v43, v41 from aggJoin6544199389940861286 join aggView4263141052996946830 using(v29);
create or replace view aggView2371052164329563274 as select id as v26 from info_type as it2 where info= 'rating';
create or replace view aggJoin7456530995314032751 as select v27, v43, v41 from aggJoin2918907310352994214 join aggView2371052164329563274 using(v26);
select MIN(v41) as v41,MIN(v27) as v42,MIN(v43) as v43 from aggJoin7456530995314032751;
