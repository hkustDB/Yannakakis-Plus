create or replace view aggView8555528173488130121 as select id as v1, name as v41 from company_name as cn where country_code= '[us]';
create or replace view aggJoin2942709706057763391 as select movie_id as v29, company_type_id as v8, v41 from movie_companies as mc, aggView8555528173488130121 where mc.company_id=aggView8555528173488130121.v1;
create or replace view aggView6293204844174438683 as select id as v21 from info_type as it1 where info= 'genres';
create or replace view aggJoin3366942491739830008 as select movie_id as v29, info as v22 from movie_info as mi, aggView6293204844174438683 where mi.info_type_id=aggView6293204844174438683.v21 and info IN ('Drama','Horror','Western','Family');
create or replace view aggView1767366682877970802 as select v29 from aggJoin3366942491739830008 group by v29;
create or replace view aggJoin1414773336679700667 as select id as v29, title as v30 from title as t, aggView1767366682877970802 where t.id=aggView1767366682877970802.v29 and production_year>=2000 and production_year<=2010;
create or replace view aggView4872887237193786194 as select id as v26 from info_type as it2 where info= 'rating';
create or replace view aggJoin8614399079067754378 as select movie_id as v29, info as v27 from movie_info_idx as mi_idx, aggView4872887237193786194 where mi_idx.info_type_id=aggView4872887237193786194.v26 and info>'7.0';
create or replace view aggView8112216578338476324 as select v29, MIN(v27) as v42 from aggJoin8614399079067754378 group by v29;
create or replace view aggJoin405914891491636741 as select v29, v30, v42 from aggJoin1414773336679700667 join aggView8112216578338476324 using(v29);
create or replace view aggView4320025902582904562 as select v29, MIN(v42) as v42, MIN(v30) as v43 from aggJoin405914891491636741 group by v29;
create or replace view aggJoin8236093377768422558 as select v8, v41 as v41, v42, v43 from aggJoin2942709706057763391 join aggView4320025902582904562 using(v29);
create or replace view aggView2151250311980731832 as select id as v8 from company_type as ct where kind= 'production companies';
create or replace view aggJoin49137462597105008 as select v41, v42, v43 from aggJoin8236093377768422558 join aggView2151250311980731832 using(v8);
select MIN(v41) as v41,MIN(v42) as v42,MIN(v43) as v43 from aggJoin49137462597105008;
