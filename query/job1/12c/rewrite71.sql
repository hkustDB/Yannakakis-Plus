create or replace view aggView3634578036033100531 as select id as v29, title as v43 from title as t where production_year>=2000 and production_year<=2010;
create or replace view aggJoin5367425019164713655 as select movie_id as v29, info_type_id as v26, info as v27, v43 from movie_info_idx as mi_idx, aggView3634578036033100531 where mi_idx.movie_id=aggView3634578036033100531.v29 and info>'7.0';
create or replace view aggView4914391774721875648 as select id as v1, name as v41 from company_name as cn where country_code= '[us]';
create or replace view aggJoin3841966627627633888 as select movie_id as v29, company_type_id as v8, v41 from movie_companies as mc, aggView4914391774721875648 where mc.company_id=aggView4914391774721875648.v1;
create or replace view aggView4255500122969634214 as select id as v8 from company_type as ct where kind= 'production companies';
create or replace view aggJoin1058503181836534705 as select v29, v41 from aggJoin3841966627627633888 join aggView4255500122969634214 using(v8);
create or replace view aggView3948779542938148843 as select id as v26 from info_type as it2 where info= 'rating';
create or replace view aggJoin5732737027792071505 as select v29, v27, v43 from aggJoin5367425019164713655 join aggView3948779542938148843 using(v26);
create or replace view aggView5474359417543748216 as select v29, MIN(v41) as v41 from aggJoin1058503181836534705 group by v29;
create or replace view aggJoin4452172994838586608 as select v29, v27, v43 as v43, v41 from aggJoin5732737027792071505 join aggView5474359417543748216 using(v29);
create or replace view aggView4772926554142156988 as select v29, MIN(v43) as v43, MIN(v41) as v41, MIN(v27) as v42 from aggJoin4452172994838586608 group by v29;
create or replace view aggJoin5597428763773856802 as select info_type_id as v21, v43, v41, v42 from movie_info as mi, aggView4772926554142156988 where mi.movie_id=aggView4772926554142156988.v29 and info IN ('Drama','Horror','Western','Family');
create or replace view aggView863546783249288256 as select v21, MIN(v43) as v43, MIN(v41) as v41, MIN(v42) as v42 from aggJoin5597428763773856802 group by v21;
create or replace view aggJoin4866895717845925974 as select v43, v41, v42 from info_type as it1, aggView863546783249288256 where it1.id=aggView863546783249288256.v21 and info= 'genres';
create or replace view res as select MIN(v41) as v41, MIN(v42) as v42, MIN(v43) as v43 from aggJoin4866895717845925974;
select sum(v41+v42+v43) from res;