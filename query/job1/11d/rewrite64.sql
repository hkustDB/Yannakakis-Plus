create or replace view aggView7027615258988770968 as select id as v22 from keyword as k where keyword IN ('sequel','revenge','based-on-novel');
create or replace view aggJoin6646391755074243437 as select movie_id as v24 from movie_keyword as mk, aggView7027615258988770968 where mk.keyword_id=aggView7027615258988770968.v22;
create or replace view aggView6161460498450773178 as select v24 from aggJoin6646391755074243437 group by v24;
create or replace view aggJoin6413829356797693913 as select id as v24, title as v28 from title as t, aggView6161460498450773178 where t.id=aggView6161460498450773178.v24 and production_year>1950;
create or replace view aggView3835577983982545313 as select v24, MIN(v28) as v41 from aggJoin6413829356797693913 group by v24;
create or replace view aggJoin7797060525042330677 as select movie_id as v24, company_id as v17, company_type_id as v18, note as v19, v41 from movie_companies as mc, aggView3835577983982545313 where mc.movie_id=aggView3835577983982545313.v24;
create or replace view aggView2910356206897119317 as select id as v13 from link_type as lt;
create or replace view aggJoin8885631524637966071 as select movie_id as v24 from movie_link as ml, aggView2910356206897119317 where ml.link_type_id=aggView2910356206897119317.v13;
create or replace view aggView4084187157481835435 as select v24 from aggJoin8885631524637966071 group by v24;
create or replace view aggJoin1514097628448329579 as select v17, v18, v19, v41 as v41 from aggJoin7797060525042330677 join aggView4084187157481835435 using(v24);
create or replace view aggView4550322641059600556 as select id as v18 from company_type as ct where kind<> 'production companies';
create or replace view aggJoin1753038559709054496 as select v17, v19, v41 from aggJoin1514097628448329579 join aggView4550322641059600556 using(v18);
create or replace view aggView2305411549402847385 as select v17, MIN(v41) as v41, MIN(v19) as v40 from aggJoin1753038559709054496 group by v17;
create or replace view aggJoin2514812186285415983 as select name as v2, v41, v40 from company_name as cn, aggView2305411549402847385 where cn.id=aggView2305411549402847385.v17 and country_code<> '[pl]';
select MIN(v2) as v39,MIN(v40) as v40,MIN(v41) as v41 from aggJoin2514812186285415983;
