create or replace view aggView1302839377659831991 as select id as v24, title as v41 from title as t where production_year>1950;
create or replace view aggJoin8706684808520555647 as select movie_id as v24, keyword_id as v22, v41 from movie_keyword as mk, aggView1302839377659831991 where mk.movie_id=aggView1302839377659831991.v24;
create or replace view aggView7743135421051636773 as select id as v22 from keyword as k where keyword IN ('sequel','revenge','based-on-novel');
create or replace view aggJoin9066989506723382795 as select v24, v41 from aggJoin8706684808520555647 join aggView7743135421051636773 using(v22);
create or replace view aggView5189764765220707253 as select v24, MIN(v41) as v41 from aggJoin9066989506723382795 group by v24;
create or replace view aggJoin2789901385257387410 as select movie_id as v24, link_type_id as v13, v41 from movie_link as ml, aggView5189764765220707253 where ml.movie_id=aggView5189764765220707253.v24;
create or replace view aggView3941390931749853252 as select id as v13 from link_type as lt;
create or replace view aggJoin5843673299213869981 as select v24, v41 from aggJoin2789901385257387410 join aggView3941390931749853252 using(v13);
create or replace view aggView7674181992396112632 as select v24, MIN(v41) as v41 from aggJoin5843673299213869981 group by v24;
create or replace view aggJoin853335237648029345 as select company_id as v17, company_type_id as v18, note as v19, v41 from movie_companies as mc, aggView7674181992396112632 where mc.movie_id=aggView7674181992396112632.v24;
create or replace view aggView1142097988216509625 as select id as v18 from company_type as ct where kind<> 'production companies';
create or replace view aggJoin7860916070383684504 as select v17, v19, v41 from aggJoin853335237648029345 join aggView1142097988216509625 using(v18);
create or replace view aggView410611113170971605 as select v17, MIN(v41) as v41, MIN(v19) as v40 from aggJoin7860916070383684504 group by v17;
create or replace view aggJoin8556644840374382224 as select name as v2, v41, v40 from company_name as cn, aggView410611113170971605 where cn.id=aggView410611113170971605.v17 and country_code<> '[pl]';
select MIN(v2) as v39,MIN(v40) as v40,MIN(v41) as v41 from aggJoin8556644840374382224;
