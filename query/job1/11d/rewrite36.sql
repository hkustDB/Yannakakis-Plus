create or replace view aggView1791624796921290176 as select id as v17, name as v39 from company_name as cn where country_code<> '[pl]';
create or replace view aggJoin680306174434580130 as select movie_id as v24, company_type_id as v18, note as v19, v39 from movie_companies as mc, aggView1791624796921290176 where mc.company_id=aggView1791624796921290176.v17;
create or replace view aggView7675436302995310705 as select id as v22 from keyword as k where keyword IN ('sequel','revenge','based-on-novel');
create or replace view aggJoin6943088837824405388 as select movie_id as v24 from movie_keyword as mk, aggView7675436302995310705 where mk.keyword_id=aggView7675436302995310705.v22;
create or replace view aggView8243526822541984019 as select id as v18 from company_type as ct where kind<> 'production companies';
create or replace view aggJoin6081408589771585767 as select v24, v19, v39 from aggJoin680306174434580130 join aggView8243526822541984019 using(v18);
create or replace view aggView6663082301873416434 as select v24, MIN(v39) as v39, MIN(v19) as v40 from aggJoin6081408589771585767 group by v24,v39;
create or replace view aggJoin856147652746421441 as select v24, v39, v40 from aggJoin6943088837824405388 join aggView6663082301873416434 using(v24);
create or replace view aggView8052158302383571270 as select id as v13 from link_type as lt;
create or replace view aggJoin3051028382516001276 as select movie_id as v24 from movie_link as ml, aggView8052158302383571270 where ml.link_type_id=aggView8052158302383571270.v13;
create or replace view aggView9178386561439263472 as select v24 from aggJoin3051028382516001276 group by v24;
create or replace view aggJoin835468508921955812 as select id as v24, title as v28, production_year as v31 from title as t, aggView9178386561439263472 where t.id=aggView9178386561439263472.v24 and production_year>1950;
create or replace view aggView5667970070053061318 as select v24, MIN(v28) as v41 from aggJoin835468508921955812 group by v24;
create or replace view aggJoin4989691176536194007 as select v39 as v39, v40 as v40, v41 from aggJoin856147652746421441 join aggView5667970070053061318 using(v24);
select MIN(v39) as v39,MIN(v40) as v40,MIN(v41) as v41 from aggJoin4989691176536194007;
