create or replace view aggView176325235191088090 as select id as v17, name as v39 from company_name as cn where country_code<> '[pl]';
create or replace view aggJoin8944662618242776869 as select movie_id as v24, company_type_id as v18, note as v19, v39 from movie_companies as mc, aggView176325235191088090 where mc.company_id=aggView176325235191088090.v17;
create or replace view aggView4113654785049704342 as select id as v18 from company_type as ct where kind<> 'production companies';
create or replace view aggJoin8231552417364300455 as select v24, v19, v39 from aggJoin8944662618242776869 join aggView4113654785049704342 using(v18);
create or replace view aggView4173029397240291970 as select id as v13 from link_type as lt;
create or replace view aggJoin3582957660452829290 as select movie_id as v24 from movie_link as ml, aggView4173029397240291970 where ml.link_type_id=aggView4173029397240291970.v13;
create or replace view aggView8054030425411734142 as select id as v22 from keyword as k where keyword IN ('sequel','revenge','based-on-novel');
create or replace view aggJoin43802315312397191 as select movie_id as v24 from movie_keyword as mk, aggView8054030425411734142 where mk.keyword_id=aggView8054030425411734142.v22;
create or replace view aggView5821822289064879075 as select v24 from aggJoin43802315312397191 group by v24;
create or replace view aggJoin1817540142326822583 as select v24 from aggJoin3582957660452829290 join aggView5821822289064879075 using(v24);
create or replace view aggView1420937598303952383 as select v24 from aggJoin1817540142326822583 group by v24;
create or replace view aggJoin8049815061647117496 as select v24, v19, v39 as v39 from aggJoin8231552417364300455 join aggView1420937598303952383 using(v24);
create or replace view aggView2268219685107463704 as select v24, MIN(v39) as v39, MIN(v19) as v40 from aggJoin8049815061647117496 group by v24;
create or replace view aggJoin5231652866793059562 as select title as v28, v39, v40 from title as t, aggView2268219685107463704 where t.id=aggView2268219685107463704.v24 and production_year>1950;
create or replace view res as select MIN(v39) as v39, MIN(v40) as v40, MIN(v28) as v41 from aggJoin5231652866793059562;
select sum(v39+v40+v41) from res;