create or replace view aggView382820904842141170 as select id as v17, name as v39 from company_name as cn where country_code<> '[pl]';
create or replace view aggJoin2155575514729851830 as select movie_id as v24, company_type_id as v18, note as v19, v39 from movie_companies as mc, aggView382820904842141170 where mc.company_id=aggView382820904842141170.v17;
create or replace view aggView7129027581868648994 as select id as v22 from keyword as k where keyword IN ('sequel','revenge','based-on-novel');
create or replace view aggJoin3023709693080973765 as select movie_id as v24 from movie_keyword as mk, aggView7129027581868648994 where mk.keyword_id=aggView7129027581868648994.v22;
create or replace view aggView4664981227737504340 as select id as v18 from company_type as ct where kind<> 'production companies';
create or replace view aggJoin8272720710286943230 as select v24, v19, v39 from aggJoin2155575514729851830 join aggView4664981227737504340 using(v18);
create or replace view aggView7717819240658484892 as select v24, MIN(v39) as v39, MIN(v19) as v40 from aggJoin8272720710286943230 group by v24;
create or replace view aggJoin1394990270954118574 as select v24, v39, v40 from aggJoin3023709693080973765 join aggView7717819240658484892 using(v24);
create or replace view aggView5042803192835027807 as select v24, MIN(v39) as v39, MIN(v40) as v40 from aggJoin1394990270954118574 group by v24;
create or replace view aggJoin2332254193730856668 as select id as v24, title as v28, v39, v40 from title as t, aggView5042803192835027807 where t.id=aggView5042803192835027807.v24 and production_year>1950;
create or replace view aggView4726385625763418321 as select v24, MIN(v39) as v39, MIN(v40) as v40, MIN(v28) as v41 from aggJoin2332254193730856668 group by v24;
create or replace view aggJoin8225157884739240978 as select link_type_id as v13, v39, v40, v41 from movie_link as ml, aggView4726385625763418321 where ml.movie_id=aggView4726385625763418321.v24;
create or replace view aggView1288974532261885984 as select v13, MIN(v39) as v39, MIN(v40) as v40, MIN(v41) as v41 from aggJoin8225157884739240978 group by v13;
create or replace view aggJoin7857603582990483098 as select v39, v40, v41 from link_type as lt, aggView1288974532261885984 where lt.id=aggView1288974532261885984.v13;
create or replace view res as select MIN(v39) as v39, MIN(v40) as v40, MIN(v41) as v41 from aggJoin7857603582990483098;
select sum(v39+v40+v41) from res;