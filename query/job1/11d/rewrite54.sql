create or replace view aggView9013487969998729337 as select id as v17, name as v39 from company_name as cn where country_code<> '[pl]';
create or replace view aggJoin6072760521894540954 as select movie_id as v24, company_type_id as v18, note as v19, v39 from movie_companies as mc, aggView9013487969998729337 where mc.company_id=aggView9013487969998729337.v17;
create or replace view aggView2985254538716314604 as select id as v24, title as v41 from title as t where production_year>1950;
create or replace view aggJoin4519836911587284924 as select v24, v18, v19, v39, v41 from aggJoin6072760521894540954 join aggView2985254538716314604 using(v24);
create or replace view aggView1512774141829866825 as select id as v22 from keyword as k where keyword IN ('sequel','revenge','based-on-novel');
create or replace view aggJoin4649300304755480539 as select movie_id as v24 from movie_keyword as mk, aggView1512774141829866825 where mk.keyword_id=aggView1512774141829866825.v22;
create or replace view aggView3588511794993866870 as select id as v13 from link_type as lt;
create or replace view aggJoin8547785138582025969 as select movie_id as v24 from movie_link as ml, aggView3588511794993866870 where ml.link_type_id=aggView3588511794993866870.v13;
create or replace view aggView6267906273321227696 as select v24 from aggJoin8547785138582025969 group by v24;
create or replace view aggJoin5811391770940823927 as select v24 from aggJoin4649300304755480539 join aggView6267906273321227696 using(v24);
create or replace view aggView7877353750169713300 as select v24 from aggJoin5811391770940823927 group by v24;
create or replace view aggJoin5652483654968977003 as select v18, v19, v39 as v39, v41 as v41 from aggJoin4519836911587284924 join aggView7877353750169713300 using(v24);
create or replace view aggView6238635713783241512 as select v18, MIN(v39) as v39, MIN(v41) as v41, MIN(v19) as v40 from aggJoin5652483654968977003 group by v18;
create or replace view aggJoin6790994188632400700 as select v39, v41, v40 from company_type as ct, aggView6238635713783241512 where ct.id=aggView6238635713783241512.v18 and kind<> 'production companies';
create or replace view res as select MIN(v39) as v39, MIN(v40) as v40, MIN(v41) as v41 from aggJoin6790994188632400700;
select sum(v39+v40+v41) from res;