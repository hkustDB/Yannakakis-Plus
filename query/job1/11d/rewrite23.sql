create or replace view aggView2168823224928303544 as select id as v17, name as v39 from company_name as cn where country_code<> '[pl]';
create or replace view aggJoin7391143372400453328 as select movie_id as v24, company_type_id as v18, note as v19, v39 from movie_companies as mc, aggView2168823224928303544 where mc.company_id=aggView2168823224928303544.v17;
create or replace view aggView2400954594891471359 as select id as v24, title as v41 from title as t where production_year>1950;
create or replace view aggJoin5771017186342430392 as select movie_id as v24, keyword_id as v22, v41 from movie_keyword as mk, aggView2400954594891471359 where mk.movie_id=aggView2400954594891471359.v24;
create or replace view aggView2794078220130129757 as select id as v18 from company_type as ct where kind<> 'production companies';
create or replace view aggJoin1055402531004399760 as select v24, v19, v39 from aggJoin7391143372400453328 join aggView2794078220130129757 using(v18);
create or replace view aggView7425219252703261946 as select v24, MIN(v39) as v39, MIN(v19) as v40 from aggJoin1055402531004399760 group by v24;
create or replace view aggJoin6933040929341904151 as select movie_id as v24, link_type_id as v13, v39, v40 from movie_link as ml, aggView7425219252703261946 where ml.movie_id=aggView7425219252703261946.v24;
create or replace view aggView6762792328902789467 as select id as v13 from link_type as lt;
create or replace view aggJoin4816682559799393309 as select v24, v39, v40 from aggJoin6933040929341904151 join aggView6762792328902789467 using(v13);
create or replace view aggView4902727728765739344 as select v24, MIN(v39) as v39, MIN(v40) as v40 from aggJoin4816682559799393309 group by v24;
create or replace view aggJoin4808018900075156185 as select v22, v41 as v41, v39, v40 from aggJoin5771017186342430392 join aggView4902727728765739344 using(v24);
create or replace view aggView7623264366487353779 as select v22, MIN(v41) as v41, MIN(v39) as v39, MIN(v40) as v40 from aggJoin4808018900075156185 group by v22;
create or replace view aggJoin8133150757465767881 as select keyword as v11, v41, v39, v40 from keyword as k, aggView7623264366487353779 where k.id=aggView7623264366487353779.v22 and keyword IN ('sequel','revenge','based-on-novel');
create or replace view res as select MIN(v39) as v39, MIN(v40) as v40, MIN(v41) as v41 from aggJoin8133150757465767881;
select sum(v39+v40+v41) from res;