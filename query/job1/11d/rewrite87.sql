create or replace view aggView3956065965122948901 as select id as v17, name as v39 from company_name as cn where country_code<> '[pl]';
create or replace view aggJoin3407793232207598730 as select movie_id as v24, company_type_id as v18, note as v19, v39 from movie_companies as mc, aggView3956065965122948901 where mc.company_id=aggView3956065965122948901.v17;
create or replace view aggView6951618034268034135 as select id as v18 from company_type as ct where kind<> 'production companies';
create or replace view aggJoin3488231979858720392 as select v24, v19, v39 from aggJoin3407793232207598730 join aggView6951618034268034135 using(v18);
create or replace view aggView9126613387911224557 as select v24, MIN(v39) as v39, MIN(v19) as v40 from aggJoin3488231979858720392 group by v24;
create or replace view aggJoin8517133259632309771 as select id as v24, title as v28, v39, v40 from title as t, aggView9126613387911224557 where t.id=aggView9126613387911224557.v24 and production_year>1950;
create or replace view aggView6853336220522473918 as select v24, MIN(v39) as v39, MIN(v40) as v40, MIN(v28) as v41 from aggJoin8517133259632309771 group by v24;
create or replace view aggJoin8353642599498915353 as select movie_id as v24, link_type_id as v13, v39, v40, v41 from movie_link as ml, aggView6853336220522473918 where ml.movie_id=aggView6853336220522473918.v24;
create or replace view aggView6378104622000980334 as select id as v13 from link_type as lt;
create or replace view aggJoin8397047424868135664 as select v24, v39, v40, v41 from aggJoin8353642599498915353 join aggView6378104622000980334 using(v13);
create or replace view aggView4106611427724038135 as select id as v22 from keyword as k where keyword IN ('sequel','revenge','based-on-novel');
create or replace view aggJoin7530782346820583374 as select movie_id as v24 from movie_keyword as mk, aggView4106611427724038135 where mk.keyword_id=aggView4106611427724038135.v22;
create or replace view aggView7627734213450813366 as select v24 from aggJoin7530782346820583374 group by v24;
create or replace view aggJoin484673608151410345 as select v39 as v39, v40 as v40, v41 as v41 from aggJoin8397047424868135664 join aggView7627734213450813366 using(v24);
create or replace view res as select MIN(v39) as v39, MIN(v40) as v40, MIN(v41) as v41 from aggJoin484673608151410345;
select sum(v39+v40+v41) from res;