create or replace view aggView4146910078028247441 as select id as v22 from keyword as k where keyword IN ('sequel','revenge','based-on-novel');
create or replace view aggJoin6883397283759318838 as select movie_id as v24 from movie_keyword as mk, aggView4146910078028247441 where mk.keyword_id=aggView4146910078028247441.v22;
create or replace view aggView8386270779887458049 as select v24 from aggJoin6883397283759318838 group by v24;
create or replace view aggJoin4376668257483235787 as select movie_id as v24, company_id as v17, company_type_id as v18, note as v19 from movie_companies as mc, aggView8386270779887458049 where mc.movie_id=aggView8386270779887458049.v24;
create or replace view aggView5260851666718133420 as select id as v13 from link_type as lt;
create or replace view aggJoin1510327828712185047 as select movie_id as v24 from movie_link as ml, aggView5260851666718133420 where ml.link_type_id=aggView5260851666718133420.v13;
create or replace view aggView8326015790892768105 as select v24 from aggJoin1510327828712185047 group by v24;
create or replace view aggJoin5323082151080194583 as select id as v24, title as v28 from title as t, aggView8326015790892768105 where t.id=aggView8326015790892768105.v24 and production_year>1950;
create or replace view aggView8755198309536054425 as select v24, MIN(v28) as v41 from aggJoin5323082151080194583 group by v24;
create or replace view aggJoin8376953823262437015 as select v17, v18, v19, v41 from aggJoin4376668257483235787 join aggView8755198309536054425 using(v24);
create or replace view aggView4846200197919525836 as select id as v18 from company_type as ct where kind<> 'production companies';
create or replace view aggJoin2995989173632914367 as select v17, v19, v41 from aggJoin8376953823262437015 join aggView4846200197919525836 using(v18);
create or replace view aggView5856045310093023911 as select v17, MIN(v41) as v41, MIN(v19) as v40 from aggJoin2995989173632914367 group by v17;
create or replace view aggJoin7060792572366135304 as select name as v2, v41, v40 from company_name as cn, aggView5856045310093023911 where cn.id=aggView5856045310093023911.v17 and country_code<> '[pl]';
select MIN(v2) as v39,MIN(v40) as v40,MIN(v41) as v41 from aggJoin7060792572366135304;
