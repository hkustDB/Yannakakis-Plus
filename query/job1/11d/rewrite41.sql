create or replace view aggView636400559218506671 as select id as v17, name as v39 from company_name as cn where country_code<> '[pl]';
create or replace view aggJoin3277145121381547572 as select movie_id as v24, company_type_id as v18, note as v19, v39 from movie_companies as mc, aggView636400559218506671 where mc.company_id=aggView636400559218506671.v17;
create or replace view aggView4123391870899698062 as select id as v24, title as v41 from title as t where production_year>1950;
create or replace view aggJoin8008432660259030472 as select movie_id as v24, link_type_id as v13, v41 from movie_link as ml, aggView4123391870899698062 where ml.movie_id=aggView4123391870899698062.v24;
create or replace view aggView8362786070382012613 as select id as v22 from keyword as k where keyword IN ('sequel','revenge','based-on-novel');
create or replace view aggJoin104921522002441562 as select movie_id as v24 from movie_keyword as mk, aggView8362786070382012613 where mk.keyword_id=aggView8362786070382012613.v22;
create or replace view aggView6579953990247075341 as select v24 from aggJoin104921522002441562 group by v24;
create or replace view aggJoin6134313090407914734 as select v24, v13, v41 as v41 from aggJoin8008432660259030472 join aggView6579953990247075341 using(v24);
create or replace view aggView3188195879811359906 as select id as v18 from company_type as ct where kind<> 'production companies';
create or replace view aggJoin2013861100240562266 as select v24, v19, v39 from aggJoin3277145121381547572 join aggView3188195879811359906 using(v18);
create or replace view aggView7081809185355610636 as select v24, MIN(v39) as v39, MIN(v19) as v40 from aggJoin2013861100240562266 group by v24;
create or replace view aggJoin7342517077145397091 as select v13, v41 as v41, v39, v40 from aggJoin6134313090407914734 join aggView7081809185355610636 using(v24);
create or replace view aggView8286869421531674205 as select v13, MIN(v41) as v41, MIN(v39) as v39, MIN(v40) as v40 from aggJoin7342517077145397091 group by v13;
create or replace view aggJoin2870011937826425674 as select v41, v39, v40 from link_type as lt, aggView8286869421531674205 where lt.id=aggView8286869421531674205.v13;
create or replace view res as select MIN(v39) as v39, MIN(v40) as v40, MIN(v41) as v41 from aggJoin2870011937826425674;
select sum(v39+v40+v41) from res;