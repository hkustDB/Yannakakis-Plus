create or replace view aggView7776997485565158161 as select id as v17, name as v39 from company_name as cn where country_code<> '[pl]';
create or replace view aggJoin478310317754108335 as select movie_id as v24, company_type_id as v18, note as v19, v39 from movie_companies as mc, aggView7776997485565158161 where mc.company_id=aggView7776997485565158161.v17;
create or replace view aggView3034384993497606613 as select id as v22 from keyword as k where keyword IN ('sequel','revenge','based-on-novel');
create or replace view aggJoin3630264021160833574 as select movie_id as v24 from movie_keyword as mk, aggView3034384993497606613 where mk.keyword_id=aggView3034384993497606613.v22;
create or replace view aggView3503124185446392098 as select v24 from aggJoin3630264021160833574 group by v24;
create or replace view aggJoin6793403088595922423 as select id as v24, title as v28 from title as t, aggView3503124185446392098 where t.id=aggView3503124185446392098.v24 and production_year>1950;
create or replace view aggView9002857481229669289 as select v24, MIN(v28) as v41 from aggJoin6793403088595922423 group by v24;
create or replace view aggJoin451510554854026129 as select movie_id as v24, link_type_id as v13, v41 from movie_link as ml, aggView9002857481229669289 where ml.movie_id=aggView9002857481229669289.v24;
create or replace view aggView9087403193435283945 as select id as v18 from company_type as ct where kind<> 'production companies';
create or replace view aggJoin247114804782054858 as select v24, v19, v39 from aggJoin478310317754108335 join aggView9087403193435283945 using(v18);
create or replace view aggView6868266506247508645 as select v24, MIN(v39) as v39, MIN(v19) as v40 from aggJoin247114804782054858 group by v24;
create or replace view aggJoin362341875436388075 as select v13, v41 as v41, v39, v40 from aggJoin451510554854026129 join aggView6868266506247508645 using(v24);
create or replace view aggView3686162029544092290 as select v13, MIN(v41) as v41, MIN(v39) as v39, MIN(v40) as v40 from aggJoin362341875436388075 group by v13;
create or replace view aggJoin3782262180339601509 as select v41, v39, v40 from link_type as lt, aggView3686162029544092290 where lt.id=aggView3686162029544092290.v13;
create or replace view res as select MIN(v39) as v39, MIN(v40) as v40, MIN(v41) as v41 from aggJoin3782262180339601509;
select sum(v39+v40+v41) from res;