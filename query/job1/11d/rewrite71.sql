create or replace view aggView4058169370493130477 as select id as v17, name as v39 from company_name as cn where country_code<> '[pl]';
create or replace view aggJoin5426410006551145670 as select movie_id as v24, company_type_id as v18, note as v19, v39 from movie_companies as mc, aggView4058169370493130477 where mc.company_id=aggView4058169370493130477.v17;
create or replace view aggView1766800357083249365 as select id as v24, title as v41 from title as t where production_year>1950;
create or replace view aggJoin3336683164739847077 as select v24, v18, v19, v39 from aggJoin5426410006551145670 join aggView1766800357083249365 using(v24);
create or replace view aggView1608490248998292424 as select id as v22 from keyword as k where keyword IN ('sequel','revenge','based-on-novel');
create or replace view aggJoin6690508298353407140 as select movie_id as v24 from movie_keyword as mk, aggView1608490248998292424 where mk.keyword_id=aggView1608490248998292424.v22;
create or replace view aggView5220676894420014233 as select v24 from aggJoin6690508298353407140 group by v24;
create or replace view aggJoin2692916937894151174 as select movie_id as v24, link_type_id as v13 from movie_link as ml, aggView5220676894420014233 where ml.movie_id=aggView5220676894420014233.v24;
create or replace view aggView8945138951546659558 as select id as v13 from link_type as lt;
create or replace view aggJoin7645996466963710948 as select v24 from aggJoin2692916937894151174 join aggView8945138951546659558 using(v13);
create or replace view aggView3920952075736521910 as select v24 from aggJoin7645996466963710948 group by v24;
create or replace view aggJoin2354996278996819178 as select v18, v19, v39 as v39 from aggJoin3336683164739847077 join aggView3920952075736521910 using(v24);
create or replace view aggView6939339544570415097 as select v18, MIN(v39) as v39, MIN(v19) as v40 from aggJoin2354996278996819178 group by v18;
create or replace view aggJoin699274529731777972 as select v39, v40 from company_type as ct, aggView6939339544570415097 where ct.id=aggView6939339544570415097.v18 and kind<> 'production companies';
select MIN(v39) as v39,MIN(v40) as v40,MIN(v41) as v41 from aggJoin699274529731777972;
