create or replace view aggView5695811538904434271 as select id as v22 from keyword as k where keyword IN ('sequel','revenge','based-on-novel');
create or replace view aggJoin5715531324078153217 as select movie_id as v24 from movie_keyword as mk, aggView5695811538904434271 where mk.keyword_id=aggView5695811538904434271.v22;
create or replace view aggView9003099633503397603 as select v24 from aggJoin5715531324078153217 group by v24;
create or replace view aggJoin8085126531029285166 as select movie_id as v24, link_type_id as v13 from movie_link as ml, aggView9003099633503397603 where ml.movie_id=aggView9003099633503397603.v24;
create or replace view aggView4408298598537118878 as select id as v13 from link_type as lt;
create or replace view aggJoin6620411911131575659 as select v24 from aggJoin8085126531029285166 join aggView4408298598537118878 using(v13);
create or replace view aggView6918702474848556637 as select v24 from aggJoin6620411911131575659 group by v24;
create or replace view aggJoin1116356076832592944 as select id as v24, title as v28 from title as t, aggView6918702474848556637 where t.id=aggView6918702474848556637.v24 and production_year>1950;
create or replace view aggView6533367702832522299 as select v24, MIN(v28) as v41 from aggJoin1116356076832592944 group by v24;
create or replace view aggJoin440745955900268487 as select company_id as v17, company_type_id as v18, note as v19, v41 from movie_companies as mc, aggView6533367702832522299 where mc.movie_id=aggView6533367702832522299.v24;
create or replace view aggView4893569379601451802 as select id as v18 from company_type as ct where kind<> 'production companies';
create or replace view aggJoin2312235522397661422 as select v17, v19, v41 from aggJoin440745955900268487 join aggView4893569379601451802 using(v18);
create or replace view aggView3324678560779962462 as select v17, MIN(v41) as v41, MIN(v19) as v40 from aggJoin2312235522397661422 group by v17;
create or replace view aggJoin8868852626168744625 as select name as v2, v41, v40 from company_name as cn, aggView3324678560779962462 where cn.id=aggView3324678560779962462.v17 and country_code<> '[pl]';
select MIN(v2) as v39,MIN(v40) as v40,MIN(v41) as v41 from aggJoin8868852626168744625;
