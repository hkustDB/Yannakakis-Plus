create or replace view aggView3170864283178131743 as select id as v24, title as v41 from title as t where production_year>1950;
create or replace view aggJoin2048401864963052938 as select movie_id as v24, keyword_id as v22, v41 from movie_keyword as mk, aggView3170864283178131743 where mk.movie_id=aggView3170864283178131743.v24;
create or replace view aggView5989570951077510315 as select id as v22 from keyword as k where keyword IN ('sequel','revenge','based-on-novel');
create or replace view aggJoin6160167489439474277 as select v24, v41 from aggJoin2048401864963052938 join aggView5989570951077510315 using(v22);
create or replace view aggView4213098926108031188 as select v24, MIN(v41) as v41 from aggJoin6160167489439474277 group by v24;
create or replace view aggJoin6860627851556525712 as select movie_id as v24, link_type_id as v13, v41 from movie_link as ml, aggView4213098926108031188 where ml.movie_id=aggView4213098926108031188.v24;
create or replace view aggView891088860040365826 as select id as v13 from link_type as lt;
create or replace view aggJoin6349537457095651371 as select v24, v41 from aggJoin6860627851556525712 join aggView891088860040365826 using(v13);
create or replace view aggView2162305532226812479 as select v24, MIN(v41) as v41 from aggJoin6349537457095651371 group by v24;
create or replace view aggJoin1090407779682992471 as select company_id as v17, company_type_id as v18, note as v19, v41 from movie_companies as mc, aggView2162305532226812479 where mc.movie_id=aggView2162305532226812479.v24;
create or replace view aggView8044520273411772365 as select id as v18 from company_type as ct where kind<> 'production companies';
create or replace view aggJoin8102899181848008607 as select v17, v19, v41 from aggJoin1090407779682992471 join aggView8044520273411772365 using(v18);
create or replace view aggView5450677431437995849 as select v17, MIN(v41) as v41, MIN(v19) as v40 from aggJoin8102899181848008607 group by v17;
create or replace view aggJoin8549708231330268301 as select name as v2, v41, v40 from company_name as cn, aggView5450677431437995849 where cn.id=aggView5450677431437995849.v17 and country_code<> '[pl]';
create or replace view res as select MIN(v2) as v39, MIN(v40) as v40, MIN(v41) as v41 from aggJoin8549708231330268301;
select sum(v39+v40+v41) from res;