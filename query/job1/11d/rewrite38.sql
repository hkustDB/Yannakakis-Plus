create or replace view aggView7396079319827416694 as select id as v17, name as v39 from company_name as cn where country_code<> '[pl]';
create or replace view aggJoin1687937236335863963 as select movie_id as v24, company_type_id as v18, note as v19, v39 from movie_companies as mc, aggView7396079319827416694 where mc.company_id=aggView7396079319827416694.v17;
create or replace view aggView3686140070227381815 as select id as v22 from keyword as k where keyword IN ('sequel','revenge','based-on-novel');
create or replace view aggJoin3520915586632947521 as select movie_id as v24 from movie_keyword as mk, aggView3686140070227381815 where mk.keyword_id=aggView3686140070227381815.v22;
create or replace view aggView5306659390810579318 as select v24 from aggJoin3520915586632947521 group by v24;
create or replace view aggJoin1536907190273453481 as select id as v24, title as v28 from title as t, aggView5306659390810579318 where t.id=aggView5306659390810579318.v24 and production_year>1950;
create or replace view aggView8767285765874726553 as select id as v18 from company_type as ct where kind<> 'production companies';
create or replace view aggJoin4218278869299013585 as select v24, v19, v39 from aggJoin1687937236335863963 join aggView8767285765874726553 using(v18);
create or replace view aggView6059842344902174095 as select v24, MIN(v39) as v39, MIN(v19) as v40 from aggJoin4218278869299013585 group by v24;
create or replace view aggJoin9014098525886414651 as select movie_id as v24, link_type_id as v13, v39, v40 from movie_link as ml, aggView6059842344902174095 where ml.movie_id=aggView6059842344902174095.v24;
create or replace view aggView4772050761096822313 as select id as v13 from link_type as lt;
create or replace view aggJoin8651330405868656578 as select v24, v39, v40 from aggJoin9014098525886414651 join aggView4772050761096822313 using(v13);
create or replace view aggView1442746555831755827 as select v24, MIN(v39) as v39, MIN(v40) as v40 from aggJoin8651330405868656578 group by v24;
create or replace view aggJoin6929388901305272315 as select v28, v39, v40 from aggJoin1536907190273453481 join aggView1442746555831755827 using(v24);
select MIN(v39) as v39,MIN(v40) as v40,MIN(v28) as v41 from aggJoin6929388901305272315;
