create or replace view aggView4498136788147984946 as select id as v17, name as v39 from company_name as cn where country_code<> '[pl]';
create or replace view aggJoin3739059275845990751 as select movie_id as v24, company_type_id as v18, note as v19, v39 from movie_companies as mc, aggView4498136788147984946 where mc.company_id=aggView4498136788147984946.v17;
create or replace view aggView1279668711113303822 as select id as v24, title as v41 from title as t where production_year>1950;
create or replace view aggJoin8911386677421825336 as select movie_id as v24, keyword_id as v22, v41 from movie_keyword as mk, aggView1279668711113303822 where mk.movie_id=aggView1279668711113303822.v24;
create or replace view aggView5473760385097895897 as select id as v18 from company_type as ct where kind<> 'production companies';
create or replace view aggJoin1971497610157753026 as select v24, v19, v39 from aggJoin3739059275845990751 join aggView5473760385097895897 using(v18);
create or replace view aggView6571242761502970334 as select v24, MIN(v39) as v39, MIN(v19) as v40 from aggJoin1971497610157753026 group by v24;
create or replace view aggJoin1881238945864176643 as select movie_id as v24, link_type_id as v13, v39, v40 from movie_link as ml, aggView6571242761502970334 where ml.movie_id=aggView6571242761502970334.v24;
create or replace view aggView2457597038399013160 as select id as v13 from link_type as lt;
create or replace view aggJoin6151292272354173660 as select v24, v39, v40 from aggJoin1881238945864176643 join aggView2457597038399013160 using(v13);
create or replace view aggView5837123257858959791 as select v24, MIN(v39) as v39, MIN(v40) as v40 from aggJoin6151292272354173660 group by v24;
create or replace view aggJoin6912707048759185611 as select v22, v41 as v41, v39, v40 from aggJoin8911386677421825336 join aggView5837123257858959791 using(v24);
create or replace view aggView793137162908032143 as select v22, MIN(v41) as v41, MIN(v39) as v39, MIN(v40) as v40 from aggJoin6912707048759185611 group by v22;
create or replace view aggJoin1181964411255947099 as select keyword as v11, v41, v39, v40 from keyword as k, aggView793137162908032143 where k.id=aggView793137162908032143.v22 and keyword IN ('sequel','revenge','based-on-novel');
select MIN(v39) as v39,MIN(v40) as v40,MIN(v41) as v41 from aggJoin1181964411255947099;
