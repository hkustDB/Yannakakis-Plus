create or replace view aggView223873197304578376 as select id as v22 from keyword as k where keyword IN ('sequel','revenge','based-on-novel');
create or replace view aggJoin7490457963566288041 as select movie_id as v24 from movie_keyword as mk, aggView223873197304578376 where mk.keyword_id=aggView223873197304578376.v22;
create or replace view aggView8646036090670721195 as select v24 from aggJoin7490457963566288041 group by v24;
create or replace view aggJoin6037149944701281115 as select id as v24, title as v28 from title as t, aggView8646036090670721195 where t.id=aggView8646036090670721195.v24 and production_year>1950;
create or replace view aggView7729409193661009399 as select v24, MIN(v28) as v41 from aggJoin6037149944701281115 group by v24;
create or replace view aggJoin220608410579737516 as select movie_id as v24, link_type_id as v13, v41 from movie_link as ml, aggView7729409193661009399 where ml.movie_id=aggView7729409193661009399.v24;
create or replace view aggView3633500775303212945 as select id as v18 from company_type as ct where kind<> 'production companies';
create or replace view aggJoin7444880563238955414 as select movie_id as v24, company_id as v17, note as v19 from movie_companies as mc, aggView3633500775303212945 where mc.company_type_id=aggView3633500775303212945.v18;
create or replace view aggView4264260012746527589 as select id as v13 from link_type as lt;
create or replace view aggJoin8479927731517199389 as select v24, v41 from aggJoin220608410579737516 join aggView4264260012746527589 using(v13);
create or replace view aggView6489087554680519942 as select v24, MIN(v41) as v41 from aggJoin8479927731517199389 group by v24;
create or replace view aggJoin5583186175372835742 as select v17, v19, v41 from aggJoin7444880563238955414 join aggView6489087554680519942 using(v24);
create or replace view aggView5786464854677561269 as select v17, MIN(v41) as v41, MIN(v19) as v40 from aggJoin5583186175372835742 group by v17;
create or replace view aggJoin8410890079493010131 as select name as v2, v41, v40 from company_name as cn, aggView5786464854677561269 where cn.id=aggView5786464854677561269.v17 and country_code<> '[pl]';
create or replace view res as select MIN(v2) as v39, MIN(v40) as v40, MIN(v41) as v41 from aggJoin8410890079493010131;
select sum(v39+v40+v41) from res;