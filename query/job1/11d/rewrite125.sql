create or replace view aggView4168791516260448220 as select id as v17, name as v39 from company_name as cn where country_code<> '[pl]';
create or replace view aggJoin3161986062806069856 as select movie_id as v24, company_type_id as v18, note as v19, v39 from movie_companies as mc, aggView4168791516260448220 where mc.company_id=aggView4168791516260448220.v17;
create or replace view aggView3837977646066755612 as select id as v24, title as v41 from title as t where production_year>1950;
create or replace view aggJoin2183620918894971659 as select movie_id as v24, keyword_id as v22, v41 from movie_keyword as mk, aggView3837977646066755612 where mk.movie_id=aggView3837977646066755612.v24;
create or replace view aggView141978459981014843 as select id as v18 from company_type as ct where kind<> 'production companies';
create or replace view aggJoin8241507475691177917 as select v24, v19, v39 from aggJoin3161986062806069856 join aggView141978459981014843 using(v18);
create or replace view aggView3223066947297867759 as select id as v13 from link_type as lt;
create or replace view aggJoin8258248950816626239 as select movie_id as v24 from movie_link as ml, aggView3223066947297867759 where ml.link_type_id=aggView3223066947297867759.v13;
create or replace view aggView5608300279643724381 as select v24 from aggJoin8258248950816626239 group by v24;
create or replace view aggJoin8454643841985878908 as select v24, v19, v39 as v39 from aggJoin8241507475691177917 join aggView5608300279643724381 using(v24);
create or replace view aggView931939925155371862 as select id as v22 from keyword as k where keyword IN ('sequel','revenge','based-on-novel');
create or replace view aggJoin219757577645777454 as select v24, v41 from aggJoin2183620918894971659 join aggView931939925155371862 using(v22);
create or replace view aggView8310526983954007133 as select v24, MIN(v41) as v41 from aggJoin219757577645777454 group by v24;
create or replace view aggJoin3047137792841657561 as select v19, v39 as v39, v41 from aggJoin8454643841985878908 join aggView8310526983954007133 using(v24);
create or replace view res as select MIN(v39) as v39, MIN(v19) as v40, MIN(v41) as v41 from aggJoin3047137792841657561;
select sum(v39+v40+v41) from res;