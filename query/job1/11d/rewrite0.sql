create or replace view aggView4642443917231206303 as select id as v17, name as v39 from company_name as cn where country_code<> '[pl]';
create or replace view aggJoin160786679738837315 as select movie_id as v24, company_type_id as v18, note as v19, v39 from movie_companies as mc, aggView4642443917231206303 where mc.company_id=aggView4642443917231206303.v17;
create or replace view aggView8859637363470958783 as select id as v22 from keyword as k where keyword IN ('sequel','revenge','based-on-novel');
create or replace view aggJoin5515585895759517337 as select movie_id as v24 from movie_keyword as mk, aggView8859637363470958783 where mk.keyword_id=aggView8859637363470958783.v22;
create or replace view aggView3357898053757078770 as select v24 from aggJoin5515585895759517337 group by v24;
create or replace view aggJoin6608753320451005338 as select movie_id as v24, link_type_id as v13 from movie_link as ml, aggView3357898053757078770 where ml.movie_id=aggView3357898053757078770.v24;
create or replace view aggView3438372086745269553 as select id as v18 from company_type as ct where kind<> 'production companies';
create or replace view aggJoin8157347516750146394 as select v24, v19, v39 from aggJoin160786679738837315 join aggView3438372086745269553 using(v18);
create or replace view aggView5437362502158857664 as select v24, MIN(v39) as v39, MIN(v19) as v40 from aggJoin8157347516750146394 group by v24;
create or replace view aggJoin610480538506413527 as select id as v24, title as v28, v39, v40 from title as t, aggView5437362502158857664 where t.id=aggView5437362502158857664.v24 and production_year>1950;
create or replace view aggView6185311403502921277 as select id as v13 from link_type as lt;
create or replace view aggJoin7481642456328321041 as select v24 from aggJoin6608753320451005338 join aggView6185311403502921277 using(v13);
create or replace view aggView549322134595084654 as select v24 from aggJoin7481642456328321041 group by v24;
create or replace view aggJoin5885443007669317988 as select v28, v39 as v39, v40 as v40 from aggJoin610480538506413527 join aggView549322134595084654 using(v24);
create or replace view res as select MIN(v39) as v39, MIN(v40) as v40, MIN(v28) as v41 from aggJoin5885443007669317988;
select sum(v39+v40+v41) from res;