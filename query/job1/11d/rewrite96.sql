create or replace view aggView4328850848929946638 as select id as v17, name as v39 from company_name as cn where country_code<> '[pl]';
create or replace view aggJoin6234659402082868266 as select movie_id as v24, company_type_id as v18, note as v19, v39 from movie_companies as mc, aggView4328850848929946638 where mc.company_id=aggView4328850848929946638.v17;
create or replace view aggView6510879647640740792 as select id as v18 from company_type as ct where kind<> 'production companies';
create or replace view aggJoin3112548463828843936 as select v24, v19, v39 from aggJoin6234659402082868266 join aggView6510879647640740792 using(v18);
create or replace view aggView6736488988601016992 as select v24, MIN(v39) as v39, MIN(v19) as v40 from aggJoin3112548463828843936 group by v24;
create or replace view aggJoin5511340405581974775 as select movie_id as v24, keyword_id as v22, v39, v40 from movie_keyword as mk, aggView6736488988601016992 where mk.movie_id=aggView6736488988601016992.v24;
create or replace view aggView953979106990036349 as select id as v13 from link_type as lt;
create or replace view aggJoin2582442817398704677 as select movie_id as v24 from movie_link as ml, aggView953979106990036349 where ml.link_type_id=aggView953979106990036349.v13;
create or replace view aggView5061550095553884263 as select v24 from aggJoin2582442817398704677 group by v24;
create or replace view aggJoin7669007835657560286 as select v24, v22, v39 as v39, v40 as v40 from aggJoin5511340405581974775 join aggView5061550095553884263 using(v24);
create or replace view aggView5360542815901800747 as select id as v22 from keyword as k where keyword IN ('sequel','revenge','based-on-novel');
create or replace view aggJoin216902595236759009 as select v24, v39, v40 from aggJoin7669007835657560286 join aggView5360542815901800747 using(v22);
create or replace view aggView3618778334625530296 as select v24, MIN(v39) as v39, MIN(v40) as v40 from aggJoin216902595236759009 group by v24;
create or replace view aggJoin7659470742190560121 as select title as v28, v39, v40 from title as t, aggView3618778334625530296 where t.id=aggView3618778334625530296.v24 and production_year>1950;
create or replace view res as select MIN(v39) as v39, MIN(v40) as v40, MIN(v28) as v41 from aggJoin7659470742190560121;
select sum(v39+v40+v41) from res;