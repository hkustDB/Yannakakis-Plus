create or replace view semiUp3381908091967488493 as select Person1Id as v4 from Person_knows_Person AS pkp3 where (Person1Id) in (select (PersonId) from Person_hasInterest_Tag AS Person_hasInterest_Tag);
create or replace view semiUp291322952893957328 as select Person1Id as v2, Person2Id as v4 from Person_knows_Person AS pkp2 where (Person2Id) in (select (v4) from semiUp3381908091967488493);
create or replace view semiUp6823671989977709009 as select Person2Id as v2, Person1Id as pkp1_person1Id from Person_knows_Person AS pkp1 where (Person2Id) in (select (v2) from semiUp291322952893957328);
create or replace view semiDown4654312124885800241 as select v2, v4 from semiUp291322952893957328 where (v2) in (select (v2) from semiUp6823671989977709009);
create or replace view semiDown7398550242086356505 as select v4 from semiUp3381908091967488493 where (v4) in (select (v4) from semiDown4654312124885800241);
create or replace view semiDown6872304635698566810 as select PersonId as v4 from Person_hasInterest_Tag AS Person_hasInterest_Tag where (PersonId) in (select (v4) from semiDown7398550242086356505);
create or replace view aggView9048191076548507374 as select v4, COUNT(*) as annot from semiDown6872304635698566810 group by v4;
create or replace view aggJoin90972703382067528 as select v4, annot from semiDown7398550242086356505 join aggView9048191076548507374 using(v4);
create or replace view aggView6766732916295990596 as select v4, SUM(annot) as annot from aggJoin90972703382067528 group by v4;
create or replace view aggJoin8861225773635235975 as select v2, v4, annot from semiDown4654312124885800241 join aggView6766732916295990596 using(v4);
create or replace view aggView6460226109061713554 as select v2, v4, SUM(annot) as annot from aggJoin8861225773635235975 group by v2, v4;
create or replace view aggJoin8159833692208419770 as select annot from semiUp6823671989977709009 join aggView6460226109061713554 using(v2) where pkp1_person1Id < v4;
select SUM(annot) as v9 from aggJoin8159833692208419770;
